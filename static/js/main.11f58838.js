/*! For license information please see main.11f58838.js.LICENSE.txt */
(()=>{var e={4:(e,t,i)=>{"use strict";var n=i(853),r=i(43),a=i(950);function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(i=t.return),e=t.return}while(e)}return 3===t.tag?i:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(l(e)!==e)throw Error(o(188))}function u(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=u(e)))return t;e=e.sibling}return null}var h=Object.assign,p=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),x=Symbol.for("react.consumer"),w=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope");var M=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var T=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var P=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var O=Symbol.for("react.client.reference");function I(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===O?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case y:return"Profiler";case v:return"StrictMode";case _:return"Suspense";case C:return"SuspenseList";case M:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case m:return"Portal";case w:return(e.displayName||"Context")+".Provider";case x:return(e._context.displayName||"Context")+".Consumer";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case E:return null!==(t=e.displayName||null)?t:I(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return I(e(t))}catch(i){}}return null}var k=Array.isArray,R=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},B=[],N=-1;function F(e){return{current:e}}function U(e){0>N||(e.current=B[N],B[N]=null,N--)}function V(e,t){N++,B[N]=e.current,e.current=t}var j=F(null),W=F(null),H=F(null),G=F(null);function q(e,t){switch(V(H,t),V(W,e),V(j,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?ru(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=au(t=ru(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(j),V(j,e)}function X(){U(j),U(W),U(H)}function Y(e){null!==e.memoizedState&&V(G,e);var t=j.current,i=au(t,e.type);t!==i&&(V(W,e),V(j,i))}function Q(e){W.current===e&&(U(j),U(W)),G.current===e&&(U(G),Yu._currentValue=L)}var K=Object.prototype.hasOwnProperty,Z=n.unstable_scheduleCallback,J=n.unstable_cancelCallback,$=n.unstable_shouldYield,ee=n.unstable_requestPaint,te=n.unstable_now,ie=n.unstable_getCurrentPriorityLevel,ne=n.unstable_ImmediatePriority,re=n.unstable_UserBlockingPriority,ae=n.unstable_NormalPriority,oe=n.unstable_LowPriority,se=n.unstable_IdlePriority,le=n.log,ce=n.unstable_setDisableYieldValue,de=null,ue=null;function he(e){if("function"===typeof le&&ce(e),ue&&"function"===typeof ue.setStrictMode)try{ue.setStrictMode(de,e)}catch(t){}}var pe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(fe(e)/me|0)|0},fe=Math.log,me=Math.LN2;var ge=256,ve=4194304;function ye(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function be(e,t,i){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var s=134217727&n;return 0!==s?0!==(n=s&~a)?r=ye(n):0!==(o&=s)?r=ye(o):i||0!==(i=s&~e)&&(r=ye(i)):0!==(s=n&~a)?r=ye(s):0!==o?r=ye(o):i||0!==(i=n&~e)&&(r=ye(i)),0===r?0:0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||32===a&&0!==(4194048&i))?t:r}function xe(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function we(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Se(){var e=ge;return 0===(4194048&(ge<<=1))&&(ge=256),e}function _e(){var e=ve;return 0===(62914560&(ve<<=1))&&(ve=4194304),e}function Ce(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function Ee(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ae(e,t,i){e.pendingLanes|=t,e.suspendedLanes&=~t;var n=31-pe(t);e.entangledLanes|=t,e.entanglements[n]=1073741824|e.entanglements[n]|4194090&i}function Me(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var n=31-pe(i),r=1<<n;r&t|e[n]&t&&(e[n]|=t),i&=~r}}function Te(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Pe(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function De(){var e=z.p;return 0!==e?e:void 0===(e=window.event)?32:ch(e.type)}var Oe=Math.random().toString(36).slice(2),Ie="__reactFiber$"+Oe,ke="__reactProps$"+Oe,Re="__reactContainer$"+Oe,ze="__reactEvents$"+Oe,Le="__reactListeners$"+Oe,Be="__reactHandles$"+Oe,Ne="__reactResources$"+Oe,Fe="__reactMarker$"+Oe;function Ue(e){delete e[Ie],delete e[ke],delete e[ze],delete e[Le],delete e[Be]}function Ve(e){var t=e[Ie];if(t)return t;for(var i=e.parentNode;i;){if(t=i[Re]||i[Ie]){if(i=t.alternate,null!==t.child||null!==i&&null!==i.child)for(e=bu(e);null!==e;){if(i=e[Ie])return i;e=bu(e)}return t}i=(e=i).parentNode}return null}function je(e){if(e=e[Ie]||e[Re]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function We(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(o(33))}function He(e){var t=e[Ne];return t||(t=e[Ne]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ge(e){e[Fe]=!0}var qe=new Set,Xe={};function Ye(e,t){Qe(e,t),Qe(e+"Capture",t)}function Qe(e,t){for(Xe[e]=t,e=0;e<t.length;e++)qe.add(t[e])}var Ke,Ze,Je=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$e={},et={};function tt(e,t,i){if(r=t,K.call(et,r)||!K.call($e,r)&&(Je.test(r)?et[r]=!0:($e[r]=!0,0)))if(null===i)e.removeAttribute(t);else{switch(typeof i){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var n=t.toLowerCase().slice(0,5);if("data-"!==n&&"aria-"!==n)return void e.removeAttribute(t)}e.setAttribute(t,""+i)}var r}function it(e,t,i){if(null===i)e.removeAttribute(t);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+i)}}function nt(e,t,i,n){if(null===n)e.removeAttribute(i);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(i)}e.setAttributeNS(t,i,""+n)}}function rt(e){if(void 0===Ke)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);Ke=t&&t[1]||"",Ze=-1<i.stack.indexOf("\n    at")?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Ke+e+Ze}var at=!1;function ot(e,t){if(!e||at)return"";at=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(t){var i=function(){throw Error()};if(Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(i,[])}catch(r){var n=r}Reflect.construct(e,[],i)}else{try{i.call()}catch(a){n=a}e.call(i.prototype)}}else{try{throw Error()}catch(o){n=o}(i=e())&&"function"===typeof i.catch&&i.catch(function(){})}}catch(s){if(s&&n&&"string"===typeof s.stack)return[s.stack,n.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var a=n.DetermineComponentFrameRoot(),o=a[0],s=a[1];if(o&&s){var l=o.split("\n"),c=s.split("\n");for(r=n=0;n<l.length&&!l[n].includes("DetermineComponentFrameRoot");)n++;for(;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;if(n===l.length||r===c.length)for(n=l.length-1,r=c.length-1;1<=n&&0<=r&&l[n]!==c[r];)r--;for(;1<=n&&0<=r;n--,r--)if(l[n]!==c[r]){if(1!==n||1!==r)do{if(n--,0>--r||l[n]!==c[r]){var d="\n"+l[n].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(1<=n&&0<=r);break}}}finally{at=!1,Error.prepareStackTrace=i}return(i=e?e.displayName||e.name:"")?rt(i):""}function st(e){switch(e.tag){case 26:case 27:case 5:return rt(e.type);case 16:return rt("Lazy");case 13:return rt("Suspense");case 19:return rt("SuspenseList");case 0:case 15:return ot(e.type,!1);case 11:return ot(e.type.render,!1);case 1:return ot(e.type,!0);case 31:return rt("Activity");default:return""}}function lt(e){try{var t="";do{t+=st(e),e=e.return}while(e);return t}catch(i){return"\nError generating stack: "+i.message+"\n"+i.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function dt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ut(e){e._valueTracker||(e._valueTracker=function(e){var t=dt(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var r=i.get,a=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ht(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),n="";return e&&(n=dt(e)?e.checked?"true":"false":e.value),(e=n)!==i&&(t.setValue(e),!0)}function pt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var ft=/[\n"\\]/g;function mt(e){return e.replace(ft,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function gt(e,t,i,n,r,a,o,s){e.name="",null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?yt(e,o,ct(t)):null!=i?yt(e,o,ct(i)):null!=n&&e.removeAttribute("value"),null==r&&null!=a&&(e.defaultChecked=!!a),null!=r&&(e.checked=r&&"function"!==typeof r&&"symbol"!==typeof r),null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.name=""+ct(s):e.removeAttribute("name")}function vt(e,t,i,n,r,a,o,s){if(null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a&&(e.type=a),null!=t||null!=i){if(!("submit"!==a&&"reset"!==a||void 0!==t&&null!==t))return;i=null!=i?""+ct(i):"",t=null!=t?""+ct(t):i,s||t===e.value||(e.value=t),e.defaultValue=t}n="function"!==typeof(n=null!=n?n:r)&&"symbol"!==typeof n&&!!n,e.checked=s?e.checked:!!n,e.defaultChecked=!!n,null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.name=o)}function yt(e,t,i){"number"===t&&pt(e.ownerDocument)===e||e.defaultValue===""+i||(e.defaultValue=""+i)}function bt(e,t,i,n){if(e=e.options,t){t={};for(var r=0;r<i.length;r++)t["$"+i[r]]=!0;for(i=0;i<e.length;i++)r=t.hasOwnProperty("$"+e[i].value),e[i].selected!==r&&(e[i].selected=r),r&&n&&(e[i].defaultSelected=!0)}else{for(i=""+ct(i),t=null,r=0;r<e.length;r++){if(e[r].value===i)return e[r].selected=!0,void(n&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function xt(e,t,i){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=i)?e.defaultValue=null!=i?""+ct(i):"":e.defaultValue!==t&&(e.defaultValue=t)}function wt(e,t,i,n){if(null==t){if(null!=n){if(null!=i)throw Error(o(92));if(k(n)){if(1<n.length)throw Error(o(93));n=n[0]}i=n}null==i&&(i=""),t=i}i=ct(t),e.defaultValue=i,(n=e.textContent)===i&&""!==n&&null!==n&&(e.value=n)}function St(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t}var _t=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ct(e,t,i){var n=0===t.indexOf("--");null==i||"boolean"===typeof i||""===i?n?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":n?e.setProperty(t,i):"number"!==typeof i||0===i||_t.has(t)?"float"===t?e.cssFloat=i:e[t]=(""+i).trim():e[t]=i+"px"}function Et(e,t,i){if(null!=t&&"object"!==typeof t)throw Error(o(62));if(e=e.style,null!=i){for(var n in i)!i.hasOwnProperty(n)||null!=t&&t.hasOwnProperty(n)||(0===n.indexOf("--")?e.setProperty(n,""):"float"===n?e.cssFloat="":e[n]="");for(var r in t)n=t[r],t.hasOwnProperty(r)&&i[r]!==n&&Ct(e,r,n)}else for(var a in t)t.hasOwnProperty(a)&&Ct(e,a,t[a])}function At(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Tt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pt(e){return Tt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Dt=null;function Ot(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var It=null,kt=null;function Rt(e){var t=je(e);if(t&&(e=t.stateNode)){var i=e[ke]||null;e:switch(e=t.stateNode,t.type){case"input":if(gt(e,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+mt(""+t)+'"][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==e&&n.form===e.form){var r=n[ke]||null;if(!r)throw Error(o(90));gt(n,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<i.length;t++)(n=i[t]).form===e.form&&ht(n)}break e;case"textarea":xt(e,i.value,i.defaultValue);break e;case"select":null!=(t=i.value)&&bt(e,!!i.multiple,t,!1)}}}var zt=!1;function Lt(e,t,i){if(zt)return e(t,i);zt=!0;try{return e(t)}finally{if(zt=!1,(null!==It||null!==kt)&&(Vc(),It&&(t=It,e=kt,kt=It=null,Rt(t),e)))for(t=0;t<e.length;t++)Rt(e[t])}}function Bt(e,t){var i=e.stateNode;if(null===i)return null;var n=i[ke]||null;if(null===n)return null;i=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(i&&"function"!==typeof i)throw Error(o(231,t,typeof i));return i}var Nt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Ft=!1;if(Nt)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){Ft=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch(kh){Ft=!1}var Vt=null,jt=null,Wt=null;function Ht(){if(Wt)return Wt;var e,t,i=jt,n=i.length,r="value"in Vt?Vt.value:Vt.textContent,a=r.length;for(e=0;e<n&&i[e]===r[e];e++);var o=n-e;for(t=1;t<=o&&i[n-t]===r[a-t];t++);return Wt=r.slice(e,1<t?1-t:void 0)}function Gt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function qt(){return!0}function Xt(){return!1}function Yt(e){function t(t,i,n,r,a){for(var o in this._reactName=t,this._targetInst=n,this.type=i,this.nativeEvent=r,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?qt:Xt,this.isPropagationStopped=Xt,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=qt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=qt)},persist:function(){},isPersistent:qt}),t}var Qt,Kt,Zt,Jt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$t=Yt(Jt),ei=h({},Jt,{view:0,detail:0}),ti=Yt(ei),ii=h({},ei,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pi,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zt&&(Zt&&"mousemove"===e.type?(Qt=e.screenX-Zt.screenX,Kt=e.screenY-Zt.screenY):Kt=Qt=0,Zt=e),Qt)},movementY:function(e){return"movementY"in e?e.movementY:Kt}}),ni=Yt(ii),ri=Yt(h({},ii,{dataTransfer:0})),ai=Yt(h({},ei,{relatedTarget:0})),oi=Yt(h({},Jt,{animationName:0,elapsedTime:0,pseudoElement:0})),si=Yt(h({},Jt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),li=Yt(h({},Jt,{data:0})),ci={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},di={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ui={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hi(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=ui[e])&&!!t[e]}function pi(){return hi}var fi=Yt(h({},ei,{key:function(e){if(e.key){var t=ci[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Gt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?di[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pi,charCode:function(e){return"keypress"===e.type?Gt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Gt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),mi=Yt(h({},ii,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),gi=Yt(h({},ei,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pi})),vi=Yt(h({},Jt,{propertyName:0,elapsedTime:0,pseudoElement:0})),yi=Yt(h({},ii,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),bi=Yt(h({},Jt,{newState:0,oldState:0})),xi=[9,13,27,32],wi=Nt&&"CompositionEvent"in window,Si=null;Nt&&"documentMode"in document&&(Si=document.documentMode);var _i=Nt&&"TextEvent"in window&&!Si,Ci=Nt&&(!wi||Si&&8<Si&&11>=Si),Ei=String.fromCharCode(32),Ai=!1;function Mi(e,t){switch(e){case"keyup":return-1!==xi.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ti(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Pi=!1;var Di={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Oi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Di[e.type]:"textarea"===t}function Ii(e,t,i,n){It?kt?kt.push(n):kt=[n]:It=n,0<(t=Hd(t,"onChange")).length&&(i=new $t("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var ki=null,Ri=null;function zi(e){Ld(e,0)}function Li(e){if(ht(We(e)))return e}function Bi(e,t){if("change"===e)return t}var Ni=!1;if(Nt){var Fi;if(Nt){var Ui="oninput"in document;if(!Ui){var Vi=document.createElement("div");Vi.setAttribute("oninput","return;"),Ui="function"===typeof Vi.oninput}Fi=Ui}else Fi=!1;Ni=Fi&&(!document.documentMode||9<document.documentMode)}function ji(){ki&&(ki.detachEvent("onpropertychange",Wi),Ri=ki=null)}function Wi(e){if("value"===e.propertyName&&Li(Ri)){var t=[];Ii(t,Ri,e,Ot(e)),Lt(zi,t)}}function Hi(e,t,i){"focusin"===e?(ji(),Ri=i,(ki=t).attachEvent("onpropertychange",Wi)):"focusout"===e&&ji()}function Gi(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Li(Ri)}function qi(e,t){if("click"===e)return Li(t)}function Xi(e,t){if("input"===e||"change"===e)return Li(t)}var Yi="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Qi(e,t){if(Yi(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var r=i[n];if(!K.call(t,r)||!Yi(e[r],t[r]))return!1}return!0}function Ki(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Zi(e,t){var i,n=Ki(e);for(e=0;n;){if(3===n.nodeType){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ki(n)}}function Ji(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Ji(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function $i(e){for(var t=pt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var i="string"===typeof t.contentWindow.location.href}catch(n){i=!1}if(!i)break;t=pt((e=t.contentWindow).document)}return t}function en(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var tn=Nt&&"documentMode"in document&&11>=document.documentMode,nn=null,rn=null,an=null,on=!1;function sn(e,t,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;on||null==nn||nn!==pt(n)||("selectionStart"in(n=nn)&&en(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},an&&Qi(an,n)||(an=n,0<(n=Hd(rn,"onSelect")).length&&(t=new $t("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=nn)))}function ln(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var cn={animationend:ln("Animation","AnimationEnd"),animationiteration:ln("Animation","AnimationIteration"),animationstart:ln("Animation","AnimationStart"),transitionrun:ln("Transition","TransitionRun"),transitionstart:ln("Transition","TransitionStart"),transitioncancel:ln("Transition","TransitionCancel"),transitionend:ln("Transition","TransitionEnd")},dn={},un={};function hn(e){if(dn[e])return dn[e];if(!cn[e])return e;var t,i=cn[e];for(t in i)if(i.hasOwnProperty(t)&&t in un)return dn[e]=i[t];return e}Nt&&(un=document.createElement("div").style,"AnimationEvent"in window||(delete cn.animationend.animation,delete cn.animationiteration.animation,delete cn.animationstart.animation),"TransitionEvent"in window||delete cn.transitionend.transition);var pn=hn("animationend"),fn=hn("animationiteration"),mn=hn("animationstart"),gn=hn("transitionrun"),vn=hn("transitionstart"),yn=hn("transitioncancel"),bn=hn("transitionend"),xn=new Map,wn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sn(e,t){xn.set(e,t),Ye(t,[e])}wn.push("scrollEnd");var _n=new WeakMap;function Cn(e,t){if("object"===typeof e&&null!==e){var i=_n.get(e);return void 0!==i?i:(t={value:e,source:t,stack:lt(t)},_n.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var En=[],An=0,Mn=0;function Tn(){for(var e=An,t=Mn=An=0;t<e;){var i=En[t];En[t++]=null;var n=En[t];En[t++]=null;var r=En[t];En[t++]=null;var a=En[t];if(En[t++]=null,null!==n&&null!==r){var o=n.pending;null===o?r.next=r:(r.next=o.next,o.next=r),n.pending=r}0!==a&&In(i,r,a)}}function Pn(e,t,i,n){En[An++]=e,En[An++]=t,En[An++]=i,En[An++]=n,Mn|=n,e.lanes|=n,null!==(e=e.alternate)&&(e.lanes|=n)}function Dn(e,t,i,n){return Pn(e,t,i,n),kn(e)}function On(e,t){return Pn(e,null,null,t),kn(e)}function In(e,t,i){e.lanes|=i;var n=e.alternate;null!==n&&(n.lanes|=i);for(var r=!1,a=e.return;null!==a;)a.childLanes|=i,null!==(n=a.alternate)&&(n.childLanes|=i),22===a.tag&&(null===(e=a.stateNode)||1&e._visibility||(r=!0)),e=a,a=a.return;return 3===e.tag?(a=e.stateNode,r&&null!==t&&(r=31-pe(i),null===(n=(e=a.hiddenUpdates)[r])?e[r]=[t]:n.push(t),t.lane=536870912|i),a):null}function kn(e){if(50<Ic)throw Ic=0,kc=null,Error(o(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Rn={};function zn(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(e,t,i,n){return new zn(e,t,i,n)}function Bn(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Nn(e,t){var i=e.alternate;return null===i?((i=Ln(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=65011712&e.flags,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i.refCleanup=e.refCleanup,i}function Fn(e,t){e.flags&=65011714;var i=e.alternate;return null===i?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=i.childLanes,e.lanes=i.lanes,e.child=i.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=i.memoizedProps,e.memoizedState=i.memoizedState,e.updateQueue=i.updateQueue,e.type=i.type,t=i.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Un(e,t,i,n,r,a){var s=0;if(n=e,"function"===typeof e)Bn(e)&&(s=1);else if("string"===typeof e)s=function(e,t,i){if(1===i||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,i,j.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case M:return(e=Ln(31,i,t,r)).elementType=M,e.lanes=a,e;case g:return Vn(i.children,r,a,t);case v:s=8,r|=24;break;case y:return(e=Ln(12,i,t,2|r)).elementType=y,e.lanes=a,e;case _:return(e=Ln(13,i,t,r)).elementType=_,e.lanes=a,e;case C:return(e=Ln(19,i,t,r)).elementType=C,e.lanes=a,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case b:case w:s=10;break e;case x:s=9;break e;case S:s=11;break e;case E:s=14;break e;case A:s=16,n=null;break e}s=29,i=Error(o(130,null===e?"null":typeof e,"")),n=null}return(t=Ln(s,i,t,r)).elementType=e,t.type=n,t.lanes=a,t}function Vn(e,t,i,n){return(e=Ln(7,e,n,t)).lanes=i,e}function jn(e,t,i){return(e=Ln(6,e,null,t)).lanes=i,e}function Wn(e,t,i){return(t=Ln(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Hn=[],Gn=0,qn=null,Xn=0,Yn=[],Qn=0,Kn=null,Zn=1,Jn="";function $n(e,t){Hn[Gn++]=Xn,Hn[Gn++]=qn,qn=e,Xn=t}function er(e,t,i){Yn[Qn++]=Zn,Yn[Qn++]=Jn,Yn[Qn++]=Kn,Kn=e;var n=Zn;e=Jn;var r=32-pe(n)-1;n&=~(1<<r),i+=1;var a=32-pe(t)+r;if(30<a){var o=r-r%5;a=(n&(1<<o)-1).toString(32),n>>=o,r-=o,Zn=1<<32-pe(t)+r|i<<r|n,Jn=a+e}else Zn=1<<a|i<<r|n,Jn=e}function tr(e){null!==e.return&&($n(e,1),er(e,1,0))}function ir(e){for(;e===qn;)qn=Hn[--Gn],Hn[Gn]=null,Xn=Hn[--Gn],Hn[Gn]=null;for(;e===Kn;)Kn=Yn[--Qn],Yn[Qn]=null,Jn=Yn[--Qn],Yn[Qn]=null,Zn=Yn[--Qn],Yn[Qn]=null}var nr=null,rr=null,ar=!1,or=null,sr=!1,lr=Error(o(519));function cr(e){throw mr(Cn(Error(o(418,"")),e)),lr}function dr(e){var t=e.stateNode,i=e.type,n=e.memoizedProps;switch(t[Ie]=e,t[ke]=n,i){case"dialog":Bd("cancel",t),Bd("close",t);break;case"iframe":case"object":case"embed":Bd("load",t);break;case"video":case"audio":for(i=0;i<Rd.length;i++)Bd(Rd[i],t);break;case"source":Bd("error",t);break;case"img":case"image":case"link":Bd("error",t),Bd("load",t);break;case"details":Bd("toggle",t);break;case"input":Bd("invalid",t),vt(t,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0),ut(t);break;case"select":Bd("invalid",t);break;case"textarea":Bd("invalid",t),wt(t,n.value,n.defaultValue,n.children),ut(t)}"string"!==typeof(i=n.children)&&"number"!==typeof i&&"bigint"!==typeof i||t.textContent===""+i||!0===n.suppressHydrationWarning||Kd(t.textContent,i)?(null!=n.popover&&(Bd("beforetoggle",t),Bd("toggle",t)),null!=n.onScroll&&Bd("scroll",t),null!=n.onScrollEnd&&Bd("scrollend",t),null!=n.onClick&&(t.onclick=Zd),t=!0):t=!1,t||cr(e)}function ur(e){for(nr=e.return;nr;)switch(nr.tag){case 5:case 13:return void(sr=!1);case 27:case 3:return void(sr=!0);default:nr=nr.return}}function hr(e){if(e!==nr)return!1;if(!ar)return ur(e),ar=!0,!1;var t,i=e.tag;if((t=3!==i&&27!==i)&&((t=5===i)&&(t=!("form"!==(t=e.type)&&"button"!==t)||ou(e.type,e.memoizedProps)),t=!t),t&&rr&&cr(e),ur(e),13===i){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,i=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===i){rr=vu(e.nextSibling);break e}i--}else"$"!==t&&"$!"!==t&&"$?"!==t||i++;e=e.nextSibling}rr=null}}else 27===i?(i=rr,pu(e.type)?(e=yu,yu=null,rr=e):rr=i):rr=nr?vu(e.stateNode.nextSibling):null;return!0}function pr(){rr=nr=null,ar=!1}function fr(){var e=or;return null!==e&&(null===bc?bc=e:bc.push.apply(bc,e),or=null),e}function mr(e){null===or?or=[e]:or.push(e)}var gr=F(null),vr=null,yr=null;function br(e,t,i){V(gr,t._currentValue),t._currentValue=i}function xr(e){e._currentValue=gr.current,U(gr)}function wr(e,t,i){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===i)break;e=e.return}}function Sr(e,t,i,n){var r=e.child;for(null!==r&&(r.return=e);null!==r;){var a=r.dependencies;if(null!==a){var s=r.child;a=a.firstContext;e:for(;null!==a;){var l=a;a=r;for(var c=0;c<t.length;c++)if(l.context===t[c]){a.lanes|=i,null!==(l=a.alternate)&&(l.lanes|=i),wr(a.return,i,e),n||(s=null);break e}a=l.next}}else if(18===r.tag){if(null===(s=r.return))throw Error(o(341));s.lanes|=i,null!==(a=s.alternate)&&(a.lanes|=i),wr(s,i,e),s=null}else s=r.child;if(null!==s)s.return=r;else for(s=r;null!==s;){if(s===e){s=null;break}if(null!==(r=s.sibling)){r.return=s.return,s=r;break}s=s.return}r=s}}function _r(e,t,i,n){e=null;for(var r=t,a=!1;null!==r;){if(!a)if(0!==(524288&r.flags))a=!0;else if(0!==(262144&r.flags))break;if(10===r.tag){var s=r.alternate;if(null===s)throw Error(o(387));if(null!==(s=s.memoizedProps)){var l=r.type;Yi(r.pendingProps.value,s.value)||(null!==e?e.push(l):e=[l])}}else if(r===G.current){if(null===(s=r.alternate))throw Error(o(387));s.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(null!==e?e.push(Yu):e=[Yu])}r=r.return}null!==e&&Sr(t,e,i,n),t.flags|=262144}function Cr(e){for(e=e.firstContext;null!==e;){if(!Yi(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Er(e){vr=e,yr=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Ar(e){return Tr(vr,e)}function Mr(e,t){return null===vr&&Er(e),Tr(e,t)}function Tr(e,t){var i=t._currentValue;if(t={context:t,memoizedValue:i,next:null},null===yr){if(null===e)throw Error(o(308));yr=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else yr=yr.next=t;return i}var Pr="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Dr=n.unstable_scheduleCallback,Or=n.unstable_NormalPriority,Ir={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function kr(){return{controller:new Pr,data:new Map,refCount:0}}function Rr(e){e.refCount--,0===e.refCount&&Dr(Or,function(){e.controller.abort()})}var zr=null,Lr=0,Br=0,Nr=null;function Fr(){if(0===--Lr&&null!==zr){null!==Nr&&(Nr.status="fulfilled");var e=zr;zr=null,Br=0,Nr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Ur=R.S;R.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===zr){var i=zr=[];Lr=0,Br=Pd(),Nr={status:"pending",value:void 0,then:function(e){i.push(e)}}}Lr++,t.then(Fr,Fr)}(0,t),null!==Ur&&Ur(e,t)};var Vr=F(null);function jr(){var e=Vr.current;return null!==e?e:nc.pooledCache}function Wr(e,t){V(Vr,null===t?Vr.current:t.pool)}function Hr(){var e=jr();return null===e?null:{parent:Ir._currentValue,pool:e}}var Gr=Error(o(460)),qr=Error(o(474)),Xr=Error(o(542)),Yr={then:function(){}};function Qr(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Kr(){}function Zr(e,t,i){switch(void 0===(i=e[i])?e.push(t):i!==t&&(t.then(Kr,Kr),t=i),t.status){case"fulfilled":return t.value;case"rejected":throw ea(e=t.reason),e;default:if("string"===typeof t.status)t.then(Kr,Kr);else{if(null!==(e=nc)&&100<e.shellSuspendCounter)throw Error(o(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var i=t;i.status="fulfilled",i.value=e}},function(e){if("pending"===t.status){var i=t;i.status="rejected",i.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw ea(e=t.reason),e}throw Jr=t,Gr}}var Jr=null;function $r(){if(null===Jr)throw Error(o(459));var e=Jr;return Jr=null,e}function ea(e){if(e===Gr||e===Xr)throw Error(o(483))}var ta=!1;function ia(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function na(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ra(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function aa(e,t,i){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&ic)){var r=n.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),n.pending=t,t=kn(e),In(e,null,i),t}return Pn(e,n,t,i),kn(e)}function oa(e,t,i){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&i))){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,Me(e,i)}}function sa(e,t){var i=e.updateQueue,n=e.alternate;if(null!==n&&i===(n=n.updateQueue)){var r=null,a=null;if(null!==(i=i.firstBaseUpdate)){do{var o={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};null===a?r=a=o:a=a.next=o,i=i.next}while(null!==i);null===a?r=a=t:a=a.next=t}else r=a=t;return i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:n.shared,callbacks:n.callbacks},void(e.updateQueue=i)}null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}var la=!1;function ca(){if(la){if(null!==Nr)throw Nr}}function da(e,t,i,n){la=!1;var r=e.updateQueue;ta=!1;var a=r.firstBaseUpdate,o=r.lastBaseUpdate,s=r.shared.pending;if(null!==s){r.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?a=c:o.next=c,o=l;var d=e.alternate;null!==d&&((s=(d=d.updateQueue).lastBaseUpdate)!==o&&(null===s?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l))}if(null!==a){var u=r.baseState;for(o=0,d=c=l=null,s=a;;){var p=-536870913&s.lane,f=p!==s.lane;if(f?(ac&p)===p:(n&p)===p){0!==p&&p===Br&&(la=!0),null!==d&&(d=d.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var m=e,g=s;p=t;var v=i;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){u=m.call(v,u,p);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(p="function"===typeof(m=g.payload)?m.call(v,u,p):m)||void 0===p)break e;u=h({},u,p);break e;case 2:ta=!0}}null!==(p=s.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=r.callbacks)?r.callbacks=[p]:f.push(p))}else f={lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===d?(c=d=f,l=u):d=d.next=f,o|=p;if(null===(s=s.next)){if(null===(s=r.shared.pending))break;s=(f=s).next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}null===d&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=d,null===a&&(r.shared.lanes=0),pc|=o,e.lanes=o,e.memoizedState=u}}function ua(e,t){if("function"!==typeof e)throw Error(o(191,e));e.call(t)}function ha(e,t){var i=e.callbacks;if(null!==i)for(e.callbacks=null,e=0;e<i.length;e++)ua(i[e],t)}var pa=F(null),fa=F(0);function ma(e,t){V(fa,e=uc),V(pa,t),uc=e|t.baseLanes}function ga(){V(fa,uc),V(pa,pa.current)}function va(){uc=fa.current,U(pa),U(fa)}var ya=0,ba=null,xa=null,wa=null,Sa=!1,_a=!1,Ca=!1,Ea=0,Aa=0,Ma=null,Ta=0;function Pa(){throw Error(o(321))}function Da(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!Yi(e[i],t[i]))return!1;return!0}function Oa(e,t,i,n,r,a){return ya=a,ba=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,R.H=null===e||null===e.memoizedState?qo:Xo,Ca=!1,a=i(n,r),Ca=!1,_a&&(a=ka(t,i,n,r)),Ia(e),a}function Ia(e){R.H=Go;var t=null!==xa&&null!==xa.next;if(ya=0,wa=xa=ba=null,Sa=!1,Aa=0,Ma=null,t)throw Error(o(300));null===e||Ms||null!==(e=e.dependencies)&&Cr(e)&&(Ms=!0)}function ka(e,t,i,n){ba=e;var r=0;do{if(_a&&(Ma=null),Aa=0,_a=!1,25<=r)throw Error(o(301));if(r+=1,wa=xa=null,null!=e.updateQueue){var a=e.updateQueue;a.lastEffect=null,a.events=null,a.stores=null,null!=a.memoCache&&(a.memoCache.index=0)}R.H=Yo,a=t(i,n)}while(_a);return a}function Ra(){var e=R.H,t=e.useState()[0];return t="function"===typeof t.then?Ua(t):t,e=e.useState()[0],(null!==xa?xa.memoizedState:null)!==e&&(ba.flags|=1024),t}function za(){var e=0!==Ea;return Ea=0,e}function La(e,t,i){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i}function Ba(e){if(Sa){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Sa=!1}ya=0,wa=xa=ba=null,_a=!1,Aa=Ea=0,Ma=null}function Na(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===wa?ba.memoizedState=wa=e:wa=wa.next=e,wa}function Fa(){if(null===xa){var e=ba.alternate;e=null!==e?e.memoizedState:null}else e=xa.next;var t=null===wa?ba.memoizedState:wa.next;if(null!==t)wa=t,xa=e;else{if(null===e){if(null===ba.alternate)throw Error(o(467));throw Error(o(310))}e={memoizedState:(xa=e).memoizedState,baseState:xa.baseState,baseQueue:xa.baseQueue,queue:xa.queue,next:null},null===wa?ba.memoizedState=wa=e:wa=wa.next=e}return wa}function Ua(e){var t=Aa;return Aa+=1,null===Ma&&(Ma=[]),e=Zr(Ma,e,t),t=ba,null===(null===wa?t.memoizedState:wa.next)&&(t=t.alternate,R.H=null===t||null===t.memoizedState?qo:Xo),e}function Va(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Ua(e);if(e.$$typeof===w)return Ar(e)}throw Error(o(438,String(e)))}function ja(e){var t=null,i=ba.updateQueue;if(null!==i&&(t=i.memoCache),null==t){var n=ba.alternate;null!==n&&(null!==(n=n.updateQueue)&&(null!=(n=n.memoCache)&&(t={data:n.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===i&&(i={lastEffect:null,events:null,stores:null,memoCache:null},ba.updateQueue=i),i.memoCache=t,void 0===(i=t.data[t.index]))for(i=t.data[t.index]=Array(e),n=0;n<e;n++)i[n]=T;return t.index++,i}function Wa(e,t){return"function"===typeof t?t(e):t}function Ha(e){return Ga(Fa(),xa,e)}function Ga(e,t,i){var n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=i;var r=e.baseQueue,a=n.pending;if(null!==a){if(null!==r){var s=r.next;r.next=a.next,a.next=s}t.baseQueue=r=a,n.pending=null}if(a=e.baseState,null===r)e.memoizedState=a;else{var l=s=null,c=null,d=t=r.next,u=!1;do{var h=-536870913&d.lane;if(h!==d.lane?(ac&h)===h:(ya&h)===h){var p=d.revertLane;if(0===p)null!==c&&(c=c.next={lane:0,revertLane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),h===Br&&(u=!0);else{if((ya&p)===p){d=d.next,p===Br&&(u=!0);continue}h={lane:0,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=h,s=a):c=c.next=h,ba.lanes|=p,pc|=p}h=d.action,Ca&&i(a,h),a=d.hasEagerState?d.eagerState:i(a,h)}else p={lane:h,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=p,s=a):c=c.next=p,ba.lanes|=h,pc|=h;d=d.next}while(null!==d&&d!==t);if(null===c?s=a:c.next=l,!Yi(a,e.memoizedState)&&(Ms=!0,u&&null!==(i=Nr)))throw i;e.memoizedState=a,e.baseState=s,e.baseQueue=c,n.lastRenderedState=a}return null===r&&(n.lanes=0),[e.memoizedState,n.dispatch]}function qa(e){var t=Fa(),i=t.queue;if(null===i)throw Error(o(311));i.lastRenderedReducer=e;var n=i.dispatch,r=i.pending,a=t.memoizedState;if(null!==r){i.pending=null;var s=r=r.next;do{a=e(a,s.action),s=s.next}while(s!==r);Yi(a,t.memoizedState)||(Ms=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),i.lastRenderedState=a}return[a,n]}function Xa(e,t,i){var n=ba,r=Fa(),a=ar;if(a){if(void 0===i)throw Error(o(407));i=i()}else i=t();var s=!Yi((xa||r).memoizedState,i);if(s&&(r.memoizedState=i,Ms=!0),r=r.queue,vo(2048,8,Ka.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==wa&&1&wa.memoizedState.tag){if(n.flags|=2048,fo(9,{destroy:void 0,resource:void 0},Qa.bind(null,n,r,i,t),null),null===nc)throw Error(o(349));a||0!==(124&ya)||Ya(n,t,i)}return i}function Ya(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},null===(t=ba.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},ba.updateQueue=t,t.stores=[e]):null===(i=t.stores)?t.stores=[e]:i.push(e)}function Qa(e,t,i,n){t.value=i,t.getSnapshot=n,Za(t)&&Ja(e)}function Ka(e,t,i){return i(function(){Za(t)&&Ja(e)})}function Za(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!Yi(e,i)}catch(n){return!0}}function Ja(e){var t=On(e,2);null!==t&&Lc(t,e,2)}function $a(e){var t=Na();if("function"===typeof e){var i=e;if(e=i(),Ca){he(!0);try{i()}finally{he(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wa,lastRenderedState:e},t}function eo(e,t,i,n){return e.baseState=i,Ga(e,xa,"function"===typeof n?n:Wa)}function to(e,t,i,n,r){if(jo(e))throw Error(o(485));if(null!==(e=t.action)){var a={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){a.listeners.push(e)}};null!==R.T?i(!0):a.isTransition=!1,n(a),null===(i=t.pending)?(a.next=t.pending=a,io(t,a)):(a.next=i.next,t.pending=i.next=a)}}function io(e,t){var i=t.action,n=t.payload,r=e.state;if(t.isTransition){var a=R.T,o={};R.T=o;try{var s=i(r,n),l=R.S;null!==l&&l(o,s),no(e,t,s)}catch(c){ao(e,t,c)}finally{R.T=a}}else try{no(e,t,a=i(r,n))}catch(d){ao(e,t,d)}}function no(e,t,i){null!==i&&"object"===typeof i&&"function"===typeof i.then?i.then(function(i){ro(e,t,i)},function(i){return ao(e,t,i)}):ro(e,t,i)}function ro(e,t,i){t.status="fulfilled",t.value=i,oo(t),e.state=i,null!==(t=e.pending)&&((i=t.next)===t?e.pending=null:(i=i.next,t.next=i,io(e,i)))}function ao(e,t,i){var n=e.pending;if(e.pending=null,null!==n){n=n.next;do{t.status="rejected",t.reason=i,oo(t),t=t.next}while(t!==n)}e.action=null}function oo(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function so(e,t){return t}function lo(e,t){if(ar){var i=nc.formState;if(null!==i){e:{var n=ba;if(ar){if(rr){t:{for(var r=rr,a=sr;8!==r.nodeType;){if(!a){r=null;break t}if(null===(r=vu(r.nextSibling))){r=null;break t}}r="F!"===(a=r.data)||"F"===a?r:null}if(r){rr=vu(r.nextSibling),n="F!"===r.data;break e}}cr(n)}n=!1}n&&(t=i[0])}}return(i=Na()).memoizedState=i.baseState=t,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:so,lastRenderedState:t},i.queue=n,i=Fo.bind(null,ba,n),n.dispatch=i,n=$a(!1),a=Vo.bind(null,ba,!1,n.queue),r={state:t,dispatch:null,action:e,pending:null},(n=Na()).queue=r,i=to.bind(null,ba,r,a,i),r.dispatch=i,n.memoizedState=e,[t,i,!1]}function co(e){return uo(Fa(),xa,e)}function uo(e,t,i){if(t=Ga(e,t,so)[0],e=Ha(Wa)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var n=Ua(t)}catch(o){if(o===Gr)throw Xr;throw o}else n=t;var r=(t=Fa()).queue,a=r.dispatch;return i!==t.memoizedState&&(ba.flags|=2048,fo(9,{destroy:void 0,resource:void 0},ho.bind(null,r,i),null)),[n,a,e]}function ho(e,t){e.action=t}function po(e){var t=Fa(),i=xa;if(null!==i)return uo(t,i,e);Fa(),t=t.memoizedState;var n=(i=Fa()).queue.dispatch;return i.memoizedState=e,[t,n,!1]}function fo(e,t,i,n){return e={tag:e,create:i,deps:n,inst:t,next:null},null===(t=ba.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},ba.updateQueue=t),null===(i=t.lastEffect)?t.lastEffect=e.next=e:(n=i.next,i.next=e,e.next=n,t.lastEffect=e),e}function mo(){return Fa().memoizedState}function go(e,t,i,n){var r=Na();n=void 0===n?null:n,ba.flags|=e,r.memoizedState=fo(1|t,{destroy:void 0,resource:void 0},i,n)}function vo(e,t,i,n){var r=Fa();n=void 0===n?null:n;var a=r.memoizedState.inst;null!==xa&&null!==n&&Da(n,xa.memoizedState.deps)?r.memoizedState=fo(t,a,i,n):(ba.flags|=e,r.memoizedState=fo(1|t,a,i,n))}function yo(e,t){go(8390656,8,e,t)}function bo(e,t){vo(2048,8,e,t)}function xo(e,t){return vo(4,2,e,t)}function wo(e,t){return vo(4,4,e,t)}function So(e,t){if("function"===typeof t){e=e();var i=t(e);return function(){"function"===typeof i?i():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function _o(e,t,i){i=null!==i&&void 0!==i?i.concat([e]):null,vo(4,4,So.bind(null,t,e),i)}function Co(){}function Eo(e,t){var i=Fa();t=void 0===t?null:t;var n=i.memoizedState;return null!==t&&Da(t,n[1])?n[0]:(i.memoizedState=[e,t],e)}function Ao(e,t){var i=Fa();t=void 0===t?null:t;var n=i.memoizedState;if(null!==t&&Da(t,n[1]))return n[0];if(n=e(),Ca){he(!0);try{e()}finally{he(!1)}}return i.memoizedState=[n,t],n}function Mo(e,t,i){return void 0===i||0!==(1073741824&ya)?e.memoizedState=t:(e.memoizedState=i,e=zc(),ba.lanes|=e,pc|=e,i)}function To(e,t,i,n){return Yi(i,t)?i:null!==pa.current?(e=Mo(e,i,n),Yi(e,t)||(Ms=!0),e):0===(42&ya)?(Ms=!0,e.memoizedState=i):(e=zc(),ba.lanes|=e,pc|=e,t)}function Po(e,t,i,n,r){var a=z.p;z.p=0!==a&&8>a?a:8;var o=R.T,s={};R.T=s,Vo(e,!1,t,i);try{var l=r(),c=R.S;if(null!==c&&c(s,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)Uo(e,t,function(e,t){var i=[],n={status:"pending",value:null,reason:null,then:function(e){i.push(e)}};return e.then(function(){n.status="fulfilled",n.value=t;for(var e=0;e<i.length;e++)(0,i[e])(t)},function(e){for(n.status="rejected",n.reason=e,e=0;e<i.length;e++)(0,i[e])(void 0)}),n}(l,n),Rc());else Uo(e,t,n,Rc())}catch(d){Uo(e,t,{then:function(){},status:"rejected",reason:d},Rc())}finally{z.p=a,R.T=o}}function Do(){}function Oo(e,t,i,n){if(5!==e.tag)throw Error(o(476));var r=Io(e).queue;Po(e,r,t,L,null===i?Do:function(){return ko(e),i(n)})}function Io(e){var t=e.memoizedState;if(null!==t)return t;var i={};return(t={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wa,lastRenderedState:L},next:null}).next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wa,lastRenderedState:i},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function ko(e){Uo(e,Io(e).next.queue,{},Rc())}function Ro(){return Ar(Yu)}function zo(){return Fa().memoizedState}function Lo(){return Fa().memoizedState}function Bo(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var i=Rc(),n=aa(t,e=ra(i),i);return null!==n&&(Lc(n,t,i),oa(n,t,i)),t={cache:kr()},void(e.payload=t)}t=t.return}}function No(e,t,i){var n=Rc();i={lane:n,revertLane:0,action:i,hasEagerState:!1,eagerState:null,next:null},jo(e)?Wo(t,i):null!==(i=Dn(e,t,i,n))&&(Lc(i,e,n),Ho(i,t,n))}function Fo(e,t,i){Uo(e,t,i,Rc())}function Uo(e,t,i,n){var r={lane:n,revertLane:0,action:i,hasEagerState:!1,eagerState:null,next:null};if(jo(e))Wo(t,r);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,i);if(r.hasEagerState=!0,r.eagerState=s,Yi(s,o))return Pn(e,t,r,0),null===nc&&Tn(),!1}catch(l){}if(null!==(i=Dn(e,t,r,n)))return Lc(i,e,n),Ho(i,t,n),!0}return!1}function Vo(e,t,i,n){if(n={lane:2,revertLane:Pd(),action:n,hasEagerState:!1,eagerState:null,next:null},jo(e)){if(t)throw Error(o(479))}else null!==(t=Dn(e,i,n,2))&&Lc(t,e,2)}function jo(e){var t=e.alternate;return e===ba||null!==t&&t===ba}function Wo(e,t){_a=Sa=!0;var i=e.pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function Ho(e,t,i){if(0!==(4194048&i)){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,Me(e,i)}}var Go={readContext:Ar,use:Va,useCallback:Pa,useContext:Pa,useEffect:Pa,useImperativeHandle:Pa,useLayoutEffect:Pa,useInsertionEffect:Pa,useMemo:Pa,useReducer:Pa,useRef:Pa,useState:Pa,useDebugValue:Pa,useDeferredValue:Pa,useTransition:Pa,useSyncExternalStore:Pa,useId:Pa,useHostTransitionStatus:Pa,useFormState:Pa,useActionState:Pa,useOptimistic:Pa,useMemoCache:Pa,useCacheRefresh:Pa},qo={readContext:Ar,use:Va,useCallback:function(e,t){return Na().memoizedState=[e,void 0===t?null:t],e},useContext:Ar,useEffect:yo,useImperativeHandle:function(e,t,i){i=null!==i&&void 0!==i?i.concat([e]):null,go(4194308,4,So.bind(null,t,e),i)},useLayoutEffect:function(e,t){return go(4194308,4,e,t)},useInsertionEffect:function(e,t){go(4,2,e,t)},useMemo:function(e,t){var i=Na();t=void 0===t?null:t;var n=e();if(Ca){he(!0);try{e()}finally{he(!1)}}return i.memoizedState=[n,t],n},useReducer:function(e,t,i){var n=Na();if(void 0!==i){var r=i(t);if(Ca){he(!0);try{i(t)}finally{he(!1)}}}else r=t;return n.memoizedState=n.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},n.queue=e,e=e.dispatch=No.bind(null,ba,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Na().memoizedState=e},useState:function(e){var t=(e=$a(e)).queue,i=Fo.bind(null,ba,t);return t.dispatch=i,[e.memoizedState,i]},useDebugValue:Co,useDeferredValue:function(e,t){return Mo(Na(),e,t)},useTransition:function(){var e=$a(!1);return e=Po.bind(null,ba,e.queue,!0,!1),Na().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,i){var n=ba,r=Na();if(ar){if(void 0===i)throw Error(o(407));i=i()}else{if(i=t(),null===nc)throw Error(o(349));0!==(124&ac)||Ya(n,t,i)}r.memoizedState=i;var a={value:i,getSnapshot:t};return r.queue=a,yo(Ka.bind(null,n,a,e),[e]),n.flags|=2048,fo(9,{destroy:void 0,resource:void 0},Qa.bind(null,n,a,i,t),null),i},useId:function(){var e=Na(),t=nc.identifierPrefix;if(ar){var i=Jn;t="\xab"+t+"R"+(i=(Zn&~(1<<32-pe(Zn)-1)).toString(32)+i),0<(i=Ea++)&&(t+="H"+i.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(i=Ta++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Ro,useFormState:lo,useActionState:lo,useOptimistic:function(e){var t=Na();t.memoizedState=t.baseState=e;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=i,t=Vo.bind(null,ba,!0,i),i.dispatch=t,[e,t]},useMemoCache:ja,useCacheRefresh:function(){return Na().memoizedState=Bo.bind(null,ba)}},Xo={readContext:Ar,use:Va,useCallback:Eo,useContext:Ar,useEffect:bo,useImperativeHandle:_o,useInsertionEffect:xo,useLayoutEffect:wo,useMemo:Ao,useReducer:Ha,useRef:mo,useState:function(){return Ha(Wa)},useDebugValue:Co,useDeferredValue:function(e,t){return To(Fa(),xa.memoizedState,e,t)},useTransition:function(){var e=Ha(Wa)[0],t=Fa().memoizedState;return["boolean"===typeof e?e:Ua(e),t]},useSyncExternalStore:Xa,useId:zo,useHostTransitionStatus:Ro,useFormState:co,useActionState:co,useOptimistic:function(e,t){return eo(Fa(),0,e,t)},useMemoCache:ja,useCacheRefresh:Lo},Yo={readContext:Ar,use:Va,useCallback:Eo,useContext:Ar,useEffect:bo,useImperativeHandle:_o,useInsertionEffect:xo,useLayoutEffect:wo,useMemo:Ao,useReducer:qa,useRef:mo,useState:function(){return qa(Wa)},useDebugValue:Co,useDeferredValue:function(e,t){var i=Fa();return null===xa?Mo(i,e,t):To(i,xa.memoizedState,e,t)},useTransition:function(){var e=qa(Wa)[0],t=Fa().memoizedState;return["boolean"===typeof e?e:Ua(e),t]},useSyncExternalStore:Xa,useId:zo,useHostTransitionStatus:Ro,useFormState:po,useActionState:po,useOptimistic:function(e,t){var i=Fa();return null!==xa?eo(i,0,e,t):(i.baseState=e,[e,i.queue.dispatch])},useMemoCache:ja,useCacheRefresh:Lo},Qo=null,Ko=0;function Zo(e){var t=Ko;return Ko+=1,null===Qo&&(Qo=[]),Zr(Qo,e,t)}function Jo(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function $o(e,t){if(t.$$typeof===p)throw Error(o(525));throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function es(e){return(0,e._init)(e._payload)}function ts(e){function t(t,i){if(e){var n=t.deletions;null===n?(t.deletions=[i],t.flags|=16):n.push(i)}}function i(i,n){if(!e)return null;for(;null!==n;)t(i,n),n=n.sibling;return null}function n(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(e,t){return(e=Nn(e,t)).index=0,e.sibling=null,e}function a(t,i,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<i?(t.flags|=67108866,i):n:(t.flags|=67108866,i):(t.flags|=1048576,i)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,i,n){return null===t||6!==t.tag?((t=jn(i,e.mode,n)).return=e,t):((t=r(t,i)).return=e,t)}function c(e,t,i,n){var a=i.type;return a===g?u(e,t,i.props.children,n,i.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===A&&es(a)===t.type)?(Jo(t=r(t,i.props),i),t.return=e,t):(Jo(t=Un(i.type,i.key,i.props,null,e.mode,n),i),t.return=e,t)}function d(e,t,i,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=Wn(i,e.mode,n)).return=e,t):((t=r(t,i.children||[])).return=e,t)}function u(e,t,i,n,a){return null===t||7!==t.tag?((t=Vn(i,e.mode,n,a)).return=e,t):((t=r(t,i)).return=e,t)}function h(e,t,i){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=jn(""+t,e.mode,i)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case f:return Jo(i=Un(t.type,t.key,t.props,null,e.mode,i),t),i.return=e,i;case m:return(t=Wn(t,e.mode,i)).return=e,t;case A:return h(e,t=(0,t._init)(t._payload),i)}if(k(t)||D(t))return(t=Vn(t,e.mode,i,null)).return=e,t;if("function"===typeof t.then)return h(e,Zo(t),i);if(t.$$typeof===w)return h(e,Mr(e,t),i);$o(e,t)}return null}function p(e,t,i,n){var r=null!==t?t.key:null;if("string"===typeof i&&""!==i||"number"===typeof i||"bigint"===typeof i)return null!==r?null:l(e,t,""+i,n);if("object"===typeof i&&null!==i){switch(i.$$typeof){case f:return i.key===r?c(e,t,i,n):null;case m:return i.key===r?d(e,t,i,n):null;case A:return p(e,t,i=(r=i._init)(i._payload),n)}if(k(i)||D(i))return null!==r?null:u(e,t,i,n,null);if("function"===typeof i.then)return p(e,t,Zo(i),n);if(i.$$typeof===w)return p(e,t,Mr(e,i),n);$o(e,i)}return null}function v(e,t,i,n,r){if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return l(t,e=e.get(i)||null,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case f:return c(t,e=e.get(null===n.key?i:n.key)||null,n,r);case m:return d(t,e=e.get(null===n.key?i:n.key)||null,n,r);case A:return v(e,t,i,n=(0,n._init)(n._payload),r)}if(k(n)||D(n))return u(t,e=e.get(i)||null,n,r,null);if("function"===typeof n.then)return v(e,t,i,Zo(n),r);if(n.$$typeof===w)return v(e,t,i,Mr(t,n),r);$o(t,n)}return null}function y(l,c,d,u){if("object"===typeof d&&null!==d&&d.type===g&&null===d.key&&(d=d.props.children),"object"===typeof d&&null!==d){switch(d.$$typeof){case f:e:{for(var b=d.key;null!==c;){if(c.key===b){if((b=d.type)===g){if(7===c.tag){i(l,c.sibling),(u=r(c,d.props.children)).return=l,l=u;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===A&&es(b)===c.type){i(l,c.sibling),Jo(u=r(c,d.props),d),u.return=l,l=u;break e}i(l,c);break}t(l,c),c=c.sibling}d.type===g?((u=Vn(d.props.children,l.mode,u,d.key)).return=l,l=u):(Jo(u=Un(d.type,d.key,d.props,null,l.mode,u),d),u.return=l,l=u)}return s(l);case m:e:{for(b=d.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){i(l,c.sibling),(u=r(c,d.children||[])).return=l,l=u;break e}i(l,c);break}t(l,c),c=c.sibling}(u=Wn(d,l.mode,u)).return=l,l=u}return s(l);case A:return y(l,c,d=(b=d._init)(d._payload),u)}if(k(d))return function(r,o,s,l){for(var c=null,d=null,u=o,f=o=0,m=null;null!==u&&f<s.length;f++){u.index>f?(m=u,u=null):m=u.sibling;var g=p(r,u,s[f],l);if(null===g){null===u&&(u=m);break}e&&u&&null===g.alternate&&t(r,u),o=a(g,o,f),null===d?c=g:d.sibling=g,d=g,u=m}if(f===s.length)return i(r,u),ar&&$n(r,f),c;if(null===u){for(;f<s.length;f++)null!==(u=h(r,s[f],l))&&(o=a(u,o,f),null===d?c=u:d.sibling=u,d=u);return ar&&$n(r,f),c}for(u=n(u);f<s.length;f++)null!==(m=v(u,r,f,s[f],l))&&(e&&null!==m.alternate&&u.delete(null===m.key?f:m.key),o=a(m,o,f),null===d?c=m:d.sibling=m,d=m);return e&&u.forEach(function(e){return t(r,e)}),ar&&$n(r,f),c}(l,c,d,u);if(D(d)){if("function"!==typeof(b=D(d)))throw Error(o(150));return function(r,s,l,c){if(null==l)throw Error(o(151));for(var d=null,u=null,f=s,m=s=0,g=null,y=l.next();null!==f&&!y.done;m++,y=l.next()){f.index>m?(g=f,f=null):g=f.sibling;var b=p(r,f,y.value,c);if(null===b){null===f&&(f=g);break}e&&f&&null===b.alternate&&t(r,f),s=a(b,s,m),null===u?d=b:u.sibling=b,u=b,f=g}if(y.done)return i(r,f),ar&&$n(r,m),d;if(null===f){for(;!y.done;m++,y=l.next())null!==(y=h(r,y.value,c))&&(s=a(y,s,m),null===u?d=y:u.sibling=y,u=y);return ar&&$n(r,m),d}for(f=n(f);!y.done;m++,y=l.next())null!==(y=v(f,r,m,y.value,c))&&(e&&null!==y.alternate&&f.delete(null===y.key?m:y.key),s=a(y,s,m),null===u?d=y:u.sibling=y,u=y);return e&&f.forEach(function(e){return t(r,e)}),ar&&$n(r,m),d}(l,c,d=b.call(d),u)}if("function"===typeof d.then)return y(l,c,Zo(d),u);if(d.$$typeof===w)return y(l,c,Mr(l,d),u);$o(l,d)}return"string"===typeof d&&""!==d||"number"===typeof d||"bigint"===typeof d?(d=""+d,null!==c&&6===c.tag?(i(l,c.sibling),(u=r(c,d)).return=l,l=u):(i(l,c),(u=jn(d,l.mode,u)).return=l,l=u),s(l)):i(l,c)}return function(e,t,i,n){try{Ko=0;var r=y(e,t,i,n);return Qo=null,r}catch(o){if(o===Gr||o===Xr)throw o;var a=Ln(29,o,null,e.mode);return a.lanes=n,a.return=e,a}}}var is=ts(!0),ns=ts(!1),rs=F(null),as=null;function os(e){var t=e.alternate;V(ds,1&ds.current),V(rs,e),null===as&&(null===t||null!==pa.current||null!==t.memoizedState)&&(as=e)}function ss(e){if(22===e.tag){if(V(ds,ds.current),V(rs,e),null===as){var t=e.alternate;null!==t&&null!==t.memoizedState&&(as=e)}}else ls()}function ls(){V(ds,ds.current),V(rs,rs.current)}function cs(e){U(rs),as===e&&(as=null),U(ds)}var ds=F(0);function us(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||gu(i)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function hs(e,t,i,n){i=null===(i=i(n,t=e.memoizedState))||void 0===i?t:h({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}var ps={enqueueSetState:function(e,t,i){e=e._reactInternals;var n=Rc(),r=ra(n);r.payload=t,void 0!==i&&null!==i&&(r.callback=i),null!==(t=aa(e,r,n))&&(Lc(t,e,n),oa(t,e,n))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var n=Rc(),r=ra(n);r.tag=1,r.payload=t,void 0!==i&&null!==i&&(r.callback=i),null!==(t=aa(e,r,n))&&(Lc(t,e,n),oa(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=Rc(),n=ra(i);n.tag=2,void 0!==t&&null!==t&&(n.callback=t),null!==(t=aa(e,n,i))&&(Lc(t,e,i),oa(t,e,i))}};function fs(e,t,i,n,r,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!Qi(i,n)||!Qi(r,a))}function ms(e,t,i,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&ps.enqueueReplaceState(t,t.state,null)}function gs(e,t){var i=t;if("ref"in t)for(var n in i={},t)"ref"!==n&&(i[n]=t[n]);if(e=e.defaultProps)for(var r in i===t&&(i=h({},i)),e)void 0===i[r]&&(i[r]=e[r]);return i}var vs="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function ys(e){vs(e)}function bs(e){console.error(e)}function xs(e){vs(e)}function ws(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Ss(e,t,i){try{(0,e.onCaughtError)(i.value,{componentStack:i.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(n){setTimeout(function(){throw n})}}function _s(e,t,i){return(i=ra(i)).tag=3,i.payload={element:null},i.callback=function(){ws(e,t)},i}function Cs(e){return(e=ra(e)).tag=3,e}function Es(e,t,i,n){var r=i.type.getDerivedStateFromError;if("function"===typeof r){var a=n.value;e.payload=function(){return r(a)},e.callback=function(){Ss(t,i,n)}}var o=i.stateNode;null!==o&&"function"===typeof o.componentDidCatch&&(e.callback=function(){Ss(t,i,n),"function"!==typeof r&&(null===Cc?Cc=new Set([this]):Cc.add(this));var e=n.stack;this.componentDidCatch(n.value,{componentStack:null!==e?e:""})})}var As=Error(o(461)),Ms=!1;function Ts(e,t,i,n){t.child=null===e?ns(t,null,i,n):is(t,e.child,i,n)}function Ps(e,t,i,n,r){i=i.render;var a=t.ref;if("ref"in n){var o={};for(var s in n)"ref"!==s&&(o[s]=n[s])}else o=n;return Er(t),n=Oa(e,t,i,o,a,r),s=za(),null===e||Ms?(ar&&s&&tr(t),t.flags|=1,Ts(e,t,n,r),t.child):(La(e,t,r),Qs(e,t,r))}function Ds(e,t,i,n,r){if(null===e){var a=i.type;return"function"!==typeof a||Bn(a)||void 0!==a.defaultProps||null!==i.compare?((e=Un(i.type,null,n,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Os(e,t,a,n,r))}if(a=e.child,!Ks(e,r)){var o=a.memoizedProps;if((i=null!==(i=i.compare)?i:Qi)(o,n)&&e.ref===t.ref)return Qs(e,t,r)}return t.flags|=1,(e=Nn(a,n)).ref=t.ref,e.return=t,t.child=e}function Os(e,t,i,n,r){if(null!==e){var a=e.memoizedProps;if(Qi(a,n)&&e.ref===t.ref){if(Ms=!1,t.pendingProps=n=a,!Ks(e,r))return t.lanes=e.lanes,Qs(e,t,r);0!==(131072&e.flags)&&(Ms=!0)}}return zs(e,t,i,n,r)}function Is(e,t,i){var n=t.pendingProps,r=n.children,a=null!==e?e.memoizedState:null;if("hidden"===n.mode){if(0!==(128&t.flags)){if(n=null!==a?a.baseLanes|i:i,null!==e){for(r=t.child=e.child,a=0;null!==r;)a=a|r.lanes|r.childLanes,r=r.sibling;t.childLanes=a&~n}else t.childLanes=0,t.child=null;return ks(e,t,n,i)}if(0===(536870912&i))return t.lanes=t.childLanes=536870912,ks(e,t,null!==a?a.baseLanes|i:i,i);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Wr(0,null!==a?a.cachePool:null),null!==a?ma(t,a):ga(),ss(t)}else null!==a?(Wr(0,a.cachePool),ma(t,a),ls(),t.memoizedState=null):(null!==e&&Wr(0,null),ga(),ls());return Ts(e,t,r,i),t.child}function ks(e,t,i,n){var r=jr();return r=null===r?null:{parent:Ir._currentValue,pool:r},t.memoizedState={baseLanes:i,cachePool:r},null!==e&&Wr(0,null),ga(),ss(t),null!==e&&_r(e,t,n,!0),null}function Rs(e,t){var i=t.ref;if(null===i)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof i&&"object"!==typeof i)throw Error(o(284));null!==e&&e.ref===i||(t.flags|=4194816)}}function zs(e,t,i,n,r){return Er(t),i=Oa(e,t,i,n,void 0,r),n=za(),null===e||Ms?(ar&&n&&tr(t),t.flags|=1,Ts(e,t,i,r),t.child):(La(e,t,r),Qs(e,t,r))}function Ls(e,t,i,n,r,a){return Er(t),t.updateQueue=null,i=ka(t,n,i,r),Ia(e),n=za(),null===e||Ms?(ar&&n&&tr(t),t.flags|=1,Ts(e,t,i,a),t.child):(La(e,t,a),Qs(e,t,a))}function Bs(e,t,i,n,r){if(Er(t),null===t.stateNode){var a=Rn,o=i.contextType;"object"===typeof o&&null!==o&&(a=Ar(o)),a=new i(n,a),t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,a.updater=ps,t.stateNode=a,a._reactInternals=t,(a=t.stateNode).props=n,a.state=t.memoizedState,a.refs={},ia(t),o=i.contextType,a.context="object"===typeof o&&null!==o?Ar(o):Rn,a.state=t.memoizedState,"function"===typeof(o=i.getDerivedStateFromProps)&&(hs(t,i,o,n),a.state=t.memoizedState),"function"===typeof i.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(o=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),o!==a.state&&ps.enqueueReplaceState(a,a.state,null),da(t,n,a,r),ca(),a.state=t.memoizedState),"function"===typeof a.componentDidMount&&(t.flags|=4194308),n=!0}else if(null===e){a=t.stateNode;var s=t.memoizedProps,l=gs(i,s);a.props=l;var c=a.context,d=i.contextType;o=Rn,"object"===typeof d&&null!==d&&(o=Ar(d));var u=i.getDerivedStateFromProps;d="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate,s=t.pendingProps!==s,d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s||c!==o)&&ms(t,a,n,o),ta=!1;var h=t.memoizedState;a.state=h,da(t,n,a,r),ca(),c=t.memoizedState,s||h!==c||ta?("function"===typeof u&&(hs(t,i,u,n),c=t.memoizedState),(l=ta||fs(t,i,l,n,h,c,o))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=o,n=l):("function"===typeof a.componentDidMount&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,na(e,t),d=gs(i,o=t.memoizedProps),a.props=d,u=t.pendingProps,h=a.context,c=i.contextType,l=Rn,"object"===typeof c&&null!==c&&(l=Ar(c)),(c="function"===typeof(s=i.getDerivedStateFromProps)||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==u||h!==l)&&ms(t,a,n,l),ta=!1,h=t.memoizedState,a.state=h,da(t,n,a,r),ca();var p=t.memoizedState;o!==u||h!==p||ta||null!==e&&null!==e.dependencies&&Cr(e.dependencies)?("function"===typeof s&&(hs(t,i,s,n),p=t.memoizedState),(d=ta||fs(t,i,d,n,h,p,l)||null!==e&&null!==e.dependencies&&Cr(e.dependencies))?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(n,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(n,p,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),a.props=n,a.state=p,a.context=l,n=d):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return a=n,Rs(e,t),n=0!==(128&t.flags),a||n?(a=t.stateNode,i=n&&"function"!==typeof i.getDerivedStateFromError?null:a.render(),t.flags|=1,null!==e&&n?(t.child=is(t,e.child,null,r),t.child=is(t,null,i,r)):Ts(e,t,i,r),t.memoizedState=a.state,e=t.child):e=Qs(e,t,r),e}function Ns(e,t,i,n){return pr(),t.flags|=256,Ts(e,t,i,n),t.child}var Fs={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Us(e){return{baseLanes:e,cachePool:Hr()}}function Vs(e,t,i){return e=null!==e?e.childLanes&~i:0,t&&(e|=gc),e}function js(e,t,i){var n,r=t.pendingProps,a=!1,s=0!==(128&t.flags);if((n=s)||(n=(null===e||null!==e.memoizedState)&&0!==(2&ds.current)),n&&(a=!0,t.flags&=-129),n=0!==(32&t.flags),t.flags&=-33,null===e){if(ar){if(a?os(t):ls(),ar){var l,c=rr;if(l=c){e:{for(l=c,c=sr;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=vu(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Kn?{id:Zn,overflow:Jn}:null,retryLane:536870912,hydrationErrors:null},(l=Ln(18,null,null,0)).stateNode=c,l.return=t,t.child=l,nr=t,rr=null,l=!0):l=!1}l||cr(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return gu(c)?t.lanes=32:t.lanes=536870912,null;cs(t)}return c=r.children,r=r.fallback,a?(ls(),c=Hs({mode:"hidden",children:c},a=t.mode),r=Vn(r,a,i,null),c.return=t,r.return=t,c.sibling=r,t.child=c,(a=t.child).memoizedState=Us(i),a.childLanes=Vs(e,n,i),t.memoizedState=Fs,r):(os(t),Ws(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(s)256&t.flags?(os(t),t.flags&=-257,t=Gs(e,t,i)):null!==t.memoizedState?(ls(),t.child=e.child,t.flags|=128,t=null):(ls(),a=r.fallback,c=t.mode,r=Hs({mode:"visible",children:r.children},c),(a=Vn(a,c,i,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,is(t,e.child,null,i),(r=t.child).memoizedState=Us(i),r.childLanes=Vs(e,n,i),t.memoizedState=Fs,t=a);else if(os(t),gu(c)){if(n=c.nextSibling&&c.nextSibling.dataset)var d=n.dgst;n=d,(r=Error(o(419))).stack="",r.digest=n,mr({value:r,source:null,stack:null}),t=Gs(e,t,i)}else if(Ms||_r(e,t,i,!1),n=0!==(i&e.childLanes),Ms||n){if(null!==(n=nc)&&(0!==(r=0!==((r=0!==(42&(r=i&-i))?1:Te(r))&(n.suspendedLanes|i))?0:r)&&r!==l.retryLane))throw l.retryLane=r,On(e,r),Lc(n,e,r),As;"$?"===c.data||Xc(),t=Gs(e,t,i)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,rr=vu(c.nextSibling),nr=t,ar=!0,or=null,sr=!1,null!==e&&(Yn[Qn++]=Zn,Yn[Qn++]=Jn,Yn[Qn++]=Kn,Zn=e.id,Jn=e.overflow,Kn=t),(t=Ws(t,r.children)).flags|=4096);return t}return a?(ls(),a=r.fallback,c=t.mode,d=(l=e.child).sibling,(r=Nn(l,{mode:"hidden",children:r.children})).subtreeFlags=65011712&l.subtreeFlags,null!==d?a=Nn(d,a):(a=Vn(a,c,i,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,null===(c=e.child.memoizedState)?c=Us(i):(null!==(l=c.cachePool)?(d=Ir._currentValue,l=l.parent!==d?{parent:d,pool:d}:l):l=Hr(),c={baseLanes:c.baseLanes|i,cachePool:l}),a.memoizedState=c,a.childLanes=Vs(e,n,i),t.memoizedState=Fs,r):(os(t),e=(i=e.child).sibling,(i=Nn(i,{mode:"visible",children:r.children})).return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i)}function Ws(e,t){return(t=Hs({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Hs(e,t){return(e=Ln(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Gs(e,t,i){return is(t,e.child,null,i),(e=Ws(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function qs(e,t,i){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),wr(e.return,t,i)}function Xs(e,t,i,n,r){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=i,a.tailMode=r)}function Ys(e,t,i){var n=t.pendingProps,r=n.revealOrder,a=n.tail;if(Ts(e,t,n.children,i),0!==(2&(n=ds.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&qs(e,i,t);else if(19===e.tag)qs(e,i,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}switch(V(ds,n),r){case"forwards":for(i=t.child,r=null;null!==i;)null!==(e=i.alternate)&&null===us(e)&&(r=i),i=i.sibling;null===(i=r)?(r=t.child,t.child=null):(r=i.sibling,i.sibling=null),Xs(t,!1,r,i,a);break;case"backwards":for(i=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===us(e)){t.child=r;break}e=r.sibling,r.sibling=i,i=r,r=e}Xs(t,!0,i,null,a);break;case"together":Xs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Qs(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),pc|=t.lanes,0===(i&t.childLanes)){if(null===e)return null;if(_r(e,t,i,!1),0===(i&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(i=Nn(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=Nn(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function Ks(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Cr(e))}function Zs(e,t,i){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ms=!0;else{if(!Ks(e,i)&&0===(128&t.flags))return Ms=!1,function(e,t,i){switch(t.tag){case 3:q(t,t.stateNode.containerInfo),br(0,Ir,e.memoizedState.cache),pr();break;case 27:case 5:Y(t);break;case 4:q(t,t.stateNode.containerInfo);break;case 10:br(0,t.type,t.memoizedProps.value);break;case 13:var n=t.memoizedState;if(null!==n)return null!==n.dehydrated?(os(t),t.flags|=128,null):0!==(i&t.child.childLanes)?js(e,t,i):(os(t),null!==(e=Qs(e,t,i))?e.sibling:null);os(t);break;case 19:var r=0!==(128&e.flags);if((n=0!==(i&t.childLanes))||(_r(e,t,i,!1),n=0!==(i&t.childLanes)),r){if(n)return Ys(e,t,i);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),V(ds,ds.current),n)break;return null;case 22:case 23:return t.lanes=0,Is(e,t,i);case 24:br(0,Ir,e.memoizedState.cache)}return Qs(e,t,i)}(e,t,i);Ms=0!==(131072&e.flags)}else Ms=!1,ar&&0!==(1048576&t.flags)&&er(t,Xn,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var n=t.elementType,r=n._init;if(n=r(n._payload),t.type=n,"function"!==typeof n){if(void 0!==n&&null!==n){if((r=n.$$typeof)===S){t.tag=11,t=Ps(null,t,n,e,i);break e}if(r===E){t.tag=14,t=Ds(null,t,n,e,i);break e}}throw t=I(n)||n,Error(o(306,t,""))}Bn(n)?(e=gs(n,e),t.tag=1,t=Bs(null,t,n,e,i)):(t.tag=0,t=zs(null,t,n,e,i))}return t;case 0:return zs(e,t,t.type,t.pendingProps,i);case 1:return Bs(e,t,n=t.type,r=gs(n,t.pendingProps),i);case 3:e:{if(q(t,t.stateNode.containerInfo),null===e)throw Error(o(387));n=t.pendingProps;var a=t.memoizedState;r=a.element,na(e,t),da(t,n,null,i);var s=t.memoizedState;if(n=s.cache,br(0,Ir,n),n!==a.cache&&Sr(t,[Ir],i,!0),ca(),n=s.element,a.isDehydrated){if(a={element:n,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Ns(e,t,n,i);break e}if(n!==r){mr(r=Cn(Error(o(424)),t)),t=Ns(e,t,n,i);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(rr=vu(e.firstChild),nr=t,ar=!0,or=null,sr=!0,i=ns(t,null,n,i),t.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(pr(),n===r){t=Qs(e,t,i);break e}Ts(e,t,n,i)}t=t.child}return t;case 26:return Rs(e,t),null===e?(i=Tu(t.type,null,t.pendingProps,null))?t.memoizedState=i:ar||(i=t.type,e=t.pendingProps,(n=nu(H.current).createElement(i))[Ie]=t,n[ke]=e,eu(n,i,e),Ge(n),t.stateNode=n):t.memoizedState=Tu(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Y(t),null===e&&ar&&(n=t.stateNode=xu(t.type,t.pendingProps,H.current),nr=t,sr=!0,r=rr,pu(t.type)?(yu=r,rr=vu(n.firstChild)):rr=r),Ts(e,t,t.pendingProps.children,i),Rs(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ar&&((r=n=rr)&&(null!==(n=function(e,t,i,n){for(;1===e.nodeType;){var r=i;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!n&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(n){if(!e[Fe])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(a=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(a!==r.rel||e.getAttribute("href")!==(null==r.href||""===r.href?null:r.href)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin)||e.getAttribute("title")!==(null==r.title?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((a=e.getAttribute("src"))!==(null==r.src?null:r.src)||e.getAttribute("type")!==(null==r.type?null:r.type)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin))&&a&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var a=null==r.name?null:""+r.name;if("hidden"===r.type&&e.getAttribute("name")===a)return e}if(null===(e=vu(e.nextSibling)))break}return null}(n,t.type,t.pendingProps,sr))?(t.stateNode=n,nr=t,rr=vu(n.firstChild),sr=!1,r=!0):r=!1),r||cr(t)),Y(t),r=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,n=a.children,ou(r,a)?n=null:null!==s&&ou(r,s)&&(t.flags|=32),null!==t.memoizedState&&(r=Oa(e,t,Ra,null,null,i),Yu._currentValue=r),Rs(e,t),Ts(e,t,n,i),t.child;case 6:return null===e&&ar&&((e=i=rr)&&(null!==(i=function(e,t,i){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!i)return null;if(null===(e=vu(e.nextSibling)))return null}return e}(i,t.pendingProps,sr))?(t.stateNode=i,nr=t,rr=null,e=!0):e=!1),e||cr(t)),null;case 13:return js(e,t,i);case 4:return q(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=is(t,null,n,i):Ts(e,t,n,i),t.child;case 11:return Ps(e,t,t.type,t.pendingProps,i);case 7:return Ts(e,t,t.pendingProps,i),t.child;case 8:case 12:return Ts(e,t,t.pendingProps.children,i),t.child;case 10:return n=t.pendingProps,br(0,t.type,n.value),Ts(e,t,n.children,i),t.child;case 9:return r=t.type._context,n=t.pendingProps.children,Er(t),n=n(r=Ar(r)),t.flags|=1,Ts(e,t,n,i),t.child;case 14:return Ds(e,t,t.type,t.pendingProps,i);case 15:return Os(e,t,t.type,t.pendingProps,i);case 19:return Ys(e,t,i);case 31:return n=t.pendingProps,i=t.mode,n={mode:n.mode,children:n.children},null===e?((i=Hs(n,i)).ref=t.ref,t.child=i,i.return=t,t=i):((i=Nn(e.child,n)).ref=t.ref,t.child=i,i.return=t,t=i),t;case 22:return Is(e,t,i);case 24:return Er(t),n=Ar(Ir),null===e?(null===(r=jr())&&(r=nc,a=kr(),r.pooledCache=a,a.refCount++,null!==a&&(r.pooledCacheLanes|=i),r=a),t.memoizedState={parent:n,cache:r},ia(t),br(0,Ir,r)):(0!==(e.lanes&i)&&(na(e,t),da(t,null,null,i),ca()),r=e.memoizedState,a=t.memoizedState,r.parent!==n?(r={parent:n,cache:n},t.memoizedState=r,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=r),br(0,Ir,n)):(n=a.cache,br(0,Ir,n),n!==r.cache&&Sr(t,[Ir],i,!0))),Ts(e,t,t.pendingProps.children,i),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}function Js(e){e.flags|=4}function $s(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!Vu(t)){if(null!==(t=rs.current)&&((4194048&ac)===ac?null!==as:(62914560&ac)!==ac&&0===(536870912&ac)||t!==as))throw Jr=Yr,qr;e.flags|=8192}}function el(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?_e():536870912,e.lanes|=t,vc|=t)}function tl(e,t){if(!ar)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function il(e){var t=null!==e.alternate&&e.alternate.child===e.child,i=0,n=0;if(t)for(var r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=65011712&r.subtreeFlags,n|=65011712&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=i,t}function nl(e,t,i){var n=t.pendingProps;switch(ir(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return il(t),null;case 3:return i=t.stateNode,n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),xr(Ir),X(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(hr(t)?Js(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,fr())),il(t),null;case 26:return i=t.memoizedState,null===e?(Js(t),null!==i?(il(t),$s(t,i)):(il(t),t.flags&=-16777217)):i?i!==e.memoizedState?(Js(t),il(t),$s(t,i)):(il(t),t.flags&=-16777217):(e.memoizedProps!==n&&Js(t),il(t),t.flags&=-16777217),null;case 27:Q(t),i=H.current;var r=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==n&&Js(t);else{if(!n){if(null===t.stateNode)throw Error(o(166));return il(t),null}e=j.current,hr(t)?dr(t):(e=xu(r,n,i),t.stateNode=e,Js(t))}return il(t),null;case 5:if(Q(t),i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==n&&Js(t);else{if(!n){if(null===t.stateNode)throw Error(o(166));return il(t),null}if(e=j.current,hr(t))dr(t);else{switch(r=nu(H.current),e){case 1:e=r.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:e=r.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":e=r.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":e=r.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":(e=r.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof n.is?r.createElement("select",{is:n.is}):r.createElement("select"),n.multiple?e.multiple=!0:n.size&&(e.size=n.size);break;default:e="string"===typeof n.is?r.createElement(i,{is:n.is}):r.createElement(i)}}e[Ie]=t,e[ke]=n;e:for(r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&27!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;null===r.sibling;){if(null===r.return||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}t.stateNode=e;e:switch(eu(e,i,n),i){case"button":case"input":case"select":case"textarea":e=!!n.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Js(t)}}return il(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==n&&Js(t);else{if("string"!==typeof n&&null===t.stateNode)throw Error(o(166));if(e=H.current,hr(t)){if(e=t.stateNode,i=t.memoizedProps,n=null,null!==(r=nr))switch(r.tag){case 27:case 5:n=r.memoizedProps}e[Ie]=t,(e=!!(e.nodeValue===i||null!==n&&!0===n.suppressHydrationWarning||Kd(e.nodeValue,i)))||cr(t)}else(e=nu(e).createTextNode(n))[Ie]=t,t.stateNode=e}return il(t),null;case 13:if(n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(r=hr(t),null!==n&&null!==n.dehydrated){if(null===e){if(!r)throw Error(o(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(o(317));r[Ie]=t}else pr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;il(t),r=!1}else r=fr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return 256&t.flags?(cs(t),t):(cs(t),null)}if(cs(t),0!==(128&t.flags))return t.lanes=i,t;if(i=null!==n,e=null!==e&&null!==e.memoizedState,i){r=null,null!==(n=t.child).alternate&&null!==n.alternate.memoizedState&&null!==n.alternate.memoizedState.cachePool&&(r=n.alternate.memoizedState.cachePool.pool);var a=null;null!==n.memoizedState&&null!==n.memoizedState.cachePool&&(a=n.memoizedState.cachePool.pool),a!==r&&(n.flags|=2048)}return i!==e&&i&&(t.child.flags|=8192),el(t,t.updateQueue),il(t),null;case 4:return X(),null===e&&Ud(t.stateNode.containerInfo),il(t),null;case 10:return xr(t.type),il(t),null;case 19:if(U(ds),null===(r=t.memoizedState))return il(t),null;if(n=0!==(128&t.flags),null===(a=r.rendering))if(n)tl(r,!1);else{if(0!==hc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(a=us(e))){for(t.flags|=128,tl(r,!1),e=a.updateQueue,t.updateQueue=e,el(t,e),t.subtreeFlags=0,e=i,i=t.child;null!==i;)Fn(i,e),i=i.sibling;return V(ds,1&ds.current|2),t.child}e=e.sibling}null!==r.tail&&te()>Sc&&(t.flags|=128,n=!0,tl(r,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=us(a))){if(t.flags|=128,n=!0,e=e.updateQueue,t.updateQueue=e,el(t,e),tl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!a.alternate&&!ar)return il(t),null}else 2*te()-r.renderingStartTime>Sc&&536870912!==i&&(t.flags|=128,n=!0,tl(r,!1),t.lanes=4194304);r.isBackwards?(a.sibling=t.child,t.child=a):(null!==(e=r.last)?e.sibling=a:t.child=a,r.last=a)}return null!==r.tail?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=te(),t.sibling=null,e=ds.current,V(ds,n?1&e|2:1&e),t):(il(t),null);case 22:case 23:return cs(t),va(),n=null!==t.memoizedState,null!==e?null!==e.memoizedState!==n&&(t.flags|=8192):n&&(t.flags|=8192),n?0!==(536870912&i)&&0===(128&t.flags)&&(il(t),6&t.subtreeFlags&&(t.flags|=8192)):il(t),null!==(i=t.updateQueue)&&el(t,i.retryQueue),i=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(i=e.memoizedState.cachePool.pool),n=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(n=t.memoizedState.cachePool.pool),n!==i&&(t.flags|=2048),null!==e&&U(Vr),null;case 24:return i=null,null!==e&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),xr(Ir),il(t),null;case 25:case 30:return null}throw Error(o(156,t.tag))}function rl(e,t){switch(ir(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return xr(Ir),X(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Q(t),null;case 13:if(cs(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));pr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return U(ds),null;case 4:return X(),null;case 10:return xr(t.type),null;case 22:case 23:return cs(t),va(),null!==e&&U(Vr),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return xr(Ir),null;default:return null}}function al(e,t){switch(ir(t),t.tag){case 3:xr(Ir),X();break;case 26:case 27:case 5:Q(t);break;case 4:X();break;case 13:cs(t);break;case 19:U(ds);break;case 10:xr(t.type);break;case 22:case 23:cs(t),va(),null!==e&&U(Vr);break;case 24:xr(Ir)}}function ol(e,t){try{var i=t.updateQueue,n=null!==i?i.lastEffect:null;if(null!==n){var r=n.next;i=r;do{if((i.tag&e)===e){n=void 0;var a=i.create,o=i.inst;n=a(),o.destroy=n}i=i.next}while(i!==r)}}catch(s){dd(t,t.return,s)}}function sl(e,t,i){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var a=r.next;n=a;do{if((n.tag&e)===e){var o=n.inst,s=o.destroy;if(void 0!==s){o.destroy=void 0,r=t;var l=i,c=s;try{c()}catch(d){dd(r,l,d)}}}n=n.next}while(n!==a)}}catch(d){dd(t,t.return,d)}}function ll(e){var t=e.updateQueue;if(null!==t){var i=e.stateNode;try{ha(t,i)}catch(n){dd(e,e.return,n)}}}function cl(e,t,i){i.props=gs(e.type,e.memoizedProps),i.state=e.memoizedState;try{i.componentWillUnmount()}catch(n){dd(e,t,n)}}function dl(e,t){try{var i=e.ref;if(null!==i){switch(e.tag){case 26:case 27:case 5:var n=e.stateNode;break;default:n=e.stateNode}"function"===typeof i?e.refCleanup=i(n):i.current=n}}catch(r){dd(e,t,r)}}function ul(e,t){var i=e.ref,n=e.refCleanup;if(null!==i)if("function"===typeof n)try{n()}catch(r){dd(e,t,r)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof i)try{i(null)}catch(a){dd(e,t,a)}else i.current=null}function hl(e){var t=e.type,i=e.memoizedProps,n=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":i.autoFocus&&n.focus();break e;case"img":i.src?n.src=i.src:i.srcSet&&(n.srcset=i.srcSet)}}catch(r){dd(e,e.return,r)}}function pl(e,t,i){try{var n=e.stateNode;!function(e,t,i,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,a=null,s=null,l=null,c=null,d=null,u=null;for(f in i){var h=i[f];if(i.hasOwnProperty(f)&&null!=h)switch(f){case"checked":case"value":break;case"defaultValue":c=h;default:n.hasOwnProperty(f)||Jd(e,t,f,null,n,h)}}for(var p in n){var f=n[p];if(h=i[p],n.hasOwnProperty(p)&&(null!=f||null!=h))switch(p){case"type":a=f;break;case"name":r=f;break;case"checked":d=f;break;case"defaultChecked":u=f;break;case"value":s=f;break;case"defaultValue":l=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(o(137,t));break;default:f!==h&&Jd(e,t,p,f,n,h)}}return void gt(e,s,l,c,d,u,a,r);case"select":for(a in f=s=l=p=null,i)if(c=i[a],i.hasOwnProperty(a)&&null!=c)switch(a){case"value":break;case"multiple":f=c;default:n.hasOwnProperty(a)||Jd(e,t,a,null,n,c)}for(r in n)if(a=n[r],c=i[r],n.hasOwnProperty(r)&&(null!=a||null!=c))switch(r){case"value":p=a;break;case"defaultValue":l=a;break;case"multiple":s=a;default:a!==c&&Jd(e,t,r,a,n,c)}return t=l,i=s,n=f,void(null!=p?bt(e,!!i,p,!1):!!n!==!!i&&(null!=t?bt(e,!!i,t,!0):bt(e,!!i,i?[]:"",!1)));case"textarea":for(l in f=p=null,i)if(r=i[l],i.hasOwnProperty(l)&&null!=r&&!n.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Jd(e,t,l,null,n,r)}for(s in n)if(r=n[s],a=i[s],n.hasOwnProperty(s)&&(null!=r||null!=a))switch(s){case"value":p=r;break;case"defaultValue":f=r;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=r)throw Error(o(91));break;default:r!==a&&Jd(e,t,s,r,n,a)}return void xt(e,p,f);case"option":for(var m in i)if(p=i[m],i.hasOwnProperty(m)&&null!=p&&!n.hasOwnProperty(m))if("selected"===m)e.selected=!1;else Jd(e,t,m,null,n,p);for(c in n)if(p=n[c],f=i[c],n.hasOwnProperty(c)&&p!==f&&(null!=p||null!=f))if("selected"===c)e.selected=p&&"function"!==typeof p&&"symbol"!==typeof p;else Jd(e,t,c,p,n,f);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in i)p=i[g],i.hasOwnProperty(g)&&null!=p&&!n.hasOwnProperty(g)&&Jd(e,t,g,null,n,p);for(d in n)if(p=n[d],f=i[d],n.hasOwnProperty(d)&&p!==f&&(null!=p||null!=f))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(o(137,t));break;default:Jd(e,t,d,p,n,f)}return;default:if(At(t)){for(var v in i)p=i[v],i.hasOwnProperty(v)&&void 0!==p&&!n.hasOwnProperty(v)&&$d(e,t,v,void 0,n,p);for(u in n)p=n[u],f=i[u],!n.hasOwnProperty(u)||p===f||void 0===p&&void 0===f||$d(e,t,u,p,n,f);return}}for(var y in i)p=i[y],i.hasOwnProperty(y)&&null!=p&&!n.hasOwnProperty(y)&&Jd(e,t,y,null,n,p);for(h in n)p=n[h],f=i[h],!n.hasOwnProperty(h)||p===f||null==p&&null==f||Jd(e,t,h,p,n,f)}(n,e.type,i,t),n[ke]=t}catch(r){dd(e,e.return,r)}}function fl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&pu(e.type)||4===e.tag}function ml(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||fl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&pu(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function gl(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?(9===i.nodeType?i.body:"HTML"===i.nodeName?i.ownerDocument.body:i).insertBefore(e,t):((t=9===i.nodeType?i.body:"HTML"===i.nodeName?i.ownerDocument.body:i).appendChild(e),null!==(i=i._reactRootContainer)&&void 0!==i||null!==t.onclick||(t.onclick=Zd));else if(4!==n&&(27===n&&pu(e.type)&&(i=e.stateNode,t=null),null!==(e=e.child)))for(gl(e,t,i),e=e.sibling;null!==e;)gl(e,t,i),e=e.sibling}function vl(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(4!==n&&(27===n&&pu(e.type)&&(i=e.stateNode),null!==(e=e.child)))for(vl(e,t,i),e=e.sibling;null!==e;)vl(e,t,i),e=e.sibling}function yl(e){var t=e.stateNode,i=e.memoizedProps;try{for(var n=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);eu(t,n,i),t[Ie]=e,t[ke]=i}catch(a){dd(e,e.return,a)}}var bl=!1,xl=!1,wl=!1,Sl="function"===typeof WeakSet?WeakSet:Set,_l=null;function Cl(e,t,i){var n=i.flags;switch(i.tag){case 0:case 11:case 15:Bl(e,i),4&n&&ol(5,i);break;case 1:if(Bl(e,i),4&n)if(e=i.stateNode,null===t)try{e.componentDidMount()}catch(o){dd(i,i.return,o)}else{var r=gs(i.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){dd(i,i.return,s)}}64&n&&ll(i),512&n&&dl(i,i.return);break;case 3:if(Bl(e,i),64&n&&null!==(e=i.updateQueue)){if(t=null,null!==i.child)switch(i.child.tag){case 27:case 5:case 1:t=i.child.stateNode}try{ha(e,t)}catch(o){dd(i,i.return,o)}}break;case 27:null===t&&4&n&&yl(i);case 26:case 5:Bl(e,i),null===t&&4&n&&hl(i),512&n&&dl(i,i.return);break;case 12:Bl(e,i);break;case 13:Bl(e,i),4&n&&Dl(e,i),64&n&&(null!==(e=i.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var i=e.ownerDocument;if("$?"!==e.data||"complete"===i.readyState)t();else{var n=function(){t(),i.removeEventListener("DOMContentLoaded",n)};i.addEventListener("DOMContentLoaded",n),e._reactRetry=n}}(e,i=fd.bind(null,i))));break;case 22:if(!(n=null!==i.memoizedState||bl)){t=null!==t&&null!==t.memoizedState||xl,r=bl;var a=xl;bl=n,(xl=t)&&!a?Fl(e,i,0!==(8772&i.subtreeFlags)):Bl(e,i),bl=r,xl=a}break;case 30:break;default:Bl(e,i)}}function El(e){var t=e.alternate;null!==t&&(e.alternate=null,El(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ue(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Al=null,Ml=!1;function Tl(e,t,i){for(i=i.child;null!==i;)Pl(e,t,i),i=i.sibling}function Pl(e,t,i){if(ue&&"function"===typeof ue.onCommitFiberUnmount)try{ue.onCommitFiberUnmount(de,i)}catch(a){}switch(i.tag){case 26:xl||ul(i,t),Tl(e,t,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode).parentNode.removeChild(i);break;case 27:xl||ul(i,t);var n=Al,r=Ml;pu(i.type)&&(Al=i.stateNode,Ml=!1),Tl(e,t,i),wu(i.stateNode),Al=n,Ml=r;break;case 5:xl||ul(i,t);case 6:if(n=Al,r=Ml,Al=null,Tl(e,t,i),Ml=r,null!==(Al=n))if(Ml)try{(9===Al.nodeType?Al.body:"HTML"===Al.nodeName?Al.ownerDocument.body:Al).removeChild(i.stateNode)}catch(o){dd(i,t,o)}else try{Al.removeChild(i.stateNode)}catch(o){dd(i,t,o)}break;case 18:null!==Al&&(Ml?(fu(9===(e=Al).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,i.stateNode),Mh(e)):fu(Al,i.stateNode));break;case 4:n=Al,r=Ml,Al=i.stateNode.containerInfo,Ml=!0,Tl(e,t,i),Al=n,Ml=r;break;case 0:case 11:case 14:case 15:xl||sl(2,i,t),xl||sl(4,i,t),Tl(e,t,i);break;case 1:xl||(ul(i,t),"function"===typeof(n=i.stateNode).componentWillUnmount&&cl(i,t,n)),Tl(e,t,i);break;case 21:Tl(e,t,i);break;case 22:xl=(n=xl)||null!==i.memoizedState,Tl(e,t,i),xl=n;break;default:Tl(e,t,i)}}function Dl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Mh(e)}catch(i){dd(t,t.return,i)}}function Ol(e,t){var i=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Sl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Sl),t;default:throw Error(o(435,e.tag))}}(e);t.forEach(function(t){var n=md.bind(null,e,t);i.has(t)||(i.add(t),t.then(n,n))})}function Il(e,t){var i=t.deletions;if(null!==i)for(var n=0;n<i.length;n++){var r=i[n],a=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 27:if(pu(l.type)){Al=l.stateNode,Ml=!1;break e}break;case 5:Al=l.stateNode,Ml=!1;break e;case 3:case 4:Al=l.stateNode.containerInfo,Ml=!0;break e}l=l.return}if(null===Al)throw Error(o(160));Pl(a,s,r),Al=null,Ml=!1,null!==(a=r.alternate)&&(a.return=null),r.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Rl(t,e),t=t.sibling}var kl=null;function Rl(e,t){var i=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Il(t,e),zl(e),4&n&&(sl(3,e,e.return),ol(3,e),sl(5,e,e.return));break;case 1:Il(t,e),zl(e),512&n&&(xl||null===i||ul(i,i.return)),64&n&&bl&&(null!==(e=e.updateQueue)&&(null!==(n=e.callbacks)&&(i=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===i?n:i.concat(n))));break;case 26:var r=kl;if(Il(t,e),zl(e),512&n&&(xl||null===i||ul(i,i.return)),4&n){var a=null!==i?i.memoizedState:null;if(n=e.memoizedState,null===i)if(null===n)if(null===e.stateNode){e:{n=e.type,i=e.memoizedProps,r=r.ownerDocument||r;t:switch(n){case"title":(!(a=r.getElementsByTagName("title")[0])||a[Fe]||a[Ie]||"http://www.w3.org/2000/svg"===a.namespaceURI||a.hasAttribute("itemprop"))&&(a=r.createElement(n),r.head.insertBefore(a,r.querySelector("head > title"))),eu(a,n,i),a[Ie]=e,Ge(a),n=a;break e;case"link":var s=Fu("link","href",r).get(n+(i.href||""));if(s)for(var l=0;l<s.length;l++)if((a=s[l]).getAttribute("href")===(null==i.href||""===i.href?null:i.href)&&a.getAttribute("rel")===(null==i.rel?null:i.rel)&&a.getAttribute("title")===(null==i.title?null:i.title)&&a.getAttribute("crossorigin")===(null==i.crossOrigin?null:i.crossOrigin)){s.splice(l,1);break t}eu(a=r.createElement(n),n,i),r.head.appendChild(a);break;case"meta":if(s=Fu("meta","content",r).get(n+(i.content||"")))for(l=0;l<s.length;l++)if((a=s[l]).getAttribute("content")===(null==i.content?null:""+i.content)&&a.getAttribute("name")===(null==i.name?null:i.name)&&a.getAttribute("property")===(null==i.property?null:i.property)&&a.getAttribute("http-equiv")===(null==i.httpEquiv?null:i.httpEquiv)&&a.getAttribute("charset")===(null==i.charSet?null:i.charSet)){s.splice(l,1);break t}eu(a=r.createElement(n),n,i),r.head.appendChild(a);break;default:throw Error(o(468,n))}a[Ie]=e,Ge(a),n=a}e.stateNode=n}else Uu(r,e.type,e.stateNode);else e.stateNode=Ru(r,n,e.memoizedProps);else a!==n?(null===a?null!==i.stateNode&&(i=i.stateNode).parentNode.removeChild(i):a.count--,null===n?Uu(r,e.type,e.stateNode):Ru(r,n,e.memoizedProps)):null===n&&null!==e.stateNode&&pl(e,e.memoizedProps,i.memoizedProps)}break;case 27:Il(t,e),zl(e),512&n&&(xl||null===i||ul(i,i.return)),null!==i&&4&n&&pl(e,e.memoizedProps,i.memoizedProps);break;case 5:if(Il(t,e),zl(e),512&n&&(xl||null===i||ul(i,i.return)),32&e.flags){r=e.stateNode;try{St(r,"")}catch(f){dd(e,e.return,f)}}4&n&&null!=e.stateNode&&pl(e,r=e.memoizedProps,null!==i?i.memoizedProps:r),1024&n&&(wl=!0);break;case 6:if(Il(t,e),zl(e),4&n){if(null===e.stateNode)throw Error(o(162));n=e.memoizedProps,i=e.stateNode;try{i.nodeValue=n}catch(f){dd(e,e.return,f)}}break;case 3:if(Nu=null,r=kl,kl=Cu(t.containerInfo),Il(t,e),kl=r,zl(e),4&n&&null!==i&&i.memoizedState.isDehydrated)try{Mh(t.containerInfo)}catch(f){dd(e,e.return,f)}wl&&(wl=!1,Ll(e));break;case 4:n=kl,kl=Cu(e.stateNode.containerInfo),Il(t,e),zl(e),kl=n;break;case 12:default:Il(t,e),zl(e);break;case 13:Il(t,e),zl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==i&&null!==i.memoizedState)&&(wc=te()),4&n&&(null!==(n=e.updateQueue)&&(e.updateQueue=null,Ol(e,n)));break;case 22:r=null!==e.memoizedState;var c=null!==i&&null!==i.memoizedState,d=bl,u=xl;if(bl=d||r,xl=u||c,Il(t,e),xl=u,bl=d,zl(e),8192&n)e:for(t=e.stateNode,t._visibility=r?-2&t._visibility:1|t._visibility,r&&(null===i||c||bl||xl||Nl(e)),i=null,t=e;;){if(5===t.tag||26===t.tag){if(null===i){c=i=t;try{if(a=c.stateNode,r)"function"===typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,p=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==p||"boolean"===typeof p?"":(""+p).trim()}}catch(f){dd(c,c.return,f)}}}else if(6===t.tag){if(null===i){c=t;try{c.stateNode.nodeValue=r?"":c.memoizedProps}catch(f){dd(c,c.return,f)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;i===t&&(i=null),t=t.return}i===t&&(i=null),t.sibling.return=t.return,t=t.sibling}4&n&&(null!==(n=e.updateQueue)&&(null!==(i=n.retryQueue)&&(n.retryQueue=null,Ol(e,i))));break;case 19:Il(t,e),zl(e),4&n&&(null!==(n=e.updateQueue)&&(e.updateQueue=null,Ol(e,n)));case 30:case 21:}}function zl(e){var t=e.flags;if(2&t){try{for(var i,n=e.return;null!==n;){if(fl(n)){i=n;break}n=n.return}if(null==i)throw Error(o(160));switch(i.tag){case 27:var r=i.stateNode;vl(e,ml(e),r);break;case 5:var a=i.stateNode;32&i.flags&&(St(a,""),i.flags&=-33),vl(e,ml(e),a);break;case 3:case 4:var s=i.stateNode.containerInfo;gl(e,ml(e),s);break;default:throw Error(o(161))}}catch(l){dd(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ll(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ll(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Bl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Cl(e,t.alternate,t),t=t.sibling}function Nl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:sl(4,t,t.return),Nl(t);break;case 1:ul(t,t.return);var i=t.stateNode;"function"===typeof i.componentWillUnmount&&cl(t,t.return,i),Nl(t);break;case 27:wu(t.stateNode);case 26:case 5:ul(t,t.return),Nl(t);break;case 22:null===t.memoizedState&&Nl(t);break;default:Nl(t)}e=e.sibling}}function Fl(e,t,i){for(i=i&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var n=t.alternate,r=e,a=t,o=a.flags;switch(a.tag){case 0:case 11:case 15:Fl(r,a,i),ol(4,a);break;case 1:if(Fl(r,a,i),"function"===typeof(r=(n=a).stateNode).componentDidMount)try{r.componentDidMount()}catch(c){dd(n,n.return,c)}if(null!==(r=(n=a).updateQueue)){var s=n.stateNode;try{var l=r.shared.hiddenCallbacks;if(null!==l)for(r.shared.hiddenCallbacks=null,r=0;r<l.length;r++)ua(l[r],s)}catch(c){dd(n,n.return,c)}}i&&64&o&&ll(a),dl(a,a.return);break;case 27:yl(a);case 26:case 5:Fl(r,a,i),i&&null===n&&4&o&&hl(a),dl(a,a.return);break;case 12:Fl(r,a,i);break;case 13:Fl(r,a,i),i&&4&o&&Dl(r,a);break;case 22:null===a.memoizedState&&Fl(r,a,i),dl(a,a.return);break;case 30:break;default:Fl(r,a,i)}t=t.sibling}}function Ul(e,t){var i=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(i=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==i&&(null!=e&&e.refCount++,null!=i&&Rr(i))}function Vl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Rr(e))}function jl(e,t,i,n){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Wl(e,t,i,n),t=t.sibling}function Wl(e,t,i,n){var r=t.flags;switch(t.tag){case 0:case 11:case 15:jl(e,t,i,n),2048&r&&ol(9,t);break;case 1:case 13:default:jl(e,t,i,n);break;case 3:jl(e,t,i,n),2048&r&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Rr(e)));break;case 12:if(2048&r){jl(e,t,i,n),e=t.stateNode;try{var a=t.memoizedProps,o=a.id,s=a.onPostCommit;"function"===typeof s&&s(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){dd(t,t.return,l)}}else jl(e,t,i,n);break;case 23:break;case 22:a=t.stateNode,o=t.alternate,null!==t.memoizedState?2&a._visibility?jl(e,t,i,n):Gl(e,t):2&a._visibility?jl(e,t,i,n):(a._visibility|=2,Hl(e,t,i,n,0!==(10256&t.subtreeFlags))),2048&r&&Ul(o,t);break;case 24:jl(e,t,i,n),2048&r&&Vl(t.alternate,t)}}function Hl(e,t,i,n,r){for(r=r&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var a=e,o=t,s=i,l=n,c=o.flags;switch(o.tag){case 0:case 11:case 15:Hl(a,o,s,l,r),ol(8,o);break;case 23:break;case 22:var d=o.stateNode;null!==o.memoizedState?2&d._visibility?Hl(a,o,s,l,r):Gl(a,o):(d._visibility|=2,Hl(a,o,s,l,r)),r&&2048&c&&Ul(o.alternate,o);break;case 24:Hl(a,o,s,l,r),r&&2048&c&&Vl(o.alternate,o);break;default:Hl(a,o,s,l,r)}t=t.sibling}}function Gl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var i=e,n=t,r=n.flags;switch(n.tag){case 22:Gl(i,n),2048&r&&Ul(n.alternate,n);break;case 24:Gl(i,n),2048&r&&Vl(n.alternate,n);break;default:Gl(i,n)}t=t.sibling}}var ql=8192;function Xl(e){if(e.subtreeFlags&ql)for(e=e.child;null!==e;)Yl(e),e=e.sibling}function Yl(e){switch(e.tag){case 26:Xl(e),e.flags&ql&&null!==e.memoizedState&&function(e,t,i){if(null===ju)throw Error(o(475));var n=ju;if("stylesheet"===t.type&&("string"!==typeof i.media||!1!==matchMedia(i.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var r=Pu(i.href),a=e.querySelector(Du(r));if(a)return null!==(e=a._p)&&"object"===typeof e&&"function"===typeof e.then&&(n.count++,n=Hu.bind(n),e.then(n,n)),t.state.loading|=4,t.instance=a,void Ge(a);a=e.ownerDocument||e,i=Ou(i),(r=Su.get(r))&&Lu(i,r),Ge(a=a.createElement("link"));var s=a;s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),eu(a,"link",i),t.instance=a}null===n.stylesheets&&(n.stylesheets=new Map),n.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(n.count++,t=Hu.bind(n),e.addEventListener("load",t),e.addEventListener("error",t))}}(kl,e.memoizedState,e.memoizedProps);break;case 5:default:Xl(e);break;case 3:case 4:var t=kl;kl=Cu(e.stateNode.containerInfo),Xl(e),kl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=ql,ql=16777216,Xl(e),ql=t):Xl(e))}}function Ql(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Kl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var i=0;i<t.length;i++){var n=t[i];_l=n,$l(n,e)}Ql(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Zl(e),e=e.sibling}function Zl(e){switch(e.tag){case 0:case 11:case 15:Kl(e),2048&e.flags&&sl(9,e,e.return);break;case 3:case 12:default:Kl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Jl(e)):Kl(e)}}function Jl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var i=0;i<t.length;i++){var n=t[i];_l=n,$l(n,e)}Ql(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:sl(8,t,t.return),Jl(t);break;case 22:2&(i=t.stateNode)._visibility&&(i._visibility&=-3,Jl(t));break;default:Jl(t)}e=e.sibling}}function $l(e,t){for(;null!==_l;){var i=_l;switch(i.tag){case 0:case 11:case 15:sl(8,i,t);break;case 23:case 22:if(null!==i.memoizedState&&null!==i.memoizedState.cachePool){var n=i.memoizedState.cachePool.pool;null!=n&&n.refCount++}break;case 24:Rr(i.memoizedState.cache)}if(null!==(n=i.child))n.return=i,_l=n;else e:for(i=e;null!==_l;){var r=(n=_l).sibling,a=n.return;if(El(n),n===i){_l=null;break e}if(null!==r){r.return=a,_l=r;break e}_l=a}}}var ec={getCacheForType:function(e){var t=Ar(Ir),i=t.data.get(e);return void 0===i&&(i=e(),t.data.set(e,i)),i}},tc="function"===typeof WeakMap?WeakMap:Map,ic=0,nc=null,rc=null,ac=0,oc=0,sc=null,lc=!1,cc=!1,dc=!1,uc=0,hc=0,pc=0,fc=0,mc=0,gc=0,vc=0,yc=null,bc=null,xc=!1,wc=0,Sc=1/0,_c=null,Cc=null,Ec=0,Ac=null,Mc=null,Tc=0,Pc=0,Dc=null,Oc=null,Ic=0,kc=null;function Rc(){if(0!==(2&ic)&&0!==ac)return ac&-ac;if(null!==R.T){return 0!==Br?Br:Pd()}return De()}function zc(){0===gc&&(gc=0===(536870912&ac)||ar?Se():536870912);var e=rs.current;return null!==e&&(e.flags|=32),gc}function Lc(e,t,i){(e!==nc||2!==oc&&9!==oc)&&null===e.cancelPendingCommit||(Wc(e,0),Uc(e,ac,gc,!1)),Ee(e,i),0!==(2&ic)&&e===nc||(e===nc&&(0===(2&ic)&&(fc|=i),4===hc&&Uc(e,ac,gc,!1)),Sd(e))}function Bc(e,t,i){if(0!==(6&ic))throw Error(o(327));for(var n=!i&&0===(124&t)&&0===(t&e.expiredLanes)||xe(e,t),r=n?function(e,t){var i=ic;ic|=2;var n=Gc(),r=qc();nc!==e||ac!==t?(_c=null,Sc=te()+500,Wc(e,t)):cc=xe(e,t);e:for(;;)try{if(0!==oc&&null!==rc){t=rc;var a=sc;t:switch(oc){case 1:oc=0,sc=null,$c(e,t,a,1);break;case 2:case 9:if(Qr(a)){oc=0,sc=null,Jc(t);break}t=function(){2!==oc&&9!==oc||nc!==e||(oc=7),Sd(e)},a.then(t,t);break e;case 3:oc=7;break e;case 4:oc=5;break e;case 7:Qr(a)?(oc=0,sc=null,Jc(t)):(oc=0,sc=null,$c(e,t,a,7));break;case 5:var s=null;switch(rc.tag){case 26:s=rc.memoizedState;case 5:case 27:var l=rc;if(!s||Vu(s)){oc=0,sc=null;var c=l.sibling;if(null!==c)rc=c;else{var d=l.return;null!==d?(rc=d,ed(d)):rc=null}break t}}oc=0,sc=null,$c(e,t,a,5);break;case 6:oc=0,sc=null,$c(e,t,a,6);break;case 8:jc(),hc=6;break e;default:throw Error(o(462))}}Kc();break}catch(u){Hc(e,u)}return yr=vr=null,R.H=n,R.A=r,ic=i,null!==rc?0:(nc=null,ac=0,Tn(),hc)}(e,t):Yc(e,t,!0),a=n;;){if(0===r){cc&&!n&&Uc(e,t,0,!1);break}if(i=e.current.alternate,!a||Fc(i)){if(2===r){if(a=t,e.errorRecoveryDisabledLanes&a)var s=0;else s=0!==(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var l=e;r=yc;var c=l.current.memoizedState.isDehydrated;if(c&&(Wc(l,s).flags|=256),2!==(s=Yc(l,s,!1))){if(dc&&!c){l.errorRecoveryDisabledLanes|=a,fc|=a,r=4;break e}a=bc,bc=r,null!==a&&(null===bc?bc=a:bc.push.apply(bc,a))}r=s}if(a=!1,2!==r)continue}}if(1===r){Wc(e,0),Uc(e,t,0,!0);break}e:{switch(n=e,a=r){case 0:case 1:throw Error(o(345));case 4:if((4194048&t)!==t)break;case 6:Uc(n,t,gc,!lc);break e;case 2:bc=null;break;case 3:case 5:break;default:throw Error(o(329))}if((62914560&t)===t&&10<(r=wc+300-te())){if(Uc(n,t,gc,!lc),0!==be(n,0,!0))break e;n.timeoutHandle=lu(Nc.bind(null,n,i,bc,_c,xc,t,gc,fc,vc,lc,a,2,-0,0),r)}else Nc(n,i,bc,_c,xc,t,gc,fc,vc,lc,a,0,-0,0)}break}r=Yc(e,t,!1),a=!1}Sd(e)}function Nc(e,t,i,n,r,a,s,l,c,d,u,h,p,f){if(e.timeoutHandle=-1,(8192&(h=t.subtreeFlags)||16785408===(16785408&h))&&(ju={stylesheets:null,count:0,unsuspend:Wu},Yl(t),null!==(h=function(){if(null===ju)throw Error(o(475));var e=ju;return e.stylesheets&&0===e.count&&qu(e,e.stylesheets),0<e.count?function(t){var i=setTimeout(function(){if(e.stylesheets&&qu(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(i)}}:null}())))return e.cancelPendingCommit=h(id.bind(null,e,t,a,i,n,r,s,l,c,u,1,p,f)),void Uc(e,a,s,!d);id(e,t,a,i,n,r,s,l,c)}function Fc(e){for(var t=e;;){var i=t.tag;if((0===i||11===i||15===i)&&16384&t.flags&&(null!==(i=t.updateQueue)&&null!==(i=i.stores)))for(var n=0;n<i.length;n++){var r=i[n],a=r.getSnapshot;r=r.value;try{if(!Yi(a(),r))return!1}catch(o){return!1}}if(i=t.child,16384&t.subtreeFlags&&null!==i)i.return=t,t=i;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Uc(e,t,i,n){t&=~mc,t&=~fc,e.suspendedLanes|=t,e.pingedLanes&=~t,n&&(e.warmLanes|=t),n=e.expirationTimes;for(var r=t;0<r;){var a=31-pe(r),o=1<<a;n[a]=-1,r&=~o}0!==i&&Ae(e,i,t)}function Vc(){return 0!==(6&ic)||(_d(0,!1),!1)}function jc(){if(null!==rc){if(0===oc)var e=rc.return;else yr=vr=null,Ba(e=rc),Qo=null,Ko=0,e=rc;for(;null!==e;)al(e.alternate,e),e=e.return;rc=null}}function Wc(e,t){var i=e.timeoutHandle;-1!==i&&(e.timeoutHandle=-1,cu(i)),null!==(i=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,i()),jc(),nc=e,rc=i=Nn(e.current,null),ac=t,oc=0,sc=null,lc=!1,cc=xe(e,t),dc=!1,vc=gc=mc=fc=pc=hc=0,bc=yc=null,xc=!1,0!==(8&t)&&(t|=32&t);var n=e.entangledLanes;if(0!==n)for(e=e.entanglements,n&=t;0<n;){var r=31-pe(n),a=1<<r;t|=e[r],n&=~a}return uc=t,Tn(),i}function Hc(e,t){ba=null,R.H=Go,t===Gr||t===Xr?(t=$r(),oc=3):t===qr?(t=$r(),oc=4):oc=t===As?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,sc=t,null===rc&&(hc=1,ws(e,Cn(t,e.current)))}function Gc(){var e=R.H;return R.H=Go,null===e?Go:e}function qc(){var e=R.A;return R.A=ec,e}function Xc(){hc=4,lc||(4194048&ac)!==ac&&null!==rs.current||(cc=!0),0===(134217727&pc)&&0===(134217727&fc)||null===nc||Uc(nc,ac,gc,!1)}function Yc(e,t,i){var n=ic;ic|=2;var r=Gc(),a=qc();nc===e&&ac===t||(_c=null,Wc(e,t)),t=!1;var o=hc;e:for(;;)try{if(0!==oc&&null!==rc){var s=rc,l=sc;switch(oc){case 8:jc(),o=6;break e;case 3:case 2:case 9:case 6:null===rs.current&&(t=!0);var c=oc;if(oc=0,sc=null,$c(e,s,l,c),i&&cc){o=0;break e}break;default:c=oc,oc=0,sc=null,$c(e,s,l,c)}}Qc(),o=hc;break}catch(d){Hc(e,d)}return t&&e.shellSuspendCounter++,yr=vr=null,ic=n,R.H=r,R.A=a,null===rc&&(nc=null,ac=0,Tn()),o}function Qc(){for(;null!==rc;)Zc(rc)}function Kc(){for(;null!==rc&&!$();)Zc(rc)}function Zc(e){var t=Zs(e.alternate,e,uc);e.memoizedProps=e.pendingProps,null===t?ed(e):rc=t}function Jc(e){var t=e,i=t.alternate;switch(t.tag){case 15:case 0:t=Ls(i,t,t.pendingProps,t.type,void 0,ac);break;case 11:t=Ls(i,t,t.pendingProps,t.type.render,t.ref,ac);break;case 5:Ba(t);default:al(i,t),t=Zs(i,t=rc=Fn(t,uc),uc)}e.memoizedProps=e.pendingProps,null===t?ed(e):rc=t}function $c(e,t,i,n){yr=vr=null,Ba(t),Qo=null,Ko=0;var r=t.return;try{if(function(e,t,i,n,r){if(i.flags|=32768,null!==n&&"object"===typeof n&&"function"===typeof n.then){if(null!==(t=i.alternate)&&_r(t,i,r,!0),null!==(i=rs.current)){switch(i.tag){case 13:return null===as?Xc():null===i.alternate&&0===hc&&(hc=3),i.flags&=-257,i.flags|=65536,i.lanes=r,n===Yr?i.flags|=16384:(null===(t=i.updateQueue)?i.updateQueue=new Set([n]):t.add(n),ud(e,n,r)),!1;case 22:return i.flags|=65536,n===Yr?i.flags|=16384:(null===(t=i.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([n])},i.updateQueue=t):null===(i=t.retryQueue)?t.retryQueue=new Set([n]):i.add(n),ud(e,n,r)),!1}throw Error(o(435,i.tag))}return ud(e,n,r),Xc(),!1}if(ar)return null!==(t=rs.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=r,n!==lr&&mr(Cn(e=Error(o(422),{cause:n}),i))):(n!==lr&&mr(Cn(t=Error(o(423),{cause:n}),i)),(e=e.current.alternate).flags|=65536,r&=-r,e.lanes|=r,n=Cn(n,i),sa(e,r=_s(e.stateNode,n,r)),4!==hc&&(hc=2)),!1;var a=Error(o(520),{cause:n});if(a=Cn(a,i),null===yc?yc=[a]:yc.push(a),4!==hc&&(hc=2),null===t)return!0;n=Cn(n,i),i=t;do{switch(i.tag){case 3:return i.flags|=65536,e=r&-r,i.lanes|=e,sa(i,e=_s(i.stateNode,n,e)),!1;case 1:if(t=i.type,a=i.stateNode,0===(128&i.flags)&&("function"===typeof t.getDerivedStateFromError||null!==a&&"function"===typeof a.componentDidCatch&&(null===Cc||!Cc.has(a))))return i.flags|=65536,r&=-r,i.lanes|=r,Es(r=Cs(r),e,i,n),sa(i,r),!1}i=i.return}while(null!==i);return!1}(e,r,t,i,ac))return hc=1,ws(e,Cn(i,e.current)),void(rc=null)}catch(a){if(null!==r)throw rc=r,a;return hc=1,ws(e,Cn(i,e.current)),void(rc=null)}32768&t.flags?(ar||1===n?e=!0:cc||0!==(536870912&ac)?e=!1:(lc=e=!0,(2===n||9===n||3===n||6===n)&&(null!==(n=rs.current)&&13===n.tag&&(n.flags|=16384))),td(t,e)):ed(t)}function ed(e){var t=e;do{if(0!==(32768&t.flags))return void td(t,lc);e=t.return;var i=nl(t.alternate,t,uc);if(null!==i)return void(rc=i);if(null!==(t=t.sibling))return void(rc=t);rc=t=e}while(null!==t);0===hc&&(hc=5)}function td(e,t){do{var i=rl(e.alternate,e);if(null!==i)return i.flags&=32767,void(rc=i);if(null!==(i=e.return)&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!t&&null!==(e=e.sibling))return void(rc=e);rc=e=i}while(null!==e);hc=6,rc=null}function id(e,t,i,n,r,a,s,l,c){e.cancelPendingCommit=null;do{sd()}while(0!==Ec);if(0!==(6&ic))throw Error(o(327));if(null!==t){if(t===e.current)throw Error(o(177));if(a=t.lanes|t.childLanes,function(e,t,i,n,r,a){var o=e.pendingLanes;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=i,e.entangledLanes&=i,e.errorRecoveryDisabledLanes&=i,e.shellSuspendCounter=0;var s=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(i=o&~i;0<i;){var d=31-pe(i),u=1<<d;s[d]=0,l[d]=-1;var h=c[d];if(null!==h)for(c[d]=null,d=0;d<h.length;d++){var p=h[d];null!==p&&(p.lane&=-536870913)}i&=~u}0!==n&&Ae(e,n,0),0!==a&&0===r&&0!==e.tag&&(e.suspendedLanes|=a&~(o&~t))}(e,i,a|=Mn,s,l,c),e===nc&&(rc=nc=null,ac=0),Mc=t,Ac=e,Tc=i,Pc=a,Dc=r,Oc=n,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,Z(ae,function(){return ld(),null})):(e.callbackNode=null,e.callbackPriority=0),n=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||n){n=R.T,R.T=null,r=z.p,z.p=2,s=ic,ic|=4;try{!function(e,t){if(e=e.containerInfo,tu=ih,en(e=$i(e))){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(i=(i=e.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(n&&0!==n.rangeCount){i=n.anchorNode;var r=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{i.nodeType,a.nodeType}catch(g){i=null;break e}var s=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var f;h!==i||0!==r&&3!==h.nodeType||(l=s+r),h!==a||0!==n&&3!==h.nodeType||(c=s+n),3===h.nodeType&&(s+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===i&&++d===r&&(l=s),p===a&&++u===n&&(c=s),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}i=-1===l||-1===c?null:{start:l,end:c}}else i=null}i=i||{start:0,end:0}}else i=null;for(iu={focusedElem:e,selectionRange:i},ih=!1,_l=t;null!==_l;)if(e=(t=_l).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,_l=e;else for(;null!==_l;){switch(a=(t=_l).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==a){e=void 0,i=t,r=a.memoizedProps,a=a.memoizedState,n=i.stateNode;try{var m=gs(i.type,r,(i.elementType,i.type));e=n.getSnapshotBeforeUpdate(m,a),n.__reactInternalSnapshotBeforeUpdate=e}catch(v){dd(i,i.return,v)}}break;case 3:if(0!==(1024&e))if(9===(i=(e=t.stateNode.containerInfo).nodeType))mu(e);else if(1===i)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":mu(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(o(163))}if(null!==(e=t.sibling)){e.return=t.return,_l=e;break}_l=t.return}}(e,t)}finally{ic=s,z.p=r,R.T=n}}Ec=1,nd(),rd(),ad()}}function nd(){if(1===Ec){Ec=0;var e=Ac,t=Mc,i=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||i){i=R.T,R.T=null;var n=z.p;z.p=2;var r=ic;ic|=4;try{Rl(t,e);var a=iu,o=$i(e.containerInfo),s=a.focusedElem,l=a.selectionRange;if(o!==s&&s&&s.ownerDocument&&Ji(s.ownerDocument.documentElement,s)){if(null!==l&&en(s)){var c=l.start,d=l.end;if(void 0===d&&(d=c),"selectionStart"in s)s.selectionStart=c,s.selectionEnd=Math.min(d,s.value.length);else{var u=s.ownerDocument||document,h=u&&u.defaultView||window;if(h.getSelection){var p=h.getSelection(),f=s.textContent.length,m=Math.min(l.start,f),g=void 0===l.end?m:Math.min(l.end,f);!p.extend&&m>g&&(o=g,g=m,m=o);var v=Zi(s,m),y=Zi(s,g);if(v&&y&&(1!==p.rangeCount||p.anchorNode!==v.node||p.anchorOffset!==v.offset||p.focusNode!==y.node||p.focusOffset!==y.offset)){var b=u.createRange();b.setStart(v.node,v.offset),p.removeAllRanges(),m>g?(p.addRange(b),p.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),p.addRange(b))}}}}for(u=[],p=s;p=p.parentNode;)1===p.nodeType&&u.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"===typeof s.focus&&s.focus(),s=0;s<u.length;s++){var x=u[s];x.element.scrollLeft=x.left,x.element.scrollTop=x.top}}ih=!!tu,iu=tu=null}finally{ic=r,z.p=n,R.T=i}}e.current=t,Ec=2}}function rd(){if(2===Ec){Ec=0;var e=Ac,t=Mc,i=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||i){i=R.T,R.T=null;var n=z.p;z.p=2;var r=ic;ic|=4;try{Cl(e,t.alternate,t)}finally{ic=r,z.p=n,R.T=i}}Ec=3}}function ad(){if(4===Ec||3===Ec){Ec=0,ee();var e=Ac,t=Mc,i=Tc,n=Oc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Ec=5:(Ec=0,Mc=Ac=null,od(e,e.pendingLanes));var r=e.pendingLanes;if(0===r&&(Cc=null),Pe(i),t=t.stateNode,ue&&"function"===typeof ue.onCommitFiberRoot)try{ue.onCommitFiberRoot(de,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==n){t=R.T,r=z.p,z.p=2,R.T=null;try{for(var a=e.onRecoverableError,o=0;o<n.length;o++){var s=n[o];a(s.value,{componentStack:s.stack})}}finally{R.T=t,z.p=r}}0!==(3&Tc)&&sd(),Sd(e),r=e.pendingLanes,0!==(4194090&i)&&0!==(42&r)?e===kc?Ic++:(Ic=0,kc=e):Ic=0,_d(0,!1)}}function od(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Rr(t)))}function sd(e){return nd(),rd(),ad(),ld()}function ld(){if(5!==Ec)return!1;var e=Ac,t=Pc;Pc=0;var i=Pe(Tc),n=R.T,r=z.p;try{z.p=32>i?32:i,R.T=null,i=Dc,Dc=null;var a=Ac,s=Tc;if(Ec=0,Mc=Ac=null,Tc=0,0!==(6&ic))throw Error(o(331));var l=ic;if(ic|=4,Zl(a.current),Wl(a,a.current,s,i),ic=l,_d(0,!1),ue&&"function"===typeof ue.onPostCommitFiberRoot)try{ue.onPostCommitFiberRoot(de,a)}catch(c){}return!0}finally{z.p=r,R.T=n,od(e,t)}}function cd(e,t,i){t=Cn(i,t),null!==(e=aa(e,t=_s(e.stateNode,t,2),2))&&(Ee(e,2),Sd(e))}function dd(e,t,i){if(3===e.tag)cd(e,e,i);else for(;null!==t;){if(3===t.tag){cd(t,e,i);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Cc||!Cc.has(n))){e=Cn(i,e),null!==(n=aa(t,i=Cs(2),2))&&(Es(i,n,t,e),Ee(n,2),Sd(n));break}}t=t.return}}function ud(e,t,i){var n=e.pingCache;if(null===n){n=e.pingCache=new tc;var r=new Set;n.set(t,r)}else void 0===(r=n.get(t))&&(r=new Set,n.set(t,r));r.has(i)||(dc=!0,r.add(i),e=hd.bind(null,e,t,i),t.then(e,e))}function hd(e,t,i){var n=e.pingCache;null!==n&&n.delete(t),e.pingedLanes|=e.suspendedLanes&i,e.warmLanes&=~i,nc===e&&(ac&i)===i&&(4===hc||3===hc&&(62914560&ac)===ac&&300>te()-wc?0===(2&ic)&&Wc(e,0):mc|=i,vc===ac&&(vc=0)),Sd(e)}function pd(e,t){0===t&&(t=_e()),null!==(e=On(e,t))&&(Ee(e,t),Sd(e))}function fd(e){var t=e.memoizedState,i=0;null!==t&&(i=t.retryLane),pd(e,i)}function md(e,t){var i=0;switch(e.tag){case 13:var n=e.stateNode,r=e.memoizedState;null!==r&&(i=r.retryLane);break;case 19:n=e.stateNode;break;case 22:n=e.stateNode._retryCache;break;default:throw Error(o(314))}null!==n&&n.delete(t),pd(e,i)}var gd=null,vd=null,yd=!1,bd=!1,xd=!1,wd=0;function Sd(e){e!==vd&&null===e.next&&(null===vd?gd=vd=e:vd=vd.next=e),bd=!0,yd||(yd=!0,uu(function(){0!==(6&ic)?Z(ne,Cd):Ed()}))}function _d(e,t){if(!xd&&bd){xd=!0;do{for(var i=!1,n=gd;null!==n;){if(!t)if(0!==e){var r=n.pendingLanes;if(0===r)var a=0;else{var o=n.suspendedLanes,s=n.pingedLanes;a=(1<<31-pe(42|e)+1)-1,a=201326741&(a&=r&~(o&~s))?201326741&a|1:a?2|a:0}0!==a&&(i=!0,Td(n,a))}else a=ac,0===(3&(a=be(n,n===nc?a:0,null!==n.cancelPendingCommit||-1!==n.timeoutHandle)))||xe(n,a)||(i=!0,Td(n,a));n=n.next}}while(i);xd=!1}}function Cd(){Ed()}function Ed(){bd=yd=!1;var e=0;0!==wd&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==su&&(su=e,!0);return su=null,!1}()&&(e=wd),wd=0);for(var t=te(),i=null,n=gd;null!==n;){var r=n.next,a=Ad(n,t);0===a?(n.next=null,null===i?gd=r:i.next=r,null===r&&(vd=i)):(i=n,(0!==e||0!==(3&a))&&(bd=!0)),n=r}_d(e,!1)}function Ad(e,t){for(var i=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,a=-62914561&e.pendingLanes;0<a;){var o=31-pe(a),s=1<<o,l=r[o];-1===l?0!==(s&i)&&0===(s&n)||(r[o]=we(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}if(i=ac,i=be(e,e===(t=nc)?i:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),n=e.callbackNode,0===i||e===t&&(2===oc||9===oc)||null!==e.cancelPendingCommit)return null!==n&&null!==n&&J(n),e.callbackNode=null,e.callbackPriority=0;if(0===(3&i)||xe(e,i)){if((t=i&-i)===e.callbackPriority)return t;switch(null!==n&&J(n),Pe(i)){case 2:case 8:i=re;break;case 32:default:i=ae;break;case 268435456:i=se}return n=Md.bind(null,e),i=Z(i,n),e.callbackPriority=t,e.callbackNode=i,t}return null!==n&&null!==n&&J(n),e.callbackPriority=2,e.callbackNode=null,2}function Md(e,t){if(0!==Ec&&5!==Ec)return e.callbackNode=null,e.callbackPriority=0,null;var i=e.callbackNode;if(sd()&&e.callbackNode!==i)return null;var n=ac;return 0===(n=be(e,e===nc?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Bc(e,n,t),Ad(e,te()),null!=e.callbackNode&&e.callbackNode===i?Md.bind(null,e):null)}function Td(e,t){if(sd())return null;Bc(e,t,!0)}function Pd(){return 0===wd&&(wd=Se()),wd}function Dd(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Pt(""+e)}function Od(e,t){var i=t.ownerDocument.createElement("input");return i.name=t.name,i.value=t.value,e.id&&i.setAttribute("form",e.id),t.parentNode.insertBefore(i,t),e=new FormData(e),i.parentNode.removeChild(i),e}for(var Id=0;Id<wn.length;Id++){var kd=wn[Id];Sn(kd.toLowerCase(),"on"+(kd[0].toUpperCase()+kd.slice(1)))}Sn(pn,"onAnimationEnd"),Sn(fn,"onAnimationIteration"),Sn(mn,"onAnimationStart"),Sn("dblclick","onDoubleClick"),Sn("focusin","onFocus"),Sn("focusout","onBlur"),Sn(gn,"onTransitionRun"),Sn(vn,"onTransitionStart"),Sn(yn,"onTransitionCancel"),Sn(bn,"onTransitionEnd"),Qe("onMouseEnter",["mouseout","mouseover"]),Qe("onMouseLeave",["mouseout","mouseover"]),Qe("onPointerEnter",["pointerout","pointerover"]),Qe("onPointerLeave",["pointerout","pointerover"]),Ye("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ye("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ye("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ye("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Rd));function Ld(e,t){t=0!==(4&t);for(var i=0;i<e.length;i++){var n=e[i],r=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var s=n[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==a&&r.isPropagationStopped())break e;a=s,r.currentTarget=c;try{a(r)}catch(d){vs(d)}r.currentTarget=null,a=l}else for(o=0;o<n.length;o++){if(l=(s=n[o]).instance,c=s.currentTarget,s=s.listener,l!==a&&r.isPropagationStopped())break e;a=s,r.currentTarget=c;try{a(r)}catch(d){vs(d)}r.currentTarget=null,a=l}}}}function Bd(e,t){var i=t[ze];void 0===i&&(i=t[ze]=new Set);var n=e+"__bubble";i.has(n)||(Vd(t,e,2,!1),i.add(n))}function Nd(e,t,i){var n=0;t&&(n|=4),Vd(i,e,n,t)}var Fd="_reactListening"+Math.random().toString(36).slice(2);function Ud(e){if(!e[Fd]){e[Fd]=!0,qe.forEach(function(t){"selectionchange"!==t&&(zd.has(t)||Nd(t,!1,e),Nd(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Fd]||(t[Fd]=!0,Nd("selectionchange",!1,t))}}function Vd(e,t,i,n){switch(ch(t)){case 2:var r=nh;break;case 8:r=rh;break;default:r=ah}i=r.bind(null,t,i,e),r=void 0,!Ft||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),n?void 0!==r?e.addEventListener(t,i,{capture:!0,passive:r}):e.addEventListener(t,i,!0):void 0!==r?e.addEventListener(t,i,{passive:r}):e.addEventListener(t,i,!1)}function jd(e,t,i,n,r){var a=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var o=n.tag;if(3===o||4===o){var s=n.stateNode.containerInfo;if(s===r)break;if(4===o)for(o=n.return;null!==o;){var c=o.tag;if((3===c||4===c)&&o.stateNode.containerInfo===r)return;o=o.return}for(;null!==s;){if(null===(o=Ve(s)))return;if(5===(c=o.tag)||6===c||26===c||27===c){n=a=o;continue e}s=s.parentNode}}n=n.return}Lt(function(){var n=a,r=Ot(i),o=[];e:{var s=xn.get(e);if(void 0!==s){var c=$t,d=e;switch(e){case"keypress":if(0===Gt(i))break e;case"keydown":case"keyup":c=fi;break;case"focusin":d="focus",c=ai;break;case"focusout":d="blur",c=ai;break;case"beforeblur":case"afterblur":c=ai;break;case"click":if(2===i.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=ni;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=ri;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=gi;break;case pn:case fn:case mn:c=oi;break;case bn:c=vi;break;case"scroll":case"scrollend":c=ti;break;case"wheel":c=yi;break;case"copy":case"cut":case"paste":c=si;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=mi;break;case"toggle":case"beforetoggle":c=bi}var u=0!==(4&t),h=!u&&("scroll"===e||"scrollend"===e),p=u?null!==s?s+"Capture":null:s;u=[];for(var f,m=n;null!==m;){var g=m;if(f=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===f||null===p||null!=(g=Bt(m,p))&&u.push(Wd(m,g,f)),h)break;m=m.return}0<u.length&&(s=new c(s,d,null,i,r),o.push({event:s,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||i===Dt||!(d=i.relatedTarget||i.fromElement)||!Ve(d)&&!d[Re])&&(c||s)&&(s=r.window===r?r:(s=r.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=n,null!==(d=(d=i.relatedTarget||i.toElement)?Ve(d):null)&&(h=l(d),u=d.tag,d!==h||5!==u&&27!==u&&6!==u)&&(d=null)):(c=null,d=n),c!==d)){if(u=ni,g="onMouseLeave",p="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(u=mi,g="onPointerLeave",p="onPointerEnter",m="pointer"),h=null==c?s:We(c),f=null==d?s:We(d),(s=new u(g,m+"leave",c,i,r)).target=h,s.relatedTarget=f,g=null,Ve(r)===n&&((u=new u(p,m+"enter",d,i,r)).target=f,u.relatedTarget=h,g=u),h=g,c&&d)e:{for(p=d,m=0,f=u=c;f;f=Gd(f))m++;for(f=0,g=p;g;g=Gd(g))f++;for(;0<m-f;)u=Gd(u),m--;for(;0<f-m;)p=Gd(p),f--;for(;m--;){if(u===p||null!==p&&u===p.alternate)break e;u=Gd(u),p=Gd(p)}u=null}else u=null;null!==c&&qd(o,s,c,u,!1),null!==d&&null!==h&&qd(o,h,d,u,!0)}if("select"===(c=(s=n?We(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var v=Bi;else if(Oi(s))if(Ni)v=Xi;else{v=Gi;var y=Hi}else!(c=s.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==s.type&&"radio"!==s.type?n&&At(n.elementType)&&(v=Bi):v=qi;switch(v&&(v=v(e,n))?Ii(o,v,i,r):(y&&y(e,s,n),"focusout"===e&&n&&"number"===s.type&&null!=n.memoizedProps.value&&yt(s,"number",s.value)),y=n?We(n):window,e){case"focusin":(Oi(y)||"true"===y.contentEditable)&&(nn=y,rn=n,an=null);break;case"focusout":an=rn=nn=null;break;case"mousedown":on=!0;break;case"contextmenu":case"mouseup":case"dragend":on=!1,sn(o,i,r);break;case"selectionchange":if(tn)break;case"keydown":case"keyup":sn(o,i,r)}var b;if(wi)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Pi?Mi(e,i)&&(x="onCompositionEnd"):"keydown"===e&&229===i.keyCode&&(x="onCompositionStart");x&&(Ci&&"ko"!==i.locale&&(Pi||"onCompositionStart"!==x?"onCompositionEnd"===x&&Pi&&(b=Ht()):(jt="value"in(Vt=r)?Vt.value:Vt.textContent,Pi=!0)),0<(y=Hd(n,x)).length&&(x=new li(x,e,null,i,r),o.push({event:x,listeners:y}),b?x.data=b:null!==(b=Ti(i))&&(x.data=b))),(b=_i?function(e,t){switch(e){case"compositionend":return Ti(t);case"keypress":return 32!==t.which?null:(Ai=!0,Ei);case"textInput":return(e=t.data)===Ei&&Ai?null:e;default:return null}}(e,i):function(e,t){if(Pi)return"compositionend"===e||!wi&&Mi(e,t)?(e=Ht(),Wt=jt=Vt=null,Pi=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ci&&"ko"!==t.locale?null:t.data}}(e,i))&&(0<(x=Hd(n,"onBeforeInput")).length&&(y=new li("onBeforeInput","beforeinput",null,i,r),o.push({event:y,listeners:x}),y.data=b)),function(e,t,i,n,r){if("submit"===t&&i&&i.stateNode===r){var a=Dd((r[ke]||null).action),o=n.submitter;o&&null!==(t=(t=o[ke]||null)?Dd(t.formAction):o.getAttribute("formAction"))&&(a=t,o=null);var s=new $t("action","action",null,n,r);e.push({event:s,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(0!==wd){var e=o?Od(r,o):new FormData(r);Oo(i,{pending:!0,data:e,method:r.method,action:a},null,e)}}else"function"===typeof a&&(s.preventDefault(),e=o?Od(r,o):new FormData(r),Oo(i,{pending:!0,data:e,method:r.method,action:a},a,e))},currentTarget:r}]})}}(o,e,n,i,r)}Ld(o,t)})}function Wd(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Hd(e,t){for(var i=t+"Capture",n=[];null!==e;){var r=e,a=r.stateNode;if(5!==(r=r.tag)&&26!==r&&27!==r||null===a||(null!=(r=Bt(e,i))&&n.unshift(Wd(e,r,a)),null!=(r=Bt(e,t))&&n.push(Wd(e,r,a))),3===e.tag)return n;e=e.return}return[]}function Gd(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function qd(e,t,i,n,r){for(var a=t._reactName,o=[];null!==i&&i!==n;){var s=i,l=s.alternate,c=s.stateNode;if(s=s.tag,null!==l&&l===n)break;5!==s&&26!==s&&27!==s||null===c||(l=c,r?null!=(c=Bt(i,a))&&o.unshift(Wd(i,c,l)):r||null!=(c=Bt(i,a))&&o.push(Wd(i,c,l))),i=i.return}0!==o.length&&e.push({event:t,listeners:o})}var Xd=/\r\n?/g,Yd=/\u0000|\uFFFD/g;function Qd(e){return("string"===typeof e?e:""+e).replace(Xd,"\n").replace(Yd,"")}function Kd(e,t){return t=Qd(t),Qd(e)===t}function Zd(){}function Jd(e,t,i,n,r,a){switch(i){case"children":"string"===typeof n?"body"===t||"textarea"===t&&""===n||St(e,n):("number"===typeof n||"bigint"===typeof n)&&"body"!==t&&St(e,""+n);break;case"className":it(e,"class",n);break;case"tabIndex":it(e,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":it(e,i,n);break;case"style":Et(e,n,a);break;case"data":if("object"!==t){it(e,"data",n);break}case"src":case"href":if(""===n&&("a"!==t||"href"!==i)){e.removeAttribute(i);break}if(null==n||"function"===typeof n||"symbol"===typeof n||"boolean"===typeof n){e.removeAttribute(i);break}n=Pt(""+n),e.setAttribute(i,n);break;case"action":case"formAction":if("function"===typeof n){e.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof a&&("formAction"===i?("input"!==t&&Jd(e,t,"name",r.name,r,null),Jd(e,t,"formEncType",r.formEncType,r,null),Jd(e,t,"formMethod",r.formMethod,r,null),Jd(e,t,"formTarget",r.formTarget,r,null)):(Jd(e,t,"encType",r.encType,r,null),Jd(e,t,"method",r.method,r,null),Jd(e,t,"target",r.target,r,null))),null==n||"symbol"===typeof n||"boolean"===typeof n){e.removeAttribute(i);break}n=Pt(""+n),e.setAttribute(i,n);break;case"onClick":null!=n&&(e.onclick=Zd);break;case"onScroll":null!=n&&Bd("scroll",e);break;case"onScrollEnd":null!=n&&Bd("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!==typeof n||!("__html"in n))throw Error(o(61));if(null!=(i=n.__html)){if(null!=r.children)throw Error(o(60));e.innerHTML=i}}break;case"multiple":e.multiple=n&&"function"!==typeof n&&"symbol"!==typeof n;break;case"muted":e.muted=n&&"function"!==typeof n&&"symbol"!==typeof n;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==n||"function"===typeof n||"boolean"===typeof n||"symbol"===typeof n){e.removeAttribute("xlink:href");break}i=Pt(""+n),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(i,""+n):e.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(i,""):e.removeAttribute(i);break;case"capture":case"download":!0===n?e.setAttribute(i,""):!1!==n&&null!=n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(i,n):e.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":null!=n&&"function"!==typeof n&&"symbol"!==typeof n&&!isNaN(n)&&1<=n?e.setAttribute(i,n):e.removeAttribute(i);break;case"rowSpan":case"start":null==n||"function"===typeof n||"symbol"===typeof n||isNaN(n)?e.removeAttribute(i):e.setAttribute(i,n);break;case"popover":Bd("beforetoggle",e),Bd("toggle",e),tt(e,"popover",n);break;case"xlinkActuate":nt(e,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":nt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":nt(e,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":nt(e,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":nt(e,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":nt(e,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":nt(e,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":nt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":nt(e,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":tt(e,"is",n);break;case"innerText":case"textContent":break;default:(!(2<i.length)||"o"!==i[0]&&"O"!==i[0]||"n"!==i[1]&&"N"!==i[1])&&tt(e,i=Mt.get(i)||i,n)}}function $d(e,t,i,n,r,a){switch(i){case"style":Et(e,n,a);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!==typeof n||!("__html"in n))throw Error(o(61));if(null!=(i=n.__html)){if(null!=r.children)throw Error(o(60));e.innerHTML=i}}break;case"children":"string"===typeof n?St(e,n):("number"===typeof n||"bigint"===typeof n)&&St(e,""+n);break;case"onScroll":null!=n&&Bd("scroll",e);break;case"onScrollEnd":null!=n&&Bd("scrollend",e);break;case"onClick":null!=n&&(e.onclick=Zd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Xe.hasOwnProperty(i)||("o"!==i[0]||"n"!==i[1]||(r=i.endsWith("Capture"),t=i.slice(2,r?i.length-7:void 0),"function"===typeof(a=null!=(a=e[ke]||null)?a[i]:null)&&e.removeEventListener(t,a,r),"function"!==typeof n)?i in e?e[i]=n:!0===n?e.setAttribute(i,""):tt(e,i,n):("function"!==typeof a&&null!==a&&(i in e?e[i]=null:e.hasAttribute(i)&&e.removeAttribute(i)),e.addEventListener(t,n,r)))}}function eu(e,t,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Bd("error",e),Bd("load",e);var n,r=!1,a=!1;for(n in i)if(i.hasOwnProperty(n)){var s=i[n];if(null!=s)switch(n){case"src":r=!0;break;case"srcSet":a=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Jd(e,t,n,s,i,null)}}return a&&Jd(e,t,"srcSet",i.srcSet,i,null),void(r&&Jd(e,t,"src",i.src,i,null));case"input":Bd("invalid",e);var l=n=s=a=null,c=null,d=null;for(r in i)if(i.hasOwnProperty(r)){var u=i[r];if(null!=u)switch(r){case"name":a=u;break;case"type":s=u;break;case"checked":c=u;break;case"defaultChecked":d=u;break;case"value":n=u;break;case"defaultValue":l=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(o(137,t));break;default:Jd(e,t,r,u,i,null)}}return vt(e,n,l,c,d,s,a,!1),void ut(e);case"select":for(a in Bd("invalid",e),r=s=n=null,i)if(i.hasOwnProperty(a)&&null!=(l=i[a]))switch(a){case"value":n=l;break;case"defaultValue":s=l;break;case"multiple":r=l;default:Jd(e,t,a,l,i,null)}return t=n,i=s,e.multiple=!!r,void(null!=t?bt(e,!!r,t,!1):null!=i&&bt(e,!!r,i,!0));case"textarea":for(s in Bd("invalid",e),n=a=r=null,i)if(i.hasOwnProperty(s)&&null!=(l=i[s]))switch(s){case"value":r=l;break;case"defaultValue":a=l;break;case"children":n=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(o(91));break;default:Jd(e,t,s,l,i,null)}return wt(e,r,a,n),void ut(e);case"option":for(c in i)if(i.hasOwnProperty(c)&&null!=(r=i[c]))if("selected"===c)e.selected=r&&"function"!==typeof r&&"symbol"!==typeof r;else Jd(e,t,c,r,i,null);return;case"dialog":Bd("beforetoggle",e),Bd("toggle",e),Bd("cancel",e),Bd("close",e);break;case"iframe":case"object":Bd("load",e);break;case"video":case"audio":for(r=0;r<Rd.length;r++)Bd(Rd[r],e);break;case"image":Bd("error",e),Bd("load",e);break;case"details":Bd("toggle",e);break;case"embed":case"source":case"link":Bd("error",e),Bd("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in i)if(i.hasOwnProperty(d)&&null!=(r=i[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Jd(e,t,d,r,i,null)}return;default:if(At(t)){for(u in i)i.hasOwnProperty(u)&&(void 0!==(r=i[u])&&$d(e,t,u,r,i,void 0));return}}for(l in i)i.hasOwnProperty(l)&&(null!=(r=i[l])&&Jd(e,t,l,r,i,null))}var tu=null,iu=null;function nu(e){return 9===e.nodeType?e:e.ownerDocument}function ru(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function au(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function ou(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var su=null;var lu="function"===typeof setTimeout?setTimeout:void 0,cu="function"===typeof clearTimeout?clearTimeout:void 0,du="function"===typeof Promise?Promise:void 0,uu="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof du?function(e){return du.resolve(null).then(e).catch(hu)}:lu;function hu(e){setTimeout(function(){throw e})}function pu(e){return"head"===e}function fu(e,t){var i=t,n=0,r=0;do{var a=i.nextSibling;if(e.removeChild(i),a&&8===a.nodeType)if("/$"===(i=a.data)){if(0<n&&8>n){i=n;var o=e.ownerDocument;if(1&i&&wu(o.documentElement),2&i&&wu(o.body),4&i)for(wu(i=o.head),o=i.firstChild;o;){var s=o.nextSibling,l=o.nodeName;o[Fe]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===o.rel.toLowerCase()||i.removeChild(o),o=s}}if(0===r)return e.removeChild(a),void Mh(t);r--}else"$"===i||"$?"===i||"$!"===i?r++:n=i.charCodeAt(0)-48;else n=0;i=a}while(i);Mh(t)}function mu(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var i=t;switch(t=t.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":mu(i),Ue(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===i.rel.toLowerCase())continue}e.removeChild(i)}}function gu(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function vu(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var yu=null;function bu(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var i=e.data;if("$"===i||"$!"===i||"$?"===i){if(0===t)return e;t--}else"/$"===i&&t++}e=e.previousSibling}return null}function xu(e,t,i){switch(t=nu(i),e){case"html":if(!(e=t.documentElement))throw Error(o(452));return e;case"head":if(!(e=t.head))throw Error(o(453));return e;case"body":if(!(e=t.body))throw Error(o(454));return e;default:throw Error(o(451))}}function wu(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ue(e)}var Su=new Map,_u=new Set;function Cu(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Eu=z.d;z.d={f:function(){var e=Eu.f(),t=Vc();return e||t},r:function(e){var t=je(e);null!==t&&5===t.tag&&"form"===t.type?ko(t):Eu.r(e)},D:function(e){Eu.D(e),Mu("dns-prefetch",e,null)},C:function(e,t){Eu.C(e,t),Mu("preconnect",e,t)},L:function(e,t,i){Eu.L(e,t,i);var n=Au;if(n&&e&&t){var r='link[rel="preload"][as="'+mt(t)+'"]';"image"===t&&i&&i.imageSrcSet?(r+='[imagesrcset="'+mt(i.imageSrcSet)+'"]',"string"===typeof i.imageSizes&&(r+='[imagesizes="'+mt(i.imageSizes)+'"]')):r+='[href="'+mt(e)+'"]';var a=r;switch(t){case"style":a=Pu(e);break;case"script":a=Iu(e)}Su.has(a)||(e=h({rel:"preload",href:"image"===t&&i&&i.imageSrcSet?void 0:e,as:t},i),Su.set(a,e),null!==n.querySelector(r)||"style"===t&&n.querySelector(Du(a))||"script"===t&&n.querySelector(ku(a))||(eu(t=n.createElement("link"),"link",e),Ge(t),n.head.appendChild(t)))}},m:function(e,t){Eu.m(e,t);var i=Au;if(i&&e){var n=t&&"string"===typeof t.as?t.as:"script",r='link[rel="modulepreload"][as="'+mt(n)+'"][href="'+mt(e)+'"]',a=r;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":a=Iu(e)}if(!Su.has(a)&&(e=h({rel:"modulepreload",href:e},t),Su.set(a,e),null===i.querySelector(r))){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(ku(a)))return}eu(n=i.createElement("link"),"link",e),Ge(n),i.head.appendChild(n)}}},X:function(e,t){Eu.X(e,t);var i=Au;if(i&&e){var n=He(i).hoistableScripts,r=Iu(e),a=n.get(r);a||((a=i.querySelector(ku(r)))||(e=h({src:e,async:!0},t),(t=Su.get(r))&&Bu(e,t),Ge(a=i.createElement("script")),eu(a,"link",e),i.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},n.set(r,a))}},S:function(e,t,i){Eu.S(e,t,i);var n=Au;if(n&&e){var r=He(n).hoistableStyles,a=Pu(e);t=t||"default";var o=r.get(a);if(!o){var s={loading:0,preload:null};if(o=n.querySelector(Du(a)))s.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},i),(i=Su.get(a))&&Lu(e,i);var l=o=n.createElement("link");Ge(l),eu(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){s.loading|=1}),l.addEventListener("error",function(){s.loading|=2}),s.loading|=4,zu(o,t,n)}o={type:"stylesheet",instance:o,count:1,state:s},r.set(a,o)}}},M:function(e,t){Eu.M(e,t);var i=Au;if(i&&e){var n=He(i).hoistableScripts,r=Iu(e),a=n.get(r);a||((a=i.querySelector(ku(r)))||(e=h({src:e,async:!0,type:"module"},t),(t=Su.get(r))&&Bu(e,t),Ge(a=i.createElement("script")),eu(a,"link",e),i.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},n.set(r,a))}}};var Au="undefined"===typeof document?null:document;function Mu(e,t,i){var n=Au;if(n&&"string"===typeof t&&t){var r=mt(t);r='link[rel="'+e+'"][href="'+r+'"]',"string"===typeof i&&(r+='[crossorigin="'+i+'"]'),_u.has(r)||(_u.add(r),e={rel:e,crossOrigin:i,href:t},null===n.querySelector(r)&&(eu(t=n.createElement("link"),"link",e),Ge(t),n.head.appendChild(t)))}}function Tu(e,t,i,n){var r,a,s,l,c=(c=H.current)?Cu(c):null;if(!c)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof i.precedence&&"string"===typeof i.href?(t=Pu(i.href),(n=(i=He(c).hoistableStyles).get(t))||(n={type:"style",instance:null,count:0,state:null},i.set(t,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===i.rel&&"string"===typeof i.href&&"string"===typeof i.precedence){e=Pu(i.href);var d=He(c).hoistableStyles,u=d.get(e);if(u||(c=c.ownerDocument||c,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,u),(d=c.querySelector(Du(e)))&&!d._p&&(u.instance=d,u.state.loading=5),Su.has(e)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},Su.set(e,i),d||(r=c,a=e,s=i,l=u.state,r.querySelector('link[rel="preload"][as="style"]['+a+"]")?l.loading=1:(a=r.createElement("link"),l.preload=a,a.addEventListener("load",function(){return l.loading|=1}),a.addEventListener("error",function(){return l.loading|=2}),eu(a,"link",s),Ge(a),r.head.appendChild(a))))),t&&null===n)throw Error(o(528,""));return u}if(t&&null!==n)throw Error(o(529,""));return null;case"script":return t=i.async,"string"===typeof(i=i.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Iu(i),(n=(i=He(c).hoistableScripts).get(t))||(n={type:"script",instance:null,count:0,state:null},i.set(t,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function Pu(e){return'href="'+mt(e)+'"'}function Du(e){return'link[rel="stylesheet"]['+e+"]"}function Ou(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Iu(e){return'[src="'+mt(e)+'"]'}function ku(e){return"script[async]"+e}function Ru(e,t,i){if(t.count++,null===t.instance)switch(t.type){case"style":var n=e.querySelector('style[data-href~="'+mt(i.href)+'"]');if(n)return t.instance=n,Ge(n),n;var r=h({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return Ge(n=(e.ownerDocument||e).createElement("style")),eu(n,"style",r),zu(n,i.precedence,e),t.instance=n;case"stylesheet":r=Pu(i.href);var a=e.querySelector(Du(r));if(a)return t.state.loading|=4,t.instance=a,Ge(a),a;n=Ou(i),(r=Su.get(r))&&Lu(n,r),Ge(a=(e.ownerDocument||e).createElement("link"));var s=a;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),eu(a,"link",n),t.state.loading|=4,zu(a,i.precedence,e),t.instance=a;case"script":return a=Iu(i.src),(r=e.querySelector(ku(a)))?(t.instance=r,Ge(r),r):(n=i,(r=Su.get(a))&&Bu(n=h({},i),r),Ge(r=(e=e.ownerDocument||e).createElement("script")),eu(r,"link",n),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(o(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(n=t.instance,t.state.loading|=4,zu(n,i.precedence,e));return t.instance}function zu(e,t,i){for(var n=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=n.length?n[n.length-1]:null,a=r,o=0;o<n.length;o++){var s=n[o];if(s.dataset.precedence===t)a=s;else if(a!==r)break}a?a.parentNode.insertBefore(e,a.nextSibling):(t=9===i.nodeType?i.head:i).insertBefore(e,t.firstChild)}function Lu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Bu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Nu=null;function Fu(e,t,i){if(null===Nu){var n=new Map,r=Nu=new Map;r.set(i,n)}else(n=(r=Nu).get(i))||(n=new Map,r.set(i,n));if(n.has(e))return n;for(n.set(e,null),i=i.getElementsByTagName(e),r=0;r<i.length;r++){var a=i[r];if(!(a[Fe]||a[Ie]||"link"===e&&"stylesheet"===a.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==a.namespaceURI){var o=a.getAttribute(t)||"";o=e+o;var s=n.get(o);s?s.push(a):n.set(o,[a])}}return n}function Uu(e,t,i){(e=e.ownerDocument||e).head.insertBefore(i,"title"===t?e.querySelector("head > title"):null)}function Vu(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var ju=null;function Wu(){}function Hu(){if(this.count--,0===this.count)if(this.stylesheets)qu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Gu=null;function qu(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Gu=new Map,t.forEach(Xu,e),Gu=null,Hu.call(e))}function Xu(e,t){if(!(4&t.state.loading)){var i=Gu.get(e);if(i)var n=i.get(null);else{i=new Map,Gu.set(e,i);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),a=0;a<r.length;a++){var o=r[a];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(i.set(o.dataset.precedence,o),n=o)}n&&i.set(null,n)}o=(r=t.instance).getAttribute("data-precedence"),(a=i.get(o)||n)===n&&i.set(null,r),i.set(o,r),this.count++,n=Hu.bind(this),r.addEventListener("load",n),r.addEventListener("error",n),a?a.parentNode.insertBefore(r,a.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(r,e.firstChild),t.state.loading|=4}}var Yu={$$typeof:w,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function Qu(e,t,i,n,r,a,o,s){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ce(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ce(0),this.hiddenUpdates=Ce(null),this.identifierPrefix=n,this.onUncaughtError=r,this.onCaughtError=a,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=s,this.incompleteTransitions=new Map}function Ku(e,t,i,n,r,a,o,s,l,c,d,u){return e=new Qu(e,t,i,o,s,l,c,u),t=1,!0===a&&(t|=24),a=Ln(3,null,null,t),e.current=a,a.stateNode=e,(t=kr()).refCount++,e.pooledCache=t,t.refCount++,a.memoizedState={element:n,isDehydrated:i,cache:t},ia(a),e}function Zu(e){return e?e=Rn:Rn}function Ju(e,t,i,n,r,a){r=Zu(r),null===n.context?n.context=r:n.pendingContext=r,(n=ra(t)).payload={element:i},null!==(a=void 0===a?null:a)&&(n.callback=a),null!==(i=aa(e,n,t))&&(Lc(i,0,t),oa(i,e,t))}function $u(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var i=e.retryLane;e.retryLane=0!==i&&i<t?i:t}}function eh(e,t){$u(e,t),(e=e.alternate)&&$u(e,t)}function th(e){if(13===e.tag){var t=On(e,67108864);null!==t&&Lc(t,0,67108864),eh(e,67108864)}}var ih=!0;function nh(e,t,i,n){var r=R.T;R.T=null;var a=z.p;try{z.p=2,ah(e,t,i,n)}finally{z.p=a,R.T=r}}function rh(e,t,i,n){var r=R.T;R.T=null;var a=z.p;try{z.p=8,ah(e,t,i,n)}finally{z.p=a,R.T=r}}function ah(e,t,i,n){if(ih){var r=oh(n);if(null===r)jd(e,t,n,sh,i),yh(e,n);else if(function(e,t,i,n,r){switch(t){case"focusin":return uh=bh(uh,e,t,i,n,r),!0;case"dragenter":return hh=bh(hh,e,t,i,n,r),!0;case"mouseover":return ph=bh(ph,e,t,i,n,r),!0;case"pointerover":var a=r.pointerId;return fh.set(a,bh(fh.get(a)||null,e,t,i,n,r)),!0;case"gotpointercapture":return a=r.pointerId,mh.set(a,bh(mh.get(a)||null,e,t,i,n,r)),!0}return!1}(r,e,t,i,n))n.stopPropagation();else if(yh(e,n),4&t&&-1<vh.indexOf(e)){for(;null!==r;){var a=je(r);if(null!==a)switch(a.tag){case 3:if((a=a.stateNode).current.memoizedState.isDehydrated){var o=ye(a.pendingLanes);if(0!==o){var s=a;for(s.pendingLanes|=2,s.entangledLanes|=2;o;){var l=1<<31-pe(o);s.entanglements[1]|=l,o&=~l}Sd(a),0===(6&ic)&&(Sc=te()+500,_d(0,!1))}}break;case 13:null!==(s=On(a,2))&&Lc(s,0,2),Vc(),eh(a,2)}if(null===(a=oh(n))&&jd(e,t,n,sh,i),a===r)break;r=a}null!==r&&n.stopPropagation()}else jd(e,t,n,null,i)}}function oh(e){return lh(e=Ot(e))}var sh=null;function lh(e){if(sh=null,null!==(e=Ve(e))){var t=l(e);if(null===t)e=null;else{var i=t.tag;if(13===i){if(null!==(e=c(t)))return e;e=null}else if(3===i){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return sh=e,null}function ch(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ie()){case ne:return 2;case re:return 8;case ae:case oe:return 32;case se:return 268435456;default:return 32}default:return 32}}var dh=!1,uh=null,hh=null,ph=null,fh=new Map,mh=new Map,gh=[],vh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yh(e,t){switch(e){case"focusin":case"focusout":uh=null;break;case"dragenter":case"dragleave":hh=null;break;case"mouseover":case"mouseout":ph=null;break;case"pointerover":case"pointerout":fh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":mh.delete(t.pointerId)}}function bh(e,t,i,n,r,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:i,eventSystemFlags:n,nativeEvent:a,targetContainers:[r]},null!==t&&(null!==(t=je(t))&&th(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function xh(e){var t=Ve(e.target);if(null!==t){var i=l(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=c(i)))return e.blockedOn=t,void function(e,t){var i=z.p;try{return z.p=e,t()}finally{z.p=i}}(e.priority,function(){if(13===i.tag){var e=Rc();e=Te(e);var t=On(i,e);null!==t&&Lc(t,0,e),eh(i,e)}})}else if(3===t&&i.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}e.blockedOn=null}function wh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var i=oh(e.nativeEvent);if(null!==i)return null!==(t=je(i))&&th(t),e.blockedOn=i,!1;var n=new(i=e.nativeEvent).constructor(i.type,i);Dt=n,i.target.dispatchEvent(n),Dt=null,t.shift()}return!0}function Sh(e,t,i){wh(e)&&i.delete(t)}function _h(){dh=!1,null!==uh&&wh(uh)&&(uh=null),null!==hh&&wh(hh)&&(hh=null),null!==ph&&wh(ph)&&(ph=null),fh.forEach(Sh),mh.forEach(Sh)}function Ch(e,t){e.blockedOn===t&&(e.blockedOn=null,dh||(dh=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,_h)))}var Eh=null;function Ah(e){Eh!==e&&(Eh=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Eh===e&&(Eh=null);for(var t=0;t<e.length;t+=3){var i=e[t],n=e[t+1],r=e[t+2];if("function"!==typeof n){if(null===lh(n||i))continue;break}var a=je(i);null!==a&&(e.splice(t,3),t-=3,Oo(a,{pending:!0,data:r,method:i.method,action:n},n,r))}}))}function Mh(e){function t(t){return Ch(t,e)}null!==uh&&Ch(uh,e),null!==hh&&Ch(hh,e),null!==ph&&Ch(ph,e),fh.forEach(t),mh.forEach(t);for(var i=0;i<gh.length;i++){var n=gh[i];n.blockedOn===e&&(n.blockedOn=null)}for(;0<gh.length&&null===(i=gh[0]).blockedOn;)xh(i),null===i.blockedOn&&gh.shift();if(null!=(i=(e.ownerDocument||e).$$reactFormReplay))for(n=0;n<i.length;n+=3){var r=i[n],a=i[n+1],o=r[ke]||null;if("function"===typeof a)o||Ah(i);else if(o){var s=null;if(a&&a.hasAttribute("formAction")){if(r=a,o=a[ke]||null)s=o.formAction;else if(null!==lh(r))continue}else s=o.action;"function"===typeof s?i[n+1]=s:(i.splice(n,3),n-=3),Ah(i)}}}function Th(e){this._internalRoot=e}function Ph(e){this._internalRoot=e}Ph.prototype.render=Th.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Ju(t.current,Rc(),e,t,null,null)},Ph.prototype.unmount=Th.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Ju(e.current,2,null,e,null,null),Vc(),t[Re]=null}},Ph.prototype.unstable_scheduleHydration=function(e){if(e){var t=De();e={blockedOn:null,target:e,priority:t};for(var i=0;i<gh.length&&0!==t&&t<gh[i].priority;i++);gh.splice(i,0,e),0===i&&xh(e)}};var Dh=r.version;if("19.1.1"!==Dh)throw Error(o(527,Dh,"19.1.1"));z.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(o(188));return t!==e?null:e}for(var i=e,n=t;;){var r=i.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(n=r.return)){i=n;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===i)return d(r),e;if(a===n)return d(r),t;a=a.sibling}throw Error(o(188))}if(i.return!==n.return)i=r,n=a;else{for(var s=!1,c=r.child;c;){if(c===i){s=!0,i=r,n=a;break}if(c===n){s=!0,n=r,i=a;break}c=c.sibling}if(!s){for(c=a.child;c;){if(c===i){s=!0,i=a,n=r;break}if(c===n){s=!0,n=a,i=r;break}c=c.sibling}if(!s)throw Error(o(189))}}if(i.alternate!==n)throw Error(o(190))}if(3!==i.tag)throw Error(o(188));return i.stateNode.current===i?e:t}(t),e=null===(e=null!==e?u(e):null)?null:e.stateNode};var Oh={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:R,reconcilerVersion:"19.1.1"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Ih=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ih.isDisabled&&Ih.supportsFiber)try{de=Ih.inject(Oh),ue=Ih}catch(Rh){}}t.createRoot=function(e,t){if(!s(e))throw Error(o(299));var i=!1,n="",r=ys,a=bs,l=xs;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(i=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onUncaughtError&&(r=t.onUncaughtError),void 0!==t.onCaughtError&&(a=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Ku(e,1,!1,null,0,i,n,r,a,l,0,null),e[Re]=t.current,Ud(e),new Th(t)},t.hydrateRoot=function(e,t,i){if(!s(e))throw Error(o(299));var n=!1,r="",a=ys,l=bs,c=xs,d=null;return null!==i&&void 0!==i&&(!0===i.unstable_strictMode&&(n=!0),void 0!==i.identifierPrefix&&(r=i.identifierPrefix),void 0!==i.onUncaughtError&&(a=i.onUncaughtError),void 0!==i.onCaughtError&&(l=i.onCaughtError),void 0!==i.onRecoverableError&&(c=i.onRecoverableError),void 0!==i.unstable_transitionCallbacks&&i.unstable_transitionCallbacks,void 0!==i.formState&&(d=i.formState)),(t=Ku(e,1,!0,t,0,n,r,a,l,c,0,d)).context=Zu(null),i=t.current,(r=ra(n=Te(n=Rc()))).callback=null,aa(i,r,n),i=n,t.current.lanes=i,Ee(t,i),Sd(t),e[Re]=t.current,Ud(e),new Ph(t)},t.version="19.1.1"},43:(e,t,i)=>{"use strict";e.exports=i(288)},219:(e,t,i)=>{"use strict";var n=i(763),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return n.isMemo(e)?o:s[e.$$typeof]||r}s[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[n.Memo]=o;var c=Object.defineProperty,d=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,i,n){if("string"!==typeof i){if(f){var r=p(i);r&&r!==f&&e(t,r,n)}var o=d(i);u&&(o=o.concat(u(i)));for(var s=l(t),m=l(i),g=0;g<o.length;++g){var v=o[g];if(!a[v]&&(!n||!n[v])&&(!m||!m[v])&&(!s||!s[v])){var y=h(i,v);try{c(t,v,y)}catch(b){}}}}return t}},288:(e,t)=>{"use strict";var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,i){this.props=e,this.context=t,this.refs=g,this.updater=i||f}function y(){}function b(e,t,i){this.props=e,this.context=t,this.refs=g,this.updater=i||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var x=b.prototype=new y;x.constructor=b,m(x,v.prototype),x.isPureReactComponent=!0;var w=Array.isArray,S={H:null,A:null,T:null,S:null,V:null},_=Object.prototype.hasOwnProperty;function C(e,t,n,r,a,o){return n=o.ref,{$$typeof:i,type:e,key:t,ref:void 0!==n?n:null,props:o}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var A=/\/+/g;function M(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function T(){}function P(e,t,r,a,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l,c,d=!1;if(null===e)d=!0;else switch(s){case"bigint":case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case i:case n:d=!0;break;case h:return P((d=e._init)(e._payload),t,r,a,o)}}if(d)return o=o(e),d=""===a?"."+M(e,0):a,w(o)?(r="",null!=d&&(r=d.replace(A,"$&/")+"/"),P(o,t,r,"",function(e){return e})):null!=o&&(E(o)&&(l=o,c=r+(null==o.key||e&&e.key===o.key?"":(""+o.key).replace(A,"$&/")+"/")+d,o=C(l.type,c,void 0,0,0,l.props)),t.push(o)),1;d=0;var u,f=""===a?".":a+":";if(w(e))for(var m=0;m<e.length;m++)d+=P(a=e[m],t,r,s=f+M(a,m),o);else if("function"===typeof(m=null===(u=e)||"object"!==typeof u?null:"function"===typeof(u=p&&u[p]||u["@@iterator"])?u:null))for(e=m.call(e),m=0;!(a=e.next()).done;)d+=P(a=a.value,t,r,s=f+M(a,m++),o);else if("object"===s){if("function"===typeof e.then)return P(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(T,T):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,r,a,o);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return d}function D(e,t,i){if(null==e)return e;var n=[],r=0;return P(e,n,"","",function(e){return t.call(i,e,r++)}),n}function O(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function k(){}t.Children={map:D,forEach:function(e,t,i){D(e,function(){t.apply(this,arguments)},i)},count:function(e){var t=0;return D(e,function(){t++}),t},toArray:function(e){return D(e,function(e){return e})||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=o,t.PureComponent=b,t.StrictMode=a,t.Suspense=d,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return S.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var n=m({},e.props),r=e.key;if(null!=t)for(a in void 0!==t.ref&&void 0,void 0!==t.key&&(r=""+t.key),t)!_.call(t,a)||"key"===a||"__self"===a||"__source"===a||"ref"===a&&void 0===t.ref||(n[a]=t[a]);var a=arguments.length-2;if(1===a)n.children=i;else if(1<a){for(var o=Array(a),s=0;s<a;s++)o[s]=arguments[s+2];n.children=o}return C(e.type,r,void 0,0,0,n)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:s,_context:e},e},t.createElement=function(e,t,i){var n,r={},a=null;if(null!=t)for(n in void 0!==t.key&&(a=""+t.key),t)_.call(t,n)&&"key"!==n&&"__self"!==n&&"__source"!==n&&(r[n]=t[n]);var o=arguments.length-2;if(1===o)r.children=i;else if(1<o){for(var s=Array(o),l=0;l<o;l++)s[l]=arguments[l+2];r.children=s}if(e&&e.defaultProps)for(n in o=e.defaultProps)void 0===r[n]&&(r[n]=o[n]);return C(e,a,void 0,0,0,r)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=S.T,i={};S.T=i;try{var n=e(),r=S.S;null!==r&&r(i,n),"object"===typeof n&&null!==n&&"function"===typeof n.then&&n.then(k,I)}catch(a){I(a)}finally{S.T=t}},t.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},t.use=function(e){return S.H.use(e)},t.useActionState=function(e,t,i){return S.H.useActionState(e,t,i)},t.useCallback=function(e,t){return S.H.useCallback(e,t)},t.useContext=function(e){return S.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return S.H.useDeferredValue(e,t)},t.useEffect=function(e,t,i){var n=S.H;if("function"===typeof i)throw Error("useEffect CRUD overload is not enabled in this build of React.");return n.useEffect(e,t)},t.useId=function(){return S.H.useId()},t.useImperativeHandle=function(e,t,i){return S.H.useImperativeHandle(e,t,i)},t.useInsertionEffect=function(e,t){return S.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return S.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return S.H.useMemo(e,t)},t.useOptimistic=function(e,t){return S.H.useOptimistic(e,t)},t.useReducer=function(e,t,i){return S.H.useReducer(e,t,i)},t.useRef=function(e){return S.H.useRef(e)},t.useState=function(e){return S.H.useState(e)},t.useSyncExternalStore=function(e,t,i){return S.H.useSyncExternalStore(e,t,i)},t.useTransition=function(){return S.H.useTransition()},t.version="19.1.1"},376:e=>{e.exports=o,o.default=o,o.stable=d,o.stableStringify=d;var t="[...]",i="[Circular]",n=[],r=[];function a(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function o(e,t,i,o){var s;"undefined"===typeof o&&(o=a()),l(e,"",0,[],void 0,0,o);try{s=0===r.length?JSON.stringify(e,t,i):JSON.stringify(e,h(t),i)}catch(d){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==n.length;){var c=n.pop();4===c.length?Object.defineProperty(c[0],c[1],c[3]):c[0][c[1]]=c[2]}}return s}function s(e,t,i,a){var o=Object.getOwnPropertyDescriptor(a,i);void 0!==o.get?o.configurable?(Object.defineProperty(a,i,{value:e}),n.push([a,i,t,o])):r.push([t,i,e]):(a[i]=e,n.push([a,i,t]))}function l(e,n,r,a,o,c,d){var u;if(c+=1,"object"===typeof e&&null!==e){for(u=0;u<a.length;u++)if(a[u]===e)return void s(i,e,n,o);if("undefined"!==typeof d.depthLimit&&c>d.depthLimit)return void s(t,e,n,o);if("undefined"!==typeof d.edgesLimit&&r+1>d.edgesLimit)return void s(t,e,n,o);if(a.push(e),Array.isArray(e))for(u=0;u<e.length;u++)l(e[u],u,u,a,e,c,d);else{var h=Object.keys(e);for(u=0;u<h.length;u++){var p=h[u];l(e[p],p,u,a,e,c,d)}}a.pop()}}function c(e,t){return e<t?-1:e>t?1:0}function d(e,t,i,o){"undefined"===typeof o&&(o=a());var s,l=u(e,"",0,[],void 0,0,o)||e;try{s=0===r.length?JSON.stringify(l,t,i):JSON.stringify(l,h(t),i)}catch(d){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==n.length;){var c=n.pop();4===c.length?Object.defineProperty(c[0],c[1],c[3]):c[0][c[1]]=c[2]}}return s}function u(e,r,a,o,l,d,h){var p;if(d+=1,"object"===typeof e&&null!==e){for(p=0;p<o.length;p++)if(o[p]===e)return void s(i,e,r,l);try{if("function"===typeof e.toJSON)return}catch(v){return}if("undefined"!==typeof h.depthLimit&&d>h.depthLimit)return void s(t,e,r,l);if("undefined"!==typeof h.edgesLimit&&a+1>h.edgesLimit)return void s(t,e,r,l);if(o.push(e),Array.isArray(e))for(p=0;p<e.length;p++)u(e[p],p,p,o,e,d,h);else{var f={},m=Object.keys(e).sort(c);for(p=0;p<m.length;p++){var g=m[p];u(e[g],g,p,o,e,d,h),f[g]=e[g]}if("undefined"===typeof l)return f;n.push([l,r,e]),l[r]=f}o.pop()}}function h(e){return e="undefined"!==typeof e?e:function(e,t){return t},function(t,i){if(r.length>0)for(var n=0;n<r.length;n++){var a=r[n];if(a[1]===t&&a[0]===i){i=a[2],r.splice(n,1);break}}return e.call(this,t,i)}}},391:(e,t,i)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=i(4)},446:(e,t,i)=>{var n=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt,l="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,c="object"==typeof self&&self&&self.Object===Object&&self,d=l||c||Function("return this")(),u=Object.prototype.toString,h=Math.max,p=Math.min,f=function(){return d.Date.now()};function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var i=a.test(e);return i||o.test(e)?s(e.slice(2),i?2:8):r.test(e)?NaN:+e}e.exports=function(e,t,i){var n,r,a,o,s,l,c=0,d=!1,u=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var i=n,a=r;return n=r=void 0,c=t,o=e.apply(a,i)}function b(e){var i=e-l;return void 0===l||i>=t||i<0||u&&e-c>=a}function x(){var e=f();if(b(e))return w(e);s=setTimeout(x,function(e){var i=t-(e-l);return u?p(i,a-(e-c)):i}(e))}function w(e){return s=void 0,v&&n?y(e):(n=r=void 0,o)}function S(){var e=f(),i=b(e);if(n=arguments,r=this,l=e,i){if(void 0===s)return function(e){return c=e,s=setTimeout(x,t),d?y(e):o}(l);if(u)return s=setTimeout(x,t),y(l)}return void 0===s&&(s=setTimeout(x,t)),o}return t=g(t)||0,m(i)&&(d=!!i.leading,a=(u="maxWait"in i)?h(g(i.maxWait)||0,t):a,v="trailing"in i?!!i.trailing:v),S.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=l=r=s=void 0},S.flush=function(){return void 0===s?o:w(f())},S}},579:(e,t,i)=>{"use strict";e.exports=i(799)},672:(e,t,i)=>{"use strict";var n=i(43);function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var o={d:{f:a,r:function(){throw Error(r(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},s=Symbol.for("react.portal");var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,t.createPortal=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(r(299));return function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:s,key:null==n?null:""+n,children:e,containerInfo:t,implementation:i}}(e,t,null,i)},t.flushSync=function(e){var t=l.T,i=o.p;try{if(l.T=null,o.p=2,e)return e()}finally{l.T=t,o.p=i,o.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,o.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&o.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var i=t.as,n=c(i,t.crossOrigin),r="string"===typeof t.integrity?t.integrity:void 0,a="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===i?o.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:n,integrity:r,fetchPriority:a}):"script"===i&&o.d.X(e,{crossOrigin:n,integrity:r,fetchPriority:a,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var i=c(t.as,t.crossOrigin);o.d.M(e,{crossOrigin:i,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&o.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var i=t.as,n=c(i,t.crossOrigin);o.d.L(e,i,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var i=c(t.as,t.crossOrigin);o.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:i,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else o.d.m(e)},t.requestFormReset=function(e){o.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,i){return l.H.useFormState(e,t,i)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.1"},763:(e,t,i)=>{"use strict";e.exports=i(983)},799:(e,t)=>{"use strict";var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function r(e,t,n){var r=null;if(void 0!==n&&(r=""+n),void 0!==t.key&&(r=""+t.key),"key"in t)for(var a in n={},t)"key"!==a&&(n[a]=t[a]);else n=t;return t=n.ref,{$$typeof:i,type:e,key:r,ref:void 0!==t?t:null,props:n}}t.Fragment=n,t.jsx=r,t.jsxs=r},853:(e,t,i)=>{"use strict";e.exports=i(896)},896:(e,t)=>{"use strict";function i(e,t){var i=e.length;e.push(t);e:for(;0<i;){var n=i-1>>>1,r=e[n];if(!(0<a(r,t)))break e;e[n]=t,e[i]=r,i=n}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],i=e.pop();if(i!==t){e[0]=i;e:for(var n=0,r=e.length,o=r>>>1;n<o;){var s=2*(n+1)-1,l=e[s],c=s+1,d=e[c];if(0>a(l,i))c<r&&0>a(d,l)?(e[n]=d,e[c]=i,n=c):(e[n]=l,e[s]=i,n=s);else{if(!(c<r&&0>a(d,i)))break e;e[n]=d,e[c]=i,n=c}}}return t}function a(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],d=[],u=1,h=null,p=3,f=!1,m=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=n(d);null!==t;){if(null===t.callback)r(d);else{if(!(t.startTime<=e))break;r(d),t.sortIndex=t.expirationTime,i(c,t)}t=n(d)}}function S(e){if(g=!1,w(e),!m)if(null!==n(c))m=!0,C||(C=!0,_());else{var t=n(d);null!==t&&I(S,t.startTime-e)}}var _,C=!1,E=-1,A=5,M=-1;function T(){return!!v||!(t.unstable_now()-M<A)}function P(){if(v=!1,C){var e=t.unstable_now();M=e;var i=!0;try{e:{m=!1,g&&(g=!1,b(E),E=-1),f=!0;var a=p;try{t:{for(w(e),h=n(c);null!==h&&!(h.expirationTime>e&&T());){var o=h.callback;if("function"===typeof o){h.callback=null,p=h.priorityLevel;var s=o(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof s){h.callback=s,w(e),i=!0;break t}h===n(c)&&r(c),w(e)}else r(c);h=n(c)}if(null!==h)i=!0;else{var l=n(d);null!==l&&I(S,l.startTime-e),i=!1}}break e}finally{h=null,p=a,f=!1}i=void 0}}finally{i?_():C=!1}}}if("function"===typeof x)_=function(){x(P)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,O=D.port2;D.port1.onmessage=P,_=function(){O.postMessage(null)}}else _=function(){y(P,0)};function I(e,i){E=y(function(){e(t.unstable_now())},i)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var i=p;p=t;try{return e()}finally{p=i}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=p;p=e;try{return t()}finally{p=i}},t.unstable_scheduleCallback=function(e,r,a){var o=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(e.sortIndex=a,i(d,e),null===n(c)&&e===n(d)&&(g?(b(E),E=-1):g=!0,I(S,a-o))):(e.sortIndex=s,i(c,e),m||f||(m=!0,C||(C=!0,_()))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=p;return function(){var i=p;p=t;try{return e.apply(this,arguments)}finally{p=i}}}},950:(e,t,i)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=i(672)},983:(e,t)=>{"use strict";var i="function"===typeof Symbol&&Symbol.for,n=i?Symbol.for("react.element"):60103,r=i?Symbol.for("react.portal"):60106,a=i?Symbol.for("react.fragment"):60107,o=i?Symbol.for("react.strict_mode"):60108,s=i?Symbol.for("react.profiler"):60114,l=i?Symbol.for("react.provider"):60109,c=i?Symbol.for("react.context"):60110,d=i?Symbol.for("react.async_mode"):60111,u=i?Symbol.for("react.concurrent_mode"):60111,h=i?Symbol.for("react.forward_ref"):60112,p=i?Symbol.for("react.suspense"):60113,f=i?Symbol.for("react.suspense_list"):60120,m=i?Symbol.for("react.memo"):60115,g=i?Symbol.for("react.lazy"):60116,v=i?Symbol.for("react.block"):60121,y=i?Symbol.for("react.fundamental"):60117,b=i?Symbol.for("react.responder"):60118,x=i?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case d:case u:case a:case s:case o:case p:return e;default:switch(e=e&&e.$$typeof){case c:case h:case g:case m:case l:return e;default:return t}}case r:return t}}}function S(e){return w(e)===u}t.AsyncMode=d,t.ConcurrentMode=u,t.ContextConsumer=c,t.ContextProvider=l,t.Element=n,t.ForwardRef=h,t.Fragment=a,t.Lazy=g,t.Memo=m,t.Portal=r,t.Profiler=s,t.StrictMode=o,t.Suspense=p,t.isAsyncMode=function(e){return S(e)||w(e)===d},t.isConcurrentMode=S,t.isContextConsumer=function(e){return w(e)===c},t.isContextProvider=function(e){return w(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return w(e)===h},t.isFragment=function(e){return w(e)===a},t.isLazy=function(e){return w(e)===g},t.isMemo=function(e){return w(e)===m},t.isPortal=function(e){return w(e)===r},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===o},t.isSuspense=function(e){return w(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===u||e===s||e===o||e===p||e===f||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===c||e.$$typeof===h||e.$$typeof===y||e.$$typeof===b||e.$$typeof===x||e.$$typeof===v)},t.typeOf=w}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,i),a.exports}i.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;i.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var a=Object.create(null);i.r(a);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&r&&n;("object"==typeof s||"function"==typeof s)&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>o[e]=()=>n[e]);return o.default=()=>n,i.d(a,o),a}})(),i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce((t,n)=>(i.f[n](e,t),t),[])),i.u=e=>"static/js/"+e+"."+{23:"d6464261",160:"a5e896c5",208:"557d1433",293:"d879f66e",453:"a86075b0",516:"e9c2238f",519:"9049c971",917:"b07cf83f",946:"9c68379e"}[e]+".chunk.js",i.miniCssF=e=>{},i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="rlfrey:";i.l=(n,r,a,o)=>{if(e[n])e[n].push(r);else{var s,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+a){s=u;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+a),s.src=n),e[n]=[r];var h=(t,i)=>{s.onerror=s.onload=null,clearTimeout(p);var r=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach(e=>e(i)),t)return t(i)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),i.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="/rlfrey/",(()=>{var e={792:0};i.f.j=(t,n)=>{var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var a=new Promise((i,n)=>r=e[t]=[i,n]);n.push(r[2]=a);var o=i.p+i.u(t),s=new Error;i.l(o,n=>{if(i.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,r[1](s)}},"chunk-"+t,t)}};var t=(t,n)=>{var r,a,o=n[0],s=n[1],l=n[2],c=0;if(o.some(t=>0!==e[t])){for(r in s)i.o(s,r)&&(i.m[r]=s[r]);if(l)l(i)}for(t&&t(n);c<o.length;c++)a=o[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunkrlfrey=self.webpackChunkrlfrey||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e=i(43),t=i.t(e,2),n=i(391);function r(e,t){if(null==e)return{};var i,n,r=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)i=a[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function o(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}function s(e,t,i){return(t=o(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function c(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?l(Object(i),!0).forEach(function(t){s(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}const d=["sri"],u=["page"],h=["page","matches"],p=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],f=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],m=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var g="popstate";function v(){return C(function(e,t){let{pathname:i,search:n,hash:r}=e.location;return w("",{pathname:i,search:n,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:S(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function y(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function b(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(VU){}}}function x(e,t){return{usr:e.state,key:e.key,idx:t}}function w(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;return c(c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?_(t):t),{},{state:i,key:t&&t.key||n||Math.random().toString(36).substring(2,10)})}function S(e){let{pathname:t="/",search:i="",hash:n=""}=e;return i&&"?"!==i&&(t+="?"===i.charAt(0)?i:"?"+i),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function _(e){let t={};if(e){let i=e.indexOf("#");i>=0&&(t.hash=e.substring(i),e=e.substring(0,i));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function C(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:r=document.defaultView,v5Compat:a=!1}=n,o=r.history,s="POP",l=null,d=u();function u(){return(o.state||{idx:null}).idx}function h(){s="POP";let e=u(),t=null==e?null:e-d;d=e,l&&l({action:s,location:f.location,delta:t})}function p(e){return E(e)}null==d&&(d=0,o.replaceState(c(c({},o.state),{},{idx:d}),""));let f={get action(){return s},get location(){return e(r,o)},listen(e){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(g,h),l=e,()=>{r.removeEventListener(g,h),l=null}},createHref:e=>t(r,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){s="PUSH";let n=w(f.location,e,t);i&&i(n,e),d=u()+1;let c=x(n,d),h=f.createHref(n);try{o.pushState(c,"",h)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;r.location.assign(h)}a&&l&&l({action:s,location:f.location,delta:1})},replace:function(e,t){s="REPLACE";let n=w(f.location,e,t);i&&i(n,e),d=u();let r=x(n,d),c=f.createHref(n);o.replaceState(r,"",c),a&&l&&l({action:s,location:f.location,delta:0})},go:e=>o.go(e)};return f}function E(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i="http://localhost";"undefined"!==typeof window&&(i="null"!==window.location.origin?window.location.origin:window.location.href),y(i,"No window.location.(origin|href) available to create URL");let n="string"===typeof e?e:S(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=i+n),new URL(n,i)}new WeakMap;function A(e,t){return M(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function M(e,t,i,n){let r=j(("string"===typeof t?_(t):t).pathname||"/",i);if(null==r)return null;let a=T(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let i=e.length===t.length&&e.slice(0,-1).every((e,i)=>e===t[i]);return i?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(a);let o=null;for(let s=0;null==o&&s<a.length;++s){let e=V(r);o=N(a[s],e,n)}return o}function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=(e,r,a)=>{let o={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};o.relativePath.startsWith("/")&&(y(o.relativePath.startsWith(n),'Absolute route path "'.concat(o.relativePath,'" nested under path "').concat(n,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),o.relativePath=o.relativePath.slice(n.length));let s=X([n,o.relativePath]),l=i.concat(o);e.children&&e.children.length>0&&(y(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(s,'".')),T(e.children,t,l,s)),(null!=e.path||e.index)&&t.push({path:s,score:B(s,e.index),routesMeta:l})};return e.forEach((e,t)=>{var i;if(""!==e.path&&null!==(i=e.path)&&void 0!==i&&i.includes("?"))for(let n of P(e.path))r(e,t,n);else r(e,t)}),t}function P(e){let t=e.split("/");if(0===t.length)return[];let[i,...n]=t,r=i.endsWith("?"),a=i.replace(/\?$/,"");if(0===n.length)return r?[a,""]:[a];let o=P(n.join("/")),s=[];return s.push(...o.map(e=>""===e?a:[a,e].join("/"))),r&&s.push(...o),s.map(t=>e.startsWith("/")&&""===t?"/":t)}var D=/^:[\w-]+$/,O=3,I=2,k=1,R=10,z=-2,L=e=>"*"===e;function B(e,t){let i=e.split("/"),n=i.length;return i.some(L)&&(n+=z),t&&(n+=I),i.filter(e=>!L(e)).reduce((e,t)=>e+(D.test(t)?O:""===t?k:R),n)}function N(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:n}=e,r={},a="/",o=[];for(let s=0;s<n.length;++s){let e=n[s],l=s===n.length-1,c="/"===a?t:t.slice(a.length)||"/",d=F({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&i&&!n[n.length-1].route.index&&(d=F({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(r,d.params),o.push({params:r,pathname:X([a,d.pathname]),pathnameBase:Y(X([a,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(a=X([a,d.pathnameBase]))}return o}function F(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[i,n]=U(e.path,e.caseSensitive,e.end),r=t.match(i);if(!r)return null;let a=r[0],o=a.replace(/(.)\/+$/,"$1"),s=r.slice(1);return{params:n.reduce((e,t,i)=>{let{paramName:n,isOptional:r}=t;if("*"===n){let e=s[i]||"";o=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[i];return e[n]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:a,pathnameBase:o,pattern:e}}function U(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];b("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let n=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,i)=>(n.push({paramName:t,isOptional:null!=i}),i?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),n]}function V(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return b(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function j(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let i=t.endsWith("/")?t.length-1:t.length,n=e.charAt(i);return n&&"/"!==n?null:e.slice(i)||"/"}function W(e,t,i,n){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(n),"].  Please separate it out to the `to.").concat(i,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function H(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function G(e){let t=H(e);return t.map((e,i)=>i===t.length-1?e.pathname:e.pathnameBase)}function q(e,t,i){let n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?n=_(e):(n=c({},e),y(!n.pathname||!n.pathname.includes("?"),W("?","pathname","search",n)),y(!n.pathname||!n.pathname.includes("#"),W("#","pathname","hash",n)),y(!n.search||!n.search.includes("#"),W("#","search","hash",n)));let a,o=""===e||""===n.pathname,s=o?"/":n.pathname;if(null==s)a=i;else{let e=t.length-1;if(!r&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;n.pathname=t.join("/")}a=e>=0?t[e]:"/"}let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:i,search:n="",hash:r=""}="string"===typeof e?_(e):e,a=i?i.startsWith("/")?i:function(e,t){let i=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?i.length>1&&i.pop():"."!==e&&i.push(e)}),i.length>1?i.join("/"):"/"}(i,t):t;return{pathname:a,search:Q(n),hash:K(r)}}(n,a),d=s&&"/"!==s&&s.endsWith("/"),u=(o||"."===s)&&i.endsWith("/");return l.pathname.endsWith("/")||!d&&!u||(l.pathname+="/"),l}var X=e=>e.join("/").replace(/\/\/+/g,"/"),Y=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Q=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",K=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function Z(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var J=["POST","PUT","PATCH","DELETE"],$=(new Set(J),["GET",...J]);new Set($),Symbol("ResetLoaderData");var ee=e.createContext(null);ee.displayName="DataRouter";var te=e.createContext(null);te.displayName="DataRouterState";var ie=e.createContext(!1);var ne=e.createContext({isTransitioning:!1});ne.displayName="ViewTransition";var re=e.createContext(new Map);re.displayName="Fetchers";var ae=e.createContext(null);ae.displayName="Await";var oe=e.createContext(null);oe.displayName="Navigation";var se=e.createContext(null);se.displayName="Location";var le=e.createContext({outlet:null,matches:[],isDataRoute:!1});le.displayName="Route";var ce=e.createContext(null);ce.displayName="RouteError";function de(){return null!=e.useContext(se)}function ue(){return y(de(),"useLocation() may be used only in the context of a <Router> component."),e.useContext(se).location}var he="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function pe(t){e.useContext(oe).static||e.useLayoutEffect(t)}function fe(){let{isDataRoute:t}=e.useContext(le);return t?function(){let{router:t}=_e("useNavigate"),i=Ee("useNavigate"),n=e.useRef(!1);pe(()=>{n.current=!0});let r=e.useCallback(async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};b(n.current,he),n.current&&("number"===typeof e?t.navigate(e):await t.navigate(e,c({fromRouteId:i},r)))},[t,i]);return r}():function(){y(de(),"useNavigate() may be used only in the context of a <Router> component.");let t=e.useContext(ee),{basename:i,navigator:n}=e.useContext(oe),{matches:r}=e.useContext(le),{pathname:a}=ue(),o=JSON.stringify(G(r)),s=e.useRef(!1);pe(()=>{s.current=!0});let l=e.useCallback(function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(b(s.current,he),!s.current)return;if("number"===typeof e)return void n.go(e);let l=q(e,JSON.parse(o),a,"path"===r.relative);null==t&&"/"!==i&&(l.pathname="/"===l.pathname?i:X([i,l.pathname])),(r.replace?n.replace:n.push)(l,r.state,r)},[i,n,o,a,t]);return l}()}e.createContext(null);function me(t){let{relative:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=e.useContext(le),{pathname:r}=ue(),a=JSON.stringify(G(n));return e.useMemo(()=>q(t,JSON.parse(a),r,"path"===i),[t,a,r,i])}function ge(t,i,n,r){y(de(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=e.useContext(oe),{matches:o}=e.useContext(le),s=o[o.length-1],l=s?s.params:{},d=s?s.pathname:"/",u=s?s.pathnameBase:"/",h=s&&s.route;{let e=h&&h.path||"";Te(d,!h||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(d,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let p,f=ue();if(i){var m;let e="string"===typeof i?_(i):i;y("/"===u||(null===(m=e.pathname)||void 0===m?void 0:m.startsWith(u)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(u,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),p=e}else p=f;let g=p.pathname||"/",v=g;if("/"!==u){let e=u.replace(/^\//,"").split("/");v="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let x=A(t,{pathname:v});b(h||null!=x,'No routes matched location "'.concat(p.pathname).concat(p.search).concat(p.hash,'" ')),b(null==x||void 0!==x[x.length-1].route.element||void 0!==x[x.length-1].route.Component||void 0!==x[x.length-1].route.lazy,'Matched leaf route at location "'.concat(p.pathname).concat(p.search).concat(p.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let w=we(x&&x.map(e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:X([u,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:X([u,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,n,r);return i&&w?e.createElement(se.Provider,{value:{location:c({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:"POP"}},w):w}function ve(){let t=Ae(),i=Z(t)?"".concat(t.status," ").concat(t.statusText):t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},s=null;return console.error("Error handled by React Router default ErrorBoundary:",t),s=e.createElement(e.Fragment,null,e.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),e.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",e.createElement("code",{style:o},"ErrorBoundary")," or"," ",e.createElement("code",{style:o},"errorElement")," prop on your route.")),e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},i),n?e.createElement("pre",{style:a},n):null,s)}var ye=e.createElement(ve,null),be=class extends e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?e.createElement(le.Provider,{value:this.props.routeContext},e.createElement(ce.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function xe(t){let{routeContext:i,match:n,children:r}=t,a=e.useContext(ee);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),e.createElement(le.Provider,{value:i},r)}function we(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==t){if(!n)return null;if(n.errors)t=n.matches;else{if(0!==i.length||n.initialized||!(n.matches.length>0))return null;t=n.matches}}let r=t,a=null===n||void 0===n?void 0:n.errors;if(null!=a){let e=r.findIndex(e=>e.route.id&&void 0!==(null===a||void 0===a?void 0:a[e.route.id]));y(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(a).join(","))),r=r.slice(0,Math.min(r.length,e+1))}let o=!1,s=-1;if(n)for(let e=0;e<r.length;e++){let t=r[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(s=e),t.route.id){let{loaderData:e,errors:i}=n,a=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!i||void 0===i[t.route.id]);if(t.route.lazy||a){o=!0,r=s>=0?r.slice(0,s+1):[r[0]];break}}}return r.reduceRight((t,l,c)=>{let d,u=!1,h=null,p=null;n&&(d=a&&l.route.id?a[l.route.id]:void 0,h=l.route.errorElement||ye,o&&(s<0&&0===c?(Te("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),u=!0,p=null):s===c&&(u=!0,p=l.route.hydrateFallbackElement||null)));let f=i.concat(r.slice(0,c+1)),m=()=>{let i;return i=d?h:u?p:l.route.Component?e.createElement(l.route.Component,null):l.route.element?l.route.element:t,e.createElement(xe,{match:l,routeContext:{outlet:t,matches:f,isDataRoute:null!=n},children:i})};return n&&(l.route.ErrorBoundary||l.route.errorElement||0===c)?e.createElement(be,{location:n.location,revalidation:n.revalidation,component:h,error:d,children:m(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):m()},null)}function Se(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function _e(t){let i=e.useContext(ee);return y(i,Se(t)),i}function Ce(t){let i=e.useContext(te);return y(i,Se(t)),i}function Ee(t){let i=function(t){let i=e.useContext(le);return y(i,Se(t)),i}(t),n=i.matches[i.matches.length-1];return y(n.route.id,"".concat(t,' can only be used on routes that contain a unique "id"')),n.route.id}function Ae(){var t;let i=e.useContext(ce),n=Ce("useRouteError"),r=Ee("useRouteError");return void 0!==i?i:null===(t=n.errors)||void 0===t?void 0:t[r]}var Me={};function Te(e,t,i){t||Me[e]||(Me[e]=!0,b(!1,i))}var Pe={};function De(e,t){e||Pe[t]||(Pe[t]=!0,console.warn(t))}e.memo(function(e){let{routes:t,future:i,state:n}=e;return ge(t,void 0,n,i)});function Oe(e){y(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ie(t){let{basename:i="/",children:n=null,location:r,navigationType:a="POP",navigator:o,static:s=!1}=t;y(!de(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=i.replace(/^\/*/,"/"),c=e.useMemo(()=>({basename:l,navigator:o,static:s,future:{}}),[l,o,s]);"string"===typeof r&&(r=_(r));let{pathname:d="/",search:u="",hash:h="",state:p=null,key:f="default"}=r,m=e.useMemo(()=>{let e=j(d,l);return null==e?null:{location:{pathname:e,search:u,hash:h,state:p,key:f},navigationType:a}},[l,d,u,h,p,f,a]);return b(null!=m,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(d).concat(u).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:e.createElement(oe.Provider,{value:c},e.createElement(se.Provider,{children:n,value:m}))}function ke(e){let{children:t,location:i}=e;return ge(Re(t),i)}e.Component;function Re(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return e.Children.forEach(t,(t,r)=>{if(!e.isValidElement(t))return;let a=[...i,r];if(t.type===e.Fragment)return void n.push.apply(n,Re(t.props.children,a));y(t.type===Oe,"[".concat("string"===typeof t.type?t.type:t.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),y(!t.props.index||!t.props.children,"An index route cannot have child routes.");let o={id:t.props.id||a.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,hydrateFallbackElement:t.props.hydrateFallbackElement,HydrateFallback:t.props.HydrateFallback,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:!0===t.props.hasErrorBoundary||null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(o.children=Re(t.props.children,a)),n.push(o)}),n}var ze="get",Le="application/x-www-form-urlencoded";function Be(e){return null!=e&&"string"===typeof e.tagName}var Ne=null;var Fe=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ue(e){return null==e||Fe.has(e)?e:(b(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Le,'"')),null)}function Ve(e,t){let i,n,r,a,o;if(Be(s=e)&&"form"===s.tagName.toLowerCase()){let o=e.getAttribute("action");n=o?j(o,t):null,i=e.getAttribute("method")||ze,r=Ue(e.getAttribute("enctype"))||Le,a=new FormData(e)}else if(function(e){return Be(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Be(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let o=e.form;if(null==o)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||o.getAttribute("action");if(n=s?j(s,t):null,i=e.getAttribute("formmethod")||o.getAttribute("method")||ze,r=Ue(e.getAttribute("formenctype"))||Ue(o.getAttribute("enctype"))||Le,a=new FormData(o,e),!function(){if(null===Ne)try{new FormData(document.createElement("form"),0),Ne=!1}catch(VU){Ne=!0}return Ne}()){let{name:t,type:i,value:n}=e;if("image"===i){let e=t?"".concat(t,"."):"";a.append("".concat(e,"x"),"0"),a.append("".concat(e,"y"),"0")}else t&&a.append(t,n)}}else{if(Be(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');i=ze,n=null,r=Le,o=e}var s;return a&&"text/plain"===r&&(o=a,a=void 0),{action:n,method:i.toLowerCase(),encType:r,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function je(e){return{__html:e}}function We(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function He(e,t,i){let n="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===n.pathname?n.pathname="_root.".concat(i):t&&"/"===j(n.pathname,t)?n.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(i):n.pathname="".concat(n.pathname.replace(/\/$/,""),".").concat(i),n}async function Ge(e,t){if(e.id in t)return t[e.id];try{let i=await import(e.module);return t[e.id]=i,i}catch(i){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(i),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function qe(e){return null!=e&&"string"===typeof e.page}function Xe(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Ye(e,t,i,n,r,a){let o=(e,t)=>!i[t]||e.route.id!==i[t].route.id,s=(e,t)=>{var n;return i[t].pathname!==e.pathname||(null===(n=i[t].route.path)||void 0===n?void 0:n.endsWith("*"))&&i[t].params["*"]!==e.params["*"]};return"assets"===a?t.filter((e,t)=>o(e,t)||s(e,t)):"data"===a?t.filter((t,a)=>{let l=n.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(o(t,a)||s(t,a))return!0;if(t.route.shouldRevalidate){var c;let n=t.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:(null===(c=i[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof n)return n}return!0}):[]}function Qe(e,t){let{includeHydrateFallback:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n=e.map(e=>{let n=t.routes[e.route.id];if(!n)return[];let r=[n.module];return n.clientActionModule&&(r=r.concat(n.clientActionModule)),n.clientLoaderModule&&(r=r.concat(n.clientLoaderModule)),i&&n.hydrateFallbackModule&&(r=r.concat(n.hydrateFallbackModule)),n.imports&&(r=r.concat(n.imports)),r}).flat(1),[...new Set(n)];var n}function Ke(e,t){let i=new Set,n=new Set(t);return e.reduce((e,r)=>{if(t&&!qe(r)&&"script"===r.as&&r.href&&n.has(r.href))return e;let a=JSON.stringify(function(e){let t={},i=Object.keys(e).sort();for(let n of i)t[n]=e[n];return t}(r));return i.has(a)||(i.add(a),e.push({key:a,link:r})),e},[])}function Ze(e,t){return"lazy"===e.mode&&!0===t}function Je(){let t=e.useContext(ee);return We(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function $e(){let t=e.useContext(te);return We(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var et=e.createContext(void 0);function tt(){let t=e.useContext(et);return We(t,"You must render this element inside a <HydratedRouter> element"),t}function it(e,t){return i=>{e&&e(i),i.defaultPrevented||t(i)}}function nt(e,t,i){if(i&&!st)return[e[0]];if(t){let i=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,i+1)}return e}et.displayName="FrameworkContext";function rt(t){let{page:i}=t,n=r(t,u),{router:a}=Je(),o=e.useMemo(()=>A(a.routes,i,a.basename),[a.routes,i,a.basename]);return o?e.createElement(ot,c({page:i,matches:o},n)):null}function at(t){let{manifest:i,routeModules:n}=tt(),[r,a]=e.useState([]);return e.useEffect(()=>{let e=!1;return async function(e,t,i){let n=await Promise.all(e.map(async e=>{let n=t.routes[e.route.id];if(n){let e=await Ge(n,i);return e.links?e.links():[]}return[]}));return Ke(n.flat(1).filter(Xe).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?c(c({},e),{},{rel:"prefetch",as:"style"}):c(c({},e),{},{rel:"prefetch"})))}(t,i,n).then(t=>{e||a(t)}),()=>{e=!0}},[t,i,n]),r}function ot(t){let{page:i,matches:n}=t,a=r(t,h),o=ue(),{manifest:s,routeModules:l}=tt(),{basename:d}=Je(),{loaderData:u,matches:p}=$e(),f=e.useMemo(()=>Ye(i,n,p,s,o,"data"),[i,n,p,s,o]),m=e.useMemo(()=>Ye(i,n,p,s,o,"assets"),[i,n,p,s,o]),g=e.useMemo(()=>{if(i===o.pathname+o.search+o.hash)return[];let e=new Set,t=!1;if(n.forEach(i=>{var n;let r=s.routes[i.route.id];r&&r.hasLoader&&(!f.some(e=>e.route.id===i.route.id)&&i.route.id in u&&null!==(n=l[i.route.id])&&void 0!==n&&n.shouldRevalidate||r.hasClientLoader?t=!0:e.add(i.route.id))}),0===e.size)return[];let r=He(i,d,"data");return t&&e.size>0&&r.searchParams.set("_routes",n.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[r.pathname+r.search]},[d,u,o,s,f,n,i,l]),v=e.useMemo(()=>Qe(m,s),[m,s]),y=at(m);return e.createElement(e.Fragment,null,g.map(t=>e.createElement("link",c({key:t,rel:"prefetch",as:"fetch",href:t},a))),v.map(t=>e.createElement("link",c({key:t,rel:"modulepreload",href:t},a))),y.map(t=>{let{key:i,link:n}=t;return e.createElement("link",c({key:i,nonce:a.nonce},n))}))}var st=!1;function lt(t){let{manifest:i,serverHandoffString:n,isSpaMode:a,renderMeta:o,routeDiscovery:s,ssr:l}=tt(),{router:u,static:h,staticContext:p}=Je(),{matches:f}=$e(),m=e.useContext(ie),g=Ze(s,l);o&&(o.didRenderScripts=!0);let v=nt(f,null,a);e.useEffect(()=>{0},[]);let y=e.useMemo(()=>{var a;if(m)return null;let o=p?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",s=h?"".concat(null!==i.hmr&&void 0!==a&&a.runtime?"import ".concat(JSON.stringify(i.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(i.url)),";\n").concat(v.map((e,t)=>{let n="route".concat(t),r=i.routes[e.route.id];We(r,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:a,clientLoaderModule:o,clientMiddlewareModule:s,hydrateFallbackModule:l,module:c}=r,d=[...a?[{module:a,varName:"".concat(n,"_clientAction")}]:[],...o?[{module:o,varName:"".concat(n,"_clientLoader")}]:[],...s?[{module:s,varName:"".concat(n,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(n,"_HydrateFallback")}]:[],{module:c,varName:"".concat(n,"_main")}];if(1===d.length)return"import * as ".concat(n," from ").concat(JSON.stringify(c),";");let u=d.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),h="const ".concat(n," = {").concat(d.map(e=>"...".concat(e.varName)).join(","),"};");return[u,h].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:i}=e,n=r(e,d),a=new Set(t.state.matches.map(e=>e.route.id)),o=t.state.location.pathname.split("/").filter(Boolean),s=["/"];for(o.pop();o.length>0;)s.push("/".concat(o.join("/"))),o.pop();s.forEach(e=>{let i=A(t.routes,e,t.basename);i&&i.forEach(e=>a.add(e.route.id))});let l=[...a].reduce((e,t)=>Object.assign(e,{[t]:n.routes[t]}),{});return c(c({},n),{},{routes:l,sri:!!i||void 0})}(i,u),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(v.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(i.entry.module),");"):" ";return e.createElement(e.Fragment,null,e.createElement("script",c(c({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:je(o),type:void 0})),e.createElement("script",c(c({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:je(s),type:"module",async:!0})))},[]),b=st||m?[]:(i.entry.imports.concat(Qe(v,i,{includeHydrateFallback:!0})),[...new Set(x)]);var x;let w="object"===typeof i.sri?i.sri:{};return De(!m,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),st||m?null:e.createElement(e.Fragment,null,"object"===typeof i.sri?e.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:w})}}):null,g?null:e.createElement("link",{rel:"modulepreload",href:i.url,crossOrigin:t.crossOrigin,integrity:w[i.url],suppressHydrationWarning:!0}),e.createElement("link",{rel:"modulepreload",href:i.entry.module,crossOrigin:t.crossOrigin,integrity:w[i.entry.module],suppressHydrationWarning:!0}),b.map(i=>e.createElement("link",{key:i,rel:"modulepreload",href:i,crossOrigin:t.crossOrigin,integrity:w[i],suppressHydrationWarning:!0})),y)}function ct(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}e.Component;function dt(t){let{error:i,isOutsideRemixApp:n}=t;console.error(i);let r,a=e.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(Z(i))return e.createElement(ut,{title:"Unhandled Thrown Response!"},e.createElement("h1",{style:{fontSize:"24px"}},i.status," ",i.statusText),a);if(i instanceof Error)0;else{let e=null==i?"Unknown Error":"object"===typeof i&&"toString"in i?i.toString():JSON.stringify(i);new Error(e)}return e.createElement(ut,{title:"Application Error!",isOutsideRemixApp:n},e.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),e.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),a)}function ut(t){var i;let{title:n,renderScripts:r,isOutsideRemixApp:a,children:o}=t,{routeModules:s}=tt();return null!==s.root&&void 0!==i&&i.Layout&&!a?o:e.createElement("html",{lang:"en"},e.createElement("head",null,e.createElement("meta",{charSet:"utf-8"}),e.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),e.createElement("title",null,n)),e.createElement("body",null,e.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},o,r?e.createElement(lt,null):null)))}var ht="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{ht&&(window.__reactRouterVersion="7.8.0")}catch(VU){}function pt(t){let{basename:i,children:n,window:r}=t,a=e.useRef();null==a.current&&(a.current=v({window:r,v5Compat:!0}));let o=a.current,[s,l]=e.useState({action:o.action,location:o.location}),c=e.useCallback(t=>{e.startTransition(()=>l(t))},[l]);return e.useLayoutEffect(()=>o.listen(c),[o,c]),e.createElement(Ie,{basename:i,children:n,location:s.location,navigationType:s.action,navigator:o})}var ft=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mt=e.forwardRef(function(t,i){let n,{onClick:a,discover:o="render",prefetch:s="none",relative:l,reloadDocument:d,replace:u,state:h,target:f,to:m,preventScrollReset:g,viewTransition:v}=t,x=r(t,p),{basename:w}=e.useContext(oe),_="string"===typeof m&&ft.test(m),C=!1;if("string"===typeof m&&_&&(n=m,ht))try{let e=new URL(window.location.href),t=m.startsWith("//")?new URL(e.protocol+m):new URL(m),i=j(t.pathname,w);t.origin===e.origin&&null!=i?m=i+t.search+t.hash:C=!0}catch(VU){b(!1,'<Link to="'.concat(m,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let E=function(t){let{relative:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y(de(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=e.useContext(oe),{hash:a,pathname:o,search:s}=me(t,{relative:i}),l=o;return"/"!==n&&(l="/"===o?n:X([n,o])),r.createHref({pathname:l,search:s,hash:a})}(m,{relative:l}),[A,M,T]=function(t,i){let n=e.useContext(et),[r,a]=e.useState(!1),[o,s]=e.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:d,onMouseLeave:u,onTouchStart:h}=i,p=e.useRef(null);e.useEffect(()=>{if("render"===t&&s(!0),"viewport"===t){let e=new IntersectionObserver(e=>{e.forEach(e=>{s(e.isIntersecting)})},{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}},[t]),e.useEffect(()=>{if(r){let e=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(e)}}},[r]);let f=()=>{a(!0)},m=()=>{a(!1),s(!1)};return n?"intent"!==t?[o,p,{}]:[o,p,{onFocus:it(l,f),onBlur:it(c,m),onMouseEnter:it(d,f),onMouseLeave:it(u,m),onTouchStart:it(h,f)}]:[!1,p,{}]}(s,x),P=function(t){let{target:i,replace:n,state:r,preventScrollReset:a,relative:o,viewTransition:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=fe(),c=ue(),d=me(t,{relative:o});return e.useCallback(e=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(e,i)){e.preventDefault();let i=void 0!==n?n:S(c)===S(d);l(t,{replace:i,state:r,preventScrollReset:a,relative:o,viewTransition:s})}},[c,l,d,n,r,i,t,a,o,s])}(m,{replace:u,state:h,target:f,preventScrollReset:g,relative:l,viewTransition:v});let D=e.createElement("a",c(c(c({},x),T),{},{href:n||E,onClick:C||d?a:function(e){a&&a(e),e.defaultPrevented||P(e)},ref:ct(i,M),target:f,"data-discover":_||"render"!==o?void 0:"true"}));return A&&!_?e.createElement(e.Fragment,null,D,e.createElement(rt,{page:E})):D});mt.displayName="Link";var gt=e.forwardRef(function(t,i){let{"aria-current":n="page",caseSensitive:a=!1,className:o="",end:s=!1,style:l,to:d,viewTransition:u,children:h}=t,p=r(t,f),m=me(d,{relative:p.relative}),g=ue(),v=e.useContext(te),{navigator:b,basename:x}=e.useContext(oe),w=null!=v&&function(t){let{relative:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.useContext(ne);y(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=bt("useViewTransitionState"),a=me(t,{relative:i});if(!n.isTransitioning)return!1;let o=j(n.currentLocation.pathname,r)||n.currentLocation.pathname,s=j(n.nextLocation.pathname,r)||n.nextLocation.pathname;return null!=F(a.pathname,s)||null!=F(a.pathname,o)}(m)&&!0===u,S=b.encodeLocation?b.encodeLocation(m).pathname:m.pathname,_=g.pathname,C=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;a||(_=_.toLowerCase(),C=C?C.toLowerCase():null,S=S.toLowerCase()),C&&x&&(C=j(C,x)||C);const E="/"!==S&&S.endsWith("/")?S.length-1:S.length;let A,M=_===S||!s&&_.startsWith(S)&&"/"===_.charAt(E),T=null!=C&&(C===S||!s&&C.startsWith(S)&&"/"===C.charAt(S.length)),P={isActive:M,isPending:T,isTransitioning:w},D=M?n:void 0;A="function"===typeof o?o(P):[o,M?"active":null,T?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let O="function"===typeof l?l(P):l;return e.createElement(mt,c(c({},p),{},{"aria-current":D,className:A,ref:i,style:O,to:d,viewTransition:u}),"function"===typeof h?h(P):h)});gt.displayName="NavLink";var vt=e.forwardRef((t,i)=>{let{discover:n="render",fetcherKey:a,navigate:o,reloadDocument:s,replace:l,state:d,method:u=ze,action:h,onSubmit:p,relative:f,preventScrollReset:g,viewTransition:v}=t,b=r(t,m),x=St(),w=function(t){let{relative:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=e.useContext(oe),r=e.useContext(le);y(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o=c({},me(t||".",{relative:i})),s=ue();if(null==t){o.search=s.search;let e=new URLSearchParams(o.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let i=e.toString();o.search=i?"?".concat(i):""}}t&&"."!==t||!a.route.index||(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(o.pathname="/"===o.pathname?n:X([n,o.pathname]));return S(o)}(h,{relative:f}),_="get"===u.toLowerCase()?"get":"post",C="string"===typeof h&&ft.test(h);return e.createElement("form",c(c({ref:i,method:_,action:w,onSubmit:s?p:e=>{if(p&&p(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,i=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||u;x(t||e.currentTarget,{fetcherKey:a,method:i,navigate:o,replace:l,state:d,relative:f,preventScrollReset:g,viewTransition:v})}},b),{},{"data-discover":C||"render"!==n?void 0:"true"}))});function yt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function bt(t){let i=e.useContext(ee);return y(i,yt(t)),i}vt.displayName="Form";var xt=0,wt=()=>"__".concat(String(++xt),"__");function St(){let{router:t}=bt("useSubmit"),{basename:i}=e.useContext(oe),n=Ee("useRouteId");return e.useCallback(async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:a,method:o,encType:s,formData:l,body:c}=Ve(e,i);if(!1===r.navigate){let e=r.fetcherKey||wt();await t.fetch(e,n,r.action||a,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||o,formEncType:r.encType||s,flushSync:r.flushSync})}else await t.navigate(r.action||a,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||o,formEncType:r.encType||s,replace:r.replace,state:r.state,fromRouteId:n,flushSync:r.flushSync,viewTransition:r.viewTransition})},[t,i,n])}var _t=i(579);var Ct=function(){function e(e){var t=this;this._insertTag=function(e){var i;i=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,i),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var i=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{i.insertRule(e,i.cssRules.length)}catch(VU){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach(function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),this.tags=[],this.ctr=0},e}(),Et=Math.abs,At=String.fromCharCode,Mt=Object.assign;function Tt(e){return e.trim()}function Pt(e,t,i){return e.replace(t,i)}function Dt(e,t){return e.indexOf(t)}function Ot(e,t){return 0|e.charCodeAt(t)}function It(e,t,i){return e.slice(t,i)}function kt(e){return e.length}function Rt(e){return e.length}function zt(e,t){return t.push(e),e}var Lt=1,Bt=1,Nt=0,Ft=0,Ut=0,Vt="";function jt(e,t,i,n,r,a,o){return{value:e,root:t,parent:i,type:n,props:r,children:a,line:Lt,column:Bt,length:o,return:""}}function Wt(e,t){return Mt(jt("",null,null,"",null,null,0),e,{length:-e.length},t)}function Ht(){return Ut=Ft>0?Ot(Vt,--Ft):0,Bt--,10===Ut&&(Bt=1,Lt--),Ut}function Gt(){return Ut=Ft<Nt?Ot(Vt,Ft++):0,Bt++,10===Ut&&(Bt=1,Lt++),Ut}function qt(){return Ot(Vt,Ft)}function Xt(){return Ft}function Yt(e,t){return It(Vt,e,t)}function Qt(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Kt(e){return Lt=Bt=1,Nt=kt(Vt=e),Ft=0,[]}function Zt(e){return Vt="",e}function Jt(e){return Tt(Yt(Ft-1,ti(91===e?e+2:40===e?e+1:e)))}function $t(e){for(;(Ut=qt())&&Ut<33;)Gt();return Qt(e)>2||Qt(Ut)>3?"":" "}function ei(e,t){for(;--t&&Gt()&&!(Ut<48||Ut>102||Ut>57&&Ut<65||Ut>70&&Ut<97););return Yt(e,Xt()+(t<6&&32==qt()&&32==Gt()))}function ti(e){for(;Gt();)switch(Ut){case e:return Ft;case 34:case 39:34!==e&&39!==e&&ti(Ut);break;case 40:41===e&&ti(e);break;case 92:Gt()}return Ft}function ii(e,t){for(;Gt()&&e+Ut!==57&&(e+Ut!==84||47!==qt()););return"/*"+Yt(t,Ft-1)+"*"+At(47===e?e:Gt())}function ni(e){for(;!Qt(qt());)Gt();return Yt(e,Ft)}var ri="-ms-",ai="-moz-",oi="-webkit-",si="comm",li="rule",ci="decl",di="@keyframes";function ui(e,t){for(var i="",n=Rt(e),r=0;r<n;r++)i+=t(e[r],r,e,t)||"";return i}function hi(e,t,i,n){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case ci:return e.return=e.return||e.value;case si:return"";case di:return e.return=e.value+"{"+ui(e.children,n)+"}";case li:e.value=e.props.join(",")}return kt(i=ui(e.children,n))?e.return=e.value+"{"+i+"}":""}function pi(e){return Zt(fi("",null,null,null,[""],e=Kt(e),0,[0],e))}function fi(e,t,i,n,r,a,o,s,l){for(var c=0,d=0,u=o,h=0,p=0,f=0,m=1,g=1,v=1,y=0,b="",x=r,w=a,S=n,_=b;g;)switch(f=y,y=Gt()){case 40:if(108!=f&&58==Ot(_,u-1)){-1!=Dt(_+=Pt(Jt(y),"&","&\f"),"&\f")&&(v=-1);break}case 34:case 39:case 91:_+=Jt(y);break;case 9:case 10:case 13:case 32:_+=$t(f);break;case 92:_+=ei(Xt()-1,7);continue;case 47:switch(qt()){case 42:case 47:zt(gi(ii(Gt(),Xt()),t,i),l);break;default:_+="/"}break;case 123*m:s[c++]=kt(_)*v;case 125*m:case 59:case 0:switch(y){case 0:case 125:g=0;case 59+d:-1==v&&(_=Pt(_,/\f/g,"")),p>0&&kt(_)-u&&zt(p>32?vi(_+";",n,i,u-1):vi(Pt(_," ","")+";",n,i,u-2),l);break;case 59:_+=";";default:if(zt(S=mi(_,t,i,c,d,r,s,b,x=[],w=[],u),a),123===y)if(0===d)fi(_,t,S,S,x,a,u,s,w);else switch(99===h&&110===Ot(_,3)?100:h){case 100:case 108:case 109:case 115:fi(e,S,S,n&&zt(mi(e,S,S,0,0,r,s,b,r,x=[],u),w),r,w,u,s,n?x:w);break;default:fi(_,S,S,S,[""],w,0,s,w)}}c=d=p=0,m=v=1,b=_="",u=o;break;case 58:u=1+kt(_),p=f;default:if(m<1)if(123==y)--m;else if(125==y&&0==m++&&125==Ht())continue;switch(_+=At(y),y*m){case 38:v=d>0?1:(_+="\f",-1);break;case 44:s[c++]=(kt(_)-1)*v,v=1;break;case 64:45===qt()&&(_+=Jt(Gt())),h=qt(),d=u=kt(b=_+=ni(Xt())),y++;break;case 45:45===f&&2==kt(_)&&(m=0)}}return a}function mi(e,t,i,n,r,a,o,s,l,c,d){for(var u=r-1,h=0===r?a:[""],p=Rt(h),f=0,m=0,g=0;f<n;++f)for(var v=0,y=It(e,u+1,u=Et(m=o[f])),b=e;v<p;++v)(b=Tt(m>0?h[v]+" "+y:Pt(y,/&\f/g,h[v])))&&(l[g++]=b);return jt(e,t,i,0===r?li:s,l,c,d)}function gi(e,t,i){return jt(e,t,i,si,At(Ut),It(e,2,-2),0)}function vi(e,t,i,n){return jt(e,t,i,ci,It(e,0,n),It(e,n+1,-1),n)}var yi=function(e,t,i){for(var n=0,r=0;n=r,r=qt(),38===n&&12===r&&(t[i]=1),!Qt(r);)Gt();return Yt(e,Ft)},bi=function(e,t){return Zt(function(e,t){var i=-1,n=44;do{switch(Qt(n)){case 0:38===n&&12===qt()&&(t[i]=1),e[i]+=yi(Ft-1,t,i);break;case 2:e[i]+=Jt(n);break;case 4:if(44===n){e[++i]=58===qt()?"&\f":"",t[i]=e[i].length;break}default:e[i]+=At(n)}}while(n=Gt());return e}(Kt(e),t))},xi=new WeakMap,wi=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,i=e.parent,n=e.column===i.column&&e.line===i.line;"rule"!==i.type;)if(!(i=i.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||xi.get(i))&&!n){xi.set(e,!0);for(var r=[],a=bi(t,r),o=i.props,s=0,l=0;s<a.length;s++)for(var c=0;c<o.length;c++,l++)e.props[l]=r[s]?a[s].replace(/&\f/g,o[c]):o[c]+" "+a[s]}}},Si=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function _i(e,t){switch(function(e,t){return 45^Ot(e,0)?(((t<<2^Ot(e,0))<<2^Ot(e,1))<<2^Ot(e,2))<<2^Ot(e,3):0}(e,t)){case 5103:return oi+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return oi+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return oi+e+ai+e+ri+e+e;case 6828:case 4268:return oi+e+ri+e+e;case 6165:return oi+e+ri+"flex-"+e+e;case 5187:return oi+e+Pt(e,/(\w+).+(:[^]+)/,oi+"box-$1$2"+ri+"flex-$1$2")+e;case 5443:return oi+e+ri+"flex-item-"+Pt(e,/flex-|-self/,"")+e;case 4675:return oi+e+ri+"flex-line-pack"+Pt(e,/align-content|flex-|-self/,"")+e;case 5548:return oi+e+ri+Pt(e,"shrink","negative")+e;case 5292:return oi+e+ri+Pt(e,"basis","preferred-size")+e;case 6060:return oi+"box-"+Pt(e,"-grow","")+oi+e+ri+Pt(e,"grow","positive")+e;case 4554:return oi+Pt(e,/([^-])(transform)/g,"$1"+oi+"$2")+e;case 6187:return Pt(Pt(Pt(e,/(zoom-|grab)/,oi+"$1"),/(image-set)/,oi+"$1"),e,"")+e;case 5495:case 3959:return Pt(e,/(image-set\([^]*)/,oi+"$1$`$1");case 4968:return Pt(Pt(e,/(.+:)(flex-)?(.*)/,oi+"box-pack:$3"+ri+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+oi+e+e;case 4095:case 3583:case 4068:case 2532:return Pt(e,/(.+)-inline(.+)/,oi+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(kt(e)-1-t>6)switch(Ot(e,t+1)){case 109:if(45!==Ot(e,t+4))break;case 102:return Pt(e,/(.+:)(.+)-([^]+)/,"$1"+oi+"$2-$3$1"+ai+(108==Ot(e,t+3)?"$3":"$2-$3"))+e;case 115:return~Dt(e,"stretch")?_i(Pt(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==Ot(e,t+1))break;case 6444:switch(Ot(e,kt(e)-3-(~Dt(e,"!important")&&10))){case 107:return Pt(e,":",":"+oi)+e;case 101:return Pt(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+oi+(45===Ot(e,14)?"inline-":"")+"box$3$1"+oi+"$2$3$1"+ri+"$2box$3")+e}break;case 5936:switch(Ot(e,t+11)){case 114:return oi+e+ri+Pt(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return oi+e+ri+Pt(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return oi+e+ri+Pt(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return oi+e+ri+e+e}return e}var Ci=[function(e,t,i,n){if(e.length>-1&&!e.return)switch(e.type){case ci:e.return=_i(e.value,e.length);break;case di:return ui([Wt(e,{value:Pt(e.value,"@","@"+oi)})],n);case li:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return ui([Wt(e,{props:[Pt(t,/:(read-\w+)/,":-moz-$1")]})],n);case"::placeholder":return ui([Wt(e,{props:[Pt(t,/:(plac\w+)/,":"+oi+"input-$1")]}),Wt(e,{props:[Pt(t,/:(plac\w+)/,":-moz-$1")]}),Wt(e,{props:[Pt(t,/:(plac\w+)/,ri+"input-$1")]})],n)}return""})}}],Ei=function(e){var t=e.key;if("css"===t){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))})}var n,r,a=e.stylisPlugins||Ci,o={},s=[];n=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(e){for(var t=e.getAttribute("data-emotion").split(" "),i=1;i<t.length;i++)o[t[i]]=!0;s.push(e)});var l,c,d=[hi,(c=function(e){l.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],u=function(e){var t=Rt(e);return function(i,n,r,a){for(var o="",s=0;s<t;s++)o+=e[s](i,n,r,a)||"";return o}}([wi,Si].concat(a,d));r=function(e,t,i,n){l=i,ui(pi(e?e+"{"+t.styles+"}":t.styles),u),n&&(h.inserted[t.name]=!0)};var h={key:t,sheet:new Ct({key:t,container:n,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:r};return h.sheet.hydrate(s),h};function Ai(e,t,i){var n="";return i.split(" ").forEach(function(i){void 0!==e[i]?t.push(e[i]+";"):i&&(n+=i+" ")}),n}var Mi=function(e,t,i){var n=e.key+"-"+t.name;!1===i&&void 0===e.registered[n]&&(e.registered[n]=t.styles)},Ti=function(e,t,i){Mi(e,t,i);var n=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var r=t;do{e.insert(t===r?"."+n:"",r,e.sheet,!0),r=r.next}while(void 0!==r)}};var Pi={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function Di(e){var t=Object.create(null);return function(i){return void 0===t[i]&&(t[i]=e(i)),t[i]}}var Oi=/[A-Z]|^ms/g,Ii=/_EMO_([^_]+?)_([^]*?)_EMO_/g,ki=function(e){return 45===e.charCodeAt(1)},Ri=function(e){return null!=e&&"boolean"!==typeof e},zi=Di(function(e){return ki(e)?e:e.replace(Oi,"-$&").toLowerCase()}),Li=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(Ii,function(e,t,i){return Ni={name:t,styles:i,next:Ni},t})}return 1===Pi[e]||ki(e)||"number"!==typeof t||0===t?t:t+"px"};function Bi(e,t,i){if(null==i)return"";var n=i;if(void 0!==n.__emotion_styles)return n;switch(typeof i){case"boolean":return"";case"object":var r=i;if(1===r.anim)return Ni={name:r.name,styles:r.styles,next:Ni},r.name;var a=i;if(void 0!==a.styles){var o=a.next;if(void 0!==o)for(;void 0!==o;)Ni={name:o.name,styles:o.styles,next:Ni},o=o.next;return a.styles+";"}return function(e,t,i){var n="";if(Array.isArray(i))for(var r=0;r<i.length;r++)n+=Bi(e,t,i[r])+";";else for(var a in i){var o=i[a];if("object"!==typeof o){var s=o;null!=t&&void 0!==t[s]?n+=a+"{"+t[s]+"}":Ri(s)&&(n+=zi(a)+":"+Li(a,s)+";")}else if(!Array.isArray(o)||"string"!==typeof o[0]||null!=t&&void 0!==t[o[0]]){var l=Bi(e,t,o);switch(a){case"animation":case"animationName":n+=zi(a)+":"+l+";";break;default:n+=a+"{"+l+"}"}}else for(var c=0;c<o.length;c++)Ri(o[c])&&(n+=zi(a)+":"+Li(a,o[c])+";")}return n}(e,t,i);case"function":if(void 0!==e){var s=Ni,l=i(e);return Ni=s,Bi(e,t,l)}}var c=i;if(null==t)return c;var d=t[c];return void 0!==d?d:c}var Ni,Fi=/label:\s*([^\s;{]+)\s*(;|$)/g;function Ui(e,t,i){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n=!0,r="";Ni=void 0;var a=e[0];null==a||void 0===a.raw?(n=!1,r+=Bi(i,t,a)):r+=a[0];for(var o=1;o<e.length;o++){if(r+=Bi(i,t,e[o]),n)r+=a[o]}Fi.lastIndex=0;for(var s,l="";null!==(s=Fi.exec(r));)l+="-"+s[1];var c=function(e){for(var t,i=0,n=0,r=e.length;r>=4;++n,r-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),i=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&i)+(59797*(i>>>16)<<16);switch(r){case 3:i^=(255&e.charCodeAt(n+2))<<16;case 2:i^=(255&e.charCodeAt(n+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(n)))+(59797*(i>>>16)<<16)}return(((i=1540483477*(65535&(i^=i>>>13))+(59797*(i>>>16)<<16))^i>>>15)>>>0).toString(36)}(r)+l;return{name:c,styles:r,next:Ni}}var Vi=!!t.useInsertionEffect&&t.useInsertionEffect,ji=Vi||function(e){return e()},Wi=Vi||e.useLayoutEffect,Hi=e.createContext("undefined"!==typeof HTMLElement?Ei({key:"css"}):null),Gi=(Hi.Provider,function(t){return(0,e.forwardRef)(function(i,n){var r=(0,e.useContext)(Hi);return t(i,r,n)})}),qi=e.createContext({});var Xi={}.hasOwnProperty,Yi="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Qi=function(e){var t=e.cache,i=e.serialized,n=e.isStringTag;return Mi(t,i,n),ji(function(){return Ti(t,i,n)}),null},Ki=Gi(function(t,i,n){var r=t.css;"string"===typeof r&&void 0!==i.registered[r]&&(r=i.registered[r]);var a=t[Yi],o=[r],s="";"string"===typeof t.className?s=Ai(i.registered,o,t.className):null!=t.className&&(s=t.className+" ");var l=Ui(o,void 0,e.useContext(qi));s+=i.key+"-"+l.name;var c={};for(var d in t)Xi.call(t,d)&&"css"!==d&&d!==Yi&&(c[d]=t[d]);return c.className=s,n&&(c.ref=n),e.createElement(e.Fragment,null,e.createElement(Qi,{cache:i,serialized:l,isStringTag:"string"===typeof a}),e.createElement(a,c))}),Zi=Ki,Ji=(i(219),function(t,i){var n=arguments;if(null==i||!Xi.call(i,"css"))return e.createElement.apply(void 0,n);var r=n.length,a=new Array(r);a[0]=Zi,a[1]=function(e,t){var i={};for(var n in t)Xi.call(t,n)&&(i[n]=t[n]);return i[Yi]=e,i}(t,i);for(var o=2;o<r;o++)a[o]=n[o];return e.createElement.apply(null,a)});!function(e){var t;t||(t=e.JSX||(e.JSX={}))}(Ji||(Ji={}));var $i=Gi(function(t,i){var n=Ui([t.styles],void 0,e.useContext(qi)),r=e.useRef();return Wi(function(){var e=i.key+"-global",t=new i.sheet.constructor({key:e,nonce:i.sheet.nonce,container:i.sheet.container,speedy:i.sheet.isSpeedy}),a=!1,o=document.querySelector('style[data-emotion="'+e+" "+n.name+'"]');return i.sheet.tags.length&&(t.before=i.sheet.tags[0]),null!==o&&(a=!0,o.setAttribute("data-emotion",e),t.hydrate([o])),r.current=[t,a],function(){t.flush()}},[i]),Wi(function(){var e=r.current,t=e[0];if(e[1])e[1]=!1;else{if(void 0!==n.next&&Ti(i,n.next,!0),t.tags.length){var a=t.tags[t.tags.length-1].nextElementSibling;t.before=a,t.flush()}i.insert("",n,t,!1)}},[i,n.name]),null});function en(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{name:i,strict:n=!0,hookName:r="useContext",providerName:a="Provider",errorMessage:o,defaultValue:s}=t,l=(0,e.createContext)(s);return l.displayName=i,[l.Provider,function t(){const i=(0,e.useContext)(l);if(!i&&n){var s;const e=new Error(null!==o&&void 0!==o?o:(c=a,"".concat(r," returned `undefined`. Seems you forgot to wrap component within ").concat(c)));throw e.name="ContextError",null===(s=Error.captureStackTrace)||void 0===s||s.call(Error,e,t),e}var c;return i},l]}const[tn,nn]=en({name:"ChakraContext",strict:!0,providerName:"<ChakraProvider />"});function rn(e){const{value:t,children:i}=e;return(0,_t.jsxs)(tn,{value:t,children:[!t._config.disableLayers&&(0,_t.jsx)($i,{styles:t.layers.atRule}),(0,_t.jsx)($i,{styles:t._global}),i]})}const an=e=>(t,i)=>{const n=i.utils.colorMix(t);if(n.invalid)return{[e]:t};const r="--mix-"+e;return{[r]:n.value,[e]:"var(".concat(r,", ").concat(n.color,")")}};function on(e){if(null===e||"object"!==typeof e)return e;if(Array.isArray(e))return e.map(e=>on(e));const t=Object.create(Object.getPrototypeOf(e));for(const i of Object.keys(e))t[i]=on(e[i]);return t}const sn=e=>null!=e&&"object"===typeof e&&!Array.isArray(e),ln=e=>"string"===typeof e,cn=e=>"function"===typeof e;function dn(e,t){if(null==t)return e;for(const i of Object.keys(t))if(void 0!==t[i]&&"__proto__"!==i)if(!sn(e[i])&&sn(t[i]))Object.assign(e,{[i]:t[i]});else if(e[i]&&sn(t[i]))dn(e[i],t[i]);else if(Array.isArray(t[i])&&Array.isArray(e[i])){let n=0;for(;n<t[i].length;n++)sn(e[i][n])&&sn(t[i][n])?dn(e[i][n],t[i][n]):e[i][n]=t[i][n]}else Object.assign(e,{[i]:t[i]});return e}function un(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];for(const r of i)dn(e,r);return e}function hn(){const e=e=>e;return new Proxy(e,{get:()=>e})}const pn=hn(),fn=hn(),mn=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return un({},...t.map(on))},gn=/[^a-zA-Z0-9_\u0081-\uffff-]/g;const vn=/[A-Z]/g;function yn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{fallback:i="",prefix:n=""}=t,r=function(e){return e.replace(vn,e=>"-".concat(e.toLowerCase()))}(["-",n,(a=e,"".concat(a).replace(gn,e=>"\\".concat(e)))].filter(Boolean).join("-"));var a;return{var:r,ref:"var(".concat(r).concat(i?", ".concat(i):"",")")}}const bn=(e,t)=>null!=t?"".concat(e,"(").concat(t,")"):t,xn=e=>{if((e=>/^var\(--.+\)$/.test(e))(e)||null==e)return e;const t="string"===typeof e&&!e.endsWith("deg");return"number"===typeof e||t?"".concat(e,"deg"):e},wn=e=>({values:["outside","inside","mixed","none"],transform(t,i){var n;let{token:r}=i;const a=r("colors.colorPalette.focusRing");return null!==(n={inside:{"--focus-ring-color":a,[e]:{outlineOffset:"0px",outlineWidth:"var(--focus-ring-width, 1px)",outlineColor:"var(--focus-ring-color)",outlineStyle:"var(--focus-ring-style, solid)",borderColor:"var(--focus-ring-color)"}},outside:{"--focus-ring-color":a,[e]:{outlineWidth:"var(--focus-ring-width, 2px)",outlineOffset:"var(--focus-ring-offset, 2px)",outlineStyle:"var(--focus-ring-style, solid)",outlineColor:"var(--focus-ring-color)"}},mixed:{"--focus-ring-color":a,[e]:{outlineWidth:"var(--focus-ring-width, 3px)",outlineStyle:"var(--focus-ring-style, solid)",outlineColor:"color-mix(in srgb, var(--focus-ring-color), transparent 60%)",borderColor:"var(--focus-ring-color)"}},none:{"--focus-ring-color":a,[e]:{outline:"none"}}}[t])&&void 0!==n?n:{}}}),Sn=an("borderColor"),_n=e=>({transition:e,transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDuration:"150ms"}),Cn={hover:["@media (hover: hover)","&:is(:hover, [data-hover]):not(:disabled, [data-disabled])"],active:"&:is(:active, [data-active]):not(:disabled, [data-disabled], [data-state=open])",focus:"&:is(:focus, [data-focus])",focusWithin:"&:is(:focus-within, [data-focus-within])",focusVisible:"&:is(:focus-visible, [data-focus-visible])",disabled:"&:is(:disabled, [disabled], [data-disabled], [aria-disabled=true])",visited:"&:visited",target:"&:target",readOnly:"&:is([data-readonly], [aria-readonly=true], [readonly])",readWrite:"&:read-write",empty:"&:is(:empty, [data-empty])",checked:"&:is(:checked, [data-checked], [aria-checked=true], [data-state=checked])",enabled:"&:enabled",expanded:"&:is([aria-expanded=true], [data-expanded], [data-state=expanded])",highlighted:"&[data-highlighted]",complete:"&[data-complete]",incomplete:"&[data-incomplete]",dragging:"&[data-dragging]",before:"&::before",after:"&::after",firstLetter:"&::first-letter",firstLine:"&::first-line",marker:"&::marker",selection:"&::selection",file:"&::file-selector-button",backdrop:"&::backdrop",first:"&:first-of-type",last:"&:last-of-type",notFirst:"&:not(:first-of-type)",notLast:"&:not(:last-of-type)",only:"&:only-child",even:"&:nth-of-type(even)",odd:"&:nth-of-type(odd)",peerFocus:".peer:is(:focus, [data-focus]) ~ &",peerHover:".peer:is(:hover, [data-hover]):not(:disabled, [data-disabled]) ~ &",peerActive:".peer:is(:active, [data-active]):not(:disabled, [data-disabled]) ~ &",peerFocusWithin:".peer:focus-within ~ &",peerFocusVisible:".peer:is(:focus-visible, [data-focus-visible]) ~ &",peerDisabled:".peer:is(:disabled, [disabled], [data-disabled]) ~ &",peerChecked:".peer:is(:checked, [data-checked], [aria-checked=true], [data-state=checked]) ~ &",peerInvalid:".peer:is(:invalid, [data-invalid], [aria-invalid=true]) ~ &",peerExpanded:".peer:is([aria-expanded=true], [data-expanded], [data-state=expanded]) ~ &",peerPlaceholderShown:".peer:placeholder-shown ~ &",groupFocus:".group:is(:focus, [data-focus]) &",groupHover:".group:is(:hover, [data-hover]):not(:disabled, [data-disabled]) &",groupActive:".group:is(:active, [data-active]):not(:disabled, [data-disabled]) &",groupFocusWithin:".group:focus-within &",groupFocusVisible:".group:is(:focus-visible, [data-focus-visible]) &",groupDisabled:".group:is(:disabled, [disabled], [data-disabled]) &",groupChecked:".group:is(:checked, [data-checked], [aria-checked=true], [data-state=checked]) &",groupExpanded:".group:is([aria-expanded=true], [data-expanded], [data-state=expanded]) &",groupInvalid:".group:invalid &",indeterminate:"&:is(:indeterminate, [data-indeterminate], [aria-checked=mixed], [data-state=indeterminate])",required:"&:is([data-required], [aria-required=true])",valid:"&:is([data-valid], [data-state=valid])",invalid:"&:is([data-invalid], [aria-invalid=true], [data-state=invalid])",autofill:"&:autofill",inRange:"&:is(:in-range, [data-in-range])",outOfRange:"&:is(:out-of-range, [data-outside-range])",placeholder:"&::placeholder, &[data-placeholder]",placeholderShown:"&:is(:placeholder-shown, [data-placeholder-shown])",pressed:"&:is([aria-pressed=true], [data-pressed])",selected:"&:is([aria-selected=true], [data-selected])",grabbed:"&:is([aria-grabbed=true], [data-grabbed])",underValue:"&[data-state=under-value]",overValue:"&[data-state=over-value]",atValue:"&[data-state=at-value]",default:"&:default",optional:"&:optional",open:"&:is([open], [data-open], [data-state=open])",closed:"&:is([closed], [data-closed], [data-state=closed])",fullscreen:"&:is(:fullscreen, [data-fullscreen])",loading:"&:is([data-loading], [aria-busy=true])",hidden:"&:is([hidden], [data-hidden])",current:"&[data-current]",currentPage:"&[aria-current=page]",currentStep:"&[aria-current=step]",today:"&[data-today]",unavailable:"&[data-unavailable]",rangeStart:"&[data-range-start]",rangeEnd:"&[data-range-end]",now:"&[data-now]",topmost:"&[data-topmost]",motionReduce:"@media (prefers-reduced-motion: reduce)",motionSafe:"@media (prefers-reduced-motion: no-preference)",print:"@media print",landscape:"@media (orientation: landscape)",portrait:"@media (orientation: portrait)",dark:".dark &, .dark .chakra-theme:not(.light) &",light:":root &, .light &",osDark:"@media (prefers-color-scheme: dark)",osLight:"@media (prefers-color-scheme: light)",highContrast:"@media (forced-colors: active)",lessContrast:"@media (prefers-contrast: less)",moreContrast:"@media (prefers-contrast: more)",ltr:"[dir=ltr] &",rtl:"[dir=rtl] &",scrollbar:"&::-webkit-scrollbar",scrollbarThumb:"&::-webkit-scrollbar-thumb",scrollbarTrack:"&::-webkit-scrollbar-track",horizontal:"&[data-orientation=horizontal]",vertical:"&[data-orientation=vertical]",icon:"& :where(svg)",starting:"@starting-style"},En=yn("bg-currentcolor"),An=e=>e===En.ref||"currentBg"===e,Mn=e=>c(c({},e("colors")),{},{currentBg:En}),Tn={conditions:Cn,utilities:{background:{values:Mn,shorthand:["bg"],transform(e,t){if(An(t.raw))return{background:En.ref};const i=an("background")(e,t);return c(c({},i),{},{[En.var]:null===i||void 0===i?void 0:i.background})}},backgroundColor:{values:Mn,shorthand:["bgColor"],transform(e,t){if(An(t.raw))return{backgroundColor:En.ref};const i=an("backgroundColor")(e,t);return c(c({},i),{},{[En.var]:null===i||void 0===i?void 0:i.backgroundColor})}},backgroundSize:{shorthand:["bgSize"]},backgroundPosition:{shorthand:["bgPos"]},backgroundRepeat:{shorthand:["bgRepeat"]},backgroundAttachment:{shorthand:["bgAttachment"]},backgroundClip:{shorthand:["bgClip"],values:["text"],transform:e=>"text"===e?{color:"transparent",backgroundClip:"text"}:{backgroundClip:e}},backgroundGradient:{shorthand:["bgGradient"],values:e=>c(c({},e("gradients")),{},{"to-t":"linear-gradient(to top, var(--gradient))","to-tr":"linear-gradient(to top right, var(--gradient))","to-r":"linear-gradient(to right, var(--gradient))","to-br":"linear-gradient(to bottom right, var(--gradient))","to-b":"linear-gradient(to bottom, var(--gradient))","to-bl":"linear-gradient(to bottom left, var(--gradient))","to-l":"linear-gradient(to left, var(--gradient))","to-tl":"linear-gradient(to top left, var(--gradient))"}),transform:e=>({"--gradient-stops":"var(--gradient-from), var(--gradient-to)","--gradient":"var(--gradient-via-stops, var(--gradient-stops))",backgroundImage:e})},gradientFrom:{values:Mn,transform:an("--gradient-from")},gradientTo:{values:Mn,transform:an("--gradient-to")},gradientVia:{values:Mn,transform:(e,t)=>c(c({},an("--gradient-via")(e,t)),{},{"--gradient-via-stops":"var(--gradient-from), var(--gradient-via), var(--gradient-to)"})},backgroundImage:{values:e=>c(c({},e("gradients")),e("assets")),shorthand:["bgImg","bgImage"]},border:{values:"borders"},borderTop:{values:"borders"},borderLeft:{values:"borders"},borderBlockStart:{values:"borders"},borderRight:{values:"borders"},borderBottom:{values:"borders"},borderBlockEnd:{values:"borders"},borderInlineStart:{values:"borders",shorthand:["borderStart"]},borderInlineEnd:{values:"borders",shorthand:["borderEnd"]},borderInline:{values:"borders",shorthand:["borderX"]},borderBlock:{values:"borders",shorthand:["borderY"]},borderColor:{values:Mn,transform:an("borderColor")},borderTopColor:{values:Mn,transform:an("borderTopColor")},borderBlockStartColor:{values:Mn,transform:an("borderBlockStartColor")},borderBottomColor:{values:Mn,transform:an("borderBottomColor")},borderBlockEndColor:{values:Mn,transform:an("borderBlockEndColor")},borderLeftColor:{values:Mn,transform:an("borderLeftColor")},borderInlineStartColor:{values:Mn,shorthand:["borderStartColor"],transform:an("borderInlineStartColor")},borderRightColor:{values:Mn,transform:an("borderRightColor")},borderInlineEndColor:{values:Mn,shorthand:["borderEndColor"],transform:an("borderInlineEndColor")},borderStyle:{values:"borderStyles"},borderTopStyle:{values:"borderStyles"},borderBlockStartStyle:{values:"borderStyles"},borderBottomStyle:{values:"borderStyles"},borderBlockEndStyle:{values:"borderStyles"},borderInlineStartStyle:{values:"borderStyles",shorthand:["borderStartStyle"]},borderInlineEndStyle:{values:"borderStyles",shorthand:["borderEndStyle"]},borderLeftStyle:{values:"borderStyles"},borderRightStyle:{values:"borderStyles"},borderRadius:{values:"radii",shorthand:["rounded"]},borderTopLeftRadius:{values:"radii",shorthand:["roundedTopLeft"]},borderStartStartRadius:{values:"radii",shorthand:["roundedStartStart","borderTopStartRadius"]},borderEndStartRadius:{values:"radii",shorthand:["roundedEndStart","borderBottomStartRadius"]},borderTopRightRadius:{values:"radii",shorthand:["roundedTopRight"]},borderStartEndRadius:{values:"radii",shorthand:["roundedStartEnd","borderTopEndRadius"]},borderEndEndRadius:{values:"radii",shorthand:["roundedEndEnd","borderBottomEndRadius"]},borderBottomLeftRadius:{values:"radii",shorthand:["roundedBottomLeft"]},borderBottomRightRadius:{values:"radii",shorthand:["roundedBottomRight"]},borderInlineStartRadius:{values:"radii",property:"borderRadius",shorthand:["roundedStart","borderStartRadius"],transform:e=>({borderStartStartRadius:e,borderEndStartRadius:e})},borderInlineEndRadius:{values:"radii",property:"borderRadius",shorthand:["roundedEnd","borderEndRadius"],transform:e=>({borderStartEndRadius:e,borderEndEndRadius:e})},borderTopRadius:{values:"radii",property:"borderRadius",shorthand:["roundedTop"],transform:e=>({borderTopLeftRadius:e,borderTopRightRadius:e})},borderBottomRadius:{values:"radii",property:"borderRadius",shorthand:["roundedBottom"],transform:e=>({borderBottomLeftRadius:e,borderBottomRightRadius:e})},borderLeftRadius:{values:"radii",property:"borderRadius",shorthand:["roundedLeft"],transform:e=>({borderTopLeftRadius:e,borderBottomLeftRadius:e})},borderRightRadius:{values:"radii",property:"borderRadius",shorthand:["roundedRight"],transform:e=>({borderTopRightRadius:e,borderBottomRightRadius:e})},borderWidth:{values:"borderWidths"},borderBlockStartWidth:{values:"borderWidths"},borderTopWidth:{values:"borderWidths"},borderBottomWidth:{values:"borderWidths"},borderBlockEndWidth:{values:"borderWidths"},borderRightWidth:{values:"borderWidths"},borderInlineWidth:{values:"borderWidths",shorthand:["borderXWidth"]},borderInlineStartWidth:{values:"borderWidths",shorthand:["borderStartWidth"]},borderInlineEndWidth:{values:"borderWidths",shorthand:["borderEndWidth"]},borderLeftWidth:{values:"borderWidths"},borderBlockWidth:{values:"borderWidths",shorthand:["borderYWidth"]},color:{values:Mn,transform:an("color")},fill:{values:Mn,transform:an("fill")},stroke:{values:Mn,transform:an("stroke")},accentColor:{values:Mn,transform:an("accentColor")},divideX:{values:{type:"string"},transform:e=>({"& > :not(style, [hidden]) ~ :not(style, [hidden])":{borderInlineStartWidth:e,borderInlineEndWidth:"0px"}})},divideY:{values:{type:"string"},transform:e=>({"& > :not(style, [hidden]) ~ :not(style, [hidden])":{borderTopWidth:e,borderBottomWidth:"0px"}})},divideColor:{values:Mn,transform:(e,t)=>({"& > :not(style, [hidden]) ~ :not(style, [hidden])":Sn(e,t)})},divideStyle:{property:"borderStyle",transform:e=>({"& > :not(style, [hidden]) ~ :not(style, [hidden])":{borderStyle:e}})},boxShadow:{values:"shadows",shorthand:["shadow"]},boxShadowColor:{values:Mn,transform:an("--shadow-color"),shorthand:["shadowColor"]},mixBlendMode:{shorthand:["blendMode"]},backgroundBlendMode:{shorthand:["bgBlendMode"]},opacity:{values:"opacity"},filter:{transform:e=>"auto"!==e?{filter:e}:{filter:"var(--blur) var(--brightness) var(--contrast) var(--grayscale) var(--hue-rotate) var(--invert) var(--saturate) var(--sepia) var(--drop-shadow)"}},blur:{values:"blurs",transform:e=>({"--blur":bn("blur",e)})},brightness:{transform:e=>({"--brightness":bn("brightness",e)})},contrast:{transform:e=>({"--contrast":bn("contrast",e)})},grayscale:{transform:e=>({"--grayscale":bn("grayscale",e)})},hueRotate:{transform:e=>({"--hue-rotate":bn("hue-rotate",xn(e))})},invert:{transform:e=>({"--invert":bn("invert",e)})},saturate:{transform:e=>({"--saturate":bn("saturate",e)})},sepia:{transform:e=>({"--sepia":bn("sepia",e)})},dropShadow:{transform:e=>({"--drop-shadow":bn("drop-shadow",e)})},backdropFilter:{transform:e=>"auto"!==e?{backdropFilter:e}:{backdropFilter:"var(--backdrop-blur) var(--backdrop-brightness) var(--backdrop-contrast) var(--backdrop-grayscale) var(--backdrop-hue-rotate) var(--backdrop-invert) var(--backdrop-opacity) var(--backdrop-saturate) var(--backdrop-sepia)"}},backdropBlur:{values:"blurs",transform:e=>({"--backdrop-blur":bn("blur",e)})},backdropBrightness:{transform:e=>({"--backdrop-brightness":bn("brightness",e)})},backdropContrast:{transform:e=>({"--backdrop-contrast":bn("contrast",e)})},backdropGrayscale:{transform:e=>({"--backdrop-grayscale":bn("grayscale",e)})},backdropHueRotate:{transform:e=>({"--backdrop-hue-rotate":bn("hue-rotate",xn(e))})},backdropInvert:{transform:e=>({"--backdrop-invert":bn("invert",e)})},backdropOpacity:{transform:e=>({"--backdrop-opacity":bn("opacity",e)})},backdropSaturate:{transform:e=>({"--backdrop-saturate":bn("saturate",e)})},backdropSepia:{transform:e=>({"--backdrop-sepia":bn("sepia",e)})},flexBasis:{values:"sizes"},gap:{values:"spacing"},rowGap:{values:"spacing",shorthand:["gapY"]},columnGap:{values:"spacing",shorthand:["gapX"]},flexDirection:{shorthand:["flexDir"]},gridGap:{values:"spacing"},gridColumnGap:{values:"spacing"},gridRowGap:{values:"spacing"},outlineColor:{values:Mn,transform:an("outlineColor")},focusRing:wn("&:is(:focus, [data-focus])"),focusVisibleRing:wn("&:is(:focus-visible, [data-focus-visible])"),focusRingColor:{values:Mn,transform:an("--focus-ring-color")},focusRingOffset:{values:"spacing",transform:e=>({"--focus-ring-offset":e})},focusRingWidth:{values:"borderWidths",property:"outlineWidth",transform:e=>({"--focus-ring-width":e})},focusRingStyle:{values:"borderStyles",property:"outlineStyle",transform:e=>({"--focus-ring-style":e})},aspectRatio:{values:"aspectRatios"},width:{values:"sizes",shorthand:["w"]},inlineSize:{values:"sizes"},height:{values:"sizes",shorthand:["h"]},blockSize:{values:"sizes"},boxSize:{values:"sizes",property:"width",transform:e=>({width:e,height:e})},minWidth:{values:"sizes",shorthand:["minW"]},minInlineSize:{values:"sizes"},minHeight:{values:"sizes",shorthand:["minH"]},minBlockSize:{values:"sizes"},maxWidth:{values:"sizes",shorthand:["maxW"]},maxInlineSize:{values:"sizes"},maxHeight:{values:"sizes",shorthand:["maxH"]},maxBlockSize:{values:"sizes"},hideFrom:{values:"breakpoints",transform:(e,t)=>{let{raw:i,token:n}=t;const r=n.raw("breakpoints.".concat(i))?"@breakpoint ".concat(i):"@media screen and (min-width: ".concat(e,")");return{[r]:{display:"none"}}}},hideBelow:{values:"breakpoints",transform(e,t){let{raw:i,token:n}=t;const r=n.raw("breakpoints.".concat(i))?"@breakpoint ".concat(i,"Down"):"@media screen and (max-width: ".concat(e,")");return{[r]:{display:"none"}}}},overscrollBehavior:{shorthand:["overscroll"]},overscrollBehaviorX:{shorthand:["overscrollX"]},overscrollBehaviorY:{shorthand:["overscrollY"]},scrollbar:{values:["visible","hidden"],transform(e){switch(e){case"visible":return{msOverflowStyle:"auto",scrollbarWidth:"auto","&::-webkit-scrollbar":{display:"block"}};case"hidden":return{msOverflowStyle:"none",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}};default:return{}}}},scrollbarColor:{values:Mn,transform:an("scrollbarColor")},scrollbarGutter:{values:"spacing"},scrollbarWidth:{values:"sizes"},scrollMargin:{values:"spacing"},scrollMarginTop:{values:"spacing"},scrollMarginBottom:{values:"spacing"},scrollMarginLeft:{values:"spacing"},scrollMarginRight:{values:"spacing"},scrollMarginX:{values:"spacing",transform:e=>({scrollMarginLeft:e,scrollMarginRight:e})},scrollMarginY:{values:"spacing",transform:e=>({scrollMarginTop:e,scrollMarginBottom:e})},scrollPadding:{values:"spacing"},scrollPaddingTop:{values:"spacing"},scrollPaddingBottom:{values:"spacing"},scrollPaddingLeft:{values:"spacing"},scrollPaddingRight:{values:"spacing"},scrollPaddingInline:{values:"spacing",shorthand:["scrollPaddingX"]},scrollPaddingBlock:{values:"spacing",shorthand:["scrollPaddingY"]},scrollSnapType:{values:{none:"none",x:"x var(--scroll-snap-strictness)",y:"y var(--scroll-snap-strictness)",both:"both var(--scroll-snap-strictness)"}},scrollSnapStrictness:{values:["mandatory","proximity"],transform:e=>({"--scroll-snap-strictness":e})},scrollSnapMargin:{values:"spacing"},scrollSnapMarginTop:{values:"spacing"},scrollSnapMarginBottom:{values:"spacing"},scrollSnapMarginLeft:{values:"spacing"},scrollSnapMarginRight:{values:"spacing"},listStylePosition:{shorthand:["listStylePos"]},listStyleImage:{values:"assets",shorthand:["listStyleImg"]},position:{shorthand:["pos"]},zIndex:{values:"zIndex"},inset:{values:"spacing"},insetInline:{values:"spacing",shorthand:["insetX"]},insetBlock:{values:"spacing",shorthand:["insetY"]},top:{values:"spacing"},insetBlockStart:{values:"spacing"},bottom:{values:"spacing"},insetBlockEnd:{values:"spacing"},left:{values:"spacing"},right:{values:"spacing"},insetInlineStart:{values:"spacing",shorthand:["insetStart"]},insetInlineEnd:{values:"spacing",shorthand:["insetEnd"]},ring:{transform:e=>({"--ring-offset-shadow":"var(--ring-inset) 0 0 0 var(--ring-offset-width) var(--ring-offset-color)","--ring-shadow":"var(--ring-inset) 0 0 0 calc(var(--ring-width) + var(--ring-offset-width)) var(--ring-color)","--ring-width":e,boxShadow:"var(--ring-offset-shadow), var(--ring-shadow), var(--shadow, 0 0 #0000)"})},ringColor:{values:Mn,transform:an("--ring-color")},ringOffset:{transform:e=>({"--ring-offset-width":e})},ringOffsetColor:{values:Mn,transform:an("--ring-offset-color")},ringInset:{transform:e=>({"--ring-inset":e})},margin:{values:"spacing",shorthand:["m"]},marginTop:{values:"spacing",shorthand:["mt"]},marginBlockStart:{values:"spacing"},marginRight:{values:"spacing",shorthand:["mr"]},marginBottom:{values:"spacing",shorthand:["mb"]},marginBlockEnd:{values:"spacing"},marginLeft:{values:"spacing",shorthand:["ml"]},marginInlineStart:{values:"spacing",shorthand:["ms","marginStart"]},marginInlineEnd:{values:"spacing",shorthand:["me","marginEnd"]},marginInline:{values:"spacing",shorthand:["mx","marginX"]},marginBlock:{values:"spacing",shorthand:["my","marginY"]},padding:{values:"spacing",shorthand:["p"]},paddingTop:{values:"spacing",shorthand:["pt"]},paddingRight:{values:"spacing",shorthand:["pr"]},paddingBottom:{values:"spacing",shorthand:["pb"]},paddingBlockStart:{values:"spacing"},paddingBlockEnd:{values:"spacing"},paddingLeft:{values:"spacing",shorthand:["pl"]},paddingInlineStart:{values:"spacing",shorthand:["ps","paddingStart"]},paddingInlineEnd:{values:"spacing",shorthand:["pe","paddingEnd"]},paddingInline:{values:"spacing",shorthand:["px","paddingX"]},paddingBlock:{values:"spacing",shorthand:["py","paddingY"]},textDecoration:{shorthand:["textDecor"]},textDecorationColor:{values:Mn,transform:an("textDecorationColor")},textShadow:{values:"shadows"},transform:{transform:e=>{let t=e;return"auto"===e&&(t="translateX(var(--translate-x, 0)) translateY(var(--translate-y, 0)) rotate(var(--rotate, 0)) scaleX(var(--scale-x, 1)) scaleY(var(--scale-y, 1)) skewX(var(--skew-x, 0)) skewY(var(--skew-y, 0))"),"auto-gpu"===e&&(t="translate3d(var(--translate-x, 0), var(--translate-y, 0), 0) rotate(var(--rotate, 0)) scaleX(var(--scale-x, 1)) scaleY(var(--scale-y, 1)) skewX(var(--skew-x, 0)) skewY(var(--skew-y, 0))"),{transform:t}}},skewX:{transform:e=>({"--skew-x":xn(e)})},skewY:{transform:e=>({"--skew-y":xn(e)})},scaleX:{transform:e=>({"--scale-x":e})},scaleY:{transform:e=>({"--scale-y":e})},scale:{transform:e=>"auto"!==e?{scale:e}:{scale:"var(--scale-x, 1) var(--scale-y, 1)"}},spaceXReverse:{values:{type:"boolean"},transform:e=>({"& > :not(style, [hidden]) ~ :not(style, [hidden])":{"--space-x-reverse":e?"1":void 0}})},spaceX:{property:"marginInlineStart",values:"spacing",transform:e=>({"& > :not(style, [hidden]) ~ :not(style, [hidden])":{"--space-x-reverse":"0",marginInlineStart:"calc(".concat(e," * calc(1 - var(--space-x-reverse)))"),marginInlineEnd:"calc(".concat(e," * var(--space-x-reverse))")}})},spaceYReverse:{values:{type:"boolean"},transform:e=>({"& > :not(style, [hidden]) ~ :not(style, [hidden])":{"--space-y-reverse":e?"1":void 0}})},spaceY:{property:"marginTop",values:"spacing",transform:e=>({"& > :not(style, [hidden]) ~ :not(style, [hidden])":{"--space-y-reverse":"0",marginTop:"calc(".concat(e," * calc(1 - var(--space-y-reverse)))"),marginBottom:"calc(".concat(e," * var(--space-y-reverse))")}})},rotate:{transform:e=>"auto"!==e?{rotate:xn(e)}:{rotate:"var(--rotate-x, 0) var(--rotate-y, 0) var(--rotate-z, 0)"}},rotateX:{transform:e=>({"--rotate-x":xn(e)})},rotateY:{transform:e=>({"--rotate-y":xn(e)})},translate:{transform:e=>"auto"!==e?{translate:e}:{translate:"var(--translate-x) var(--translate-y)"}},translateX:{values:"spacing",transform:e=>({"--translate-x":e})},translateY:{values:"spacing",transform:e=>({"--translate-y":e})},transition:{values:["all","common","colors","opacity","position","backgrounds","size","shadow","transform"],transform(e){switch(e){case"all":return _n("all");case"position":return _n("left, right, top, bottom, inset-inline, inset-block");case"colors":return _n("color, background-color, border-color, text-decoration-color, fill, stroke");case"opacity":return _n("opacity");case"shadow":return _n("box-shadow");case"transform":return _n("transform");case"size":return _n("width, height");case"backgrounds":return _n("background, background-color, background-image, background-position");case"common":return _n("color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter");default:return{transition:e}}}},transitionDuration:{values:"durations"},transitionProperty:{values:{common:"background-color, border-color, color, fill, stroke, opacity, box-shadow, translate, transform",colors:"background-color, border-color, color, fill, stroke",size:"width, height",position:"left, right, top, bottom, inset-inline, inset-block",background:"background, background-color, background-image, background-position"}},transitionTimingFunction:{values:"easings"},animation:{values:"animations"},animationDuration:{values:"durations"},animationDelay:{values:"durations"},animationTimingFunction:{values:"easings"},fontFamily:{values:"fonts"},fontSize:{values:"fontSizes"},fontWeight:{values:"fontWeights"},lineHeight:{values:"lineHeights"},letterSpacing:{values:"letterSpacings"},textIndent:{values:"spacing"},truncate:{values:{type:"boolean"},transform:e=>!0===e?{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}:{}},lineClamp:{transform:e=>"none"===e?{WebkitLineClamp:"unset"}:{overflow:"hidden",display:"-webkit-box",WebkitLineClamp:e,WebkitBoxOrient:"vertical",textWrap:"wrap"}},srOnly:{values:{type:"boolean"},transform:e=>Pn[e]||{}},debug:{values:{type:"boolean"},transform:e=>e?{outline:"1px solid blue !important","& > *":{outline:"1px solid red !important"}}:{}},caretColor:{values:Mn,transform:an("caretColor")},cursor:{values:"cursor"}}},Pn={true:{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"},false:{position:"static",width:"auto",height:"auto",padding:"0",margin:"0",overflow:"visible",clip:"auto",whiteSpace:"normal"}};var Dn="".split(","),On="WebkitAppearance,WebkitBorderBefore,WebkitBorderBeforeColor,WebkitBorderBeforeStyle,WebkitBorderBeforeWidth,WebkitBoxReflect,WebkitLineClamp,WebkitMask,WebkitMaskAttachment,WebkitMaskClip,WebkitMaskComposite,WebkitMaskImage,WebkitMaskOrigin,WebkitMaskPosition,WebkitMaskPositionX,WebkitMaskPositionY,WebkitMaskRepeat,WebkitMaskRepeatX,WebkitMaskRepeatY,WebkitMaskSize,WebkitOverflowScrolling,WebkitTapHighlightColor,WebkitTextFillColor,WebkitTextStroke,WebkitTextStrokeColor,WebkitTextStrokeWidth,WebkitTouchCallout,WebkitUserModify,WebkitUserSelect,accentColor,alignContent,alignItems,alignSelf,alignTracks,all,anchorName,anchorScope,animation,animationComposition,animationDelay,animationDirection,animationDuration,animationFillMode,animationIterationCount,animationName,animationPlayState,animationRange,animationRangeEnd,animationRangeStart,animationTimeline,animationTimingFunction,appearance,aspectRatio,backdropFilter,backfaceVisibility,background,backgroundAttachment,backgroundBlendMode,backgroundClip,backgroundColor,backgroundImage,backgroundOrigin,backgroundPosition,backgroundPositionX,backgroundPositionY,backgroundRepeat,backgroundSize,blockSize,border,borderBlock,borderBlockColor,borderBlockEnd,borderBlockEndColor,borderBlockEndStyle,borderBlockEndWidth,borderBlockStart,borderBlockStartColor,borderBlockStartStyle,borderBlockStartWidth,borderBlockStyle,borderBlockWidth,borderBottom,borderBottomColor,borderBottomLeftRadius,borderBottomRightRadius,borderBottomStyle,borderBottomWidth,borderCollapse,borderColor,borderEndEndRadius,borderEndStartRadius,borderImage,borderImageOutset,borderImageRepeat,borderImageSlice,borderImageSource,borderImageWidth,borderInline,borderInlineColor,borderInlineEnd,borderInlineEndColor,borderInlineEndStyle,borderInlineEndWidth,borderInlineStart,borderInlineStartColor,borderInlineStartStyle,borderInlineStartWidth,borderInlineStyle,borderInlineWidth,borderLeft,borderLeftColor,borderLeftStyle,borderLeftWidth,borderRadius,borderRight,borderRightColor,borderRightStyle,borderRightWidth,borderSpacing,borderStartEndRadius,borderStartStartRadius,borderStyle,borderTop,borderTopColor,borderTopLeftRadius,borderTopRightRadius,borderTopStyle,borderTopWidth,borderWidth,bottom,boxAlign,boxDecorationBreak,boxDirection,boxFlex,boxFlexGroup,boxLines,boxOrdinalGroup,boxOrient,boxPack,boxShadow,boxSizing,breakAfter,breakBefore,breakInside,captionSide,caret,caretColor,caretShape,clear,clip,clipPath,clipRule,color,colorInterpolationFilters,colorScheme,columnCount,columnFill,columnGap,columnRule,columnRuleColor,columnRuleStyle,columnRuleWidth,columnSpan,columnWidth,columns,contain,containIntrinsicBlockSize,containIntrinsicHeight,containIntrinsicInlineSize,containIntrinsicSize,containIntrinsicWidth,container,containerName,containerType,content,contentVisibility,counterIncrement,counterReset,counterSet,cursor,cx,cy,d,direction,display,dominantBaseline,emptyCells,fieldSizing,fill,fillOpacity,fillRule,filter,flex,flexBasis,flexDirection,flexFlow,flexGrow,flexShrink,flexWrap,float,floodColor,floodOpacity,font,fontFamily,fontFeatureSettings,fontKerning,fontLanguageOverride,fontOpticalSizing,fontPalette,fontSize,fontSizeAdjust,fontSmooth,fontStretch,fontStyle,fontSynthesis,fontSynthesisPosition,fontSynthesisSmallCaps,fontSynthesisStyle,fontSynthesisWeight,fontVariant,fontVariantAlternates,fontVariantCaps,fontVariantEastAsian,fontVariantEmoji,fontVariantLigatures,fontVariantNumeric,fontVariantPosition,fontVariationSettings,fontWeight,forcedColorAdjust,gap,grid,gridArea,gridAutoColumns,gridAutoFlow,gridAutoRows,gridColumn,gridColumnEnd,gridColumnGap,gridColumnStart,gridGap,gridRow,gridRowEnd,gridRowGap,gridRowStart,gridTemplate,gridTemplateAreas,gridTemplateColumns,gridTemplateRows,hangingPunctuation,height,hyphenateCharacter,hyphenateLimitChars,hyphens,imageOrientation,imageRendering,imageResolution,imeMode,initialLetter,initialLetterAlign,inlineSize,inset,insetBlock,insetBlockEnd,insetBlockStart,insetInline,insetInlineEnd,insetInlineStart,interpolateSize,isolation,justifyContent,justifyItems,justifySelf,justifyTracks,left,letterSpacing,lightingColor,lineBreak,lineClamp,lineHeight,lineHeightStep,listStyle,listStyleImage,listStylePosition,listStyleType,margin,marginBlock,marginBlockEnd,marginBlockStart,marginBottom,marginInline,marginInlineEnd,marginInlineStart,marginLeft,marginRight,marginTop,marginTrim,marker,markerEnd,markerMid,markerStart,mask,maskBorder,maskBorderMode,maskBorderOutset,maskBorderRepeat,maskBorderSlice,maskBorderSource,maskBorderWidth,maskClip,maskComposite,maskImage,maskMode,maskOrigin,maskPosition,maskRepeat,maskSize,maskType,masonryAutoFlow,mathDepth,mathShift,mathStyle,maxBlockSize,maxHeight,maxInlineSize,maxLines,maxWidth,minBlockSize,minHeight,minInlineSize,minWidth,mixBlendMode,objectFit,objectPosition,offset,offsetAnchor,offsetDistance,offsetPath,offsetPosition,offsetRotate,opacity,order,orphans,outline,outlineColor,outlineOffset,outlineStyle,outlineWidth,overflow,overflowAnchor,overflowBlock,overflowClipBox,overflowClipMargin,overflowInline,overflowWrap,overflowX,overflowY,overlay,overscrollBehavior,overscrollBehaviorBlock,overscrollBehaviorInline,overscrollBehaviorX,overscrollBehaviorY,padding,paddingBlock,paddingBlockEnd,paddingBlockStart,paddingBottom,paddingInline,paddingInlineEnd,paddingInlineStart,paddingLeft,paddingRight,paddingTop,page,pageBreakAfter,pageBreakBefore,pageBreakInside,paintOrder,perspective,perspectiveOrigin,placeContent,placeItems,placeSelf,pointerEvents,position,positionAnchor,positionArea,positionTry,positionTryFallbacks,positionTryOrder,positionVisibility,printColorAdjust,quotes,r,resize,right,rotate,rowGap,rubyAlign,rubyMerge,rubyPosition,rx,ry,scale,scrollBehavior,scrollMargin,scrollMarginBlock,scrollMarginBlockEnd,scrollMarginBlockStart,scrollMarginBottom,scrollMarginInline,scrollMarginInlineEnd,scrollMarginInlineStart,scrollMarginLeft,scrollMarginRight,scrollMarginTop,scrollPadding,scrollPaddingBlock,scrollPaddingBlockEnd,scrollPaddingBlockStart,scrollPaddingBottom,scrollPaddingInline,scrollPaddingInlineEnd,scrollPaddingInlineStart,scrollPaddingLeft,scrollPaddingRight,scrollPaddingTop,scrollSnapAlign,scrollSnapCoordinate,scrollSnapDestination,scrollSnapPointsX,scrollSnapPointsY,scrollSnapStop,scrollSnapType,scrollSnapTypeX,scrollSnapTypeY,scrollTimeline,scrollTimelineAxis,scrollTimelineName,scrollbarColor,scrollbarGutter,scrollbarWidth,shapeImageThreshold,shapeMargin,shapeOutside,shapeRendering,stopColor,stopOpacity,stroke,strokeDasharray,strokeDashoffset,strokeLinecap,strokeLinejoin,strokeMiterlimit,strokeOpacity,strokeWidth,tabSize,tableLayout,textAlign,textAlignLast,textAnchor,textBox,textBoxEdge,textBoxTrim,textCombineUpright,textDecoration,textDecorationColor,textDecorationLine,textDecorationSkip,textDecorationSkipInk,textDecorationStyle,textDecorationThickness,textEmphasis,textEmphasisColor,textEmphasisPosition,textEmphasisStyle,textIndent,textJustify,textOrientation,textOverflow,textRendering,textShadow,textSizeAdjust,textSpacingTrim,textTransform,textUnderlineOffset,textUnderlinePosition,textWrap,textWrapMode,textWrapStyle,timelineScope,top,touchAction,transform,transformBox,transformOrigin,transformStyle,transition,transitionBehavior,transitionDelay,transitionDuration,transitionProperty,transitionTimingFunction,translate,unicodeBidi,userSelect,vectorEffect,verticalAlign,viewTimeline,viewTimelineAxis,viewTimelineInset,viewTimelineName,viewTransitionName,visibility,whiteSpace,whiteSpaceCollapse,widows,width,willChange,wordBreak,wordSpacing,wordWrap,writingMode,x,y,zIndex,zoom,alignmentBaseline,baselineShift,colorInterpolation,colorRendering,glyphOrientationVertical".split(",").concat(Dn),In=new Map(On.map(e=>[e,!0]));function kn(e){const t=Object.create(null);return i=>(void 0===t[i]&&(t[i]=e(i)),t[i])}var Rn=/&|@/,zn=kn(e=>In.has(e)||e.startsWith("--")||Rn.test(e));function Ln(e){const t=Object.assign({},e);for(let i in t)void 0===t[i]&&delete t[i];return t}const Bn=e=>null!=e;function Nn(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{stop:n,getKey:r}=i;return function e(i){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(sn(i)||Array.isArray(i)){const s={};for(const[l,c]of Object.entries(i)){var o;const d=null!==(o=null===r||void 0===r?void 0:r(l,c))&&void 0!==o?o:l,u=[...a,d];if(null!==n&&void 0!==n&&n(i,u))return t(i,a);const h=e(c,u);Bn(h)&&(s[d]=h)}return s}return t(i,a)}(e)}function Fn(e,t){return Array.isArray(e)?e.map(e=>Bn(e)?t(e):e):sn(e)?Nn(e,e=>t(e)):Bn(e)?t(e):e}function Un(e,t){const i={};return Nn(e,(e,t)=>{e&&(i[t.join(".")]=e.value)},{stop:t}),i}var Vn=i(376);const jn=e=>{const t=Object.create(null);return function(){for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];const a=n.map(e=>Vn(e)).join("|");return void 0===t[a]&&(t[a]=e(...n)),t[a]}},Wn=(e,t)=>((e,t)=>{const i={},n={},r=Object.keys(e);for(const a of r)t(a)?n[a]=e[a]:i[a]=e[a];return[n,i]})(e,cn(t)?t:e=>t.includes(e));var Hn;const Gn="px",qn="em",Xn="rem";function Yn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=new RegExp(String.raw(Hn||(Hn=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["-?d+(?:.d+|d*)"],["-?\\d+(?:\\.\\d+|\\d*)"])))),i=new RegExp("".concat(Gn,"|").concat(qn,"|").concat(Xn)),n=e.match(new RegExp("".concat(t.source,"(").concat(i.source,")")));return null===n||void 0===n?void 0:n[1]}function Qn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("number"===typeof e)return"".concat(e,"px");const t=Yn(e);return t?t===Gn?e:t===qn||t===Xn?"".concat(16*parseFloat(e)).concat(Gn):void 0:e}function Kn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=Yn(e);return t?t===Xn?e:t===qn?"".concat(parseFloat(e)).concat(Xn):t===Gn?"".concat(parseFloat(e)/16).concat(Xn):void 0:e}function Zn(e){const t=function(e){const t=Object.entries(e).sort((e,t)=>{let[,i]=e,[,n]=t;return parseInt(i,10)<parseInt(n,10)?-1:1});return t.map((e,t,i)=>{let[n,r]=e,a=null;var o;t<=i.length-1&&(a=null===(o=i[t+1])||void 0===o?void 0:o[1]);return null!=a&&(a=Jn(a)),[n,{name:n,min:Kn(r),max:a}]})}(e),i=Object.fromEntries(t);function n(e){return i[e]}function r(e){return $n(n(e))}const a=function(){const e=function(){const e=Object.keys(i),t=function(e){const t=[];return e.forEach((i,n)=>{let r=n;r++;let a=e[r];for(;a;)t.push([i,a]),r++,a=e[r]}),t}(e),a=e.flatMap(e=>{const t=n(e),i=["".concat(e,"Down"),$n({max:Jn(t.min)})];return[[e,$n({min:t.min})],["".concat(e,"Only"),r(e)],i]}).filter(e=>{let[,t]=e;return""!==t}).concat(t.map(e=>{let[t,i]=e;const r=n(t),a=n(i);return["".concat(t,"To").concat((o=i,o.charAt(0).toUpperCase()+o.slice(1))),$n({min:r.min,max:Jn(a.min)})];var o}));return Object.fromEntries(a)}();return Object.fromEntries(Object.entries(e))}();return{values:Object.values(i),only:r,keys:function(){return["base",...Object.keys(i)]},conditions:a,getCondition:e=>a[e],up:function(e){return $n({min:n(e).min})},down:function(e){return $n({max:Jn(n(e).min)})}}}function Jn(e){var t;const i=parseFloat(null!==(t=Qn(e))&&void 0!==t?t:"")-.04;return Kn("".concat(i,"px"))}function $n(e){let{min:t,max:i}=e;return null==t&&null==i?"":["@media screen",t&&"(min-width: ".concat(t,")"),i&&"(max-width: ".concat(i,")")].filter(Boolean).join(" and ")}const er=e=>{const{breakpoints:t,conditions:i={}}=e,n=((e,t)=>Object.fromEntries(Object.entries(e).map(e=>{let[i,n]=e;return t(i,n)})))(i,(e,t)=>["_".concat(e),t]),r=Object.assign({},n,t.conditions);function a(){return Object.keys(r)}function o(e){return a().includes(e)||/^@|&|&$/.test(e)||e.startsWith("_")}return{keys:a,sort:function(e){return e.filter(e=>"base"!==e).sort((e,t)=>{const i=o(e),n=o(t);return i&&!n?1:!i&&n?-1:0})},has:o,resolve:function(e){return Reflect.get(r,e)||e},breakpoints:t.keys(),expandAtRule:function(e){return e.startsWith("@breakpoint")?t.getCondition(e.replace("@breakpoint ","")):e}}},tr=e=>({minMax:new RegExp("(!?\\(\\s*min(-device-)?-".concat(e,")(.|\n)+\\(\\s*max(-device)?-").concat(e),"i"),min:new RegExp("\\(\\s*min(-device)?-".concat(e),"i"),maxMin:new RegExp("(!?\\(\\s*max(-device)?-".concat(e,")(.|\n)+\\(\\s*min(-device)?-").concat(e),"i"),max:new RegExp("\\(\\s*max(-device)?-".concat(e),"i")}),ir=tr("width"),nr=tr("height"),rr=e=>({isMin:gr(e.minMax,e.maxMin,e.min),isMax:gr(e.maxMin,e.minMax,e.max)}),{isMin:ar,isMax:or}=rr(ir),{isMin:sr,isMax:lr}=rr(nr),cr=/print/i,dr=/^print$/i,ur=/(-?\d*\.?\d+)(ch|em|ex|px|rem)/,hr=/(\d)/,pr=Number.MAX_VALUE,fr={ch:8.8984375,em:16,rem:16,ex:8.296875,px:1};function mr(e){const t=ur.exec(e)||(ar(e)||sr(e)?hr.exec(e):null);if(!t)return pr;if("0"===t[0])return 0;const i=parseFloat(t[1]),n=t[2];return i*(fr[n]||1)}function gr(e,t,i){return n=>e.test(n)||!t.test(n)&&i.test(n)}const vr=jn((e,t)=>{const i=function(e,t){const i=cr.test(e),n=dr.test(e),r=cr.test(t),a=dr.test(t);return i&&r?!n&&a?1:n&&!a?-1:e.localeCompare(t):i?1:r?-1:null}(e,t);if(null!==i)return i;const n=ar(e)||sr(e),r=or(e)||lr(e),a=ar(t)||sr(t),o=or(t)||lr(t);if(n&&o)return-1;if(r&&a)return 1;const s=mr(e),l=mr(t);return s===pr&&l===pr?e.localeCompare(t):s===pr?1:l===pr?-1:s!==l?s>l?r?-1:1:r?1:-1:e.localeCompare(t)});function yr(e){return e.sort((e,t)=>{let[i]=e,[n]=t;return vr(i,n)})}function br(e){const t=[],i=[],n={};for(const[o,s]of Object.entries(e))o.startsWith("@media")?t.push([o,s]):o.startsWith("@container")?i.push([o,s]):sn(s)?n[o]=br(s):n[o]=s;const r=yr(t),a=yr(i);return c(c(c({},n),Object.fromEntries(r)),Object.fromEntries(a))}const xr=/\s*!(important)?/i;function wr(e){const{transform:t,conditions:i,normalize:n}=e,r=function(e){function t(t){const i=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.filter(e=>sn(e)&&Object.keys(Ln(e)).length>0)}(...t);return 1===i.length?i:i.map(t=>e.normalize(t))}return jn(function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return un({},...t(i))})}(e);return jn(function(){const e=r(...arguments),a=n(e),o=Object.create(null);return Nn(a,(e,n)=>{var r;const a=!!ln(s=e)&&xr.test(s);var s;if(null==e)return;const[l,...c]=i.sort(n).map(i.resolve);a&&(e=(e=>ln(e)?e.replace(xr,"").trim():e)(e));let d=null!==(r=t(l,e))&&void 0!==r?r:Object.create(null);d=Nn(d,e=>ln(e)&&a?"".concat(e," !important"):e,{getKey:e=>i.expandAtRule(e)}),function(e,t,i){let n=e;for(const r of t)r&&(n[r]||(n[r]=Object.create(null)),n=n[r]);un(n,i)}(o,c.flat(),d)}),br(o)})}const Sr=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.filter(Boolean).map(e=>e.trim()).join(" ")};function _r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const i=Object.assign({},e);for(const n of t)n in i&&delete i[n];return i}const Cr=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const n=t.reduce((e,t)=>(null!=t&&t.forEach(t=>e.add(t)),e),new Set([]));return Array.from(n)},Er=e=>c({base:{},variants:{},defaultVariants:{},compoundVariants:[]},e);function Ar(e){const{css:t,conditions:i,normalize:n,layers:r}=e;return function a(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{base:s,variants:l,defaultVariants:d,compoundVariants:u}=Er(o),h=wr({conditions:i,normalize:n,transform(e,t){var i;return null===(i=l[e])||void 0===i?void 0:i[t]}}),p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=n(c(c({},d),Ln(e)));let a=c({},s);un(a,h(i));const o=function(e,i){let n={};return e.forEach(e=>{Object.entries(e).every(e=>{let[t,n]=e;if("css"===t)return!0;return(Array.isArray(n)?n:[n]).some(e=>i[t]===e)})&&(n=t(n,e.css))}),n}(u,i);return r.wrap("recipes",t(a,o))},f=Object.keys(l),m=Object.fromEntries(Object.entries(l).map(e=>{let[t,i]=e;return[t,Object.keys(i)]}));return Object.assign(e=>t(p(e)),{className:o.className,__cva__:!0,variantMap:m,variantKeys:f,raw:p,config:o,splitVariantProps:e=>{const t=_r(e,["recipe"]),[i,n]=Wn(t,f);return f.includes("colorPalette")||(i.colorPalette=e.colorPalette||d.colorPalette),f.includes("orientation")&&(n.orientation=e.orientation),[i,n]},merge(t){return a(function(e){const{css:t}=e;return function(e,i){const n=Er(i.config),r=Cr(e.variantKeys,Object.keys(i.variants)),a=t(e.base,n.base),o=Object.fromEntries(r.map(i=>[i,t(e.config.variants[i],n.variants[i])])),s=un(e.config.defaultVariants,n.defaultVariants),l=[...e.compoundVariants,...n.compoundVariants];return{className:Sr(e.className,i.className),base:a,variants:o,defaultVariants:s,compoundVariants:l}}}(e)(this,t))}})}}const Mr={reset:"reset",base:"base",tokens:"tokens",recipes:"recipes"},Tr={reset:0,base:1,tokens:2,recipes:3};const Pr=(e,t)=>e.filter(e=>e.css[t]).map(e=>c(c({},e),{},{css:e.css[t]}));function Dr(e){const{cva:t}=e;return function(){var e;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=Object.entries(function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=e=>{var i,n,r;return{base:null!==(i=null===(n=t.base)||void 0===n?void 0:n[e])&&void 0!==i?i:{},variants:{},defaultVariants:null!==(r=t.defaultVariants)&&void 0!==r?r:{},compoundVariants:t.compoundVariants?Pr(t.compoundVariants,e):[]}},n=(null!==(e=t.slots)&&void 0!==e?e:[]).map(e=>[e,i(e)]);for(const[a,o]of Object.entries(null!==(r=t.variants)&&void 0!==r?r:{})){var r;for(const[e,t]of Object.entries(o))n.forEach(i=>{var n,r;let[o,s]=i;var l;null!==(n=(l=s.variants)[a])&&void 0!==n||(l[a]={}),s.variants[a][e]=null!==(r=t[o])&&void 0!==r?r:{}})}return Object.fromEntries(n)}(i)).map(e=>{let[i,n]=e;return[i,t(n)]});const r=null!==(e=i.variants)&&void 0!==e?e:{},a=Object.keys(r);const o=Object.fromEntries(Object.entries(r).map(e=>{let[t,i]=e;return[t,Object.keys(i)]}));let s={};return i.className&&(s=Object.fromEntries(i.slots.map(e=>[e,"".concat(i.className,"__").concat(e)]))),Object.assign(function(e){const t=n.map(t=>{let[i,n]=t;return[i,n(e)]});return Object.fromEntries(t)},{variantMap:o,variantKeys:a,splitVariantProps:function(e){const t=_r(e,["recipe"]),[n,r]=Wn(t,a);var o;return a.includes("colorPalette")||(n.colorPalette=e.colorPalette||(null===(o=i.defaultVariants)||void 0===o?void 0:o.colorPalette)),a.includes("orientation")&&(r.orientation=e.orientation),[n,r]},classNameMap:s})}}const Or=/([\0-\x1f\x7f]|^-?\d)|^-$|^-|[^\x80-\uFFFF\w-]/g,Ir=function(e,t){return t?"\0"===e?"\ufffd":"-"===e&&1===e.length?"\\-":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16):"\\"+e},kr=e=>(e+"").replace(Or,Ir),Rr=(e,t)=>{let i="",n=0,r="char",a="",o="";const s=[];for(;n<e.length;){const h=e[n];if("{"===h){const r=e.indexOf("}",n);if(-1===r)break;const a=e.slice(n+1,r),o=t(a);i+=null!==o&&void 0!==o?o:a,n=r+1;continue}if("token"===r&&","===h){""===e[n]&&n++,r="fallback",s.push(r);const l=t(a);null!==l&&void 0!==l&&l.endsWith(")")&&(i+=l.slice(0,-1)),a="",o="";continue}if("fallback"===r){if(", var("===o+h){var l;const t=zr(e.slice(n+1))+n+1,a=e.slice(n+1,t);if(-1===t)break;i+=", var("+a+")",n=t+1,r=null!==(l=s.pop())&&void 0!==l?l:r,o="";continue}}if("token"===r||"fallback"===r){if(n++,")"===h){var c,d,u;r=null!==(c=null!==(d=s.pop())&&void 0!==d?d:r)&&void 0!==c?c:"char",o+=h;const e=a?null!==(u=t(a))&&void 0!==u?u:kr(a):a;if(o)if(o=o.slice(1).trim(),!o.startsWith("token(")&&o.endsWith(")")&&(o=o.slice(0,-1)),o.includes("token(")){const e=Rr(o,t);e&&(o=e.slice(0,-1))}else if(o){const e=t(o);e&&(o=e)}const n=i.at(-1);o?null!==n&&void 0!==n&&n.trim()?i+=e.slice(0,-1)+", "+o+")":i+=o:i+=e||")",a="",o="",r="char";continue}"token"===r&&(a+=h),"fallback"===r&&(o+=h);continue}const p=e.indexOf("token(",n);if(-1!==p){const t=p+6;i+=e.slice(n,p),n=t,r="token",s.push(r);continue}i+=h,n++}return i},zr=e=>{let t=0;const i=["("];for(;t<e.length;){const n=e[t];if("("===n)i.push(n);else if(")"===n&&(i.pop(),0===i.length))return t;t++}return t};function Lr(e){const t={};return e.forEach((e,i)=>{e instanceof Map?t[i]=Object.fromEntries(e):t[i]=e}),t}const Br=/({([^}]*)})/g,Nr=/[{}]/g,Fr=/\w+\.\w+/,Ur=e=>{if(!ln(e))return[];const t=e.match(Br);return t?t.map(e=>e.replace(Nr,"")).map(e=>e.trim()):[]};function Vr(e){var t,i,n,r;if(null===(t=e.extensions)||void 0===t||!t.references)return null!==(n=null===(r=e.extensions)||void 0===r||null===(r=r.cssVar)||void 0===r?void 0:r.ref)&&void 0!==n?n:e.value;const a=null!==(i=e.extensions.references)&&void 0!==i?i:{};return e.value=Object.keys(a).reduce((e,t)=>{const i=a[t];if(i.extensions.conditions)return e;const n=Vr(i);return e.replace("{".concat(t,"}"),n)},e.value),delete e.extensions.references,e.value}function jr(e){return sn(e)&&e.reference?e.reference:String(e)}const Wr=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return i.map(jr).join(" ".concat(e," ")).replace(/calc/g,"")},Hr=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return"calc(".concat(Wr("+",...t),")")},Gr=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return"calc(".concat(Wr("-",...t),")")},qr=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return"calc(".concat(Wr("*",...t),")")},Xr=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return"calc(".concat(Wr("/",...t),")")},Yr=e=>{const t=jr(e);return null==t||Number.isNaN(parseFloat(t))?qr(t,-1):String(t).startsWith("-")?String(t).slice(1):"-".concat(t)},Qr=Object.assign(e=>({add:function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return Qr(Hr(e,...i))},subtract:function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return Qr(Gr(e,...i))},multiply:function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return Qr(qr(e,...i))},divide:function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return Qr(Xr(e,...i))},negate:()=>Qr(Yr(e)),toString:()=>e.toString()}),{add:Hr,subtract:Gr,multiply:qr,divide:Xr,negate:Yr}),Kr={enforce:"pre",transform(e){const{prefix:t,allTokens:i,formatCssVar:n,formatTokenName:r,registerToken:a}=e;i.filter(e=>{let{extensions:t}=e;return"spacing"===t.category}).forEach(e=>{const i=e.path.slice(),o=n(i,t);if(ln(e.value)&&"0rem"===e.value)return;const s=structuredClone(e);Object.assign(s.extensions,{negative:!0,prop:"-".concat(e.extensions.prop),originalPath:i}),s.value=Qr.negate(o.ref);const l=s.path[s.path.length-1];null!=l&&(s.path[s.path.length-1]="-".concat(l)),s.path&&(s.name=r(s.path)),a(s)})}},Zr=new Set(["spacing","sizes","borderWidths","fontSizes","radii"]),Jr={enforce:"post",transform(e){const t=e.allTokens.filter(e=>Zr.has(e.extensions.category)&&!e.extensions.negative);t.forEach(e=>{Object.assign(e.extensions,{pixelValue:Qn(e.value)})})}},$r={enforce:"post",transform(e){const{allTokens:t,registerToken:i,formatTokenName:n}=e,r=t.filter(e=>{let{extensions:t}=e;return"colors"===t.category}),a=new Map,o=new Map;r.forEach(e=>{const{colorPalette:t}=e.extensions;t&&(t.keys.forEach(e=>{a.set(n(e),e)}),t.roots.forEach(i=>{const r=n(i),s=o.get(r)||[];if(s.push(e),o.set(r,s),e.extensions.default&&1===i.length){var l;const e=null===(l=t.keys[0])||void 0===l?void 0:l.filter(Boolean);if(!e.length)return;const r=i.concat(e);a.set(n(r),[])}}))}),a.forEach(e=>{const t=["colors","colorPalette",...e].filter(Boolean),r=n(t),a=n(t.slice(1));i({name:r,value:r,originalValue:r,path:t,extensions:{condition:"base",originalPath:t,category:"colors",prop:a,virtual:!0}},"pre")})}},ea={enforce:"post",transform(e){e.allTokens=e.allTokens.filter(e=>""!==e.value)}},ta=[Kr,$r,Jr,ea],ia={type:"extensions",enforce:"pre",name:"tokens/css-var",transform(e,t){const{prefix:i,formatCssVar:n}=t,{negative:r,originalPath:a}=e.extensions;return{cssVar:n((r?a:e.path).filter(Boolean),i)}}},na={enforce:"post",type:"value",name:"tokens/conditionals",transform(e,t){const{prefix:i,formatCssVar:n}=t,r=Ur(e.value);return r.length?(r.forEach(t=>{const r=n(t.split("."),i);e.value=e.value.replace("{".concat(r.ref,"}"),r)}),e.value):e.value}},ra={type:"extensions",enforce:"pre",name:"tokens/colors/colorPalette",match:e=>"colors"===e.extensions.category&&!e.extensions.virtual,transform(e,t){let i=e.path.slice();if(i.pop(),i.shift(),0===i.length){const t=[...e.path];t.shift(),i=t}if(0===i.length)return{};const n=i.reduce((e,t,i,n)=>{const r=n.slice(0,i+1);return e.push(r),e},[]),r=i[0],a=t.formatTokenName(i),o=e.path.slice(e.path.indexOf(r)+1).reduce((e,t,i,n)=>(e.push(n.slice(i)),e),[]);return 0===o.length&&o.push([""]),{colorPalette:{value:a,roots:n,keys:o}}}},aa=[ia,na,ra],oa=e=>sn(e)&&Object.prototype.hasOwnProperty.call(e,"value");function sa(e){const{prefix:t="",tokens:i={},semanticTokens:n={},breakpoints:r={}}=e,a=e=>e.join("."),o=[],s=new Map,l=new Map,d=new Map,u=new Map,h=new Map,p=new Map,f=new Map,m=new Map,g=[];function v(e,t){o.push(e),s.set(e.name,e),t&&m.forEach(i=>{i.enforce===t&&M(i,e)})}const y=function(e){return e?{breakpoints:Fn(e,e=>({value:e})),sizes:Object.fromEntries(Object.entries(e).map(e=>{let[t,i]=e;return["breakpoint-".concat(t),{value:i}]}))}:{breakpoints:{},sizes:{}}}(r),b=Ln(c(c({},i),{},{breakpoints:y.breakpoints,sizes:c(c({},i.sizes),y.sizes)}));function x(e){return s.get(e)}let w={};function S(){o.forEach(e=>{!function(e){const{condition:t}=e.extensions;t&&(l.has(t)||l.set(t,new Set),l.get(t).add(e))}(e),function(e){const{category:t,prop:i}=e.extensions;t&&(f.has(t)||f.set(t,new Map),f.get(t).set(i,e))}(e),function(e){const{condition:t,negative:i,virtual:n,cssVar:r}=e.extensions;!i&&!n&&t&&r&&(d.has(t)||d.set(t,new Map),d.get(t).set(r.var,e.value))}(e),function(e){const{category:t,prop:i,cssVar:n,negative:r}=e.extensions;if(!t)return;p.has(t)||p.set(t,new Map);const a=r?e.extensions.conditions?e.originalValue:e.value:n.ref;p.get(t).set(i,a),h.set([t,i].join("."),a)}(e),function(e){const{colorPalette:t,virtual:i,default:n}=e.extensions;t&&!i&&t.roots.forEach(i=>{const r=a(i);u.has(r)||u.set(r,new Map);const o=function(e,t){const i=e.findIndex((i,n)=>t.every((t,i)=>e[n+i]===t));return-1===i||(e.splice(i,t.length),e.splice(i,0,"colorPalette")),e}([...e.path],[...i]),s=x(a(o));if(!s||!s.extensions.cssVar)return;const{var:l}=s.extensions.cssVar;if(u.get(r).set(l,e.extensions.cssVar.ref),n&&1===i.length){var c;const n=x(a(["colors","colorPalette"]));if(!n)return;const r=x(a(e.path));if(!r)return;const o=null===(c=t.keys[0])||void 0===c?void 0:c.filter(Boolean);if(!o.length)return;const s=a(i.concat(o));u.has(s)||u.set(s,new Map),u.get(s).set(n.extensions.cssVar.var,r.extensions.cssVar.ref)}})}(e)}),w=Lr(p)}const _=jn((e,t)=>{var i;return null!==(i=h.get(e))&&void 0!==i?i:t}),C=jn(e=>w[e]||null),E=jn(e=>Rr(e,e=>{if(!e)return;if(e.includes("/")){const t=((e,t)=>{var i;if(!e||"string"!==typeof e)return{invalid:!0,value:e};const[n,r]=e.split("/");if(!n||!r)return{invalid:!0,value:n};const a=t(n),o=null===(i=x("opacity.".concat(r)))||void 0===i?void 0:i.value;if(!o&&isNaN(Number(r)))return{invalid:!0,value:n};const s=o?100*Number(o)+"%":"".concat(r,"%"),l=null!==a&&void 0!==a?a:n;return{invalid:!1,color:l,value:"color-mix(in srgb, ".concat(l," ").concat(s,", transparent)")}})(e,e=>_(e));if(t.invalid)throw new Error("Invalid color mix at "+e+": "+t.value);return t.value}const t=_(e);return t||(Fr.test(e)?kr(e):e)})),A={prefix:t,allTokens:o,tokenMap:s,registerToken:v,getByName:x,formatTokenName:a,formatCssVar:(e,t)=>yn(e.join("-"),{prefix:t}),flatMap:h,cssVarMap:d,categoryMap:f,colorPaletteMap:u,getVar:_,getCategoryValues:C,expandReferenceInValue:E};function M(e,t){if(t.extensions.references)return;if(cn(e.match)&&!e.match(t))return;const i=(n=t,e.transform(n,A));var n;switch(!0){case"extensions"===e.type:Object.assign(t.extensions,i);break;case"value"===e.type:t.value=i;break;default:t[e.type]=i}}function T(e){g.forEach(t=>{t.enforce===e&&t.transform(A)})}function P(e){m.forEach(t=>{t.enforce===e&&o.forEach(e=>{M(t,e)})})}function D(){o.forEach(e=>{const t=function(e){if(!e.extensions.conditions)return;const{conditions:t}=e.extensions,i=[];return Nn(t,(t,n)=>{const r=ca(n);if(!r.length)return;const a=structuredClone(e);a.value=t,a.extensions.condition=r.join(":"),i.push(a)}),i}(e);t&&0!==t.length&&t.forEach(e=>{v(e)})})}function O(){o.forEach(e=>{if(t=e.value,!Br.test(t))return;var t;const i=function(e){return Ur(e).map(e=>x(e)).filter(Boolean)}(e.value);e.extensions.references=i.reduce((e,t)=>(e[t.name]=t,e),{})})}function I(){o.forEach(e=>{Vr(e)})}return Nn(b,(e,t)=>{const i=t.includes("DEFAULT"),n=(t=la(t))[0],r=a(t),o=ln(e)?{value:e}:e,s={value:o.value,originalValue:o.value,name:r,path:t,extensions:{condition:"base",originalPath:t,category:n,prop:a(t.slice(1))}};i&&(s.extensions.default=!0),v(s)},{stop:oa}),Nn(n,(e,t)=>{const i=t.includes("DEFAULT"),n=(t=ca(la(t)))[0],r=a(t),o=ln(e.value)?{value:{base:e.value}}:e,s={value:o.value.base||"",originalValue:o.value.base||"",name:r,path:t,extensions:{originalPath:t,category:n,conditions:o.value,condition:"base",prop:a(t.slice(1))}};i&&(s.extensions.default=!0),v(s)},{stop:oa}),function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(e=>{m.set(e.name,e)})}(...aa),function(){g.push(...arguments)}(...ta),T("pre"),P("pre"),D(),O(),I(),T("post"),P("post"),S(),A}function la(e){return"DEFAULT"===e[0]?e:e.filter(e=>"DEFAULT"!==e)}function ca(e){return e.filter(e=>"base"!==e)}(e=>{Array.from(new Set(e))})(["aspectRatios","zIndex","opacity","colors","fonts","fontSizes","fontWeights","lineHeights","letterSpacings","sizes","shadows","spacing","radii","cursor","borders","borderWidths","borderStyles","durations","easings","animations","blurs","gradients","breakpoints","assets"]);function da(e){const t=(i=e.config,Object.fromEntries(Object.entries(i).map(e=>{let[t,i]=e;return[t,i]})));var i;const n=e.tokens,r=new Map,a=new Map;function o(e,i){t[e]=i,s(e,i)}const s=(e,t)=>{const i=d(t);i&&(a.set(e,i),c(e,t))},l=new Map,c=(e,t)=>{var i;if(!t)return;const n=d(t,e=>'type:Tokens["'.concat(e,'"]'));if("object"===typeof n&&n.type)return void l.set(e,new Set(["type:".concat(n.type)]));if(n){const t=new Set(Object.keys(n));l.set(e,t)}const r=null!==(i=l.get(e))&&void 0!==i?i:new Set;t.property&&l.set(e,r.add('CssProperties["'.concat(t.property,'"]')))},d=(e,t)=>{const{values:i}=e,r=e=>{const i=null===t||void 0===t?void 0:t(e);return i?{[i]:i}:void 0};var a,o;return ln(i)?null!==(a=null!==(o=null===r||void 0===r?void 0:r(i))&&void 0!==o?o:n.getCategoryValues(i))&&void 0!==a?a:{}:Array.isArray(i)?i.reduce((e,t)=>(e[t]=t,e),{}):cn(i)?i(t?r:n.getCategoryValues):i},u=jn((e,t)=>({[e]:e.startsWith("--")?n.getVar(t,t):t})),h=Object.assign(n.getVar,{raw:e=>n.getByName(e)}),p=jn((e,i)=>{var r;const o=m(e);ln(i)&&!i.includes("_EMO_")&&(i=n.expandReferenceInValue(i));const s=t[o];if(!s)return u(o,i);const l=null===(r=a.get(o))||void 0===r?void 0:r[i];if(!s.transform)return u(e,null!==l&&void 0!==l?l:i);return s.transform(null!==l&&void 0!==l?l:i,{raw:i,token:h,utils:{colorMix:e=>((e,t)=>{var i;if(!e||"string"!==typeof e)return{invalid:!0,value:e};const[n,r]=e.split("/");if(!n||!r||"currentBg"===n)return{invalid:!0,value:n};const a=t("colors.".concat(n)),o=null===(i=t.raw("opacity.".concat(r)))||void 0===i?void 0:i.value;if(!o&&isNaN(Number(r)))return{invalid:!0,value:n};const s=o?100*Number(o)+"%":"".concat(r,"%"),l=null!==a&&void 0!==a?a:n;return{invalid:!1,color:l,value:"color-mix(in srgb, ".concat(l," ").concat(s,", transparent)")}})(e,h)}})});(()=>{for(const[e,i]of Object.entries(t)){const{shorthand:t}=null!==i&&void 0!==i?i:{};t&&(Array.isArray(t)?t:[t]).forEach(t=>r.set(t,e))}})(),(()=>{const e=Lr(n.colorPaletteMap);o("colorPalette",{values:Object.keys(e),transform:jn(t=>e[t])})})(),(()=>{for(const[e,i]of Object.entries(t))i&&s(e,i)})(),(()=>{for(const[e,i]of Object.entries(t))i&&c(e,i)})();const f=r.size>0,m=jn(e=>{var t;return null!==(t=r.get(e))&&void 0!==t?t:e}),g={keys:()=>[...Array.from(r.keys()),...Object.keys(t)],hasShorthand:f,transform:p,shorthands:r,resolveShorthand:m,register:o,getTypes:()=>{const e=new Map;for(const[t,i]of l.entries()){if(0===i.size){e.set(t,["string"]);continue}const n=Array.from(i).map(e=>e.startsWith("CssProperties")?e:e.startsWith("type:")?e.replace("type:",""):JSON.stringify(e));e.set(t,n)}return e},addPropertyType:(e,t)=>{var i;const n=null!==(i=l.get(e))&&void 0!==i?i:new Set;l.set(e,new Set([...n,...t]))}};return g}const ua={};const ha=e=>sn(e)&&"value"in e,pa=e=>({list:()=>Object.keys(Un(e,ha)),search(e){return this.list().filter(t=>t.includes(e))}}),fa=(e,t,i)=>({categoryKeys:t,list(t){var n,r;return Array.from(null!==(n=null===(r=e.categoryMap.get(t))||void 0===r?void 0:r.entries())&&void 0!==n?n:[]).reduce((e,t)=>{let[n,r]=t;return i(r,n)&&e.push(n),e},[])},search(e,t){return this.list(e).filter(e=>e.includes(t))}}),ma=e=>({list:()=>Object.keys(e),search(e){return this.list().filter(t=>t.includes(e))}}),ga="var(--chakra-empty,/*!*/ /*!*/)",va={"*":c(c(c({fontFeatureSettings:'"cv11"',"--ring-inset":ga,"--ring-offset-width":"0px","--ring-offset-color":"#fff","--ring-color":"rgba(66, 153, 225, 0.6)","--ring-offset-shadow":"0 0 #0000","--ring-shadow":"0 0 #0000"},Object.fromEntries(["brightness","contrast","grayscale","hue-rotate","invert","saturate","sepia","drop-shadow"].map(e=>["--".concat(e),ga]))),Object.fromEntries(["blur","brightness","contrast","grayscale","hue-rotate","invert","opacity","saturate","sepia"].map(e=>["--backdrop-".concat(e),ga]))),{},{"--global-font-mono":"fonts.mono","--global-font-body":"fonts.body","--global-color-border":"colors.border"}),html:{color:"fg",bg:"bg",lineHeight:"1.5",colorPalette:"gray"},"*::placeholder, *[data-placeholder]":{color:"fg.muted/80"},"*::selection":{bg:"colorPalette.emphasized/80"}},ya={"fill.muted":{value:{background:"colorPalette.muted",color:"colorPalette.fg"}},"fill.subtle":{value:{background:"colorPalette.subtle",color:"colorPalette.fg"}},"fill.surface":{value:{background:"colorPalette.subtle",color:"colorPalette.fg",boxShadow:"0 0 0px 1px var(--shadow-color)",boxShadowColor:"colorPalette.muted"}},"fill.solid":{value:{background:"colorPalette.solid",color:"colorPalette.contrast"}},"outline.subtle":{value:{color:"colorPalette.fg",boxShadow:"inset 0 0 0px 1px var(--shadow-color)",boxShadowColor:"colorPalette.subtle"}},"outline.solid":{value:{borderWidth:"1px",borderColor:"colorPalette.solid",color:"colorPalette.fg"}},"indicator.bottom":{value:{position:"relative","--indicator-color-fallback":"colors.colorPalette.solid",_before:{content:'""',position:"absolute",bottom:"var(--indicator-offset-y, 0)",insetInline:"var(--indicator-offset-x, 0)",height:"var(--indicator-thickness, 2px)",background:"var(--indicator-color, var(--indicator-color-fallback))"}}},"indicator.top":{value:{position:"relative","--indicator-color-fallback":"colors.colorPalette.solid",_before:{content:'""',position:"absolute",top:"var(--indicator-offset-y, 0)",insetInline:"var(--indicator-offset-x, 0)",height:"var(--indicator-thickness, 2px)",background:"var(--indicator-color, var(--indicator-color-fallback))"}}},"indicator.start":{value:{position:"relative","--indicator-color-fallback":"colors.colorPalette.solid",_before:{content:'""',position:"absolute",insetInlineStart:"var(--indicator-offset-x, 0)",insetBlock:"var(--indicator-offset-y, 0)",width:"var(--indicator-thickness, 2px)",background:"var(--indicator-color, var(--indicator-color-fallback))"}}},"indicator.end":{value:{position:"relative","--indicator-color-fallback":"colors.colorPalette.solid",_before:{content:'""',position:"absolute",insetInlineEnd:"var(--indicator-offset-x, 0)",insetBlock:"var(--indicator-offset-y, 0)",width:"var(--indicator-thickness, 2px)",background:"var(--indicator-color, var(--indicator-color-fallback))"}}},disabled:{value:{opacity:"0.5",cursor:"not-allowed"}},none:{value:{}}},ba={"slide-fade-in":{value:{transformOrigin:"var(--transform-origin)","&[data-placement^=top]":{animationName:"slide-from-bottom, fade-in"},"&[data-placement^=bottom]":{animationName:"slide-from-top, fade-in"},"&[data-placement^=left]":{animationName:"slide-from-right, fade-in"},"&[data-placement^=right]":{animationName:"slide-from-left, fade-in"}}},"slide-fade-out":{value:{transformOrigin:"var(--transform-origin)","&[data-placement^=top]":{animationName:"slide-to-bottom, fade-out"},"&[data-placement^=bottom]":{animationName:"slide-to-top, fade-out"},"&[data-placement^=left]":{animationName:"slide-to-right, fade-out"},"&[data-placement^=right]":{animationName:"slide-to-left, fade-out"}}},"scale-fade-in":{value:{transformOrigin:"var(--transform-origin)",animationName:"scale-in, fade-in"}},"scale-fade-out":{value:{transformOrigin:"var(--transform-origin)",animationName:"scale-out, fade-out"}}},xa={className:"chakra-badge",base:{display:"inline-flex",alignItems:"center",borderRadius:"l2",gap:"1",fontWeight:"medium",fontVariantNumeric:"tabular-nums",whiteSpace:"nowrap",userSelect:"none"},variants:{variant:{solid:{bg:"colorPalette.solid",color:"colorPalette.contrast"},subtle:{bg:"colorPalette.subtle",color:"colorPalette.fg"},outline:{color:"colorPalette.fg",shadow:"inset 0 0 0px 1px var(--shadow-color)",shadowColor:"colorPalette.muted"},surface:{bg:"colorPalette.subtle",color:"colorPalette.fg",shadow:"inset 0 0 0px 1px var(--shadow-color)",shadowColor:"colorPalette.muted"},plain:{color:"colorPalette.fg"}},size:{xs:{textStyle:"2xs",px:"1",minH:"4"},sm:{textStyle:"xs",px:"1.5",minH:"5"},md:{textStyle:"sm",px:"2",minH:"6"},lg:{textStyle:"sm",px:"2.5",minH:"7"}}},defaultVariants:{variant:"subtle",size:"sm"}},wa={className:"chakra-button",base:{display:"inline-flex",appearance:"none",alignItems:"center",justifyContent:"center",userSelect:"none",position:"relative",borderRadius:"l2",whiteSpace:"nowrap",verticalAlign:"middle",borderWidth:"1px",borderColor:"transparent",cursor:"button",flexShrink:"0",outline:"0",lineHeight:"1.2",isolation:"isolate",fontWeight:"medium",transitionProperty:"common",transitionDuration:"moderate",focusVisibleRing:"outside",_disabled:{layerStyle:"disabled"},_icon:{flexShrink:"0"}},variants:{size:{"2xs":{h:"6",minW:"6",textStyle:"xs",px:"2",gap:"1",_icon:{width:"3.5",height:"3.5"}},xs:{h:"8",minW:"8",textStyle:"xs",px:"2.5",gap:"1",_icon:{width:"4",height:"4"}},sm:{h:"9",minW:"9",px:"3.5",textStyle:"sm",gap:"2",_icon:{width:"4",height:"4"}},md:{h:"10",minW:"10",textStyle:"sm",px:"4",gap:"2",_icon:{width:"5",height:"5"}},lg:{h:"11",minW:"11",textStyle:"md",px:"5",gap:"3",_icon:{width:"5",height:"5"}},xl:{h:"12",minW:"12",textStyle:"md",px:"5",gap:"2.5",_icon:{width:"5",height:"5"}},"2xl":{h:"16",minW:"16",textStyle:"lg",px:"7",gap:"3",_icon:{width:"6",height:"6"}}},variant:{solid:{bg:"colorPalette.solid",color:"colorPalette.contrast",borderColor:"transparent",_hover:{bg:"colorPalette.solid/90"},_expanded:{bg:"colorPalette.solid/90"}},subtle:{bg:"colorPalette.subtle",color:"colorPalette.fg",borderColor:"transparent",_hover:{bg:"colorPalette.muted"},_expanded:{bg:"colorPalette.muted"}},surface:{bg:"colorPalette.subtle",color:"colorPalette.fg",shadow:"0 0 0px 1px var(--shadow-color)",shadowColor:"colorPalette.muted",_hover:{bg:"colorPalette.muted"},_expanded:{bg:"colorPalette.muted"}},outline:{borderWidth:"1px",borderColor:"colorPalette.muted",color:"colorPalette.fg",_hover:{bg:"colorPalette.subtle"},_expanded:{bg:"colorPalette.subtle"}},ghost:{bg:"transparent",color:"colorPalette.fg",_hover:{bg:"colorPalette.subtle"},_expanded:{bg:"colorPalette.subtle"}},plain:{color:"colorPalette.fg"}}},defaultVariants:{size:"md",variant:"solid"}},Sa={className:"chakra-checkmark",base:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:"0",color:"white",borderWidth:"1px",borderColor:"transparent",borderRadius:"l1",cursor:"checkbox",focusVisibleRing:"outside",_icon:{boxSize:"full"},_invalid:{colorPalette:"red",borderColor:"border.error"},_disabled:{opacity:"0.5",cursor:"disabled"}},variants:{size:{xs:{boxSize:"3"},sm:{boxSize:"4"},md:{boxSize:"5",p:"0.5"},lg:{boxSize:"6",p:"0.5"}},variant:{solid:{borderColor:"border.emphasized","&:is([data-state=checked], [data-state=indeterminate])":{bg:"colorPalette.solid",color:"colorPalette.contrast",borderColor:"colorPalette.solid"}},outline:{borderColor:"border","&:is([data-state=checked], [data-state=indeterminate])":{color:"colorPalette.fg",borderColor:"colorPalette.solid"}},subtle:{bg:"colorPalette.muted",borderColor:"colorPalette.muted","&:is([data-state=checked], [data-state=indeterminate])":{color:"colorPalette.fg"}},plain:{"&:is([data-state=checked], [data-state=indeterminate])":{color:"colorPalette.fg"}},inverted:{borderColor:"border",color:"colorPalette.fg","&:is([data-state=checked], [data-state=indeterminate])":{borderColor:"colorPalette.solid"}}}},defaultVariants:{variant:"solid",size:"md"}},{variants:_a,defaultVariants:Ca}=xa,Ea={className:"color-swatch",base:{boxSize:"var(--swatch-size)",shadow:"inset 0 0 0 1px rgba(0, 0, 0, 0.1)","--checker-size":"8px","--checker-bg":"colors.bg","--checker-fg":"colors.bg.emphasized",background:"linear-gradient(var(--color), var(--color)), repeating-conic-gradient(var(--checker-fg) 0%, var(--checker-fg) 25%, var(--checker-bg) 0%, var(--checker-bg) 50%) 0% 50% / var(--checker-size) var(--checker-size) !important",display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:"0"},variants:{size:{"2xs":{"--swatch-size":"sizes.3.5"},xs:{"--swatch-size":"sizes.4"},sm:{"--swatch-size":"sizes.4.5"},md:{"--swatch-size":"sizes.5"},lg:{"--swatch-size":"sizes.6"},xl:{"--swatch-size":"sizes.7"},"2xl":{"--swatch-size":"sizes.8"},inherit:{"--swatch-size":"inherit"},full:{"--swatch-size":"100%"}},shape:{square:{borderRadius:"none"},circle:{borderRadius:"full"},rounded:{borderRadius:"l1"}}},defaultVariants:{size:"md",shape:"rounded"}},Aa={className:"chakra-icon",base:{display:"inline-block",lineHeight:"1em",flexShrink:"0",color:"currentcolor",verticalAlign:"middle"},variants:{size:{inherit:{},xs:{boxSize:"3"},sm:{boxSize:"4"},md:{boxSize:"5"},lg:{boxSize:"6"},xl:{boxSize:"7"},"2xl":{boxSize:"8"}}},defaultVariants:{size:"inherit"}},Ma={className:"chakra-input",base:{width:"100%",minWidth:"0",outline:"0",position:"relative",appearance:"none",textAlign:"start",borderRadius:"l2",_disabled:{layerStyle:"disabled"},height:"var(--input-height)",minW:"var(--input-height)","--focus-color":"colors.colorPalette.focusRing","--error-color":"colors.border.error",_invalid:{focusRingColor:"var(--error-color)",borderColor:"var(--error-color)"}},variants:{size:{"2xs":{textStyle:"xs",px:"2","--input-height":"sizes.7"},xs:{textStyle:"xs",px:"2","--input-height":"sizes.8"},sm:{textStyle:"sm",px:"2.5","--input-height":"sizes.9"},md:{textStyle:"sm",px:"3","--input-height":"sizes.10"},lg:{textStyle:"md",px:"4","--input-height":"sizes.11"},xl:{textStyle:"md",px:"4.5","--input-height":"sizes.12"},"2xl":{textStyle:"lg",px:"5","--input-height":"sizes.16"}},variant:{outline:{bg:"transparent",borderWidth:"1px",borderColor:"border",focusVisibleRing:"inside",focusRingColor:"var(--focus-color)"},subtle:{borderWidth:"1px",borderColor:"transparent",bg:"bg.muted",focusVisibleRing:"inside",focusRingColor:"var(--focus-color)"},flushed:{bg:"transparent",borderBottomWidth:"1px",borderBottomColor:"border",borderRadius:"0",px:"0",_focusVisible:{borderColor:"var(--focus-color)",boxShadow:"0px 1px 0px 0px var(--focus-color)",_invalid:{borderColor:"var(--error-color)",boxShadow:"0px 1px 0px 0px var(--error-color)"}}}}},defaultVariants:{size:"md",variant:"outline"}},Ta={className:"chakra-radiomark",base:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,verticalAlign:"top",color:"white",borderWidth:"1px",borderColor:"transparent",borderRadius:"full",cursor:"radio",_focusVisible:{outline:"2px solid",outlineColor:"colorPalette.focusRing",outlineOffset:"2px"},_invalid:{colorPalette:"red",borderColor:"red.500"},_disabled:{opacity:"0.5",cursor:"disabled"},"& .dot":{height:"100%",width:"100%",borderRadius:"full",bg:"currentColor",scale:"0.4"}},variants:{variant:{solid:{borderWidth:"1px",borderColor:"border.emphasized",_checked:{bg:"colorPalette.solid",color:"colorPalette.contrast",borderColor:"colorPalette.solid"}},subtle:{borderWidth:"1px",bg:"colorPalette.muted",borderColor:"colorPalette.muted",color:"transparent",_checked:{color:"colorPalette.fg"}},outline:{borderWidth:"1px",borderColor:"inherit",_checked:{color:"colorPalette.fg",borderColor:"colorPalette.solid"},"& .dot":{scale:"0.6"}},inverted:{bg:"bg",borderWidth:"1px",borderColor:"inherit",_checked:{color:"colorPalette.solid",borderColor:"currentcolor"}}},size:{xs:{boxSize:"3"},sm:{boxSize:"4"},md:{boxSize:"5"},lg:{boxSize:"6"}}},defaultVariants:{variant:"solid",size:"md"}},Pa={badge:xa,button:wa,code:{className:"chakra-code",base:{fontFamily:"mono",alignItems:"center",display:"inline-flex",borderRadius:"l2"},variants:_a,defaultVariants:Ca},container:{className:"chakra-container",base:{position:"relative",maxWidth:"8xl",w:"100%",mx:"auto",px:{base:"4",md:"6",lg:"8"}},variants:{centerContent:{true:{display:"flex",flexDirection:"column",alignItems:"center"}},fluid:{true:{maxWidth:"full"}}}},heading:{className:"chakra-heading",base:{fontFamily:"heading",fontWeight:"semibold"},variants:{size:{xs:{textStyle:"xs"},sm:{textStyle:"sm"},md:{textStyle:"md"},lg:{textStyle:"lg"},xl:{textStyle:"xl"},"2xl":{textStyle:"2xl"},"3xl":{textStyle:"3xl"},"4xl":{textStyle:"4xl"},"5xl":{textStyle:"5xl"},"6xl":{textStyle:"6xl"},"7xl":{textStyle:"7xl"}}},defaultVariants:{size:"xl"}},input:Ma,inputAddon:{className:"chakra-input-addon",base:{flex:"0 0 auto",width:"auto",display:"flex",alignItems:"center",whiteSpace:"nowrap",alignSelf:"stretch",borderRadius:"l2"},variants:{size:Ma.variants.size,variant:{outline:{borderWidth:"1px",borderColor:"border",bg:"bg.muted"},subtle:{borderWidth:"1px",borderColor:"transparent",bg:"bg.emphasized"},flushed:{borderBottom:"1px solid",borderColor:"inherit",borderRadius:"0",px:"0",bg:"transparent"}}},defaultVariants:{size:"md",variant:"outline"}},kbd:{className:"chakra-kbd",base:{display:"inline-flex",alignItems:"center",fontWeight:"medium",fontFamily:"mono",flexShrink:"0",whiteSpace:"nowrap",wordSpacing:"-0.5em",userSelect:"none",px:"1",borderRadius:"l2"},variants:{variant:{raised:{bg:"colorPalette.subtle",color:"colorPalette.fg",borderWidth:"1px",borderBottomWidth:"2px",borderColor:"colorPalette.muted"},outline:{borderWidth:"1px",color:"colorPalette.fg"},subtle:{bg:"colorPalette.muted",color:"colorPalette.fg"},plain:{color:"colorPalette.fg"}},size:{sm:{textStyle:"xs",height:"4.5"},md:{textStyle:"sm",height:"5"},lg:{textStyle:"md",height:"6"}}},defaultVariants:{size:"md",variant:"raised"}},link:{className:"chakra-link",base:{display:"inline-flex",alignItems:"center",outline:"none",gap:"1.5",cursor:"pointer",borderRadius:"l1",focusRing:"outside"},variants:{variant:{underline:{color:"colorPalette.fg",textDecoration:"underline",textUnderlineOffset:"3px",textDecorationColor:"currentColor/20"},plain:{color:"colorPalette.fg",_hover:{textDecoration:"underline",textUnderlineOffset:"3px",textDecorationColor:"currentColor/20"}}}},defaultVariants:{variant:"plain"}},mark:{className:"chakra-mark",base:{bg:"transparent",color:"inherit",whiteSpace:"nowrap"},variants:{variant:{subtle:{bg:"colorPalette.subtle",color:"inherit"},solid:{bg:"colorPalette.solid",color:"colorPalette.contrast"},text:{fontWeight:"medium"},plain:{}}}},separator:{className:"chakra-separator",base:{display:"block",borderColor:"border"},variants:{variant:{solid:{borderStyle:"solid"},dashed:{borderStyle:"dashed"},dotted:{borderStyle:"dotted"}},orientation:{vertical:{borderInlineStartWidth:"var(--separator-thickness)"},horizontal:{borderTopWidth:"var(--separator-thickness)"}},size:{xs:{"--separator-thickness":"0.5px"},sm:{"--separator-thickness":"1px"},md:{"--separator-thickness":"2px"},lg:{"--separator-thickness":"3px"}}},defaultVariants:{size:"sm",variant:"solid",orientation:"horizontal"}},skeleton:{className:"chakra-skeleton",base:{},variants:{loading:{true:{borderRadius:"l2",boxShadow:"none",backgroundClip:"padding-box",cursor:"default",color:"transparent",pointerEvents:"none",userSelect:"none",flexShrink:"0","&::before, &::after, *":{visibility:"hidden"}},false:{background:"unset",animation:"fade-in var(--fade-duration, 0.1s) ease-out !important"}},variant:{pulse:{background:"bg.emphasized",animation:"pulse",animationDuration:"var(--duration, 1.2s)"},shine:{"--animate-from":"200%","--animate-to":"-200%","--start-color":"colors.bg.muted","--end-color":"colors.bg.emphasized",backgroundImage:"linear-gradient(270deg,var(--start-color),var(--end-color),var(--end-color),var(--start-color))",backgroundSize:"400% 100%",animation:"bg-position var(--duration, 5s) ease-in-out infinite"},none:{animation:"none"}}},defaultVariants:{variant:"pulse",loading:!0}},skipNavLink:{className:"chakra-skip-nav",base:{display:"inline-flex",bg:"bg.panel",padding:"2.5",borderRadius:"l2",fontWeight:"semibold",focusVisibleRing:"outside",textStyle:"sm",userSelect:"none",border:"0",height:"1px",width:"1px",margin:"-1px",outline:"0",overflow:"hidden",position:"absolute",clip:"rect(0 0 0 0)",_focusVisible:{clip:"auto",width:"auto",height:"auto",position:"fixed",top:"6",insetStart:"6"}}},spinner:{className:"chakra-spinner",base:{display:"inline-block",borderColor:"currentColor",borderStyle:"solid",borderWidth:"2px",borderRadius:"full",width:"var(--spinner-size)",height:"var(--spinner-size)",animation:"spin",animationDuration:"slowest","--spinner-track-color":"transparent",borderBottomColor:"var(--spinner-track-color)",borderInlineStartColor:"var(--spinner-track-color)"},variants:{size:{inherit:{"--spinner-size":"1em"},xs:{"--spinner-size":"sizes.3"},sm:{"--spinner-size":"sizes.4"},md:{"--spinner-size":"sizes.5"},lg:{"--spinner-size":"sizes.8"},xl:{"--spinner-size":"sizes.10"}}},defaultVariants:{size:"md"}},textarea:{className:"chakra-textarea",base:{width:"100%",minWidth:"0",outline:"0",position:"relative",appearance:"none",textAlign:"start",borderRadius:"l2",_disabled:{layerStyle:"disabled"},"--focus-color":"colors.colorPalette.focusRing","--error-color":"colors.border.error",_invalid:{focusRingColor:"var(--error-color)",borderColor:"var(--error-color)"}},variants:{size:{xs:{textStyle:"xs",px:"2",py:"1.5",scrollPaddingBottom:"1.5"},sm:{textStyle:"sm",px:"2.5",py:"2",scrollPaddingBottom:"2"},md:{textStyle:"sm",px:"3",py:"2",scrollPaddingBottom:"2"},lg:{textStyle:"md",px:"4",py:"3",scrollPaddingBottom:"3"},xl:{textStyle:"md",px:"4.5",py:"3.5",scrollPaddingBottom:"3.5"}},variant:{outline:{bg:"transparent",borderWidth:"1px",borderColor:"border",focusVisibleRing:"inside"},subtle:{borderWidth:"1px",borderColor:"transparent",bg:"bg.muted",focusVisibleRing:"inside"},flushed:{bg:"transparent",borderBottomWidth:"1px",borderBottomColor:"border",borderRadius:"0",px:"0",_focusVisible:{borderColor:"var(--focus-color)",boxShadow:"0px 1px 0px 0px var(--focus-color)"}}}},defaultVariants:{size:"md",variant:"outline"}},icon:Aa,checkmark:Sa,radiomark:Ta,colorSwatch:Ea},Da=fn.colors({bg:{DEFAULT:{value:{_light:"{colors.white}",_dark:"{colors.black}"}},subtle:{value:{_light:"{colors.gray.50}",_dark:"{colors.gray.950}"}},muted:{value:{_light:"{colors.gray.100}",_dark:"{colors.gray.900}"}},emphasized:{value:{_light:"{colors.gray.200}",_dark:"{colors.gray.800}"}},inverted:{value:{_light:"{colors.black}",_dark:"{colors.white}"}},panel:{value:{_light:"{colors.white}",_dark:"{colors.gray.950}"}},error:{value:{_light:"{colors.red.50}",_dark:"{colors.red.950}"}},warning:{value:{_light:"{colors.orange.50}",_dark:"{colors.orange.950}"}},success:{value:{_light:"{colors.green.50}",_dark:"{colors.green.950}"}},info:{value:{_light:"{colors.blue.50}",_dark:"{colors.blue.950}"}}},fg:{DEFAULT:{value:{_light:"{colors.black}",_dark:"{colors.gray.50}"}},muted:{value:{_light:"{colors.gray.600}",_dark:"{colors.gray.400}"}},subtle:{value:{_light:"{colors.gray.400}",_dark:"{colors.gray.500}"}},inverted:{value:{_light:"{colors.gray.50}",_dark:"{colors.black}"}},error:{value:{_light:"{colors.red.500}",_dark:"{colors.red.400}"}},warning:{value:{_light:"{colors.orange.600}",_dark:"{colors.orange.300}"}},success:{value:{_light:"{colors.green.600}",_dark:"{colors.green.300}"}},info:{value:{_light:"{colors.blue.600}",_dark:"{colors.blue.300}"}}},border:{DEFAULT:{value:{_light:"{colors.gray.200}",_dark:"{colors.gray.800}"}},muted:{value:{_light:"{colors.gray.100}",_dark:"{colors.gray.900}"}},subtle:{value:{_light:"{colors.gray.50}",_dark:"{colors.gray.950}"}},emphasized:{value:{_light:"{colors.gray.300}",_dark:"{colors.gray.700}"}},inverted:{value:{_light:"{colors.gray.800}",_dark:"{colors.gray.200}"}},error:{value:{_light:"{colors.red.500}",_dark:"{colors.red.400}"}},warning:{value:{_light:"{colors.orange.500}",_dark:"{colors.orange.400}"}},success:{value:{_light:"{colors.green.500}",_dark:"{colors.green.400}"}},info:{value:{_light:"{colors.blue.500}",_dark:"{colors.blue.400}"}}},gray:{contrast:{value:{_light:"{colors.white}",_dark:"{colors.black}"}},fg:{value:{_light:"{colors.gray.800}",_dark:"{colors.gray.200}"}},subtle:{value:{_light:"{colors.gray.100}",_dark:"{colors.gray.900}"}},muted:{value:{_light:"{colors.gray.200}",_dark:"{colors.gray.800}"}},emphasized:{value:{_light:"{colors.gray.300}",_dark:"{colors.gray.700}"}},solid:{value:{_light:"{colors.gray.900}",_dark:"{colors.white}"}},focusRing:{value:{_light:"{colors.gray.400}",_dark:"{colors.gray.400}"}}},red:{contrast:{value:{_light:"white",_dark:"white"}},fg:{value:{_light:"{colors.red.700}",_dark:"{colors.red.300}"}},subtle:{value:{_light:"{colors.red.100}",_dark:"{colors.red.900}"}},muted:{value:{_light:"{colors.red.200}",_dark:"{colors.red.800}"}},emphasized:{value:{_light:"{colors.red.300}",_dark:"{colors.red.700}"}},solid:{value:{_light:"{colors.red.600}",_dark:"{colors.red.600}"}},focusRing:{value:{_light:"{colors.red.500}",_dark:"{colors.red.500}"}}},orange:{contrast:{value:{_light:"white",_dark:"black"}},fg:{value:{_light:"{colors.orange.700}",_dark:"{colors.orange.300}"}},subtle:{value:{_light:"{colors.orange.100}",_dark:"{colors.orange.900}"}},muted:{value:{_light:"{colors.orange.200}",_dark:"{colors.orange.800}"}},emphasized:{value:{_light:"{colors.orange.300}",_dark:"{colors.orange.700}"}},solid:{value:{_light:"{colors.orange.600}",_dark:"{colors.orange.500}"}},focusRing:{value:{_light:"{colors.orange.500}",_dark:"{colors.orange.500}"}}},green:{contrast:{value:{_light:"white",_dark:"white"}},fg:{value:{_light:"{colors.green.700}",_dark:"{colors.green.300}"}},subtle:{value:{_light:"{colors.green.100}",_dark:"{colors.green.900}"}},muted:{value:{_light:"{colors.green.200}",_dark:"{colors.green.800}"}},emphasized:{value:{_light:"{colors.green.300}",_dark:"{colors.green.700}"}},solid:{value:{_light:"{colors.green.600}",_dark:"{colors.green.600}"}},focusRing:{value:{_light:"{colors.green.500}",_dark:"{colors.green.500}"}}},blue:{contrast:{value:{_light:"white",_dark:"white"}},fg:{value:{_light:"{colors.blue.700}",_dark:"{colors.blue.300}"}},subtle:{value:{_light:"{colors.blue.100}",_dark:"{colors.blue.900}"}},muted:{value:{_light:"{colors.blue.200}",_dark:"{colors.blue.800}"}},emphasized:{value:{_light:"{colors.blue.300}",_dark:"{colors.blue.700}"}},solid:{value:{_light:"{colors.blue.600}",_dark:"{colors.blue.600}"}},focusRing:{value:{_light:"{colors.blue.500}",_dark:"{colors.blue.500}"}}},yellow:{contrast:{value:{_light:"black",_dark:"black"}},fg:{value:{_light:"{colors.yellow.800}",_dark:"{colors.yellow.300}"}},subtle:{value:{_light:"{colors.yellow.100}",_dark:"{colors.yellow.900}"}},muted:{value:{_light:"{colors.yellow.200}",_dark:"{colors.yellow.800}"}},emphasized:{value:{_light:"{colors.yellow.300}",_dark:"{colors.yellow.700}"}},solid:{value:{_light:"{colors.yellow.300}",_dark:"{colors.yellow.300}"}},focusRing:{value:{_light:"{colors.yellow.500}",_dark:"{colors.yellow.500}"}}},teal:{contrast:{value:{_light:"white",_dark:"white"}},fg:{value:{_light:"{colors.teal.700}",_dark:"{colors.teal.300}"}},subtle:{value:{_light:"{colors.teal.100}",_dark:"{colors.teal.900}"}},muted:{value:{_light:"{colors.teal.200}",_dark:"{colors.teal.800}"}},emphasized:{value:{_light:"{colors.teal.300}",_dark:"{colors.teal.700}"}},solid:{value:{_light:"{colors.teal.600}",_dark:"{colors.teal.600}"}},focusRing:{value:{_light:"{colors.teal.500}",_dark:"{colors.teal.500}"}}},purple:{contrast:{value:{_light:"white",_dark:"white"}},fg:{value:{_light:"{colors.purple.700}",_dark:"{colors.purple.300}"}},subtle:{value:{_light:"{colors.purple.100}",_dark:"{colors.purple.900}"}},muted:{value:{_light:"{colors.purple.200}",_dark:"{colors.purple.800}"}},emphasized:{value:{_light:"{colors.purple.300}",_dark:"{colors.purple.700}"}},solid:{value:{_light:"{colors.purple.600}",_dark:"{colors.purple.600}"}},focusRing:{value:{_light:"{colors.purple.500}",_dark:"{colors.purple.500}"}}},pink:{contrast:{value:{_light:"white",_dark:"white"}},fg:{value:{_light:"{colors.pink.700}",_dark:"{colors.pink.300}"}},subtle:{value:{_light:"{colors.pink.100}",_dark:"{colors.pink.900}"}},muted:{value:{_light:"{colors.pink.200}",_dark:"{colors.pink.800}"}},emphasized:{value:{_light:"{colors.pink.300}",_dark:"{colors.pink.700}"}},solid:{value:{_light:"{colors.pink.600}",_dark:"{colors.pink.600}"}},focusRing:{value:{_light:"{colors.pink.500}",_dark:"{colors.pink.500}"}}},cyan:{contrast:{value:{_light:"white",_dark:"white"}},fg:{value:{_light:"{colors.cyan.700}",_dark:"{colors.cyan.300}"}},subtle:{value:{_light:"{colors.cyan.100}",_dark:"{colors.cyan.900}"}},muted:{value:{_light:"{colors.cyan.200}",_dark:"{colors.cyan.800}"}},emphasized:{value:{_light:"{colors.cyan.300}",_dark:"{colors.cyan.700}"}},solid:{value:{_light:"{colors.cyan.600}",_dark:"{colors.cyan.600}"}},focusRing:{value:{_light:"{colors.cyan.500}",_dark:"{colors.cyan.500}"}}}}),Oa=fn.radii({l1:{value:"{radii.xs}"},l2:{value:"{radii.sm}"},l3:{value:"{radii.md}"}}),Ia=fn.shadows({xs:{value:{_light:"0px 1px 2px {colors.gray.900/10}, 0px 0px 1px {colors.gray.900/20}",_dark:"0px 1px 1px {black/64}, 0px 0px 1px inset {colors.gray.300/20}"}},sm:{value:{_light:"0px 2px 4px {colors.gray.900/10}, 0px 0px 1px {colors.gray.900/30}",_dark:"0px 2px 4px {black/64}, 0px 0px 1px inset {colors.gray.300/30}"}},md:{value:{_light:"0px 4px 8px {colors.gray.900/10}, 0px 0px 1px {colors.gray.900/30}",_dark:"0px 4px 8px {black/64}, 0px 0px 1px inset {colors.gray.300/30}"}},lg:{value:{_light:"0px 8px 16px {colors.gray.900/10}, 0px 0px 1px {colors.gray.900/30}",_dark:"0px 8px 16px {black/64}, 0px 0px 1px inset {colors.gray.300/30}"}},xl:{value:{_light:"0px 16px 24px {colors.gray.900/10}, 0px 0px 1px {colors.gray.900/30}",_dark:"0px 16px 24px {black/64}, 0px 0px 1px inset {colors.gray.300/30}"}},"2xl":{value:{_light:"0px 24px 40px {colors.gray.900/16}, 0px 0px 1px {colors.gray.900/30}",_dark:"0px 24px 40px {black/64}, 0px 0px 1px inset {colors.gray.300/30}"}},inner:{value:{_light:"inset 0 2px 4px 0 {black/5}",_dark:"inset 0 2px 4px 0 black"}},inset:{value:{_light:"inset 0 0 0 1px {black/5}",_dark:"inset 0 0 0 1px {colors.gray.300/5}"}}});var ka=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{parts:function(){if(za(t)){for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return ka(e,n)}throw new Error("createAnatomy().parts(...) should only be called once. Did you mean to use .extendWith(...) ?")},extendWith:function(){for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return ka(e,[...t,...n])},omit:function(){for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return ka(e,t.filter(e=>!n.includes(e)))},rename:e=>ka(e,t),keys:()=>t,build:()=>[...new Set(t)].reduce((t,i)=>Object.assign(t,{[i]:{selector:['&[data-scope="'.concat(Ra(e),'"][data-part="').concat(Ra(i),'"]'),'& [data-scope="'.concat(Ra(e),'"][data-part="').concat(Ra(i),'"]')].join(", "),attrs:{"data-scope":Ra(e),"data-part":Ra(i)}}}),{})}},Ra=e=>e.replace(/([A-Z])([A-Z])/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase(),za=e=>0===e.length;function La(e){return null==e?[]:Array.isArray(e)?e:[e]}var Ba=e=>e[0],Na=e=>e[e.length-1],Fa=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return e.concat(i)},Ua=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return e.filter(e=>!i.includes(e))},Va=e=>Array.from(new Set(e)),ja=(e,t)=>{const i=new Set(t);return e.filter(e=>!i.has(e))},Wa=(e,t)=>((e,t)=>-1!==e.indexOf(t))(e,t)?Ua(e,t):Fa(e,t);function Ha(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{step:n=1,loop:r=!0}=i,a=t+n,o=e.length,s=o-1;return-1===t?n>0?0:s:a<0?r?s:0:a>=o?r?0:t>o?o:t:a}function Ga(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{step:n=1,loop:r=!0}=i;return Ha(e,t,{step:-n,loop:r})}function qa(e,t){return e.reduce((e,i)=>{let[n,r]=e;return t(i)?n.push(i):r.push(i),[n,r]},[[],[]])}var Xa=e=>"Array"===(null===e||void 0===e?void 0:e.constructor.name),Ya=(e,t)=>{if(Object.is(e,t))return!0;if(null==e&&null!=t||null!=e&&null==t)return!1;if("function"===typeof(null===e||void 0===e?void 0:e.isEqual)&&"function"===typeof(null===t||void 0===t?void 0:t.isEqual))return e.isEqual(t);if("function"===typeof e&&"function"===typeof t)return e.toString()===t.toString();if(Xa(e)&&Xa(t))return((e,t)=>{if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Ya(e[i],t[i]))return!1;return!0})(Array.from(e),Array.from(t));if("object"!==typeof e||"object"!==typeof t)return!1;const i=Object.keys(null!==t&&void 0!==t?t:Object.create(null)),n=i.length;for(let r=0;r<n;r++){if(!Reflect.has(e,i[r]))return!1}for(let r=0;r<n;r++){const n=i[r];if(!Ya(e[n],t[n]))return!1}return!0},Qa=e=>Array.isArray(e),Ka=e=>null!=e&&"object"===typeof e,Za=e=>Ka(e)&&!Qa(e),Ja=e=>"number"===typeof e&&!Number.isNaN(e),$a=e=>"string"===typeof e,eo=e=>"function"===typeof e,to=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),io=Function.prototype.toString,no=io.call(Object),ro=e=>{if(!Ka(e)||"[object Object]"!=(e=>Object.prototype.toString.call(e))(e)||ao(e))return!1;const t=Object.getPrototypeOf(e);if(null===t)return!0;const i=to(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&io.call(i)==no},ao=e=>(e=>"object"===typeof e&&null!==e&&"$$typeof"in e&&"props"in e)(e)||(e=>"object"===typeof e&&null!==e&&"__v_isVNode"in e)(e),oo=e=>e(),so=()=>{},lo=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];t.forEach(function(e){null===e||void 0===e||e(...i)})}};function co(e,t){var i;if(e in t){const i=t[e];for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return eo(i)?i(...r):i}const o=new Error("No matching key: ".concat(JSON.stringify(e)," in ").concat(JSON.stringify(Object.keys(t))));throw null===(i=Error.captureStackTrace)||void 0===i||i.call(Error,o,co),o}var uo=(e,t)=>{try{return e()}catch(n){var i;if(n instanceof Error)null===(i=Error.captureStackTrace)||void 0===i||i.call(Error,n,uo);return null===t||void 0===t?void 0:t()}};var{floor:ho,abs:po,round:fo,min:mo,max:go,pow:vo,sign:yo}=Math,bo=e=>Number.isNaN(e),xo=e=>bo(e)?0:e,wo=(e,t)=>(e%t+t)%t,So=(e,t,i)=>xo(e)>=t&&xo(e)<=i,_o=(e,t,i)=>mo(go(xo(e),t),i),Co=(e,t,i)=>(xo(e)-t)/(i-t),Eo=(e,t,i,n)=>_o(((e,t,i)=>fo((xo(e)-t)/i)*i+t)(e*(i-t)+t,t,n),t,i),Ao=(e,t)=>{let i=e,n=t.toString(),r=n.indexOf("."),a=r>=0?n.length-r:0;if(a>0){let e=vo(10,a);i=fo(i*e)/e}return i},Mo=(e,t)=>"number"===typeof t?ho(e*t+.5)/t:fo(e),To=(e,t,i,n)=>{const r=null!=t?Number(t):0,a=Number(i),o=(e-r)%n;let s=2*po(o)>=n?e+yo(o)*(n-po(o)):e-o;if(s=Ao(s,n),!bo(r)&&s<r)s=r;else if(!bo(a)&&s>a){const e=ho((a-r)/n),t=r+e*n;s=e<=0||t<r?a:t}return Ao(s,n)},Po=(e,t,i)=>e[t]===i?e:[...e.slice(0,t),i,...e.slice(t+1)];var Do=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;const n=Math.pow(i,t);return fo(e*n)/n},Oo=e=>{if(!Number.isFinite(e))return 0;let t=1,i=0;for(;Math.round(e*t)/t!==e;)t*=10,i+=1;return i},Io=(e,t,i)=>{let n="+"===t?e+i:e-i;if(e%1!==0||i%1!==0){const r=10**Math.max(Oo(e),Oo(i));e=Math.round(e*r),i=Math.round(i*r),n="+"===t?e+i:e-i,n/=r}return n};function ko(e){if(!ro(e)||void 0===e)return e;const t=Reflect.ownKeys(e).filter(e=>"string"===typeof e),i={};for(const n of t){const t=e[n];void 0!==t&&(i[n]=ko(t))}return i}var Ro=e=>function(t){return function(e,t){const i={},n={},r=new Set(t);for(const a in e)r.has(a)?n[a]=e[a]:i[a]=e[a];return[n,i]}(t,e)};function zo(e,t){if(null==e)throw new Error(t())}const Lo=["skip"];var Bo=Object.defineProperty,No=(e,t,i)=>((e,t,i)=>t in e?Bo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i)(e,"symbol"!==typeof t?t+"":t,i),Fo={itemToValue:e=>"string"===typeof e?e:Za(e)&&to(e,"value")?e.value:"",itemToString:e=>"string"===typeof e?e:Za(e)&&to(e,"label")?e.label:Fo.itemToValue(e),isItemDisabled:e=>!(!Za(e)||!to(e,"disabled"))&&!!e.disabled},Uo=class e{constructor(t){var i=this;this.options=t,No(this,"items"),No(this,"copy",t=>new e(c(c({},this.options),{},{items:null!==t&&void 0!==t?t:[...this.items]}))),No(this,"isEqual",e=>Ya(this.items,e.items)),No(this,"setItems",e=>this.copy(e)),No(this,"getValues",function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.items;return Array.from(e).map(e=>i.getItemValue(e)).filter(Boolean)}),No(this,"find",e=>{if(null==e)return null;const t=this.indexOf(e);return null!=t?this.at(t):null}),No(this,"findMany",e=>Array.from(e).map(e=>this.find(e)).filter(e=>null!=e)),No(this,"at",e=>{var t;if(!this.options.groupBy&&!this.options.groupSort)return null!==(t=this.items[e])&&void 0!==t?t:null;let i=0;const n=this.group();for(const[,r]of n)for(const t of r){if(i===e)return t;i++}return null}),No(this,"sortFn",(e,t)=>{const i=this.indexOf(e),n=this.indexOf(t);return(null!==i&&void 0!==i?i:0)-(null!==n&&void 0!==n?n:0)}),No(this,"sort",e=>[...e].sort(this.sortFn.bind(this))),No(this,"getItemValue",e=>{var t,i,n;return null==e?null:null!==(t=null===(i=(n=this.options).itemToValue)||void 0===i?void 0:i.call(n,e))&&void 0!==t?t:Fo.itemToValue(e)}),No(this,"getItemDisabled",e=>{var t,i,n;return null!=e&&(null!==(t=null===(i=(n=this.options).isItemDisabled)||void 0===i?void 0:i.call(n,e))&&void 0!==t?t:Fo.isItemDisabled(e))}),No(this,"stringifyItem",e=>{var t,i,n;return null==e?null:null!==(t=null===(i=(n=this.options).itemToString)||void 0===i?void 0:i.call(n,e))&&void 0!==t?t:Fo.itemToString(e)}),No(this,"stringify",e=>null==e?null:this.stringifyItem(this.find(e))),No(this,"stringifyItems",function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:", ";return Array.from(e).map(e=>i.stringifyItem(e)).filter(Boolean).join(t)}),No(this,"stringifyMany",(e,t)=>this.stringifyItems(this.findMany(e),t)),No(this,"has",e=>-1!==this.indexOf(e)),No(this,"hasItem",e=>null!=e&&this.has(this.getItemValue(e))),No(this,"group",()=>{const{groupBy:e,groupSort:t}=this.options;if(!e)return[["",[...this.items]]];const i=new Map;this.items.forEach((t,n)=>{const r=e(t,n);i.has(r)||i.set(r,[]),i.get(r).push(t)});let n=Array.from(i.entries());return t&&n.sort((e,i)=>{let[n]=e,[r]=i;if("function"===typeof t)return t(n,r);if(Array.isArray(t)){const e=t.indexOf(n),i=t.indexOf(r);return-1===e?1:-1===i?-1:e-i}return"asc"===t?n.localeCompare(r):"desc"===t?r.localeCompare(n):0}),n}),No(this,"getNextValue",function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=i.indexOf(e);if(-1===r)return null;for(r=n?Math.min(r+t,i.size-1):r+t;r<=i.size&&i.getItemDisabled(i.at(r));)r++;return i.getItemValue(i.at(r))}),No(this,"getPreviousValue",function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=i.indexOf(e);if(-1===r)return null;for(r=n?Math.max(r-t,0):r-t;r>=0&&i.getItemDisabled(i.at(r));)r--;return i.getItemValue(i.at(r))}),No(this,"indexOf",e=>{if(null==e)return-1;if(!this.options.groupBy&&!this.options.groupSort)return this.items.findIndex(t=>this.getItemValue(t)===e);let t=0;const i=this.group();for(const[,n]of i)for(const i of n){if(this.getItemValue(i)===e)return t;t++}return-1}),No(this,"getByText",(e,t)=>{let i=null!=t?jo(this.items,this.indexOf(t)):this.items;return 1===e.length&&(i=i.filter(e=>this.getItemValue(e)!==t)),i.find(t=>Vo(this.stringifyItem(t),e))}),No(this,"search",(e,t)=>{const{state:i,currentValue:n,timeout:r=350}=t,a=i.keysSoFar+e,o=a.length>1&&Array.from(a).every(e=>e===a[0])?a[0]:a,s=this.getByText(o,n),l=this.getItemValue(s);function c(){clearTimeout(i.timer),i.timer=-1}return function e(t){i.keysSoFar=t,c(),""!==t&&(i.timer=+setTimeout(()=>{e(""),c()},r))}(a),l}),No(this,"update",(e,t)=>{let i=this.indexOf(e);return-1===i?this:this.copy([...this.items.slice(0,i),t,...this.items.slice(i+1)])}),No(this,"upsert",function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"append",r=i.indexOf(e);if(-1===r){return("append"===n?i.append:i.prepend)(t)}return i.copy([...i.items.slice(0,r),t,...i.items.slice(r+1)])}),No(this,"insert",function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return i.copy(Wo(i.items,e,...n))}),No(this,"insertBefore",function(e){let t=i.indexOf(e);if(-1===t){if(0!==i.items.length)return i;t=0}for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return i.copy(Wo(i.items,t,...r))}),No(this,"insertAfter",function(e){let t=i.indexOf(e);if(-1===t){if(0!==i.items.length)return i;t=0}for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return i.copy(Wo(i.items,t+1,...r))}),No(this,"prepend",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.copy(Wo(i.items,0,...t))}),No(this,"append",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.copy(Wo(i.items,i.items.length,...t))}),No(this,"filter",e=>{const t=this.items.filter((t,i)=>e(this.stringifyItem(t),i,t));return this.copy(t)}),No(this,"remove",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.map(e=>"string"===typeof e?e:i.getItemValue(e));return i.copy(i.items.filter(e=>{const t=i.getItemValue(e);return null!=t&&!r.includes(t)}))}),No(this,"move",(e,t)=>{const i=this.indexOf(e);return-1===i?this:this.copy(Ho(this.items,[i],t))}),No(this,"moveBefore",function(e){let t=i.items.findIndex(t=>i.getItemValue(t)===e);if(-1===t)return i;for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];let o=r.map(e=>i.items.findIndex(t=>i.getItemValue(t)===e)).sort((e,t)=>e-t);return i.copy(Ho(i.items,o,t))}),No(this,"moveAfter",function(e){let t=i.items.findIndex(t=>i.getItemValue(t)===e);if(-1===t)return i;for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];let o=r.map(e=>i.items.findIndex(t=>i.getItemValue(t)===e)).sort((e,t)=>e-t);return i.copy(Ho(i.items,o,t+1))}),No(this,"reorder",(e,t)=>this.copy(Ho(this.items,[e],t))),No(this,"compareValue",(e,t)=>{const i=this.indexOf(e),n=this.indexOf(t);return i<n?-1:i>n?1:0}),No(this,"range",(e,t)=>{let i=[],n=e;for(;null!=n;){if(this.find(n)&&i.push(n),n===t)return i;n=this.getNextValue(n)}return[]}),No(this,"getValueRange",(e,t)=>e&&t?this.compareValue(e,t)<=0?this.range(e,t):this.range(t,e):[]),No(this,"toString",()=>{let e="";for(const t of this.items){e+=[this.getItemValue(t),this.stringifyItem(t),this.getItemDisabled(t)].filter(Boolean).join(":")+","}return e}),No(this,"toJSON",()=>({size:this.size,first:this.firstValue,last:this.lastValue})),this.items=[...t.items]}get size(){return this.items.length}get firstValue(){let e=0;for(;this.getItemDisabled(this.at(e));)e++;return this.getItemValue(this.at(e))}get lastValue(){let e=this.size-1;for(;this.getItemDisabled(this.at(e));)e--;return this.getItemValue(this.at(e))}*[Symbol.iterator](){yield*this.items}},Vo=(e,t)=>!(null===e||void 0===e||!e.toLowerCase().startsWith(t.toLowerCase())),jo=(e,t)=>e.map((i,n)=>e[(Math.max(t,0)+n)%e.length]);function Wo(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];return[...e.slice(0,t),...n,...e.slice(t)]}function Ho(e,t,i){t=[...t].sort((e,t)=>e-t);const n=t.map(t=>e[t]);for(let r=t.length-1;r>=0;r--)e=[...e.slice(0,t[r]),...e.slice(t[r]+1)];return i=Math.max(0,i-t.filter(e=>e<i).length),[...e.slice(0,i),...n,...e.slice(i)]}Set;function Go(e,t,i){for(let n=0;n<t.length;n++)e=i.getChildren(e,t.slice(n+1))[t[n]];return e}function qo(e){const t=function(e){return e.sort(Xo)}(e),i=[],n=new Set;for(const r of t){const e=r.join();n.has(e)||(n.add(e),i.push(r))}return i}function Xo(e,t){for(let i=0;i<Math.min(e.length,t.length);i++){if(e[i]<t[i])return-1;if(e[i]>t[i])return 1}return e.length-t.length}function Yo(e,t){let i;return rs(e,{onEnter:(e,n)=>{if(t.predicate(e,n))return i=[...n],"stop"},getChildren:t.getChildren}),i}function Qo(e,t){return function(e,t){let i=t.initialResult;return rs(e,c(c({},t),{},{onEnter:(e,n)=>{i=t.nextResult(i,e,n)}})),i}(e,c(c({},t),{},{initialResult:[],nextResult:(e,i,n)=>(e.push(...t.transform(i,n)),e)}))}function Ko(e){return{type:"remove",indexes:e}}function Zo(){return{type:"replace"}}function Jo(e){return[e.slice(0,-1),e[e.length-1]]}function $o(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;const[n,r]=Jo(e);for(let s=n.length-1;s>=0;s--){var a;const e=n.slice(0,s).join();"remove"!==(null===(a=i.get(e))||void 0===a?void 0:a.type)&&i.set(e,Zo())}const o=i.get(n.join());if("remove"===(null===o||void 0===o?void 0:o.type))i.set(n.join(),{type:"removeThenInsert",removeIndexes:o.indexes,insertIndex:r,insertNodes:t});else i.set(n.join(),function(e,t){return{type:"insert",index:e,nodes:t}}(r,t));return i}function es(e){const t=new Map,i=new Map;for(const r of e){var n;const e=r.slice(0,-1).join(),t=null!==(n=i.get(e))&&void 0!==n?n:[];t.push(r[r.length-1]),i.set(e,t.sort((e,t)=>e-t))}for(const r of e)for(let e=r.length-2;e>=0;e--){const i=r.slice(0,e).join();t.has(i)||t.set(i,Zo())}for(const[r,a]of i)t.set(r,Ko(a));return t}function ts(e,t,i){return function(e,t){const i={};return rs(e,c(c({},t),{},{onLeave:(e,n)=>{var r,a;const o=[0,...n],s=o.join(),l=t.transform(e,null!==(r=i[s])&&void 0!==r?r:[],n),c=o.slice(0,-1).join(),d=null!==(a=i[c])&&void 0!==a?a:[];d.push(l),i[c]=d}})),i[""][0]}(e,c(c({},i),{},{getChildren:(e,n)=>{const r=n.join(),a=t.get(r);switch(null===a||void 0===a?void 0:a.type){case"replace":case"remove":case"removeThenInsert":case"insert":return i.getChildren(e,n);default:return[]}},transform:(e,n,r)=>{const a=r.join(),o=t.get(a);switch(null===o||void 0===o?void 0:o.type){case"remove":return i.create(e,n.filter((e,t)=>!o.indexes.includes(t)),r);case"removeThenInsert":const t=n.filter((e,t)=>!o.removeIndexes.includes(t)),a=o.removeIndexes.reduce((e,t)=>t<e?e-1:e,o.insertIndex);return i.create(e,is(t,a,0,...o.insertNodes),r);case"insert":return i.create(e,is(n,o.index,0,...o.nodes),r);case"replace":return i.create(e,n,r);default:return e}}}))}function is(e,t,i){for(var n=arguments.length,r=new Array(n>3?n-3:0),a=3;a<n;a++)r[a-3]=arguments[a];return[...e.slice(0,t),...r,...e.slice(t+i)]}function ns(e,t){if(0===t.at.length)return t.node;const i=function(e,t){const i=new Map,[n,r]=Jo(e);for(let a=n.length-1;a>=0;a--){const e=n.slice(0,a).join();i.set(e,Zo())}return i.set(n.join(),{type:"removeThenInsert",removeIndexes:[r],insertIndex:r,insertNodes:[t]}),i}(t.at,t.node);return ts(e,i,t)}function rs(e,t){const{onEnter:i,onLeave:n,getChildren:r}=t;let a=[],o=[{node:e}];const s=t.reuseIndexPath?()=>a:()=>a.slice();for(;o.length>0;){let e=o[o.length-1];if(void 0===e.state){const t=null===i||void 0===i?void 0:i(e.node,s());if("stop"===t)return;e.state="skip"===t?-1:0}const t=e.children||r(e.node,s());if(e.children||(e.children=t),-1!==e.state){if(e.state<t.length){let i=e.state;a.push(i),o.push({node:t[i]}),e.state=i+1;continue}if("stop"===(null===n||void 0===n?void 0:n(e.node,s())))return}a.pop(),o.pop()}}var as=class e{constructor(t){var i=this;this.options=t,No(this,"rootNode"),No(this,"isEqual",e=>Ya(this.rootNode,e.rootNode)),No(this,"getNodeChildren",e=>{var t,i,n,r;return null!==(t=null!==(i=null===(n=(r=this.options).nodeToChildren)||void 0===n?void 0:n.call(r,e))&&void 0!==i?i:os.nodeToChildren(e))&&void 0!==t?t:[]}),No(this,"resolveIndexPath",e=>"string"===typeof e?this.getIndexPath(e):e),No(this,"resolveNode",e=>{const t=this.resolveIndexPath(e);return t?this.at(t):void 0}),No(this,"getNodeChildrenCount",e=>{var t,i,n;return null!==(t=null===(i=(n=this.options).nodeToChildrenCount)||void 0===i?void 0:i.call(n,e))&&void 0!==t?t:os.nodeToChildrenCount(e)}),No(this,"getNodeValue",e=>{var t,i,n;return null!==(t=null===(i=(n=this.options).nodeToValue)||void 0===i?void 0:i.call(n,e))&&void 0!==t?t:os.nodeToValue(e)}),No(this,"getNodeDisabled",e=>{var t,i,n;return null!==(t=null===(i=(n=this.options).isNodeDisabled)||void 0===i?void 0:i.call(n,e))&&void 0!==t?t:os.isNodeDisabled(e)}),No(this,"stringify",e=>{const t=this.findNode(e);return t?this.stringifyNode(t):null}),No(this,"stringifyNode",e=>{var t,i,n;return null!==(t=null===(i=(n=this.options).nodeToString)||void 0===i?void 0:i.call(n,e))&&void 0!==t?t:os.nodeToString(e)}),No(this,"getFirstNode",function(){let e;return rs(arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.rootNode,{getChildren:i.getNodeChildren,onEnter:(t,n)=>{if(!e&&n.length>0&&!i.getNodeDisabled(t))return e=t,"stop"}}),e}),No(this,"getLastNode",function(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.rootNode,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return rs(t,{getChildren:i.getNodeChildren,onEnter:(r,a)=>{var o;if(!i.isSameNode(r,t))return null!==(o=n.skip)&&void 0!==o&&o.call(n,{value:i.getNodeValue(r),node:r,indexPath:a})?"skip":void(a.length>0&&!i.getNodeDisabled(r)&&(e=r))}}),e}),No(this,"at",e=>Go(this.rootNode,e,{getChildren:this.getNodeChildren})),No(this,"findNode",function(e){return function(e,t){let i;return rs(e,c(c({},t),{},{onEnter:(e,n)=>{if(t.predicate(e,n))return i=e,"stop"}})),i}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.rootNode,{getChildren:i.getNodeChildren,predicate:t=>i.getNodeValue(t)===e})}),No(this,"findNodes",function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.rootNode;const n=new Set(e.filter(e=>null!=e));return function(e,t){const i=[];return rs(e,{onEnter:(e,n)=>{t.predicate(e,n)&&i.push(e)},getChildren:t.getChildren}),i}(t,{getChildren:i.getNodeChildren,predicate:e=>n.has(i.getNodeValue(e))})}),No(this,"sort",e=>e.reduce((e,t)=>{const i=this.getIndexPath(t);return i&&e.push({value:t,indexPath:i}),e},[]).sort((e,t)=>Xo(e.indexPath,t.indexPath)).map(e=>{let{value:t}=e;return t})),No(this,"getIndexPath",e=>Yo(this.rootNode,{getChildren:this.getNodeChildren,predicate:t=>this.getNodeValue(t)===e})),No(this,"getValue",e=>{const t=this.at(e);return t?this.getNodeValue(t):void 0}),No(this,"getValuePath",e=>{if(!e)return[];const t=[];let i=[...e];for(;i.length>0;){const e=this.at(i);e&&t.unshift(this.getNodeValue(e)),i.pop()}return t}),No(this,"getDepth",e=>{var t;const i=Yo(this.rootNode,{getChildren:this.getNodeChildren,predicate:t=>this.getNodeValue(t)===e});return null!==(t=null===i||void 0===i?void 0:i.length)&&void 0!==t?t:0}),No(this,"isSameNode",(e,t)=>this.getNodeValue(e)===this.getNodeValue(t)),No(this,"isRootNode",e=>this.isSameNode(e,this.rootNode)),No(this,"contains",(e,t)=>!(!e||!t)&&t.slice(0,e.length).every((i,n)=>e[n]===t[n])),No(this,"getNextNode",function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!1;return rs(i.rootNode,{getChildren:i.getNodeChildren,onEnter:(a,o)=>{var s;if(i.isRootNode(a))return;const l=i.getNodeValue(a);return null!==(s=n.skip)&&void 0!==s&&s.call(n,{value:l,node:a,indexPath:o})?(l===e&&(r=!0),"skip"):r&&!i.getNodeDisabled(a)?(t=a,"stop"):void(l===e&&(r=!0))}}),t}),No(this,"getPreviousNode",function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!1;return rs(i.rootNode,{getChildren:i.getNodeChildren,onEnter:(a,o)=>{var s;if(i.isRootNode(a))return;const l=i.getNodeValue(a);return null!==(s=n.skip)&&void 0!==s&&s.call(n,{value:l,node:a,indexPath:o})?"skip":l===e?(r=!0,"stop"):void(i.getNodeDisabled(a)||(t=a))}}),r?t:void 0}),No(this,"getParentNodes",e=>{var t;const i=null===(t=this.resolveIndexPath(e))||void 0===t?void 0:t.slice();if(!i)return[];const n=[];for(;i.length>0;){i.pop();const e=this.at(i);e&&!this.isRootNode(e)&&n.unshift(e)}return n}),No(this,"getDescendantNodes",(e,t)=>{const i=this.resolveNode(e);if(!i)return[];const n=[];return rs(i,{getChildren:this.getNodeChildren,onEnter:(e,i)=>{0!==i.length&&(null!==t&&void 0!==t&&t.withBranch||!this.isBranchNode(e))&&n.push(e)}}),n}),No(this,"getDescendantValues",(e,t)=>this.getDescendantNodes(e,t).map(e=>this.getNodeValue(e))),No(this,"getParentIndexPath",e=>e.slice(0,-1)),No(this,"getParentNode",e=>{const t=this.resolveIndexPath(e);return t?this.at(this.getParentIndexPath(t)):void 0}),No(this,"visit",e=>{const{skip:t}=e,i=r(e,Lo);rs(this.rootNode,c(c({},i),{},{getChildren:this.getNodeChildren,onEnter:(e,n)=>{var r;if(!this.isRootNode(e))return null!==t&&void 0!==t&&t({value:this.getNodeValue(e),node:e,indexPath:n})?"skip":null===(r=i.onEnter)||void 0===r?void 0:r.call(i,e,n)}}))}),No(this,"getPreviousSibling",e=>{const t=this.getParentNode(e);if(!t)return;const i=this.getNodeChildren(t);let n=e[e.length-1];for(;--n>=0;){const e=i[n];if(!this.getNodeDisabled(e))return e}}),No(this,"getNextSibling",e=>{const t=this.getParentNode(e);if(!t)return;const i=this.getNodeChildren(t);let n=e[e.length-1];for(;++n<i.length;){const e=i[n];if(!this.getNodeDisabled(e))return e}}),No(this,"getSiblingNodes",e=>{const t=this.getParentNode(e);return t?this.getNodeChildren(t):[]}),No(this,"getValues",function(){const e=Qo(arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.rootNode,{getChildren:i.getNodeChildren,transform:e=>[i.getNodeValue(e)]});return e.slice(1)}),No(this,"isValidDepth",(e,t)=>null==t||("function"===typeof t?t(e.length):e.length===t)),No(this,"isBranchNode",e=>this.getNodeChildren(e).length>0||null!=this.getNodeChildrenCount(e)),No(this,"getBranchValues",function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.rootNode,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];return rs(e,{getChildren:i.getNodeChildren,onEnter:(e,r)=>{var a;if(0===r.length)return;const o=i.getNodeValue(e);if(null!==(a=t.skip)&&void 0!==a&&a.call(t,{value:o,node:e,indexPath:r}))return"skip";i.isBranchNode(e)&&i.isValidDepth(r,t.depth)&&n.push(i.getNodeValue(e))}}),n}),No(this,"flatten",function(){return function(e,t){const i=[];let n=0;const r=new Map,a=new Map;return rs(e,{getChildren:t.getChildren,onEnter:(e,o)=>{r.has(e)||r.set(e,n++);const s=t.getChildren(e,o);s.forEach(t=>{a.has(t)||a.set(t,e),r.has(t)||r.set(t,n++)});const l=s.length>0?s.map(e=>r.get(e)):void 0,d=a.get(e),u=d?r.get(d):void 0,h=r.get(e);i.push(c(c({},e),{},{_children:l,_parent:u,_index:h}))}}),i}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.rootNode,{getChildren:i.getNodeChildren})}),No(this,"_create",(e,t)=>this.getNodeChildren(e).length>0||t.length>0?c(c({},e),{},{children:t}):c({},e)),No(this,"_insert",(e,t,i)=>this.copy(function(e,t){const{nodes:i,at:n}=t;if(0===n.length)throw new Error("Can't insert nodes at the root");return ts(e,$o(n,i),t)}(e,{at:t,nodes:i,getChildren:this.getNodeChildren,create:this._create}))),No(this,"copy",t=>new e(c(c({},this.options),{},{rootNode:t}))),No(this,"_replace",(e,t,i)=>this.copy(ns(e,{at:t,node:i,getChildren:this.getNodeChildren,create:this._create}))),No(this,"_move",(e,t,i)=>this.copy(function(e,t){if(0===t.indexPaths.length)return e;for(const a of t.indexPaths)if(0===a.length)throw new Error("Can't move the root node");if(0===t.to.length)throw new Error("Can't move nodes to the root");const i=qo(t.indexPaths),n=i.map(i=>Go(e,i,t)),r=$o(t.to,n,es(i));return ts(e,r,t)}(e,{indexPaths:t,to:i,getChildren:this.getNodeChildren,create:this._create}))),No(this,"_remove",(e,t)=>this.copy(function(e,t){if(0===t.indexPaths.length)return e;for(const i of t.indexPaths)if(0===i.length)throw new Error("Can't remove the root node");return ts(e,es(t.indexPaths),t)}(e,{indexPaths:t,getChildren:this.getNodeChildren,create:this._create}))),No(this,"replace",(e,t)=>this._replace(this.rootNode,e,t)),No(this,"remove",e=>this._remove(this.rootNode,e)),No(this,"insertBefore",(e,t)=>this.getParentNode(e)?this._insert(this.rootNode,e,t):void 0),No(this,"insertAfter",(e,t)=>{if(!this.getParentNode(e))return;const i=[...e.slice(0,-1),e[e.length-1]+1];return this._insert(this.rootNode,i,t)}),No(this,"move",(e,t)=>this._move(this.rootNode,e,t)),No(this,"filter",e=>{const t=function(e,t){const{predicate:i,create:n,getChildren:r}=t,a=(e,t)=>{const o=r(e,t),s=[];o.forEach((e,i)=>{const n=[...t,i],r=a(e,n);r&&s.push(r)});const l=0===t.length,c=i(e,t),d=s.length>0;return l||c||d?n(e,s,t):null};return a(e,[])||n(e,[],[])}(this.rootNode,{predicate:e,getChildren:this.getNodeChildren,create:this._create});return this.copy(t)}),No(this,"toJSON",()=>this.getValues(this.rootNode)),this.rootNode=t.rootNode}};var os={nodeToValue:e=>"string"===typeof e?e:Za(e)&&to(e,"value")?e.value:"",nodeToString:e=>"string"===typeof e?e:Za(e)&&to(e,"label")?e.label:os.nodeToValue(e),isNodeDisabled:e=>!(!Za(e)||!to(e,"disabled"))&&!!e.disabled,nodeToChildren:e=>e.children,nodeToChildrenCount(e){if(Za(e)&&to(e,"childrenCount"))return e.childrenCount}};const ss=["rootEl"],ls=["defer","target"];var cs=e=>Math.max(0,Math.min(1,e)),ds=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return e=>t.reduce((e,t)=>t(e),e)},us=()=>{},hs=e=>"object"===typeof e&&null!==e,ps=e=>e?"":void 0,fs=e=>hs(e)&&1===e.nodeType&&"string"===typeof e.nodeName,ms=e=>hs(e)&&9===e.nodeType,gs=e=>fs(e)?e.localName||"":"#document";var vs=e=>(e=>hs(e)&&void 0!==e.nodeType)(e)&&11===e.nodeType&&"host"in e,ys=/(textarea|select)/;function bs(e){if(null==e||!fs(e))return!1;try{return(e=>fs(e)&&"input"===e.localName)(e)&&null!=e.selectionStart||ys.test(e.localName)||e.isContentEditable||"true"===e.getAttribute("contenteditable")||""===e.getAttribute("contenteditable")}catch(t){return!1}}function xs(e,t){var i;if(!e||!t)return!1;if(!fs(e)||!fs(t))return!1;const n=null===(i=t.getRootNode)||void 0===i?void 0:i.call(t);if(e===t)return!0;if(e.contains(t))return!0;if(n&&vs(n)){let i=t;for(;i;){if(e===i)return!0;i=i.parentNode||i.host}}return!1}function ws(e){var t;return ms(e)?e:(e=>hs(e)&&e===e.window)(e)?e.document:null!==(t=null===e||void 0===e?void 0:e.ownerDocument)&&void 0!==t?t:document}function Ss(e){var t,i,n;return vs(e)?Ss(e.host):ms(e)?null!==(t=e.defaultView)&&void 0!==t?t:window:fs(e)&&null!==(i=null===(n=e.ownerDocument)||void 0===n?void 0:n.defaultView)&&void 0!==i?i:window}function _s(e){let t=e.activeElement;for(;null!==(i=t)&&void 0!==i&&i.shadowRoot;){var i;const e=t.shadowRoot.activeElement;if(e===t)break;t=e}return t}function Cs(e){if("html"===gs(e))return e;const t=e.assignedSlot||e.parentNode||vs(e)&&e.host||function(e){return ws(e).documentElement}(e);return vs(t)?t.host:t}var Es=new WeakMap;function As(e){return Es.has(e)||Es.set(e,Ss(e).getComputedStyle(e)),Es.get(e)}var Ms=()=>"undefined"!==typeof document;var Ts=e=>Ms()&&e.test(function(){var e;const t=navigator.userAgentData;return null!==(e=null===t||void 0===t?void 0:t.platform)&&void 0!==e?e:navigator.platform}()),Ps=e=>Ms()&&e.test(function(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map(e=>{let{brand:t,version:i}=e;return"".concat(t,"/").concat(i)}).join(" "):navigator.userAgent}()),Ds=()=>Ms()&&!!navigator.maxTouchPoints,Os=()=>Ts(/^iPhone/i)||Ts(/^iPad/i)||Is()&&navigator.maxTouchPoints>1,Is=()=>Ts(/^Mac/i),ks=()=>{return(Is()||Os())&&(e=/apple/i,Ms()&&e.test(navigator.vendor));var e};function Rs(e){var t;const i=function(e){var t,i,n,r;return null!==(t=null===(i=e.composedPath)||void 0===i?void 0:i.call(e))&&void 0!==t?t:null===(n=e.nativeEvent)||void 0===n||null===(r=n.composedPath)||void 0===r?void 0:r.call(n)}(e);return null!==(t=null===i||void 0===i?void 0:i[0])&&void 0!==t?t:e.target}function zs(e){const t=e.currentTarget;if(!t)return!1;if(!t.matches("a[href], button[type='submit'], input[type='submit']"))return!1;const i=1===e.button,n=(r=e,Is()?r.metaKey:r.ctrlKey);var r;return i||n}function Ls(e){return function(e){var t;return null!==(t=e.nativeEvent)&&void 0!==t?t:e}(e).isComposing||229===e.keyCode}function Bs(e){return!(0!==e.mozInputSource||!e.isTrusted)||(Ps(/Android/i)&&e.pointerType?"click"===e.type&&1===e.buttons:0===e.detail&&!e.pointerType)}var Ns={Up:"ArrowUp",Down:"ArrowDown",Esc:"Escape"," ":"Space",",":"Comma",Left:"ArrowLeft",Right:"ArrowRight"},Fs={ArrowLeft:"ArrowRight",ArrowRight:"ArrowLeft"};function Us(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{dir:n="ltr",orientation:r="horizontal"}=i;let a=e.key;a=null!==(t=Ns[a])&&void 0!==t?t:a;return"rtl"===n&&"horizontal"===r&&a in Fs&&(a=Fs[a]),a}function Vs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"client";const i=(e=>"touches"in e&&e.touches.length>0)(e)?e.touches[0]||e.changedTouches[0]:e;return{x:i["".concat(t,"X")],y:i["".concat(t,"Y")]}}var js=(e,t,i,n)=>{const r="function"===typeof e?e():e;return null===r||void 0===r||r.addEventListener(t,i,n),()=>{null===r||void 0===r||r.removeEventListener(t,i,n)}};function Ws(e,t){var i;const{type:n="HTMLInputElement",property:r="value"}=t,a=Ss(e)[n].prototype;return null!==(i=Object.getOwnPropertyDescriptor(a,r))&&void 0!==i?i:{}}function Hs(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"value";if(!e)return;const n=function(e){return"input"===e.localName?"HTMLInputElement":"textarea"===e.localName?"HTMLTextAreaElement":"select"===e.localName?"HTMLSelectElement":void 0}(e);if(n){var r;null===(r=Ws(e,{type:n,property:i}).set)||void 0===r||r.call(e,t)}e.setAttribute(i,t)}function Gs(e,t){var i;if(!e)return;null===Ws(e,{type:"HTMLInputElement",property:"checked"}).set||void 0===i||i.call(e,t),t?e.setAttribute("checked",""):e.removeAttribute("checked")}function qs(e,t){const{value:i,bubbles:n=!0}=t;if(!e)return;const r=Ss(e);e instanceof r.HTMLInputElement&&(Hs(e,"".concat(i)),e.dispatchEvent(new r.Event("input",{bubbles:n})))}function Xs(e,t){const{checked:i,bubbles:n=!0}=t;if(!e)return;const r=Ss(e);e instanceof r.HTMLInputElement&&(Gs(e,i),e.dispatchEvent(new r.Event("click",{bubbles:n})))}function Ys(e,t){if(!e)return;const i=function(e){return function(e){return e.matches("textarea, input, select, button")}(e)?e.form:e.closest("form")}(e),n=e=>{e.defaultPrevented||t()};return null===i||void 0===i||i.addEventListener("reset",n,{passive:!0}),()=>null===i||void 0===i?void 0:i.removeEventListener("reset",n)}function Qs(e,t){const i=null===e||void 0===e?void 0:e.closest("fieldset");if(!i)return;t(i.disabled);const n=new(Ss(i).MutationObserver)(()=>t(i.disabled));return n.observe(i,{attributes:!0,attributeFilter:["disabled"]}),()=>n.disconnect()}function Ks(e,t){if(!e)return;const{onFieldsetDisabledChange:i,onFormReset:n}=t,r=[Ys(e,n),Qs(e,i)];return()=>r.forEach(e=>null===e||void 0===e?void 0:e())}var Zs=e=>fs(e)&&"IFRAME"===e.tagName,Js="input:not([type='hidden']):not([disabled]), select:not([disabled]), textarea:not([disabled]), a[href], button:not([disabled]), [tabindex], iframe, object, embed, area[href], audio[controls], video[controls], [contenteditable]:not([contenteditable='false']), details > summary:first-of-type",$s=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return[];const i=Array.from(e.querySelectorAll(Js));(1==t||"if-empty"==t&&0===i.length)&&fs(e)&&el(e)&&i.unshift(e);const n=i.filter(el);return n.forEach((e,t)=>{if(Zs(e)&&e.contentDocument){const i=e.contentDocument.body;n.splice(t,1,...$s(i))}}),n};function el(e){return!(!e||e.closest("[inert]"))&&(e.matches(Js)&&(e=>!!fs(e)&&(e.offsetWidth>0||e.offsetHeight>0||e.getClientRects().length>0))(e))}function tl(e,t){if(!e)return[];const i=Array.from(e.querySelectorAll(Js)),n=i.filter(il);return t&&il(e)&&n.unshift(e),n.forEach((e,t)=>{if(Zs(e)&&e.contentDocument){const i=tl(e.contentDocument.body);n.splice(t,1,...i)}}),!n.length&&t?i:n}function il(e){return null!=e&&e.tabIndex>0||el(e)&&!(e=>parseInt(e.getAttribute("tabindex")||"0",10)<0)(e)}function nl(e){const{root:t,getInitialEl:i,filter:n,enabled:r=!0}=e;if(!r)return;let a=null;if(a||("function"===typeof i?i():i),a||(null===t||void 0===t?void 0:t.querySelector("[data-autofocus],[autofocus]")),!a){const e=tl(t);n?e.filter(n)[0]:e[0]}return a||t||void 0}function rl(e){const t=new Set;function i(e){const i=globalThis.requestAnimationFrame(e);t.add(()=>globalThis.cancelAnimationFrame(i))}return i(()=>i(e)),function(){t.forEach(e=>e())}}function al(e){let t;const i=globalThis.requestAnimationFrame(()=>{t=e()});return()=>{var e;globalThis.cancelAnimationFrame(i),null===(e=t)||void 0===e||e()}}function ol(e,t){const{defer:i}=t,n=i?al:e=>e(),r=[];return r.push(n(()=>{const i="function"===typeof e?e():e;r.push(function(e,t){if(!e)return;const{attributes:i,callback:n}=t,r=new(e.ownerDocument.defaultView||window).MutationObserver(e=>{for(const t of e)"attributes"===t.type&&t.attributeName&&i.includes(t.attributeName)&&n(t)});return r.observe(e,{attributes:!0,attributeFilter:i}),()=>r.disconnect()}(i,t))})),()=>{r.forEach(e=>null===e||void 0===e?void 0:e())}}function sl(e){const t=()=>{const t=Ss(e);e.dispatchEvent(new t.MouseEvent("click"))};Ps(/Firefox/i)?function(e,t,i){const n=al(()=>{e.removeEventListener(t,r,!0),i()}),r=()=>{n(),i()};e.addEventListener(t,r,{once:!0,capture:!0})}(e,"keyup",t):queueMicrotask(t)}function ll(e){const t=Cs(e);return function(e){return["html","body","#document"].includes(gs(e))}(t)?ws(t).body:fs(t)&&hl(t)?t:ll(t)}function cl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const i=ll(e),n=i===e.ownerDocument.body,r=Ss(i);return n?t.concat(r,r.visualViewport||[],hl(i)?i:[]):t.concat(i,cl(i,[]))}var dl=/auto|scroll|overlay|hidden|clip/,ul=new Set(["inline","contents"]);function hl(e){const t=Ss(e),{overflow:i,overflowX:n,overflowY:r,display:a}=t.getComputedStyle(e);return dl.test(i+r+n)&&!ul.has(a)}function pl(e,t){const i=t||{},{rootEl:n}=i,a=r(i,ss);e&&n&&hl(n)&&function(e){return e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth}(n)&&e.scrollIntoView(a)}function fl(e,t){const{left:i,top:n,width:r,height:a}=t.getBoundingClientRect(),o={x:e.x-i,y:e.y-n},s={x:cs(o.x/r),y:cs(o.y/a)};return{offset:o,percent:s,getPercentValue:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{dir:t="ltr",orientation:i="horizontal",inverted:n}=e,r="object"===typeof n?n.x:n,a="object"===typeof n?n.y:n;return"horizontal"===i?"rtl"===t||r?1-s.x:s.x:a?1-s.y:s.y}}}var ml="default",gl="",vl=new WeakMap;function yl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{target:t,doc:i}=e,n=null!==i&&void 0!==i?i:document,r=n.documentElement;return Os()?("default"===ml&&(r.style.webkitUserSelect,r.style.webkitUserSelect="none"),"disabled"):t&&(vl.set(t,t.style.userSelect),t.style.userSelect="none"),()=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{target:t,doc:i}=e,n=null!==i&&void 0!==i?i:document,r=n.documentElement;if(Os()){if("disabled"!==ml)return;setTimeout(()=>{rl(()=>{"restoring"===ml&&("none"===r.style.webkitUserSelect&&(r.style.webkitUserSelect=gl||""),"default")})},300)}else if(t&&vl.has(t)){const e=vl.get(t);"none"===t.style.userSelect&&(t.style.userSelect=null!==e&&void 0!==e?e:""),""===t.getAttribute("style")&&t.removeAttribute("style"),vl.delete(t)}}({target:t,doc:n})}function bl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{defer:t,target:i}=e,n=r(e,ls),a=t?al:e=>e(),o=[];return o.push(a(()=>{const e="function"===typeof i?i():i;o.push(yl(c(c({},n),{},{target:e})))})),()=>{o.forEach(e=>null===e||void 0===e?void 0:e())}}function xl(e,t){const{onPointerMove:i,onPointerUp:n}=t,r=[js(e,"pointermove",e=>{const t=Vs(e);Math.sqrt(t.x**2+t.y**2)<("touch"===e.pointerType?10:5)||("mouse"!==e.pointerType||0!==e.button?i({point:t,event:e}):n())},!1),js(e,"pointerup",n,!1),js(e,"pointercancel",n,!1),js(e,"contextmenu",n,!1),bl({doc:e})];return()=>{r.forEach(e=>e())}}function wl(e){const{pointerNode:t,keyboardNode:i=t,onPress:n,onPressStart:r,onPressEnd:a,isValidKey:o=e=>"Enter"===e.key}=e;if(!t)return us;const s=Ss(t),l=ws(t);let c=us,d=us,u=us;const h=e=>({point:Vs(e),event:e});function p(e){null===r||void 0===r||r(h(e))}function f(e){null===a||void 0===a||a(h(e))}const m=js(t,"pointerdown",e=>{d();const r=js(s,"pointerup",e=>{const i=Rs(e);xs(t,i)?null===n||void 0===n||n(h(e)):null===a||void 0===a||a(h(e))},{passive:!n,once:!0}),o=js(s,"pointercancel",f,{passive:!a,once:!0});ds(r,o),l.activeElement===i&&"mouse"===e.pointerType&&e.preventDefault(),p(e)},{passive:!r}),g=js(i,"focus",function(){const e=js(i,"keydown",e=>{if(!o(e))return;d(),js(i,"keyup",e=>{if(!o(e))return;const t=new s.PointerEvent("pointerup"),i=h(t);null===n||void 0===n||n(i),null===a||void 0===a||a(i)}),p(new s.PointerEvent("pointerdown"))}),t=js(i,"blur",()=>{f(new s.PointerEvent("pointercancel"))});ds(e,t)});return ds(m,g),()=>{c(),d(),u()}}function Sl(e,t){var i;return Array.from(null!==(i=null===e||void 0===e?void 0:e.querySelectorAll(t))&&void 0!==i?i:[])}function _l(e,t){var i;return null!==(i=null===e||void 0===e?void 0:e.querySelector(t))&&void 0!==i?i:null}var Cl=e=>e.id;function El(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cl;return e.find(e=>i(e)===t)}function Al(e,t){const i=El(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cl);return i?e.indexOf(i):-1}function Ml(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Al(e,t);return n=i?(n+1)%e.length:Math.min(n+1,e.length-1),e[n]}function Tl(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Al(e,t);return-1===n?i?e[e.length-1]:null:(n=i?(n-1+e.length)%e.length:Math.max(0,n-1),e[n])}function Pl(e,t){const{onEntry:i,measure:n,box:r="border-box"}=t,a=(Array.isArray(e)?e:[e]).filter(fs),o=Ss(a[0]),s=e=>{const t=a.map(e=>n(e));i({rects:t,entries:e})};s([]);const l=new o.ResizeObserver(s);return a.forEach(e=>l.observe(e,{box:r})),()=>l.disconnect()}function Dl(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Cl;const r=i?Al(e,i,n):-1;let a=i?((e,t)=>e.map((i,n)=>e[(Math.max(t,0)+n)%e.length]))(e,r):e;return 1===t.length&&(a=a.filter(e=>n(e)!==i)),a.find(e=>{return i=(e=>{var t,i,n;return(null!==(t=null!==(i=null===(n=e.dataset)||void 0===n?void 0:n.valuetext)&&void 0!==i?i:e.textContent)&&void 0!==t?t:"").split("").map(e=>{const t=e.charCodeAt(0);return t>0&&t<128?e:t>=128&&t<=255?"/x".concat(t.toString(16)).replace("/","\\"):""}).join("").trim()})(e),n=t,i.trim().toLowerCase().startsWith(n.toLowerCase());var i,n})}function Ol(e,t){if(!e)return us;const i=Object.keys(t).reduce((t,i)=>(t[i]=e.style.getPropertyValue(i),t),{});return Object.assign(e.style,t),()=>{Object.assign(e.style,i),0===e.style.length&&e.removeAttribute("style")}}function Il(e,t){const{state:i,activeId:n,key:r,timeout:a=350,itemToId:o}=t,s=i.keysSoFar+r,l=s.length>1&&Array.from(s).every(e=>e===s[0])?s[0]:s;const c=Dl(e.slice(),l,n,o);function d(){clearTimeout(i.timer),i.timer=-1}return function e(t){i.keysSoFar=t,d(),""!==t&&(i.timer=+setTimeout(()=>{e(""),d()},a))}(s),c}var kl=Object.assign(Il,{defaultOptions:{keysSoFar:"",timer:-1},isValidEvent:function(e){return 1===e.key.length&&!e.ctrlKey&&!e.metaKey}});function Rl(e,t){const{timeout:i,rootNode:n}=t,r=Ss(n),a=ws(n),o=new r.AbortController;return function(e,t,i){const{signal:n}=t;return[new Promise((t,r)=>{const a=setTimeout(()=>{r(new Error("Timeout of ".concat(i,"ms exceeded")))},i);n.addEventListener("abort",()=>{clearTimeout(a),r(new Error("Promise aborted"))}),e.then(e=>{n.aborted||(clearTimeout(a),t(e))}).catch(e=>{n.aborted||(clearTimeout(a),r(e))})}),()=>t.abort()]}(new Promise(t=>{const i=e();if(i)return void t(i);const n=new r.MutationObserver(()=>{const i=e();i&&i.isConnected&&(n.disconnect(),t(i))});n.observe(a.body,{childList:!0,subtree:!0})}),o,i)}const zl=["top","right","bottom","left"],Ll=Math.min,Bl=Math.max,Nl=Math.round,Fl=Math.floor,Ul=e=>({x:e,y:e}),Vl={left:"right",right:"left",bottom:"top",top:"bottom"},jl={start:"end",end:"start"};function Wl(e,t,i){return Bl(e,Ll(t,i))}function Hl(e,t){return"function"===typeof e?e(t):e}function Gl(e){return e.split("-")[0]}function ql(e){return e.split("-")[1]}function Xl(e){return"x"===e?"y":"x"}function Yl(e){return"y"===e?"height":"width"}const Ql=new Set(["top","bottom"]);function Kl(e){return Ql.has(Gl(e))?"y":"x"}function Zl(e){return Xl(Kl(e))}function Jl(e){return e.replace(/start|end/g,e=>jl[e])}const $l=["left","right"],ec=["right","left"],tc=["top","bottom"],ic=["bottom","top"];function nc(e,t,i,n){const r=ql(e);let a=function(e,t,i){switch(e){case"top":case"bottom":return i?t?ec:$l:t?$l:ec;case"left":case"right":return t?tc:ic;default:return[]}}(Gl(e),"start"===i,n);return r&&(a=a.map(e=>e+"-"+r),t&&(a=a.concat(a.map(Jl)))),a}function rc(e){return e.replace(/left|right|bottom|top/g,e=>Vl[e])}function ac(e){return"number"!==typeof e?function(e){return c({top:0,right:0,bottom:0,left:0},e)}(e):{top:e,right:e,bottom:e,left:e}}function oc(e){const{x:t,y:i,width:n,height:r}=e;return{width:n,height:r,top:i,left:t,right:t+n,bottom:i+r,x:t,y:i}}const sc=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"],lc=["strategy"],cc=["mainAxis","crossAxis","limiter"],dc=["apply"];function uc(e,t,i){let{reference:n,floating:r}=e;const a=Kl(t),o=Zl(t),s=Yl(o),l=Gl(t),c="y"===a,d=n.x+n.width/2-r.width/2,u=n.y+n.height/2-r.height/2,h=n[s]/2-r[s]/2;let p;switch(l){case"top":p={x:d,y:n.y-r.height};break;case"bottom":p={x:d,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:u};break;case"left":p={x:n.x-r.width,y:u};break;default:p={x:n.x,y:n.y}}switch(ql(t)){case"start":p[o]-=h*(i&&c?-1:1);break;case"end":p[o]+=h*(i&&c?-1:1)}return p}async function hc(e,t){var i;void 0===t&&(t={});const{x:n,y:r,platform:a,rects:o,elements:s,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:h=!1,padding:p=0}=Hl(t,e),f=ac(p),m=s[h?"floating"===u?"reference":"floating":u],g=oc(await a.getClippingRect({element:null==(i=await(null==a.isElement?void 0:a.isElement(m)))||i?m:m.contextElement||await(null==a.getDocumentElement?void 0:a.getDocumentElement(s.floating)),boundary:c,rootBoundary:d,strategy:l})),v="floating"===u?{x:n,y:r,width:o.floating.width,height:o.floating.height}:o.reference,y=await(null==a.getOffsetParent?void 0:a.getOffsetParent(s.floating)),b=await(null==a.isElement?void 0:a.isElement(y))&&await(null==a.getScale?void 0:a.getScale(y))||{x:1,y:1},x=oc(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:v,offsetParent:y,strategy:l}):v);return{top:(g.top-x.top+f.top)/b.y,bottom:(x.bottom-g.bottom+f.bottom)/b.y,left:(g.left-x.left+f.left)/b.x,right:(x.right-g.right+f.right)/b.x}}function pc(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function fc(e){return zl.some(t=>e[t]>=0)}const mc=new Set(["left","top"]);function gc(){return"undefined"!==typeof window}function vc(e){return xc(e)?(e.nodeName||"").toLowerCase():"#document"}function yc(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function bc(e){var t;return null==(t=(xc(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function xc(e){return!!gc()&&(e instanceof Node||e instanceof yc(e).Node)}function wc(e){return!!gc()&&(e instanceof Element||e instanceof yc(e).Element)}function Sc(e){return!!gc()&&(e instanceof HTMLElement||e instanceof yc(e).HTMLElement)}function _c(e){return!(!gc()||"undefined"===typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof yc(e).ShadowRoot)}const Cc=new Set(["inline","contents"]);function Ec(e){const{overflow:t,overflowX:i,overflowY:n,display:r}=Bc(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+i)&&!Cc.has(r)}const Ac=new Set(["table","td","th"]);function Mc(e){return Ac.has(vc(e))}const Tc=[":popover-open",":modal"];function Pc(e){return Tc.some(t=>{try{return e.matches(t)}catch(i){return!1}})}const Dc=["transform","translate","scale","rotate","perspective"],Oc=["transform","translate","scale","rotate","perspective","filter"],Ic=["paint","layout","strict","content"];function kc(e){const t=Rc(),i=wc(e)?Bc(e):e;return Dc.some(e=>!!i[e]&&"none"!==i[e])||!!i.containerType&&"normal"!==i.containerType||!t&&!!i.backdropFilter&&"none"!==i.backdropFilter||!t&&!!i.filter&&"none"!==i.filter||Oc.some(e=>(i.willChange||"").includes(e))||Ic.some(e=>(i.contain||"").includes(e))}function Rc(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const zc=new Set(["html","body","#document"]);function Lc(e){return zc.has(vc(e))}function Bc(e){return yc(e).getComputedStyle(e)}function Nc(e){return wc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Fc(e){if("html"===vc(e))return e;const t=e.assignedSlot||e.parentNode||_c(e)&&e.host||bc(e);return _c(t)?t.host:t}function Uc(e){const t=Fc(e);return Lc(t)?e.ownerDocument?e.ownerDocument.body:e.body:Sc(t)&&Ec(t)?t:Uc(t)}function Vc(e,t,i){var n;void 0===t&&(t=[]),void 0===i&&(i=!0);const r=Uc(e),a=r===(null==(n=e.ownerDocument)?void 0:n.body),o=yc(r);if(a){const e=jc(o);return t.concat(o,o.visualViewport||[],Ec(r)?r:[],e&&i?Vc(e):[])}return t.concat(r,Vc(r,[],i))}function jc(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Wc(e){const t=Bc(e);let i=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const r=Sc(e),a=r?e.offsetWidth:i,o=r?e.offsetHeight:n,s=Nl(i)!==a||Nl(n)!==o;return s&&(i=a,n=o),{width:i,height:n,$:s}}function Hc(e){return wc(e)?e:e.contextElement}function Gc(e){const t=Hc(e);if(!Sc(t))return Ul(1);const i=t.getBoundingClientRect(),{width:n,height:r,$:a}=Wc(t);let o=(a?Nl(i.width):i.width)/n,s=(a?Nl(i.height):i.height)/r;return o&&Number.isFinite(o)||(o=1),s&&Number.isFinite(s)||(s=1),{x:o,y:s}}const qc=Ul(0);function Xc(e){const t=yc(e);return Rc()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:qc}function Yc(e,t,i,n){void 0===t&&(t=!1),void 0===i&&(i=!1);const r=e.getBoundingClientRect(),a=Hc(e);let o=Ul(1);t&&(n?wc(n)&&(o=Gc(n)):o=Gc(e));const s=function(e,t,i){return void 0===t&&(t=!1),!(!i||t&&i!==yc(e))&&t}(a,i,n)?Xc(a):Ul(0);let l=(r.left+s.x)/o.x,c=(r.top+s.y)/o.y,d=r.width/o.x,u=r.height/o.y;if(a){const e=yc(a),t=n&&wc(n)?yc(n):n;let i=e,r=jc(i);for(;r&&n&&t!==i;){const e=Gc(r),t=r.getBoundingClientRect(),n=Bc(r),a=t.left+(r.clientLeft+parseFloat(n.paddingLeft))*e.x,o=t.top+(r.clientTop+parseFloat(n.paddingTop))*e.y;l*=e.x,c*=e.y,d*=e.x,u*=e.y,l+=a,c+=o,i=yc(r),r=jc(i)}}return oc({width:d,height:u,x:l,y:c})}function Qc(e,t){const i=Nc(e).scrollLeft;return t?t.left+i:Yc(bc(e)).left+i}function Kc(e,t,i){void 0===i&&(i=!1);const n=e.getBoundingClientRect();return{x:n.left+t.scrollLeft-(i?0:Qc(e,n)),y:n.top+t.scrollTop}}const Zc=new Set(["absolute","fixed"]);function Jc(e,t,i){let n;if("viewport"===t)n=function(e,t){const i=yc(e),n=bc(e),r=i.visualViewport;let a=n.clientWidth,o=n.clientHeight,s=0,l=0;if(r){a=r.width,o=r.height;const e=Rc();(!e||e&&"fixed"===t)&&(s=r.offsetLeft,l=r.offsetTop)}return{width:a,height:o,x:s,y:l}}(e,i);else if("document"===t)n=function(e){const t=bc(e),i=Nc(e),n=e.ownerDocument.body,r=Bl(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),a=Bl(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-i.scrollLeft+Qc(e);const s=-i.scrollTop;return"rtl"===Bc(n).direction&&(o+=Bl(t.clientWidth,n.clientWidth)-r),{width:r,height:a,x:o,y:s}}(bc(e));else if(wc(t))n=function(e,t){const i=Yc(e,!0,"fixed"===t),n=i.top+e.clientTop,r=i.left+e.clientLeft,a=Sc(e)?Gc(e):Ul(1);return{width:e.clientWidth*a.x,height:e.clientHeight*a.y,x:r*a.x,y:n*a.y}}(t,i);else{const i=Xc(e);n={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return oc(n)}function $c(e,t){const i=Fc(e);return!(i===t||!wc(i)||Lc(i))&&("fixed"===Bc(i).position||$c(i,t))}function ed(e,t,i){const n=Sc(t),r=bc(t),a="fixed"===i,o=Yc(e,!0,a,t);let s={scrollLeft:0,scrollTop:0};const l=Ul(0);function c(){l.x=Qc(r)}if(n||!n&&!a)if(("body"!==vc(t)||Ec(r))&&(s=Nc(t)),n){const e=Yc(t,!0,a,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else r&&c();a&&!n&&r&&c();const d=!r||n||a?Ul(0):Kc(r,s);return{x:o.left+s.scrollLeft-l.x-d.x,y:o.top+s.scrollTop-l.y-d.y,width:o.width,height:o.height}}function td(e){return"static"===Bc(e).position}function id(e,t){if(!Sc(e)||"fixed"===Bc(e).position)return null;if(t)return t(e);let i=e.offsetParent;return bc(e)===i&&(i=i.ownerDocument.body),i}function nd(e,t){const i=yc(e);if(Pc(e))return i;if(!Sc(e)){let t=Fc(e);for(;t&&!Lc(t);){if(wc(t)&&!td(t))return t;t=Fc(t)}return i}let n=id(e,t);for(;n&&Mc(n)&&td(n);)n=id(n,t);return n&&Lc(n)&&td(n)&&!kc(n)?i:n||function(e){let t=Fc(e);for(;Sc(t)&&!Lc(t);){if(kc(t))return t;if(Pc(t))return null;t=Fc(t)}return null}(e)||i}const rd={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:i,offsetParent:n,strategy:r}=e;const a="fixed"===r,o=bc(n),s=!!t&&Pc(t.floating);if(n===o||s&&a)return i;let l={scrollLeft:0,scrollTop:0},c=Ul(1);const d=Ul(0),u=Sc(n);if((u||!u&&!a)&&(("body"!==vc(n)||Ec(o))&&(l=Nc(n)),Sc(n))){const e=Yc(n);c=Gc(n),d.x=e.x+n.clientLeft,d.y=e.y+n.clientTop}const h=!o||u||a?Ul(0):Kc(o,l,!0);return{width:i.width*c.x,height:i.height*c.y,x:i.x*c.x-l.scrollLeft*c.x+d.x+h.x,y:i.y*c.y-l.scrollTop*c.y+d.y+h.y}},getDocumentElement:bc,getClippingRect:function(e){let{element:t,boundary:i,rootBoundary:n,strategy:r}=e;const a="clippingAncestors"===i?Pc(t)?[]:function(e,t){const i=t.get(e);if(i)return i;let n=Vc(e,[],!1).filter(e=>wc(e)&&"body"!==vc(e)),r=null;const a="fixed"===Bc(e).position;let o=a?Fc(e):e;for(;wc(o)&&!Lc(o);){const t=Bc(o),i=kc(o);i||"fixed"!==t.position||(r=null),(a?!i&&!r:!i&&"static"===t.position&&r&&Zc.has(r.position)||Ec(o)&&!i&&$c(e,o))?n=n.filter(e=>e!==o):r=t,o=Fc(o)}return t.set(e,n),n}(t,this._c):[].concat(i),o=[...a,n],s=o[0],l=o.reduce((e,i)=>{const n=Jc(t,i,r);return e.top=Bl(n.top,e.top),e.right=Ll(n.right,e.right),e.bottom=Ll(n.bottom,e.bottom),e.left=Bl(n.left,e.left),e},Jc(t,s,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:nd,getElementRects:async function(e){const t=this.getOffsetParent||nd,i=this.getDimensions,n=await i(e.floating);return{reference:ed(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:i}=Wc(e);return{width:t,height:i}},getScale:Gc,isElement:wc,isRTL:function(e){return"rtl"===Bc(e).direction}};function ad(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function od(e,t,i,n){void 0===n&&(n={});const{ancestorScroll:r=!0,ancestorResize:a=!0,elementResize:o="function"===typeof ResizeObserver,layoutShift:s="function"===typeof IntersectionObserver,animationFrame:l=!1}=n,d=Hc(e),u=r||a?[...d?Vc(d):[],...Vc(t)]:[];u.forEach(e=>{r&&e.addEventListener("scroll",i,{passive:!0}),a&&e.addEventListener("resize",i)});const h=d&&s?function(e,t){let i,n=null;const r=bc(e);function a(){var e;clearTimeout(i),null==(e=n)||e.disconnect(),n=null}return function o(s,l){void 0===s&&(s=!1),void 0===l&&(l=1),a();const d=e.getBoundingClientRect(),{left:u,top:h,width:p,height:f}=d;if(s||t(),!p||!f)return;const m={rootMargin:-Fl(h)+"px "+-Fl(r.clientWidth-(u+p))+"px "+-Fl(r.clientHeight-(h+f))+"px "+-Fl(u)+"px",threshold:Bl(0,Ll(1,l))||1};let g=!0;function v(t){const n=t[0].intersectionRatio;if(n!==l){if(!g)return o();n?o(!1,n):i=setTimeout(()=>{o(!1,1e-7)},1e3)}1!==n||ad(d,e.getBoundingClientRect())||o(),g=!1}try{n=new IntersectionObserver(v,c(c({},m),{},{root:r.ownerDocument}))}catch(y){n=new IntersectionObserver(v,m)}n.observe(e)}(!0),a}(d,i):null;let p,f=-1,m=null;o&&(m=new ResizeObserver(e=>{let[n]=e;n&&n.target===d&&m&&(m.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var e;null==(e=m)||e.observe(t)})),i()}),d&&!l&&m.observe(d),m.observe(t));let g=l?Yc(e):null;return l&&function t(){const n=Yc(e);g&&!ad(g,n)&&i();g=n,p=requestAnimationFrame(t)}(),i(),()=>{var e;u.forEach(e=>{r&&e.removeEventListener("scroll",i),a&&e.removeEventListener("resize",i)}),null==h||h(),null==(e=m)||e.disconnect(),m=null,l&&cancelAnimationFrame(p)}}const sd=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var i,n;const{x:r,y:a,placement:o,middlewareData:s}=t,l=await async function(e,t){const{placement:i,platform:n,elements:r}=e,a=await(null==n.isRTL?void 0:n.isRTL(r.floating)),o=Gl(i),s=ql(i),l="y"===Kl(i),c=mc.has(o)?-1:1,d=a&&l?-1:1,u=Hl(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:f}="number"===typeof u?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return s&&"number"===typeof f&&(p="end"===s?-1*f:f),l?{x:p*d,y:h*c}:{x:h*c,y:p*d}}(t,e);return o===(null==(i=s.offset)?void 0:i.placement)&&null!=(n=s.arrow)&&n.alignmentOffset?{}:{x:r+l.x,y:a+l.y,data:c(c({},l),{},{placement:o})}}}},ld=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:i,y:n,placement:a}=t,o=Hl(e,t),{mainAxis:s=!0,crossAxis:l=!1,limiter:d={fn:e=>{let{x:t,y:i}=e;return{x:t,y:i}}}}=o,u=r(o,cc),h={x:i,y:n},p=await hc(t,u),f=Kl(Gl(a)),m=Xl(f);let g=h[m],v=h[f];if(s){const e="y"===m?"bottom":"right";g=Wl(g+p["y"===m?"top":"left"],g,g-p[e])}if(l){const e="y"===f?"bottom":"right";v=Wl(v+p["y"===f?"top":"left"],v,v-p[e])}const y=d.fn(c(c({},t),{},{[m]:g,[f]:v}));return c(c({},y),{},{data:{x:y.x-i,y:y.y-n,enabled:{[m]:s,[f]:l}}})}}},cd=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var i,n;const{placement:a,middlewareData:o,rects:s,initialPlacement:l,platform:c,elements:d}=t,u=Hl(e,t),{mainAxis:h=!0,crossAxis:p=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:v=!0}=u,y=r(u,sc);if(null!=(i=o.arrow)&&i.alignmentOffset)return{};const b=Gl(a),x=Kl(l),w=Gl(l)===l,S=await(null==c.isRTL?void 0:c.isRTL(d.floating)),_=f||(w||!v?[rc(l)]:function(e){const t=rc(e);return[Jl(e),t,Jl(t)]}(l)),C="none"!==g;!f&&C&&_.push(...nc(l,v,g,S));const E=[l,..._],A=await hc(t,y),M=[];let T=(null==(n=o.flip)?void 0:n.overflows)||[];if(h&&M.push(A[b]),p){const e=function(e,t,i){void 0===i&&(i=!1);const n=ql(e),r=Zl(e),a=Yl(r);let o="x"===r?n===(i?"end":"start")?"right":"left":"start"===n?"bottom":"top";return t.reference[a]>t.floating[a]&&(o=rc(o)),[o,rc(o)]}(a,s,S);M.push(A[e[0]],A[e[1]])}if(T=[...T,{placement:a,overflows:M}],!M.every(e=>e<=0)){var P,D;const e=((null==(P=o.flip)?void 0:P.index)||0)+1,t=E[e];if(t){if(!("alignment"===p&&x!==Kl(t))||T.every(e=>Kl(e.placement)!==x||e.overflows[0]>0))return{data:{index:e,overflows:T},reset:{placement:t}}}let i=null==(D=T.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:D.placement;if(!i)switch(m){case"bestFit":{var O;const e=null==(O=T.filter(e=>{if(C){const t=Kl(e.placement);return t===x||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:O[0];e&&(i=e);break}case"initialPlacement":i=l}if(a!==i)return{reset:{placement:i}}}return{}}}},dd=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){var i,n;const{placement:a,rects:o,platform:s,elements:l}=t,d=Hl(e,t),{apply:u=()=>{}}=d,h=r(d,dc),p=await hc(t,h),f=Gl(a),m=ql(a),g="y"===Kl(a),{width:v,height:y}=o.floating;let b,x;"top"===f||"bottom"===f?(b=f,x=m===(await(null==s.isRTL?void 0:s.isRTL(l.floating))?"start":"end")?"left":"right"):(x=f,b="end"===m?"top":"bottom");const w=y-p.top-p.bottom,S=v-p.left-p.right,_=Ll(y-p[b],w),C=Ll(v-p[x],S),E=!t.middlewareData.shift;let A=_,M=C;if(null!=(i=t.middlewareData.shift)&&i.enabled.x&&(M=S),null!=(n=t.middlewareData.shift)&&n.enabled.y&&(A=w),E&&!m){const e=Bl(p.left,0),t=Bl(p.right,0),i=Bl(p.top,0),n=Bl(p.bottom,0);g?M=v-2*(0!==e||0!==t?e+t:Bl(p.left,p.right)):A=y-2*(0!==i||0!==n?i+n:Bl(p.top,p.bottom))}await u(c(c({},t),{},{availableWidth:M,availableHeight:A}));const T=await s.getDimensions(l.floating);return v!==T.width||y!==T.height?{reset:{rects:!0}}:{}}}},ud=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:i}=t,n=Hl(e,t),{strategy:a="referenceHidden"}=n,o=r(n,lc);switch(a){case"referenceHidden":{const e=pc(await hc(t,c(c({},o),{},{elementContext:"reference"})),i.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:fc(e)}}}case"escaped":{const e=pc(await hc(t,c(c({},o),{},{altBoundary:!0})),i.floating);return{data:{escapedOffsets:e,escaped:fc(e)}}}default:return{}}}}},hd=e=>({name:"arrow",options:e,async fn(t){const{x:i,y:n,placement:r,rects:a,platform:o,elements:s,middlewareData:l}=t,{element:d,padding:u=0}=Hl(e,t)||{};if(null==d)return{};const h=ac(u),p={x:i,y:n},f=Zl(r),m=Yl(f),g=await o.getDimensions(d),v="y"===f,y=v?"top":"left",b=v?"bottom":"right",x=v?"clientHeight":"clientWidth",w=a.reference[m]+a.reference[f]-p[f]-a.floating[m],S=p[f]-a.reference[f],_=await(null==o.getOffsetParent?void 0:o.getOffsetParent(d));let C=_?_[x]:0;C&&await(null==o.isElement?void 0:o.isElement(_))||(C=s.floating[x]||a.floating[m]);const E=w/2-S/2,A=C/2-g[m]/2-1,M=Ll(h[y],A),T=Ll(h[b],A),P=M,D=C-g[m]-T,O=C/2-g[m]/2+E,I=Wl(P,O,D),k=!l.arrow&&null!=ql(r)&&O!==I&&a.reference[m]/2-(O<P?M:T)-g[m]/2<0,R=k?O<P?O-P:O-D:0;return{[f]:p[f]+R,data:c({[f]:I,centerOffset:O-I-R},k&&{alignmentOffset:R}),reset:k}}}),pd=function(e){return void 0===e&&(e={}),{options:e,fn(t){const{x:i,y:n,placement:r,rects:a,middlewareData:o}=t,{offset:s=0,mainAxis:l=!0,crossAxis:d=!0}=Hl(e,t),u={x:i,y:n},h=Kl(r),p=Xl(h);let f=u[p],m=u[h];const g=Hl(s,t),v="number"===typeof g?{mainAxis:g,crossAxis:0}:c({mainAxis:0,crossAxis:0},g);if(l){const e="y"===p?"height":"width",t=a.reference[p]-a.floating[e]+v.mainAxis,i=a.reference[p]+a.reference[e]-v.mainAxis;f<t?f=t:f>i&&(f=i)}if(d){var y,b;const e="y"===p?"width":"height",t=mc.has(Gl(r)),i=a.reference[h]-a.floating[e]+(t&&(null==(y=o.offset)?void 0:y[h])||0)+(t?0:v.crossAxis),n=a.reference[h]+a.reference[e]+(t?0:(null==(b=o.offset)?void 0:b[h])||0)-(t?v.crossAxis:0);m<i?m=i:m>n&&(m=n)}return{[p]:f,[h]:m}}}},fd=(e,t,i)=>{const n=new Map,r=c({platform:rd},i),a=c(c({},r.platform),{},{_c:n});return(async(e,t,i)=>{const{placement:n="bottom",strategy:r="absolute",middleware:a=[],platform:o}=i,s=a.filter(Boolean),l=await(null==o.isRTL?void 0:o.isRTL(t));let d=await o.getElementRects({reference:e,floating:t,strategy:r}),{x:u,y:h}=uc(d,n,l),p=n,f={},m=0;for(let g=0;g<s.length;g++){const{name:i,fn:a}=s[g],{x:v,y:y,data:b,reset:x}=await a({x:u,y:h,initialPlacement:n,placement:p,strategy:r,middlewareData:f,rects:d,platform:o,elements:{reference:e,floating:t}});u=null!=v?v:u,h=null!=y?y:h,f=c(c({},f),{},{[i]:c(c({},f[i]),b)}),x&&m<=50&&(m++,"object"===typeof x&&(x.placement&&(p=x.placement),x.rects&&(d=!0===x.rects?await o.getElementRects({reference:e,floating:t,strategy:r}):x.rects),({x:u,y:h}=uc(d,p,l))),g=-1)}return{x:u,y:h,placement:p,strategy:r,middlewareData:f}})(e,t,c(c({},r),{},{platform:a}))},md=["defer"];function gd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if("function"===typeof DOMRect)return new DOMRect(e,t,i,n);const r={x:e,y:t,width:i,height:n,top:t,right:e+i,bottom:t+n,left:e};return c(c({},r),{},{toJSON:()=>r})}function vd(e,t){return{contextElement:fs(e)?e:void 0,getBoundingClientRect:()=>{const i=e,n=null===t||void 0===t?void 0:t(i);return n||!i?function(e){if(!e)return gd();const{x:t,y:i,width:n,height:r}=e;return gd(t,i,n,r)}(n):i.getBoundingClientRect()}}}var yd=e=>({variable:e,reference:"var(".concat(e,")")}),bd={arrowSize:yd("--arrow-size"),arrowSizeHalf:yd("--arrow-size-half"),arrowBg:yd("--arrow-background"),transformOrigin:yd("--transform-origin"),arrowOffset:yd("--arrow-offset")},xd={name:"transformOrigin",fn(e){let{placement:t,elements:i,middlewareData:n}=e;const{arrow:r}=n,a=(e=>({top:"bottom center","top-start":e?"".concat(e.x,"px bottom"):"left bottom","top-end":e?"".concat(e.x,"px bottom"):"right bottom",bottom:"top center","bottom-start":e?"".concat(e.x,"px top"):"top left","bottom-end":e?"".concat(e.x,"px top"):"top right",left:"right center","left-start":e?"right ".concat(e.y,"px"):"right top","left-end":e?"right ".concat(e.y,"px"):"right bottom",right:"left center","right-start":e?"left ".concat(e.y,"px"):"left top","right-end":e?"left ".concat(e.y,"px"):"left bottom"}))(r)[t],{floating:o}=i;return o.style.setProperty(bd.transformOrigin.variable,a),{data:{transformOrigin:a}}}},wd={name:"rects",fn(e){let{rects:t}=e;return{data:t}}},Sd=e=>{if(e)return{name:"shiftArrow",fn(t){let{placement:i,middlewareData:n}=t;if(!n.arrow)return{};const{x:r,y:a}=n.arrow,o=i.split("-")[0];return Object.assign(e.style,{left:null!=r?"".concat(r,"px"):"",top:null!=a?"".concat(a,"px"):"",[o]:"calc(100% + ".concat(bd.arrowOffset.reference,")")}),{}}}};var _d={strategy:"absolute",placement:"bottom",listeners:!0,gutter:8,flip:!0,slide:!0,overlap:!1,sameWidth:!1,fitViewport:!1,overflowPadding:8,arrowPadding:4};function Cd(e,t){const i=e.devicePixelRatio||1;return Math.round(t*i)/i}function Ed(e){return function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];const r="function"===typeof e?e(...i):e;return null!==r&&void 0!==r?r:void 0}(e.boundary)}function Ad(e,t){if(e)return hd({element:e,padding:t.arrowPadding})}function Md(e,t){var i;if(null!=(null!==(i=t.offset)&&void 0!==i?i:t.gutter))return sd(i=>{var n,r,a,o;let{placement:s}=i;const l=((null===e||void 0===e?void 0:e.clientHeight)||0)/2,c=null!==(n=null===(r=t.offset)||void 0===r?void 0:r.mainAxis)&&void 0!==n?n:t.gutter,d="number"===typeof c?c+l:null!==c&&void 0!==c?c:l,{hasAlign:u}=function(e){const[t,i]=e.split("-");return{side:t,align:i,hasAlign:null!=i}}(s),h=u?void 0:t.shift;return ko({crossAxis:null!==(a=null===(o=t.offset)||void 0===o?void 0:o.crossAxis)&&void 0!==a?a:h,mainAxis:d,alignmentAxis:t.shift})})}function Td(e){if(e.flip)return cd({boundary:Ed(e),padding:e.overflowPadding,fallbackPlacements:!0===e.flip?void 0:e.flip})}function Pd(e){if(e.slide||e.overlap)return ld({boundary:Ed(e),mainAxis:e.slide,crossAxis:e.overlap,padding:e.overflowPadding,limiter:pd()})}function Dd(e){return dd({padding:e.overflowPadding,apply(e){let{elements:t,rects:i,availableHeight:n,availableWidth:r}=e;const a=t.floating,o=Math.round(i.reference.width);r=Math.floor(r),n=Math.floor(n),a.style.setProperty("--reference-width","".concat(o,"px")),a.style.setProperty("--available-width","".concat(r,"px")),a.style.setProperty("--available-height","".concat(n,"px"))}})}function Od(e){var t,i;if(e.hideWhenDetached)return ud({strategy:"referenceHidden",boundary:null!==(t=null===(i=e.boundary)||void 0===i?void 0:i.call(e))&&void 0!==t?t:"clippingAncestors"})}function Id(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{defer:n}=i,a=r(i,md),o=n?al:e=>e(),s=[];return s.push(o(()=>{const i="function"===typeof e?e():e,n="function"===typeof t?t():t;s.push(function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=vd(e,i.getAnchorRect);if(!t||!n)return;const r=Object.assign({},_d,i),a=t.querySelector("[data-part=arrow]"),o=[Md(a,r),Td(r),Pd(r),Ad(a,r),Sd(a),xd,Dd(r),Od(r),wd],{placement:s,strategy:l,onComplete:c,onPositioned:d}=r,u=async()=>{if(!n||!t)return;const e=await fd(n,t,{placement:s,middleware:o,strategy:l});null===c||void 0===c||c(e),null===d||void 0===d||d({placed:!0});const i=Ss(t),a=Cd(i,e.x),u=Cd(i,e.y);var h;(t.style.setProperty("--x","".concat(a,"px")),t.style.setProperty("--y","".concat(u,"px")),r.hideWhenDetached)&&((null===(h=e.middlewareData.hide)||void 0===h?void 0:h.referenceHidden)?(t.style.setProperty("visibility","hidden"),t.style.setProperty("pointer-events","none")):(t.style.removeProperty("visibility"),t.style.removeProperty("pointer-events")));const p=t.firstElementChild;if(p){const e=As(p);t.style.setProperty("--z-index",e.zIndex)}},h=async()=>{i.updatePosition?(await i.updatePosition({updatePosition:u,floatingElement:t}),null===d||void 0===d||d({placed:!0})):await u()},p=function(e){return e?!0===e?{ancestorResize:!0,ancestorScroll:!0,elementResize:!0,layoutShift:!0}:e:{}}(r.listeners),f=r.listeners?od(n,t,h,p):so;return h(),()=>{null===f||void 0===f||f(),null===d||void 0===d||d({placed:!1})}}(i,n,a))})),()=>{s.forEach(e=>null===e||void 0===e?void 0:e())}}var kd=new WeakMap,Rd=new WeakMap,zd={},Ld=0,Bd=e=>e&&(e.host||Bd(e.parentNode)),Nd=new Set(["script","output","status","next-route-announcer"]),Fd=(e,t)=>{const{parentNode:i,markerName:n,controlAttribute:r}=t,a=((e,t)=>t.map(t=>{if(e.contains(t))return t;const i=Bd(t);return i&&e.contains(i)?i:(console.error("[zag-js > ariaHidden] target",t,"in not contained inside",e,". Doing nothing"),null)}).filter(e=>Boolean(e)))(i,Array.isArray(e)?e:[e]);zd[n]||(zd[n]=new WeakMap);const o=zd[n],s=[],l=new Set,c=new Set(a),d=e=>{e&&!l.has(e)&&(l.add(e),d(e.parentNode))};a.forEach(d);const u=e=>{e&&!c.has(e)&&Array.prototype.forEach.call(e.children,e=>{if(l.has(e))u(e);else try{if((e=>!!Nd.has(e.localName)||"status"===e.role||!!e.hasAttribute("aria-live")||e.matches("[data-live-announcer]"))(e))return;const t="true"===e.getAttribute(r),i=(kd.get(e)||0)+1,a=(o.get(e)||0)+1;kd.set(e,i),o.set(e,a),s.push(e),1===i&&t&&Rd.set(e,!0),1===a&&e.setAttribute(n,""),t||e.setAttribute(r,"true")}catch(VU){console.error("[zag-js > ariaHidden] cannot operate on ",e,VU)}})};return u(i),l.clear(),Ld++,()=>{s.forEach(e=>{const t=kd.get(e)-1,i=o.get(e)-1;kd.set(e,t),o.set(e,i),t||(Rd.has(e)||e.removeAttribute(r),Rd.delete(e)),i||e.removeAttribute(n)}),--Ld||(kd=new WeakMap,kd=new WeakMap,Rd=new WeakMap,zd={})}},Ud=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e=>(Array.isArray(e)?e[0]:e).ownerDocument.body)(e);if(t)return Fd(e,{parentNode:t,markerName:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data-aria-hidden",controlAttribute:"aria-hidden"})},Vd=e=>{const t=requestAnimationFrame(()=>e());return()=>cancelAnimationFrame(t)};function jd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{defer:i=!0}=t,n=i?Vd:e=>e(),r=[];return r.push(n(()=>{const t=("function"===typeof e?e():e).filter(Boolean);0!==t.length&&r.push(Ud(t))})),()=>{r.forEach(e=>null===e||void 0===e?void 0:e())}}var Wd=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.map(e=>{var t;return null===e||void 0===e||null===(t=e.trim)||void 0===t?void 0:t.call(e)}).filter(Boolean).join(" ")},Hd=/((?:--)?(?:\w+-?)+)\s*:\s*([^;]*)/g,Gd=e=>{const t={};let i;for(;i=Hd.exec(e);)t[i[1]]=i[2];return t},qd=(e,t)=>{if($a(e)){if($a(t))return"".concat(e,";").concat(t);e=Gd(e)}else $a(t)&&(t=Gd(t));return Object.assign({},null!==e&&void 0!==e?e:{},null!==t&&void 0!==t?t:{})};function Xd(){let e={};for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];for(let r of i){for(let t in e)t.startsWith("on")&&"function"===typeof e[t]&&"function"===typeof r[t]?e[t]=lo(r[t],e[t]):e[t]="className"!==t&&"class"!==t?"style"!==t?void 0!==r[t]?r[t]:e[t]:qd(e[t],r[t]):Wd(e[t],r[t]);for(let t in r)void 0===e[t]&&(e[t]=r[t])}return e}function Yd(e,t,i){let n,r=[];return a=>{var o;const s=e(a);return s.length!==r.length||s.some((e,t)=>!Ya(r[t],e))?(r=s,n=t(...s),null===i||void 0===i||null===(o=i.onChange)||void 0===o||o.call(i,n),n):n}}function Qd(){return{and:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){return t.every(t=>e.guard(t))}},or:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){return t.some(t=>e.guard(t))}},not:e=>function(t){return!t.guard(e)}}}function Kd(){return{guards:Qd(),createMachine:e=>e,choose:e=>function(t){var i;let{choose:n}=t;return null===(i=n(e))||void 0===i?void 0:i.actions}}}var Zd=(e=>(e.NotStarted="Not Started",e.Started="Started",e.Stopped="Stopped",e))(Zd||{}),Jd="__init__";var $d="pointerdown.outside",eu="focus.outside";function tu(e){for(const t of e)if(fs(t)&&el(t))return!0;return!1}var iu=e=>"clientY"in e;function nu(e,t){if(!t||!iu(e))return!1;const i=t.scrollHeight>t.clientHeight,n=i&&e.clientX>t.offsetLeft+t.clientWidth,r=t.scrollWidth>t.clientWidth,a=r&&e.clientY>t.offsetTop+t.clientHeight;return!!function(e,t){return e.y<=t.y&&t.y<=e.y+e.height&&e.x<=t.x&&t.x<=e.x+e.width}({x:t.offsetLeft,y:t.offsetTop,width:t.clientWidth+(i?16:0),height:t.clientHeight+(r?16:0)},{x:e.clientX,y:e.clientY})&&(n||a)}function ru(e,t){const{exclude:i,onFocusOutside:n,onPointerDownOutside:r,onInteractOutside:a,defer:o}=t;if(!e)return;const s=ws(e),l=Ss(e),c=function(e){const t={each(t){for(let n=0;n<(null===(i=e.frames)||void 0===i?void 0:i.length);n+=1){var i;const r=e.frames[n];r&&t(r)}},addEventListener:(e,i,n)=>(t.each(t=>{try{t.document.addEventListener(e,i,n)}catch(r){}}),()=>{try{t.removeEventListener(e,i,n)}catch(r){}}),removeEventListener(e,i,n){t.each(t=>{try{t.document.removeEventListener(e,i,n)}catch(r){}})}};return t}(l),d=function(e){const t=null!=e.frameElement?e.parent:null;return{addEventListener:(e,i,n)=>{try{null===t||void 0===t||t.addEventListener(e,i,n)}catch(r){}return()=>{try{null===t||void 0===t||t.removeEventListener(e,i,n)}catch(r){}}},removeEventListener:(e,i,n)=>{try{null===t||void 0===t||t.removeEventListener(e,i,n)}catch(r){}}}}(l);function u(t,n){if(!fs(n))return!1;if(!n.isConnected)return!1;if(xs(e,n))return!1;if(function(e,t){if(!iu(t)||!e)return!1;const i=e.getBoundingClientRect();return 0!==i.width&&0!==i.height&&i.top<=t.clientY&&t.clientY<=i.top+i.height&&i.left<=t.clientX&&t.clientX<=i.left+i.width}(e,t))return!1;const r=s.querySelector('[aria-controls="'.concat(e.id,'"]'));if(r){if(nu(t,ll(r)))return!1}return!nu(t,ll(e))&&!(null!==i&&void 0!==i&&i(n))}const h=new Set,p=vs(null===e||void 0===e?void 0:e.getRootNode());function f(t){function i(i){var n,s;const l=o&&!Ds()?al:e=>e(),c=null!==i&&void 0!==i?i:t,d=null!==(n=null===c||void 0===c||null===(s=c.composedPath)||void 0===s?void 0:s.call(c))&&void 0!==n?n:[null===c||void 0===c?void 0:c.target];l(()=>{const i=p?d[0]:Rs(t);if(e&&u(t,i)){if(r||a){const t=lo(r,a);e.addEventListener($d,t,{once:!0})}var n;ou(e,$d,{bubbles:!1,cancelable:!0,detail:{originalEvent:c,contextmenu:(n=c,2===n.button||Is()&&n.ctrlKey&&0===n.button),focusable:tu(d),target:i}})}})}"touch"===t.pointerType?(h.forEach(e=>e()),h.add(js(s,"click",i,{once:!0})),h.add(d.addEventListener("click",i,{once:!0})),h.add(c.addEventListener("click",i,{once:!0}))):i()}const m=new Set,g=setTimeout(()=>{m.add(js(s,"pointerdown",f,!0)),m.add(d.addEventListener("pointerdown",f,!0)),m.add(c.addEventListener("pointerdown",f,!0))},0);function v(t){(o?al:e=>e())(()=>{const i=Rs(t);if(e&&u(t,i)){if(n||a){const t=lo(n,a);e.addEventListener(eu,t,{once:!0})}ou(e,eu,{bubbles:!1,cancelable:!0,detail:{originalEvent:t,contextmenu:!1,focusable:el(i),target:i}})}})}return Ds()||(m.add(js(s,"focusin",v,!0)),m.add(d.addEventListener("focusin",v,!0)),m.add(c.addEventListener("focusin",v,!0))),()=>{clearTimeout(g),h.forEach(e=>e()),m.forEach(e=>e())}}function au(e,t){const{defer:i}=t,n=i?al:e=>e(),r=[];return r.push(n(()=>{const i="function"===typeof e?e():e;r.push(ru(i,t))})),()=>{r.forEach(e=>null===e||void 0===e?void 0:e())}}function ou(e,t,i){const n=new(e.ownerDocument.defaultView||window).CustomEvent(t,i);return e.dispatchEvent(n)}function su(e,t){return js(ws(e),"keydown",e=>{"Escape"===e.key&&(e.isComposing||null===t||void 0===t||t(e))},{capture:!0})}var lu,cu={layers:[],branches:[],count(){return this.layers.length},pointerBlockingLayers(){return this.layers.filter(e=>e.pointerBlocking)},topMostPointerBlockingLayer(){return[...this.pointerBlockingLayers()].slice(-1)[0]},hasPointerBlockingLayer(){return this.pointerBlockingLayers().length>0},isBelowPointerBlockingLayer(e){var t;return this.indexOf(e)<(this.topMostPointerBlockingLayer()?this.indexOf(null===(t=this.topMostPointerBlockingLayer())||void 0===t?void 0:t.node):-1)},isTopMost(e){const t=this.layers[this.count()-1];return(null===t||void 0===t?void 0:t.node)===e},getNestedLayers(e){return Array.from(this.layers).slice(this.indexOf(e)+1)},isInNestedLayer(e,t){return this.getNestedLayers(e).some(e=>xs(e.node,t))},isInBranch(e){return Array.from(this.branches).some(t=>xs(t,e))},add(e){const t=this.layers.push(e);e.node.style.setProperty("--layer-index","".concat(t))},addBranch(e){this.branches.push(e)},remove(e){const t=this.indexOf(e);if(!(t<0)){if(t<this.count()-1){this.getNestedLayers(e).forEach(e=>e.dismiss())}this.layers.splice(t,1),e.style.removeProperty("--layer-index")}},removeBranch(e){const t=this.branches.indexOf(e);t>=0&&this.branches.splice(t,1)},indexOf(e){return this.layers.findIndex(t=>t.node===e)},dismiss(e){var t;null===(t=this.layers[this.indexOf(e)])||void 0===t||t.dismiss()},clear(){this.remove(this.layers[0].node)}};function du(){cu.layers.forEach(e=>{let{node:t}=e;t.style.pointerEvents=cu.isBelowPointerBlockingLayer(t)?"none":"auto"})}function uu(e,t){const i=ws(e),n=[];return cu.hasPointerBlockingLayer()&&!i.body.hasAttribute("data-inert")&&(lu=document.body.style.pointerEvents,queueMicrotask(()=>{i.body.style.pointerEvents="none",i.body.setAttribute("data-inert","")})),null===t||void 0===t||t.forEach(e=>{const[t,i]=Rl(()=>{const t=e();return fs(t)?t:null},{timeout:1e3});t.then(e=>n.push(Ol(e,{pointerEvents:"auto"}))),n.push(i)}),()=>{cu.hasPointerBlockingLayer()||(queueMicrotask(()=>{i.body.style.pointerEvents=lu,i.body.removeAttribute("data-inert"),0===i.body.style.length&&i.body.removeAttribute("style")}),n.forEach(e=>e()))}}function hu(e,t){const{defer:i}=t,n=i?al:e=>e(),r=[];return r.push(n(()=>{const i=eo(e)?e():e;r.push(function(e,t){const{warnOnMissingNode:i=!0}=t;if(i&&!e)return;if(!e)return;const{onDismiss:n,pointerBlocking:r,exclude:a,debug:o}=t,s={dismiss:n,node:e,pointerBlocking:r};cu.add(s),du();const l=[r?uu(e,t.persistentElements):void 0,su(e,function(i){var r;cu.isTopMost(e)&&(null===(r=t.onEscapeKeyDown)||void 0===r||r.call(t,i),!i.defaultPrevented&&n&&(i.preventDefault(),n()))}),au(e,{exclude:function(i){var n;if(!e)return!1;const r="function"===typeof a?a():a,o=Array.isArray(r)?r:[r],s=null===(n=t.persistentElements)||void 0===n?void 0:n.map(e=>e()).filter(fs);return s&&o.push(...s),o.some(e=>xs(e,i))||cu.isInNestedLayer(e,i)},onFocusOutside:function(e){var i,r;const a=Rs(e.detail.originalEvent);cu.isInBranch(a)||(null===(i=t.onFocusOutside)||void 0===i||i.call(t,e),null===(r=t.onInteractOutside)||void 0===r||r.call(t,e),e.defaultPrevented||(o&&console.log("onFocusOutside:",e.detail.originalEvent),null===n||void 0===n||n()))},onPointerDownOutside:function(i){var r,a;const s=Rs(i.detail.originalEvent);cu.isBelowPointerBlockingLayer(e)||cu.isInBranch(s)||(null===(r=t.onPointerDownOutside)||void 0===r||r.call(t,i),null===(a=t.onInteractOutside)||void 0===a||a.call(t,i),i.defaultPrevented||(o&&console.log("onPointerDownOutside:",i.detail.originalEvent),null===n||void 0===n||n()))},defer:t.defer})];return()=>{cu.remove(e),du(),function(e){e.style.pointerEvents=""}(e),l.forEach(e=>null===e||void 0===e?void 0:e())}}(i,t))})),()=>{r.forEach(e=>null===e||void 0===e?void 0:e())}}var pu=()=>e=>Array.from(new Set(e)),fu=ka("combobox").parts("root","clearTrigger","content","control","input","item","itemGroup","itemGroupLabel","itemIndicator","itemText","label","list","positioner","trigger"),mu=(fu.build(),e=>new Uo(e));mu.empty=()=>new Uo({items:[]});var gu=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.control)&&void 0!==t?t:"combobox:".concat(e.id,":control")},vu=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.input)&&void 0!==t?t:"combobox:".concat(e.id,":input")},yu=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.content)&&void 0!==t?t:"combobox:".concat(e.id,":content")},bu=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.positioner)&&void 0!==t?t:"combobox:".concat(e.id,":popper")},xu=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.trigger)&&void 0!==t?t:"combobox:".concat(e.id,":toggle-btn")},wu=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.clearTrigger)&&void 0!==t?t:"combobox:".concat(e.id,":clear-btn")},Su=e=>e.getById(yu(e)),_u=e=>e.getById(vu(e)),Cu=e=>e.getById(bu(e)),Eu=e=>e.getById(gu(e)),Au=e=>e.getById(xu(e)),Mu=e=>e.getById(wu(e)),Tu=(e,t)=>{if(null==t)return;const i='[role=option][data-value="'.concat(CSS.escape(t),'"]');return _l(Su(e),i)},Pu=e=>{const t=_u(e);e.isActiveElement(t)||null===t||void 0===t||t.focus({preventScroll:!0})};var{guards:Du,createMachine:Ou,choose:Iu}=Kd(),{and:ku,not:Ru}=Du;Ou({props(e){let{props:t}=e;return c(c({loopFocus:!0,openOnClick:!1,defaultValue:[],closeOnSelect:!t.multiple,allowCustomValue:!1,inputBehavior:"none",selectionBehavior:t.multiple?"clear":"replace",openOnKeyPress:!0,openOnChange:!0,composite:!0,navigate(e){let{node:t}=e;sl(t)},collection:mu.empty()},t),{},{positioning:c({placement:"bottom",sameWidth:!0},t.positioning),translations:c({triggerLabel:"Toggle suggestions",clearTriggerLabel:"Clear value"},t.translations)})},initialState(e){let{prop:t}=e;return t("open")||t("defaultOpen")?"suggesting":"idle"},context(e){let{prop:t,bindable:i,getContext:n,getEvent:r}=e;return{currentPlacement:i(()=>({defaultValue:void 0})),value:i(()=>({defaultValue:t("defaultValue"),value:t("value"),isEqual:Ya,hash:e=>e.join(","),onChange(e){var i;const r=n(),a=r.get("selectedItems"),o=t("collection"),s=e.map(e=>a.find(t=>o.getItemValue(t)===e)||o.find(e));r.set("selectedItems",s),null===(i=t("onValueChange"))||void 0===i||i({value:e,items:s})}})),highlightedValue:i(()=>({defaultValue:t("defaultHighlightedValue")||null,value:t("highlightedValue"),onChange(e){var i;const n=t("collection").find(e);null===(i=t("onHighlightChange"))||void 0===i||i({highlightedValue:e,highlightedItem:n})}})),inputValue:i(()=>{let e=t("inputValue")||t("defaultInputValue")||"";const i=t("defaultValue")||t("value")||[];if(!e.trim()&&!t("multiple")){const n=t("collection").stringifyMany(i);e=co(t("selectionBehavior"),{preserve:e||n,replace:n,clear:""})}return{defaultValue:e,value:t("inputValue"),onChange(e){var i;const n=r(),a=(n.previousEvent||n).src;null===(i=t("onInputValueChange"))||void 0===i||i({inputValue:e,reason:a})}}}),highlightedItem:i(()=>{const e=t("highlightedValue");return{defaultValue:t("collection").find(e)}}),selectedItems:i(()=>{const e=t("value")||t("defaultValue")||[];return{defaultValue:t("collection").findMany(e)}})}},computed:{isInputValueEmpty:e=>{let{context:t}=e;return 0===t.get("inputValue").length},isInteractive:e=>{let{prop:t}=e;return!(t("readOnly")||t("disabled"))},autoComplete:e=>{let{prop:t}=e;return"autocomplete"===t("inputBehavior")},autoHighlight:e=>{let{prop:t}=e;return"autohighlight"===t("inputBehavior")},hasSelectedItems:e=>{let{context:t}=e;return t.get("value").length>0},valueAsString:e=>{let{context:t,prop:i}=e;return i("collection").stringifyItems(t.get("selectedItems"))},isCustomValue:e=>{let{context:t,computed:i}=e;return t.get("inputValue")!==i("valueAsString")}},watch(e){let{context:t,prop:i,track:n,action:r,send:a}=e;n([()=>t.hash("value")],()=>{r(["syncSelectedItems"])}),n([()=>t.get("inputValue")],()=>{r(["syncInputValue"])}),n([()=>t.get("highlightedValue")],()=>{r(["syncHighlightedItem","autofillInputValue"])}),n([()=>i("open")],()=>{r(["toggleVisibility"])}),n([()=>i("collection").toString()],()=>{a({type:"CHILDREN_CHANGE"})})},on:{"SELECTED_ITEMS.SYNC":{actions:["syncSelectedItems"]},"HIGHLIGHTED_VALUE.SET":{actions:["setHighlightedValue"]},"HIGHLIGHTED_VALUE.CLEAR":{actions:["clearHighlightedValue"]},"ITEM.SELECT":{actions:["selectItem"]},"ITEM.CLEAR":{actions:["clearItem"]},"VALUE.SET":{actions:["setValue"]},"INPUT_VALUE.SET":{actions:["setInputValue"]},"POSITIONING.SET":{actions:["reposition"]}},entry:Iu([{guard:"autoFocus",actions:["setInitialFocus"]}]),states:{idle:{tags:["idle","closed"],entry:["scrollContentToTop","clearHighlightedValue"],on:{"CONTROLLED.OPEN":{target:"interacting"},"TRIGGER.CLICK":[{guard:"isOpenControlled",actions:["setInitialFocus","highlightFirstSelectedItem","invokeOnOpen"]},{target:"interacting",actions:["setInitialFocus","highlightFirstSelectedItem","invokeOnOpen"]}],"INPUT.CLICK":[{guard:"isOpenControlled",actions:["highlightFirstSelectedItem","invokeOnOpen"]},{target:"interacting",actions:["highlightFirstSelectedItem","invokeOnOpen"]}],"INPUT.FOCUS":{target:"focused"},OPEN:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"interacting",actions:["invokeOnOpen"]}],"VALUE.CLEAR":{target:"focused",actions:["clearInputValue","clearSelectedItems","setInitialFocus"]}}},focused:{tags:["focused","closed"],entry:["scrollContentToTop","clearHighlightedValue"],on:{"CONTROLLED.OPEN":[{guard:"isChangeEvent",target:"suggesting"},{target:"interacting"}],"INPUT.CHANGE":[{guard:ku("isOpenControlled","openOnChange"),actions:["setInputValue","invokeOnOpen","highlightFirstItemIfNeeded"]},{guard:"openOnChange",target:"suggesting",actions:["setInputValue","invokeOnOpen","highlightFirstItemIfNeeded"]},{actions:["setInputValue"]}],"LAYER.INTERACT_OUTSIDE":{target:"idle"},"INPUT.ESCAPE":{guard:ku("isCustomValue",Ru("allowCustomValue")),actions:["revertInputValue"]},"INPUT.BLUR":{target:"idle"},"INPUT.CLICK":[{guard:"isOpenControlled",actions:["highlightFirstSelectedItem","invokeOnOpen"]},{target:"interacting",actions:["highlightFirstSelectedItem","invokeOnOpen"]}],"TRIGGER.CLICK":[{guard:"isOpenControlled",actions:["setInitialFocus","highlightFirstSelectedItem","invokeOnOpen"]},{target:"interacting",actions:["setInitialFocus","highlightFirstSelectedItem","invokeOnOpen"]}],"INPUT.ARROW_DOWN":[{guard:ku("isOpenControlled","autoComplete"),actions:["invokeOnOpen"]},{guard:"autoComplete",target:"interacting",actions:["invokeOnOpen"]},{guard:"isOpenControlled",actions:["highlightFirstOrSelectedItem","invokeOnOpen"]},{target:"interacting",actions:["highlightFirstOrSelectedItem","invokeOnOpen"]}],"INPUT.ARROW_UP":[{guard:"autoComplete",target:"interacting",actions:["invokeOnOpen"]},{guard:"autoComplete",target:"interacting",actions:["invokeOnOpen"]},{target:"interacting",actions:["highlightLastOrSelectedItem","invokeOnOpen"]},{target:"interacting",actions:["highlightLastOrSelectedItem","invokeOnOpen"]}],OPEN:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"interacting",actions:["invokeOnOpen"]}],"VALUE.CLEAR":{actions:["clearInputValue","clearSelectedItems"]}}},interacting:{tags:["open","focused"],entry:["setInitialFocus"],effects:["scrollToHighlightedItem","trackDismissableLayer","trackPlacement","hideOtherElements"],on:{"CONTROLLED.CLOSE":[{guard:"restoreFocus",target:"focused",actions:["setFinalFocus"]},{target:"idle"}],CHILDREN_CHANGE:[{guard:"isHighlightedItemRemoved",actions:["clearHighlightedValue"]},{actions:["scrollToHighlightedItem"]}],"INPUT.HOME":{actions:["highlightFirstItem"]},"INPUT.END":{actions:["highlightLastItem"]},"INPUT.ARROW_DOWN":[{guard:ku("autoComplete","isLastItemHighlighted"),actions:["clearHighlightedValue","scrollContentToTop"]},{actions:["highlightNextItem"]}],"INPUT.ARROW_UP":[{guard:ku("autoComplete","isFirstItemHighlighted"),actions:["clearHighlightedValue"]},{actions:["highlightPrevItem"]}],"INPUT.ENTER":[{guard:ku("isOpenControlled","isCustomValue",Ru("hasHighlightedItem"),Ru("allowCustomValue")),actions:["revertInputValue","invokeOnClose"]},{guard:ku("isCustomValue",Ru("hasHighlightedItem"),Ru("allowCustomValue")),target:"focused",actions:["revertInputValue","invokeOnClose"]},{guard:ku("isOpenControlled","closeOnSelect"),actions:["selectHighlightedItem","invokeOnClose"]},{guard:"closeOnSelect",target:"focused",actions:["selectHighlightedItem","invokeOnClose","setFinalFocus"]},{actions:["selectHighlightedItem"]}],"INPUT.CHANGE":[{guard:"autoComplete",target:"suggesting",actions:["setInputValue"]},{target:"suggesting",actions:["clearHighlightedValue","setInputValue"]}],"ITEM.POINTER_MOVE":{actions:["setHighlightedValue"]},"ITEM.POINTER_LEAVE":{actions:["clearHighlightedValue"]},"ITEM.CLICK":[{guard:ku("isOpenControlled","closeOnSelect"),actions:["selectItem","invokeOnClose"]},{guard:"closeOnSelect",target:"focused",actions:["selectItem","invokeOnClose","setFinalFocus"]},{actions:["selectItem"]}],"LAYER.ESCAPE":[{guard:ku("isOpenControlled","autoComplete"),actions:["syncInputValue","invokeOnClose"]},{guard:"autoComplete",target:"focused",actions:["syncInputValue","invokeOnClose"]},{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"focused",actions:["invokeOnClose","setFinalFocus"]}],"TRIGGER.CLICK":[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"focused",actions:["invokeOnClose"]}],"LAYER.INTERACT_OUTSIDE":[{guard:ku("isOpenControlled","isCustomValue",Ru("allowCustomValue")),actions:["revertInputValue","invokeOnClose"]},{guard:ku("isCustomValue",Ru("allowCustomValue")),target:"idle",actions:["revertInputValue","invokeOnClose"]},{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"idle",actions:["invokeOnClose"]}],CLOSE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"focused",actions:["invokeOnClose","setFinalFocus"]}],"VALUE.CLEAR":[{guard:"isOpenControlled",actions:["clearInputValue","clearSelectedItems","invokeOnClose"]},{target:"focused",actions:["clearInputValue","clearSelectedItems","invokeOnClose","setFinalFocus"]}]}},suggesting:{tags:["open","focused"],effects:["trackDismissableLayer","scrollToHighlightedItem","trackPlacement","hideOtherElements"],entry:["setInitialFocus"],on:{"CONTROLLED.CLOSE":[{guard:"restoreFocus",target:"focused",actions:["setFinalFocus"]},{target:"idle"}],CHILDREN_CHANGE:[{guard:"autoHighlight",actions:["highlightFirstItem"]},{guard:"isHighlightedItemRemoved",actions:["clearHighlightedValue"]}],"INPUT.ARROW_DOWN":{target:"interacting",actions:["highlightNextItem"]},"INPUT.ARROW_UP":{target:"interacting",actions:["highlightPrevItem"]},"INPUT.HOME":{target:"interacting",actions:["highlightFirstItem"]},"INPUT.END":{target:"interacting",actions:["highlightLastItem"]},"INPUT.ENTER":[{guard:ku("isOpenControlled","isCustomValue",Ru("hasHighlightedItem"),Ru("allowCustomValue")),actions:["revertInputValue","invokeOnClose"]},{guard:ku("isCustomValue",Ru("hasHighlightedItem"),Ru("allowCustomValue")),target:"focused",actions:["revertInputValue","invokeOnClose"]},{guard:ku("isOpenControlled","closeOnSelect"),actions:["selectHighlightedItem","invokeOnClose"]},{guard:"closeOnSelect",target:"focused",actions:["selectHighlightedItem","invokeOnClose","setFinalFocus"]},{actions:["selectHighlightedItem"]}],"INPUT.CHANGE":{actions:["setInputValue"]},"LAYER.ESCAPE":[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"focused",actions:["invokeOnClose"]}],"ITEM.POINTER_MOVE":{target:"interacting",actions:["setHighlightedValue"]},"ITEM.POINTER_LEAVE":{actions:["clearHighlightedValue"]},"LAYER.INTERACT_OUTSIDE":[{guard:ku("isOpenControlled","isCustomValue",Ru("allowCustomValue")),actions:["revertInputValue","invokeOnClose"]},{guard:ku("isCustomValue",Ru("allowCustomValue")),target:"idle",actions:["revertInputValue","invokeOnClose"]},{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"idle",actions:["invokeOnClose"]}],"TRIGGER.CLICK":[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"focused",actions:["invokeOnClose"]}],"ITEM.CLICK":[{guard:ku("isOpenControlled","closeOnSelect"),actions:["selectItem","invokeOnClose"]},{guard:"closeOnSelect",target:"focused",actions:["selectItem","invokeOnClose","setFinalFocus"]},{actions:["selectItem"]}],CLOSE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"focused",actions:["invokeOnClose","setFinalFocus"]}],"VALUE.CLEAR":[{guard:"isOpenControlled",actions:["clearInputValue","clearSelectedItems","invokeOnClose"]},{target:"focused",actions:["clearInputValue","clearSelectedItems","invokeOnClose","setFinalFocus"]}]}}},implementations:{guards:{isInputValueEmpty:e=>{let{computed:t}=e;return t("isInputValueEmpty")},autoComplete:e=>{let{computed:t,prop:i}=e;return t("autoComplete")&&!i("multiple")},autoHighlight:e=>{let{computed:t}=e;return t("autoHighlight")},isFirstItemHighlighted:e=>{let{prop:t,context:i}=e;return t("collection").firstValue===i.get("highlightedValue")},isLastItemHighlighted:e=>{let{prop:t,context:i}=e;return t("collection").lastValue===i.get("highlightedValue")},isCustomValue:e=>{let{computed:t}=e;return t("isCustomValue")},allowCustomValue:e=>{let{prop:t}=e;return!!t("allowCustomValue")},hasHighlightedItem:e=>{let{context:t}=e;return null!=t.get("highlightedValue")},closeOnSelect:e=>{let{prop:t}=e;return!!t("closeOnSelect")},isOpenControlled:e=>{let{prop:t}=e;return null!=t("open")},openOnChange:e=>{let{prop:t,context:i}=e;const n=t("openOnChange");return!0===(r=n)||!1===r?n:!(null===n||void 0===n||!n({inputValue:i.get("inputValue")}));var r},restoreFocus:e=>{let{event:t}=e;return null==t.restoreFocus||!!t.restoreFocus},isChangeEvent:e=>{var t;let{event:i}=e;return"INPUT.CHANGE"===(null===(t=i.previousEvent)||void 0===t?void 0:t.type)},autoFocus:e=>{let{prop:t}=e;return!!t("autoFocus")},isHighlightedItemRemoved:e=>{let{prop:t,context:i}=e;return!t("collection").has(i.get("highlightedValue"))}},effects:{trackDismissableLayer(e){let{send:t,prop:i,scope:n}=e;if(i("disableLayer"))return;return hu(()=>Su(n),{defer:!0,exclude:()=>[_u(n),Au(n),Mu(n)],onFocusOutside:i("onFocusOutside"),onPointerDownOutside:i("onPointerDownOutside"),onInteractOutside:i("onInteractOutside"),onEscapeKeyDown(e){e.preventDefault(),e.stopPropagation(),t({type:"LAYER.ESCAPE",src:"escape-key"})},onDismiss(){t({type:"LAYER.INTERACT_OUTSIDE",src:"interact-outside",restoreFocus:!1})}})},hideOtherElements(e){let{scope:t}=e;return jd([_u(t),Su(t),Au(t),Mu(t)])},trackPlacement(e){let{context:t,prop:i,scope:n}=e;return t.set("currentPlacement",i("positioning").placement),Id(()=>Eu(n)||Au(n),()=>Cu(n),c(c({},i("positioning")),{},{defer:!0,onComplete(e){t.set("currentPlacement",e.placement)}}))},scrollToHighlightedItem(e){let{context:t,prop:i,scope:n,event:r}=e;const a=_u(n);let o=[];const s=e=>{const a=r.current().type.includes("POINTER"),s=t.get("highlightedValue");if(a||!s)return;const l=Tu(n,s),c=Su(n),d=i("scrollToIndexFn");if(d){return void d({index:i("collection").indexOf(s),immediate:e})}const u=al(()=>{pl(l,{rootEl:c,block:"nearest"})});o.push(u)},l=al(()=>s(!0));o.push(l);const c=ol(a,{attributes:["aria-activedescendant"],callback:()=>s(!1)});return o.push(c),()=>{o.forEach(e=>e())}}},actions:{reposition(e){let{context:t,prop:i,scope:n,event:r}=e;Id(()=>Eu(n),()=>Cu(n),c(c(c({},i("positioning")),r.options),{},{defer:!0,listeners:!1,onComplete(e){t.set("currentPlacement",e.placement)}}))},setHighlightedValue(e){let{context:t,event:i}=e;null!=i.value&&t.set("highlightedValue",i.value)},clearHighlightedValue(e){let{context:t}=e;t.set("highlightedValue",null)},selectHighlightedItem(e){var t;const{context:i,prop:n}=e,r=n("collection"),a=i.get("highlightedValue");if(!a||!r.has(a))return;const o=n("multiple")?Wa(i.get("value"),a):[a];null===(t=n("onSelect"))||void 0===t||t({value:o,itemValue:a}),i.set("value",o);const s=co(n("selectionBehavior"),{preserve:i.get("inputValue"),replace:r.stringifyMany(o),clear:""});i.set("inputValue",s)},scrollToHighlightedItem(e){let{context:t,prop:i,scope:n}=e;rl(()=>{const e=t.get("highlightedValue");if(null==e)return;const r=Tu(n,e),a=Su(n),o=i("scrollToIndexFn");if(o){return void o({index:i("collection").indexOf(e),immediate:!0})}pl(r,{rootEl:a,block:"nearest"})})},selectItem(e){const{context:t,event:i,flush:n,prop:r}=e;null!=i.value&&n(()=>{var e;const n=r("multiple")?Wa(t.get("value"),i.value):[i.value];null===(e=r("onSelect"))||void 0===e||e({value:n,itemValue:i.value}),t.set("value",n);const a=co(r("selectionBehavior"),{preserve:t.get("inputValue"),replace:r("collection").stringifyMany(n),clear:""});t.set("inputValue",a)})},clearItem(e){const{context:t,event:i,flush:n,prop:r}=e;null!=i.value&&n(()=>{const e=Ua(t.get("value"),i.value);t.set("value",e);const n=co(r("selectionBehavior"),{preserve:t.get("inputValue"),replace:r("collection").stringifyMany(e),clear:""});t.set("inputValue",n)})},setInitialFocus(e){let{scope:t}=e;al(()=>{Pu(t)})},setFinalFocus(e){let{scope:t}=e;al(()=>{const e=Au(t);null==(null===e||void 0===e?void 0:e.dataset.focusable)?Pu(t):(e=>{const t=Au(e);e.isActiveElement(t)||null===t||void 0===t||t.focus({preventScroll:!0})})(t)})},syncInputValue(e){let{context:t,scope:i,event:n}=e;const r=_u(i);r&&(r.value=t.get("inputValue"),queueMicrotask(()=>{"INPUT.CHANGE"!==n.current().type&&function(e){var t,i;if(!e)return;const n=null!==(t=e.selectionStart)&&void 0!==t?t:0,r=null!==(i=e.selectionEnd)&&void 0!==i?i:0;0===Math.abs(r-n)&&0===n&&e.setSelectionRange(e.value.length,e.value.length)}(r)}))},setInputValue(e){let{context:t,event:i}=e;t.set("inputValue",i.value)},clearInputValue(e){let{context:t}=e;t.set("inputValue","")},revertInputValue(e){let{context:t,prop:i,computed:n}=e;const r=co(i("selectionBehavior"),{replace:n("hasSelectedItems")?n("valueAsString"):"",preserve:t.get("inputValue"),clear:""});t.set("inputValue",r)},setValue(e){const{context:t,flush:i,event:n,prop:r}=e;i(()=>{t.set("value",n.value);const e=co(r("selectionBehavior"),{preserve:t.get("inputValue"),replace:r("collection").stringifyMany(n.value),clear:""});t.set("inputValue",e)})},clearSelectedItems(e){const{context:t,flush:i,prop:n}=e;i(()=>{t.set("value",[]);const e=co(n("selectionBehavior"),{preserve:t.get("inputValue"),replace:n("collection").stringifyMany([]),clear:""});t.set("inputValue",e)})},scrollContentToTop(e){let{prop:t,scope:i}=e;const n=t("scrollToIndexFn");if(n)n({index:0,immediate:!0});else{const e=Su(i);if(!e)return;e.scrollTop=0}},invokeOnOpen(e){var t;let{prop:i,event:n}=e;const r=zu(n);null===(t=i("onOpenChange"))||void 0===t||t({open:!0,reason:r})},invokeOnClose(e){var t;let{prop:i,event:n}=e;const r=zu(n);null===(t=i("onOpenChange"))||void 0===t||t({open:!1,reason:r})},highlightFirstItem(e){let{context:t,prop:i,scope:n}=e;(Su(n)?queueMicrotask:al)(()=>{const e=i("collection").firstValue;e&&t.set("highlightedValue",e)})},highlightFirstItemIfNeeded(e){let{computed:t,action:i}=e;t("autoHighlight")&&i(["highlightFirstItem"])},highlightLastItem(e){let{context:t,prop:i,scope:n}=e;(Su(n)?queueMicrotask:al)(()=>{const e=i("collection").lastValue;e&&t.set("highlightedValue",e)})},highlightNextItem(e){let{context:t,prop:i}=e,n=null;const r=t.get("highlightedValue"),a=i("collection");r?(n=a.getNextValue(r),!n&&i("loopFocus")&&(n=a.firstValue)):n=a.firstValue,n&&t.set("highlightedValue",n)},highlightPrevItem(e){let{context:t,prop:i}=e,n=null;const r=t.get("highlightedValue"),a=i("collection");r?(n=a.getPreviousValue(r),!n&&i("loopFocus")&&(n=a.lastValue)):n=a.lastValue,n&&t.set("highlightedValue",n)},highlightFirstSelectedItem(e){let{context:t,prop:i}=e;al(()=>{const[e]=i("collection").sort(t.get("value"));e&&t.set("highlightedValue",e)})},highlightFirstOrSelectedItem(e){let{context:t,prop:i,computed:n}=e;al(()=>{let e=null;e=n("hasSelectedItems")?i("collection").sort(t.get("value"))[0]:i("collection").firstValue,e&&t.set("highlightedValue",e)})},highlightLastOrSelectedItem(e){let{context:t,prop:i,computed:n}=e;al(()=>{const e=i("collection");let r=null;r=n("hasSelectedItems")?e.sort(t.get("value"))[0]:e.lastValue,r&&t.set("highlightedValue",r)})},autofillInputValue(e){let{context:t,computed:i,prop:n,event:r,scope:a}=e;const o=_u(a),s=n("collection");if(!i("autoComplete")||!o||!r.keypress)return;const l=s.stringify(t.get("highlightedValue"));al(()=>{o.value=l||t.get("inputValue")})},syncSelectedItems(e){queueMicrotask(()=>{const{context:t,prop:i}=e,n=i("collection"),r=t.get("value"),a=r.map(e=>t.get("selectedItems").find(t=>n.getItemValue(t)===e)||n.find(e));t.set("selectedItems",a);const o=co(i("selectionBehavior"),{preserve:t.get("inputValue"),replace:n.stringifyMany(r),clear:""});t.set("inputValue",o)})},syncHighlightedItem(e){let{context:t,prop:i}=e;const n=i("collection").find(t.get("highlightedValue"));t.set("highlightedItem",n)},toggleVisibility(e){let{event:t,send:i,prop:n}=e;i({type:n("open")?"CONTROLLED.OPEN":"CONTROLLED.CLOSE",previousEvent:t})}}}});function zu(e){return(e.previousEvent||e).src}var Lu=pu()(["allowCustomValue","autoFocus","closeOnSelect","collection","composite","defaultHighlightedValue","defaultInputValue","defaultOpen","defaultValue","dir","disabled","disableLayer","form","getRootNode","highlightedValue","id","ids","inputBehavior","inputValue","invalid","loopFocus","multiple","name","navigate","onFocusOutside","onHighlightChange","onInputValueChange","onInteractOutside","onOpenChange","onOpenChange","onPointerDownOutside","onSelect","onValueChange","open","openOnChange","openOnClick","openOnKeyPress","placeholder","positioning","readOnly","required","scrollToIndexFn","selectionBehavior","translations","value"]),Bu=(Ro(Lu),pu()(["htmlFor"])),Nu=(Ro(Bu),pu()(["id"])),Fu=(Ro(Nu),pu()(["item","persistFocus"])),Uu=(Ro(Fu),ka("accordion").parts("root","item","itemTrigger","itemContent","itemIndicator")),Vu=(Uu.build(),e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.root)&&void 0!==t?t:"accordion:".concat(e.id)}),ju=(e,t)=>{var i,n,r;return null!==(i=null===(n=e.ids)||void 0===n||null===(r=n.itemTrigger)||void 0===r?void 0:r.call(n,t))&&void 0!==i?i:"accordion:".concat(e.id,":trigger:").concat(t)},Wu=e=>{const t=CSS.escape(Vu(e)),i="[aria-controls][data-ownedby='".concat(t,"']:not([disabled])");return Sl((e=>e.getById(Vu(e)))(e),i)};var{and:Hu,not:Gu}=Qd(),qu=(Hu("isExpanded","canToggle"),Gu("isExpanded"),pu()(["collapsible","dir","disabled","getRootNode","id","ids","multiple","onFocusChange","onValueChange","orientation","value","defaultValue"])),Xu=(Ro(qu),pu()(["value","disabled"])),Yu=(Ro(Xu),ka("clipboard").parts("root","control","trigger","indicator","input","label"));Yu.build();var Qu=pu()(["getRootNode","id","ids","value","defaultValue","timeout","onStatusChange","onValueChange"]),Ku=(Ro(Qu),pu()(["copied"])),Zu=(Ro(Ku),Object.defineProperty),Ju=(e,t,i)=>((e,t,i)=>t in e?Zu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i)(e,t+"",i);var $u=class{toHexInt(){return this.toFormat("rgba").toHexInt()}getChannelValue(e){if(e in this)return this[e];throw new Error("Unsupported color channel: "+e)}getChannelValuePercent(e,t){const i=null!==t&&void 0!==t?t:this.getChannelValue(e),{minValue:n,maxValue:r}=this.getChannelRange(e);return Co(i,n,r)}getChannelPercentValue(e,t){const{minValue:i,maxValue:n,step:r}=this.getChannelRange(e),a=Eo(t,i,n,r);return To(a,i,n,r)}withChannelValue(e,t){const{minValue:i,maxValue:n}=this.getChannelRange(e);if(e in this){let r=this.clone();return r[e]=_o(t,i,n),r}throw new Error("Unsupported color channel: "+e)}getColorAxes(e){let{xChannel:t,yChannel:i}=e,n=t||this.getChannels().find(e=>e!==i),r=i||this.getChannels().find(e=>e!==n),a=this.getChannels().find(e=>e!==n&&e!==r);return{xChannel:n,yChannel:r,zChannel:a}}incrementChannel(e,t){const{minValue:i,maxValue:n,step:r}=this.getChannelRange(e),a=To(_o(this.getChannelValue(e)+t,i,n),i,n,r);return this.withChannelValue(e,a)}decrementChannel(e,t){return this.incrementChannel(e,-t)}isEqual(e){const t=((e,t)=>{if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let i in e)if(e[i]!==t[i])return!1;return!0})(this.toJSON(),e.toJSON());return t&&this.getChannelValue("alpha")===e.getChannelValue("alpha")}},eh=/^#[\da-f]+$/i,th=/^rgba?\((.*)\)$/,ih=/[^#]/gi,nh=class e extends $u{constructor(e,t,i,n){super(),this.red=e,this.green=t,this.blue=i,this.alpha=n}static parse(t){var i;let n=[];if(eh.test(t)&&[4,5,7,9].includes(t.length)){const e=(t.length<6?t.replace(ih,"$&$&"):t).slice(1).split("");for(;e.length>0;)n.push(parseInt(e.splice(0,2).join(""),16));n[3]=void 0!==n[3]?n[3]/255:void 0}const r=t.match(th);return null!==r&&void 0!==r&&r[1]&&(n=r[1].split(",").map(e=>Number(e.trim())).map((e,t)=>_o(e,0,t<3?255:1))),n.length<3?void 0:new e(n[0],n[1],n[2],null!==(i=n[3])&&void 0!==i?i:1)}toString(e){switch(e){case"hex":return"#"+(this.red.toString(16).padStart(2,"0")+this.green.toString(16).padStart(2,"0")+this.blue.toString(16).padStart(2,"0")).toUpperCase();case"hexa":return"#"+(this.red.toString(16).padStart(2,"0")+this.green.toString(16).padStart(2,"0")+this.blue.toString(16).padStart(2,"0")+Math.round(255*this.alpha).toString(16).padStart(2,"0")).toUpperCase();case"rgb":return"rgb(".concat(this.red,", ").concat(this.green,", ").concat(this.blue,")");case"css":case"rgba":return"rgba(".concat(this.red,", ").concat(this.green,", ").concat(this.blue,", ").concat(this.alpha,")");case"hsl":return this.toHSL().toString("hsl");case"hsb":return this.toHSB().toString("hsb");default:return this.toFormat(e).toString(e)}}toFormat(e){switch(e){case"rgba":return this;case"hsba":return this.toHSB();case"hsla":return this.toHSL();default:throw new Error("Unsupported color conversion: rgb -> "+e)}}toHexInt(){return this.red<<16|this.green<<8|this.blue}toHSB(){const e=this.red/255,t=this.green/255,i=this.blue/255,n=Math.min(e,t,i),r=Math.max(e,t,i),a=r-n,o=0===r?0:a/r;let s=0;if(0!==a){switch(r){case e:s=(t-i)/a+(t<i?6:0);break;case t:s=(i-e)/a+2;break;case i:s=(e-t)/a+4}s/=6}return new dh(Do(360*s,2),Do(100*o,2),Do(100*r,2),Do(this.alpha,2))}toHSL(){const e=this.red/255,t=this.green/255,i=this.blue/255,n=Math.min(e,t,i),r=Math.max(e,t,i),a=(r+n)/2,o=r-n;let s=-1,l=-1;if(0===o)s=l=0;else{switch(l=o/(a<.5?r+n:2-r-n),r){case e:s=(t-i)/o+(t<i?6:0);break;case t:s=(i-e)/o+2;break;case i:s=(e-t)/o+4}s/=6}return new sh(Do(360*s,2),Do(100*l,2),Do(100*a,2),Do(this.alpha,2))}clone(){return new e(this.red,this.green,this.blue,this.alpha)}getChannelFormatOptions(e){switch(e){case"red":case"green":case"blue":return{style:"decimal"};case"alpha":return{style:"percent"};default:throw new Error("Unknown color channel: "+e)}}formatChannelValue(e,t){let i=this.getChannelFormatOptions(e),n=this.getChannelValue(e);return new Intl.NumberFormat(t,i).format(n)}getChannelRange(e){switch(e){case"red":case"green":case"blue":return{minValue:0,maxValue:255,step:1,pageSize:17};case"alpha":return{minValue:0,maxValue:1,step:.01,pageSize:.1};default:throw new Error("Unknown color channel: "+e)}}toJSON(){return{r:this.red,g:this.green,b:this.blue,a:this.alpha}}getFormat(){return"rgba"}getChannels(){return e.colorChannels}};Ju(nh,"colorChannels",["red","green","blue"]);var rh=nh,ah=/hsl\(([-+]?\d+(?:.\d+)?\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d+(?:.\d+)?%)\)|hsla\(([-+]?\d+(?:.\d+)?\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d(.\d+)?)\)/,oh=class e extends $u{constructor(e,t,i,n){super(),this.hue=e,this.saturation=t,this.lightness=i,this.alpha=n}static parse(t){let i;if(i=t.match(ah)){var n;const[t,r,a,o]=(null!==(n=i[1])&&void 0!==n?n:i[2]).split(",").map(e=>Number(e.trim().replace("%","")));return new e(wo(t,360),_o(r,0,100),_o(a,0,100),_o(null!==o&&void 0!==o?o:1,0,1))}}toString(e){switch(e){case"hex":return this.toRGB().toString("hex");case"hexa":return this.toRGB().toString("hexa");case"hsl":return"hsl(".concat(this.hue,", ").concat(Do(this.saturation,2),"%, ").concat(Do(this.lightness,2),"%)");case"css":case"hsla":return"hsla(".concat(this.hue,", ").concat(Do(this.saturation,2),"%, ").concat(Do(this.lightness,2),"%, ").concat(this.alpha,")");case"hsb":return this.toHSB().toString("hsb");case"rgb":return this.toRGB().toString("rgb");default:return this.toFormat(e).toString(e)}}toFormat(e){switch(e){case"hsla":return this;case"hsba":return this.toHSB();case"rgba":return this.toRGB();default:throw new Error("Unsupported color conversion: hsl -> "+e)}}toHSB(){let e=this.saturation/100,t=this.lightness/100,i=t+e*Math.min(t,1-t);return e=0===i?0:2*(1-t/i),new dh(Do(this.hue,2),Do(100*e,2),Do(100*i,2),Do(this.alpha,2))}toRGB(){let e=this.hue,t=this.saturation/100,i=this.lightness/100,n=t*Math.min(i,1-i),r=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return i-n*Math.max(Math.min(r-3,9-r,1),-1)};return new rh(Math.round(255*r(0)),Math.round(255*r(8)),Math.round(255*r(4)),Do(this.alpha,2))}clone(){return new e(this.hue,this.saturation,this.lightness,this.alpha)}getChannelFormatOptions(e){switch(e){case"hue":return{style:"unit",unit:"degree",unitDisplay:"narrow"};case"saturation":case"lightness":case"alpha":return{style:"percent"};default:throw new Error("Unknown color channel: "+e)}}formatChannelValue(e,t){let i=this.getChannelFormatOptions(e),n=this.getChannelValue(e);return"saturation"!==e&&"lightness"!==e||(n/=100),new Intl.NumberFormat(t,i).format(n)}getChannelRange(e){switch(e){case"hue":return{minValue:0,maxValue:360,step:1,pageSize:15};case"saturation":case"lightness":return{minValue:0,maxValue:100,step:1,pageSize:10};case"alpha":return{minValue:0,maxValue:1,step:.01,pageSize:.1};default:throw new Error("Unknown color channel: "+e)}}toJSON(){return{h:this.hue,s:this.saturation,l:this.lightness,a:this.alpha}}getFormat(){return"hsla"}getChannels(){return e.colorChannels}};Ju(oh,"colorChannels",["hue","saturation","lightness"]);var sh=oh,lh=/hsb\(([-+]?\d+(?:.\d+)?\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d+(?:.\d+)?%)\)|hsba\(([-+]?\d+(?:.\d+)?\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d(.\d+)?)\)/,ch=class e extends $u{constructor(e,t,i,n){super(),this.hue=e,this.saturation=t,this.brightness=i,this.alpha=n}static parse(t){let i;if(i=t.match(lh)){var n;const[t,r,a,o]=(null!==(n=i[1])&&void 0!==n?n:i[2]).split(",").map(e=>Number(e.trim().replace("%","")));return new e(wo(t,360),_o(r,0,100),_o(a,0,100),_o(null!==o&&void 0!==o?o:1,0,1))}}toString(e){switch(e){case"css":return this.toHSL().toString("css");case"hex":return this.toRGB().toString("hex");case"hexa":return this.toRGB().toString("hexa");case"hsb":return"hsb(".concat(this.hue,", ").concat(Do(this.saturation,2),"%, ").concat(Do(this.brightness,2),"%)");case"hsba":return"hsba(".concat(this.hue,", ").concat(Do(this.saturation,2),"%, ").concat(Do(this.brightness,2),"%, ").concat(this.alpha,")");case"hsl":return this.toHSL().toString("hsl");case"rgb":return this.toRGB().toString("rgb");default:return this.toFormat(e).toString(e)}}toFormat(e){switch(e){case"hsba":return this;case"hsla":return this.toHSL();case"rgba":return this.toRGB();default:throw new Error("Unsupported color conversion: hsb -> "+e)}}toHSL(){let e=this.saturation/100,t=this.brightness/100,i=t*(1-e/2);return e=0===i||1===i?0:(t-i)/Math.min(i,1-i),new sh(Do(this.hue,2),Do(100*e,2),Do(100*i,2),Do(this.alpha,2))}toRGB(){let e=this.hue,t=this.saturation/100,i=this.brightness/100,n=function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(n+e/60)%6;return i-t*i*Math.max(Math.min(r,4-r,1),0)};return new rh(Math.round(255*n(5)),Math.round(255*n(3)),Math.round(255*n(1)),Do(this.alpha,2))}clone(){return new e(this.hue,this.saturation,this.brightness,this.alpha)}getChannelFormatOptions(e){switch(e){case"hue":return{style:"unit",unit:"degree",unitDisplay:"narrow"};case"saturation":case"brightness":case"alpha":return{style:"percent"};default:throw new Error("Unknown color channel: "+e)}}formatChannelValue(e,t){let i=this.getChannelFormatOptions(e),n=this.getChannelValue(e);return"saturation"!==e&&"brightness"!==e||(n/=100),new Intl.NumberFormat(t,i).format(n)}getChannelRange(e){switch(e){case"hue":return{minValue:0,maxValue:360,step:1,pageSize:15};case"saturation":case"brightness":return{minValue:0,maxValue:100,step:1,pageSize:10};case"alpha":return{minValue:0,maxValue:1,step:.01,pageSize:.1};default:throw new Error("Unknown color channel: "+e)}}toJSON(){return{h:this.hue,s:this.saturation,b:this.brightness,a:this.alpha}}getFormat(){return"hsba"}getChannels(){return e.colorChannels}};Ju(ch,"colorChannels",["hue","saturation","brightness"]);var dh=ch,uh=(e=>{const t=new Map,i=e.split(",");for(let n=0;n<i.length;n++){const[e,r]=i[n].split(":");t.set(e,"#".concat(r)),e.includes("gray")&&t.set(e.replace("gray","grey"),"#".concat(r))}return t})("aliceblue:f0f8ff,antiquewhite:faebd7,aqua:00ffff,aquamarine:7fffd4,azure:f0ffff,beige:f5f5dc,bisque:ffe4c4,black:000000,blanchedalmond:ffebcd,blue:0000ff,blueviolet:8a2be2,brown:a52a2a,burlywood:deb887,cadetblue:5f9ea0,chartreuse:7fff00,chocolate:d2691e,coral:ff7f50,cornflowerblue:6495ed,cornsilk:fff8dc,crimson:dc143c,cyan:00ffff,darkblue:00008b,darkcyan:008b8b,darkgoldenrod:b8860b,darkgray:a9a9a9,darkgreen:006400,darkkhaki:bdb76b,darkmagenta:8b008b,darkolivegreen:556b2f,darkorange:ff8c00,darkorchid:9932cc,darkred:8b0000,darksalmon:e9967a,darkseagreen:8fbc8f,darkslateblue:483d8b,darkslategray:2f4f4f,darkturquoise:00ced1,darkviolet:9400d3,deeppink:ff1493,deepskyblue:00bfff,dimgray:696969,dodgerblue:1e90ff,firebrick:b22222,floralwhite:fffaf0,forestgreen:228b22,fuchsia:ff00ff,gainsboro:dcdcdc,ghostwhite:f8f8ff,gold:ffd700,goldenrod:daa520,gray:808080,green:008000,greenyellow:adff2f,honeydew:f0fff0,hotpink:ff69b4,indianred:cd5c5c,indigo:4b0082,ivory:fffff0,khaki:f0e68c,lavender:e6e6fa,lavenderblush:fff0f5,lawngreen:7cfc00,lemonchiffon:fffacd,lightblue:add8e6,lightcoral:f08080,lightcyan:e0ffff,lightgoldenrodyellow:fafad2,lightgrey:d3d3d3,lightgreen:90ee90,lightpink:ffb6c1,lightsalmon:ffa07a,lightseagreen:20b2aa,lightskyblue:87cefa,lightslategray:778899,lightsteelblue:b0c4de,lightyellow:ffffe0,lime:00ff00,limegreen:32cd32,linen:faf0e6,magenta:ff00ff,maroon:800000,mediumaquamarine:66cdaa,mediumblue:0000cd,mediumorchid:ba55d3,mediumpurple:9370d8,mediumseagreen:3cb371,mediumslateblue:7b68ee,mediumspringgreen:00fa9a,mediumturquoise:48d1cc,mediumvioletred:c71585,midnightblue:191970,mintcream:f5fffa,mistyrose:ffe4e1,moccasin:ffe4b5,navajowhite:ffdead,navy:000080,oldlace:fdf5e6,olive:808000,olivedrab:6b8e23,orange:ffa500,orangered:ff4500,orchid:da70d6,palegoldenrod:eee8aa,palegreen:98fb98,paleturquoise:afeeee,palevioletred:d87093,papayawhip:ffefd5,peachpuff:ffdab9,peru:cd853f,pink:ffc0cb,plum:dda0dd,powderblue:b0e0e6,purple:800080,rebeccapurple:663399,red:ff0000,rosybrown:bc8f8f,royalblue:4169e1,saddlebrown:8b4513,salmon:fa8072,sandybrown:f4a460,seagreen:2e8b57,seashell:fff5ee,sienna:a0522d,silver:c0c0c0,skyblue:87ceeb,slateblue:6a5acd,slategray:708090,snow:fffafa,springgreen:00ff7f,steelblue:4682b4,tan:d2b48c,teal:008080,thistle:d8bfd8,tomato:ff6347,turquoise:40e0d0,violet:ee82ee,wheat:f5deb3,white:ffffff,whitesmoke:f5f5f5,yellow:ffff00,yellowgreen:9acd32"),hh=e=>{if(uh.has(e))return hh(uh.get(e));const t=rh.parse(e)||dh.parse(e)||sh.parse(e);if(!t){var i;const t=new Error("Invalid color value: "+e);throw null===(i=Error.captureStackTrace)||void 0===i||i.call(Error,t,hh),t}return t},ph=ka("color-picker",["root","label","control","trigger","positioner","content","area","areaThumb","valueText","areaBackground","channelSlider","channelSliderLabel","channelSliderTrack","channelSliderThumb","channelSliderValueText","channelInput","transparencyGrid","swatchGroup","swatchTrigger","swatchIndicator","swatch","eyeDropperTrigger","formatTrigger","formatSelect"]),fh=(ph.build(),e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.hiddenInput)&&void 0!==t?t:"color-picker:".concat(e.id,":hidden-input")}),mh=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.control)&&void 0!==t?t:"color-picker:".concat(e.id,":control")},gh=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.trigger)&&void 0!==t?t:"color-picker:".concat(e.id,":trigger")},vh=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.content)&&void 0!==t?t:"color-picker:".concat(e.id,":content")},yh=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.positioner)&&void 0!==t?t:"color-picker:".concat(e.id,":positioner")},bh=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.area)&&void 0!==t?t:"color-picker:".concat(e.id,":area")},xh=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.areaThumb)&&void 0!==t?t:"color-picker:".concat(e.id,":area-thumb")},wh=(e,t)=>{var i,n,r;return null!==(i=null===(n=e.ids)||void 0===n||null===(r=n.channelSliderTrack)||void 0===r?void 0:r.call(n,t))&&void 0!==i?i:"color-picker:".concat(e.id,":slider-track:").concat(t)},Sh=(e,t)=>{var i,n,r;return null!==(i=null===(n=e.ids)||void 0===n||null===(r=n.channelSliderThumb)||void 0===r?void 0:r.call(n,t))&&void 0!==i?i:"color-picker:".concat(e.id,":slider-thumb:").concat(t)},_h=e=>e.getById(vh(e)),Ch=e=>e.getById(fh(e)),Eh=(e,t)=>{const i=(e=>e.getById(bh(e)))(e);if(!i)return;const{percent:n}=fl(t,i);return n},Ah=e=>e.getById(mh(e)),Mh=e=>e.getById(gh(e)),Th=(e,t,i)=>{const n=((e,t)=>e.getById(wh(e,t)))(e,i);if(!n)return;const{percent:r}=fl(t,n);return r};function Ph(e,t){if(null==t)return"";if("hex"===t)return e.toString("hex");if("css"===t)return e.toString("css");if(t in e)return e.getChannelValue(t).toString();const i="hsla"===e.getFormat();switch(t){case"hue":return i?e.toFormat("hsla").getChannelValue("hue").toString():e.toFormat("hsba").getChannelValue("hue").toString();case"saturation":return i?e.toFormat("hsla").getChannelValue("saturation").toString():e.toFormat("hsba").getChannelValue("saturation").toString();case"lightness":return e.toFormat("hsla").getChannelValue("lightness").toString();case"brightness":return e.toFormat("hsba").getChannelValue("brightness").toString();case"red":case"green":case"blue":return e.toFormat("rgba").getChannelValue(t).toString();default:return e.getChannelValue(t).toString()}}var Dh=["hsba","hsla","rgba"];new RegExp("^(".concat(Dh.join("|"),")$"));var Oh=e=>hh(e),Ih=/^[0-9a-fA-F]{3,8}$/;function kh(e){return e.startsWith("#")?e:function(e){return Ih.test(e)}(e)?"#".concat(e):e}var{and:Rh}=Qd();Rh("isOpenControlled","closeOnSelect");function zh(e,t,i){const n=[...Sl(_h(e),"input[data-channel]"),...Sl(Ah(r),"input[data-channel]")];var r;al(()=>{n.forEach(e=>{const n=e.dataset.channel;Hs(e,Ph(i||t,n))})})}var Lh=pu()(["closeOnSelect","dir","disabled","format","defaultFormat","getRootNode","id","ids","initialFocusEl","inline","name","positioning","onFocusOutside","onFormatChange","onInteractOutside","onOpenChange","onPointerDownOutside","onValueChange","onValueChangeEnd","defaultOpen","open","positioning","required","readOnly","value","defaultValue","invalid","openAutoFocus"]),Bh=(Ro(Lh),pu()(["xChannel","yChannel"])),Nh=(Ro(Bh),pu()(["channel","orientation"])),Fh=(Ro(Nh),pu()(["value","disabled"])),Uh=(Ro(Fh),pu()(["value","respectAlpha"])),Vh=(Ro(Uh),pu()(["size"]));Ro(Vh);const jh=ph.extendWith("view");Object.defineProperty;var Wh=ka("dialog").parts("trigger","backdrop","positioner","content","title","description","closeTrigger");Wh.build();var Hh=pu()(["aria-label","closeOnEscape","closeOnInteractOutside","dir","finalFocusEl","getRootNode","getRootNode","id","id","ids","initialFocusEl","modal","onEscapeKeyDown","onFocusOutside","onInteractOutside","onOpenChange","onPointerDownOutside","defaultOpen","open","persistentElements","preventScroll","restoreFocus","role","trapFocus"]),Gh=(Ro(Hh),ka("editable").parts("root","area","label","preview","input","editTrigger","submitTrigger","cancelTrigger","control"));Gh.build();var qh=pu()(["activationMode","autoResize","dir","disabled","finalFocusEl","form","getRootNode","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","edit","defaultEdit","submitMode","translations","defaultValue","value"]);Ro(qh);const Xh=ka("field").parts("root","errorText","helperText","input","label","select","textarea","requiredIndicator"),Yh=(Xh.build(),ka("fieldset").parts("root","errorText","helperText","legend"));Yh.build();new Map("3g2_video/3gpp2[3gp,3gpp_video/3gpp[3mf_model/3mf[7z_application/x-7z-compressed[aac_audio/aac[ac_application/pkix-attr-cert[adp_audio/adpcm[adts_audio/aac[ai_application/postscript[aml_application/automationml-aml+xml[amlx_application/automationml-amlx+zip[amr_audio/amr[apk_application/vnd.android.package-archive[apng_image/apng[appcache,manifest_text/cache-manifest[appinstaller_application/appinstaller[appx_application/appx[appxbundle_application/appxbundle[asc_application/pgp-keys[atom_application/atom+xml[atomcat_application/atomcat+xml[atomdeleted_application/atomdeleted+xml[atomsvc_application/atomsvc+xml[au,snd_audio/basic[avi_video/x-msvideo[avci_image/avci[avcs_image/avcs[avif_image/avif[aw_application/applixware[bdoc_application/bdoc[bin,bpk,buffer,deb,deploy,dist,distz,dll,dmg,dms,dump,elc,exe,img,iso,lrf,mar,msi,msm,msp,pkg,so_application/octet-stream[bmp,dib_image/bmp[btf,btif_image/prs.btif[bz2_application/x-bzip2[c_text/x-c[ccxml_application/ccxml+xml[cdfx_application/cdfx+xml[cdmia_application/cdmi-capability[cdmic_application/cdmi-container[cdmid_application/cdmi-domain[cdmio_application/cdmi-object[cdmiq_application/cdmi-queue[cer_application/pkix-cert[cgm_image/cgm[cjs_application/node[class_application/java-vm[coffee,litcoffee_text/coffeescript[conf,def,in,ini,list,log,text,txt_text/plain[cpp,cxx,cc_text/x-c++src[cpl_application/cpl+xml[cpt_application/mac-compactpro[crl_application/pkix-crl[css_text/css[csv_text/csv[cu_application/cu-seeme[cwl_application/cwl[cww_application/prs.cww[davmount_application/davmount+xml[dbk_application/docbook+xml[doc_application/msword[docx_application/vnd.openxmlformats-officedocument.wordprocessingml.document[dsc_text/prs.lines.tag[dssc_application/dssc+der[dtd_application/xml-dtd[dwd_application/atsc-dwd+xml[ear,jar,war_application/java-archive[ecma_application/ecmascript[emf_image/emf[eml,mime_message/rfc822[emma_application/emma+xml[emotionml_application/emotionml+xml[eot_application/vnd.ms-fontobject[eps,ps_application/postscript[epub_application/epub+zip[exi_application/exi[exp_application/express[exr_image/aces[ez_application/andrew-inset[fdf_application/fdf[fdt_application/fdt+xml[fits_image/fits[flac_audio/flac[flv_video/x-flv[g3_image/g3fax[geojson_application/geo+json[gif_image/gif[glb_model/gltf-binary[gltf_model/gltf+json[gml_application/gml+xml[go_text/x-go[gpx_application/gpx+xml[gz_application/gzip[h_text/x-h[h261_video/h261[h263_video/h263[h264_video/h264[heic_image/heic[heics_image/heic-sequence[heif_image/heif[heifs_image/heif-sequence[htm,html,shtml_text/html[ico_image/x-icon[icns_image/x-icns[ics,ifb_text/calendar[iges,igs_model/iges[ink,inkml_application/inkml+xml[ipa_application/octet-stream[java_text/x-java-source[jp2,jpg2_image/jp2[jpeg,jpe,jpg_image/jpeg[jpf,jpx_image/jpx[jpm,jpgm_image/jpm[jpgv_video/jpeg[jph_image/jph[js,mjs_text/javascript[json_application/json[json5_application/json5[jsonld_application/ld+json[jsx_text/jsx[jxl_image/jxl[jxr_image/jxr[ktx_image/ktx[ktx2_image/ktx2[less_text/less[m1v,m2v,mpe,mpeg,mpg_video/mpeg[m4a_audio/mp4[m4v_video/x-m4v[md,markdown_text/markdown[mid,midi,kar,rmi_audio/midi[mkv_video/x-matroska[mp2,mp2a,mp3,mpga,m3a,m2a_audio/mpeg[mp4,mp4v,mpg4_video/mp4[mp4a_audio/mp4[mp4s,m4p_application/mp4[odp_application/vnd.oasis.opendocument.presentation[oda_application/oda[ods_application/vnd.oasis.opendocument.spreadsheet[odt_application/vnd.oasis.opendocument.text[oga,ogg,opus,spx_audio/ogg[ogv_video/ogg[ogx_application/ogg[otf_font/otf[p12,pfx_application/x-pkcs12[pdf_application/pdf[pem_application/x-pem-file[php_text/x-php[png_image/png[ppt_application/vnd.ms-powerpoint[pptx_application/vnd.openxmlformats-officedocument.presentationml.presentation[pskcxml_application/pskc+xml[psd_image/vnd.adobe.photoshop[py_text/x-python[qt,mov_video/quicktime[rar_application/vnd.rar[rdf_application/rdf+xml[rtf_text/rtf[sass_text/x-sass[scss_text/x-scss[sgm,sgml_text/sgml[sh_application/x-sh[svg,svgz_image/svg+xml[swf_application/x-shockwave-flash[tar_application/x-tar[tif,tiff_image/tiff[toml_application/toml[ts_video/mp2t[tsx_text/tsx[tsv_text/tab-separated-values[ttc_font/collection[ttf_font/ttf[vtt_text/vtt[wasm_application/wasm[wav_audio/wav[weba_audio/webm[webm_video/webm[webmanifest_application/manifest+json[webp_image/webp[wma_audio/x-ms-wma[wmv_video/x-ms-wmv[woff_font/woff[woff2_font/woff2[xls_application/vnd.ms-excel[xlsx_application/vnd.openxmlformats-officedocument.spreadsheetml.sheet[xml_application/xml[xz_application/x-xz[yaml,yml_text/yaml[zip_application/zip".split("[").flatMap(e=>{const[t,i]=e.split("_");return t.split(",").map(e=>[e,i])}));var Qh=ka("file-upload").parts("root","dropzone","item","itemDeleteTrigger","itemGroup","itemName","itemPreview","itemPreviewImage","itemSizeText","label","trigger","clearTrigger");Qh.build();var Kh=pu()(["accept","acceptedFiles","allowDrop","capture","defaultAcceptedFiles","dir","directory","disabled","getRootNode","id","ids","invalid","locale","maxFiles","maxFileSize","minFileSize","name","onFileAccept","onFileChange","onFileReject","preventDocumentDrop","required","transformFiles","translations","validate"]),Zh=(Ro(Kh),pu()(["file"]));Ro(Zh),Object.defineProperty;var Jh=(e,t)=>({x:e,y:t});function $h(e){const{x:t,y:i,width:n,height:r}=e,a=t+n/2,o=i+r/2;return{x:t,y:i,width:n,height:r,minX:t,minY:i,maxX:t+n,maxY:i+r,midX:a,midY:o,center:Jh(a,o)}}function ep(e){return{top:Jh(e.minX,e.minY),right:Jh(e.maxX,e.minY),bottom:Jh(e.maxX,e.maxY),left:Jh(e.minX,e.maxY)}}var{min:tp,max:ip}=Math;var{sign:np,abs:rp,min:ap}=Math;var op=ka("menu").parts("arrow","arrowTip","content","contextTrigger","indicator","item","itemGroup","itemGroupLabel","itemIndicator","itemText","positioner","separator","trigger","triggerItem"),sp=(op.build(),e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.trigger)&&void 0!==t?t:"menu:".concat(e.id,":trigger")}),lp=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.contextTrigger)&&void 0!==t?t:"menu:".concat(e.id,":ctx-trigger")},cp=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.content)&&void 0!==t?t:"menu:".concat(e.id,":content")},dp=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.positioner)&&void 0!==t?t:"menu:".concat(e.id,":popper")},up=(e,t)=>"".concat(e.id,"/").concat(t),hp=e=>{var t;return null!==(t=null===e||void 0===e?void 0:e.dataset.value)&&void 0!==t?t:null},pp=e=>e.getById(cp(e)),fp=e=>e.getById(dp(e)),mp=e=>e.getById(sp(e)),gp=(e,t)=>t?e.getById(up(e,t)):null,vp=e=>e.getById(lp(e)),yp=e=>{const t=CSS.escape(cp(e)),i='[role^="menuitem"][data-ownedby='.concat(t,"]:not([data-disabled])");return Sl(pp(e),i)},bp=(e,t)=>!!t&&(e.id===t||e.dataset.value===t),xp=(e,t)=>{var i;const n=yp(e),r=n.findIndex(e=>bp(e,t.value));return function(e,t){return e[Ha(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})]}(n,r,{loop:null!==(i=t.loop)&&void 0!==i?i:t.loopFocus})},wp=(e,t)=>{var i;const n=yp(e),r=n.findIndex(e=>bp(e,t.value));return function(e,t){return e[Ga(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})]}(n,r,{loop:null!==(i=t.loop)&&void 0!==i?i:t.loopFocus})},Sp="menu:select";var{not:_p,and:Cp,or:Ep}=Qd();_p("isSubmenu"),Ep("isOpenAutoFocusEvent","isArrowDownEvent"),Cp(_p("isTriggerItem"),"isOpenControlled"),_p("isTriggerItem"),Cp("isSubmenu","isOpenControlled"),_p("isPointerSuspended"),Cp(_p("isPointerSuspended"),_p("isTriggerItem")),Cp(_p("isTriggerItemHighlighted"),_p("isHighlightedItemEditable"),"closeOnSelect","isOpenControlled"),Cp(_p("isTriggerItemHighlighted"),_p("isHighlightedItemEditable"),"closeOnSelect"),Cp(_p("isTriggerItemHighlighted"),_p("isHighlightedItemEditable"));function Ap(e){var t;let i=e.parent;for(;i&&i.computed("isSubmenu");)i.refs.get("parent");null===i||void 0===t||t.send({type:"CLOSE"})}var Mp=pu()(["anchorPoint","aria-label","closeOnSelect","composite","defaultHighlightedValue","defaultOpen","dir","getRootNode","highlightedValue","id","ids","loopFocus","navigate","onEscapeKeyDown","onFocusOutside","onHighlightChange","onInteractOutside","onOpenChange","onPointerDownOutside","onSelect","open","positioning","typeahead"]),Tp=(Ro(Mp),pu()(["closeOnSelect","disabled","value","valueText"])),Pp=(Ro(Tp),pu()(["htmlFor"])),Dp=(Ro(Pp),pu()(["id"])),Op=(Ro(Dp),pu()(["checked","closeOnSelect","disabled","onCheckedChange","type","value","valueText"])),Ip=(Ro(Op),ka("popover").parts("arrow","arrowTip","anchor","trigger","indicator","positioner","content","title","description","closeTrigger"));Ip.build();var kp=pu()(["autoFocus","closeOnEscape","closeOnInteractOutside","dir","getRootNode","id","ids","initialFocusEl","modal","onEscapeKeyDown","onFocusOutside","onInteractOutside","onOpenChange","onPointerDownOutside","defaultOpen","open","persistentElements","portalled","positioning"]);Ro(kp);var Rp=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);var zp=null,Lp=new Set,Bp=new Map,Np=!1,Fp=!1,Up={Tab:!0,Escape:!0};function Vp(e,t){for(let i of Lp)i(e,t)}function jp(e){Np=!0,function(e){return!(e.metaKey||!Is()&&e.altKey||e.ctrlKey||"Control"===e.key||"Shift"===e.key||"Meta"===e.key)}(e)&&(zp="keyboard",Vp("keyboard",e))}function Wp(e){zp="pointer","mousedown"!==e.type&&"pointerdown"!==e.type||(Np=!0,Vp("pointer",e))}function Hp(e){Bs(e)&&(Np=!0,zp="virtual")}function Gp(e){const t=Rs(e);t!==Ss(t)&&t!==ws(t)&&(Np||Fp||(zp="virtual",Vp("virtual",e)),Np=!1,Fp=!1)}function qp(){Np=!1,Fp=!0}function Xp(e){if("undefined"===typeof window||Bp.get(Ss(e)))return;const t=Ss(e),i=ws(e);let n=t.HTMLElement.prototype.focus;Object.defineProperty(t.HTMLElement.prototype,"focus",{configurable:!0,value:function(){zp="virtual",Vp("virtual",null),Np=!0,n.apply(this,arguments)}}),i.addEventListener("keydown",jp,!0),i.addEventListener("keyup",jp,!0),i.addEventListener("click",Hp,!0),t.addEventListener("focus",Gp,!0),t.addEventListener("blur",qp,!1),"undefined"!==typeof t.PointerEvent?(i.addEventListener("pointerdown",Wp,!0),i.addEventListener("pointermove",Wp,!0),i.addEventListener("pointerup",Wp,!0)):(i.addEventListener("mousedown",Wp,!0),i.addEventListener("mousemove",Wp,!0),i.addEventListener("mouseup",Wp,!0)),t.addEventListener("beforeunload",()=>{Yp(e)},{once:!0}),Bp.set(t,{focus:n})}var Yp=(e,t)=>{const i=Ss(e),n=ws(e);Bp.has(i)&&(i.HTMLElement.prototype.focus=Bp.get(i).focus,n.removeEventListener("keydown",jp,!0),n.removeEventListener("keyup",jp,!0),n.removeEventListener("click",Hp,!0),i.removeEventListener("focus",Gp,!0),i.removeEventListener("blur",qp,!1),"undefined"!==typeof i.PointerEvent?(n.removeEventListener("pointerdown",Wp,!0),n.removeEventListener("pointermove",Wp,!0),n.removeEventListener("pointerup",Wp,!0)):(n.removeEventListener("mousedown",Wp,!0),n.removeEventListener("mousemove",Wp,!0),n.removeEventListener("mouseup",Wp,!0)),Bp.delete(i))};function Qp(){return"keyboard"===zp}function Kp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{isTextInput:t,autoFocus:i,onChange:n,root:r}=e;Xp(r),null===n||void 0===n||n({isFocusVisible:i||Qp(),modality:zp});const a=(e,i)=>{(function(e,t,i){const n=i?Rs(i):null,r=Ss(n);return!((e||n instanceof r.HTMLInputElement&&!Rp.has(null===n||void 0===n?void 0:n.type)||n instanceof r.HTMLTextAreaElement||n instanceof r.HTMLElement&&n.isContentEditable)&&"keyboard"===t&&i instanceof r.KeyboardEvent&&!Reflect.has(Up,i.key))})(!!t,e,i)&&(null===n||void 0===n||n({isFocusVisible:Qp(),modality:e}))};return Lp.add(a),()=>{Lp.delete(a)}}var Zp=ka("radio-group").parts("root","label","item","itemText","itemControl","indicator"),Jp=(Zp.build(),e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.root)&&void 0!==t?t:"radio-group:".concat(e.id)}),$p=(e,t)=>{var i,n,r;return null!==(i=null===(n=e.ids)||void 0===n||null===(r=n.item)||void 0===r?void 0:r.call(n,t))&&void 0!==i?i:"radio-group:".concat(e.id,":radio:").concat(t)},ef=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.indicator)&&void 0!==t?t:"radio-group:".concat(e.id,":indicator")},tf=e=>e.getById(Jp(e)),nf=e=>{const t=CSS.escape(Jp(e)),i="input[type=radio][data-ownedby='".concat(t,"']:not([disabled])");return Sl(tf(e),i)};var{not:rf}=Qd(),af=(rf("isTrusted"),pu()(["dir","disabled","form","getRootNode","id","ids","name","onValueChange","orientation","readOnly","value","defaultValue"])),of=(Ro(af),pu()(["value","disabled","invalid"])),sf=(Ro(of),ka("rating-group").parts("root","label","item","control"));sf.build();var lf=pu()(["allowHalf","autoFocus","count","dir","disabled","form","getRootNode","id","ids","name","onHoverChange","onValueChange","required","readOnly","translations","value","defaultValue"]),cf=(Ro(lf),pu()(["index"])),df=(Ro(cf),ka("select").parts("label","positioner","trigger","indicator","clearTrigger","item","itemText","itemIndicator","itemGroup","itemGroupLabel","list","content","root","control","valueText")),uf=(df.build(),e=>new Uo(e));uf.empty=()=>new Uo({items:[]});var hf=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.content)&&void 0!==t?t:"select:".concat(e.id,":content")},pf=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.trigger)&&void 0!==t?t:"select:".concat(e.id,":trigger")},ff=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.clearTrigger)&&void 0!==t?t:"select:".concat(e.id,":clear-trigger")},mf=(e,t)=>{var i,n,r;return null!==(i=null===(n=e.ids)||void 0===n||null===(r=n.item)||void 0===r?void 0:r.call(n,t))&&void 0!==i?i:"select:".concat(e.id,":option:").concat(t)},gf=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.hiddenSelect)&&void 0!==t?t:"select:".concat(e.id,":select")},vf=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.positioner)&&void 0!==t?t:"select:".concat(e.id,":positioner")},yf=e=>e.getById(gf(e)),bf=e=>e.getById(hf(e)),xf=e=>e.getById(pf(e)),wf=e=>e.getById(vf(e));var{and:Sf,not:_f,or:Cf}=Qd();Cf("isTriggerArrowDownEvent","isTriggerEnterEvent"),Sf(_f("multiple"),"hasSelectedItems"),_f("multiple"),Sf(_f("multiple"),"hasSelectedItems"),_f("multiple"),_f("multiple"),_f("multiple"),_f("multiple"),Sf("closeOnSelect","isOpenControlled"),Sf("hasHighlightedItem","loop","isLastItemHighlighted"),Sf("hasHighlightedItem","loop","isFirstItemHighlighted");function Ef(e){var t,i;const n=null!==e.restoreFocus&&void 0!==t?t:null===e.previousEvent||void 0===i?void 0:i.restoreFocus;return null==n||!!n}var Af=pu()(["closeOnSelect","collection","composite","defaultHighlightedValue","defaultOpen","defaultValue","deselectable","dir","disabled","form","getRootNode","highlightedValue","id","ids","invalid","loopFocus","multiple","name","onFocusOutside","onHighlightChange","onInteractOutside","onOpenChange","onPointerDownOutside","onSelect","onValueChange","open","positioning","readOnly","required","scrollToIndexFn","value"]),Mf=(Ro(Af),pu()(["item","persistFocus"])),Tf=(Ro(Mf),pu()(["id"])),Pf=(Ro(Tf),pu()(["htmlFor"])),Df=(Ro(Pf),ka("slider").parts("root","label","thumb","valueText","track","range","control","markerGroup","marker","draggingIndicator"));Df.build();var Of=pu()(["aria-label","aria-labelledby","dir","disabled","form","getAriaValueText","getRootNode","id","ids","invalid","max","min","minStepsBetweenThumbs","name","onFocusChange","onValueChange","onValueChangeEnd","orientation","origin","readOnly","step","thumbAlignment","thumbAlignment","thumbSize","value","defaultValue"]),If=(Ro(Of),pu()(["index","name"])),kf=(Ro(If),ka("switch").parts("root","label","control","thumb")),Rf=(kf.build(),e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.root)&&void 0!==t?t:"switch:".concat(e.id)}),zf=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.hiddenInput)&&void 0!==t?t:"switch:".concat(e.id,":input")},Lf=e=>e.getById(zf(e));var{not:Bf}=Qd(),Nf=(Bf("isTrusted"),Bf("isTrusted"),pu()(["checked","defaultChecked","dir","disabled","form","getRootNode","id","ids","invalid","label","name","onCheckedChange","readOnly","required","value"]));Ro(Nf);const Ff=Uu.extendWith("itemBody"),Uf=ka("action-bar").parts("positioner","content","separator","selectionTrigger","closeTrigger"),Vf=ka("alert").parts("title","description","root","indicator","content"),jf=ka("breadcrumb").parts("link","currentLink","item","list","root","ellipsis","separator"),Wf=ka("blockquote").parts("root","icon","content","caption"),Hf=ka("card").parts("root","header","body","footer","title","description"),Gf=ka("checkbox-card",["root","control","label","description","addon","indicator","content"]),qf=ka("data-list").parts("root","item","itemLabel","itemValue"),Xf=Wh.extendWith("header","body","footer","backdrop"),Yf=Wh.extendWith("header","body","footer","backdrop"),Qf=Gh.extendWith("textarea"),Kf=ka("empty-state",["root","content","indicator","title","description"]),Zf=Xh.extendWith("requiredIndicator"),Jf=Yh.extendWith("content"),$f=Qh.extendWith("itemContent","dropzoneContent","fileText"),em=ka("list").parts("root","item","indicator"),tm=op.extendWith("itemCommand"),im=ka("select").parts("root","field","indicator"),nm=Ip.extendWith("header","body","footer"),rm=Zp.extendWith("itemAddon","itemIndicator"),am=rm.extendWith("itemContent","itemDescription"),om=sf.extendWith("itemIndicator"),sm=df.extendWith("indicatorGroup"),lm=fu.extendWith("indicatorGroup","empty"),cm=Df.extendWith("markerIndicator"),dm=ka("stat").parts("root","label","helpText","valueText","valueUnit","indicator"),um=ka("status").parts("root","indicator"),hm=ka("steps",["root","list","item","trigger","indicator","separator","content","title","description","nextTrigger","prevTrigger","progress"]),pm=kf.extendWith("indicator"),fm=ka("table").parts("root","header","body","row","columnHeader","cell","footer","caption"),mm=ka("toast").parts("root","title","description","indicator","closeTrigger","actionTrigger"),gm=ka("tabs").parts("root","trigger","list","content","contentGroup","indicator"),vm=ka("tag").parts("root","label","closeTrigger","startElement","endElement"),ym=ka("timeline").parts("root","item","content","separator","indicator","connector","title","description"),bm=jh.extendWith("channelText"),xm=ka("code-block",["root","content","title","header","footer","control","overlay","code","codeText","copyTrigger","copyIndicator","collapseTrigger","collapseIndicator","collapseText"]),wm=(Yu.extendWith("valueText"),{className:"chakra-accordion",slots:Ff.keys(),base:{root:{width:"full","--accordion-radius":"radii.l2"},item:{overflowAnchor:"none"},itemTrigger:{display:"flex",alignItems:"center",textAlign:"start",width:"full",outline:"0",gap:"3",fontWeight:"medium",borderRadius:"var(--accordion-radius)",_focusVisible:{outline:"2px solid",outlineColor:"colorPalette.focusRing"},_disabled:{layerStyle:"disabled"}},itemBody:{pt:"var(--accordion-padding-y)",pb:"calc(var(--accordion-padding-y) * 2)"},itemContent:{overflow:"hidden",borderRadius:"var(--accordion-radius)",_open:{animationName:"expand-height, fade-in",animationDuration:"moderate"},_closed:{animationName:"collapse-height, fade-out",animationDuration:"moderate"}},itemIndicator:{transition:"rotate 0.2s",transformOrigin:"center",color:"fg.subtle",_open:{rotate:"180deg"},_icon:{width:"1.2em",height:"1.2em"}}},variants:{variant:{outline:{item:{borderBottomWidth:"1px"}},subtle:{itemTrigger:{px:"var(--accordion-padding-x)"},itemContent:{px:"var(--accordion-padding-x)"},item:{borderRadius:"var(--accordion-radius)",_open:{bg:"colorPalette.subtle"}}},enclosed:{root:{borderWidth:"1px",borderRadius:"var(--accordion-radius)",divideY:"1px",overflow:"hidden"},itemTrigger:{px:"var(--accordion-padding-x)"},itemContent:{px:"var(--accordion-padding-x)"},item:{_open:{bg:"bg.subtle"}}},plain:{}},size:{sm:{root:{"--accordion-padding-x":"spacing.3","--accordion-padding-y":"spacing.2"},itemTrigger:{textStyle:"sm",py:"var(--accordion-padding-y)"}},md:{root:{"--accordion-padding-x":"spacing.4","--accordion-padding-y":"spacing.2"},itemTrigger:{textStyle:"md",py:"var(--accordion-padding-y)"}},lg:{root:{"--accordion-padding-x":"spacing.4.5","--accordion-padding-y":"spacing.2.5"},itemTrigger:{textStyle:"lg",py:"var(--accordion-padding-y)"}}}},defaultVariants:{size:"md",variant:"outline"}}),Sm={className:"chakra-action-bar",slots:Uf.keys(),base:{positioner:{position:"fixed",display:"flex",justifyContent:"center",pointerEvents:"none",insetInline:"0",top:"unset",bottom:"calc(env(safe-area-inset-bottom) + 20px)"},content:{bg:"bg.panel",shadow:"md",display:"flex",alignItems:"center",gap:"3",borderRadius:"l3",py:"2.5",px:"3",pointerEvents:"auto",translate:"calc(-1 * var(--scrollbar-width) / 2) 0px",_open:{animationName:"slide-from-bottom, fade-in",animationDuration:"moderate"},_closed:{animationName:"slide-to-bottom, fade-out",animationDuration:"faster"}},separator:{width:"1px",height:"5",bg:"border"},selectionTrigger:{display:"inline-flex",alignItems:"center",gap:"2",alignSelf:"stretch",textStyle:"sm",px:"4",py:"1",borderRadius:"l2",borderWidth:"1px",borderStyle:"dashed"}}},_m={slots:Vf.keys(),className:"chakra-alert",base:{root:{width:"full",display:"flex",alignItems:"flex-start",position:"relative",borderRadius:"l3"},title:{fontWeight:"medium"},description:{display:"inline"},indicator:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:"0",width:"1em",height:"1em",_icon:{boxSize:"full"}},content:{display:"flex",flex:"1",gap:"1"}},variants:{status:{info:{root:{colorPalette:"blue"}},warning:{root:{colorPalette:"orange"}},success:{root:{colorPalette:"green"}},error:{root:{colorPalette:"red"}},neutral:{root:{colorPalette:"gray"}}},inline:{true:{content:{display:"inline-flex",flexDirection:"row",alignItems:"center"}},false:{content:{display:"flex",flexDirection:"column"}}},variant:{subtle:{root:{bg:"colorPalette.subtle",color:"colorPalette.fg"}},surface:{root:{bg:"colorPalette.subtle",color:"colorPalette.fg",shadow:"inset 0 0 0px 1px var(--shadow-color)",shadowColor:"colorPalette.muted"},indicator:{color:"colorPalette.fg"}},outline:{root:{color:"colorPalette.fg",shadow:"inset 0 0 0px 1px var(--shadow-color)",shadowColor:"colorPalette.muted"},indicator:{color:"colorPalette.fg"}},solid:{root:{bg:"colorPalette.solid",color:"colorPalette.contrast"},indicator:{color:"colorPalette.contrast"}}},size:{sm:{root:{gap:"2",px:"3",py:"3",textStyle:"xs"},indicator:{textStyle:"lg"}},md:{root:{gap:"3",px:"4",py:"4",textStyle:"sm"},indicator:{textStyle:"xl"}},lg:{root:{gap:"3",px:"4",py:"4",textStyle:"md"},indicator:{textStyle:"2xl"}}}},defaultVariants:{status:"info",variant:"subtle",size:"md",inline:!1}};var Cm=ka("avatar").parts("root","image","fallback");Cm.build();var Em=pu()(["dir","id","ids","onStatusChange","getRootNode"]);Ro(Em);const Am={slots:Cm.keys(),className:"chakra-avatar",base:{root:{display:"inline-flex",alignItems:"center",justifyContent:"center",fontWeight:"medium",position:"relative",verticalAlign:"top",flexShrink:"0",userSelect:"none",width:"var(--avatar-size)",height:"var(--avatar-size)",fontSize:"var(--avatar-font-size)",borderRadius:"var(--avatar-radius)","&[data-group-item]":{borderWidth:"2px",borderColor:"bg"}},image:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"var(--avatar-radius)"},fallback:{lineHeight:"1",textTransform:"uppercase",fontWeight:"medium",fontSize:"var(--avatar-font-size)",borderRadius:"var(--avatar-radius)"}},variants:{size:{full:{root:{"--avatar-size":"100%","--avatar-font-size":"100%"}},"2xs":{root:{"--avatar-font-size":"fontSizes.2xs","--avatar-size":"sizes.6"}},xs:{root:{"--avatar-font-size":"fontSizes.xs","--avatar-size":"sizes.8"}},sm:{root:{"--avatar-font-size":"fontSizes.sm","--avatar-size":"sizes.9"}},md:{root:{"--avatar-font-size":"fontSizes.md","--avatar-size":"sizes.10"}},lg:{root:{"--avatar-font-size":"fontSizes.md","--avatar-size":"sizes.11"}},xl:{root:{"--avatar-font-size":"fontSizes.lg","--avatar-size":"sizes.12"}},"2xl":{root:{"--avatar-font-size":"fontSizes.xl","--avatar-size":"sizes.16"}}},variant:{solid:{root:{bg:"colorPalette.solid",color:"colorPalette.contrast"}},subtle:{root:{bg:"colorPalette.muted",color:"colorPalette.fg"}},outline:{root:{color:"colorPalette.fg",borderWidth:"1px",borderColor:"colorPalette.muted"}}},shape:{square:{},rounded:{root:{"--avatar-radius":"radii.l3"}},full:{root:{"--avatar-radius":"radii.full"}}},borderless:{true:{root:{"&[data-group-item]":{borderWidth:"0px"}}}}},defaultVariants:{size:"md",shape:"full",variant:"subtle"}},Mm={className:"chakra-blockquote",slots:Wf.keys(),base:{root:{position:"relative",display:"flex",flexDirection:"column",gap:"2"},caption:{textStyle:"sm",color:"fg.muted"},icon:{boxSize:"5"}},variants:{justify:{start:{root:{alignItems:"flex-start",textAlign:"start"}},center:{root:{alignItems:"center",textAlign:"center"}},end:{root:{alignItems:"flex-end",textAlign:"end"}}},variant:{subtle:{root:{paddingX:"5",borderStartWidth:"4px",borderStartColor:"colorPalette.muted"},icon:{color:"colorPalette.fg"}},solid:{root:{paddingX:"5",borderStartWidth:"4px",borderStartColor:"colorPalette.solid"},icon:{color:"colorPalette.solid"}},plain:{root:{paddingX:"5"},icon:{color:"colorPalette.solid"}}}},defaultVariants:{variant:"subtle",justify:"start"}},Tm={className:"chakra-breadcrumb",slots:jf.keys(),base:{list:{display:"flex",alignItems:"center",wordBreak:"break-word",color:"fg.muted",listStyle:"none"},link:{outline:"0",textDecoration:"none",borderRadius:"l1",focusRing:"outside",display:"inline-flex",alignItems:"center",gap:"2"},item:{display:"inline-flex",alignItems:"center"},separator:{color:"fg.muted",opacity:"0.8",_icon:{boxSize:"1em"},_rtl:{rotate:"180deg"}},ellipsis:{display:"inline-flex",alignItems:"center",justifyContent:"center",_icon:{boxSize:"1em"}}},variants:{variant:{underline:{link:{color:"colorPalette.fg",textDecoration:"underline",textUnderlineOffset:"0.2em",textDecorationColor:"colorPalette.muted"},currentLink:{color:"colorPalette.fg"}},plain:{link:{color:"fg.muted",_hover:{color:"fg"}},currentLink:{color:"fg"}}},size:{sm:{list:{gap:"1",textStyle:"xs"}},md:{list:{gap:"1.5",textStyle:"sm"}},lg:{list:{gap:"2",textStyle:"md"}}}},defaultVariants:{variant:"plain",size:"md"}},Pm={className:"chakra-card",slots:Hf.keys(),base:{root:{display:"flex",flexDirection:"column",position:"relative",minWidth:"0",wordWrap:"break-word",borderRadius:"l3",color:"fg",textAlign:"start"},title:{fontWeight:"semibold"},description:{color:"fg.muted",fontSize:"sm"},header:{paddingInline:"var(--card-padding)",paddingTop:"var(--card-padding)",display:"flex",flexDirection:"column",gap:"1.5"},body:{padding:"var(--card-padding)",flex:"1",display:"flex",flexDirection:"column"},footer:{display:"flex",alignItems:"center",gap:"2",paddingInline:"var(--card-padding)",paddingBottom:"var(--card-padding)"}},variants:{size:{sm:{root:{"--card-padding":"spacing.4"},title:{textStyle:"md"}},md:{root:{"--card-padding":"spacing.6"},title:{textStyle:"lg"}},lg:{root:{"--card-padding":"spacing.7"},title:{textStyle:"xl"}}},variant:{elevated:{root:{bg:"bg.panel",boxShadow:"md"}},outline:{root:{bg:"bg.panel",borderWidth:"1px",borderColor:"border"}},subtle:{root:{bg:"bg.muted"}}}},defaultVariants:{variant:"outline",size:"md"}};var Dm=ka("checkbox").parts("root","label","control","indicator"),Om=(Dm.build(),e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.root)&&void 0!==t?t:"checkbox:".concat(e.id)}),Im=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.hiddenInput)&&void 0!==t?t:"checkbox:".concat(e.id,":input")},km=e=>e.getById(Im(e));var{not:Rm}=Qd();Rm("isTrusted"),Rm("isTrusted");function zm(e){return"indeterminate"===e}var Lm=pu()(["defaultChecked","checked","dir","disabled","form","getRootNode","id","ids","invalid","name","onCheckedChange","readOnly","required","value"]);Ro(Lm);var Bm,Nm,Fm,Um,Vm,jm,Wm;const Hm={slots:Dm.extendWith("group").keys(),className:"chakra-checkbox",base:{root:{display:"inline-flex",gap:"2",alignItems:"center",verticalAlign:"top",position:"relative"},control:Sa.base,label:{fontWeight:"medium",userSelect:"none",_disabled:{opacity:"0.5"}}},variants:{size:{xs:{root:{gap:"1.5"},label:{textStyle:"xs"},control:null===(Bm=Sa.variants)||void 0===Bm||null===(Bm=Bm.size)||void 0===Bm?void 0:Bm.xs},sm:{root:{gap:"2"},label:{textStyle:"sm"},control:null===(Nm=Sa.variants)||void 0===Nm||null===(Nm=Nm.size)||void 0===Nm?void 0:Nm.sm},md:{root:{gap:"2.5"},label:{textStyle:"sm"},control:null===(Fm=Sa.variants)||void 0===Fm||null===(Fm=Fm.size)||void 0===Fm?void 0:Fm.md},lg:{root:{gap:"3"},label:{textStyle:"md"},control:null===(Um=Sa.variants)||void 0===Um||null===(Um=Um.size)||void 0===Um?void 0:Um.lg}},variant:{outline:{control:null===(Vm=Sa.variants)||void 0===Vm||null===(Vm=Vm.variant)||void 0===Vm?void 0:Vm.outline},solid:{control:null===(jm=Sa.variants)||void 0===jm||null===(jm=jm.variant)||void 0===jm?void 0:jm.solid},subtle:{control:null===(Wm=Sa.variants)||void 0===Wm||null===(Wm=Wm.variant)||void 0===Wm?void 0:Wm.subtle}}},defaultVariants:{variant:"solid",size:"md"}};var Gm,qm,Xm,Ym,Qm,Km,Zm;const Jm={slots:Gf.keys(),className:"chakra-checkbox-card",base:{root:{display:"flex",flexDirection:"column",userSelect:"none",position:"relative",borderRadius:"l2",flex:"1",focusVisibleRing:"outside",_disabled:{opacity:"0.8"},_invalid:{outline:"2px solid",outlineColor:"border.error"}},control:{display:"inline-flex",flex:"1",position:"relative",borderRadius:"inherit",justifyContent:"var(--checkbox-card-justify)",alignItems:"var(--checkbox-card-align)"},label:{fontWeight:"medium",display:"flex",alignItems:"center",gap:"2",flex:"1",_disabled:{opacity:"0.5"}},description:{opacity:"0.64",textStyle:"sm",_disabled:{opacity:"0.5"}},addon:{_disabled:{opacity:"0.5"}},indicator:Sa.base,content:{display:"flex",flexDirection:"column",flex:"1",gap:"1",justifyContent:"var(--checkbox-card-justify)",alignItems:"var(--checkbox-card-align)"}},variants:{size:{sm:{root:{textStyle:"sm"},control:{padding:"3",gap:"1.5"},addon:{px:"3",py:"1.5",borderTopWidth:"1px"},indicator:null===(Gm=Sa.variants)||void 0===Gm?void 0:Gm.size.sm},md:{root:{textStyle:"sm"},control:{padding:"4",gap:"2.5"},addon:{px:"4",py:"2",borderTopWidth:"1px"},indicator:null===(qm=Sa.variants)||void 0===qm?void 0:qm.size.md},lg:{root:{textStyle:"md"},control:{padding:"4",gap:"3.5"},addon:{px:"4",py:"2",borderTopWidth:"1px"},indicator:null===(Xm=Sa.variants)||void 0===Xm?void 0:Xm.size.lg}},variant:{surface:{root:{borderWidth:"1px",borderColor:"border",_checked:{bg:"colorPalette.subtle",color:"colorPalette.fg",borderColor:"colorPalette.muted"},_disabled:{bg:"bg.muted"}},indicator:null===(Ym=Sa.variants)||void 0===Ym?void 0:Ym.variant.solid},subtle:{root:{bg:"bg.muted"},control:{_checked:{bg:"colorPalette.muted",color:"colorPalette.fg"}},indicator:null===(Qm=Sa.variants)||void 0===Qm?void 0:Qm.variant.plain},outline:{root:{borderWidth:"1px",borderColor:"border",_checked:{boxShadow:"0 0 0 1px var(--shadow-color)",boxShadowColor:"colorPalette.solid",borderColor:"colorPalette.solid"}},indicator:null===(Km=Sa.variants)||void 0===Km?void 0:Km.variant.solid},solid:{root:{borderWidth:"1px",_checked:{bg:"colorPalette.solid",color:"colorPalette.contrast",borderColor:"colorPalette.solid"}},indicator:null===(Zm=Sa.variants)||void 0===Zm?void 0:Zm.variant.inverted}},justify:{start:{root:{"--checkbox-card-justify":"flex-start"}},end:{root:{"--checkbox-card-justify":"flex-end"}},center:{root:{"--checkbox-card-justify":"center"}}},align:{start:{root:{"--checkbox-card-align":"flex-start"},content:{textAlign:"start"}},end:{root:{"--checkbox-card-align":"flex-end"},content:{textAlign:"end"}},center:{root:{"--checkbox-card-align":"center"},content:{textAlign:"center"}}},orientation:{vertical:{control:{flexDirection:"column"}},horizontal:{control:{flexDirection:"row"}}}},defaultVariants:{size:"md",variant:"outline",align:"start",orientation:"horizontal"}},$m={slots:xm.keys(),className:"code-block",base:{root:{colorPalette:"gray",rounded:"var(--code-block-radius)",overflow:"hidden",bg:"bg",color:"fg",borderWidth:"1px","--code-block-max-height":"320px","--code-block-bg":"colors.bg","--code-block-fg":"colors.fg","--code-block-obscured-opacity":"0.5","--code-block-obscured-blur":"1px","--code-block-line-number-width":"sizes.3","--code-block-line-number-margin":"spacing.4","--code-block-highlight-bg":"{colors.teal.focusRing/20}","--code-block-highlight-border":"colors.teal.focusRing","--code-block-highlight-added-bg":"{colors.green.focusRing/20}","--code-block-highlight-added-border":"colors.green.focusRing","--code-block-highlight-removed-bg":"{colors.red.focusRing/20}","--code-block-highlight-removed-border":"colors.red.focusRing"},header:{display:"flex",alignItems:"center",gap:"2",position:"relative",px:"var(--code-block-padding)",minH:"var(--code-block-header-height)",mb:"calc(var(--code-block-padding) / 2 * -1)"},title:{display:"inline-flex",alignItems:"center",gap:"1.5",flex:"1",color:"fg.muted"},control:{gap:"1.5",display:"inline-flex",alignItems:"center"},footer:{display:"flex",alignItems:"center",justifyContent:"center",gap:"2",px:"var(--code-block-padding)",minH:"var(--code-block-header-height)"},content:{position:"relative",colorScheme:"dark",overflow:"hidden",borderBottomRadius:"var(--code-block-radius)",maxHeight:"var(--code-block-max-height)","& ::selection":{bg:"blue.500/40"},_expanded:{maxHeight:"unset"}},overlay:{"--bg":"{colors.black/50}",display:"flex",alignItems:"flex-end",justifyContent:"center",padding:"4",bgImage:"linear-gradient(0deg,var(--bg) 25%,transparent 100%)",color:"white",minH:"5rem",pos:"absolute",bottom:"0",insetInline:"0",zIndex:"1",fontWeight:"medium",_expanded:{display:"none"}},code:{fontFamily:"mono",lineHeight:"tall",whiteSpace:"pre",counterReset:"line 0"},codeText:{px:"var(--code-block-padding)",py:"var(--code-block-padding)",position:"relative",display:"block",width:"100%","&[data-has-focused]":{"& [data-line]:not([data-focused])":{transitionProperty:"opacity, filter",transitionDuration:"moderate",transitionTimingFunction:"ease-in-out",opacity:"var(--code-block-obscured-opacity)",filter:"blur(var(--code-block-obscured-blur))"},"&:hover":{"--code-block-obscured-opacity":"1","--code-block-obscured-blur":"0px"}},"&[data-has-line-numbers][data-plaintext]":{paddingInlineStart:"calc(var(--code-block-line-number-width) + var(--code-block-line-number-margin) + var(--code-block-padding))"},"& [data-line]":{position:"relative","--highlight-bg":"var(--code-block-highlight-bg)","--highlight-border":"var(--code-block-highlight-border)","&[data-highlight], &[data-diff]":{display:"inline-block",width:"full","&:after":{content:"''",display:"block",position:"absolute",insetStart:"calc(var(--code-block-padding) * -1)",insetEnd:"0px",width:"calc(100% + var(--code-block-padding) * 2)",height:"100%",bg:"var(--highlight-bg)",borderStartWidth:"2px",borderStartColor:"var(--highlight-border)"}},"&[data-diff='added']":{"--highlight-bg":"var(--code-block-highlight-added-bg)","--highlight-border":"var(--code-block-highlight-added-border)"},"&[data-diff='removed']":{"--highlight-bg":"var(--code-block-highlight-removed-bg)","--highlight-border":"var(--code-block-highlight-removed-border)"}},"&[data-word-wrap]":{"&[data-plaintext], & [data-line]":{whiteSpace:"pre-wrap",wordBreak:"break-all"}},"&[data-has-line-numbers]":{"--content":"counter(line)","& [data-line]:before":{content:"var(--content)",counterIncrement:"line",width:"var(--code-block-line-number-width)",marginRight:"var(--code-block-line-number-margin)",display:"inline-block",textAlign:"end",userSelect:"none",opacity:.4},"& [data-diff='added']:before":{content:"'+'"},"& [data-diff='removed']:before":{content:"'-'"}}}},variants:{size:{sm:{root:{"--code-block-padding":"spacing.4","--code-block-radius":"radii.md","--code-block-header-height":"sizes.8"},title:{textStyle:"xs"},code:{fontSize:"xs"}},md:{root:{"--code-block-padding":"spacing.4","--code-block-radius":"radii.lg","--code-block-header-height":"sizes.10"},title:{textStyle:"xs"},code:{fontSize:"sm"}},lg:{root:{"--code-block-padding":"spacing.5","--code-block-radius":"radii.xl","--code-block-header-height":"sizes.12"},title:{textStyle:"sm"},code:{fontSize:"sm"}}}},defaultVariants:{size:"md"}};var eg=ka("collapsible").parts("root","trigger","content","indicator");eg.build();var tg=pu()(["dir","disabled","getRootNode","id","ids","onExitComplete","onOpenChange","defaultOpen","open"]);Ro(tg);const ig={slots:eg.keys(),className:"chakra-collapsible",base:{content:{overflow:"hidden",_open:{animationName:"expand-height, fade-in",animationDuration:"moderate"},_closed:{animationName:"collapse-height, fade-out",animationDuration:"moderate"}}}};var ng,rg,ag,og,sg,lg,cg,dg,ug;const hg={className:"colorPicker",slots:bm.keys(),base:{root:{display:"flex",flexDirection:"column",gap:"1.5"},label:{color:"fg",fontWeight:"medium",textStyle:"sm",_disabled:{opacity:"0.5"}},valueText:{textAlign:"start"},control:{display:"flex",alignItems:"center",flexDirection:"row",gap:"2",position:"relative"},swatchTrigger:{display:"flex",alignItems:"center",justifyContent:"center"},trigger:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"row",flexShrink:"0",gap:"2",textStyle:"sm",minH:"var(--input-height)",minW:"var(--input-height)",px:"1",rounded:"l2",_disabled:{opacity:"0.5"},"--focus-color":"colors.colorPalette.focusRing","&:focus-visible":{borderColor:"var(--focus-color)",outline:"1px solid var(--focus-color)"},"&[data-fit-content]":{"--input-height":"unset",px:"0",border:"0"}},content:{display:"flex",flexDirection:"column",bg:"bg.panel",borderRadius:"l3",boxShadow:"lg",width:"64",p:"4",gap:"3",zIndex:"dropdown",_open:{animationStyle:"slide-fade-in",animationDuration:"fast"},_closed:{animationStyle:"slide-fade-out",animationDuration:"faster"}},area:{height:"180px",borderRadius:"l2",overflow:"hidden"},areaThumb:{borderRadius:"full",height:"var(--thumb-size)",width:"var(--thumb-size)",borderWidth:"2px",borderColor:"white",shadow:"sm",focusVisibleRing:"mixed",focusRingColor:"white"},areaBackground:{height:"full"},channelSlider:{borderRadius:"l2",flex:"1"},channelSliderTrack:{height:"var(--slider-height)",borderRadius:"inherit",boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"},channelText:{textStyle:"xs",color:"fg.muted",fontWeight:"medium",textTransform:"capitalize"},swatchGroup:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:"2"},swatch:c(c({},Ea.base),{},{borderRadius:"l1"}),swatchIndicator:{color:"white",rounded:"full"},channelSliderThumb:{borderRadius:"full",height:"var(--thumb-size)",width:"var(--thumb-size)",borderWidth:"2px",borderColor:"white",shadow:"sm",transform:"translate(-50%, -50%)",focusVisibleRing:"outside",focusRingOffset:"1px"},channelInput:c(c({},Ma.base),{},{"&::-webkit-inner-spin-button, &::-webkit-outer-spin-button":{WebkitAppearance:"none",margin:0}}),formatSelect:{textStyle:"xs",textTransform:"uppercase",borderWidth:"1px",minH:"6",focusRing:"inside",rounded:"l2"},transparencyGrid:{borderRadius:"l2"},view:{display:"flex",flexDirection:"column",gap:"2"}},variants:{size:{"2xs":{channelInput:null===(ng=Ma.variants)||void 0===ng||null===(ng=ng.size)||void 0===ng?void 0:ng["2xs"],swatch:{"--swatch-size":"sizes.4.5"},trigger:{"--input-height":"sizes.7"},area:{"--thumb-size":"sizes.3"},channelSlider:{"--slider-height":"sizes.3","--thumb-size":"sizes.3"}},xs:{channelInput:null===(rg=Ma.variants)||void 0===rg||null===(rg=rg.size)||void 0===rg?void 0:rg.xs,swatch:{"--swatch-size":"sizes.5"},trigger:{"--input-height":"sizes.8"},area:{"--thumb-size":"sizes.3.5"},channelSlider:{"--slider-height":"sizes.3.5","--thumb-size":"sizes.3.5"}},sm:{channelInput:null===(ag=Ma.variants)||void 0===ag||null===(ag=ag.size)||void 0===ag?void 0:ag.sm,swatch:{"--swatch-size":"sizes.6"},trigger:{"--input-height":"sizes.9"},area:{"--thumb-size":"sizes.3.5"},channelSlider:{"--slider-height":"sizes.3.5","--thumb-size":"sizes.3.5"}},md:{channelInput:null===(og=Ma.variants)||void 0===og||null===(og=og.size)||void 0===og?void 0:og.md,swatch:{"--swatch-size":"sizes.7"},trigger:{"--input-height":"sizes.10"},area:{"--thumb-size":"sizes.3.5"},channelSlider:{"--slider-height":"sizes.3.5","--thumb-size":"sizes.3.5"}},lg:{channelInput:null===(sg=Ma.variants)||void 0===sg||null===(sg=sg.size)||void 0===sg?void 0:sg.lg,swatch:{"--swatch-size":"sizes.7"},trigger:{"--input-height":"sizes.11"},area:{"--thumb-size":"sizes.3.5"},channelSlider:{"--slider-height":"sizes.3.5","--thumb-size":"sizes.3.5"}},xl:{channelInput:null===(lg=Ma.variants)||void 0===lg||null===(lg=lg.size)||void 0===lg?void 0:lg.xl,swatch:{"--swatch-size":"sizes.8"},trigger:{"--input-height":"sizes.12"},area:{"--thumb-size":"sizes.3.5"},channelSlider:{"--slider-height":"sizes.3.5","--thumb-size":"sizes.3.5"}},"2xl":{channelInput:null===(cg=Ma.variants)||void 0===cg||null===(cg=cg.size)||void 0===cg?void 0:cg["2xl"],swatch:{"--swatch-size":"sizes.10"},trigger:{"--input-height":"sizes.16"},area:{"--thumb-size":"sizes.3.5"},channelSlider:{"--slider-height":"sizes.3.5","--thumb-size":"sizes.3.5"}}},variant:{outline:{channelInput:null===(dg=Ma.variants)||void 0===dg||null===(dg=dg.variant)||void 0===dg?void 0:dg.outline,trigger:{borderWidth:"1px"}},subtle:{channelInput:null===(ug=Ma.variants)||void 0===ug||null===(ug=ug.variant)||void 0===ug?void 0:ug.subtle,trigger:{borderWidth:"1px",borderColor:"transparent",bg:"bg.muted"}}}},defaultVariants:{size:"md",variant:"outline"}},pg={className:"chakra-combobox",slots:lm.keys(),base:{root:{display:"flex",flexDirection:"column",gap:"1.5",width:"full"},label:{fontWeight:"medium",userSelect:"none",textStyle:"sm",_disabled:{layerStyle:"disabled"}},input:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"bg.panel",width:"full",minH:"var(--combobox-input-height)",px:"var(--combobox-input-padding-x)","--input-height":"var(--combobox-input-height)",borderRadius:"l2",outline:0,userSelect:"none",textAlign:"start",_placeholderShown:{color:"fg.muted"},_disabled:{layerStyle:"disabled"},"--focus-color":"colors.colorPalette.focusRing","--error-color":"colors.border.error",_invalid:{focusRingColor:"var(--error-color)",borderColor:"var(--error-color)"}},trigger:{display:"inline-flex",alignItems:"center",justifyContent:"center","--input-height":"var(--combobox-input-height)"},clearTrigger:{color:"fg.muted",pointerEvents:"auto",focusVisibleRing:"inside",focusRingWidth:"2px",rounded:"l1"},control:{pos:"relative"},indicatorGroup:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1",pos:"absolute",insetEnd:"0",top:"0",bottom:"0",px:"var(--combobox-input-padding-x)",_icon:{boxSize:"var(--combobox-indicator-size)"},"[data-disabled] &":{opacity:.5}},content:{background:"bg.panel",display:"flex",flexDirection:"column",zIndex:"dropdown",borderRadius:"l2",outline:0,maxH:"96",overflowY:"auto",boxShadow:"md",_open:{animationStyle:"slide-fade-in",animationDuration:"fast"},_closed:{animationStyle:"slide-fade-out",animationDuration:"0s"},"&[data-empty]:not(:has([data-scope=combobox][data-part=empty]))":{opacity:0}},item:{position:"relative",userSelect:"none",display:"flex",alignItems:"center",gap:"2",py:"var(--combobox-item-padding-y)",px:"var(--combobox-item-padding-x)",cursor:"option",justifyContent:"space-between",flex:"1",textAlign:"start",borderRadius:"l1",_highlighted:{bg:"bg.emphasized/60"},_disabled:{pointerEvents:"none",opacity:"0.5"},_icon:{boxSize:"var(--combobox-indicator-size)"}},empty:{py:"var(--combobox-item-padding-y)",px:"var(--combobox-item-padding-x)"},itemText:{flex:"1"},itemGroup:{pb:"var(--combobox-item-padding-y)",_last:{pb:"0"}},itemGroupLabel:{fontWeight:"medium",py:"var(--combobox-item-padding-y)",px:"var(--combobox-item-padding-x)"}},variants:{variant:{outline:{input:{bg:"transparent",borderWidth:"1px",borderColor:"border",focusVisibleRing:"inside"}},subtle:{input:{borderWidth:"1px",borderColor:"transparent",bg:"bg.muted",focusVisibleRing:"inside"}},flushed:{input:{bg:"transparent",borderBottomWidth:"1px",borderBottomColor:"border",borderRadius:"0",px:"0",_focusVisible:{borderColor:"var(--focus-color)",boxShadow:"0px 1px 0px 0px var(--focus-color)"}},indicatorGroup:{px:"0"}}},size:{xs:{root:{"--combobox-input-height":"sizes.8","--combobox-input-padding-x":"spacing.2","--combobox-indicator-size":"sizes.3.5"},input:{textStyle:"xs"},content:{"--combobox-item-padding-x":"spacing.1.5","--combobox-item-padding-y":"spacing.1","--combobox-indicator-size":"sizes.3.5",p:"1",textStyle:"xs"},trigger:{textStyle:"xs",gap:"1"}},sm:{root:{"--combobox-input-height":"sizes.9","--combobox-input-padding-x":"spacing.2.5","--combobox-indicator-size":"sizes.4"},input:{textStyle:"sm"},content:{"--combobox-item-padding-x":"spacing.2","--combobox-item-padding-y":"spacing.1.5","--combobox-indicator-size":"sizes.4",p:"1",textStyle:"sm"},trigger:{textStyle:"sm",gap:"1"}},md:{root:{"--combobox-input-height":"sizes.10","--combobox-input-padding-x":"spacing.3","--combobox-indicator-size":"sizes.4"},input:{textStyle:"sm"},content:{"--combobox-item-padding-x":"spacing.2","--combobox-item-padding-y":"spacing.1.5","--combobox-indicator-size":"sizes.4",p:"1",textStyle:"sm"},itemIndicator:{display:"flex",alignItems:"center",justifyContent:"center"},trigger:{textStyle:"sm",gap:"2"}},lg:{root:{"--combobox-input-height":"sizes.12","--combobox-input-padding-x":"spacing.4","--combobox-indicator-size":"sizes.5"},input:{textStyle:"md"},content:{"--combobox-item-padding-y":"spacing.2","--combobox-item-padding-x":"spacing.3","--combobox-indicator-size":"sizes.5",p:"1.5",textStyle:"md"},trigger:{textStyle:"md",py:"3",gap:"2"}}}},defaultVariants:{size:"md",variant:"outline"}},fg={slots:qf.keys(),className:"chakra-data-list",base:{itemLabel:{display:"flex",alignItems:"center",gap:"1"},itemValue:{display:"flex",minWidth:"0",flex:"1"}},variants:{orientation:{horizontal:{root:{display:"flex",flexDirection:"column"},item:{display:"inline-flex",alignItems:"center",gap:"4"},itemLabel:{minWidth:"120px"}},vertical:{root:{display:"flex",flexDirection:"column"},item:{display:"flex",flexDirection:"column",gap:"1"}}},size:{sm:{root:{gap:"3"},item:{textStyle:"xs"}},md:{root:{gap:"4"},item:{textStyle:"sm"}},lg:{root:{gap:"5"},item:{textStyle:"md"}}},variant:{subtle:{itemLabel:{color:"fg.muted"}},bold:{itemLabel:{fontWeight:"medium"},itemValue:{color:"fg.muted"}}}},defaultVariants:{size:"md",orientation:"vertical",variant:"subtle"}},mg={slots:Xf.keys(),className:"chakra-dialog",base:{backdrop:{bg:"blackAlpha.500",pos:"fixed",left:0,top:0,w:"100dvw",h:"100dvh",zIndex:"var(--z-index)",_open:{animationName:"fade-in",animationDuration:"slow"},_closed:{animationName:"fade-out",animationDuration:"moderate"}},positioner:{display:"flex",width:"100dvw",height:"100dvh",position:"fixed",left:0,top:0,"--dialog-z-index":"zIndex.modal",zIndex:"calc(var(--dialog-z-index) + var(--layer-index, 0))",justifyContent:"center",overscrollBehaviorY:"none"},content:{display:"flex",flexDirection:"column",position:"relative",width:"100%",outline:0,borderRadius:"l3",textStyle:"sm",my:"var(--dialog-margin, var(--dialog-base-margin))","--dialog-z-index":"zIndex.modal",zIndex:"calc(var(--dialog-z-index) + var(--layer-index, 0))",bg:"bg.panel",boxShadow:"lg",_open:{animationDuration:"moderate"},_closed:{animationDuration:"faster"}},header:{display:"flex",gap:"2",flex:0,px:"6",pt:"6",pb:"4"},body:{flex:"1",px:"6",pt:"2",pb:"6"},footer:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"3",px:"6",pt:"2",pb:"4"},title:{textStyle:"lg",fontWeight:"semibold"},description:{color:"fg.muted"},closeTrigger:{pos:"absolute",top:"2",insetEnd:"2"}},variants:{placement:{center:{positioner:{alignItems:"center"},content:{"--dialog-base-margin":"auto",mx:"auto"}},top:{positioner:{alignItems:"flex-start"},content:{"--dialog-base-margin":"spacing.16",mx:"auto"}},bottom:{positioner:{alignItems:"flex-end"},content:{"--dialog-base-margin":"spacing.16",mx:"auto"}}},scrollBehavior:{inside:{positioner:{overflow:"hidden"},content:{maxH:"calc(100% - 7.5rem)"},body:{overflow:"auto"}},outside:{positioner:{overflow:"auto",pointerEvents:"auto"}}},size:{xs:{content:{maxW:"sm"}},sm:{content:{maxW:"md"}},md:{content:{maxW:"lg"}},lg:{content:{maxW:"2xl"}},xl:{content:{maxW:"4xl"}},cover:{positioner:{padding:"10"},content:{width:"100%",height:"100%","--dialog-margin":"0"}},full:{content:{maxW:"100dvw",minH:"100dvh","--dialog-margin":"0",borderRadius:"0"}}},motionPreset:{scale:{content:{_open:{animationName:"scale-in, fade-in"},_closed:{animationName:"scale-out, fade-out"}}},"slide-in-bottom":{content:{_open:{animationName:"slide-from-bottom, fade-in"},_closed:{animationName:"slide-to-bottom, fade-out"}}},"slide-in-top":{content:{_open:{animationName:"slide-from-top, fade-in"},_closed:{animationName:"slide-to-top, fade-out"}}},"slide-in-left":{content:{_open:{animationName:"slide-from-left, fade-in"},_closed:{animationName:"slide-to-left, fade-out"}}},"slide-in-right":{content:{_open:{animationName:"slide-from-right, fade-in"},_closed:{animationName:"slide-to-right, fade-out"}}},none:{}}},defaultVariants:{size:"md",scrollBehavior:"outside",placement:"top",motionPreset:"scale"}},gg={slots:Yf.keys(),className:"chakra-drawer",base:{backdrop:{bg:"blackAlpha.500",pos:"fixed",insetInlineStart:0,top:0,w:"100vw",h:"100dvh",zIndex:"overlay",_open:{animationName:"fade-in",animationDuration:"slow"},_closed:{animationName:"fade-out",animationDuration:"moderate"}},positioner:{display:"flex",width:"100vw",height:"100dvh",position:"fixed",insetInlineStart:0,top:0,zIndex:"modal",overscrollBehaviorY:"none"},content:{display:"flex",flexDirection:"column",position:"relative",width:"100%",outline:0,zIndex:"modal",textStyle:"sm",maxH:"100dvh",color:"inherit",bg:"bg.panel",boxShadow:"lg",_open:{animationDuration:"slowest",animationTimingFunction:"ease-in-smooth"},_closed:{animationDuration:"slower",animationTimingFunction:"ease-in-smooth"}},header:{display:"flex",alignItems:"center",gap:"2",flex:0,px:"6",pt:"6",pb:"4"},body:{px:"6",py:"2",flex:"1",overflow:"auto"},footer:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"3",px:"6",pt:"2",pb:"4"},title:{flex:"1",textStyle:"lg",fontWeight:"semibold"},description:{color:"fg.muted"},closeTrigger:{pos:"absolute",top:"3",insetEnd:"2"}},variants:{size:{xs:{content:{maxW:"xs"}},sm:{content:{maxW:"md"}},md:{content:{maxW:"lg"}},lg:{content:{maxW:"2xl"}},xl:{content:{maxW:"4xl"}},full:{content:{maxW:"100vw",h:"100dvh"}}},placement:{start:{positioner:{justifyContent:"flex-start",alignItems:"stretch"},content:{_open:{animationName:{base:"slide-from-left-full, fade-in",_rtl:"slide-from-right-full, fade-in"}},_closed:{animationName:{base:"slide-to-left-full, fade-out",_rtl:"slide-to-right-full, fade-out"}}}},end:{positioner:{justifyContent:"flex-end",alignItems:"stretch"},content:{_open:{animationName:{base:"slide-from-right-full, fade-in",_rtl:"slide-from-left-full, fade-in"}},_closed:{animationName:{base:"slide-to-right-full, fade-out",_rtl:"slide-to-left-full, fade-out"}}}},top:{positioner:{justifyContent:"stretch",alignItems:"flex-start"},content:{maxW:"100%",_open:{animationName:"slide-from-top-full, fade-in"},_closed:{animationName:"slide-to-top-full, fade-out"}}},bottom:{positioner:{justifyContent:"stretch",alignItems:"flex-end"},content:{maxW:"100%",_open:{animationName:"slide-from-bottom-full, fade-in"},_closed:{animationName:"slide-to-bottom-full, fade-out"}}}},contained:{true:{positioner:{padding:"4"},content:{borderRadius:"l3"}}}},defaultVariants:{size:"xs",placement:"end"}},vg={fontSize:"inherit",fontWeight:"inherit",textAlign:"inherit",bg:"transparent",borderRadius:"l2"},yg={slots:Qf.keys(),className:"chakra-editable",base:{root:{display:"inline-flex",alignItems:"center",position:"relative",gap:"1.5",width:"full"},preview:c(c({},vg),{},{py:"1",px:"1",display:"inline-flex",alignItems:"center",transitionProperty:"common",transitionDuration:"moderate",cursor:"text",_hover:{bg:"bg.muted"},_disabled:{userSelect:"none"}}),input:c(c({},vg),{},{outline:"0",py:"1",px:"1",transitionProperty:"common",transitionDuration:"normal",width:"full",focusVisibleRing:"inside",focusRingWidth:"2px",_placeholder:{opacity:.6}}),control:{display:"inline-flex",alignItems:"center",gap:"1.5"}},variants:{size:{sm:{root:{textStyle:"sm"},preview:{minH:"8"},input:{minH:"8"}},md:{root:{textStyle:"sm"},preview:{minH:"9"},input:{minH:"9"}},lg:{root:{textStyle:"md"},preview:{minH:"10"},input:{minH:"10"}}}},defaultVariants:{size:"md"}},bg={slots:Kf.keys(),className:"chakra-empty-state",base:{root:{width:"full"},content:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},indicator:{display:"flex",alignItems:"center",justifyContent:"center",color:"fg.subtle",_icon:{boxSize:"1em"}},title:{fontWeight:"semibold"},description:{textStyle:"sm",color:"fg.muted"}},variants:{size:{sm:{root:{px:"4",py:"6"},title:{textStyle:"md"},content:{gap:"4"},indicator:{textStyle:"2xl"}},md:{root:{px:"8",py:"12"},title:{textStyle:"lg"},content:{gap:"6"},indicator:{textStyle:"4xl"}},lg:{root:{px:"12",py:"16"},title:{textStyle:"xl"},content:{gap:"8"},indicator:{textStyle:"6xl"}}}},defaultVariants:{size:"md"}},xg={className:"chakra-field",slots:Zf.keys(),base:{requiredIndicator:{color:"fg.error",lineHeight:"1"},root:{display:"flex",width:"100%",position:"relative",gap:"1.5"},label:{display:"flex",alignItems:"center",textAlign:"start",textStyle:"sm",fontWeight:"medium",gap:"1",userSelect:"none",_disabled:{opacity:"0.5"}},errorText:{display:"inline-flex",alignItems:"center",fontWeight:"medium",gap:"1",color:"fg.error",textStyle:"xs"},helperText:{color:"fg.muted",textStyle:"xs"}},variants:{orientation:{vertical:{root:{flexDirection:"column",alignItems:"flex-start"}},horizontal:{root:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},label:{flex:"0 0 var(--field-label-width, 80px)"}}}},defaultVariants:{orientation:"vertical"}},wg={className:"fieldset",slots:Jf.keys(),base:{root:{display:"flex",flexDirection:"column",width:"full"},content:{display:"flex",flexDirection:"column",width:"full"},legend:{color:"fg",fontWeight:"medium",_disabled:{opacity:"0.5"}},helperText:{color:"fg.muted",textStyle:"sm"},errorText:{display:"inline-flex",alignItems:"center",color:"fg.error",gap:"2",fontWeight:"medium",textStyle:"sm"}},variants:{size:{sm:{root:{spaceY:"2"},content:{gap:"1.5"},legend:{textStyle:"sm"}},md:{root:{spaceY:"4"},content:{gap:"4"},legend:{textStyle:"sm"}},lg:{root:{spaceY:"6"},content:{gap:"4"},legend:{textStyle:"md"}}}},defaultVariants:{size:"md"}},Sg={className:"chakra-file-upload",slots:$f.keys(),base:{root:{display:"flex",flexDirection:"column",gap:"4",width:"100%",alignItems:"flex-start"},label:{fontWeight:"medium",textStyle:"sm"},dropzone:{background:"bg",borderRadius:"l3",borderWidth:"2px",borderStyle:"dashed",display:"flex",alignItems:"center",flexDirection:"column",gap:"4",justifyContent:"center",minHeight:"2xs",px:"3",py:"2",transition:"backgrounds",focusVisibleRing:"outside",_hover:{bg:"bg.subtle"},_dragging:{bg:"colorPalette.subtle",borderStyle:"solid",borderColor:"colorPalette.solid"}},dropzoneContent:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"1",textStyle:"sm"},item:{pos:"relative",textStyle:"sm",animationName:"fade-in",animationDuration:"moderate",background:"bg",borderRadius:"l2",borderWidth:"1px",width:"100%",display:"flex",alignItems:"center",gap:"3",p:"4"},itemGroup:{width:"100%",display:"flex",flexDirection:"column",gap:"3",_empty:{display:"none"}},itemName:{color:"fg",fontWeight:"medium",lineClamp:"1"},itemContent:{display:"flex",flexDirection:"column",gap:"0.5",flex:"1"},itemSizeText:{color:"fg.muted",textStyle:"xs"},itemDeleteTrigger:{display:"flex",alignItems:"center",justifyContent:"center",alignSelf:"flex-start",boxSize:"5",p:"2px",color:"fg.muted",cursor:"button"},itemPreview:{color:"fg.muted",_icon:{boxSize:"4.5"}}},defaultVariants:{}};var _g=ka("hoverCard").parts("arrow","arrowTip","trigger","positioner","content"),Cg=(_g.build(),e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.trigger)&&void 0!==t?t:"hover-card:".concat(e.id,":trigger")}),Eg=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.content)&&void 0!==t?t:"hover-card:".concat(e.id,":content")},Ag=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.positioner)&&void 0!==t?t:"hover-card:".concat(e.id,":popper")},Mg=e=>e.getById(Cg(e)),Tg=e=>e.getById(Ag(e));var{not:Pg,and:Dg}=Qd(),Og=(Dg("isOpenControlled",Pg("isPointer")),Pg("isPointer"),Dg("isOpenControlled",Pg("isPointer")),Pg("isPointer"),pu()(["closeDelay","dir","getRootNode","id","ids","onOpenChange","defaultOpen","open","openDelay","positioning","onInteractOutside","onPointerDownOutside","onFocusOutside"]));Ro(Og);const Ig={className:"chakra-hover-card",slots:_g.keys(),base:{content:{position:"relative",display:"flex",flexDirection:"column",textStyle:"sm","--hovercard-bg":"colors.bg.panel",bg:"var(--hovercard-bg)",boxShadow:"lg",maxWidth:"80",borderRadius:"l3",zIndex:"popover",transformOrigin:"var(--transform-origin)",outline:"0",_open:{animationStyle:"slide-fade-in",animationDuration:"fast"},_closed:{animationStyle:"slide-fade-out",animationDuration:"faster"}},arrow:{"--arrow-size":"sizes.3","--arrow-background":"var(--hovercard-bg)"},arrowTip:{borderTopWidth:"0.5px",borderInlineStartWidth:"0.5px"}},variants:{size:{xs:{content:{padding:"3"}},sm:{content:{padding:"4"}},md:{content:{padding:"5"}},lg:{content:{padding:"6"}}}},defaultVariants:{size:"md"}},kg={className:"chakra-list",slots:em.keys(),base:{root:{display:"flex",flexDirection:"column",gap:"var(--list-gap)","& :where(ul, ol)":{marginTop:"var(--list-gap)"}},item:{whiteSpace:"normal",display:"list-item"},indicator:{marginEnd:"2",minHeight:"1lh",flexShrink:0,display:"inline-block",verticalAlign:"middle"}},variants:{variant:{marker:{root:{listStyle:"revert"},item:{_marker:{color:"fg.subtle"}}},plain:{item:{alignItems:"flex-start",display:"inline-flex"}}},align:{center:{item:{alignItems:"center"}},start:{item:{alignItems:"flex-start"}},end:{item:{alignItems:"flex-end"}}}},defaultVariants:{variant:"marker"}},Rg={className:"chakra-menu",slots:tm.keys(),base:{content:{outline:0,bg:"bg.panel",boxShadow:"lg",color:"fg",maxHeight:"var(--available-height)","--menu-z-index":"zIndex.dropdown",zIndex:"calc(var(--menu-z-index) + var(--layer-index, 0))",borderRadius:"l2",overflow:"hidden",overflowY:"auto",_open:{animationStyle:"slide-fade-in",animationDuration:"fast"},_closed:{animationStyle:"slide-fade-out",animationDuration:"faster"}},item:{textDecoration:"none",color:"fg",userSelect:"none",borderRadius:"l1",width:"100%",display:"flex",cursor:"menuitem",alignItems:"center",textAlign:"start",position:"relative",flex:"0 0 auto",outline:0,_disabled:{layerStyle:"disabled"},"&[data-type]":{ps:"8"}},itemText:{flex:"1"},itemIndicator:{position:"absolute",insetStart:"2",transform:"translateY(-50%)",top:"50%"},itemGroupLabel:{px:"2",py:"1.5",fontWeight:"semibold",textStyle:"sm"},indicator:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:"0"},itemCommand:{opacity:"0.6",textStyle:"xs",ms:"auto",ps:"4",letterSpacing:"widest",fontFamily:"inherit"},separator:{height:"1px",bg:"bg.muted",my:"1",mx:"-1"}},variants:{variant:{subtle:{item:{_highlighted:{bg:"bg.emphasized/60"}}},solid:{item:{_highlighted:{bg:"colorPalette.solid",color:"colorPalette.contrast"}}}},size:{sm:{content:{minW:"8rem",padding:"1"},item:{gap:"1",textStyle:"xs",py:"1",px:"1.5"}},md:{content:{minW:"8rem",padding:"1.5"},item:{gap:"2",textStyle:"sm",py:"1.5",px:"2"}}}},defaultVariants:{size:"md",variant:"subtle"}},zg={className:"chakra-select",slots:sm.keys(),base:{root:{display:"flex",flexDirection:"column",gap:"1.5",width:"full"},trigger:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"full",minH:"var(--select-trigger-height)","--input-height":"var(--select-trigger-height)",px:"var(--select-trigger-padding-x)",borderRadius:"l2",userSelect:"none",textAlign:"start",focusVisibleRing:"inside",_placeholderShown:{color:"fg.muted/80"},_disabled:{layerStyle:"disabled"},_invalid:{borderColor:"border.error"}},indicatorGroup:{display:"flex",alignItems:"center",gap:"1",pos:"absolute",insetEnd:"0",top:"0",bottom:"0",px:"var(--select-trigger-padding-x)",pointerEvents:"none"},indicator:{display:"flex",alignItems:"center",justifyContent:"center",color:{base:"fg.muted",_disabled:"fg.subtle",_invalid:"fg.error"}},content:{background:"bg.panel",display:"flex",flexDirection:"column",zIndex:"dropdown",borderRadius:"l2",outline:0,maxH:"96",overflowY:"auto",boxShadow:"md",_open:{animationStyle:"slide-fade-in",animationDuration:"fast"},_closed:{animationStyle:"slide-fade-out",animationDuration:"fastest"}},item:{position:"relative",userSelect:"none",display:"flex",alignItems:"center",gap:"2",cursor:"option",justifyContent:"space-between",flex:"1",textAlign:"start",borderRadius:"l1",_highlighted:{bg:"bg.emphasized/60"},_disabled:{pointerEvents:"none",opacity:"0.5"},_icon:{width:"4",height:"4"}},control:{pos:"relative"},itemText:{flex:"1"},itemGroup:{_first:{mt:"0"}},itemGroupLabel:{py:"1",fontWeight:"medium"},label:{fontWeight:"medium",userSelect:"none",textStyle:"sm",_disabled:{layerStyle:"disabled"}},valueText:{lineClamp:"1",maxW:"80%"},clearTrigger:{color:"fg.muted",pointerEvents:"auto",focusVisibleRing:"inside",focusRingWidth:"2px",rounded:"l1"}},variants:{variant:{outline:{trigger:{bg:"transparent",borderWidth:"1px",borderColor:"border",_expanded:{borderColor:"border.emphasized"}}},subtle:{trigger:{borderWidth:"1px",borderColor:"transparent",bg:"bg.muted"}}},size:{xs:{root:{"--select-trigger-height":"sizes.8","--select-trigger-padding-x":"spacing.2"},content:{p:"1",gap:"1",textStyle:"xs"},trigger:{textStyle:"xs",gap:"1"},item:{py:"1",px:"2"},itemGroupLabel:{py:"1",px:"2"},indicator:{_icon:{width:"3.5",height:"3.5"}}},sm:{root:{"--select-trigger-height":"sizes.9","--select-trigger-padding-x":"spacing.2.5"},content:{p:"1",textStyle:"sm"},trigger:{textStyle:"sm",gap:"1"},indicator:{_icon:{width:"4",height:"4"}},item:{py:"1",px:"1.5"},itemGroup:{mt:"1"},itemGroupLabel:{py:"1",px:"1.5"}},md:{root:{"--select-trigger-height":"sizes.10","--select-trigger-padding-x":"spacing.3"},content:{p:"1",textStyle:"sm"},itemGroup:{mt:"1.5"},item:{py:"1.5",px:"2"},itemIndicator:{display:"flex",alignItems:"center",justifyContent:"center"},itemGroupLabel:{py:"1.5",px:"2"},trigger:{textStyle:"sm",gap:"2"},indicator:{_icon:{width:"4",height:"4"}}},lg:{root:{"--select-trigger-height":"sizes.12","--select-trigger-padding-x":"spacing.4"},content:{p:"1.5",textStyle:"md"},itemGroup:{mt:"2"},item:{py:"2",px:"3"},itemGroupLabel:{py:"2",px:"3"},trigger:{textStyle:"md",py:"3",gap:"2"},indicator:{_icon:{width:"5",height:"5"}}}}},defaultVariants:{size:"md",variant:"outline"}};var Lg,Bg;const Ng={className:"chakra-native-select",slots:im.keys(),base:{root:{height:"fit-content",display:"flex",width:"100%",position:"relative"},field:{width:"100%",minWidth:"0",outline:"0",appearance:"none",borderRadius:"l2","--error-color":"colors.border.error","--input-height":"var(--select-field-height)",height:"var(--select-field-height)",_disabled:{layerStyle:"disabled"},_invalid:{focusRingColor:"var(--error-color)",borderColor:"var(--error-color)"},focusVisibleRing:"inside",lineHeight:"normal","& > option, & > optgroup":{bg:"bg"}},indicator:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)",height:"100%",color:"fg.muted",_disabled:{opacity:"0.5"},_invalid:{color:"fg.error"},_icon:{width:"1em",height:"1em"}}},variants:{variant:{outline:{field:null===(Lg=zg.variants)||void 0===Lg?void 0:Lg.variant.outline.trigger},subtle:{field:null===(Bg=zg.variants)||void 0===Bg?void 0:Bg.variant.subtle.trigger},plain:{field:{bg:"transparent",color:"fg",focusRingWidth:"2px"}}},size:{xs:{root:{"--select-field-height":"sizes.8"},field:{textStyle:"xs",ps:"2",pe:"6"},indicator:{textStyle:"sm",insetEnd:"1.5"}},sm:{root:{"--select-field-height":"sizes.9"},field:{textStyle:"sm",ps:"2.5",pe:"8"},indicator:{textStyle:"md",insetEnd:"2"}},md:{root:{"--select-field-height":"sizes.10"},field:{textStyle:"sm",ps:"3",pe:"8"},indicator:{textStyle:"lg",insetEnd:"2"}},lg:{root:{"--select-field-height":"sizes.11"},field:{textStyle:"md",ps:"4",pe:"8"},indicator:{textStyle:"xl",insetEnd:"3"}},xl:{root:{"--select-field-height":"sizes.12"},field:{textStyle:"md",ps:"4.5",pe:"10"},indicator:{textStyle:"xl",insetEnd:"3"}}}},defaultVariants:zg.defaultVariants};function Fg(e,t){const i={};for(const n in e){const r=t(n,e[n]);i[r[0]]=r[1]}return i}let Ug=new Map,Vg=!1;try{Vg="exceptZero"===new Intl.NumberFormat("de-DE",{signDisplay:"exceptZero"}).resolvedOptions().signDisplay}catch(Ene){}let jg=!1;try{jg="unit"===new Intl.NumberFormat("de-DE",{style:"unit",unit:"degree"}).resolvedOptions().style}catch(Ane){}const Wg={degree:{narrow:{default:"\xb0","ja-JP":" \u5ea6","zh-TW":"\u5ea6","sl-SI":" \xb0"}}};class Hg{format(e){let t="";if(t=Vg||null==this.options.signDisplay?this.numberFormatter.format(e):function(e,t,i){if("auto"===t)return e.format(i);if("never"===t)return e.format(Math.abs(i));{let n=!1;if("always"===t?n=i>0||Object.is(i,0):"exceptZero"===t&&(Object.is(i,-0)||Object.is(i,0)?i=Math.abs(i):n=i>0),n){let t=e.format(-i),n=e.format(i),r=t.replace(n,"").replace(/\u200e|\u061C/,"");return 1!==[...r].length&&console.warn("@react-aria/i18n polyfill for NumberFormat signDisplay: Unsupported case"),t.replace(n,"!!!").replace(r,"+").replace("!!!",n)}return e.format(i)}}(this.numberFormatter,this.options.signDisplay,e),"unit"===this.options.style&&!jg){var i;let{unit:e,unitDisplay:n="short",locale:r}=this.resolvedOptions();if(!e)return t;let a=null===(i=Wg[e])||void 0===i?void 0:i[n];t+=a[r]||a.default}return t}formatToParts(e){return this.numberFormatter.formatToParts(e)}formatRange(e,t){if("function"===typeof this.numberFormatter.formatRange)return this.numberFormatter.formatRange(e,t);if(t<e)throw new RangeError("End date must be >= start date");return"".concat(this.format(e)," \u2013 ").concat(this.format(t))}formatRangeToParts(e,t){if("function"===typeof this.numberFormatter.formatRangeToParts)return this.numberFormatter.formatRangeToParts(e,t);if(t<e)throw new RangeError("End date must be >= start date");let i=this.numberFormatter.formatToParts(e),n=this.numberFormatter.formatToParts(t);return[...i.map(e=>c(c({},e),{},{source:"startRange"})),{type:"literal",value:" \u2013 ",source:"shared"},...n.map(e=>c(c({},e),{},{source:"endRange"}))]}resolvedOptions(){let e=this.numberFormatter.resolvedOptions();return Vg||null==this.options.signDisplay||(e=c(c({},e),{},{signDisplay:this.options.signDisplay})),jg||"unit"!==this.options.style||(e=c(c({},e),{},{style:"unit",unit:this.options.unit,unitDisplay:this.options.unitDisplay})),e}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.numberFormatter=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{numberingSystem:i}=t;i&&e.includes("-nu-")&&(e.includes("-u-")||(e+="-u-"),e+="-nu-".concat(i));if("unit"===t.style&&!jg){var n;let{unit:e,unitDisplay:i="short"}=t;if(!e)throw new Error('unit option must be provided with style: "unit"');if(!(null===(n=Wg[e])||void 0===n?void 0:n[i]))throw new Error("Unsupported unit ".concat(e," with unitDisplay = ").concat(i));t=c(c({},t),{},{style:"decimal"})}let r=e+(t?Object.entries(t).sort((e,t)=>e[0]<t[0]?-1:1).join():"");if(Ug.has(r))return Ug.get(r);let a=new Intl.NumberFormat(e,t);return Ug.set(r,a),a}(e,t),this.options=t}}const Gg=new RegExp("^.*\\(.*\\).*$"),qg=["latn","arab","hanidec","deva","beng"];class Xg{parse(e){return Qg(this.locale,this.options,e).parse(e)}isValidPartialNumber(e,t,i){return Qg(this.locale,this.options,e).isValidPartialNumber(e,t,i)}getNumberingSystem(e){return Qg(this.locale,this.options,e).options.numberingSystem}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.locale=e,this.options=t}}const Yg=new Map;function Qg(e,t,i){let n=Kg(e,t);if(!e.includes("-nu-")&&!n.isValidPartialNumber(i))for(let r of qg)if(r!==n.options.numberingSystem){let n=Kg(e+(e.includes("-u-")?"-nu-":"-u-nu-")+r,t);if(n.isValidPartialNumber(i))return n}return n}function Kg(e,t){let i=e+(t?Object.entries(t).sort((e,t)=>e[0]<t[0]?-1:1).join():""),n=Yg.get(i);return n||(n=new Zg(e,t),Yg.set(i,n)),n}class Zg{parse(e){let t=this.sanitize(e);if(this.symbols.group&&(t=ev(t,this.symbols.group,"")),this.symbols.decimal&&(t=t.replace(this.symbols.decimal,".")),this.symbols.minusSign&&(t=t.replace(this.symbols.minusSign,"-")),t=t.replace(this.symbols.numeral,this.symbols.index),"percent"===this.options.style){let e=t.indexOf("-");t=t.replace("-",""),t=t.replace("+","");let i=t.indexOf(".");-1===i&&(i=t.length),t=t.replace(".",""),t=i-2===0?"0.".concat(t):i-2===-1?"0.0".concat(t):i-2===-2?"0.00":"".concat(t.slice(0,i-2),".").concat(t.slice(i-2)),e>-1&&(t="-".concat(t))}let i=t?+t:NaN;if(isNaN(i))return NaN;if("percent"===this.options.style){var n,r;let e=c(c({},this.options),{},{style:"decimal",minimumFractionDigits:Math.min((null!==(n=this.options.minimumFractionDigits)&&void 0!==n?n:0)+2,20),maximumFractionDigits:Math.min((null!==(r=this.options.maximumFractionDigits)&&void 0!==r?r:0)+2,20)});return new Xg(this.locale,e).parse(new Hg(this.locale,e).format(i))}return"accounting"===this.options.currencySign&&Gg.test(e)&&(i*=-1),i}sanitize(e){return e=e.replace(this.symbols.literals,""),this.symbols.minusSign&&(e=e.replace("-",this.symbols.minusSign)),"arab"===this.options.numberingSystem&&(this.symbols.decimal&&(e=(e=e.replace(",",this.symbols.decimal)).replace(String.fromCharCode(1548),this.symbols.decimal)),this.symbols.group&&(e=ev(e,".",this.symbols.group))),"fr-FR"===this.options.locale&&this.symbols.group&&(e=ev(e," ",this.symbols.group),e=ev(e,/\u00A0/g,this.symbols.group)),e}isValidPartialNumber(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return e=this.sanitize(e),this.symbols.minusSign&&e.startsWith(this.symbols.minusSign)&&t<0?e=e.slice(this.symbols.minusSign.length):this.symbols.plusSign&&e.startsWith(this.symbols.plusSign)&&i>0&&(e=e.slice(this.symbols.plusSign.length)),(!this.symbols.group||!e.startsWith(this.symbols.group))&&(!(this.symbols.decimal&&e.indexOf(this.symbols.decimal)>-1&&0===this.options.maximumFractionDigits)&&(this.symbols.group&&(e=ev(e,this.symbols.group,"")),e=e.replace(this.symbols.numeral,""),this.symbols.decimal&&(e=e.replace(this.symbols.decimal,"")),0===e.length))}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i,n;this.locale=e,1!==t.roundingIncrement&&null!=t.roundingIncrement&&(null==t.maximumFractionDigits&&null==t.minimumFractionDigits?(t.maximumFractionDigits=0,t.minimumFractionDigits=0):null==t.maximumFractionDigits?t.maximumFractionDigits=t.minimumFractionDigits:null==t.minimumFractionDigits&&(t.minimumFractionDigits=t.maximumFractionDigits)),this.formatter=new Intl.NumberFormat(e,t),this.options=this.formatter.resolvedOptions(),this.symbols=function(e,t,i,n){var r,a,o,s;let l=new Intl.NumberFormat(e,c(c({},i),{},{minimumSignificantDigits:1,maximumSignificantDigits:21,roundingIncrement:1,roundingPriority:"auto",roundingMode:"halfExpand"})),d=l.formatToParts(-10000.111),u=l.formatToParts(10000.111),h=$g.map(e=>l.formatToParts(e));var p;let f=null!==(p=null===(r=d.find(e=>"minusSign"===e.type))||void 0===r?void 0:r.value)&&void 0!==p?p:"-",m=null===(a=u.find(e=>"plusSign"===e.type))||void 0===a?void 0:a.value;m||"exceptZero"!==(null===n||void 0===n?void 0:n.signDisplay)&&"always"!==(null===n||void 0===n?void 0:n.signDisplay)||(m="+");let g=new Intl.NumberFormat(e,c(c({},i),{},{minimumFractionDigits:2,maximumFractionDigits:2})).formatToParts(.001),v=null===(o=g.find(e=>"decimal"===e.type))||void 0===o?void 0:o.value,y=null===(s=d.find(e=>"group"===e.type))||void 0===s?void 0:s.value,b=d.filter(e=>!Jg.has(e.type)).map(e=>tv(e.value)),x=h.flatMap(e=>e.filter(e=>!Jg.has(e.type)).map(e=>tv(e.value))),w=[...new Set([...b,...x])].sort((e,t)=>t.length-e.length),S=0===w.length?new RegExp("[\\p{White_Space}]","gu"):new RegExp("".concat(w.join("|"),"|[\\p{White_Space}]"),"gu"),_=[...new Intl.NumberFormat(i.locale,{useGrouping:!1}).format(9876543210)].reverse(),C=new Map(_.map((e,t)=>[e,t])),E=new RegExp("[".concat(_.join(""),"]"),"g");return{minusSign:f,plusSign:m,decimal:v,group:y,literals:S,numeral:E,index:e=>String(C.get(e))}}(e,this.formatter,this.options,t),"percent"===this.options.style&&((null!==(i=this.options.minimumFractionDigits)&&void 0!==i?i:0)>18||(null!==(n=this.options.maximumFractionDigits)&&void 0!==n?n:0)>18)&&console.warn("NumberParser cannot handle percentages with greater than 18 decimal places, please reduce the number in your options.")}}const Jg=new Set(["decimal","fraction","integer","minusSign","plusSign","group"]),$g=[0,4,2,1,11,20,3,7,100,21,.1,1.1];function ev(e,t,i){return e.replaceAll?e.replaceAll(t,i):e.split(t).join(i)}function tv(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var iv=ka("numberInput").parts("root","label","input","control","valueText","incrementTrigger","decrementTrigger","scrubber"),nv=(iv.build(),e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.input)&&void 0!==t?t:"number-input:".concat(e.id,":input")}),rv=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.incrementTrigger)&&void 0!==t?t:"number-input:".concat(e.id,":inc")},av=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.decrementTrigger)&&void 0!==t?t:"number-input:".concat(e.id,":dec")},ov=e=>"number-input:".concat(e.id,":cursor"),sv=e=>e.getById(nv(e)),lv=e=>e.getDoc().getElementById(ov(e)),cv=(e,t)=>{let i=null;return"increment"===t&&(i=(e=>e.getById(rv(e)))(e)),"decrement"===t&&(i=(e=>e.getById(av(e)))(e)),i},dv=(e,t)=>{const i=e.getDoc(),n=i.createElement("div");n.className="scrubber--cursor",n.id=ov(e),Object.assign(n.style,{width:"15px",height:"15px",position:"fixed",pointerEvents:"none",left:"0px",top:"0px",zIndex:2147483647,transform:t?"translate3d(".concat(t.x,"px, ").concat(t.y,"px, 0px)"):void 0,willChange:"transform"}),n.innerHTML='\n      <svg width="46" height="15" style="left: -15.5px; position: absolute; top: 0; filter: drop-shadow(rgba(0, 0, 0, 0.4) 0px 1px 1.1px);">\n        <g transform="translate(2 3)">\n          <path fill-rule="evenodd" d="M 15 4.5L 15 2L 11.5 5.5L 15 9L 15 6.5L 31 6.5L 31 9L 34.5 5.5L 31 2L 31 4.5Z" style="stroke-width: 2px; stroke: white;"></path>\n          <path fill-rule="evenodd" d="M 15 4.5L 15 2L 11.5 5.5L 15 9L 15 6.5L 31 6.5L 31 9L 34.5 5.5L 31 2L 31 4.5Z"></path>\n        </g>\n      </svg>',i.body.appendChild(n)};var uv=(e,t)=>{const{prop:i,computed:n}=t;return i("formatOptions")?n("parser").parse(String(e)):parseFloat(e)},hv=(e,t)=>{const{prop:i,computed:n}=t;return Number.isNaN(e)?"":i("formatOptions")?n("formatter").format(e):e.toString()},{choose:pv,guards:fv,createMachine:mv}=Kd(),{not:gv,and:vv}=fv,yv=(mv({props(e){let{props:t}=e;const i=((e,t)=>{let i=void 0===e||Number.isNaN(e)?1:e;return"percent"!==(null===t||void 0===t?void 0:t.style)||void 0!==e&&!Number.isNaN(e)||(i=.01),i})(t.step,t.formatOptions);return c(c({dir:"ltr",locale:"en-US",focusInputOnChange:!0,clampValueOnBlur:!t.allowOverflow,allowOverflow:!1,inputMode:"decimal",pattern:"-?[0-9]*(.[0-9]+)?",defaultValue:"",step:i,min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,spinOnPress:!0},t),{},{translations:c({incrementLabel:"increment value",decrementLabel:"decrease value"},t.translations)})},initialState:()=>"idle",context(e){let{prop:t,bindable:i,getComputed:n}=e;return{value:i(()=>({defaultValue:t("defaultValue"),value:t("value"),onChange(e){var i;const r=n(),a=uv(e,{computed:r,prop:t});null===(i=t("onValueChange"))||void 0===i||i({value:e,valueAsNumber:a})}})),hint:i(()=>({defaultValue:null})),scrubberCursorPoint:i(()=>({defaultValue:null,hash:e=>e?"x:".concat(e.x,", y:").concat(e.y):""})),fieldsetDisabled:i(()=>({defaultValue:!1}))}},computed:{isRtl:e=>{let{prop:t}=e;return"rtl"===t("dir")},valueAsNumber:e=>{let{context:t,computed:i,prop:n}=e;return uv(t.get("value"),{computed:i,prop:n})},formattedValue:e=>{let{computed:t,prop:i}=e;return hv(t("valueAsNumber"),{computed:t,prop:i})},isAtMin:e=>{let{computed:t,prop:i}=e;return n=t("valueAsNumber"),r=i("min"),xo(n)<=r;var n,r},isAtMax:e=>{let{computed:t,prop:i}=e;return n=t("valueAsNumber"),r=i("max"),xo(n)>=r;var n,r},isOutOfRange:e=>{let{computed:t,prop:i}=e;return!So(t("valueAsNumber"),i("min"),i("max"))},isValueEmpty:e=>{let{context:t}=e;return""===t.get("value")},isDisabled:e=>{let{prop:t,context:i}=e;return!!t("disabled")||i.get("fieldsetDisabled")},canIncrement:e=>{let{prop:t,computed:i}=e;return t("allowOverflow")||!i("isAtMax")},canDecrement:e=>{let{prop:t,computed:i}=e;return t("allowOverflow")||!i("isAtMin")},valueText:e=>{var t,i;let{prop:n,context:r}=e;return null===(t=(i=n("translations")).valueText)||void 0===t?void 0:t.call(i,r.get("value"))},formatter:Yd(e=>{let{prop:t}=e;return[t("locale"),t("formatOptions")]},(e,t)=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Intl.NumberFormat(e,t)}(e,t)),parser:Yd(e=>{let{prop:t}=e;return[t("locale"),t("formatOptions")]},(e,t)=>function(e){return new Xg(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e,t))},watch(e){let{track:t,action:i,context:n,computed:r,prop:a}=e;t([()=>n.get("value"),()=>a("locale")],()=>{i(["syncInputElement"])}),t([()=>r("isOutOfRange")],()=>{i(["invokeOnInvalid"])}),t([()=>n.hash("scrubberCursorPoint")],()=>{i(["setVirtualCursorPosition"])})},effects:["trackFormControl"],on:{"VALUE.SET":{actions:["setRawValue"]},"VALUE.CLEAR":{actions:["clearValue"]},"VALUE.INCREMENT":{actions:["increment"]},"VALUE.DECREMENT":{actions:["decrement"]}},states:{idle:{on:{"TRIGGER.PRESS_DOWN":[{guard:"isTouchPointer",target:"before:spin",actions:["setHint"]},{target:"before:spin",actions:["focusInput","invokeOnFocus","setHint"]}],"SCRUBBER.PRESS_DOWN":{target:"scrubbing",actions:["focusInput","invokeOnFocus","setHint","setCursorPoint"]},"INPUT.FOCUS":{target:"focused",actions:["focusInput","invokeOnFocus"]}}},focused:{tags:["focus"],effects:["attachWheelListener"],on:{"TRIGGER.PRESS_DOWN":[{guard:"isTouchPointer",target:"before:spin",actions:["setHint"]},{target:"before:spin",actions:["focusInput","setHint"]}],"SCRUBBER.PRESS_DOWN":{target:"scrubbing",actions:["focusInput","setHint","setCursorPoint"]},"INPUT.ARROW_UP":{actions:["increment"]},"INPUT.ARROW_DOWN":{actions:["decrement"]},"INPUT.HOME":{actions:["decrementToMin"]},"INPUT.END":{actions:["incrementToMax"]},"INPUT.CHANGE":{actions:["setValue","setHint"]},"INPUT.BLUR":[{guard:vv("clampValueOnBlur",gv("isInRange")),target:"idle",actions:["setClampedValue","clearHint","invokeOnBlur"]},{guard:gv("isInRange"),target:"idle",actions:["setFormattedValue","clearHint","invokeOnBlur","invokeOnInvalid"]},{target:"idle",actions:["setFormattedValue","clearHint","invokeOnBlur"]}],"INPUT.ENTER":{actions:["setFormattedValue","clearHint","invokeOnBlur"]}}},"before:spin":{tags:["focus"],effects:["trackButtonDisabled","waitForChangeDelay"],entry:pv([{guard:"isIncrementHint",actions:["increment"]},{guard:"isDecrementHint",actions:["decrement"]}]),on:{CHANGE_DELAY:{target:"spinning",guard:vv("isInRange","spinOnPress")},"TRIGGER.PRESS_UP":[{guard:"isTouchPointer",target:"focused",actions:["clearHint"]},{target:"focused",actions:["focusInput","clearHint"]}]}},spinning:{tags:["focus"],effects:["trackButtonDisabled","spinValue"],on:{SPIN:[{guard:"isIncrementHint",actions:["increment"]},{guard:"isDecrementHint",actions:["decrement"]}],"TRIGGER.PRESS_UP":{target:"focused",actions:["focusInput","clearHint"]}}},scrubbing:{tags:["focus"],effects:["activatePointerLock","trackMousemove","setupVirtualCursor","preventTextSelection"],on:{"SCRUBBER.POINTER_UP":{target:"focused",actions:["focusInput","clearCursorPoint"]},"SCRUBBER.POINTER_MOVE":[{guard:"isIncrementHint",actions:["increment","setCursorPoint"]},{guard:"isDecrementHint",actions:["decrement","setCursorPoint"]}]}}},implementations:{guards:{clampValueOnBlur:e=>{let{prop:t}=e;return t("clampValueOnBlur")},spinOnPress:e=>{let{prop:t}=e;return!!t("spinOnPress")},isInRange:e=>{let{computed:t}=e;return!t("isOutOfRange")},isDecrementHint:e=>{var t;let{context:i,event:n}=e;return"decrement"===(null!==(t=n.hint)&&void 0!==t?t:i.get("hint"))},isIncrementHint:e=>{var t;let{context:i,event:n}=e;return"increment"===(null!==(t=n.hint)&&void 0!==t?t:i.get("hint"))},isTouchPointer:e=>{let{event:t}=e;return"touch"===t.pointerType}},effects:{waitForChangeDelay(e){let{send:t}=e;const i=setTimeout(()=>{t({type:"CHANGE_DELAY"})},300);return()=>clearTimeout(i)},spinValue(e){let{send:t}=e;const i=setInterval(()=>{t({type:"SPIN"})},50);return()=>clearInterval(i)},trackFormControl(e){let{context:t,scope:i}=e;return Ks(sv(i),{onFieldsetDisabledChange(e){t.set("fieldsetDisabled",e)},onFormReset(){t.set("value",t.initial("value"))}})},setupVirtualCursor(e){let{context:t,scope:i}=e;return((e,t)=>{if(!ks())return dv(e,t),()=>{var t;null===(t=lv(e))||void 0===t||t.remove()}})(i,t.get("scrubberCursorPoint"))},preventTextSelection(e){let{scope:t}=e;return(e=>{const t=e.getDoc(),i=t.documentElement,n=t.body;return n.style.pointerEvents="none",i.style.userSelect="none",i.style.cursor="ew-resize",()=>{n.style.pointerEvents="",i.style.userSelect="",i.style.cursor="",i.style.length||i.removeAttribute("style"),n.style.length||n.removeAttribute("style")}})(t)},trackButtonDisabled(e){let{context:t,scope:i,send:n}=e;const r=t.get("hint");return ol(cv(i,r),{attributes:["disabled"],callback(){n({type:"TRIGGER.PRESS_UP",src:"attr"})}})},attachWheelListener(e){let{scope:t,send:i,prop:n}=e;const r=sv(t);if(r&&t.isActiveElement(r)&&n("allowMouseWheel"))return js(r,"wheel",function(e){e.preventDefault();const t=-1*Math.sign(e.deltaY);1===t?i({type:"VALUE.INCREMENT"}):-1===t&&i({type:"VALUE.DECREMENT"})},{passive:!1})},activatePointerLock(e){let{scope:t}=e;if(!ks())return function(e,t){const i=e.body,n=()=>!!e.pointerLockElement;if(!("pointerLockElement"in e)&&!("mozPointerLockElement"in e))return;try{i.requestPointerLock()}catch(a){}const r=[js(e,"pointerlockchange",function(){null===t||void 0===t||t(n())},!1),js(e,"pointerlockerror",function(i){n()&&(null===t||void 0===t||t(!1)),console.error("PointerLock error occurred:",i),e.exitPointerLock()},!1)];return()=>{r.forEach(e=>e()),e.exitPointerLock()}}(t.getDoc())},trackMousemove(e){let{scope:t,send:i,context:n,computed:r}=e;const a=t.getDoc();return lo(js(a,"mousemove",function(e){const a=n.get("scrubberCursorPoint"),o=r("isRtl"),s=((e,t)=>{const{point:i,isRtl:n,event:r}=t,a=e.getWin(),o=Mo(r.movementX,a.devicePixelRatio),s=Mo(r.movementY,a.devicePixelRatio);let l=o>0?"increment":o<0?"decrement":null;n&&"increment"===l&&(l="decrement"),n&&"decrement"===l&&(l="increment");const c={x:i.x+o,y:i.y+s},d=a.innerWidth,u=Mo(7.5,a.devicePixelRatio);var h;return c.x=((c.x+u)%(h=d)+h)%h-u,{hint:l,point:c}})(t,{point:a,isRtl:o,event:e});s.hint&&i({type:"SCRUBBER.POINTER_MOVE",hint:s.hint,point:s.point})},!1),js(a,"mouseup",function(){i({type:"SCRUBBER.POINTER_UP"})},!1))}},actions:{focusInput(e){let{scope:t,prop:i}=e;if(!i("focusInputOnChange"))return;const n=sv(t);t.isActiveElement(n)||al(()=>null===n||void 0===n?void 0:n.focus({preventScroll:!0}))},increment(e){var t;let{context:i,event:n,prop:r,computed:a}=e,o=(s=a("valueAsNumber"),l=null!==(t=n.step)&&void 0!==t?t:r("step"),Io(xo(s),"+",l));var s,l;r("allowOverflow")||(o=_o(o,r("min"),r("max"))),i.set("value",hv(o,{computed:a,prop:r}))},decrement(e){var t;let{context:i,event:n,prop:r,computed:a}=e,o=(s=a("valueAsNumber"),l=null!==(t=n.step)&&void 0!==t?t:r("step"),Io(xo(s),"-",l));var s,l;r("allowOverflow")||(o=_o(o,r("min"),r("max"))),i.set("value",hv(o,{computed:a,prop:r}))},setClampedValue(e){let{context:t,prop:i,computed:n}=e;const r=_o(n("valueAsNumber"),i("min"),i("max"));t.set("value",hv(r,{computed:n,prop:i}))},setRawValue(e){let{context:t,event:i,prop:n,computed:r}=e,a=uv(i.value,{computed:r,prop:n});n("allowOverflow")||(a=_o(a,n("min"),n("max"))),t.set("value",hv(a,{computed:r,prop:n}))},setValue(e){var t,i;let{context:n,event:r}=e;const a=null!==(t=null===(i=r.target)||void 0===i?void 0:i.value)&&void 0!==t?t:r.value;n.set("value",a)},clearValue(e){let{context:t}=e;t.set("value","")},incrementToMax(e){let{context:t,prop:i,computed:n}=e;const r=hv(i("max"),{computed:n,prop:i});t.set("value",r)},decrementToMin(e){let{context:t,prop:i,computed:n}=e;const r=hv(i("min"),{computed:n,prop:i});t.set("value",r)},setHint(e){let{context:t,event:i}=e;t.set("hint",i.hint)},clearHint(e){let{context:t}=e;t.set("hint",null)},invokeOnFocus(e){var t;let{computed:i,prop:n}=e;null===(t=n("onFocusChange"))||void 0===t||t({focused:!0,value:i("formattedValue"),valueAsNumber:i("valueAsNumber")})},invokeOnBlur(e){var t;let{computed:i,prop:n}=e;null===(t=n("onFocusChange"))||void 0===t||t({focused:!1,value:i("formattedValue"),valueAsNumber:i("valueAsNumber")})},invokeOnInvalid(e){var t;let{computed:i,prop:n,event:r}=e;if("INPUT.CHANGE"===r.type)return;const a=i("valueAsNumber")>n("max")?"rangeOverflow":"rangeUnderflow";null===(t=n("onValueInvalid"))||void 0===t||t({reason:a,value:i("formattedValue"),valueAsNumber:i("valueAsNumber")})},syncInputElement(e){let{context:t,event:i,computed:n,scope:r}=e;const a=i.type.endsWith("CHANGE")?t.get("value"):n("formattedValue"),o=sv(r),s=function(e){if(e&&e.ownerDocument.activeElement===e)try{const{selectionStart:t,selectionEnd:i,value:n}=e,r=n.substring(0,t),a=n.substring(i);return{start:t,end:i,value:n,beforeTxt:r,afterTxt:a}}catch(Ane){}}(o);al(()=>{Hs(o,a),function(e,t){if(e&&e.ownerDocument.activeElement===e)if(t)try{const{value:i}=e,{beforeTxt:n="",afterTxt:r="",start:a}=t;let o=i.length;if(i.endsWith(r))o=i.length-r.length;else if(i.startsWith(n))o=n.length;else if(null!=a){const e=n[a-1],t=i.indexOf(e,a-1);-1!==t&&(o=t+1)}e.setSelectionRange(o,o)}catch(i){}else e.setSelectionRange(e.value.length,e.value.length)}(o,s)})},setFormattedValue(e){let{context:t,computed:i}=e;t.set("value",i("formattedValue"))},setCursorPoint(e){let{context:t,event:i}=e;t.set("scrubberCursorPoint",i.point)},clearCursorPoint(e){let{context:t}=e;t.set("scrubberCursorPoint",null)},setVirtualCursorPosition(e){let{context:t,scope:i}=e;const n=lv(i),r=t.get("scrubberCursorPoint");n&&r&&(n.style.transform="translate3d(".concat(r.x,"px, ").concat(r.y,"px, 0px)"))}}}}),pu()(["allowMouseWheel","allowOverflow","clampValueOnBlur","dir","disabled","focusInputOnChange","form","formatOptions","getRootNode","id","ids","inputMode","invalid","locale","max","min","name","onFocusChange","onValueChange","onValueInvalid","pattern","required","readOnly","spinOnPress","step","translations","value","defaultValue"]));Ro(yv);const bv={display:"flex",justifyContent:"center",alignItems:"center",flex:"1",userSelect:"none",cursor:"button",lineHeight:"1",color:"fg.muted","--stepper-base-radius":"radii.l1","--stepper-radius":"calc(var(--stepper-base-radius) + 1px)",_icon:{boxSize:"1em"},_disabled:{opacity:"0.5"},_hover:{bg:"bg.muted"},_active:{bg:"bg.emphasized"}},xv={className:"chakra-number-input",slots:iv.keys(),base:{root:{position:"relative",zIndex:"0",isolation:"isolate"},input:c(c({},Ma.base),{},{verticalAlign:"top",pe:"calc(var(--stepper-width) + 0.5rem)"}),control:{display:"flex",flexDirection:"column",position:"absolute",top:"0",insetEnd:"0px",margin:"1px",width:"var(--stepper-width)",height:"calc(100% - 2px)",zIndex:"1",borderStartWidth:"1px",divideY:"1px"},incrementTrigger:c(c({},bv),{},{borderTopEndRadius:"var(--stepper-radius)"}),decrementTrigger:c(c({},bv),{},{borderBottomEndRadius:"var(--stepper-radius)"}),valueText:{fontWeight:"medium",fontFeatureSettings:"pnum",fontVariantNumeric:"proportional-nums"}},variants:{size:{xs:{input:Ma.variants.size.xs,control:{fontSize:"2xs","--stepper-width":"sizes.4"}},sm:{input:Ma.variants.size.sm,control:{fontSize:"xs","--stepper-width":"sizes.5"}},md:{input:Ma.variants.size.md,control:{fontSize:"sm","--stepper-width":"sizes.6"}},lg:{input:Ma.variants.size.lg,control:{fontSize:"sm","--stepper-width":"sizes.6"}}},variant:Fg(Ma.variants.variant,(e,t)=>[e,{input:t}])},defaultVariants:{size:"md",variant:"outline"}};var wv=ka("pinInput").parts("root","label","input","control"),Sv=(wv.build(),e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.root)&&void 0!==t?t:"pin-input:".concat(e.id)}),_v=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.hiddenInput)&&void 0!==t?t:"pin-input:".concat(e.id,":hidden")},Cv=e=>{const t=CSS.escape(Sv(e)),i="input[data-ownedby=".concat(t,"]");return Sl((e=>e.getById(Sv(e)))(e),i)},Ev=(e,t)=>Cv(e)[t],Av=e=>e.getById(_v(e)),Mv=(e,t)=>{e.value=t,e.setAttribute("value",t)};var{choose:Tv,createMachine:Pv}=Kd();Pv({props(e){let{props:t}=e;return c(c({placeholder:"\u25cb",otp:!1,type:"numeric",defaultValue:t.count?Ov([],t.count):[]},t),{},{translations:c({inputLabel:(e,t)=>"pin code ".concat(e+1," of ").concat(t)},t.translations)})},initialState:()=>"idle",context(e){let{prop:t,bindable:i}=e;return{value:i(()=>({value:t("value"),defaultValue:t("defaultValue"),isEqual:Ya,onChange(e){var i;null===(i=t("onValueChange"))||void 0===i||i({value:e,valueAsString:e.join("")})}})),focusedIndex:i(()=>({sync:!0,defaultValue:-1})),count:i(()=>({defaultValue:t("count")}))}},computed:{_value:e=>{let{context:t}=e;return Ov(t.get("value"),t.get("count"))},valueLength:e=>{let{computed:t}=e;return t("_value").length},filledValueLength:e=>{let{computed:t}=e;return t("_value").filter(e=>""!==(null===e||void 0===e?void 0:e.trim())).length},isValueComplete:e=>{let{computed:t}=e;return t("valueLength")===t("filledValueLength")},valueAsString:e=>{let{computed:t}=e;return t("_value").join("")},focusedValue:e=>{let{computed:t,context:i}=e;return t("_value")[i.get("focusedIndex")]||""}},entry:Tv([{guard:"autoFocus",actions:["setInputCount","setFocusIndexToFirst"]},{actions:["setInputCount"]}]),watch(e){let{action:t,track:i,context:n,computed:r}=e;i([()=>n.get("focusedIndex")],()=>{t(["focusInput","selectInputIfNeeded"])}),i([()=>n.get("value").join(",")],()=>{t(["syncInputElements","dispatchInputEvent"])}),i([()=>r("isValueComplete")],()=>{t(["invokeOnComplete","blurFocusedInputIfNeeded"])})},on:{"VALUE.SET":[{guard:"hasIndex",actions:["setValueAtIndex"]},{actions:["setValue"]}],"VALUE.CLEAR":{actions:["clearValue","setFocusIndexToFirst"]}},states:{idle:{on:{"INPUT.FOCUS":{target:"focused",actions:["setFocusedIndex"]}}},focused:{on:{"INPUT.CHANGE":{actions:["setFocusedValue","syncInputValue","setNextFocusedIndex"]},"INPUT.PASTE":{actions:["setPastedValue","setLastValueFocusIndex"]},"INPUT.FOCUS":{actions:["setFocusedIndex"]},"INPUT.BLUR":{target:"idle",actions:["clearFocusedIndex"]},"INPUT.DELETE":{guard:"hasValue",actions:["clearFocusedValue"]},"INPUT.ARROW_LEFT":{actions:["setPrevFocusedIndex"]},"INPUT.ARROW_RIGHT":{actions:["setNextFocusedIndex"]},"INPUT.BACKSPACE":[{guard:"hasValue",actions:["clearFocusedValue"]},{actions:["setPrevFocusedIndex","clearFocusedValue"]}],"INPUT.ENTER":{guard:"isValueComplete",actions:["requestFormSubmit"]},"VALUE.INVALID":{actions:["invokeOnInvalid"]}}}},implementations:{guards:{autoFocus:e=>{let{prop:t}=e;return!!t("autoFocus")},hasValue:e=>{let{context:t}=e;return""!==t.get("value")[t.get("focusedIndex")]},isValueComplete:e=>{let{computed:t}=e;return t("isValueComplete")},hasIndex:e=>{let{event:t}=e;return void 0!==t.index}},actions:{dispatchInputEvent(e){let{computed:t,scope:i}=e;qs(Av(i),{value:t("valueAsString")})},setInputCount(e){let{scope:t,context:i,prop:n}=e;if(n("count"))return;const r=Cv(t);i.set("count",r.length)},focusInput(e){var t;let{context:i,scope:n}=e;const r=i.get("focusedIndex");-1!==r&&(null===(t=Ev(n,r))||void 0===t||t.focus({preventScroll:!0}))},selectInputIfNeeded(e){let{context:t,prop:i,scope:n}=e;const r=t.get("focusedIndex");i("selectOnFocus")&&-1!==r&&al(()=>{var e;null===(e=Ev(n,r))||void 0===e||e.select()})},invokeOnComplete(e){var t;let{computed:i,prop:n}=e;i("isValueComplete")&&(null===(t=n("onValueComplete"))||void 0===t||t({value:i("_value"),valueAsString:i("valueAsString")}))},invokeOnInvalid(e){var t;let{context:i,event:n,prop:r}=e;null===(t=r("onValueInvalid"))||void 0===t||t({value:n.value,index:i.get("focusedIndex")})},clearFocusedIndex(e){let{context:t}=e;t.set("focusedIndex",-1)},setFocusedIndex(e){let{context:t,event:i}=e;t.set("focusedIndex",i.index)},setValue(e){let{context:t,event:i}=e;const n=Ov(i.value,t.get("count"));t.set("value",n)},setFocusedValue(e){let{context:t,event:i,computed:n,flush:r}=e;const a=n("focusedValue"),o=t.get("focusedIndex"),s=Dv(a,i.value);r(()=>{t.set("value",Po(n("_value"),o,s))})},revertInputValue(e){let{context:t,computed:i,scope:n}=e;const r=Ev(n,t.get("focusedIndex"));Mv(r,i("focusedValue"))},syncInputValue(e){let{context:t,event:i,scope:n}=e;const r=t.get("value"),a=Ev(n,i.index);Mv(a,r[i.index])},syncInputElements(e){let{context:t,scope:i}=e;const n=Cv(i),r=t.get("value");n.forEach((e,t)=>{Mv(e,r[t])})},setPastedValue(e){let{context:t,event:i,computed:n,flush:r}=e;al(()=>{const e=n("valueAsString"),a=t.get("focusedIndex"),o=n("valueLength"),s=n("filledValueLength"),l=Math.min(a,s),c=l>0?e.substring(0,a):"",d=i.value.substring(0,o-l),u=Ov("".concat(c).concat(d).split(""),o);r(()=>{t.set("value",u)})})},setValueAtIndex(e){let{context:t,event:i,computed:n}=e;const r=Dv(n("focusedValue"),i.value);t.set("value",Po(n("_value"),i.index,r))},clearValue(e){let{context:t}=e;const i=Array.from({length:t.get("count")}).fill("");t.set("value",i)},clearFocusedValue(e){let{context:t,computed:i}=e;const n=t.get("focusedIndex");-1!==n&&t.set("value",Po(i("_value"),n,""))},setFocusIndexToFirst(e){let{context:t}=e;t.set("focusedIndex",0)},setNextFocusedIndex(e){let{context:t,computed:i}=e;t.set("focusedIndex",Math.min(t.get("focusedIndex")+1,i("valueLength")-1))},setPrevFocusedIndex(e){let{context:t}=e;t.set("focusedIndex",Math.max(t.get("focusedIndex")-1,0))},setLastValueFocusIndex(e){let{context:t,computed:i}=e;al(()=>{t.set("focusedIndex",Math.min(i("filledValueLength"),i("valueLength")-1))})},blurFocusedInputIfNeeded(e){let{context:t,prop:i,scope:n}=e;i("blurOnComplete")&&al(()=>{var e;null===(e=Ev(n,t.get("focusedIndex")))||void 0===e||e.blur()})},requestFormSubmit(e){var t;let{computed:i,prop:n,scope:r}=e;if(!n("name")||!i("isValueComplete"))return;const a=Av(r);null===a||void 0===a||null===(t=a.form)||void 0===t||t.requestSubmit()}}}});function Dv(e,t){let i=t;return e[0]===t[0]?i=t[1]:e[0]===t[1]&&(i=t[0]),i.split("")[i.length-1]}function Ov(e,t){return Array.from({length:t}).fill("").map((t,i)=>e[i]||t)}var Iv=pu()(["autoFocus","blurOnComplete","count","defaultValue","dir","disabled","form","getRootNode","id","ids","invalid","mask","name","onValueChange","onValueComplete","onValueInvalid","otp","pattern","placeholder","readOnly","required","selectOnFocus","translations","type","value"]);Ro(Iv);const{variants:kv,defaultVariants:Rv}=Ma,zv={className:"chakra-pin-input",slots:wv.keys(),base:{input:c(c({},Ma.base),{},{textAlign:"center",width:"var(--input-height)"}),control:{display:"inline-flex",gap:"2",isolation:"isolate"}},variants:{size:Fg(kv.size,(e,t)=>[e,{input:c(c({},t),{},{px:"1"})}]),variant:Fg(kv.variant,(e,t)=>[e,{input:t}]),attached:{true:{control:{gap:"0",spaceX:"-1px"},input:{_notFirst:{borderStartRadius:"0"},_notLast:{borderEndRadius:"0"},_focusVisible:{zIndex:"1"}}}}},defaultVariants:Rv},Lv={className:"chakra-popover",slots:nm.keys(),base:{content:{position:"relative",display:"flex",flexDirection:"column",textStyle:"sm","--popover-bg":"colors.bg.panel",bg:"var(--popover-bg)",boxShadow:"lg","--popover-size":"sizes.xs","--popover-mobile-size":"calc(100dvw - 1rem)",width:{base:"min(var(--popover-mobile-size), var(--popover-size))",sm:"var(--popover-size)"},borderRadius:"l3","--popover-z-index":"zIndex.popover",zIndex:"calc(var(--popover-z-index) + var(--layer-index, 0))",outline:"0",transformOrigin:"var(--transform-origin)",maxHeight:"var(--available-height)",_open:{animationStyle:"scale-fade-in",animationDuration:"fast"},_closed:{animationStyle:"scale-fade-out",animationDuration:"faster"}},header:{paddingInline:"var(--popover-padding)",paddingTop:"var(--popover-padding)"},body:{padding:"var(--popover-padding)",flex:"1"},footer:{display:"flex",alignItems:"center",paddingInline:"var(--popover-padding)",paddingBottom:"var(--popover-padding)"},arrow:{"--arrow-size":"sizes.3","--arrow-background":"var(--popover-bg)"},arrowTip:{borderTopWidth:"1px",borderInlineStartWidth:"1px"}},variants:{size:{xs:{content:{"--popover-padding":"spacing.3"}},sm:{content:{"--popover-padding":"spacing.4"}},md:{content:{"--popover-padding":"spacing.5"}},lg:{content:{"--popover-padding":"spacing.6"}}}},defaultVariants:{size:"md"}};var Bv=ka("progress").parts("root","label","track","range","valueText","view","circle","circleTrack","circleRange");Bv.build();Yd(e=>{let{prop:t}=e;return[t("locale"),t("formatOptions")]},(e,t)=>new Intl.NumberFormat(e,t));var Nv=e=>Ja(e)&&!isNaN(e),Fv=(e,t)=>Nv(e)&&e<=t,Uv=(e,t)=>Nv(e)&&e>=t,Vv=(e,t)=>e+(t-e)/2,jv=pu()(["dir","getRootNode","id","ids","max","min","orientation","translations","value","onValueChange","defaultValue","formatOptions","locale"]);Ro(jv);const Wv={slots:Bv.keys(),className:"chakra-progress",base:{root:{textStyle:"sm",position:"relative"},track:{overflow:"hidden",position:"relative"},range:{display:"flex",alignItems:"center",justifyContent:"center",transitionProperty:"width, height",transitionDuration:"slow",height:"100%",bgColor:"var(--track-color)",_indeterminate:{"--animate-from-x":"-40%","--animate-to-x":"100%",position:"absolute",willChange:"left",minWidth:"50%",animation:"position 1s ease infinite normal none running",backgroundImage:"linear-gradient(to right, transparent 0%, var(--track-color) 50%, transparent 100%)"}},label:{display:"inline-flex",fontWeight:"medium",alignItems:"center",gap:"1"},valueText:{textStyle:"xs",lineHeight:"1",fontWeight:"medium"}},variants:{variant:{outline:{track:{shadow:"inset",bgColor:"bg.muted"},range:{bgColor:"colorPalette.solid"}},subtle:{track:{bgColor:"colorPalette.muted"},range:{bgColor:"colorPalette.solid/72"}}},shape:{square:{},rounded:{track:{borderRadius:"l1"}},full:{track:{borderRadius:"full"}}},striped:{true:{range:{backgroundImage:"linear-gradient(45deg, var(--stripe-color) 25%, transparent 25%, transparent 50%, var(--stripe-color) 50%, var(--stripe-color) 75%, transparent 75%, transparent)",backgroundSize:"var(--stripe-size) var(--stripe-size)","--stripe-size":"1rem","--stripe-color":{_light:"rgba(255, 255, 255, 0.3)",_dark:"rgba(0, 0, 0, 0.3)"}}}},animated:{true:{range:{"--animate-from":"var(--stripe-size)",animation:"bg-position 1s linear infinite"}}},size:{xs:{track:{h:"1.5"}},sm:{track:{h:"2"}},md:{track:{h:"2.5"}},lg:{track:{h:"3"}},xl:{track:{h:"4"}}}},defaultVariants:{variant:"outline",size:"md",shape:"rounded"}},Hv={className:"chakra-progress-circle",slots:Bv.keys(),base:{root:{display:"inline-flex",textStyle:"sm",position:"relative"},circle:{_indeterminate:{animation:"spin 2s linear infinite"}},circleTrack:{"--track-color":"colors.colorPalette.muted",stroke:"var(--track-color)"},circleRange:{stroke:"colorPalette.solid",transitionProperty:"stroke-dashoffset, stroke-dasharray",transitionDuration:"0.6s",_indeterminate:{animation:"circular-progress 1.5s linear infinite"}},label:{display:"inline-flex"},valueText:{lineHeight:"1",fontWeight:"medium",letterSpacing:"tight",fontVariantNumeric:"tabular-nums"}},variants:{size:{xs:{circle:{"--size":"24px","--thickness":"4px"},valueText:{textStyle:"2xs"}},sm:{circle:{"--size":"32px","--thickness":"5px"},valueText:{textStyle:"2xs"}},md:{circle:{"--size":"40px","--thickness":"6px"},valueText:{textStyle:"xs"}},lg:{circle:{"--size":"48px","--thickness":"7px"},valueText:{textStyle:"sm"}},xl:{circle:{"--size":"64px","--thickness":"8px"},valueText:{textStyle:"sm"}}}},defaultVariants:{size:"md"}};var Gv=(e=>(e[e.Border=-1]="Border",e[e.Data=0]="Data",e[e.Function=1]="Function",e[e.Position=2]="Position",e[e.Timing=3]="Timing",e[e.Alignment=4]="Alignment",e))(Gv||{}),qv=Object.defineProperty,Xv=(e,t,i)=>(((e,t,i)=>{t in e?qv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!==typeof t?t+"":t,i),i);const Yv=[1,0],Qv=[2,3],Kv=[3,2],Zv={L:[0,1],M:Yv,Q:Qv,H:Kv},Jv=/^[0-9]*$/,$v=/^[A-Z0-9 $%*+.\/:-]*$/,ey="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",ty=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],iy=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]];class ny{constructor(e,t,i,n){if(this.version=e,this.ecc=t,Xv(this,"size"),Xv(this,"mask"),Xv(this,"modules",[]),Xv(this,"types",[]),e<1||e>40)throw new RangeError("Version value out of range");if(n<-1||n>7)throw new RangeError("Mask value out of range");this.size=4*e+17;const r=Array.from({length:this.size},()=>!1);for(let o=0;o<this.size;o++)this.modules.push(r.slice()),this.types.push(r.map(()=>0));this.drawFunctionPatterns();const a=this.addEccAndInterleave(i);if(this.drawCodewords(a),-1===n){let e=1e9;for(let t=0;t<8;t++){this.applyMask(t),this.drawFormatBits(t);const i=this.getPenaltyScore();i<e&&(n=t,e=i),this.applyMask(t)}}this.mask=n,this.applyMask(n),this.drawFormatBits(n)}getModule(e,t){return e>=0&&e<this.size&&t>=0&&t<this.size&&this.modules[t][e]}drawFunctionPatterns(){for(let i=0;i<this.size;i++)this.setFunctionModule(6,i,i%2===0,Gv.Timing),this.setFunctionModule(i,6,i%2===0,Gv.Timing);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),t=e.length;for(let i=0;i<t;i++)for(let n=0;n<t;n++)0===i&&0===n||0===i&&n===t-1||i===t-1&&0===n||this.drawAlignmentPattern(e[i],e[n]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const t=this.ecc[1]<<3|e;let i=t;for(let r=0;r<10;r++)i=i<<1^1335*(i>>>9);const n=21522^(t<<10|i);for(let r=0;r<=5;r++)this.setFunctionModule(8,r,ay(n,r));this.setFunctionModule(8,7,ay(n,6)),this.setFunctionModule(8,8,ay(n,7)),this.setFunctionModule(7,8,ay(n,8));for(let r=9;r<15;r++)this.setFunctionModule(14-r,8,ay(n,r));for(let r=0;r<8;r++)this.setFunctionModule(this.size-1-r,8,ay(n,r));for(let r=8;r<15;r++)this.setFunctionModule(8,this.size-15+r,ay(n,r));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let i=0;i<12;i++)e=e<<1^7973*(e>>>11);const t=this.version<<12|e;for(let i=0;i<18;i++){const e=ay(t,i),n=this.size-11+i%3,r=Math.floor(i/3);this.setFunctionModule(n,r,e),this.setFunctionModule(r,n,e)}}drawFinderPattern(e,t){for(let i=-4;i<=4;i++)for(let n=-4;n<=4;n++){const r=Math.max(Math.abs(n),Math.abs(i)),a=e+n,o=t+i;a>=0&&a<this.size&&o>=0&&o<this.size&&this.setFunctionModule(a,o,2!==r&&4!==r,Gv.Position)}}drawAlignmentPattern(e,t){for(let i=-2;i<=2;i++)for(let n=-2;n<=2;n++)this.setFunctionModule(e+n,t+i,1!==Math.max(Math.abs(n),Math.abs(i)),Gv.Alignment)}setFunctionModule(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Gv.Function;this.modules[t][e]=i,this.types[t][e]=n}addEccAndInterleave(e){const t=this.version,i=this.ecc;if(e.length!==by(t,i))throw new RangeError("Invalid argument");const n=iy[i[0]][t],r=ty[i[0]][t],a=Math.floor(yy(t)/8),o=n-a%n,s=Math.floor(a/n),l=[],c=function(e){if(e<1||e>255)throw new RangeError("Degree out of range");const t=[];for(let n=0;n<e-1;n++)t.push(0);t.push(1);let i=1;for(let n=0;n<e;n++){for(let e=0;e<t.length;e++)t[e]=wy(t[e],i),e+1<t.length&&(t[e]^=t[e+1]);i=wy(i,2)}return t}(r);for(let u=0,h=0;u<n;u++){const t=e.slice(h,h+s-r+(u<o?0:1));h+=t.length;const i=xy(t,c);u<o&&t.push(0),l.push(t.concat(i))}const d=[];for(let u=0;u<l[0].length;u++)l.forEach((e,t)=>{(u!==s-r||t>=o)&&d.push(e[u])});return d}drawCodewords(e){if(e.length!==Math.floor(yy(this.version)/8))throw new RangeError("Invalid argument");let t=0;for(let i=this.size-1;i>=1;i-=2){6===i&&(i=5);for(let n=0;n<this.size;n++)for(let r=0;r<2;r++){const a=i-r,o=0===(i+1&2)?this.size-1-n:n;!this.types[o][a]&&t<8*e.length&&(this.modules[o][a]=ay(e[t>>>3],7-(7&t)),t++)}}}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let i=0;i<this.size;i++){let n;switch(e){case 0:n=(i+t)%2===0;break;case 1:n=t%2===0;break;case 2:n=i%3===0;break;case 3:n=(i+t)%3===0;break;case 4:n=(Math.floor(i/3)+Math.floor(t/2))%2===0;break;case 5:n=i*t%2+i*t%3===0;break;case 6:n=(i*t%2+i*t%3)%2===0;break;case 7:n=((i+t)%2+i*t%3)%2===0;break;default:throw new Error("Unreachable")}!this.types[t][i]&&n&&(this.modules[t][i]=!this.modules[t][i])}}getPenaltyScore(){let e=0;for(let n=0;n<this.size;n++){let t=!1,i=0;const r=[0,0,0,0,0,0,0];for(let a=0;a<this.size;a++)this.modules[n][a]===t?(i++,5===i?e+=3:i>5&&e++):(this.finderPenaltyAddHistory(i,r),t||(e+=40*this.finderPenaltyCountPatterns(r)),t=this.modules[n][a],i=1);e+=40*this.finderPenaltyTerminateAndCount(t,i,r)}for(let n=0;n<this.size;n++){let t=!1,i=0;const r=[0,0,0,0,0,0,0];for(let a=0;a<this.size;a++)this.modules[a][n]===t?(i++,5===i?e+=3:i>5&&e++):(this.finderPenaltyAddHistory(i,r),t||(e+=40*this.finderPenaltyCountPatterns(r)),t=this.modules[a][n],i=1);e+=40*this.finderPenaltyTerminateAndCount(t,i,r)}for(let n=0;n<this.size-1;n++)for(let t=0;t<this.size-1;t++){const i=this.modules[n][t];i===this.modules[n][t+1]&&i===this.modules[n+1][t]&&i===this.modules[n+1][t+1]&&(e+=3)}let t=0;for(const n of this.modules)t=n.reduce((e,t)=>e+(t?1:0),t);const i=this.size*this.size;return e+=10*(Math.ceil(Math.abs(20*t-10*i)/i)-1),e}getAlignmentPatternPositions(){if(1===this.version)return[];{const e=Math.floor(this.version/7)+2,t=32===this.version?26:2*Math.ceil((4*this.version+4)/(2*e-2)),i=[6];for(let n=this.size-7;i.length<e;n-=t)i.splice(1,0,n);return i}}finderPenaltyCountPatterns(e){const t=e[1],i=t>0&&e[2]===t&&e[3]===3*t&&e[4]===t&&e[5]===t;return(i&&e[0]>=4*t&&e[6]>=t?1:0)+(i&&e[6]>=4*t&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,i){return e&&(this.finderPenaltyAddHistory(t,i),t=0),t+=this.size,this.finderPenaltyAddHistory(t,i),this.finderPenaltyCountPatterns(i)}finderPenaltyAddHistory(e,t){0===t[0]&&(e+=this.size),t.pop(),t.unshift(e)}}function ry(e,t,i){if(t<0||t>31||e>>>t!==0)throw new RangeError("Value out of range");for(let n=t-1;n>=0;n--)i.push(e>>>n&1)}function ay(e,t){return 0!==(e>>>t&1)}class oy{constructor(e,t,i){if(this.mode=e,this.numChars=t,this.bitData=i,t<0)throw new RangeError("Invalid argument");this.bitData=i.slice()}getData(){return this.bitData.slice()}}const sy=[1,10,12,14],ly=[2,9,11,13],cy=[4,8,16,16];function dy(e,t){return e[Math.floor((t+7)/17)+1]}function uy(e){const t=[];for(const i of e)ry(i,8,t);return new oy(cy,e.length,t)}function hy(e){if(!fy(e))throw new RangeError("String contains non-numeric characters");const t=[];for(let i=0;i<e.length;){const n=Math.min(e.length-i,3);ry(Number.parseInt(e.substring(i,i+n),10),3*n+1,t),i+=n}return new oy(sy,e.length,t)}function py(e){if(!my(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");const t=[];let i;for(i=0;i+2<=e.length;i+=2){let n=45*ey.indexOf(e.charAt(i));n+=ey.indexOf(e.charAt(i+1)),ry(n,11,t)}return i<e.length&&ry(ey.indexOf(e.charAt(i)),6,t),new oy(ly,e.length,t)}function fy(e){return Jv.test(e)}function my(e){return $v.test(e)}function gy(e,t){let i=0;for(const n of e){const e=dy(n.mode,t);if(n.numChars>=1<<e)return Number.POSITIVE_INFINITY;i+=4+e+n.bitData.length}return i}function vy(e){e=encodeURI(e);const t=[];for(let i=0;i<e.length;i++)"%"!==e.charAt(i)?t.push(e.charCodeAt(i)):(t.push(Number.parseInt(e.substring(i+1,i+3),16)),i+=2);return t}function yy(e){if(e<1||e>40)throw new RangeError("Version number out of range");let t=(16*e+128)*e+64;if(e>=2){const i=Math.floor(e/7)+2;t-=(25*i-10)*i-55,e>=7&&(t-=36)}return t}function by(e,t){return Math.floor(yy(e)/8)-ty[t[0]][e]*iy[t[0]][e]}function xy(e,t){const i=t.map(e=>0);for(const n of e){const e=n^i.shift();i.push(0),t.forEach((t,n)=>i[n]^=wy(t,e))}return i}function wy(e,t){if(e>>>8!==0||t>>>8!==0)throw new RangeError("Byte out of range");let i=0;for(let n=7;n>=0;n--)i=i<<1^285*(i>>>7),i^=(t>>>n&1)*e;return i}function Sy(e,t){var i;const{ecc:n="L",boostEcc:r=!1,minVersion:a=1,maxVersion:o=40,maskPattern:s=-1,border:l=1}=t||{},c="string"===typeof e?""===(d=e)?[]:fy(d)?[hy(d)]:my(d)?[py(d)]:[uy(vy(d))]:Array.isArray(e)?[uy(e)]:void 0;var d;if(!c)throw new Error("uqr only supports encoding string and binary data, but got: ".concat(typeof e));const u=function(e,t){let i,n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(!(1<=r&&r<=a&&a<=40)||o<-1||o>7)throw new RangeError("Invalid value");for(i=r;;i++){const r=8*by(i,t),o=gy(e,i);if(o<=r){n=o;break}if(i>=a)throw new RangeError("Data too long")}for(const u of[Yv,Qv,Kv])s&&n<=8*by(i,u)&&(t=u);const l=[];for(const u of e){ry(u.mode[0],4,l),ry(u.numChars,dy(u.mode,i),l);for(const e of u.getData())l.push(e)}const c=8*by(i,t);ry(0,Math.min(4,c-l.length),l),ry(0,(8-l.length%8)%8,l);for(let u=236;l.length<c;u^=253)ry(u,8,l);const d=Array.from({length:Math.ceil(l.length/8)},()=>0);return l.forEach((e,t)=>d[t>>>3]|=e<<7-(7&t)),new ny(i,t,d,o)}(c,Zv[n],a,o,s,r),h=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!t)return e;const{size:i}=e,n=i+2*t;e.size=n,e.data.forEach(e=>{for(let i=0;i<t;i++)e.unshift(!1),e.push(!1)});for(let a=0;a<t;a++)e.data.unshift(Array.from({length:n},e=>!1)),e.data.push(Array.from({length:n},e=>!1));const r=Gv.Border;e.types.forEach(e=>{for(let i=0;i<t;i++)e.unshift(r),e.push(r)});for(let a=0;a<t;a++)e.types.unshift(Array.from({length:n},e=>r)),e.types.push(Array.from({length:n},e=>r));return e}({version:u.version,maskPattern:u.mask,size:u.size,data:u.modules,types:u.types},l);return null!==t&&void 0!==t&&t.invert&&(h.data=h.data.map(e=>e.map(e=>!e))),null===t||void 0===t||null===(i=t.onEncoded)||void 0===i||i.call(t,h),h}var _y=ka("qr-code").parts("root","frame","pattern","overlay","downloadTrigger"),Cy=(_y.build(),e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.frame)&&void 0!==t?t:"qrcode:".concat(e.id,":frame")}),Ey=e=>e.getById(Cy(e));Yd(e=>{let{context:t,prop:i}=e;return[t.get("value"),i("encoding")]},(e,t)=>Sy(e,t));var Ay=pu()(["ids","defaultValue","value","id","encoding","dir","getRootNode","onValueChange","pixelSize"]);Ro(Ay);const My={slots:_y.keys(),className:"chakra-qr-code",base:{root:{position:"relative",width:"fit-content","--qr-code-overlay-size":"calc(var(--qr-code-size) / 3)"},frame:{width:"var(--qr-code-size)",height:"var(--qr-code-size)",fill:"currentColor"},overlay:{display:"flex",alignItems:"center",justifyContent:"center",width:"var(--qr-code-overlay-size)",height:"var(--qr-code-overlay-size)",padding:"1",bg:"bg",rounded:"l1"}},variants:{size:{"2xs":{root:{"--qr-code-size":"40px"}},xs:{root:{"--qr-code-size":"64px"}},sm:{root:{"--qr-code-size":"80px"}},md:{root:{"--qr-code-size":"120px"}},lg:{root:{"--qr-code-size":"160px"}},xl:{root:{"--qr-code-size":"200px"}},"2xl":{root:{"--qr-code-size":"240px"}},full:{root:{"--qr-code-size":"100%"}}}},defaultVariants:{size:"md"}};var Ty,Py,Dy,Oy,Iy,ky,Ry;const zy={className:"chakra-radio-card",slots:am.keys(),base:{root:{display:"flex",flexDirection:"column",gap:"1.5",isolation:"isolate"},item:{flex:"1",display:"flex",flexDirection:"column",userSelect:"none",position:"relative",borderRadius:"l2",_focus:{bg:"colorPalette.muted/20"},_disabled:{opacity:"0.8",borderColor:"border.disabled"},_checked:{zIndex:"1"}},label:{display:"inline-flex",fontWeight:"medium",textStyle:"sm",_disabled:{opacity:"0.5"}},itemText:{fontWeight:"medium",flex:"1"},itemDescription:{opacity:"0.64",textStyle:"sm"},itemControl:{display:"inline-flex",flex:"1",pos:"relative",rounded:"inherit",justifyContent:"var(--radio-card-justify)",alignItems:"var(--radio-card-align)",_disabled:{bg:"bg.muted"}},itemIndicator:Ta.base,itemAddon:{roundedBottom:"inherit",_disabled:{color:"fg.muted"}},itemContent:{display:"flex",flexDirection:"column",flex:"1",gap:"1",justifyContent:"var(--radio-card-justify)",alignItems:"var(--radio-card-align)"}},variants:{size:{sm:{item:{textStyle:"sm"},itemControl:{padding:"3",gap:"1.5"},itemAddon:{px:"3",py:"1.5",borderTopWidth:"1px"},itemIndicator:null===(Ty=Ta.variants)||void 0===Ty?void 0:Ty.size.sm},md:{item:{textStyle:"sm"},itemControl:{padding:"4",gap:"2.5"},itemAddon:{px:"4",py:"2",borderTopWidth:"1px"},itemIndicator:null===(Py=Ta.variants)||void 0===Py?void 0:Py.size.md},lg:{item:{textStyle:"md"},itemControl:{padding:"4",gap:"3.5"},itemAddon:{px:"4",py:"2",borderTopWidth:"1px"},itemIndicator:null===(Dy=Ta.variants)||void 0===Dy?void 0:Dy.size.lg}},variant:{surface:{item:{borderWidth:"1px",_checked:{bg:"colorPalette.subtle",color:"colorPalette.fg",borderColor:"colorPalette.muted"}},itemIndicator:null===(Oy=Ta.variants)||void 0===Oy?void 0:Oy.variant.solid},subtle:{item:{bg:"bg.muted"},itemControl:{_checked:{bg:"colorPalette.muted",color:"colorPalette.fg"}},itemIndicator:null===(Iy=Ta.variants)||void 0===Iy?void 0:Iy.variant.outline},outline:{item:{borderWidth:"1px",_checked:{boxShadow:"0 0 0 1px var(--shadow-color)",boxShadowColor:"colorPalette.solid",borderColor:"colorPalette.solid"}},itemIndicator:null===(ky=Ta.variants)||void 0===ky?void 0:ky.variant.solid},solid:{item:{borderWidth:"1px",_checked:{bg:"colorPalette.solid",color:"colorPalette.contrast",borderColor:"colorPalette.solid"}},itemIndicator:null===(Ry=Ta.variants)||void 0===Ry?void 0:Ry.variant.inverted}},justify:{start:{item:{"--radio-card-justify":"flex-start"}},end:{item:{"--radio-card-justify":"flex-end"}},center:{item:{"--radio-card-justify":"center"}}},align:{start:{item:{"--radio-card-align":"flex-start"},itemControl:{textAlign:"start"}},end:{item:{"--radio-card-align":"flex-end"},itemControl:{textAlign:"end"}},center:{item:{"--radio-card-align":"center"},itemControl:{textAlign:"center"}}},orientation:{vertical:{itemControl:{flexDirection:"column"}},horizontal:{itemControl:{flexDirection:"row"}}}},defaultVariants:{size:"md",variant:"outline",align:"start",orientation:"horizontal"}};var Ly,By,Ny,Fy,Uy,Vy,jy;const Wy={className:"chakra-radio-group",slots:rm.keys(),base:{item:{display:"inline-flex",alignItems:"center",position:"relative",fontWeight:"medium",_disabled:{cursor:"disabled"}},itemControl:Ta.base,label:{userSelect:"none",textStyle:"sm",_disabled:{opacity:"0.5"}}},variants:{variant:{outline:{itemControl:null===(Ly=Ta.variants)||void 0===Ly||null===(Ly=Ly.variant)||void 0===Ly?void 0:Ly.outline},subtle:{itemControl:null===(By=Ta.variants)||void 0===By||null===(By=By.variant)||void 0===By?void 0:By.subtle},solid:{itemControl:null===(Ny=Ta.variants)||void 0===Ny||null===(Ny=Ny.variant)||void 0===Ny?void 0:Ny.solid}},size:{xs:{item:{textStyle:"xs",gap:"1.5"},itemControl:null===(Fy=Ta.variants)||void 0===Fy||null===(Fy=Fy.size)||void 0===Fy?void 0:Fy.xs},sm:{item:{textStyle:"sm",gap:"2"},itemControl:null===(Uy=Ta.variants)||void 0===Uy||null===(Uy=Uy.size)||void 0===Uy?void 0:Uy.sm},md:{item:{textStyle:"sm",gap:"2.5"},itemControl:null===(Vy=Ta.variants)||void 0===Vy||null===(Vy=Vy.size)||void 0===Vy?void 0:Vy.md},lg:{item:{textStyle:"md",gap:"3"},itemControl:null===(jy=Ta.variants)||void 0===jy||null===(jy=jy.size)||void 0===jy?void 0:jy.lg}}},defaultVariants:{size:"md",variant:"solid"}},Hy={className:"chakra-rating-group",slots:om.keys(),base:{root:{display:"inline-flex"},control:{display:"inline-flex",alignItems:"center"},item:{display:"inline-flex",alignItems:"center",justifyContent:"center",userSelect:"none"},itemIndicator:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"1em",height:"1em",position:"relative","--clip-path":{base:"inset(0 50% 0 0)",_rtl:"inset(0 0 0 50%)"},_icon:{stroke:"currentColor",width:"100%",height:"100%",display:"inline-block",flexShrink:0,position:"absolute",left:0,top:0},"& [data-bg]":{color:"bg.emphasized"},"& [data-fg]":{color:"transparent"},"&[data-highlighted]:not([data-half])":{"& [data-fg]":{color:"colorPalette.solid"}},"&[data-half]":{"& [data-fg]":{color:"colorPalette.solid",clipPath:"var(--clip-path)"}}}},variants:{size:{xs:{item:{textStyle:"sm"}},sm:{item:{textStyle:"md"}},md:{item:{textStyle:"xl"}},lg:{item:{textStyle:"2xl"}}}},defaultVariants:{size:"md"}},Gy=Zp.rename("segment-group"),qy=(Gy.build(),{className:"chakra-segment-group",slots:Gy.keys(),base:{root:{"--segment-radius":"radii.l2",borderRadius:"l2",display:"inline-flex",boxShadow:"inset",minW:"max-content",textAlign:"center",position:"relative",isolation:"isolate",bg:"bg.muted",_vertical:{flexDirection:"column"}},item:{display:"flex",alignItems:"center",justifyContent:"center",userSelect:"none",fontSize:"sm",position:"relative",color:"fg",borderRadius:"var(--segment-radius)",_disabled:{opacity:"0.5"},"&:has(input:focus-visible)":{focusRing:"outside"},_before:{content:'""',position:"absolute",bg:"border",transition:"opacity 0.2s"},_horizontal:{_before:{insetInlineStart:0,insetBlock:"1.5",width:"1px"}},_vertical:{_before:{insetBlockStart:0,insetInline:"1.5",height:"1px"}},"& + &[data-state=checked], &[data-state=checked] + &, &:first-of-type":{_before:{opacity:"0"}},"&[data-state=checked][data-ssr]":{shadow:"sm",bg:"bg",borderRadius:"var(--segment-radius)"}},indicator:{shadow:"sm",pos:"absolute",bg:{_light:"bg",_dark:"bg.emphasized"},width:"var(--width)",height:"var(--height)",top:"var(--top)",left:"var(--left)",zIndex:-1,borderRadius:"var(--segment-radius)"}},variants:{size:{xs:{item:{textStyle:"xs",px:"3",gap:"1",height:"6"}},sm:{item:{textStyle:"sm",px:"4",gap:"2",height:"8"}},md:{item:{textStyle:"sm",px:"4",gap:"2",height:"10"}},lg:{item:{textStyle:"md",px:"4.5",gap:"3",height:"11"}}}},defaultVariants:{size:"md"}}),Xy={className:"chakra-slider",slots:cm.keys(),base:{root:{display:"flex",flexDirection:"column",gap:"1",textStyle:"sm",position:"relative",isolation:"isolate",touchAction:"none"},label:{fontWeight:"medium",textStyle:"sm"},control:{display:"inline-flex",alignItems:"center",position:"relative"},track:{overflow:"hidden",borderRadius:"full",flex:"1"},range:{width:"inherit",height:"inherit",_disabled:{bg:"border.emphasized!"}},markerGroup:{position:"absolute!",zIndex:"1"},marker:{"--marker-bg":{base:"white",_underValue:"colors.bg"},display:"flex",alignItems:"center",gap:"calc(var(--slider-thumb-size) / 2)",color:"fg.muted",textStyle:"xs"},markerIndicator:{width:"var(--slider-marker-size)",height:"var(--slider-marker-size)",borderRadius:"full",bg:"var(--marker-bg)"},thumb:{width:"var(--slider-thumb-size)",height:"var(--slider-thumb-size)",display:"flex",alignItems:"center",justifyContent:"center",outline:0,zIndex:"2",borderRadius:"full",_focusVisible:{ring:"2px",ringColor:"colorPalette.focusRing",ringOffset:"2px",ringOffsetColor:"bg"}}},variants:{size:{sm:{root:{"--slider-thumb-size":"sizes.4","--slider-track-size":"sizes.1.5","--slider-marker-center":"6px","--slider-marker-size":"sizes.1","--slider-marker-inset":"3px"}},md:{root:{"--slider-thumb-size":"sizes.5","--slider-track-size":"sizes.2","--slider-marker-center":"8px","--slider-marker-size":"sizes.1","--slider-marker-inset":"4px"}},lg:{root:{"--slider-thumb-size":"sizes.6","--slider-track-size":"sizes.2.5","--slider-marker-center":"9px","--slider-marker-size":"sizes.1.5","--slider-marker-inset":"5px"}}},variant:{outline:{track:{shadow:"inset",bg:"bg.emphasized/72"},range:{bg:"colorPalette.solid"},thumb:{borderWidth:"2px",borderColor:"colorPalette.solid",bg:"bg",_disabled:{bg:"border.emphasized",borderColor:"border.emphasized"}}},solid:{track:{bg:"colorPalette.subtle",_disabled:{bg:"bg.muted"}},range:{bg:"colorPalette.solid"},thumb:{bg:"colorPalette.solid",_disabled:{bg:"border.emphasized"}}}},orientation:{vertical:{root:{display:"inline-flex"},control:{flexDirection:"column",height:"100%",minWidth:"var(--slider-thumb-size)","&[data-has-mark-label], &:has(.chakra-slider__marker-label)":{marginEnd:"4"}},track:{width:"var(--slider-track-size)"},thumb:{left:"50%",translate:"-50% 0"},markerGroup:{insetStart:"var(--slider-marker-center)",insetBlock:"var(--slider-marker-inset)"},marker:{flexDirection:"row"}},horizontal:{control:{flexDirection:"row",width:"100%",minHeight:"var(--slider-thumb-size)","&[data-has-mark-label], &:has(.chakra-slider__marker-label)":{marginBottom:"4"}},track:{height:"var(--slider-track-size)"},thumb:{top:"50%",translate:"0 -50%"},markerGroup:{top:"var(--slider-marker-center)",insetInline:"var(--slider-marker-inset)"},marker:{flexDirection:"column"}}}},defaultVariants:{size:"md",variant:"outline",orientation:"horizontal"}},Yy={className:"chakra-stat",slots:dm.keys(),base:{root:{display:"flex",flexDirection:"column",gap:"1",position:"relative",flex:"1"},label:{display:"inline-flex",gap:"1.5",alignItems:"center",color:"fg.muted",textStyle:"sm"},helpText:{color:"fg.muted",textStyle:"xs"},valueUnit:{color:"fg.muted",textStyle:"xs",fontWeight:"initial",letterSpacing:"initial"},valueText:{verticalAlign:"baseline",fontWeight:"semibold",letterSpacing:"tight",fontFeatureSettings:"pnum",fontVariantNumeric:"proportional-nums",display:"inline-flex",gap:"1"},indicator:{display:"inline-flex",alignItems:"center",justifyContent:"center",marginEnd:1,"& :where(svg)":{w:"1em",h:"1em"},"&[data-type=up]":{color:"fg.success"},"&[data-type=down]":{color:"fg.error"}}},variants:{size:{sm:{valueText:{textStyle:"xl"}},md:{valueText:{textStyle:"2xl"}},lg:{valueText:{textStyle:"3xl"}}}},defaultVariants:{size:"md"}},Qy={className:"chakra-status",slots:um.keys(),base:{root:{display:"inline-flex",alignItems:"center",gap:"2"},indicator:{width:"0.64em",height:"0.64em",flexShrink:0,borderRadius:"full",forcedColorAdjust:"none",bg:"colorPalette.solid"}},variants:{size:{sm:{root:{textStyle:"xs"}},md:{root:{textStyle:"sm"}},lg:{root:{textStyle:"md"}}}},defaultVariants:{size:"md"}},Ky={className:"chakra-steps",slots:hm.keys(),base:{root:{display:"flex",width:"full"},list:{display:"flex",justifyContent:"space-between","--steps-gutter":"spacing.3","--steps-thickness":"2px"},title:{fontWeight:"medium",color:"fg"},description:{color:"fg.muted"},separator:{bg:"border",flex:"1"},indicator:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0",borderRadius:"full",fontWeight:"medium",width:"var(--steps-size)",height:"var(--steps-size)",_icon:{flexShrink:"0",width:"var(--steps-icon-size)",height:"var(--steps-icon-size)"}},item:{position:"relative",display:"flex",gap:"3",flex:"1 0 0","&:last-of-type":{flex:"initial","& [data-part=separator]":{display:"none"}}},trigger:{display:"flex",alignItems:"center",gap:"3",textAlign:"start",focusVisibleRing:"outside",borderRadius:"l2"},content:{focusVisibleRing:"outside"}},variants:{orientation:{vertical:{root:{flexDirection:"row",height:"100%"},list:{flexDirection:"column",alignItems:"flex-start"},separator:{position:"absolute",width:"var(--steps-thickness)",height:"100%",maxHeight:"calc(100% - var(--steps-size) - var(--steps-gutter) * 2)",top:"calc(var(--steps-size) + var(--steps-gutter))",insetStart:"calc(var(--steps-size) / 2 - 1px)"},item:{alignItems:"flex-start"}},horizontal:{root:{flexDirection:"column",width:"100%"},list:{flexDirection:"row",alignItems:"center"},separator:{width:"100%",height:"var(--steps-thickness)",marginX:"var(--steps-gutter)"},item:{alignItems:"center"}}},variant:{solid:{indicator:{_incomplete:{borderWidth:"var(--steps-thickness)"},_current:{bg:"colorPalette.muted",borderWidth:"var(--steps-thickness)",borderColor:"colorPalette.solid",color:"colorPalette.fg"},_complete:{bg:"colorPalette.solid",borderColor:"colorPalette.solid",color:"colorPalette.contrast"}},separator:{_complete:{bg:"colorPalette.solid"}}},subtle:{indicator:{_incomplete:{bg:"bg.muted"},_current:{bg:"colorPalette.muted",color:"colorPalette.fg"},_complete:{bg:"colorPalette.emphasized",color:"colorPalette.fg"}},separator:{_complete:{bg:"colorPalette.emphasized"}}}},size:{xs:{root:{gap:"2.5"},list:{"--steps-size":"sizes.6","--steps-icon-size":"sizes.3.5",textStyle:"xs"},title:{textStyle:"sm"}},sm:{root:{gap:"3"},list:{"--steps-size":"sizes.8","--steps-icon-size":"sizes.4",textStyle:"xs"},title:{textStyle:"sm"}},md:{root:{gap:"4"},list:{"--steps-size":"sizes.10","--steps-icon-size":"sizes.4",textStyle:"sm"},title:{textStyle:"sm"}},lg:{root:{gap:"6"},list:{"--steps-size":"sizes.11","--steps-icon-size":"sizes.5",textStyle:"md"},title:{textStyle:"md"}}}},defaultVariants:{size:"md",variant:"solid",orientation:"horizontal"}},Zy={slots:pm.keys(),className:"chakra-switch",base:{root:{display:"inline-flex",gap:"2.5",alignItems:"center",position:"relative",verticalAlign:"middle","--switch-diff":"calc(var(--switch-width) - var(--switch-height))","--switch-x":{base:"var(--switch-diff)",_rtl:"calc(var(--switch-diff) * -1)"}},label:{lineHeight:"1",userSelect:"none",fontSize:"sm",fontWeight:"medium",_disabled:{opacity:"0.5"}},indicator:{position:"absolute",height:"var(--switch-height)",width:"var(--switch-height)",fontSize:"var(--switch-indicator-font-size)",fontWeight:"medium",flexShrink:0,userSelect:"none",display:"grid",placeContent:"center",transition:"inset-inline-start 0.12s ease",insetInlineStart:"calc(var(--switch-x) - 2px)",_checked:{insetInlineStart:"2px"}},control:{display:"inline-flex",gap:"0.5rem",flexShrink:0,justifyContent:"flex-start",cursor:"switch",borderRadius:"full",position:"relative",width:"var(--switch-width)",height:"var(--switch-height)",transition:"backgrounds",_disabled:{opacity:"0.5",cursor:"not-allowed"},_invalid:{outline:"2px solid",outlineColor:"border.error",outlineOffset:"2px"}},thumb:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transitionProperty:"translate",transitionDuration:"fast",borderRadius:"inherit",_checked:{translate:"var(--switch-x) 0"}}},variants:{variant:{solid:{control:{borderRadius:"full",bg:"bg.emphasized",focusVisibleRing:"outside",_checked:{bg:"colorPalette.solid"}},thumb:{bg:"white",width:"var(--switch-height)",height:"var(--switch-height)",scale:"0.8",boxShadow:"sm",_checked:{bg:"colorPalette.contrast"}}},raised:{control:{borderRadius:"full",height:"calc(var(--switch-height) / 2)",bg:"bg.muted",boxShadow:"inset",_checked:{bg:"colorPalette.solid/60"}},thumb:{width:"var(--switch-height)",height:"var(--switch-height)",position:"relative",top:"calc(var(--switch-height) * -0.25)",bg:"white",boxShadow:"xs",focusVisibleRing:"outside",_checked:{bg:"colorPalette.solid"}}}},size:{xs:{root:{"--switch-width":"sizes.6","--switch-height":"sizes.3","--switch-indicator-font-size":"fontSizes.xs"}},sm:{root:{"--switch-width":"sizes.8","--switch-height":"sizes.4","--switch-indicator-font-size":"fontSizes.xs"}},md:{root:{"--switch-width":"sizes.10","--switch-height":"sizes.5","--switch-indicator-font-size":"fontSizes.sm"}},lg:{root:{"--switch-width":"sizes.12","--switch-height":"sizes.6","--switch-indicator-font-size":"fontSizes.md"}}}},defaultVariants:{variant:"solid",size:"md"}},Jy={className:"chakra-table",slots:fm.keys(),base:{root:{fontVariantNumeric:"lining-nums tabular-nums",borderCollapse:"collapse",width:"full",textAlign:"start",verticalAlign:"top"},row:{_selected:{bg:"colorPalette.subtle"}},cell:{textAlign:"start",alignItems:"center"},columnHeader:{fontWeight:"medium",textAlign:"start",color:"fg"},caption:{fontWeight:"medium",textStyle:"xs"},footer:{fontWeight:"medium"}},variants:{interactive:{true:{body:{"& tr":{_hover:{bg:"colorPalette.subtle"}}}}},stickyHeader:{true:{header:{"& :where(tr)":{top:"var(--table-sticky-offset, 0)",position:"sticky",zIndex:1}}}},striped:{true:{row:{"&:nth-of-type(odd) td":{bg:"bg.muted"}}}},showColumnBorder:{true:{columnHeader:{"&:not(:last-of-type)":{borderInlineEndWidth:"1px"}},cell:{"&:not(:last-of-type)":{borderInlineEndWidth:"1px"}}}},variant:{line:{columnHeader:{borderBottomWidth:"1px"},cell:{borderBottomWidth:"1px"},row:{bg:"bg"}},outline:{root:{boxShadow:"0 0 0 1px {colors.border}",overflow:"hidden"},columnHeader:{borderBottomWidth:"1px"},header:{bg:"bg.muted"},row:{"&:not(:last-of-type)":{borderBottomWidth:"1px"}},footer:{borderTopWidth:"1px"}}},size:{sm:{root:{textStyle:"sm"},columnHeader:{px:"2",py:"2"},cell:{px:"2",py:"2"}},md:{root:{textStyle:"sm"},columnHeader:{px:"3",py:"3"},cell:{px:"3",py:"3"}},lg:{root:{textStyle:"md"},columnHeader:{px:"4",py:"3"},cell:{px:"4",py:"3"}}}},defaultVariants:{variant:"line",size:"md"}},$y={slots:gm.keys(),className:"chakra-tabs",base:{root:{"--tabs-trigger-radius":"radii.l2",position:"relative",_horizontal:{display:"block"},_vertical:{display:"flex"}},list:{display:"inline-flex",position:"relative",isolation:"isolate","--tabs-indicator-shadow":"shadows.xs","--tabs-indicator-bg":"colors.bg",minH:"var(--tabs-height)",_horizontal:{flexDirection:"row"},_vertical:{flexDirection:"column"}},trigger:{outline:"0",minW:"var(--tabs-height)",height:"var(--tabs-height)",display:"flex",alignItems:"center",fontWeight:"medium",position:"relative",cursor:"button",gap:"2",_focusVisible:{zIndex:1,outline:"2px solid",outlineColor:"colorPalette.focusRing"},_disabled:{cursor:"not-allowed",opacity:.5}},content:{focusVisibleRing:"inside",_horizontal:{width:"100%",pt:"var(--tabs-content-padding)"},_vertical:{height:"100%",ps:"var(--tabs-content-padding)"}},indicator:{width:"var(--width)",height:"var(--height)",borderRadius:"var(--tabs-indicator-radius)",bg:"var(--tabs-indicator-bg)",shadow:"var(--tabs-indicator-shadow)",zIndex:-1}},variants:{fitted:{true:{list:{display:"flex"},trigger:{flex:1,textAlign:"center",justifyContent:"center"}}},justify:{start:{list:{justifyContent:"flex-start"}},center:{list:{justifyContent:"center"}},end:{list:{justifyContent:"flex-end"}}},size:{sm:{root:{"--tabs-height":"sizes.9","--tabs-content-padding":"spacing.3"},trigger:{py:"1",px:"3",textStyle:"sm"}},md:{root:{"--tabs-height":"sizes.10","--tabs-content-padding":"spacing.4"},trigger:{py:"2",px:"4",textStyle:"sm"}},lg:{root:{"--tabs-height":"sizes.11","--tabs-content-padding":"spacing.4.5"},trigger:{py:"2",px:"4.5",textStyle:"md"}}},variant:{line:{list:{display:"flex",borderColor:"border",_horizontal:{borderBottomWidth:"1px"},_vertical:{borderEndWidth:"1px"}},trigger:{color:"fg.muted",_disabled:{_active:{bg:"initial"}},_selected:{color:"fg",_horizontal:{layerStyle:"indicator.bottom","--indicator-offset-y":"-1px","--indicator-color":"colors.colorPalette.solid"},_vertical:{layerStyle:"indicator.end","--indicator-offset-x":"-1px"}}}},subtle:{trigger:{borderRadius:"var(--tabs-trigger-radius)",color:"fg.muted",_selected:{bg:"colorPalette.subtle",color:"colorPalette.fg"}}},enclosed:{list:{bg:"bg.muted",padding:"1",borderRadius:"l3",minH:"calc(var(--tabs-height) - 4px)"},trigger:{justifyContent:"center",color:"fg.muted",borderRadius:"var(--tabs-trigger-radius)",_selected:{bg:"bg",color:"colorPalette.fg",shadow:"xs"}}},outline:{list:{"--line-thickness":"1px","--line-offset":"calc(var(--line-thickness) * -1)",borderColor:"border",display:"flex",_horizontal:{_before:{content:'""',position:"absolute",bottom:"0px",width:"100%",borderBottomWidth:"var(--line-thickness)",borderBottomColor:"border"}},_vertical:{_before:{content:'""',position:"absolute",insetInline:"var(--line-offset)",height:"calc(100% - calc(var(--line-thickness) * 2))",borderEndWidth:"var(--line-thickness)",borderEndColor:"border"}}},trigger:{color:"fg.muted",borderWidth:"1px",borderColor:"transparent",_selected:{bg:"currentBg",color:"colorPalette.fg"},_horizontal:{borderTopRadius:"var(--tabs-trigger-radius)",marginBottom:"var(--line-offset)",marginEnd:{_notLast:"var(--line-offset)"},_selected:{borderColor:"border",borderBottomColor:"transparent"}},_vertical:{borderStartRadius:"var(--tabs-trigger-radius)",marginEnd:"var(--line-offset)",marginBottom:{_notLast:"var(--line-offset)"},_selected:{borderColor:"border",borderEndColor:"transparent"}}}},plain:{trigger:{color:"fg.muted",_selected:{color:"colorPalette.fg"},borderRadius:"var(--tabs-trigger-radius)","&[data-selected][data-ssr]":{bg:"var(--tabs-indicator-bg)",shadow:"var(--tabs-indicator-shadow)",borderRadius:"var(--tabs-indicator-radius)"}}}}},defaultVariants:{size:"md",variant:"line"}};var eb;const tb=null===(eb=xa.variants)||void 0===eb?void 0:eb.variant,ib={slots:vm.keys(),className:"chakra-tag",base:{root:{display:"inline-flex",alignItems:"center",verticalAlign:"top",maxWidth:"100%",userSelect:"none",borderRadius:"l2",focusVisibleRing:"outside"},label:{lineClamp:"1"},closeTrigger:{display:"flex",alignItems:"center",justifyContent:"center",outline:"0",borderRadius:"l1",color:"currentColor",focusVisibleRing:"inside",focusRingWidth:"2px"},startElement:{flexShrink:0,boxSize:"var(--tag-element-size)",ms:"var(--tag-element-offset)","&:has([data-scope=avatar])":{boxSize:"var(--tag-avatar-size)",ms:"calc(var(--tag-element-offset) * 1.5)"},_icon:{boxSize:"100%"}},endElement:{flexShrink:0,boxSize:"var(--tag-element-size)",me:"var(--tag-element-offset)",_icon:{boxSize:"100%"},"&:has(button)":{ms:"calc(var(--tag-element-offset) * -1)"}}},variants:{size:{sm:{root:{px:"1.5",minH:"4.5",gap:"1","--tag-avatar-size":"spacing.3","--tag-element-size":"spacing.3","--tag-element-offset":"-2px"},label:{textStyle:"xs"}},md:{root:{px:"1.5",minH:"5",gap:"1","--tag-avatar-size":"spacing.3.5","--tag-element-size":"spacing.3.5","--tag-element-offset":"-2px"},label:{textStyle:"xs"}},lg:{root:{px:"2",minH:"6",gap:"1.5","--tag-avatar-size":"spacing.4.5","--tag-element-size":"spacing.4","--tag-element-offset":"-3px"},label:{textStyle:"sm"}},xl:{root:{px:"2.5",minH:"8",gap:"1.5","--tag-avatar-size":"spacing.6","--tag-element-size":"spacing.4.5","--tag-element-offset":"-4px"},label:{textStyle:"sm"}}},variant:{subtle:{root:null===tb||void 0===tb?void 0:tb.subtle},solid:{root:null===tb||void 0===tb?void 0:tb.solid},outline:{root:null===tb||void 0===tb?void 0:tb.outline},surface:{root:null===tb||void 0===tb?void 0:tb.surface}}},defaultVariants:{size:"md",variant:"surface"}},nb={slots:ym.keys(),className:"chakra-timeline",base:{root:{display:"flex",flexDirection:"column",width:"full","--timeline-thickness":"1px","--timeline-gutter":"4px"},item:{display:"flex",position:"relative",alignItems:"flex-start",flexShrink:0,gap:"4",_last:{"& :where(.chakra-timeline__separator)":{display:"none"}}},separator:{position:"absolute",borderStartWidth:"var(--timeline-thickness)",ms:"calc(-1 * var(--timeline-thickness) / 2)",insetInlineStart:"calc(var(--timeline-indicator-size) / 2)",insetBlock:"0",borderColor:"border"},indicator:{outline:"2px solid {colors.bg}",position:"relative",flexShrink:"0",boxSize:"var(--timeline-indicator-size)",fontSize:"var(--timeline-font-size)",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"full",fontWeight:"medium"},connector:{alignSelf:"stretch",position:"relative"},content:{pb:"6",display:"flex",flexDirection:"column",width:"full",gap:"2"},title:{display:"flex",fontWeight:"medium",flexWrap:"wrap",gap:"1.5",alignItems:"center",mt:"var(--timeline-margin)"},description:{color:"fg.muted",textStyle:"xs"}},variants:{variant:{subtle:{indicator:{bg:"colorPalette.muted"}},solid:{indicator:{bg:"colorPalette.solid",color:"colorPalette.contrast"}},outline:{indicator:{bg:"currentBg",borderWidth:"1px",borderColor:"colorPalette.muted"}},plain:{}},size:{sm:{root:{"--timeline-indicator-size":"sizes.4","--timeline-font-size":"fontSizes.2xs"},title:{textStyle:"xs"}},md:{root:{"--timeline-indicator-size":"sizes.5","--timeline-font-size":"fontSizes.xs"},title:{textStyle:"sm"}},lg:{root:{"--timeline-indicator-size":"sizes.6","--timeline-font-size":"fontSizes.xs"},title:{mt:"0.5",textStyle:"sm"}},xl:{root:{"--timeline-indicator-size":"sizes.8","--timeline-font-size":"fontSizes.sm"},title:{mt:"1.5",textStyle:"sm"}}}},defaultVariants:{size:"md",variant:"solid"}},rb={slots:mm.keys(),className:"chakra-toast",base:{root:{width:"full",display:"flex",alignItems:"flex-start",position:"relative",gap:"3",py:"4",ps:"4",pe:"6",borderRadius:"l2",translate:"var(--x) var(--y)",scale:"var(--scale)",zIndex:"var(--z-index)",height:"var(--height)",opacity:"var(--opacity)",willChange:"translate, opacity, scale",transition:"translate 400ms, scale 400ms, opacity 400ms, height 400ms, box-shadow 200ms",transitionTimingFunction:"cubic-bezier(0.21, 1.02, 0.73, 1)",_closed:{transition:"translate 400ms, scale 400ms, opacity 200ms",transitionTimingFunction:"cubic-bezier(0.06, 0.71, 0.55, 1)"},bg:"bg.panel",color:"fg",boxShadow:"xl","--toast-trigger-bg":"colors.bg.muted","&[data-type=warning]":{bg:"orange.solid",color:"orange.contrast","--toast-trigger-bg":"{white/10}","--toast-border-color":"{white/40}"},"&[data-type=success]":{bg:"green.solid",color:"green.contrast","--toast-trigger-bg":"{white/10}","--toast-border-color":"{white/40}"},"&[data-type=error]":{bg:"red.solid",color:"red.contrast","--toast-trigger-bg":"{white/10}","--toast-border-color":"{white/40}"}},title:{fontWeight:"medium",textStyle:"sm",marginEnd:"2"},description:{display:"inline",textStyle:"sm",opacity:"0.8"},indicator:{flexShrink:"0",boxSize:"5"},actionTrigger:{textStyle:"sm",fontWeight:"medium",height:"8",px:"3",borderRadius:"l2",alignSelf:"center",borderWidth:"1px",borderColor:"var(--toast-border-color, inherit)",transition:"background 200ms",_hover:{bg:"var(--toast-trigger-bg)"}},closeTrigger:{position:"absolute",top:"1",insetEnd:"1",padding:"1",display:"inline-flex",alignItems:"center",justifyContent:"center",color:"{currentColor/60}",borderRadius:"l2",textStyle:"md",transition:"background 200ms",_icon:{boxSize:"1em"}}}},ab=(Symbol(),Symbol());const ob=Object.getPrototypeOf,sb=new WeakMap,lb=e=>e&&(sb.has(e)?sb.get(e):ob(e)===Object.prototype||ob(e)===Array.prototype),cb=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];sb.set(e,t)};function db(e,t){const i="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:void 0;return i?(i[e]||(i[e]=t()),i[e]):t()}var ub=db("__zag__refSet",()=>new WeakSet),hb=e=>null!==e&&"object"===typeof e,pb=e=>hb(e)&&!ub.has(e)&&(Array.isArray(e)||!(Symbol.iterator in e))&&!(e=>(e=>"object"===typeof e&&null!==e&&"$$typeof"in e&&"props"in e)(e)||(e=>"object"===typeof e&&null!==e&&"__v_isVNode"in e)(e)||(e=>"object"===typeof e&&null!==e&&"nodeType"in e&&"string"===typeof e.nodeName)(e))(e)&&!(e instanceof WeakMap)&&!(e instanceof WeakSet)&&!(e instanceof Error)&&!(e instanceof Number)&&!(e instanceof Date)&&!(e instanceof String)&&!(e instanceof RegExp)&&!(e instanceof ArrayBuffer)&&!(e instanceof Promise);var fb=db("__zag__proxyStateMap",()=>new WeakMap),[mb]=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.is,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t)=>new Proxy(e,t),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new WeakMap,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(e,t)=>{const n=i.get(e);if((null===n||void 0===n?void 0:n[0])===t)return n[1];const r=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));return cb(r,!0),i.set(e,[t,r]),Reflect.ownKeys(e).forEach(t=>{const i=Reflect.get(e,t);ub.has(i)?(cb(i,!1),r[t]=i):fb.has(i)?r[t]=vb(i):r[t]=i}),Object.freeze(r)},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new WeakMap,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:i=>{if(!hb(i))throw new Error("object required");const o=r.get(i);if(o)return o;let s=a[0];const l=new Set,c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:++a[0];s!==t&&(s=t,l.forEach(i=>i(e,t)))};let d=a[1];const u=e=>(t,i)=>{const n=[...t];n[1]=[e,...n[1]],c(n,i)},h=new Map,p=e=>{const t=h.get(e);var i;t&&(h.delete(e),null===(i=t[1])||void 0===i||i.call(t))},f=Array.isArray(i)?[]:Object.create(Object.getPrototypeOf(i)),m={deleteProperty(e,t){const i=Reflect.get(e,t);p(t);const n=Reflect.deleteProperty(e,t);return n&&c(["delete",[t],i]),n},set(t,i,n,a){var o;const s=Reflect.has(t,i),d=Reflect.get(t,i,a);if(s&&(e(d,n)||r.has(n)&&e(d,r.get(n))))return!0;var f;p(i),hb(n)&&(n=lb(f=n)&&f[ab]||null||n);let m=n;if(null!==(o=Object.getOwnPropertyDescriptor(t,i))&&void 0!==o&&o.set);else{!fb.has(n)&&pb(n)&&(m=gb(n));const e=!ub.has(m)&&fb.get(m);e&&((e,t)=>{if(l.size){const i=t[3](u(e));h.set(e,[t,i])}else h.set(e,[t])})(i,e)}return Reflect.set(t,i,m,a),c(["set",[i],n,d]),!0}},g=t(f,m);r.set(i,g);const v=[f,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:++a[1];return d===e||l.size||(d=e,h.forEach(t=>{let[i]=t;const n=i[1](e);n>s&&(s=n)})),s},n,e=>{l.add(e),1===l.size&&h.forEach((e,t)=>{let[i,n]=e;const r=i[3](u(t));h.set(t,[i,r])});return()=>{l.delete(e),0===l.size&&h.forEach((e,t)=>{let[i,n]=e;n&&(n(),h.set(t,[i]))})}}];return fb.set(g,v),Reflect.ownKeys(i).forEach(e=>{const t=Object.getOwnPropertyDescriptor(i,e);t.get||t.set?Object.defineProperty(f,e,t):g[e]=i[e]}),g};return[o,fb,ub,e,t,pb,i,n,r,a]}();function gb(){return mb(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function vb(e){const t=fb.get(e);const[i,n,r]=t;return r(i,n())}var yb=ka("tooltip").parts("trigger","arrow","arrowTip","positioner","content"),bb=(yb.build(),e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.trigger)&&void 0!==t?t:"tooltip:".concat(e.id,":trigger")}),xb=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.positioner)&&void 0!==t?t:"tooltip:".concat(e.id,":popper")},wb=e=>e.getById(bb(e)),Sb=e=>e.getById(xb(e)),_b=gb({id:null});var{and:Cb,not:Eb}=Qd(),Ab=(Cb("noVisibleTooltip",Eb("hasPointerMoveOpened")),Eb("hasPointerMoveOpened"),pu()(["aria-label","closeDelay","closeOnEscape","closeOnPointerDown","closeOnScroll","closeOnClick","dir","disabled","getRootNode","id","ids","interactive","onOpenChange","defaultOpen","open","openDelay","positioning"]));Ro(Ab);const Mb={slots:yb.keys(),className:"chakra-tooltip",base:{content:{"--tooltip-bg":"colors.bg.inverted",bg:"var(--tooltip-bg)",color:"fg.inverted",px:"2.5",py:"1",borderRadius:"l2",fontWeight:"medium",textStyle:"xs",boxShadow:"md",maxW:"xs",zIndex:"tooltip",transformOrigin:"var(--transform-origin)",_open:{animationStyle:"scale-fade-in",animationDuration:"fast"},_closed:{animationStyle:"scale-fade-out",animationDuration:"fast"}},arrow:{"--arrow-size":"sizes.2","--arrow-background":"var(--tooltip-bg)"},arrowTip:{borderTopWidth:"1px",borderInlineStartWidth:"1px",borderColor:"var(--tooltip-bg)"}}};var Tb=ka("tree-view").parts("branch","branchContent","branchControl","branchIndentGuide","branchIndicator","branchText","branchTrigger","item","itemIndicator","itemText","label","nodeCheckbox","root","tree"),Pb=(Tb.build(),e=>new as(e));Pb.empty=()=>new as({rootNode:{children:[]}});var Db=(e,t)=>{var i,n,r;return null!==(i=null===(n=e.ids)||void 0===n||null===(r=n.node)||void 0===r?void 0:r.call(n,t))&&void 0!==i?i:"tree:".concat(e.id,":node:").concat(t)},Ob=(e,t)=>{var i;null!=t&&(null===(i=e.getById(Db(e,t)))||void 0===i||i.focus())};function Ib(e,t){const{context:i,prop:n,refs:r}=e;if(!n("loadChildren"))return void i.set("expandedValue",e=>Va(Fa(e,...t)));const a=i.get("loadingStatus"),[o,s]=qa(t,e=>"loaded"===a[e]);if(o.length>0&&i.set("expandedValue",e=>Va(Fa(e,...o))),0===s.length)return;const l=n("collection"),[d,u]=qa(s,e=>{const t=l.findNode(e);return l.getNodeChildren(t).length>0});if(d.length>0&&i.set("expandedValue",e=>Va(Fa(e,...d))),0===u.length)return;i.set("loadingStatus",e=>c(c({},e),u.reduce((e,t)=>c(c({},e),{},{[t]:"loading"}),{})));const h=u.map(e=>{const t=l.getIndexPath(e);return{id:e,indexPath:t,valuePath:l.getValuePath(t),node:l.findNode(e)}}),p=r.get("pendingAborts"),f=n("loadChildren");zo(f,()=>"[zag-js/tree-view] `loadChildren` is required for async expansion");const m=h.map(e=>{let{id:t,indexPath:i,valuePath:n,node:r}=e;const a=p.get(t);a&&(a.abort(),p.delete(t));const o=new AbortController;return p.set(t,o),f({valuePath:n,indexPath:i,node:r,signal:o.signal})});Promise.allSettled(m).then(e=>{const t=[],r=[],a=i.get("loadingStatus");let o=n("collection");var s,l;(e.forEach((e,i)=>{const{id:n,indexPath:s,node:l,valuePath:d}=h[i];"fulfilled"===e.status?(a[n]="loaded",t.push(n),o.replace(s,c(c({},l),{},{children:e.value}))):(p.delete(n),Reflect.deleteProperty(a,n),r.push({node:l,error:e.reason,indexPath:s,valuePath:d}))}),i.set("loadingStatus",a),t.length)&&(i.set("expandedValue",e=>Va(Fa(e,...t))),null===n("onLoadChildrenComplete")||void 0===s||s({collection:o}));r.length&&(null===n("onLoadChildrenError")||void 0===l||l({nodes:r}))})}function kb(e){const{prop:t,context:i}=e;return function(e){let{indexPath:n}=e;return t("collection").getValuePath(n).slice(0,-1).some(e=>!i.get("expandedValue").includes(e))}}var{and:Rb}=Qd(),zb=(Rb("isMultipleSelection","moveFocus"),Rb("isShiftKey","isMultipleSelection"),Rb("isShiftKey","isMultipleSelection"),Rb("isBranchFocused","isBranchExpanded"),Rb("isShiftKey","isMultipleSelection"),Rb("isShiftKey","isMultipleSelection"),Rb("isCtrlKey","isMultipleSelection"),Rb("isShiftKey","isMultipleSelection"),Rb("isCtrlKey","isMultipleSelection"),Rb("isShiftKey","isMultipleSelection"),pu()(["ids","collection","dir","expandedValue","expandOnClick","defaultFocusedValue","focusedValue","getRootNode","id","onExpandedChange","onFocusChange","onSelectionChange","checkedValue","selectedValue","selectionMode","typeahead","defaultExpandedValue","defaultSelectedValue","defaultCheckedValue","onCheckedChange","onLoadChildrenComplete","onLoadChildrenError","loadChildren"])),Lb=(Ro(zb),pu()(["node","indexPath"]));Ro(Lb);const Bb={display:"flex",alignItems:"center",gap:"var(--tree-item-gap)",rounded:"l2",userSelect:"none",position:"relative","--tree-depth":"calc(var(--depth) - 1)","--tree-indentation-offset":"calc(var(--tree-indentation) * var(--tree-depth))","--tree-icon-offset":"calc(var(--tree-icon-size) * var(--tree-depth) * 0.5)","--tree-offset":"calc(var(--tree-padding-inline) + var(--tree-indentation-offset) + var(--tree-icon-offset))",ps:"var(--tree-offset)",pe:"var(--tree-padding-inline)",py:"var(--tree-padding-block)",focusVisibleRing:"inside",focusRingColor:"border.emphasized",focusRingWidth:"2px","&:hover, &:focus-visible":{bg:"bg.muted"},_disabled:{layerStyle:"disabled"}},Nb={flex:"1"},Fb={_selected:{bg:"colorPalette.subtle",color:"colorPalette.fg"}},Ub={_selected:{layerStyle:"fill.solid"}},Vb={accordion:wm,actionBar:Sm,alert:_m,avatar:Am,blockquote:Mm,breadcrumb:Tm,card:Pm,checkbox:Hm,checkboxCard:Jm,codeBlock:$m,collapsible:ig,dataList:fg,dialog:mg,drawer:gg,editable:yg,emptyState:bg,field:xg,fieldset:wg,fileUpload:Sg,hoverCard:Ig,list:kg,menu:Rg,nativeSelect:Ng,numberInput:xv,pinInput:zv,popover:Lv,progress:Wv,progressCircle:Hv,radioCard:zy,radioGroup:Wy,ratingGroup:Hy,segmentGroup:qy,select:zg,combobox:pg,slider:Xy,stat:Yy,steps:Ky,switch:Zy,table:Jy,tabs:$y,tag:ib,toast:rb,tooltip:Mb,status:Qy,timeline:nb,colorPicker:hg,qrCode:My,treeView:{slots:Tb.keys(),className:"chakra-tree-view",base:{root:{width:"full",display:"flex",flexDirection:"column",gap:"2"},tree:{display:"flex",flexDirection:"column","--tree-item-gap":"spacing.2",_icon:{boxSize:"var(--tree-icon-size)"}},label:{fontWeight:"medium",textStyle:"sm"},branch:{position:"relative"},branchContent:{position:"relative"},branchIndentGuide:{height:"100%",width:"1px",bg:"border",position:"absolute","--tree-depth":"calc(var(--depth) - 1)","--tree-indentation-offset":"calc(var(--tree-indentation) * var(--tree-depth))","--tree-offset":"calc(var(--tree-padding-inline) + var(--tree-indentation-offset))","--tree-icon-offset":"calc(var(--tree-icon-size) * 0.5 * var(--depth))",insetInlineStart:"calc(var(--tree-offset) + var(--tree-icon-offset))",zIndex:"1"},branchIndicator:{color:"fg.muted",transformOrigin:"center",transitionDuration:"normal",transitionProperty:"transform",transitionTimingFunction:"default",_open:{transform:"rotate(90deg)"}},branchTrigger:{display:"inline-flex",alignItems:"center",justifyContent:"center"},branchControl:Bb,item:Bb,itemText:Nb,branchText:Nb,nodeCheckbox:{display:"inline-flex"}},variants:{size:{md:{tree:{textStyle:"sm","--tree-indentation":"spacing.4","--tree-padding-inline":"spacing.3","--tree-padding-block":"spacing.1.5","--tree-icon-size":"spacing.4"}},sm:{tree:{textStyle:"sm","--tree-indentation":"spacing.4","--tree-padding-inline":"spacing.3","--tree-padding-block":"spacing.1","--tree-icon-size":"spacing.3"}},xs:{tree:{textStyle:"xs","--tree-indentation":"spacing.4","--tree-padding-inline":"spacing.2","--tree-padding-block":"spacing.1","--tree-icon-size":"spacing.3"}}},variant:{subtle:{branchControl:Fb,item:Fb},solid:{branchControl:Ub,item:Ub}},animateContent:{true:{branchContent:{_open:{animationName:"expand-height, fade-in",animationDuration:"moderate"},_closed:{animationName:"collapse-height, fade-out",animationDuration:"moderate"}}}}},defaultVariants:{size:"md",variant:"subtle"}}},jb={"2xs":{value:{fontSize:"2xs",lineHeight:"0.75rem"}},xs:{value:{fontSize:"xs",lineHeight:"1rem"}},sm:{value:{fontSize:"sm",lineHeight:"1.25rem"}},md:{value:{fontSize:"md",lineHeight:"1.5rem"}},lg:{value:{fontSize:"lg",lineHeight:"1.75rem"}},xl:{value:{fontSize:"xl",lineHeight:"1.875rem"}},"2xl":{value:{fontSize:"2xl",lineHeight:"2rem"}},"3xl":{value:{fontSize:"3xl",lineHeight:"2.375rem"}},"4xl":{value:{fontSize:"4xl",lineHeight:"2.75rem",letterSpacing:"-0.025em"}},"5xl":{value:{fontSize:"5xl",lineHeight:"3.75rem",letterSpacing:"-0.025em"}},"6xl":{value:{fontSize:"6xl",lineHeight:"4.5rem",letterSpacing:"-0.025em"}},"7xl":{value:{fontSize:"7xl",lineHeight:"5.75rem",letterSpacing:"-0.025em"}},none:{value:{}},label:{value:{fontSize:"sm",lineHeight:"1.25rem",fontWeight:"medium"}}},Wb=pn.animations({spin:{value:"spin 1s linear infinite"},ping:{value:"ping 1s cubic-bezier(0, 0, 0.2, 1) infinite"},pulse:{value:"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"},bounce:{value:"bounce 1s infinite"}}),Hb=pn.aspectRatios({square:{value:"1 / 1"},landscape:{value:"4 / 3"},portrait:{value:"3 / 4"},wide:{value:"16 / 9"},ultrawide:{value:"18 / 5"},golden:{value:"1.618 / 1"}}),Gb=pn.blurs({none:{value:" "},sm:{value:"4px"},md:{value:"8px"},lg:{value:"12px"},xl:{value:"16px"},"2xl":{value:"24px"},"3xl":{value:"40px"},"4xl":{value:"64px"}}),qb=pn.borders({xs:{value:"0.5px solid"},sm:{value:"1px solid"},md:{value:"2px solid"},lg:{value:"4px solid"},xl:{value:"8px solid"}}),Xb=pn.colors({transparent:{value:"transparent"},current:{value:"currentColor"},black:{value:"#09090B"},white:{value:"#FFFFFF"},whiteAlpha:{50:{value:"rgba(255, 255, 255, 0.04)"},100:{value:"rgba(255, 255, 255, 0.06)"},200:{value:"rgba(255, 255, 255, 0.08)"},300:{value:"rgba(255, 255, 255, 0.16)"},400:{value:"rgba(255, 255, 255, 0.24)"},500:{value:"rgba(255, 255, 255, 0.36)"},600:{value:"rgba(255, 255, 255, 0.48)"},700:{value:"rgba(255, 255, 255, 0.64)"},800:{value:"rgba(255, 255, 255, 0.80)"},900:{value:"rgba(255, 255, 255, 0.92)"},950:{value:"rgba(255, 255, 255, 0.95)"}},blackAlpha:{50:{value:"rgba(0, 0, 0, 0.04)"},100:{value:"rgba(0, 0, 0, 0.06)"},200:{value:"rgba(0, 0, 0, 0.08)"},300:{value:"rgba(0, 0, 0, 0.16)"},400:{value:"rgba(0, 0, 0, 0.24)"},500:{value:"rgba(0, 0, 0, 0.36)"},600:{value:"rgba(0, 0, 0, 0.48)"},700:{value:"rgba(0, 0, 0, 0.64)"},800:{value:"rgba(0, 0, 0, 0.80)"},900:{value:"rgba(0, 0, 0, 0.92)"},950:{value:"rgba(0, 0, 0, 0.95)"}},gray:{50:{value:"#fafafa"},100:{value:"#f4f4f5"},200:{value:"#e4e4e7"},300:{value:"#d4d4d8"},400:{value:"#a1a1aa"},500:{value:"#71717a"},600:{value:"#52525b"},700:{value:"#3f3f46"},800:{value:"#27272a"},900:{value:"#18181b"},950:{value:"#111111"}},red:{50:{value:"#fef2f2"},100:{value:"#fee2e2"},200:{value:"#fecaca"},300:{value:"#fca5a5"},400:{value:"#f87171"},500:{value:"#ef4444"},600:{value:"#dc2626"},700:{value:"#991919"},800:{value:"#511111"},900:{value:"#300c0c"},950:{value:"#1f0808"}},orange:{50:{value:"#fff7ed"},100:{value:"#ffedd5"},200:{value:"#fed7aa"},300:{value:"#fdba74"},400:{value:"#fb923c"},500:{value:"#f97316"},600:{value:"#ea580c"},700:{value:"#92310a"},800:{value:"#6c2710"},900:{value:"#3b1106"},950:{value:"#220a04"}},yellow:{50:{value:"#fefce8"},100:{value:"#fef9c3"},200:{value:"#fef08a"},300:{value:"#fde047"},400:{value:"#facc15"},500:{value:"#eab308"},600:{value:"#ca8a04"},700:{value:"#845209"},800:{value:"#713f12"},900:{value:"#422006"},950:{value:"#281304"}},green:{50:{value:"#f0fdf4"},100:{value:"#dcfce7"},200:{value:"#bbf7d0"},300:{value:"#86efac"},400:{value:"#4ade80"},500:{value:"#22c55e"},600:{value:"#16a34a"},700:{value:"#116932"},800:{value:"#124a28"},900:{value:"#042713"},950:{value:"#03190c"}},teal:{50:{value:"#f0fdfa"},100:{value:"#ccfbf1"},200:{value:"#99f6e4"},300:{value:"#5eead4"},400:{value:"#2dd4bf"},500:{value:"#14b8a6"},600:{value:"#0d9488"},700:{value:"#0c5d56"},800:{value:"#114240"},900:{value:"#032726"},950:{value:"#021716"}},blue:{50:{value:"#eff6ff"},100:{value:"#dbeafe"},200:{value:"#bfdbfe"},300:{value:"#a3cfff"},400:{value:"#60a5fa"},500:{value:"#3b82f6"},600:{value:"#2563eb"},700:{value:"#173da6"},800:{value:"#1a3478"},900:{value:"#14204a"},950:{value:"#0c142e"}},cyan:{50:{value:"#ecfeff"},100:{value:"#cffafe"},200:{value:"#a5f3fc"},300:{value:"#67e8f9"},400:{value:"#22d3ee"},500:{value:"#06b6d4"},600:{value:"#0891b2"},700:{value:"#0c5c72"},800:{value:"#134152"},900:{value:"#072a38"},950:{value:"#051b24"}},purple:{50:{value:"#faf5ff"},100:{value:"#f3e8ff"},200:{value:"#e9d5ff"},300:{value:"#d8b4fe"},400:{value:"#c084fc"},500:{value:"#a855f7"},600:{value:"#9333ea"},700:{value:"#641ba3"},800:{value:"#4a1772"},900:{value:"#2f0553"},950:{value:"#1a032e"}},pink:{50:{value:"#fdf2f8"},100:{value:"#fce7f3"},200:{value:"#fbcfe8"},300:{value:"#f9a8d4"},400:{value:"#f472b6"},500:{value:"#ec4899"},600:{value:"#db2777"},700:{value:"#a41752"},800:{value:"#6d0e34"},900:{value:"#45061f"},950:{value:"#2c0514"}}}),Yb=pn.cursor({button:{value:"pointer"},checkbox:{value:"default"},disabled:{value:"not-allowed"},menuitem:{value:"default"},option:{value:"default"},radio:{value:"default"},slider:{value:"default"},switch:{value:"pointer"}}),Qb=pn.durations({fastest:{value:"50ms"},faster:{value:"100ms"},fast:{value:"150ms"},moderate:{value:"200ms"},slow:{value:"300ms"},slower:{value:"400ms"},slowest:{value:"500ms"}}),Kb=pn.easings({"ease-in":{value:"cubic-bezier(0.42, 0, 1, 1)"},"ease-out":{value:"cubic-bezier(0, 0, 0.58, 1)"},"ease-in-out":{value:"cubic-bezier(0.42, 0, 0.58, 1)"},"ease-in-smooth":{value:"cubic-bezier(0.32, 0.72, 0, 1)"}}),Zb=pn.fontSizes({"2xs":{value:"0.625rem"},xs:{value:"0.75rem"},sm:{value:"0.875rem"},md:{value:"1rem"},lg:{value:"1.125rem"},xl:{value:"1.25rem"},"2xl":{value:"1.5rem"},"3xl":{value:"1.875rem"},"4xl":{value:"2.25rem"},"5xl":{value:"3rem"},"6xl":{value:"3.75rem"},"7xl":{value:"4.5rem"},"8xl":{value:"6rem"},"9xl":{value:"8rem"}}),Jb=pn.fontWeights({thin:{value:"100"},extralight:{value:"200"},light:{value:"300"},normal:{value:"400"},medium:{value:"500"},semibold:{value:"600"},bold:{value:"700"},extrabold:{value:"800"},black:{value:"900"}}),$b='-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',ex=pn.fonts({heading:{value:"Inter, ".concat($b)},body:{value:"Inter, ".concat($b)},mono:{value:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'}}),tx={spin:{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}},pulse:{"50%":{opacity:"0.5"}},ping:{"75%, 100%":{transform:"scale(2)",opacity:"0"}},bounce:{"0%, 100%":{transform:"translateY(-25%)",animationTimingFunction:"cubic-bezier(0.8,0,1,1)"},"50%":{transform:"none",animationTimingFunction:"cubic-bezier(0,0,0.2,1)"}},"bg-position":{from:{backgroundPosition:"var(--animate-from, 1rem) 0"},to:{backgroundPosition:"var(--animate-to, 0) 0"}},position:{from:{insetInlineStart:"var(--animate-from-x)",insetBlockStart:"var(--animate-from-y)"},to:{insetInlineStart:"var(--animate-to-x)",insetBlockStart:"var(--animate-to-y)"}},"circular-progress":{"0%":{strokeDasharray:"1, 400",strokeDashoffset:"0"},"50%":{strokeDasharray:"400, 400",strokeDashoffset:"-100%"},"100%":{strokeDasharray:"400, 400",strokeDashoffset:"-260%"}},"expand-height":{from:{height:"0"},to:{height:"var(--height)"}},"collapse-height":{from:{height:"var(--height)"},to:{height:"0"}},"expand-width":{from:{width:"0"},to:{width:"var(--width)"}},"collapse-width":{from:{height:"var(--width)"},to:{height:"0"}},"fade-in":{from:{opacity:0},to:{opacity:1}},"fade-out":{from:{opacity:1},to:{opacity:0}},"slide-from-left-full":{from:{translate:"-100% 0"},to:{translate:"0 0"}},"slide-from-right-full":{from:{translate:"100% 0"},to:{translate:"0 0"}},"slide-from-top-full":{from:{translate:"0 -100%"},to:{translate:"0 0"}},"slide-from-bottom-full":{from:{translate:"0 100%"},to:{translate:"0 0"}},"slide-to-left-full":{from:{translate:"0 0"},to:{translate:"-100% 0"}},"slide-to-right-full":{from:{translate:"0 0"},to:{translate:"100% 0"}},"slide-to-top-full":{from:{translate:"0 0"},to:{translate:"0 -100%"}},"slide-to-bottom-full":{from:{translate:"0 0"},to:{translate:"0 100%"}},"slide-from-top":{"0%":{translate:"0 -0.5rem"},to:{translate:"0"}},"slide-from-bottom":{"0%":{translate:"0 0.5rem"},to:{translate:"0"}},"slide-from-left":{"0%":{translate:"-0.5rem 0"},to:{translate:"0"}},"slide-from-right":{"0%":{translate:"0.5rem 0"},to:{translate:"0"}},"slide-to-top":{"0%":{translate:"0"},to:{translate:"0 -0.5rem"}},"slide-to-bottom":{"0%":{translate:"0"},to:{translate:"0 0.5rem"}},"slide-to-left":{"0%":{translate:"0"},to:{translate:"-0.5rem 0"}},"slide-to-right":{"0%":{translate:"0"},to:{translate:"0.5rem 0"}},"scale-in":{from:{scale:"0.95"},to:{scale:"1"}},"scale-out":{from:{scale:"1"},to:{scale:"0.95"}}},ix=pn.letterSpacings({tighter:{value:"-0.05em"},tight:{value:"-0.025em"},wide:{value:"0.025em"},wider:{value:"0.05em"},widest:{value:"0.1em"}}),nx=pn.lineHeights({shorter:{value:1.25},short:{value:1.375},moderate:{value:1.5},tall:{value:1.625},taller:{value:2}}),rx=pn.radii({none:{value:"0"},"2xs":{value:"0.0625rem"},xs:{value:"0.125rem"},sm:{value:"0.25rem"},md:{value:"0.375rem"},lg:{value:"0.5rem"},xl:{value:"0.75rem"},"2xl":{value:"1rem"},"3xl":{value:"1.5rem"},"4xl":{value:"2rem"},full:{value:"9999px"}}),ax=pn.spacing({.5:{value:"0.125rem"},1:{value:"0.25rem"},1.5:{value:"0.375rem"},2:{value:"0.5rem"},2.5:{value:"0.625rem"},3:{value:"0.75rem"},3.5:{value:"0.875rem"},4:{value:"1rem"},4.5:{value:"1.125rem"},5:{value:"1.25rem"},6:{value:"1.5rem"},7:{value:"1.75rem"},8:{value:"2rem"},9:{value:"2.25rem"},10:{value:"2.5rem"},11:{value:"2.75rem"},12:{value:"3rem"},14:{value:"3.5rem"},16:{value:"4rem"},20:{value:"5rem"},24:{value:"6rem"},28:{value:"7rem"},32:{value:"8rem"},36:{value:"9rem"},40:{value:"10rem"},44:{value:"11rem"},48:{value:"12rem"},52:{value:"13rem"},56:{value:"14rem"},60:{value:"15rem"},64:{value:"16rem"},72:{value:"18rem"},80:{value:"20rem"},96:{value:"24rem"}}),ox=pn.sizes({"3xs":{value:"14rem"},"2xs":{value:"16rem"},xs:{value:"20rem"},sm:{value:"24rem"},md:{value:"28rem"},lg:{value:"32rem"},xl:{value:"36rem"},"2xl":{value:"42rem"},"3xl":{value:"48rem"},"4xl":{value:"56rem"},"5xl":{value:"64rem"},"6xl":{value:"72rem"},"7xl":{value:"80rem"},"8xl":{value:"90rem"}}),sx=pn.sizes({max:{value:"max-content"},min:{value:"min-content"},fit:{value:"fit-content"},prose:{value:"60ch"},full:{value:"100%"},dvh:{value:"100dvh"},svh:{value:"100svh"},lvh:{value:"100lvh"},dvw:{value:"100dvw"},svw:{value:"100svw"},lvw:{value:"100lvw"},vw:{value:"100vw"},vh:{value:"100vh"}}),lx=pn.sizes({"1/2":{value:"50%"},"1/3":{value:"33.333333%"},"2/3":{value:"66.666667%"},"1/4":{value:"25%"},"3/4":{value:"75%"},"1/5":{value:"20%"},"2/5":{value:"40%"},"3/5":{value:"60%"},"4/5":{value:"80%"},"1/6":{value:"16.666667%"},"2/6":{value:"33.333333%"},"3/6":{value:"50%"},"4/6":{value:"66.666667%"},"5/6":{value:"83.333333%"},"1/12":{value:"8.333333%"},"2/12":{value:"16.666667%"},"3/12":{value:"25%"},"4/12":{value:"33.333333%"},"5/12":{value:"41.666667%"},"6/12":{value:"50%"},"7/12":{value:"58.333333%"},"8/12":{value:"66.666667%"},"9/12":{value:"75%"},"10/12":{value:"83.333333%"},"11/12":{value:"91.666667%"}}),cx=pn.sizes(c(c(c(c({},ox),ax),lx),sx)),dx=pn.zIndex({hide:{value:-1},base:{value:0},docked:{value:10},dropdown:{value:1e3},sticky:{value:1100},banner:{value:1200},overlay:{value:1300},modal:{value:1400},popover:{value:1500},skipNav:{value:1600},toast:{value:1700},tooltip:{value:1800},max:{value:2147483647}}),ux=function(){var e,t,i,n,r,a,o,s,l,c;const d=mn(...arguments),{theme:u={},utilities:h={},globalCss:p={},cssVarsRoot:f=":where(:root, :host)",cssVarsPrefix:m="chakra",preflight:g}=d,v=function(e){var t;const i=null!==(t=e.layers)&&void 0!==t?t:Mr,n=Object.values(i).sort((e,t)=>Tr[e]-Tr[t]);return{names:n,atRule:"@layer ".concat(n.join(", "),";"),wrap(t,n){if(e.disableLayers)return n;const r=i[t];return{["@layer ".concat(r)]:n}}}}(d),y=sa({breakpoints:u.breakpoints,tokens:u.tokens,semanticTokens:u.semanticTokens,prefix:m}),b=Zn(null!==(e=u.breakpoints)&&void 0!==e?e:ua),x=er({conditions:null!==(t=d.conditions)&&void 0!==t?t:ua,breakpoints:b}),w=da({config:h,tokens:y});!function(){const{textStyles:e,layerStyles:t,animationStyles:i}=u,n=Ln({textStyle:e,layerStyle:t,animationStyle:i});for(const[r,a]of Object.entries(n)){const e=Un(null!==a&&void 0!==a?a:ua,ha);w.register(r,{values:Object.keys(e),transform:t=>M(e[t])})}}(),w.addPropertyType("animationName",Object.keys(null!==(i=u.keyframes)&&void 0!==i?i:ua));const S=new Set(["css",...w.keys(),...x.keys()]),_=jn(e=>S.has(e)||zn(e)),C=e=>Array.isArray(e)?e.reduce((e,t,i)=>{const n=x.breakpoints[i];return null!=t&&(e[n]=t),e},{}):e,E=function(e){const{utility:t,normalize:i}=e,{hasShorthand:n,resolveShorthand:r}=t;return function(e){return Nn(e,i,{stop:e=>Array.isArray(e),getKey:n?r:void 0})}}({utility:w,normalize:C}),A=function(e){const{conditions:t,isValidProperty:i}=e;return function(e){return Nn(e,e=>e,{getKey:(e,n)=>sn(n)?t.has(e)||i(e)?e:function(e){const t=[];let i=0,n="",r=!1;for(let a=0;a<e.length;a++){const o=e[a];"\\"!==o||r?r?(r=!1,n+=o):("("===o?i++:")"===o&&i--,","===o&&0===i?(t.push(n.trim()),n=""):n+=o):(r=!0,n+=o)}return n&&t.push(n.trim()),t}(e).map(e=>"&"+e).join(", "):e})}}({conditions:x,isValidProperty:_}),M=wr({transform:w.transform,conditions:x,normalize:E}),T=Ar({css:M,conditions:x,normalize:E,layers:v}),P=Dr({cva:T});function D(){const e={};for(const[t,i]of y.cssVarMap.entries()){const n=Object.fromEntries(i);if(0===Object.keys(n).length)continue;const r="base"===t?f:x.resolve(t),a=r.startsWith("@");un(e,M(A({[r]:a?{[f]:n}:n})))}return v.wrap("tokens",e)}function O(){var e;const t=Object.fromEntries(Object.entries(null!==(e=u.keyframes)&&void 0!==e?e:ua).map(e=>{let[t,i]=e;return["@keyframes ".concat(t),i]})),i=Object.assign({},t,M(A(p)));return v.wrap("base",i)}function I(){const e=function(e){const{preflight:t}=e;if(!t)return{};const{scope:i="",level:n="parent"}=sn(t)?t:{};let r="";i&&"parent"===n?r="".concat(i," "):i&&"element"===n&&(r="&".concat(i));const a={"*":{margin:"0px",padding:"0px",font:"inherit",wordWrap:"break-word",WebkitTapHighlightColor:"transparent"},"*, *::before, *::after, *::backdrop":{boxSizing:"border-box",borderWidth:"0px",borderStyle:"solid",borderColor:"var(--global-color-border, currentColor)"},hr:{height:"0px",color:"inherit",borderTopWidth:"1px"},body:{minHeight:"100dvh",position:"relative"},img:{borderStyle:"none"},"img, svg, video, canvas, audio, iframe, embed, object":{display:"block",verticalAlign:"middle"},iframe:{border:"none"},"img, video":{maxWidth:"100%",height:"auto"},"p, h1, h2, h3, h4, h5, h6":{overflowWrap:"break-word"},"ol, ul":{listStyle:"none"},"code, kbd, pre, samp":{fontSize:"1em"},"button, [type='button'], [type='reset'], [type='submit']":{WebkitAppearance:"button",backgroundColor:"transparent",backgroundImage:"none"},"button, input, optgroup, select, textarea":{color:"inherit"},"button, select":{textTransform:"none"},table:{textIndent:"0px",borderColor:"inherit",borderCollapse:"collapse"},"*::placeholder":{opacity:"unset",color:"#9ca3af",userSelect:"none"},textarea:{resize:"vertical"},summary:{display:"list-item"},small:{fontSize:"80%"},"sub, sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sub:{bottom:"-0.25em"},sup:{top:"-0.5em"},dialog:{padding:"0px"},a:{color:"inherit",textDecoration:"inherit"},"abbr:where([title])":{textDecoration:"underline dotted"},"b, strong":{fontWeight:"bolder"},"code, kbd, samp, pre":{fontSize:"1em","--font-mono-fallback":"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New'",fontFamily:"var(--global-font-mono, var(--font-mono-fallback))"},'input[type="text"], input[type="email"], input[type="search"], input[type="password"]':{WebkitAppearance:"none",MozAppearance:"none"},"input[type='search']":{WebkitAppearance:"textfield",outlineOffset:"-2px"},"::-webkit-search-decoration, ::-webkit-search-cancel-button":{WebkitAppearance:"none"},"::-webkit-file-upload-button":{WebkitAppearance:"button",font:"inherit"},'input[type="number"]::-webkit-inner-spin-button, input[type="number"]::-webkit-outer-spin-button':{height:"auto"},"input[type='number']":{MozAppearance:"textfield"},":-moz-ui-invalid":{boxShadow:"none"},":-moz-focusring":{outline:"auto"},"[hidden]:where(:not([hidden='until-found']))":{display:"none !important"}},o={[i||"html"]:{lineHeight:1.5,"--font-fallback":"ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",WebkitTextSizeAdjust:"100%",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",touchAction:"manipulation",MozTabSize:"4",tabSize:"4",fontFamily:"var(--global-font-body, var(--font-fallback))"}};if("element"===n){const e=Object.entries(a).reduce((e,t)=>{let[i,n]=t;return e[i]={[r]:n},e},{});Object.assign(o,e)}else r?o[r]=a:Object.assign(o,a);return o}({preflight:g});return v.wrap("reset",e)}const k=function(e){const t=new Map;return e.allTokens.forEach(e=>{const{cssVar:i,virtual:n,conditions:r}=e.extensions,a=r||n?i.ref:e.value;t.set(e.name,{value:a,variable:i.ref})}),t}(y),R=(e,t)=>{var i;return(null===(i=k.get(e))||void 0===i?void 0:i.value)||t};function z(e){var t;return Object.hasOwnProperty.call(null!==(t=u.recipes)&&void 0!==t?t:ua,e)}function L(e){var t;return Object.hasOwnProperty.call(null!==(t=u.slotRecipes)&&void 0!==t?t:ua,e)}R.var=(e,t)=>{var i;return(null===(i=k.get(e))||void 0===i?void 0:i.variable)||t};const B=[I(),O(),D()],N={layerStyles:pa(null!==(n=u.layerStyles)&&void 0!==n?n:ua),textStyles:pa(null!==(r=u.textStyles)&&void 0!==r?r:ua),animationStyles:pa(null!==(a=u.animationStyles)&&void 0!==a?a:ua),tokens:fa(y,Object.keys(null!==(o=u.tokens)&&void 0!==o?o:ua),(e,t)=>!e.extensions.conditions&&!t.includes("colorPalette")),semanticTokens:fa(y,Object.keys(null!==(s=u.semanticTokens)&&void 0!==s?s:ua),e=>!!e.extensions.conditions),keyframes:ma(null!==(l=u.keyframes)&&void 0!==l?l:ua),breakpoints:ma(null!==(c=u.breakpoints)&&void 0!==c?c:ua)};return{$$chakra:!0,_config:d,_global:B,breakpoints:b,tokens:y,conditions:x,utility:w,token:R,properties:S,layers:v,isValidProperty:_,splitCssProps:function(e){return Wn(e,_)},normalizeValue:C,getTokenCss:D,getGlobalCss:O,getPreflightCss:I,css:M,cva:T,sva:P,getRecipe:function(e,t){var i,n;return null!==(i=null===(n=u.recipes)||void 0===n?void 0:n[e])&&void 0!==i?i:t},getSlotRecipe:function(e,t){var i,n;return null!==(i=null===(n=u.slotRecipes)||void 0===n?void 0:n[e])&&void 0!==i?i:t},hasRecipe:function(e){return z(e)||L(e)},isRecipe:z,isSlotRecipe:L,query:N}}(mn(Tn,{preflight:!0,cssVarsPrefix:"chakra",cssVarsRoot:":where(html, .chakra-theme)",globalCss:va,theme:{breakpoints:{sm:"480px",md:"768px",lg:"1024px",xl:"1280px","2xl":"1536px"},keyframes:tx,tokens:{aspectRatios:Hb,animations:Wb,blurs:Gb,borders:qb,colors:Xb,durations:Qb,easings:Kb,fonts:ex,fontSizes:Zb,fontWeights:Jb,letterSpacings:ix,lineHeights:nx,radii:rx,spacing:ax,sizes:cx,zIndex:dx,cursor:Yb},semanticTokens:{colors:Da,shadows:Ia,radii:Oa},recipes:Pa,slotRecipes:Vb,textStyles:jb,layerStyles:ya,animationStyles:ba}}));var hx=(e,t,i,n,r,a,o,s)=>{let l=document.documentElement,c=["light","dark"];function d(t){(Array.isArray(e)?e:[e]).forEach(e=>{let i="class"===e,n=i&&a?r.map(e=>a[e]||e):r;i?(l.classList.remove(...n),l.classList.add(a&&a[t]?a[t]:t)):l.setAttribute(e,t)}),function(e){s&&c.includes(e)&&(l.style.colorScheme=e)}(t)}if(n)d(n);else try{let e=localStorage.getItem(t)||i;d(o&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e)}catch(Lq){}},px=["light","dark"],fx="(prefers-color-scheme: dark)",mx="undefined"==typeof window,gx=e.createContext(void 0),vx=t=>e.useContext(gx)?e.createElement(e.Fragment,null,t.children):e.createElement(bx,c({},t)),yx=["light","dark"],bx=t=>{let{forcedTheme:i,disableTransitionOnChange:n=!1,enableSystem:r=!0,enableColorScheme:a=!0,storageKey:o="theme",themes:s=yx,defaultTheme:l=(r?"system":"light"),attribute:c="data-theme",value:d,children:u,nonce:h,scriptProps:p}=t,[f,m]=e.useState(()=>wx(o,l)),[g,v]=e.useState(()=>"system"===f?_x():f),y=d?Object.values(d):s,b=e.useCallback(e=>{let t=e;if(!t)return;"system"===e&&r&&(t=_x());let i=d?d[t]:t,o=n?Sx(h):null,s=document.documentElement,u=e=>{"class"===e?(s.classList.remove(...y),i&&s.classList.add(i)):e.startsWith("data-")&&(i?s.setAttribute(e,i):s.removeAttribute(e))};if(Array.isArray(c)?c.forEach(u):u(c),a){let e=px.includes(l)?l:null,i=px.includes(t)?t:e;s.style.colorScheme=i}null==o||o()},[h]),x=e.useCallback(e=>{let t="function"==typeof e?e(f):e;m(t);try{localStorage.setItem(o,t)}catch(i){}},[f]),w=e.useCallback(e=>{let t=_x(e);v(t),"system"===f&&r&&!i&&b("system")},[f,i]);e.useEffect(()=>{let e=window.matchMedia(fx);return e.addListener(w),w(e),()=>e.removeListener(w)},[w]),e.useEffect(()=>{let e=e=>{e.key===o&&(e.newValue?m(e.newValue):x(l))};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[x]),e.useEffect(()=>{b(null!=i?i:f)},[i,f]);let S=e.useMemo(()=>({theme:f,setTheme:x,forcedTheme:i,resolvedTheme:"system"===f?g:f,themes:r?[...s,"system"]:s,systemTheme:r?g:void 0}),[f,x,i,g,r,s]);return e.createElement(gx.Provider,{value:S},e.createElement(xx,{forcedTheme:i,storageKey:o,attribute:c,enableSystem:r,enableColorScheme:a,defaultTheme:l,value:d,themes:s,nonce:h,scriptProps:p}),u)},xx=e.memo(t=>{let{forcedTheme:i,storageKey:n,attribute:r,enableSystem:a,enableColorScheme:o,defaultTheme:s,value:l,themes:d,nonce:u,scriptProps:h}=t,p=JSON.stringify([r,n,s,i,d,l,a,o]).slice(1,-1);return e.createElement("script",c(c({},h),{},{suppressHydrationWarning:!0,nonce:"undefined"==typeof window?u:"",dangerouslySetInnerHTML:{__html:"(".concat(hx.toString(),")(").concat(p,")")}}))}),wx=(e,t)=>{if(mx)return;let i;try{i=localStorage.getItem(e)||void 0}catch(n){}return i||t},Sx=e=>{let t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},_x=e=>(e||(e=window.matchMedia(fx)),e.matches?"dark":"light");function Cx(e){return(0,_t.jsx)(vx,c(c({attribute:"class",disableTransitionOnChange:!0},e),{},{forcedTheme:"light"}))}function Ex(e){return(0,_t.jsx)(rn,{value:ux,children:(0,_t.jsx)(Cx,c({},e))})}var Ax=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Mx=Di(function(e){return Ax.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91});function Tx(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];t.forEach(e=>null===e||void 0===e?void 0:e(...i))}}const Px=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.map(e=>{var t;return null===e||void 0===e||null===(t=e.trim)||void 0===t?void 0:t.call(e)}).filter(Boolean).join(" ")},Dx=/^on[A-Z]/;function Ox(){let e={};for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];for(let o of i){for(let t in e){var r,a;if(Dx.test(t)&&"function"===typeof e[t]&&"function"===typeof o[t])e[t]=Tx(e[t],o[t]);else if("className"!==t&&"class"!==t)if("style"!==t)e[t]=void 0!==o[t]?o[t]:e[t];else e[t]=Object.assign({},null!==(r=e[t])&&void 0!==r?r:{},null!==(a=o[t])&&void 0!==a?a:{});else e[t]=Px(e[t],o[t])}for(let t in o)void 0===e[t]&&(e[t]=o[t])}return e}function Ix(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return e=>{t.forEach(t=>{!function(e,t){if(null!=e)if("function"!==typeof e)try{e.current=t}catch(i){throw new Error("Cannot assign value '".concat(t,"' to ref '").concat(e,"'"))}else e(t)}(t,e)})}}const kx=["children"],Rx=["css"],zx=new Set(["htmlWidth","htmlHeight","htmlSize","htmlTranslate"]);function Lx(e){return"string"===typeof e&&zx.has(e)}const Bx=e=>(Array.isArray(e)?e:[e]).filter(Boolean).flat(),Nx=function(e){return e.default||e}(Mx),Fx=Nx,Ux=e=>"theme"!==e;let Vx="undefined"!==typeof document;const jx=e=>{let{cache:t,serialized:i,isStringTag:n}=e;Mi(t,i,n);const r=ji(()=>Ti(t,i,n));if(!Vx&&void 0!==r){let e=i.name,n=i.next;for(;void 0!==n;)e=Sr(e,n.name),n=n.next;return(0,_t.jsx)("style",c({},{"data-emotion":Sr(t.key,e),dangerouslySetInnerHTML:{__html:r},nonce:t.sheet.nonce}))}return null},Wx={path:["d"],text:["x","y"],circle:["cx","cy","r"],rect:["width","height","x","y","rx","ry"],ellipse:["cx","cy","rx","ry"],g:["transform"],stop:["offset","stopOpacity"]},Hx=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(a=Wx,o=t,Object.prototype.hasOwnProperty.call(a,o)){n.forwardProps||(n.forwardProps=[]);const e=Wx[t];n.forwardProps=Cr([...n.forwardProps,...e])}var a,o;const s=t.__emotion_real===t,l=s&&t.__emotion_base||t;let d,u;void 0!==n&&(d=n.label,u=n.target);let h=[];const p=Gi((a,o,d)=>{var p;const{cva:f,isValidProperty:m}=nn(),g=i.__cva__?i:f(i),v=Yx(t.__emotion_cva,g);var y;!n.shouldForwardProp&&n.forwardProps&&(n.shouldForwardProp=(y=n.forwardProps,(e,t)=>!!y.includes(e)||!(null!==t&&void 0!==t&&t.includes(e))&&!m(e)));const b=((e,t,i)=>{let n;if(t){const i=t.shouldForwardProp;n=e.__emotion_forwardProp&&i?t=>e.__emotion_forwardProp(t)&&i(t):i}return"function"!==typeof n&&i&&(n=e.__emotion_forwardProp),n})(t,n,s)||((e,i)=>{const n="string"===typeof t&&t.charCodeAt(0)>96?Fx:Ux,r=!(null!==i&&void 0!==i&&i.includes(e))&&!m(e);return n(e)&&r}),x=e.useMemo(()=>Object.assign({},n.defaultProps,Ln(a)),[a]),{props:w,styles:S}=function(t,i,n){const{css:a,isValidProperty:o}=nn(),{children:s}=t,l=r(t,kx),d=(0,e.useMemo)(()=>{const[e,t]=Wn(l,e=>n(e,i.variantKeys)),[r,a]=Wn(t,i.variantKeys),[s,c]=Wn(a,o);return{forwardedProps:e,variantProps:r,styleProps:s,elementProps:c}},[i.variantKeys,n,l,o]),u=d.styleProps,{css:h}=u,p=r(u,Rx),f=(0,e.useMemo)(()=>{const e=c({},d.variantProps);return i.variantKeys.includes("colorPalette")||(e.colorPalette=l.colorPalette),i.variantKeys.includes("orientation")||(e.orientation=l.orientation),i(e)},[i,d.variantProps,l.colorPalette,l.orientation]);return{styles:(0,e.useMemo)(()=>a(f,...Bx(h),p),[a,f,h,p]),props:c(c(c({},d.forwardedProps),d.elementProps),{},{children:s})}}(x,v,b);let _="",C=[S],E=w;if(null==w.theme){E={};for(let e in w)E[e]=w[e];E.theme=e.useContext(qi)}"string"===typeof w.className?_=Ai(o.registered,C,w.className):null!=w.className&&(_=Sr(_,w.className));const A=Ui(h.concat(C),o.registered,E);A.styles&&(_=Sr(_,"".concat(o.key,"-").concat(A.name))),void 0!==u&&(_=Sr(_,u));const M=!b("as");let T=M&&w.as||l,P={};for(let e in w)if(!M||"as"!==e){if(Lx(e)){P[e.replace("html","").toLowerCase()]=w[e];continue}b(e)&&(P[e]=w[e])}let D=_.trim();D?P.className=D:Reflect.deleteProperty(P,"className"),P.ref=d;const O=n.forwardAsChild||(null===(p=n.forwardProps)||void 0===p?void 0:p.includes("asChild"));if(w.asChild&&!O){const t=e.isValidElement(w.children)?e.Children.only(w.children):e.Children.toArray(w.children).find(e.isValidElement);if(!t)throw new Error("[chakra-ui > factory] No valid child found");T=t.type,P.children=null,Reflect.deleteProperty(P,"asChild"),P=Ox(P,t.props),P.ref=Ix(d,function(t){var i;const n=e.version;return ln(n)?n.startsWith("18.")?null===t||void 0===t?void 0:t.ref:null===t||void 0===t||null===(i=t.props)||void 0===i?void 0:i.ref:null===t||void 0===t?void 0:t.ref}(t))}return P.as&&O?(P.as=void 0,(0,_t.jsxs)(e.Fragment,{children:[(0,_t.jsx)(jx,{cache:o,serialized:A,isStringTag:"string"===typeof T}),(0,_t.jsx)(T,c(c({asChild:!0},P),{},{children:(0,_t.jsx)(w.as,{children:P.children})}))]})):(0,_t.jsxs)(e.Fragment,{children:[(0,_t.jsx)(jx,{cache:o,serialized:A,isStringTag:"string"===typeof T}),(0,_t.jsx)(T,c({},P))]})});return p.displayName=void 0!==d?d:"chakra(".concat("string"===typeof l?l:l.displayName||l.name||"Component",")"),p.__emotion_real=p,p.__emotion_base=l,p.__emotion_forwardProp=n.shouldForwardProp,p.__emotion_cva=i,Object.defineProperty(p,"toString",{value:()=>".".concat(u)}),p}.bind(),Gx=new Map,qx=new Proxy(Hx,{apply:(e,t,i)=>Hx(...i),get:(e,t)=>(Gx.has(t)||Gx.set(t,Hx(t)),Gx.get(t))}),Xx=qx,Yx=(e,t)=>e&&!t?e:!e&&t?t:e.merge(t),Qx=Xx("div");Qx.displayName="Box";const Kx=["templateAreas","column","row","autoFlow","autoRows","templateRows","autoColumns","templateColumns","inline"],Zx=(0,e.forwardRef)(function(e,t){const{templateAreas:i,column:n,row:a,autoFlow:o,autoRows:s,templateRows:l,autoColumns:d,templateColumns:u,inline:h}=e,p=r(e,Kx);return(0,_t.jsx)(Xx.div,c(c({},p),{},{ref:t,css:[{display:h?"inline-grid":"grid",gridTemplateAreas:i,gridAutoColumns:d,gridColumn:n,gridRow:a,gridAutoFlow:o,gridAutoRows:s,gridTemplateRows:l,gridTemplateColumns:u},e.css]}))}),Jx=Xx("div",{base:{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},variants:{axis:{horizontal:{insetStart:"50%",translate:"-50%",_rtl:{translate:"50%"}},vertical:{top:"50%",translate:"0 -50%"},both:{insetStart:"50%",top:"50%",translate:"-50% -50%",_rtl:{translate:"50% -50%"}}}},defaultVariants:{axis:"both"}});Jx.displayName="AbsoluteCenter";const $x=e=>e?"":void 0,ew=Object.freeze({}),tw=Object.freeze({});const iw=["unstyled"];function nw(t){const{key:i,recipe:n}=t,a=(o=i||n.className||"Component").charAt(0).toUpperCase()+o.slice(1);var o;const[s,l]=en({strict:!1,name:"".concat(a,"PropsContext"),providerName:"".concat(a,"PropsContext")});function d(t){const{unstyled:a}=t,o=r(t,iw),s=function(t){const{key:i,recipe:n}=t,r=nn();return(0,e.useMemo)(()=>{const e=n||(null!=i?r.getRecipe(i):{});return r.cva(structuredClone(e))},[i,n,r])}({key:i,recipe:o.recipe||n}),[l,c]=(0,e.useMemo)(()=>s.splitVariantProps(o),[s,o]);return{styles:a?ew:s(l),className:s.className,props:c}}return{withContext:(t,i)=>{const n=Xx(t,{},i),r=(0,e.forwardRef)((t,i)=>{const r=l(),a=(0,e.useMemo)(()=>Ox(r,t),[t,r]),{styles:o,className:s,props:u}=d(a);return(0,_t.jsx)(n,c(c({},u),{},{ref:i,css:[o,a.css],className:Sr(s,a.className)}))});return r.displayName=t.displayName||t.name,r},PropsProvider:s,withPropsProvider:function(){return s},usePropsContext:l,useRecipeResult:d}}const rw=Xx("span"),{withContext:aw,PropsProvider:ow}=nw({key:"spinner"}),sw=aw("span"),lw=["spinner","spinnerPlacement","children","text","visible"],cw=e.forwardRef(function(e,t){const{spinner:i=(0,_t.jsx)(sw,{size:"inherit",borderWidth:"0.125em",color:"inherit"}),spinnerPlacement:n="start",children:a,text:o,visible:s=!0}=e,l=r(e,lw);return s?o?(0,_t.jsxs)(rw,c(c({ref:t,display:"contents"},l),{},{children:["start"===n&&i,o,"end"===n&&i]})):i?(0,_t.jsxs)(rw,c(c({ref:t,display:"contents"},l),{},{children:[(0,_t.jsx)(Jx,{display:"inline-flex",children:i}),(0,_t.jsx)(rw,{visibility:"hidden",display:"contents",children:a})]})):(0,_t.jsx)(rw,c(c({ref:t,display:"contents"},l),{},{children:a})):a}),dw=["loading","loadingText","children","spinner","spinnerPlacement"],{useRecipeResult:uw,PropsProvider:hw,usePropsContext:pw}=nw({key:"button"}),fw=(0,e.forwardRef)(function(t,i){const n=pw(),a=(0,e.useMemo)(()=>Ox(n,t),[n,t]),o=uw(a),s=o.props,{loading:l,loadingText:d,children:u,spinner:h,spinnerPlacement:p}=s,f=r(s,dw);return(0,_t.jsx)(Xx.button,c(c({type:"button",ref:i},f),{},{"data-loading":$x(l),disabled:l||f.disabled,className:Sr(o.className,a.className),css:[o.styles,a.css],children:!a.asChild&&l?(0,_t.jsx)(cw,{spinner:h,text:d,spinnerPlacement:p,children:u}):u}))});function mw(e,t){return mw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},mw(e,t)}function gw(){gw=function(e,t){return new i(e,void 0,t)};var e=RegExp.prototype,t=new WeakMap;function i(e,n,r){var a=RegExp(e,n);return t.set(a,r||t.get(e)),mw(a,i.prototype)}function n(e,i){var n=t.get(i);return Object.keys(n).reduce(function(t,i){var r=n[i];if("number"==typeof r)t[i]=e[r];else{for(var a=0;void 0===e[r[a]]&&a+1<r.length;)a++;t[i]=e[r[a]]}return t},Object.create(null))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mw(e,t)}(i,RegExp),i.prototype.exec=function(t){var i=e.exec.call(this,t);if(i){i.groups=n(i,this);var r=i.indices;r&&(r.groups=n(r,this))}return i},i.prototype[Symbol.replace]=function(i,r){if("string"==typeof r){var o=t.get(this);return e[Symbol.replace].call(this,i,r.replace(/\$<([^>]+)(>|$)/g,function(e,t,i){if(""===i)return e;var n=o[t];return Array.isArray(n)?"$"+n.join("$"):"number"==typeof n?"$"+n:""}))}if("function"==typeof r){var s=this;return e[Symbol.replace].call(this,i,function(){var e=arguments;return"object"!=a(e[e.length-1])&&(e=[].slice.call(e)).push(n(e,s)),r.apply(this,e)})}return e[Symbol.replace].call(this,i,r)},gw.apply(this,arguments)}const vw=["texture"],yw=["texture"],bw=["name"],xw=["material"],ww=["enabled"],Sw=["name"],_w=["from","to","duration","delay"];var Cw=Object.create,Ew=Object.defineProperty,Aw=Object.getOwnPropertyDescriptor,Mw=Object.getOwnPropertyNames,Tw=Object.getPrototypeOf,Pw=Object.prototype.hasOwnProperty,Dw=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ow=(e,t,i)=>(i=null!=e?Cw(Tw(e)):{},((e,t,i,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of Mw(t))!Pw.call(e,r)&&r!==i&&Ew(e,r,{get:()=>t[r],enumerable:!(n=Aw(t,r))||n.enumerable});return e})(!t&&e&&e.__esModule?i:Ew(i,"default",{value:e,enumerable:!0}),e)),Iw=(e,t,i)=>(((e,t,i)=>{t in e?Ew(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i),kw=Dw((e,t)=>{!function(i,n){"object"==typeof e?t.exports=n():"function"==typeof define&&define.amd?define(n):i.Alea=n()}(e,function(){return e.importState=function(t){var i=new e;return i.importState(t),i},e;function e(){return function(e){var t=0,i=0,n=0,r=1;0==e.length&&(e=[+new Date]);var a=function(){var e=4022871197,t=function(t){t=t.toString();for(var i=0;i<t.length;i++){var n=.02519603282416938*(e+=t.charCodeAt(i));n-=e=n>>>0,e=(n*=e)>>>0,e+=4294967296*(n-=e)}return 2.3283064365386963e-10*(e>>>0)};return t.version="Mash 0.9",t}();t=a(" "),i=a(" "),n=a(" ");for(var o=0;o<e.length;o++)(t-=a(e[o]))<0&&(t+=1),(i-=a(e[o]))<0&&(i+=1),(n-=a(e[o]))<0&&(n+=1);a=null;var s=function(){var e=2091639*t+2.3283064365386963e-10*r;return t=i,i=n,n=e-(r=0|e)};return s.next=s,s.uint32=function(){return 4294967296*s()},s.fract53=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.version="Alea 0.9",s.args=e,s.exportState=function(){return[t,i,n,r]},s.importState=function(e){t=+e[0]||0,i=+e[1]||0,n=+e[2]||0,r=+e[3]||0},s}(Array.prototype.slice.call(arguments))}})}),Rw=Dw((e,t)=>{!function(i,n){"object"==typeof e&&typeof t<"u"?n(e):"function"==typeof define&&define.amd?define(["exports"],n):n((i=typeof globalThis<"u"?globalThis:i||self).SVDJS={})}(e,function(e){e.SVD=function(e,t,i,n,r){if(t=void 0===t||t,i=void 0===i||i,r=1e-64/(n=n||Math.pow(2,-52)),!e)throw new TypeError("Matrix a is not defined");var a,o,s,l,c,d,u,h,p,f,m,g,v=e[0].length,y=e.length;if(y<v)throw new TypeError("Invalid matrix: m < n");for(var b=[],x=[],w=[],S="f"===t?y:v,_=f=u=0;_<y;_++)x[_]=new Array(S).fill(0);for(_=0;_<v;_++)w[_]=new Array(v).fill(0);var C,E=new Array(v).fill(0);for(_=0;_<y;_++)for(a=0;a<v;a++)x[_][a]=e[_][a];for(_=0;_<v;_++){for(b[_]=u,p=0,s=_+1,a=_;a<y;a++)p+=Math.pow(x[a][_],2);if(p<r)u=0;else for(h=(d=x[_][_])*(u=d<0?Math.sqrt(p):-Math.sqrt(p))-p,x[_][_]=d-u,a=s;a<v;a++){for(p=0,o=_;o<y;o++)p+=x[o][_]*x[o][a];for(d=p/h,o=_;o<y;o++)x[o][a]=x[o][a]+d*x[o][_]}for(E[_]=u,p=0,a=s;a<v;a++)p+=Math.pow(x[_][a],2);if(p<r)u=0;else{for(h=(d=x[_][_+1])*(u=d<0?Math.sqrt(p):-Math.sqrt(p))-p,x[_][_+1]=d-u,a=s;a<v;a++)b[a]=x[_][a]/h;for(a=s;a<y;a++){for(p=0,o=s;o<v;o++)p+=x[a][o]*x[_][o];for(o=s;o<v;o++)x[a][o]=x[a][o]+p*b[o]}}f<(m=Math.abs(E[_])+Math.abs(b[_]))&&(f=m)}if(i)for(_=v-1;0<=_;_--){if(0!==u){for(h=x[_][_+1]*u,a=s;a<v;a++)w[a][_]=x[_][a]/h;for(a=s;a<v;a++){for(p=0,o=s;o<v;o++)p+=x[_][o]*w[o][a];for(o=s;o<v;o++)w[o][a]=w[o][a]+p*w[o][_]}}for(a=s;a<v;a++)w[_][a]=0,w[a][_]=0;w[_][_]=1,u=b[_],s=_}if(t){if("f"===t)for(_=v;_<y;_++){for(a=v;a<y;a++)x[_][a]=0;x[_][_]=1}for(_=v-1;0<=_;_--){for(s=_+1,u=E[_],a=s;a<S;a++)x[_][a]=0;if(0!==u){for(h=x[_][_]*u,a=s;a<S;a++){for(p=0,o=s;o<y;o++)p+=x[o][_]*x[o][a];for(d=p/h,o=_;o<y;o++)x[o][a]=x[o][a]+d*x[o][_]}for(a=_;a<y;a++)x[a][_]=x[a][_]/u}else for(a=_;a<y;a++)x[a][_]=0;x[_][_]=x[_][_]+1}}for(n*=f,o=v-1;0<=o;o--)for(var A=0;A<50;A++){for(C=!1,s=o;0<=s;s--){if(Math.abs(b[s])<=n){C=!0;break}if(Math.abs(E[s-1])<=n)break}if(!C)for(c=0,l=s-(p=1),_=s;_<o+1&&(d=p*b[_],b[_]=c*b[_],!(Math.abs(d)<=n));_++)if(u=E[_],E[_]=Math.sqrt(d*d+u*u),c=u/(h=E[_]),p=-d/h,t)for(a=0;a<y;a++)m=x[a][l],g=x[a][_],x[a][l]=m*c+g*p,x[a][_]=-m*p+g*c;if(g=E[o],s===o){if(g<0&&(E[o]=-g,i))for(a=0;a<v;a++)w[a][o]=-w[a][o];break}for(f=E[s],d=(((m=E[o-1])-g)*(m+g)+((u=b[o-1])-(h=b[o]))*(u+h))/(2*h*m),u=Math.sqrt(d*d+1),d=((f-g)*(f+g)+h*(m/(d<0?d-u:d+u)-h))/f,_=s+(p=c=1);_<o+1;_++){if(u=b[_],m=E[_],h=p*u,u*=c,g=Math.sqrt(d*d+h*h),d=f*(c=d/(b[_-1]=g))+u*(p=h/g),u=-f*p+u*c,h=m*p,m*=c,i)for(a=0;a<v;a++)f=w[a][_-1],g=w[a][_],w[a][_-1]=f*c+g*p,w[a][_]=-f*p+g*c;if(g=Math.sqrt(d*d+h*h),d=(c=d/(E[_-1]=g))*u+(p=h/g)*m,f=-p*u+c*m,t)for(a=0;a<y;a++)m=x[a][_-1],g=x[a][_],x[a][_-1]=m*c+g*p,x[a][_]=-m*p+g*c}b[s]=0,b[o]=d,E[o]=f}for(_=0;_<v;_++)E[_]<n&&(E[_]=0);return{u:x,q:E,v:w}},e.VERSION="1.1.1",Object.defineProperty(e,"__esModule",{value:!0})})}),zw=Dw((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)},t.exports=e.default}),Lw=Dw((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()},t.exports=e.default}),Bw=Dw((e,t)=>{function i(e,t,n,r){this.message=e,this.expected=t,this.found=n,this.location=r,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,i)}!function(e,t){function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i}(i,Error),i.buildMessage=function(e,t){var i,n={literal:function(e){return'"'+a(e.text)+'"'},class:function(e){var t,i="";for(t=0;t<e.parts.length;t++)i+=e.parts[t]instanceof Array?o(e.parts[t][0])+"-"+o(e.parts[t][1]):o(e.parts[t]);return"["+(e.inverted?"^":"")+i+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function a(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}function s(e){return n[e.type](e)}return"Expected "+function(e){var t,i,n=new Array(e.length);for(t=0;t<e.length;t++)n[t]=s(e[t]);if(n.sort(),n.length>0){for(t=1,i=1;t<n.length;t++)n[t-1]!==n[t]&&(n[i]=n[t],i++);n.length=i}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+(((i=t)?'"'+a(i)+'"':"end of input")+" found.")},t.exports={SyntaxError:i,parse:function(e,t){t=void 0!==t?t:{};var n,r={},a={svg_path:ge},o=ge,s=function(e){if(!e)return[];for(var t=[],i=0;i<e.length;i++)t=t.concat.apply(t,e[i]);var n=t[0];return n&&"m"==n.code&&(delete n.relative,n.code="M"),t},l=function(e,t){return function(e,t){if(!t)return[e];for(var i=[e],n=0,r=t.length;n<r;n++)i[n+1]=t[n][1];return i}(e,t)},c=/^[Mm]/,d=ue(["M","m"],!1,!1),u=function(e,t,i){var n=Ne(e,[t]);return i&&(n=n.concat(Ne("M"==e?"L":"l",i[1]))),n},h=/^[Zz]/,p=ue(["Z","z"],!1,!1),f=function(){return Ne("Z")},m=/^[Ll]/,g=ue(["L","l"],!1,!1),v=function(e,t){return Ne(e,t)},y=/^[Hh]/,b=ue(["H","h"],!1,!1),x=function(e,t){return Ne(e,t.map(function(e){return{x:e}}))},w=/^[Vv]/,S=ue(["V","v"],!1,!1),_=function(e,t){return Ne(e,t.map(function(e){return{y:e}}))},C=/^[Cc]/,E=ue(["C","c"],!1,!1),A=function(e,t,i){return{x1:e.x,y1:e.y,x2:t.x,y2:t.y,x:i.x,y:i.y}},M=/^[Ss]/,T=ue(["S","s"],!1,!1),P=function(e,t){return{x2:e.x,y2:e.y,x:t.x,y:t.y}},D=/^[Qq]/,O=ue(["Q","q"],!1,!1),I=function(e,t){return{x1:e.x,y1:e.y,x:t.x,y:t.y}},k=/^[Tt]/,R=ue(["T","t"],!1,!1),z=/^[Aa]/,L=ue(["A","a"],!1,!1),B=function(e,t,i,n,r,a){return{rx:e,ry:t,xAxisRotation:i,largeArc:n,sweep:r,x:a.x,y:a.y}},N=function(e,t){return{x:e,y:t}},F=function(e){return 1*e},U=function(e){return 1*e.join("")},V=/^[01]/,j=ue(["0","1"],!1,!1),W=function(e){return"1"==e},H=function(){return""},G=",",q=de(",",!1),X=function(e){return e.join("")},Y=".",Q=de(".",!1),K=/^[eE]/,Z=ue(["e","E"],!1,!1),J=/^[+\-]/,$=ue(["+","-"],!1,!1),ee=/^[0-9]/,te=ue([["0","9"]],!1,!1),ie=function(e){return e.join("")},ne=/^[ \t\n\r]/,re=ue([" ","\t","\n","\r"],!1,!1),ae=0,oe=[{line:1,column:1}],se=0,le=[],ce=0;if("startRule"in t){if(!(t.startRule in a))throw new Error("Can't start parsing from rule \""+t.startRule+'".');o=a[t.startRule]}function de(e,t){return{type:"literal",text:e,ignoreCase:t}}function ue(e,t,i){return{type:"class",parts:e,inverted:t,ignoreCase:i}}function he(t){var i,n=oe[t];if(n)return n;for(i=t-1;!oe[i];)i--;for(n={line:(n=oe[i]).line,column:n.column};i<t;)10===e.charCodeAt(i)?(n.line++,n.column=1):n.column++,i++;return oe[t]=n,n}function pe(e,t){var i=he(e),n=he(t);return{start:{offset:e,line:i.line,column:i.column},end:{offset:t,line:n.line,column:n.column}}}function fe(e){ae<se||(ae>se&&(se=ae,le=[]),le.push(e))}function me(e,t,n){return new i(i.buildMessage(e,t),e,t,n)}function ge(){var e,t,i,n,a;for(e=ae,t=[],i=ze();i!==r;)t.push(i),i=ze();if(t!==r)if(i=function(){var e,t,i,n,a,o;if(e=ae,t=ve(),t!==r){for(i=[],n=ae,a=[],o=ze();o!==r;)a.push(o),o=ze();for(a!==r?(o=ve())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);n!==r;){for(i.push(n),n=ae,a=[],o=ze();o!==r;)a.push(o),o=ze();a!==r?(o=ve())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r)}i!==r?e=t=l(t,i):(ae=e,e=r)}else ae=e,e=r;return e}(),i===r&&(i=null),i!==r){for(n=[],a=ze();a!==r;)n.push(a),a=ze();n!==r?e=t=s(i):(ae=e,e=r)}else ae=e,e=r;else ae=e,e=r;return e}function ve(){var t,i,n,a,o,s;if(t=ae,i=function(){var t,i,n,a,o,s,l;if(t=ae,c.test(e.charAt(ae))?(i=e.charAt(ae),ae++):(i=r,0===ce&&fe(d)),i!==r){for(n=[],a=ze();a!==r;)n.push(a),a=ze();n!==r?(a=Ee())!==r?(o=ae,(s=Pe())===r&&(s=null),s!==r?(l=be())!==r?o=s=[s,l]:(ae=o,o=r):(ae=o,o=r),o===r&&(o=null),o!==r?t=i=u(i,a,o):(ae=t,t=r)):(ae=t,t=r):(ae=t,t=r)}else ae=t,t=r;return t}(),i!==r){for(n=[],a=ae,o=[],s=ze();s!==r;)o.push(s),s=ze();for(o!==r?(s=ye())!==r?a=o=[o,s]:(ae=a,a=r):(ae=a,a=r);a!==r;){for(n.push(a),a=ae,o=[],s=ze();s!==r;)o.push(s),s=ze();o!==r?(s=ye())!==r?a=o=[o,s]:(ae=a,a=r):(ae=a,a=r)}n!==r?t=i=l(i,n):(ae=t,t=r)}else ae=t,t=r;return t}function ye(){var t;return(t=function(){var t,i;return t=ae,h.test(e.charAt(ae))?(i=e.charAt(ae),ae++):(i=r,0===ce&&fe(p)),i!==r&&(i=f()),t=i,t}())===r&&(t=function(){var t,i,n,a;if(t=ae,m.test(e.charAt(ae))?(i=e.charAt(ae),ae++):(i=r,0===ce&&fe(g)),i!==r){for(n=[],a=ze();a!==r;)n.push(a),a=ze();n!==r?(a=be())!==r?t=i=v(i,a):(ae=t,t=r):(ae=t,t=r)}else ae=t,t=r;return t}(),t===r&&(t=function(){var t,i,n,a;if(t=ae,y.test(e.charAt(ae))?(i=e.charAt(ae),ae++):(i=r,0===ce&&fe(b)),i!==r){for(n=[],a=ze();a!==r;)n.push(a),a=ze();n!==r?(a=xe())!==r?t=i=x(i,a):(ae=t,t=r):(ae=t,t=r)}else ae=t,t=r;return t}(),t===r&&(t=function(){var t,i,n,a;if(t=ae,w.test(e.charAt(ae))?(i=e.charAt(ae),ae++):(i=r,0===ce&&fe(S)),i!==r){for(n=[],a=ze();a!==r;)n.push(a),a=ze();n!==r?(a=xe())!==r?t=i=_(i,a):(ae=t,t=r):(ae=t,t=r)}else ae=t,t=r;return t}(),t===r&&(t=function(){var t,i,n,a;if(t=ae,C.test(e.charAt(ae))?(i=e.charAt(ae),ae++):(i=r,0===ce&&fe(E)),i!==r){for(n=[],a=ze();a!==r;)n.push(a),a=ze();n!==r?(a=function(){var e,t,i,n,a,o;if(e=ae,t=we(),t!==r){for(i=[],n=ae,(a=Pe())===r&&(a=null),a!==r?(o=we())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);n!==r;)i.push(n),n=ae,(a=Pe())===r&&(a=null),a!==r?(o=we())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);i!==r?e=t=l(t,i):(ae=e,e=r)}else ae=e,e=r;return e}(),a!==r?t=i=v(i,a):(ae=t,t=r)):(ae=t,t=r)}else ae=t,t=r;return t}(),t===r&&(t=function(){var t,i,n,a;if(t=ae,M.test(e.charAt(ae))?(i=e.charAt(ae),ae++):(i=r,0===ce&&fe(T)),i!==r){for(n=[],a=ze();a!==r;)n.push(a),a=ze();n!==r?(a=function(){var e,t,i,n,a,o;if(e=ae,t=Se(),t!==r){for(i=[],n=ae,(a=Pe())===r&&(a=null),a!==r?(o=Se())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);n!==r;)i.push(n),n=ae,(a=Pe())===r&&(a=null),a!==r?(o=Se())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);i!==r?e=t=l(t,i):(ae=e,e=r)}else ae=e,e=r;return e}(),a!==r?t=i=v(i,a):(ae=t,t=r)):(ae=t,t=r)}else ae=t,t=r;return t}(),t===r&&(t=function(){var t,i,n,a;if(t=ae,D.test(e.charAt(ae))?(i=e.charAt(ae),ae++):(i=r,0===ce&&fe(O)),i!==r){for(n=[],a=ze();a!==r;)n.push(a),a=ze();n!==r?(a=function(){var e,t,i,n,a,o;if(e=ae,t=_e(),t!==r){for(i=[],n=ae,(a=Pe())===r&&(a=null),a!==r?(o=_e())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);n!==r;)i.push(n),n=ae,(a=Pe())===r&&(a=null),a!==r?(o=_e())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);i!==r?e=t=l(t,i):(ae=e,e=r)}else ae=e,e=r;return e}(),a!==r?t=i=v(i,a):(ae=t,t=r)):(ae=t,t=r)}else ae=t,t=r;return t}(),t===r&&(t=function(){var t,i,n,a;if(t=ae,k.test(e.charAt(ae))?(i=e.charAt(ae),ae++):(i=r,0===ce&&fe(R)),i!==r){for(n=[],a=ze();a!==r;)n.push(a),a=ze();n!==r?(a=function(){var e,t,i,n,a,o;if(e=ae,t=Ee(),t!==r){for(i=[],n=ae,(a=Pe())===r&&(a=null),a!==r?(o=Ee())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);n!==r;)i.push(n),n=ae,(a=Pe())===r&&(a=null),a!==r?(o=Ee())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);i!==r?e=t=l(t,i):(ae=e,e=r)}else ae=e,e=r;return e}(),a!==r?t=i=v(i,a):(ae=t,t=r)):(ae=t,t=r)}else ae=t,t=r;return t}(),t===r&&(t=function(){var t,i,n,a;if(t=ae,z.test(e.charAt(ae))?(i=e.charAt(ae),ae++):(i=r,0===ce&&fe(L)),i!==r){for(n=[],a=ze();a!==r;)n.push(a),a=ze();n!==r?(a=function(){var e,t,i,n,a,o;if(e=ae,t=Ce(),t!==r){for(i=[],n=ae,(a=Pe())===r&&(a=null),a!==r?(o=Ce())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);n!==r;)i.push(n),n=ae,(a=Pe())===r&&(a=null),a!==r?(o=Ce())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);i!==r?e=t=l(t,i):(ae=e,e=r)}else ae=e,e=r;return e}(),a!==r?t=i=v(i,a):(ae=t,t=r)):(ae=t,t=r)}else ae=t,t=r;return t}())))))))),t}function be(){var e,t,i,n,a,o;if(e=ae,(t=Ee())!==r){for(i=[],n=ae,(a=Pe())===r&&(a=null),a!==r?(o=Ee())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);n!==r;)i.push(n),n=ae,(a=Pe())===r&&(a=null),a!==r?(o=Ee())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);i!==r?e=t=l(t,i):(ae=e,e=r)}else ae=e,e=r;return e}function xe(){var e,t,i,n,a,o;if(e=ae,(t=Me())!==r){for(i=[],n=ae,(a=Pe())===r&&(a=null),a!==r?(o=Me())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);n!==r;)i.push(n),n=ae,(a=Pe())===r&&(a=null),a!==r?(o=Me())!==r?n=a=[a,o]:(ae=n,n=r):(ae=n,n=r);i!==r?e=t=l(t,i):(ae=e,e=r)}else ae=e,e=r;return e}function we(){var e,t,i,n,a,o;return e=ae,(t=Ee())!==r?((i=Pe())===r&&(i=null),i!==r?(n=Ee())!==r?((a=Pe())===r&&(a=null),a!==r?(o=Ee())!==r?e=t=A(t,n,o):(ae=e,e=r):(ae=e,e=r)):(ae=e,e=r):(ae=e,e=r)):(ae=e,e=r),e}function Se(){var e,t,i,n;return e=ae,(t=Ee())!==r?((i=Pe())===r&&(i=null),i!==r?(n=Ee())!==r?e=t=P(t,n):(ae=e,e=r):(ae=e,e=r)):(ae=e,e=r),e}function _e(){var e,t,i,n;return e=ae,(t=Ee())!==r?((i=Pe())===r&&(i=null),i!==r?(n=Ee())!==r?e=t=I(t,n):(ae=e,e=r):(ae=e,e=r)):(ae=e,e=r),e}function Ce(){var e,t,i,n,a,o,s,l,c,d,u;return e=ae,(t=Ae())!==r?((i=Pe())===r&&(i=null),i!==r?(n=Ae())!==r?((a=Pe())===r&&(a=null),a!==r?(o=Me())!==r?Pe()!==r?(s=Te())!==r?((l=Pe())===r&&(l=null),l!==r?(c=Te())!==r?((d=Pe())===r&&(d=null),d!==r?(u=Ee())!==r?e=t=B(t,n,o,s,c,u):(ae=e,e=r):(ae=e,e=r)):(ae=e,e=r):(ae=e,e=r)):(ae=e,e=r):(ae=e,e=r):(ae=e,e=r):(ae=e,e=r)):(ae=e,e=r):(ae=e,e=r)):(ae=e,e=r),e}function Ee(){var e,t,i,n;return e=ae,(t=Me())!==r?((i=Pe())===r&&(i=null),i!==r?(n=Me())!==r?e=t=N(t,n):(ae=e,e=r):(ae=e,e=r)):(ae=e,e=r),e}function Ae(){var e,t;return e=ae,(t=Oe())===r&&(t=Re()),t!==r&&(t=F(t)),e=t}function Me(){var e,t,i,n;return e=ae,t=ae,(i=ke())===r&&(i=null),i!==r?(n=Oe())!==r?t=i=[i,n]:(ae=t,t=r):(ae=t,t=r),t===r&&(t=ae,(i=ke())===r&&(i=null),i!==r?(n=Re())!==r?t=i=[i,n]:(ae=t,t=r):(ae=t,t=r)),t!==r&&(t=U(t)),e=t}function Te(){var t,i;return t=ae,V.test(e.charAt(ae))?(i=e.charAt(ae),ae++):(i=r,0===ce&&fe(j)),i!==r&&(i=W(i)),t=i}function Pe(){var e,t,i,n,a;if(e=ae,t=[],(i=ze())!==r)for(;i!==r;)t.push(i),i=ze();else t=r;if(t!==r)if((i=De())===r&&(i=null),i!==r){for(n=[],a=ze();a!==r;)n.push(a),a=ze();n!==r?e=t=[t,i,n]:(ae=e,e=r)}else ae=e,e=r;else ae=e,e=r;if(e===r){if(e=ae,t=ae,(i=De())!==r){for(n=[],a=ze();a!==r;)n.push(a),a=ze();n!==r?t=i=[i,n]:(ae=t,t=r)}else ae=t,t=r;t!==r&&(t=H()),e=t}return e}function De(){var t;return 44===e.charCodeAt(ae)?(t=G,ae++):(t=r,0===ce&&fe(q)),t}function Oe(){var t,i,n,a;return t=ae,i=ae,n=function(){var t,i,n,a,o;return t=ae,i=ae,n=Re(),n===r&&(n=null),n!==r?(46===e.charCodeAt(ae)?(a=Y,ae++):(a=r,0===ce&&fe(Q)),a!==r&&(o=Re())!==r?(n=[n,a,o],i=n):(ae=i,i=r)):(ae=i,i=r),i===r&&(i=ae,n=Re(),n!==r?(46===e.charCodeAt(ae)?(a=Y,ae++):(a=r,0===ce&&fe(Q)),a!==r?(n=[n,a],i=n):(ae=i,i=r)):(ae=i,i=r)),i!==r&&(i=X(i)),t=i,t}(),n!==r?((a=Ie())===r&&(a=null),a!==r?i=n=[n,a]:(ae=i,i=r)):(ae=i,i=r),i===r&&(i=ae,(n=Re())!==r?(a=Ie())!==r?i=n=[n,a]:(ae=i,i=r):(ae=i,i=r)),i!==r&&(i=X(i)),t=i}function Ie(){var t,i,n,a,o;return t=ae,i=ae,K.test(e.charAt(ae))?(n=e.charAt(ae),ae++):(n=r,0===ce&&fe(Z)),n!==r?((a=ke())===r&&(a=null),a!==r?(o=Re())!==r?i=n=[n,a,o]:(ae=i,i=r):(ae=i,i=r)):(ae=i,i=r),i!==r&&(i=X(i)),t=i}function ke(){var t;return J.test(e.charAt(ae))?(t=e.charAt(ae),ae++):(t=r,0===ce&&fe($)),t}function Re(){var t,i,n;if(t=ae,i=[],ee.test(e.charAt(ae))?(n=e.charAt(ae),ae++):(n=r,0===ce&&fe(te)),n!==r)for(;n!==r;)i.push(n),ee.test(e.charAt(ae))?(n=e.charAt(ae),ae++):(n=r,0===ce&&fe(te));else i=r;return i!==r&&(i=ie(i)),t=i}function ze(){var t,i;return t=ae,ne.test(e.charAt(ae))?(i=e.charAt(ae),ae++):(i=r,0===ce&&fe(re)),i!==r&&(i=H()),t=i}var Le={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var Be in Le)Le[Be.toUpperCase()]=Le[Be];function Ne(e,t){t||(t=[{}]);for(var i=t.length;i--;){var n={code:e,command:Le[e]};for(var r in e==e.toLowerCase()&&(n.relative=!0),t[i])n[r]=t[i][r];t[i]=n}return t}if((n=o())!==r&&ae===e.length)return n;throw n!==r&&ae<e.length&&fe({type:"end"}),me(le,se<e.length?e.charAt(se):null,se<e.length?pe(se,se+1):pe(se,se))}}}),Nw=Dw((e,t)=>{var i=Bw().parse;i.parseSVG=i,i.makeAbsolute=function(e){var t,i={x:0,y:0},n={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return e.forEach(function(e){for(var r in"moveto"===e.command&&(t=e),e.x0=i.x,e.y0=i.y,n)r in e&&(e[r]+=e.relative?e[n[r]]:0);"x"in e||(e.x=i.x),"y"in e||(e.y=i.y),e.relative=!1,e.code=e.code.toUpperCase(),"closepath"==e.command&&(e.x=t.x,e.y=t.y),i=e}),e},t.exports=i}),Fw=Dw((e,t)=>{t.exports=function(e,t){for(var i=e.split("."),n=t.split("."),r=0;r<3;r++){var a=Number(i[r]),o=Number(n[r]);if(a>o)return 1;if(o>a)return-1;if(!isNaN(a)&&isNaN(o))return 1;if(isNaN(a)&&!isNaN(o))return-1}return 0}}),Uw="149",Vw=0,jw=1,Ww=2,Hw=3,Gw=0,qw=1,Xw=2,Yw=100,Qw=101,Kw=102,Zw=200,Jw=201,$w=202,eS=203,tS=204,iS=205,nS=206,rS=207,aS=208,oS=209,sS=210,lS=301,cS=302,dS=306,uS=1e3,hS=1001,pS=1002,fS=1003,mS=1004,gS=1005,vS=1006,yS=1007,bS=1008,xS=1009,wS=1014,SS=1015,_S=1016,CS=1020,ES=1023,AS=1026,MS=1027,TS=1028,PS=1030,DS=33776,OS=33777,IS=33778,kS=33779,RS=36492,zS=2202,LS=2300,BS=2301,NS=2302,FS=2400,US=2401,VS=2402,jS=2500,WS=3e3,HS=3001,GS=3200,qS="srgb",XS="srgb-linear",YS=7680,QS=35044,KS="300 es",ZS=1035,JS=class{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});let i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;let i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;let i=this._listeners[e];if(void 0!==i){let e=i.indexOf(t);-1!==e&&i.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;let t=this._listeners[e.type];if(void 0!==t){e.target=this;let i=t.slice(0);for(let t=0,n=i.length;t<n;t++)i[t].call(this,e);e.target=null}}},$S=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],e_=1234567,t_=Math.PI/180,i_=180/Math.PI;function n_(){let e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return($S[255&e]+$S[e>>8&255]+$S[e>>16&255]+$S[e>>24&255]+"-"+$S[255&t]+$S[t>>8&255]+"-"+$S[t>>16&15|64]+$S[t>>24&255]+"-"+$S[63&i|128]+$S[i>>8&255]+"-"+$S[i>>16&255]+$S[i>>24&255]+$S[255&n]+$S[n>>8&255]+$S[n>>16&255]+$S[n>>24&255]).toLowerCase()}function r_(e,t,i){return Math.max(t,Math.min(i,e))}function a_(e,t){return(e%t+t)%t}function o_(e,t,i){return(1-i)*e+i*t}function s_(e){return 0===(e&e-1)&&0!==e}function l_(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function c_(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function d_(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function u_(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}var h_=Object.freeze({__proto__:null,DEG2RAD:t_,RAD2DEG:i_,ceilPowerOfTwo:l_,clamp:r_,damp:function(e,t,i,n){return o_(e,t,1-Math.exp(-i*n))},degToRad:function(e){return e*t_},denormalize:d_,euclideanModulo:a_,floorPowerOfTwo:c_,generateUUID:n_,inverseLerp:function(e,t,i){return e!==t?(i-e)/(t-e):0},isPowerOfTwo:s_,lerp:o_,mapLinear:function(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)},normalize:u_,pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(a_(e,2*t)-t)},radToDeg:function(e){return e*i_},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},seededRandom:function(e){void 0!==e&&(e_=e);let t=e_+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},setQuaternionFromProperEuler:function(e,t,i,n,r){let a=Math.cos,o=Math.sin,s=a(i/2),l=o(i/2),c=a((t+n)/2),d=o((t+n)/2),u=a((t-n)/2),h=o((t-n)/2),p=a((n-t)/2),f=o((n-t)/2);switch(r){case"XYX":e.set(s*d,l*u,l*h,s*c);break;case"YZY":e.set(l*h,s*d,l*u,s*c);break;case"ZXZ":e.set(l*u,l*h,s*d,s*c);break;case"XZX":e.set(s*d,l*f,l*p,s*c);break;case"YXY":e.set(l*p,s*d,l*f,s*c);break;case"ZYZ":e.set(l*f,l*p,s*d,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},smootherstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*e*(e*(6*e-15)+10)},smoothstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*(3-2*e)}}),p_=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;p_.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,i=this.y,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6],this.y=n[1]*t+n[4]*i+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let i=Math.cos(t),n=Math.sin(t),r=this.x-e.x,a=this.y-e.y;return this.x=r*i-a*n+e.x,this.y=r*n+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},f_=class{constructor(){f_.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,n,r,a,o,s,l){let c=this.elements;return c[0]=e,c[1]=n,c[2]=o,c[3]=t,c[4]=r,c[5]=s,c[6]=i,c[7]=a,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,n=t.elements,r=this.elements,a=i[0],o=i[3],s=i[6],l=i[1],c=i[4],d=i[7],u=i[2],h=i[5],p=i[8],f=n[0],m=n[3],g=n[6],v=n[1],y=n[4],b=n[7],x=n[2],w=n[5],S=n[8];return r[0]=a*f+o*v+s*x,r[3]=a*m+o*y+s*w,r[6]=a*g+o*b+s*S,r[1]=l*f+c*v+d*x,r[4]=l*m+c*y+d*w,r[7]=l*g+c*b+d*S,r[2]=u*f+h*v+p*x,r[5]=u*m+h*y+p*w,r[8]=u*g+h*b+p*S,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8];return t*a*c-t*o*l-i*r*c+i*o*s+n*r*l-n*a*s}invert(){let e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],d=c*a-o*l,u=o*s-c*r,h=l*r-a*s,p=t*d+i*u+n*h;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);let f=1/p;return e[0]=d*f,e[1]=(n*l-c*i)*f,e[2]=(o*i-n*a)*f,e[3]=u*f,e[4]=(c*t-n*s)*f,e[5]=(n*r-o*t)*f,e[6]=h*f,e[7]=(i*s-l*t)*f,e[8]=(a*t-i*r)*f,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,n,r,a,o){let s=Math.cos(r),l=Math.sin(r);return this.set(i*s,i*l,-i*(s*a+l*o)+a+e,-n*l,n*s,-n*(-l*a+s*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(m_.makeScale(e,t)),this}rotate(e){return this.premultiply(m_.makeRotation(-e)),this}translate(e,t){return this.premultiply(m_.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,i=e.elements;for(let n=0;n<9;n++)if(t[n]!==i[n])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}},m_=new f_;function g_(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var v_={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function y_(e,t){return new v_[e](t)}function b_(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function x_(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function w_(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var S_={[qS]:{[XS]:x_},[XS]:{[qS]:w_}},__={legacyMode:!0,get workingColorSpace(){return XS},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,i){if(this.legacyMode||t===i||!t||!i)return e;if(S_[t]&&void 0!==S_[t][i]){let n=S_[t][i];return e.r=n(e.r),e.g=n(e.g),e.b=n(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},C_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},E_={r:0,g:0,b:0},A_={h:0,s:0,l:0},M_={h:0,s:0,l:0};function T_(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+6*(t-e)*(2/3-i):e}function P_(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var D_=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===i?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qS;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,__.toWorkingColorSpace(this,t),this}setRGB(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:__.workingColorSpace;return this.r=e,this.g=t,this.b=i,__.toWorkingColorSpace(this,n),this}setHSL(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:__.workingColorSpace;if(e=a_(e,1),t=r_(t,0,1),i=r_(i,0,1),0===t)this.r=this.g=this.b=i;else{let n=i<=.5?i*(1+t):i+t-i*t,r=2*i-n;this.r=T_(r,n,e+1/3),this.g=T_(r,n,e),this.b=T_(r,n,e-1/3)}return __.toWorkingColorSpace(this,n),this}setStyle(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qS;function n(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let e,r=t[1],a=t[2];switch(r){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,__.toWorkingColorSpace(this,i),n(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,__.toWorkingColorSpace(this,i),n(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){let t=parseFloat(e[1])/360,r=parseFloat(e[2])/100,a=parseFloat(e[3])/100;return n(e[4]),this.setHSL(t,r,a,i)}}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){let e=t[1],n=e.length;if(3===n)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,__.toWorkingColorSpace(this,i),this;if(6===n)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,__.toWorkingColorSpace(this,i),this}return e&&e.length>0?this.setColorName(e,i):this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qS,i=C_[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=x_(e.r),this.g=x_(e.g),this.b=x_(e.b),this}copyLinearToSRGB(e){return this.r=w_(e.r),this.g=w_(e.g),this.b=w_(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qS;return __.fromWorkingColorSpace(P_(this,E_),e),r_(255*E_.r,0,255)<<16^r_(255*E_.g,0,255)<<8^r_(255*E_.b,0,255)}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qS;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:__.workingColorSpace;__.fromWorkingColorSpace(P_(this,E_),t);let i,n,r=E_.r,a=E_.g,o=E_.b,s=Math.max(r,a,o),l=Math.min(r,a,o),c=(l+s)/2;if(l===s)i=0,n=0;else{let e=s-l;switch(n=c<=.5?e/(s+l):e/(2-s-l),s){case r:i=(a-o)/e+(a<o?6:0);break;case a:i=(o-r)/e+2;break;case o:i=(r-a)/e+4}i/=6}return e.h=i,e.s=n,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:__.workingColorSpace;return __.fromWorkingColorSpace(P_(this,E_),t),e.r=E_.r,e.g=E_.g,e.b=E_.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qS;return __.fromWorkingColorSpace(P_(this,E_),e),e!==qS?"color(".concat(e," ").concat(E_.r," ").concat(E_.g," ").concat(E_.b,")"):"rgb(".concat(255*E_.r|0,",").concat(255*E_.g|0,",").concat(255*E_.b|0,")")}offsetHSL(e,t,i){return this.getHSL(A_),A_.h+=e,A_.s+=t,A_.l+=i,this.setHSL(A_.h,A_.s,A_.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(A_),e.getHSL(M_);let i=o_(A_.h,M_.h,t),n=o_(A_.s,M_.s,t),r=o_(A_.l,M_.l,t);return this.setHSL(i,n,r),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};D_.NAMES=C_;var O_,I_=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===O_&&(O_=b_("canvas")),O_.width=e.width,O_.height=e.height;let i=O_.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=O_}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=b_("canvas");t.width=e.width,t.height=e.height;let i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let n=i.getImageData(0,0,e.width,e.height),r=n.data;for(let e=0;e<r.length;e++)r[e]=255*x_(r[e]/255);return i.putImageData(n,0,0),t}if(e.data){let t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*x_(t[e]/255)):t[e]=x_(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},k_=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,this.uuid=n_(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];let i={uuid:this.uuid,url:""},n=this.data;if(null!==n){let e;if(Array.isArray(n)){e=[];for(let t=0,i=n.length;t<i;t++)n[t].isDataTexture?e.push(R_(n[t].image)):e.push(R_(n[t]))}else e=R_(n);i.url=e}return t||(e.images[this.uuid]=i),i}};function R_(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?I_.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var z_=0,L_=class extends JS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L_.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L_.DEFAULT_MAPPING,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:hS,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:hS,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:vS,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:bS,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ES,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:xS,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:L_.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:WS;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:z_++}),this.uuid=n_(),this.name="",this.source=new k_(e),this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=n,this.magFilter=r,this.minFilter=a,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=s,this.offset=new p_(0,0),this.repeat=new p_(1,1),this.center=new p_(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new f_,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];let i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case uS:e.x=e.x-Math.floor(e.x);break;case hS:e.x=e.x<0?0:1;break;case pS:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case uS:e.y=e.y-Math.floor(e.y);break;case hS:e.y=e.y<0?0:1;break;case pS:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}};L_.DEFAULT_IMAGE=null,L_.DEFAULT_MAPPING=300,L_.DEFAULT_ANISOTROPY=1;var B_=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;B_.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,i=this.y,n=this.z,r=this.w,a=e.elements;return this.x=a[0]*t+a[4]*i+a[8]*n+a[12]*r,this.y=a[1]*t+a[5]*i+a[9]*n+a[13]*r,this.z=a[2]*t+a[6]*i+a[10]*n+a[14]*r,this.w=a[3]*t+a[7]*i+a[11]*n+a[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,n,r,a=e.elements,o=a[0],s=a[4],l=a[8],c=a[1],d=a[5],u=a[9],h=a[2],p=a[6],f=a[10];if(Math.abs(s-c)<.01&&Math.abs(l-h)<.01&&Math.abs(u-p)<.01){if(Math.abs(s+c)<.1&&Math.abs(l+h)<.1&&Math.abs(u+p)<.1&&Math.abs(o+d+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let e=(o+1)/2,a=(d+1)/2,m=(f+1)/2,g=(s+c)/4,v=(l+h)/4,y=(u+p)/4;return e>a&&e>m?e<.01?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(e),n=g/i,r=v/i):a>m?a<.01?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(a),i=g/n,r=y/n):m<.01?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(m),i=v/r,n=y/r),this.set(i,n,r,t),this}let m=Math.sqrt((p-u)*(p-u)+(l-h)*(l-h)+(c-s)*(c-s));return Math.abs(m)<.001&&(m=1),this.x=(p-u)/m,this.y=(l-h)/m,this.z=(c-s)/m,this.w=Math.acos((o+d+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},N_=class extends JS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new B_(0,0,e,t),this.scissorTest=!1,this.viewport=new B_(0,0,e,t);let n={width:e,height:t,depth:1};this.texture=new L_(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:vS,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new k_(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},F_=class extends L_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=fS,this.minFilter=fS,this.wrapR=hS,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},U_=class extends N_{constructor(){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGLMultipleRenderTargets=!0;let t=this.texture;this.texture=[];for(let i=0;i<e;i++)this.texture[i]=t.clone(),this.texture[i].isRenderTargetTexture=!0}setSize(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let n=0,r=this.texture.length;n<r;n++)this.texture[n].image.width=e,this.texture[n].image.height=t,this.texture[n].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},V_=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=n}static slerpFlat(e,t,i,n,r,a,o){let s=i[n+0],l=i[n+1],c=i[n+2],d=i[n+3],u=r[a+0],h=r[a+1],p=r[a+2],f=r[a+3];if(0===o)return e[t+0]=s,e[t+1]=l,e[t+2]=c,void(e[t+3]=d);if(1===o)return e[t+0]=u,e[t+1]=h,e[t+2]=p,void(e[t+3]=f);if(d!==f||s!==u||l!==h||c!==p){let e=1-o,t=s*u+l*h+c*p+d*f,i=t>=0?1:-1,n=1-t*t;if(n>Number.EPSILON){let r=Math.sqrt(n),a=Math.atan2(r,t*i);e=Math.sin(e*a)/r,o=Math.sin(o*a)/r}let r=o*i;if(s=s*e+u*r,l=l*e+h*r,c=c*e+p*r,d=d*e+f*r,e===1-o){let e=1/Math.sqrt(s*s+l*l+c*c+d*d);s*=e,l*=e,c*=e,d*=e}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,n,r,a){let o=i[n],s=i[n+1],l=i[n+2],c=i[n+3],d=r[a],u=r[a+1],h=r[a+2],p=r[a+3];return e[t]=o*p+c*d+s*h-l*u,e[t+1]=s*p+c*u+l*d-o*h,e[t+2]=l*p+c*h+o*u-s*d,e[t+3]=c*p-o*d-s*u-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let i=e._x,n=e._y,r=e._z,a=e._order,o=Math.cos,s=Math.sin,l=o(i/2),c=o(n/2),d=o(r/2),u=s(i/2),h=s(n/2),p=s(r/2);switch(a){case"XYZ":this._x=u*c*d+l*h*p,this._y=l*h*d-u*c*p,this._z=l*c*p+u*h*d,this._w=l*c*d-u*h*p;break;case"YXZ":this._x=u*c*d+l*h*p,this._y=l*h*d-u*c*p,this._z=l*c*p-u*h*d,this._w=l*c*d+u*h*p;break;case"ZXY":this._x=u*c*d-l*h*p,this._y=l*h*d+u*c*p,this._z=l*c*p+u*h*d,this._w=l*c*d-u*h*p;break;case"ZYX":this._x=u*c*d-l*h*p,this._y=l*h*d+u*c*p,this._z=l*c*p-u*h*d,this._w=l*c*d+u*h*p;break;case"YZX":this._x=u*c*d+l*h*p,this._y=l*h*d+u*c*p,this._z=l*c*p-u*h*d,this._w=l*c*d-u*h*p;break;case"XZY":this._x=u*c*d-l*h*p,this._y=l*h*d-u*c*p,this._z=l*c*p+u*h*d,this._w=l*c*d+u*h*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let i=t/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,i=t[0],n=t[4],r=t[8],a=t[1],o=t[5],s=t[9],l=t[2],c=t[6],d=t[10],u=i+o+d;if(u>0){let e=.5/Math.sqrt(u+1);this._w=.25/e,this._x=(c-s)*e,this._y=(r-l)*e,this._z=(a-n)*e}else if(i>o&&i>d){let e=2*Math.sqrt(1+i-o-d);this._w=(c-s)/e,this._x=.25*e,this._y=(n+a)/e,this._z=(r+l)/e}else if(o>d){let e=2*Math.sqrt(1+o-i-d);this._w=(r-l)/e,this._x=(n+a)/e,this._y=.25*e,this._z=(s+c)/e}else{let e=2*Math.sqrt(1+d-i-o);this._w=(a-n)/e,this._x=(r+l)/e,this._y=(s+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(r_(this.dot(e),-1,1)))}rotateTowards(e,t){let i=this.angleTo(e);if(0===i)return this;let n=Math.min(1,t/i);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let i=e._x,n=e._y,r=e._z,a=e._w,o=t._x,s=t._y,l=t._z,c=t._w;return this._x=i*c+a*o+n*l-r*s,this._y=n*c+a*s+r*o-i*l,this._z=r*c+a*l+i*s-n*o,this._w=a*c-i*o-n*s-r*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);let i=this._x,n=this._y,r=this._z,a=this._w,o=a*e._w+i*e._x+n*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=i,this._y=n,this._z=r,this;let s=1-o*o;if(s<=Number.EPSILON){let e=1-t;return this._w=e*a+t*this._w,this._x=e*i+t*this._x,this._y=e*n+t*this._y,this._z=e*r+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(s),c=Math.atan2(l,o),d=Math.sin((1-t)*c)/l,u=Math.sin(t*c)/l;return this._w=a*d+this._w*u,this._x=i*d+this._x*u,this._y=n*d+this._y*u,this._z=r*d+this._z*u,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){let e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),n=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(t*Math.cos(n),i*Math.sin(r),i*Math.cos(r),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},j_=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;j_.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(H_.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(H_.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*n,this.y=r[1]*t+r[4]*i+r[7]*n,this.z=r[2]*t+r[5]*i+r[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,i=this.y,n=this.z,r=e.elements,a=1/(r[3]*t+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*n+r[12])*a,this.y=(r[1]*t+r[5]*i+r[9]*n+r[13])*a,this.z=(r[2]*t+r[6]*i+r[10]*n+r[14])*a,this}applyQuaternion(e){let t=this.x,i=this.y,n=this.z,r=e.x,a=e.y,o=e.z,s=e.w,l=s*t+a*n-o*i,c=s*i+o*t-r*n,d=s*n+r*i-a*t,u=-r*t-a*i-o*n;return this.x=l*s+u*-r+c*-o-d*-a,this.y=c*s+u*-a+d*-r-l*-o,this.z=d*s+u*-o+l*-a-c*-r,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n,this.y=r[1]*t+r[5]*i+r[9]*n,this.z=r[2]*t+r[6]*i+r[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let i=e.x,n=e.y,r=e.z,a=t.x,o=t.y,s=t.z;return this.x=n*s-r*o,this.y=r*a-i*s,this.z=i*o-n*a,this}projectOnVector(e){let t=e.lengthSq();if(0===t)return this.set(0,0,0);let i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return W_.copy(this).projectOnVector(e),this.sub(W_)}reflect(e){return this.sub(W_.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(r_(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){let n=Math.sin(t)*e;return this.x=n*Math.sin(i),this.y=Math.cos(t)*e,this.z=n*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},W_=new j_,H_=new V_,G_=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new j_(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new j_(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,n=1/0,r=-1/0,a=-1/0,o=-1/0;for(let s=0,l=e.length;s<l;s+=3){let l=e[s],c=e[s+1],d=e[s+2];l<t&&(t=l),c<i&&(i=c),d<n&&(n=d),l>r&&(r=l),c>a&&(a=c),d>o&&(o=d)}return this.min.set(t,i,n),this.max.set(r,a,o),this}setFromBufferAttribute(e){let t=1/0,i=1/0,n=1/0,r=-1/0,a=-1/0,o=-1/0;for(let s=0,l=e.count;s<l;s++){let l=e.getX(s),c=e.getY(s),d=e.getZ(s);l<t&&(t=l),c<i&&(i=c),d<n&&(n=d),l>r&&(r=l),c>a&&(a=c),d>o&&(o=d)}return this.min.set(t,i,n),this.max.set(r,a,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=X_.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);let i=e.geometry;if(void 0!==i)if(t&&null!=i.attributes&&void 0!==i.attributes.position){let t=i.attributes.position;for(let i=0,n=t.count;i<n;i++)X_.fromBufferAttribute(t,i).applyMatrix4(e.matrixWorld),this.expandByPoint(X_)}else null===i.boundingBox&&i.computeBoundingBox(),Y_.copy(i.boundingBox),Y_.applyMatrix4(e.matrixWorld),this.union(Y_);let n=e.children;for(let r=0,a=n.length;r<a;r++)this.expandByObject(n[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,X_),X_.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(tC),iC.subVectors(this.max,tC),Q_.subVectors(e.a,tC),K_.subVectors(e.b,tC),Z_.subVectors(e.c,tC),J_.subVectors(K_,Q_),$_.subVectors(Z_,K_),eC.subVectors(Q_,Z_);let t=[0,-J_.z,J_.y,0,-$_.z,$_.y,0,-eC.z,eC.y,J_.z,0,-J_.x,$_.z,0,-$_.x,eC.z,0,-eC.x,-J_.y,J_.x,0,-$_.y,$_.x,0,-eC.y,eC.x,0];return!(!aC(t,Q_,K_,Z_,iC)||(t=[1,0,0,0,1,0,0,0,1],!aC(t,Q_,K_,Z_,iC)))&&(nC.crossVectors(J_,$_),t=[nC.x,nC.y,nC.z],aC(t,Q_,K_,Z_,iC))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return X_.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(X_).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(q_[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),q_[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),q_[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),q_[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),q_[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),q_[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),q_[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),q_[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(q_)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},q_=[new j_,new j_,new j_,new j_,new j_,new j_,new j_,new j_],X_=new j_,Y_=new G_,Q_=new j_,K_=new j_,Z_=new j_,J_=new j_,$_=new j_,eC=new j_,tC=new j_,iC=new j_,nC=new j_,rC=new j_;function aC(e,t,i,n,r){for(let a=0,o=e.length-3;a<=o;a+=3){rC.fromArray(e,a);let o=r.x*Math.abs(rC.x)+r.y*Math.abs(rC.y)+r.z*Math.abs(rC.z),s=t.dot(rC),l=i.dot(rC),c=n.dot(rC);if(Math.max(-Math.max(s,l,c),Math.min(s,l,c))>o)return!1}return!0}var oC=new G_,sC=new j_,lC=new j_,cC=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new j_,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let i=this.center;void 0!==t?i.copy(t):oC.setFromPoints(e).getCenter(i);let n=0;for(let r=0,a=e.length;r<a;r++)n=Math.max(n,i.distanceToSquared(e[r]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;sC.subVectors(e,this.center);let t=sC.lengthSq();if(t>this.radius*this.radius){let e=Math.sqrt(t),i=.5*(e-this.radius);this.center.addScaledVector(sC,i/e),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(lC.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(sC.copy(e.center).add(lC)),this.expandByPoint(sC.copy(e.center).sub(lC))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}},dC=new j_,uC=new j_,hC=new j_,pC=new j_,fC=new j_,mC=new j_,gC=new j_,vC=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new j_,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new j_(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,dC)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=dC.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(dC.copy(this.direction).multiplyScalar(t).add(this.origin),dC.distanceToSquared(e))}distanceSqToSegment(e,t,i,n){uC.copy(e).add(t).multiplyScalar(.5),hC.copy(t).sub(e).normalize(),pC.copy(this.origin).sub(uC);let r,a,o,s,l=.5*e.distanceTo(t),c=-this.direction.dot(hC),d=pC.dot(this.direction),u=-pC.dot(hC),h=pC.lengthSq(),p=Math.abs(1-c*c);if(p>0)if(r=c*u-d,a=c*d-u,s=l*p,r>=0)if(a>=-s)if(a<=s){let e=1/p;r*=e,a*=e,o=r*(r+c*a+2*d)+a*(c*r+a+2*u)+h}else a=l,r=Math.max(0,-(c*a+d)),o=-r*r+a*(a+2*u)+h;else a=-l,r=Math.max(0,-(c*a+d)),o=-r*r+a*(a+2*u)+h;else a<=-s?(r=Math.max(0,-(-c*l+d)),a=r>0?-l:Math.min(Math.max(-l,-u),l),o=-r*r+a*(a+2*u)+h):a<=s?(r=0,a=Math.min(Math.max(-l,-u),l),o=a*(a+2*u)+h):(r=Math.max(0,-(c*l+d)),a=r>0?l:Math.min(Math.max(-l,-u),l),o=-r*r+a*(a+2*u)+h);else a=c>0?-l:l,r=Math.max(0,-(c*a+d)),o=-r*r+a*(a+2*u)+h;return i&&i.copy(this.direction).multiplyScalar(r).add(this.origin),n&&n.copy(hC).multiplyScalar(a).add(uC),o}intersectSphere(e,t){dC.subVectors(e.center,this.origin);let i=dC.dot(this.direction),n=dC.dot(dC)-i*i,r=e.radius*e.radius;if(n>r)return null;let a=Math.sqrt(r-n),o=i-a,s=i+a;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){let i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,n,r,a,o,s,l=1/this.direction.x,c=1/this.direction.y,d=1/this.direction.z,u=this.origin;return l>=0?(i=(e.min.x-u.x)*l,n=(e.max.x-u.x)*l):(i=(e.max.x-u.x)*l,n=(e.min.x-u.x)*l),c>=0?(r=(e.min.y-u.y)*c,a=(e.max.y-u.y)*c):(r=(e.max.y-u.y)*c,a=(e.min.y-u.y)*c),i>a||r>n||((r>i||isNaN(i))&&(i=r),(a<n||isNaN(n))&&(n=a),d>=0?(o=(e.min.z-u.z)*d,s=(e.max.z-u.z)*d):(o=(e.max.z-u.z)*d,s=(e.min.z-u.z)*d),i>s||o>n)||((o>i||i!==i)&&(i=o),(s<n||n!==n)&&(n=s),n<0)?null:this.at(i>=0?i:n,t)}intersectsBox(e){return null!==this.intersectBox(e,dC)}intersectTriangle(e,t,i,n,r){fC.subVectors(t,e),mC.subVectors(i,e),gC.crossVectors(fC,mC);let a,o=this.direction.dot(gC);if(o>0){if(n)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}pC.subVectors(this.origin,e);let s=a*this.direction.dot(mC.crossVectors(pC,mC));if(s<0)return null;let l=a*this.direction.dot(fC.cross(pC));if(l<0||s+l>o)return null;let c=-a*pC.dot(gC);return c<0?null:this.at(c/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}},yC=class{constructor(){yC.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,n,r,a,o,s,l,c,d,u,h,p,f,m){let g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=n,g[1]=r,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=c,g[10]=d,g[14]=u,g[3]=h,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new yC).fromArray(this.elements)}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){let t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,i=e.elements,n=1/bC.setFromMatrixColumn(e,0).length(),r=1/bC.setFromMatrixColumn(e,1).length(),a=1/bC.setFromMatrixColumn(e,2).length();return t[0]=i[0]*n,t[1]=i[1]*n,t[2]=i[2]*n,t[3]=0,t[4]=i[4]*r,t[5]=i[5]*r,t[6]=i[6]*r,t[7]=0,t[8]=i[8]*a,t[9]=i[9]*a,t[10]=i[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,i=e.x,n=e.y,r=e.z,a=Math.cos(i),o=Math.sin(i),s=Math.cos(n),l=Math.sin(n),c=Math.cos(r),d=Math.sin(r);if("XYZ"===e.order){let e=a*c,i=a*d,n=o*c,r=o*d;t[0]=s*c,t[4]=-s*d,t[8]=l,t[1]=i+n*l,t[5]=e-r*l,t[9]=-o*s,t[2]=r-e*l,t[6]=n+i*l,t[10]=a*s}else if("YXZ"===e.order){let e=s*c,i=s*d,n=l*c,r=l*d;t[0]=e+r*o,t[4]=n*o-i,t[8]=a*l,t[1]=a*d,t[5]=a*c,t[9]=-o,t[2]=i*o-n,t[6]=r+e*o,t[10]=a*s}else if("ZXY"===e.order){let e=s*c,i=s*d,n=l*c,r=l*d;t[0]=e-r*o,t[4]=-a*d,t[8]=n+i*o,t[1]=i+n*o,t[5]=a*c,t[9]=r-e*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){let e=a*c,i=a*d,n=o*c,r=o*d;t[0]=s*c,t[4]=n*l-i,t[8]=e*l+r,t[1]=s*d,t[5]=r*l+e,t[9]=i*l-n,t[2]=-l,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){let e=a*s,i=a*l,n=o*s,r=o*l;t[0]=s*c,t[4]=r-e*d,t[8]=n*d+i,t[1]=d,t[5]=a*c,t[9]=-o*c,t[2]=-l*c,t[6]=i*d+n,t[10]=e-r*d}else if("XZY"===e.order){let e=a*s,i=a*l,n=o*s,r=o*l;t[0]=s*c,t[4]=-d,t[8]=l*c,t[1]=e*d+r,t[5]=a*c,t[9]=i*d-n,t[2]=n*d-i,t[6]=o*c,t[10]=r*d+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(wC,e,SC)}lookAt(e,t,i){let n=this.elements;return EC.subVectors(e,t),0===EC.lengthSq()&&(EC.z=1),EC.normalize(),_C.crossVectors(i,EC),0===_C.lengthSq()&&(1===Math.abs(i.z)?EC.x+=1e-4:EC.z+=1e-4,EC.normalize(),_C.crossVectors(i,EC)),_C.normalize(),CC.crossVectors(EC,_C),n[0]=_C.x,n[4]=CC.x,n[8]=EC.x,n[1]=_C.y,n[5]=CC.y,n[9]=EC.y,n[2]=_C.z,n[6]=CC.z,n[10]=EC.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,n=t.elements,r=this.elements,a=i[0],o=i[4],s=i[8],l=i[12],c=i[1],d=i[5],u=i[9],h=i[13],p=i[2],f=i[6],m=i[10],g=i[14],v=i[3],y=i[7],b=i[11],x=i[15],w=n[0],S=n[4],_=n[8],C=n[12],E=n[1],A=n[5],M=n[9],T=n[13],P=n[2],D=n[6],O=n[10],I=n[14],k=n[3],R=n[7],z=n[11],L=n[15];return r[0]=a*w+o*E+s*P+l*k,r[4]=a*S+o*A+s*D+l*R,r[8]=a*_+o*M+s*O+l*z,r[12]=a*C+o*T+s*I+l*L,r[1]=c*w+d*E+u*P+h*k,r[5]=c*S+d*A+u*D+h*R,r[9]=c*_+d*M+u*O+h*z,r[13]=c*C+d*T+u*I+h*L,r[2]=p*w+f*E+m*P+g*k,r[6]=p*S+f*A+m*D+g*R,r[10]=p*_+f*M+m*O+g*z,r[14]=p*C+f*T+m*I+g*L,r[3]=v*w+y*E+b*P+x*k,r[7]=v*S+y*A+b*D+x*R,r[11]=v*_+y*M+b*O+x*z,r[15]=v*C+y*T+b*I+x*L,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[4],n=e[8],r=e[12],a=e[1],o=e[5],s=e[9],l=e[13],c=e[2],d=e[6],u=e[10],h=e[14];return e[3]*(+r*s*d-n*l*d-r*o*u+i*l*u+n*o*h-i*s*h)+e[7]*(+t*s*h-t*l*u+r*a*u-n*a*h+n*l*c-r*s*c)+e[11]*(+t*l*d-t*o*h-r*a*d+i*a*h+r*o*c-i*l*c)+e[15]*(-n*o*c-t*s*d+t*o*u+n*a*d-i*a*u+i*s*c)}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(e,t,i){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=i),this}invert(){let e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],d=e[9],u=e[10],h=e[11],p=e[12],f=e[13],m=e[14],g=e[15],v=d*m*l-f*u*l+f*s*h-o*m*h-d*s*g+o*u*g,y=p*u*l-c*m*l-p*s*h+a*m*h+c*s*g-a*u*g,b=c*f*l-p*d*l+p*o*h-a*f*h-c*o*g+a*d*g,x=p*d*s-c*f*s-p*o*u+a*f*u+c*o*m-a*d*m,w=t*v+i*y+n*b+r*x;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let S=1/w;return e[0]=v*S,e[1]=(f*u*r-d*m*r-f*n*h+i*m*h+d*n*g-i*u*g)*S,e[2]=(o*m*r-f*s*r+f*n*l-i*m*l-o*n*g+i*s*g)*S,e[3]=(d*s*r-o*u*r-d*n*l+i*u*l+o*n*h-i*s*h)*S,e[4]=y*S,e[5]=(c*m*r-p*u*r+p*n*h-t*m*h-c*n*g+t*u*g)*S,e[6]=(p*s*r-a*m*r-p*n*l+t*m*l+a*n*g-t*s*g)*S,e[7]=(a*u*r-c*s*r+c*n*l-t*u*l-a*n*h+t*s*h)*S,e[8]=b*S,e[9]=(p*d*r-c*f*r-p*i*h+t*f*h+c*i*g-t*d*g)*S,e[10]=(a*f*r-p*o*r+p*i*l-t*f*l-a*i*g+t*o*g)*S,e[11]=(c*o*r-a*d*r-c*i*l+t*d*l+a*i*h-t*o*h)*S,e[12]=x*S,e[13]=(c*f*n-p*d*n+p*i*u-t*f*u-c*i*m+t*d*m)*S,e[14]=(p*o*n-a*f*n-p*i*s+t*f*s+a*i*m-t*o*m)*S,e[15]=(a*d*n-c*o*n+c*i*s-t*d*s-a*i*u+t*o*u)*S,this}scale(e){let t=this.elements,i=e.x,n=e.y,r=e.z;return t[0]*=i,t[4]*=n,t[8]*=r,t[1]*=i,t[5]*=n,t[9]*=r,t[2]*=i,t[6]*=n,t[10]*=r,t[3]*=i,t[7]*=n,t[11]*=r,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,n))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let i=Math.cos(t),n=Math.sin(t),r=1-i,a=e.x,o=e.y,s=e.z,l=r*a,c=r*o;return this.set(l*a+i,l*o-n*s,l*s+n*o,0,l*o+n*s,c*o+i,c*s-n*a,0,l*s-n*o,c*s+n*a,r*s*s+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,n,r,a){return this.set(1,i,r,0,e,1,a,0,t,n,1,0,0,0,0,1),this}compose(e,t,i){let n=this.elements,r=t._x,a=t._y,o=t._z,s=t._w,l=r+r,c=a+a,d=o+o,u=r*l,h=r*c,p=r*d,f=a*c,m=a*d,g=o*d,v=s*l,y=s*c,b=s*d,x=i.x,w=i.y,S=i.z;return n[0]=(1-(f+g))*x,n[1]=(h+b)*x,n[2]=(p-y)*x,n[3]=0,n[4]=(h-b)*w,n[5]=(1-(u+g))*w,n[6]=(m+v)*w,n[7]=0,n[8]=(p+y)*S,n[9]=(m-v)*S,n[10]=(1-(u+f))*S,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,i){let n=this.elements,r=bC.set(n[0],n[1],n[2]).length(),a=bC.set(n[4],n[5],n[6]).length(),o=bC.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),e.x=n[12],e.y=n[13],e.z=n[14],xC.copy(this);let s=1/r,l=1/a,c=1/o;return xC.elements[0]*=s,xC.elements[1]*=s,xC.elements[2]*=s,xC.elements[4]*=l,xC.elements[5]*=l,xC.elements[6]*=l,xC.elements[8]*=c,xC.elements[9]*=c,xC.elements[10]*=c,t.setFromRotationMatrix(xC),i.x=r,i.y=a,i.z=o,this}makePerspective(e,t,i,n,r,a){let o=this.elements,s=2*r/(t-e),l=2*r/(i-n),c=(t+e)/(t-e),d=(i+n)/(i-n),u=-(a+r)/(a-r),h=-2*a*r/(a-r);return o[0]=s,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=d,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=h,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,i,n,r,a){let o=this.elements,s=1/(t-e),l=1/(i-n),c=1/(a-r),d=(t+e)*s,u=(i+n)*l,h=(a+r)*c;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-d,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-h,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){let t=this.elements,i=e.elements;for(let n=0;n<16;n++)if(t[n]!==i[n])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}},bC=new j_,xC=new yC,wC=new j_(0,0,0),SC=new j_(1,1,1),_C=new j_,CC=new j_,EC=new j_,AC=new yC,MC=new V_,TC=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:TC.DEFAULT_ORDER;this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e.elements,r=n[0],a=n[4],o=n[8],s=n[1],l=n[5],c=n[9],d=n[2],u=n[6],h=n[10];switch(t){case"XYZ":this._y=Math.asin(r_(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-a,r)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-r_(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,h),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-d,r),this._z=0);break;case"ZXY":this._x=Math.asin(r_(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-d,h),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,r));break;case"ZYX":this._y=Math.asin(-r_(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(u,h),this._z=Math.atan2(s,r)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(r_(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-d,r)):(this._x=0,this._y=Math.atan2(o,h));break;case"XZY":this._z=Math.asin(-r_(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===i&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return AC.makeRotationFromQuaternion(e),this.setFromRotationMatrix(AC,t,i)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return MC.setFromEuler(this),this.setFromQuaternion(MC,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};TC.DEFAULT_ORDER="XYZ";var PC=class{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&1<<e)}},DC=0,OC=new j_,IC=new V_,kC=new yC,RC=new j_,zC=new j_,LC=new j_,BC=new V_,NC=new j_(1,0,0),FC=new j_(0,1,0),UC=new j_(0,0,1),VC={type:"added"},jC={type:"removed"},WC=class extends JS{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:DC++}),this.uuid=n_(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=WC.DEFAULT_UP.clone();let e=new j_,t=new TC,i=new V_,n=new j_(1,1,1);t._onChange(function(){i.setFromEuler(t,!1)}),i._onChange(function(){t.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new yC},normalMatrix:{value:new f_}}),this.matrix=new yC,this.matrixWorld=new yC,this.matrixAutoUpdate=WC.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=WC.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new PC,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return IC.setFromAxisAngle(e,t),this.quaternion.multiply(IC),this}rotateOnWorldAxis(e,t){return IC.setFromAxisAngle(e,t),this.quaternion.premultiply(IC),this}rotateX(e){return this.rotateOnAxis(NC,e)}rotateY(e){return this.rotateOnAxis(FC,e)}rotateZ(e){return this.rotateOnAxis(UC,e)}translateOnAxis(e,t){return OC.copy(e).applyQuaternion(this.quaternion),this.position.add(OC.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(NC,e)}translateY(e){return this.translateOnAxis(FC,e)}translateZ(e){return this.translateOnAxis(UC,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(kC.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?RC.copy(e):RC.set(e,t,i);let n=this.parent;this.updateWorldMatrix(!0,!1),zC.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?kC.lookAt(zC,RC,this.up):kC.lookAt(RC,zC,this.up),this.quaternion.setFromRotationMatrix(kC),n&&(kC.extractRotation(n.matrixWorld),IC.setFromRotationMatrix(kC),this.quaternion.premultiply(IC.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(VC)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}let t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(jC)),this}removeFromParent(){let e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(jC)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),kC.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),kC.multiply(e.parent.matrixWorld)),e.applyMatrix4(kC),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,n=this.children.length;i<n;i++){let n=this.children[i].getObjectByProperty(e,t);if(void 0!==n)return n}}getObjectsByProperty(e,t){let i=[];this[e]===t&&i.push(this);for(let n=0,r=this.children.length;n<r;n++){let r=this.children[n].getObjectsByProperty(e,t);r.length>0&&(i=i.concat(r))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(zC,e,LC),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(zC,BC,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let i=0,n=t.length;i<n;i++)t[i].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);let t=this.children;for(let i=0,n=t.length;i<n;i++)t[i].traverseVisible(e)}traverseAncestors(e){let t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let i=0,n=t.length;i<n;i++){let n=t[i];(!0===n.matrixWorldAutoUpdate||!0===e)&&n.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let i=this.parent;if(!0===e&&null!==i&&!0===i.matrixWorldAutoUpdate&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){let e=this.children;for(let t=0,i=e.length;t<i;t++){let i=e[t];!0===i.matrixWorldAutoUpdate&&i.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=void 0===e||"string"==typeof e,i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let n={};function r(t,i){return void 0===t[i.uuid]&&(t[i.uuid]=i.toJSON(e)),i.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(n.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=r(e.geometries,this.geometry);let t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){let i=t.shapes;if(Array.isArray(i))for(let t=0,n=i.length;t<n;t++){let n=i[t];r(e.shapes,n)}else r(e.shapes,i)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){let t=[];for(let i=0,n=this.material.length;i<n;i++)t.push(r(e.materials,this.material[i]));n.material=t}else n.material=r(e.materials,this.material);if(this.children.length>0){n.children=[];for(let t=0;t<this.children.length;t++)n.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let t=0;t<this.animations.length;t++){let i=this.animations[t];n.animations.push(r(e.animations,i))}}if(t){let t=a(e.geometries),n=a(e.materials),r=a(e.textures),o=a(e.images),s=a(e.shapes),l=a(e.skeletons),c=a(e.animations),d=a(e.nodes);t.length>0&&(i.geometries=t),n.length>0&&(i.materials=n),r.length>0&&(i.textures=r),o.length>0&&(i.images=o),s.length>0&&(i.shapes=s),l.length>0&&(i.skeletons=l),c.length>0&&(i.animations=c),d.length>0&&(i.nodes=d)}return i.object=n,i;function a(e){let t=[];for(let i in e){let n=e[i];delete n.metadata,t.push(n)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let i=0;i<e.children.length;i++){let t=e.children[i];this.add(t.clone())}return this}};WC.DEFAULT_UP=new j_(0,1,0),WC.DEFAULT_MATRIX_AUTO_UPDATE=!0,WC.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var HC=new j_,GC=new j_,qC=new j_,XC=new j_,YC=new j_,QC=new j_,KC=new j_,ZC=new j_,JC=new j_,$C=new j_,eE=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new j_,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new j_,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new j_;this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,n){n.subVectors(i,t),HC.subVectors(e,t),n.cross(HC);let r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)}static getBarycoord(e,t,i,n,r){HC.subVectors(n,t),GC.subVectors(i,t),qC.subVectors(e,t);let a=HC.dot(HC),o=HC.dot(GC),s=HC.dot(qC),l=GC.dot(GC),c=GC.dot(qC),d=a*l-o*o;if(0===d)return r.set(-2,-1,-1);let u=1/d,h=(l*s-o*c)*u,p=(a*c-o*s)*u;return r.set(1-h-p,p,h)}static containsPoint(e,t,i,n){return this.getBarycoord(e,t,i,n,XC),XC.x>=0&&XC.y>=0&&XC.x+XC.y<=1}static getUV(e,t,i,n,r,a,o,s){return this.getBarycoord(e,t,i,n,XC),s.set(0,0),s.addScaledVector(r,XC.x),s.addScaledVector(a,XC.y),s.addScaledVector(o,XC.z),s}static isFrontFacing(e,t,i,n){return HC.subVectors(i,t),GC.subVectors(e,t),HC.cross(GC).dot(n)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,n){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,i,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return HC.subVectors(this.c,this.b),GC.subVectors(this.a,this.b),.5*HC.cross(GC).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return eE.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return eE.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,n,r){return eE.getUV(e,this.a,this.b,this.c,t,i,n,r)}containsPoint(e){return eE.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return eE.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let i,n,r=this.a,a=this.b,o=this.c;YC.subVectors(a,r),QC.subVectors(o,r),ZC.subVectors(e,r);let s=YC.dot(ZC),l=QC.dot(ZC);if(s<=0&&l<=0)return t.copy(r);JC.subVectors(e,a);let c=YC.dot(JC),d=QC.dot(JC);if(c>=0&&d<=c)return t.copy(a);let u=s*d-c*l;if(u<=0&&s>=0&&c<=0)return i=s/(s-c),t.copy(r).addScaledVector(YC,i);$C.subVectors(e,o);let h=YC.dot($C),p=QC.dot($C);if(p>=0&&h<=p)return t.copy(o);let f=h*l-s*p;if(f<=0&&l>=0&&p<=0)return n=l/(l-p),t.copy(r).addScaledVector(QC,n);let m=c*p-h*d;if(m<=0&&d-c>=0&&h-p>=0)return KC.subVectors(o,a),n=(d-c)/(d-c+(h-p)),t.copy(a).addScaledVector(KC,n);let g=1/(m+f+u);return i=f*g,n=u*g,t.copy(r).addScaledVector(YC,i).addScaledVector(QC,n)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},tE=0,iE=class extends JS{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:tE++}),this.uuid=n_(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=Yw,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=YS,this.stencilZFail=YS,this.stencilZPass=YS,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(let t in e){let i=e[t];if(void 0===i){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}let n=this[t];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){let t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});let i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(e){let t=[];for(let i in e){let n=e[i];delete n.metadata,t.push(n)}return t}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(i.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){let t=n(e.textures),r=n(e.images);t.length>0&&(i.textures=t),r.length>0&&(i.images=r)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,i=null;if(null!==t){let e=t.length;i=new Array(e);for(let n=0;n!==e;++n)i[n]=t[n].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}},nE=class extends iE{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new D_(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},rE=new j_,aE=new p_,oE=class{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=QS,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let n=0,r=this.itemSize;n<r;n++)this.array[e+n]=t.array[i+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)aE.fromBufferAttribute(this,t),aE.applyMatrix3(e),this.setXY(t,aE.x,aE.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)rE.fromBufferAttribute(this,t),rE.applyMatrix3(e),this.setXYZ(t,rE.x,rE.y,rE.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)rE.fromBufferAttribute(this,t),rE.applyMatrix4(e),this.setXYZ(t,rE.x,rE.y,rE.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)rE.fromBufferAttribute(this,t),rE.applyNormalMatrix(e),this.setXYZ(t,rE.x,rE.y,rE.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)rE.fromBufferAttribute(this,t),rE.transformDirection(e),this.setXYZ(t,rE.x,rE.y,rE.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=d_(t,this.array)),t}setX(e,t){return this.normalized&&(t=u_(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=d_(t,this.array)),t}setY(e,t){return this.normalized&&(t=u_(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=d_(t,this.array)),t}setZ(e,t){return this.normalized&&(t=u_(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=d_(t,this.array)),t}setW(e,t){return this.normalized&&(t=u_(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=u_(t,this.array),i=u_(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,n){return e*=this.itemSize,this.normalized&&(t=u_(t,this.array),i=u_(i,this.array),n=u_(n,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this}setXYZW(e,t,i,n,r){return e*=this.itemSize,this.normalized&&(t=u_(t,this.array),i=u_(i,this.array),n=u_(n,this.array),r=u_(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==QS&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},sE=class extends oE{constructor(e,t,i){super(new Uint16Array(e),t,i)}},lE=class extends oE{constructor(e,t,i){super(new Uint32Array(e),t,i)}},cE=class extends oE{constructor(e,t,i){super(new Float32Array(e),t,i)}},dE=0,uE=new yC,hE=new WC,pE=new j_,fE=new G_,mE=new G_,gE=new j_,vE=class extends JS{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:dE++}),this.uuid=n_(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(g_(e)?lE:sE)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);let i=this.attributes.normal;if(void 0!==i){let t=(new f_).getNormalMatrix(e);i.applyNormalMatrix(t),i.needsUpdate=!0}let n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return uE.makeRotationFromQuaternion(e),this.applyMatrix4(uE),this}rotateX(e){return uE.makeRotationX(e),this.applyMatrix4(uE),this}rotateY(e){return uE.makeRotationY(e),this.applyMatrix4(uE),this}rotateZ(e){return uE.makeRotationZ(e),this.applyMatrix4(uE),this}translate(e,t,i){return uE.makeTranslation(e,t,i),this.applyMatrix4(uE),this}scale(e,t,i){return uE.makeScale(e,t,i),this.applyMatrix4(uE),this}lookAt(e){return hE.lookAt(e),hE.updateMatrix(),this.applyMatrix4(hE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(pE).negate(),this.translate(pE.x,pE.y,pE.z),this}setFromPoints(e){let t=[];for(let i=0,n=e.length;i<n;i++){let n=e[i];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new cE(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new G_);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new j_(-1/0,-1/0,-1/0),new j_(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,n=t.length;i<n;i++){let e=t[i];fE.setFromBufferAttribute(e),this.morphTargetsRelative?(gE.addVectors(this.boundingBox.min,fE.min),this.boundingBox.expandByPoint(gE),gE.addVectors(this.boundingBox.max,fE.max),this.boundingBox.expandByPoint(gE)):(this.boundingBox.expandByPoint(fE.min),this.boundingBox.expandByPoint(fE.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new cC);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new j_,1/0);if(e){let i=this.boundingSphere.center;if(fE.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){let i=t[e];mE.setFromBufferAttribute(i),this.morphTargetsRelative?(gE.addVectors(fE.min,mE.min),fE.expandByPoint(gE),gE.addVectors(fE.max,mE.max),fE.expandByPoint(gE)):(fE.expandByPoint(mE.min),fE.expandByPoint(mE.max))}fE.getCenter(i);let n=0;for(let t=0,r=e.count;t<r;t++)gE.fromBufferAttribute(e,t),n=Math.max(n,i.distanceToSquared(gE));if(t)for(let r=0,a=t.length;r<a;r++){let a=t[r],o=this.morphTargetsRelative;for(let t=0,r=a.count;t<r;t++)gE.fromBufferAttribute(a,t),o&&(pE.fromBufferAttribute(e,t),gE.add(pE)),n=Math.max(n,i.distanceToSquared(gE))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");let i=e.array,n=t.position.array,r=t.normal.array,a=t.uv.array,o=n.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new oE(new Float32Array(4*o),4));let s=this.getAttribute("tangent").array,l=[],c=[];for(let E=0;E<o;E++)l[E]=new j_,c[E]=new j_;let d=new j_,u=new j_,h=new j_,p=new p_,f=new p_,m=new p_,g=new j_,v=new j_;function y(e,t,i){d.fromArray(n,3*e),u.fromArray(n,3*t),h.fromArray(n,3*i),p.fromArray(a,2*e),f.fromArray(a,2*t),m.fromArray(a,2*i),u.sub(d),h.sub(d),f.sub(p),m.sub(p);let r=1/(f.x*m.y-m.x*f.y);!isFinite(r)||(g.copy(u).multiplyScalar(m.y).addScaledVector(h,-f.y).multiplyScalar(r),v.copy(h).multiplyScalar(f.x).addScaledVector(u,-m.x).multiplyScalar(r),l[e].add(g),l[t].add(g),l[i].add(g),c[e].add(v),c[t].add(v),c[i].add(v))}let b=this.groups;0===b.length&&(b=[{start:0,count:i.length}]);for(let E=0,A=b.length;E<A;++E){let e=b[E],t=e.start;for(let n=t,r=t+e.count;n<r;n+=3)y(i[n+0],i[n+1],i[n+2])}let x=new j_,w=new j_,S=new j_,_=new j_;function C(e){S.fromArray(r,3*e),_.copy(S);let t=l[e];x.copy(t),x.sub(S.multiplyScalar(S.dot(t))).normalize(),w.crossVectors(_,t);let i=w.dot(c[e])<0?-1:1;s[4*e]=x.x,s[4*e+1]=x.y,s[4*e+2]=x.z,s[4*e+3]=i}for(let E=0,A=b.length;E<A;++E){let e=b[E],t=e.start;for(let n=t,r=t+e.count;n<r;n+=3)C(i[n+0]),C(i[n+1]),C(i[n+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new oE(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let e=0,t=i.count;e<t;e++)i.setXYZ(e,0,0,0);let n=new j_,r=new j_,a=new j_,o=new j_,s=new j_,l=new j_,c=new j_,d=new j_;if(e)for(let u=0,h=e.count;u<h;u+=3){let h=e.getX(u+0),p=e.getX(u+1),f=e.getX(u+2);n.fromBufferAttribute(t,h),r.fromBufferAttribute(t,p),a.fromBufferAttribute(t,f),c.subVectors(a,r),d.subVectors(n,r),c.cross(d),o.fromBufferAttribute(i,h),s.fromBufferAttribute(i,p),l.fromBufferAttribute(i,f),o.add(c),s.add(c),l.add(c),i.setXYZ(h,o.x,o.y,o.z),i.setXYZ(p,s.x,s.y,s.z),i.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,u=t.count;e<u;e+=3)n.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),a.fromBufferAttribute(t,e+2),c.subVectors(a,r),d.subVectors(n,r),c.cross(d),i.setXYZ(e+0,c.x,c.y,c.z),i.setXYZ(e+1,c.x,c.y,c.z),i.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)gE.fromBufferAttribute(e,t),gE.normalize(),e.setXYZ(t,gE.x,gE.y,gE.z)}toNonIndexed(){function e(e,t){let i=e.array,n=e.itemSize,r=e.normalized,a=new i.constructor(t.length*n),o=0,s=0;for(let l=0,c=t.length;l<c;l++){o=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*n;for(let e=0;e<n;e++)a[s++]=i[o++]}return new oE(a,n,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new vE,i=this.index.array,n=this.attributes;for(let o in n){let r=e(n[o],i);t.setAttribute(o,r)}let r=this.morphAttributes;for(let o in r){let n=[],a=r[o];for(let t=0,r=a.length;t<r;t++){let r=e(a[t],i);n.push(r)}t.morphAttributes[o]=n}t.morphTargetsRelative=this.morphTargetsRelative;let a=this.groups;for(let o=0,s=a.length;o<s;o++){let e=a[o];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){let t=this.parameters;for(let i in t)void 0!==t[i]&&(e[i]=t[i]);return e}e.data={attributes:{}};let t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let i=this.attributes;for(let s in i){let t=i[s];e.data.attributes[s]=t.toJSON(e.data)}let n={},r=!1;for(let s in this.morphAttributes){let t=this.morphAttributes[s],i=[];for(let n=0,r=t.length;n<r;n++){let r=t[n];i.push(r.toJSON(e.data))}i.length>0&&(n[s]=i,r=!0)}r&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);let a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));let o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let i=e.index;null!==i&&this.setIndex(i.clone(t));let n=e.attributes;for(let l in n){let e=n[l];this.setAttribute(l,e.clone(t))}let r=e.morphAttributes;for(let l in r){let e=[],i=r[l];for(let n=0,r=i.length;n<r;n++)e.push(i[n].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;let a=e.groups;for(let l=0,c=a.length;l<c;l++){let e=a[l];this.addGroup(e.start,e.count,e.materialIndex)}let o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());let s=e.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},yE=new yC,bE=new vC,xE=new cC,wE=new j_,SE=new j_,_E=new j_,CE=new j_,EE=new j_,AE=new p_,ME=new p_,TE=new p_,PE=new j_,DE=new j_,OE=class extends WC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new vE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nE;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let i=e[t[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=i.length;e<t;e++){let t=i[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){let i=this.geometry,n=i.attributes.position,r=i.morphAttributes.position,a=i.morphTargetsRelative;t.fromBufferAttribute(n,e);let o=this.morphTargetInfluences;if(r&&o){EE.set(0,0,0);for(let i=0,n=r.length;i<n;i++){let n=o[i],s=r[i];0!==n&&(CE.fromBufferAttribute(s,e),a?EE.addScaledVector(CE,n):EE.addScaledVector(CE.sub(t),n))}t.add(EE)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){let i=this.geometry,n=this.material,r=this.matrixWorld;if(void 0===n||(null===i.boundingSphere&&i.computeBoundingSphere(),xE.copy(i.boundingSphere),xE.applyMatrix4(r),!1===e.ray.intersectsSphere(xE))||(yE.copy(r).invert(),bE.copy(e.ray).applyMatrix4(yE),null!==i.boundingBox&&!1===bE.intersectsBox(i.boundingBox)))return;let a,o=i.index,s=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv2,d=i.groups,u=i.drawRange;if(null!==o)if(Array.isArray(n))for(let h=0,p=d.length;h<p;h++){let i=d[h],r=n[i.materialIndex];for(let n=Math.max(i.start,u.start),s=Math.min(o.count,Math.min(i.start+i.count,u.start+u.count));n<s;n+=3){let s=o.getX(n),d=o.getX(n+1),u=o.getX(n+2);a=IE(this,r,e,bE,l,c,s,d,u),a&&(a.faceIndex=Math.floor(n/3),a.face.materialIndex=i.materialIndex,t.push(a))}}else{for(let i=Math.max(0,u.start),r=Math.min(o.count,u.start+u.count);i<r;i+=3){let r=o.getX(i),s=o.getX(i+1),d=o.getX(i+2);a=IE(this,n,e,bE,l,c,r,s,d),a&&(a.faceIndex=Math.floor(i/3),t.push(a))}}else if(void 0!==s)if(Array.isArray(n))for(let h=0,p=d.length;h<p;h++){let i=d[h],r=n[i.materialIndex];for(let n=Math.max(i.start,u.start),o=Math.min(s.count,Math.min(i.start+i.count,u.start+u.count));n<o;n+=3){a=IE(this,r,e,bE,l,c,n,n+1,n+2),a&&(a.faceIndex=Math.floor(n/3),a.face.materialIndex=i.materialIndex,t.push(a))}}else{for(let i=Math.max(0,u.start),r=Math.min(s.count,u.start+u.count);i<r;i+=3){a=IE(this,n,e,bE,l,c,i,i+1,i+2),a&&(a.faceIndex=Math.floor(i/3),t.push(a))}}}};function IE(e,t,i,n,r,a,o,s,l){e.getVertexPosition(o,wE),e.getVertexPosition(s,SE),e.getVertexPosition(l,_E);let c=function(e,t,i,n,r,a,o,s){let l;if(l=1===t.side?n.intersectTriangle(o,a,r,!0,s):n.intersectTriangle(r,a,o,0===t.side,s),null===l)return null;DE.copy(s),DE.applyMatrix4(e.matrixWorld);let c=i.ray.origin.distanceTo(DE);return c<i.near||c>i.far?null:{distance:c,point:DE.clone(),object:e}}(e,t,i,n,wE,SE,_E,PE);if(c){r&&(AE.fromBufferAttribute(r,o),ME.fromBufferAttribute(r,s),TE.fromBufferAttribute(r,l),c.uv=eE.getUV(PE,wE,SE,_E,AE,ME,TE,new p_)),a&&(AE.fromBufferAttribute(a,o),ME.fromBufferAttribute(a,s),TE.fromBufferAttribute(a,l),c.uv2=eE.getUV(PE,wE,SE,_E,AE,ME,TE,new p_));let e={a:o,b:s,c:l,normal:new j_,materialIndex:0};eE.getNormal(wE,SE,_E,e.normal),c.face=e}return c}var kE=class extends vE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:a};let o=this;n=Math.floor(n),r=Math.floor(r),a=Math.floor(a);let s=[],l=[],c=[],d=[],u=0,h=0;function p(e,t,i,n,r,a,p,f,m,g,v){let y=a/m,b=p/g,x=a/2,w=p/2,S=f/2,_=m+1,C=g+1,E=0,A=0,M=new j_;for(let o=0;o<C;o++){let a=o*b-w;for(let s=0;s<_;s++){let u=s*y-x;M[e]=u*n,M[t]=a*r,M[i]=S,l.push(M.x,M.y,M.z),M[e]=0,M[t]=0,M[i]=f>0?1:-1,c.push(M.x,M.y,M.z),d.push(s/m),d.push(1-o/g),E+=1}}for(let o=0;o<g;o++)for(let e=0;e<m;e++){let t=u+e+_*o,i=u+e+_*(o+1),n=u+(e+1)+_*(o+1),r=u+(e+1)+_*o;s.push(t,i,r),s.push(i,n,r),A+=6}o.addGroup(h,A,v),h+=A,u+=E}p("z","y","x",-1,-1,i,t,e,a,r,0),p("z","y","x",1,-1,i,t,-e,a,r,1),p("x","z","y",1,1,e,i,t,n,a,2),p("x","z","y",1,-1,e,i,-t,n,a,3),p("x","y","z",1,-1,e,t,i,n,r,4),p("x","y","z",-1,-1,e,t,-i,n,r,5),this.setIndex(s),this.setAttribute("position",new cE(l,3)),this.setAttribute("normal",new cE(c,3)),this.setAttribute("uv",new cE(d,2))}static fromJSON(e){return new kE(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function RE(e){let t={};for(let i in e){t[i]={};for(let n in e[i]){let r=e[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?t[i][n]=r.clone():Array.isArray(r)?t[i][n]=r.slice():t[i][n]=r}}return t}function zE(e){let t={};for(let i=0;i<e.length;i++){let n=RE(e[i]);for(let e in n)t[e]=n[e]}return t}function LE(e){return null===e.getRenderTarget()&&e.outputEncoding===HS?qS:XS}var BE={clone:RE,merge:zE},NE=class extends iE{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=RE(e.uniforms),this.uniformsGroups=function(e){let t=[];for(let i=0;i<e.length;i++)t.push(e[i].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let n in this.uniforms){let i=this.uniforms[n].value;i&&i.isTexture?t.uniforms[n]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[n]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[n]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[n]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[n]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[n]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[n]={type:"m4",value:i.toArray()}:t.uniforms[n]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let i={};for(let n in this.extensions)!0===this.extensions[n]&&(i[n]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}},FE=class extends WC{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new yC,this.projectionMatrix=new yC,this.projectionMatrixInverse=new yC}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}},UE=class extends FE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=2*i_*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(.5*t_*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*i_*Math.atan(Math.tan(.5*t_*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,n,r,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(.5*t_*this.fov)/this.zoom,i=2*t,n=this.aspect*i,r=-.5*n,a=this.view;if(null!==this.view&&this.view.enabled){let e=a.fullWidth,o=a.fullHeight;r+=a.offsetX*n/e,t-=a.offsetY*i/o,n*=a.width/e,i*=a.height/o}let o=this.filmOffset;0!==o&&(r+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},VE=-90,jE=class extends WC{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i;let n=new UE(VE,1,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(1,0,0),this.add(n);let r=new UE(VE,1,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(-1,0,0),this.add(r);let a=new UE(VE,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(0,1,0),this.add(a);let o=new UE(VE,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(0,-1,0),this.add(o);let s=new UE(VE,1,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(0,0,1),this.add(s);let l=new UE(VE,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();let i=this.renderTarget,[n,r,a,o,s,l]=this.children,c=e.getRenderTarget(),d=e.toneMapping,u=e.xr.enabled;e.toneMapping=0,e.xr.enabled=!1;let h=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,n),e.setRenderTarget(i,1),e.render(t,r),e.setRenderTarget(i,2),e.render(t,a),e.setRenderTarget(i,3),e.render(t,o),e.setRenderTarget(i,4),e.render(t,s),i.texture.generateMipmaps=h,e.setRenderTarget(i,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=d,e.xr.enabled=u,i.texture.needsPMREMUpdate=!0}},WE=class extends L_{constructor(e,t,i,n,r,a,o,s,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:lS,i,n,r,a,o,s,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},HE=class extends N_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},n=[i,i,i,i,i,i];this.texture=new WE(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:vS}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let i={tEquirect:{value:null}},n="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new kE(5,5,5),o=new NE({name:"CubemapFromEquirect",uniforms:RE(i),vertexShader:n,fragmentShader:r,side:1,blending:0});o.uniforms.tEquirect.value=t;let s=new OE(a,o),l=t.minFilter;return t.minFilter===bS&&(t.minFilter=vS),new jE(1,10,this).update(e,s),t.minFilter=l,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,i,n){let r=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,i,n);e.setRenderTarget(r)}},GE=new j_,qE=new j_,XE=new f_,YE=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new j_(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){let n=GE.subVectors(i,t).cross(qE.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let i=e.delta(GE),n=this.normal.dot(i);if(0===n)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;let r=-(e.start.dot(this.normal)+this.constant)/n;return r<0||r>1?null:t.copy(i).multiplyScalar(r).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let i=t||XE.getNormalMatrix(e),n=this.coplanarPoint(GE).applyMatrix4(e),r=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}},QE=new cC,KE=new j_,ZE=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new YE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new YE,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new YE,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new YE,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new YE,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new YE;this.planes=[e,t,i,n,r,a]}set(e,t,i,n,r,a){let o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(i),o[3].copy(n),o[4].copy(r),o[5].copy(a),this}copy(e){let t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){let t=this.planes,i=e.elements,n=i[0],r=i[1],a=i[2],o=i[3],s=i[4],l=i[5],c=i[6],d=i[7],u=i[8],h=i[9],p=i[10],f=i[11],m=i[12],g=i[13],v=i[14],y=i[15];return t[0].setComponents(o-n,d-s,f-u,y-m).normalize(),t[1].setComponents(o+n,d+s,f+u,y+m).normalize(),t[2].setComponents(o+r,d+l,f+h,y+g).normalize(),t[3].setComponents(o-r,d-l,f-h,y-g).normalize(),t[4].setComponents(o-a,d-c,f-p,y-v).normalize(),t[5].setComponents(o+a,d+c,f+p,y+v).normalize(),this}intersectsObject(e){let t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),QE.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(QE)}intersectsSprite(e){return QE.center.set(0,0,0),QE.radius=.7071067811865476,QE.applyMatrix4(e.matrixWorld),this.intersectsSphere(QE)}intersectsSphere(e){let t=this.planes,i=e.center,n=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(i)<n)return!1;return!0}intersectsBox(e){let t=this.planes;for(let i=0;i<6;i++){let n=t[i];if(KE.x=n.normal.x>0?e.max.x:e.min.x,KE.y=n.normal.y>0?e.max.y:e.min.y,KE.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(KE)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}};function JE(){let e=null,t=!1,i=null,n=null;function r(t,a){i(t,a),n=e.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==i&&(n=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(e){i=e},setContext:function(t){e=t}}}function $E(e,t){let i=t.isWebGL2,n=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),n.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);let i=n.get(t);i&&(e.deleteBuffer(i.buffer),n.delete(t))},update:function(t,r){if(t.isGLBufferAttribute){let e=n.get(t);return void((!e||e.version<t.version)&&n.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);let a=n.get(t);void 0===a?n.set(t,function(t,n){let r,a=t.array,o=t.usage,s=e.createBuffer();if(e.bindBuffer(n,s),e.bufferData(n,a,o),t.onUploadCallback(),a instanceof Float32Array)r=5126;else if(a instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!i)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");r=5131}else r=5123;else if(a instanceof Int16Array)r=5122;else if(a instanceof Uint32Array)r=5125;else if(a instanceof Int32Array)r=5124;else if(a instanceof Int8Array)r=5120;else if(a instanceof Uint8Array)r=5121;else{if(!(a instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+a);r=5121}return{buffer:s,type:r,bytesPerElement:a.BYTES_PER_ELEMENT,version:t.version}}(t,r)):a.version<t.version&&(function(t,n,r){let a=n.array,o=n.updateRange;e.bindBuffer(r,t),-1===o.count?e.bufferSubData(r,0,a):(i?e.bufferSubData(r,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):e.bufferSubData(r,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1),n.onUploadCallback()}(a.buffer,t,r),a.version=t.version)}}}var eA=class extends vE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n};let r=e/2,a=t/2,o=Math.floor(i),s=Math.floor(n),l=o+1,c=s+1,d=e/o,u=t/s,h=[],p=[],f=[],m=[];for(let g=0;g<c;g++){let e=g*u-a;for(let t=0;t<l;t++){let i=t*d-r;p.push(i,-e,0),f.push(0,0,1),m.push(t/o),m.push(1-g/s)}}for(let g=0;g<s;g++)for(let e=0;e<o;e++){let t=e+l*g,i=e+l*(g+1),n=e+1+l*(g+1),r=e+1+l*g;h.push(t,i,r),h.push(i,n,r)}this.setIndex(h),this.setAttribute("position",new cE(p,3)),this.setAttribute("normal",new cE(f,3)),this.setAttribute("uv",new cE(m,2))}static fromJSON(e){return new eA(e.width,e.height,e.widthSegments,e.heightSegments)}},tA={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},iA={common:{diffuse:{value:new D_(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new f_},uv2Transform:{value:new f_},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new p_(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new D_(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new D_(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new f_}},sprite:{diffuse:{value:new D_(16777215)},opacity:{value:1},center:{value:new p_(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new f_}}},nA={basic:{uniforms:zE([iA.common,iA.specularmap,iA.envmap,iA.aomap,iA.lightmap,iA.fog]),vertexShader:tA.meshbasic_vert,fragmentShader:tA.meshbasic_frag},lambert:{uniforms:zE([iA.common,iA.specularmap,iA.envmap,iA.aomap,iA.lightmap,iA.emissivemap,iA.bumpmap,iA.normalmap,iA.displacementmap,iA.fog,iA.lights,{emissive:{value:new D_(0)}}]),vertexShader:tA.meshlambert_vert,fragmentShader:tA.meshlambert_frag},phong:{uniforms:zE([iA.common,iA.specularmap,iA.envmap,iA.aomap,iA.lightmap,iA.emissivemap,iA.bumpmap,iA.normalmap,iA.displacementmap,iA.fog,iA.lights,{emissive:{value:new D_(0)},specular:{value:new D_(1118481)},shininess:{value:30}}]),vertexShader:tA.meshphong_vert,fragmentShader:tA.meshphong_frag},standard:{uniforms:zE([iA.common,iA.envmap,iA.aomap,iA.lightmap,iA.emissivemap,iA.bumpmap,iA.normalmap,iA.displacementmap,iA.roughnessmap,iA.metalnessmap,iA.fog,iA.lights,{emissive:{value:new D_(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:tA.meshphysical_vert,fragmentShader:tA.meshphysical_frag},toon:{uniforms:zE([iA.common,iA.aomap,iA.lightmap,iA.emissivemap,iA.bumpmap,iA.normalmap,iA.displacementmap,iA.gradientmap,iA.fog,iA.lights,{emissive:{value:new D_(0)}}]),vertexShader:tA.meshtoon_vert,fragmentShader:tA.meshtoon_frag},matcap:{uniforms:zE([iA.common,iA.bumpmap,iA.normalmap,iA.displacementmap,iA.fog,{matcap:{value:null}}]),vertexShader:tA.meshmatcap_vert,fragmentShader:tA.meshmatcap_frag},points:{uniforms:zE([iA.points,iA.fog]),vertexShader:tA.points_vert,fragmentShader:tA.points_frag},dashed:{uniforms:zE([iA.common,iA.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:tA.linedashed_vert,fragmentShader:tA.linedashed_frag},depth:{uniforms:zE([iA.common,iA.displacementmap]),vertexShader:tA.depth_vert,fragmentShader:tA.depth_frag},normal:{uniforms:zE([iA.common,iA.bumpmap,iA.normalmap,iA.displacementmap,{opacity:{value:1}}]),vertexShader:tA.meshnormal_vert,fragmentShader:tA.meshnormal_frag},sprite:{uniforms:zE([iA.sprite,iA.fog]),vertexShader:tA.sprite_vert,fragmentShader:tA.sprite_frag},background:{uniforms:{uvTransform:{value:new f_},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:tA.background_vert,fragmentShader:tA.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:tA.backgroundCube_vert,fragmentShader:tA.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:tA.cube_vert,fragmentShader:tA.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:tA.equirect_vert,fragmentShader:tA.equirect_frag},distanceRGBA:{uniforms:zE([iA.common,iA.displacementmap,{referencePosition:{value:new j_},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:tA.distanceRGBA_vert,fragmentShader:tA.distanceRGBA_frag},shadow:{uniforms:zE([iA.lights,iA.fog,{color:{value:new D_(0)},opacity:{value:1}}]),vertexShader:tA.shadow_vert,fragmentShader:tA.shadow_frag}};nA.physical={uniforms:zE([nA.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new p_(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new D_(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new p_},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new D_(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new D_(1,1,1)},specularColorMap:{value:null}}]),vertexShader:tA.meshphysical_vert,fragmentShader:tA.meshphysical_frag};var rA={r:0,b:0,g:0};function aA(e,t,i,n,r,a,o){let s,l,c=new D_(0),d=!0===a?0:1,u=null,h=0,p=null;function f(t,i){t.getRGB(rA,LE(e)),n.buffers.color.setClear(rA.r,rA.g,rA.b,i,o)}return{getClearColor:function(){return c},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;c.set(e),d=t,f(c,d)},getClearAlpha:function(){return d},setClearAlpha:function(e){d=e,f(c,d)},render:function(n,a){let o=!1,m=!0===a.isScene?a.background:null;m&&m.isTexture&&(m=(a.backgroundBlurriness>0?i:t).get(m));let g=e.xr,v=g.getSession&&g.getSession();v&&"additive"===v.environmentBlendMode&&(m=null),null===m?f(c,d):m&&m.isColor&&(f(m,1),o=!0),(e.autoClear||o)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),m&&(m.isCubeTexture||m.mapping===dS)?(void 0===l&&(l=new OE(new kE(1,1,1),new NE({name:"BackgroundCubeMaterial",uniforms:RE(nA.backgroundCube.uniforms),vertexShader:nA.backgroundCube.vertexShader,fragmentShader:nA.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(l)),l.material.uniforms.envMap.value=m,l.material.uniforms.flipEnvMap.value=m.isCubeTexture&&!1===m.isRenderTargetTexture?-1:1,l.material.uniforms.backgroundBlurriness.value=a.backgroundBlurriness,l.material.uniforms.backgroundIntensity.value=a.backgroundIntensity,l.material.toneMapped=m.encoding!==HS,(u!==m||h!==m.version||p!==e.toneMapping)&&(l.material.needsUpdate=!0,u=m,h=m.version,p=e.toneMapping),l.layers.enableAll(),n.unshift(l,l.geometry,l.material,0,0,null)):m&&m.isTexture&&(void 0===s&&(s=new OE(new eA(2,2),new NE({name:"BackgroundMaterial",uniforms:RE(nA.background.uniforms),vertexShader:nA.background.vertexShader,fragmentShader:nA.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),s.geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(s)),s.material.uniforms.t2D.value=m,s.material.uniforms.backgroundIntensity.value=a.backgroundIntensity,s.material.toneMapped=m.encoding!==HS,!0===m.matrixAutoUpdate&&m.updateMatrix(),s.material.uniforms.uvTransform.value.copy(m.matrix),(u!==m||h!==m.version||p!==e.toneMapping)&&(s.material.needsUpdate=!0,u=m,h=m.version,p=e.toneMapping),s.layers.enableAll(),n.unshift(s,s.geometry,s.material,0,0,null))}}}function oA(e,t,i,n){let r=e.getParameter(34921),a=n.isWebGL2?null:t.get("OES_vertex_array_object"),o=n.isWebGL2||null!==a,s={},l=p(null),c=l,d=!1;function u(t){return n.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function h(t){return n.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function p(e){let t=[],i=[],n=[];for(let a=0;a<r;a++)t[a]=0,i[a]=0,n[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:i,attributeDivisors:n,object:e,attributes:{},index:null}}function f(){let e=c.newAttributes;for(let t=0,i=e.length;t<i;t++)e[t]=0}function m(e){g(e,0)}function g(i,r){let a=c.newAttributes,o=c.enabledAttributes,s=c.attributeDivisors;a[i]=1,0===o[i]&&(e.enableVertexAttribArray(i),o[i]=1),s[i]!==r&&((n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](i,r),s[i]=r)}function v(){let t=c.newAttributes,i=c.enabledAttributes;for(let n=0,r=i.length;n<r;n++)i[n]!==t[n]&&(e.disableVertexAttribArray(n),i[n]=0)}function y(t,i,r,a,o,s){!0!==n.isWebGL2||5124!==r&&5125!==r?e.vertexAttribPointer(t,i,r,a,o,s):e.vertexAttribIPointer(t,i,r,o,s)}function b(){x(),d=!0,c!==l&&(c=l,u(c.object))}function x(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,h,b,x){let w=!1;if(o){let t=function(t,i,r){let o=!0===r.wireframe,l=s[t.id];void 0===l&&(l={},s[t.id]=l);let c=l[i.id];void 0===c&&(c={},l[i.id]=c);let d=c[o];return void 0===d&&(d=p(n.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),c[o]=d),d}(b,h,l);c!==t&&(c=t,u(c.object)),w=function(e,t,i,n){let r=c.attributes,a=t.attributes,o=0,s=i.getAttributes();for(let l in s)if(s[l].location>=0){let t=r[l],i=a[l];if(void 0===i&&("instanceMatrix"===l&&e.instanceMatrix&&(i=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(i=e.instanceColor)),void 0===t||t.attribute!==i||i&&t.data!==i.data)return!0;o++}return c.attributesNum!==o||c.index!==n}(r,b,h,x),w&&function(e,t,i,n){let r={},a=t.attributes,o=0,s=i.getAttributes();for(let l in s)if(s[l].location>=0){let t=a[l];void 0===t&&("instanceMatrix"===l&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(t=e.instanceColor));let i={};i.attribute=t,t&&t.data&&(i.data=t.data),r[l]=i,o++}c.attributes=r,c.attributesNum=o,c.index=n}(r,b,h,x)}else{let e=!0===l.wireframe;(c.geometry!==b.id||c.program!==h.id||c.wireframe!==e)&&(c.geometry=b.id,c.program=h.id,c.wireframe=e,w=!0)}null!==x&&i.update(x,34963),(w||d)&&(d=!1,function(r,a,o,s){if(!1===n.isWebGL2&&(r.isInstancedMesh||s.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();let l=s.attributes,c=o.getAttributes(),d=a.defaultAttributeValues;for(let t in c){let n=c[t];if(n.location>=0){let a=l[t];if(void 0===a&&("instanceMatrix"===t&&r.instanceMatrix&&(a=r.instanceMatrix),"instanceColor"===t&&r.instanceColor&&(a=r.instanceColor)),void 0!==a){let t=a.normalized,o=a.itemSize,l=i.get(a);if(void 0===l)continue;let c=l.buffer,d=l.type,u=l.bytesPerElement;if(a.isInterleavedBufferAttribute){let i=a.data,l=i.stride,h=a.offset;if(i.isInstancedInterleavedBuffer){for(let e=0;e<n.locationSize;e++)g(n.location+e,i.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=i.meshPerAttribute*i.count)}else for(let e=0;e<n.locationSize;e++)m(n.location+e);e.bindBuffer(34962,c);for(let e=0;e<n.locationSize;e++)y(n.location+e,o/n.locationSize,d,t,l*u,(h+o/n.locationSize*e)*u)}else{if(a.isInstancedBufferAttribute){for(let e=0;e<n.locationSize;e++)g(n.location+e,a.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=a.meshPerAttribute*a.count)}else for(let e=0;e<n.locationSize;e++)m(n.location+e);e.bindBuffer(34962,c);for(let e=0;e<n.locationSize;e++)y(n.location+e,o/n.locationSize,d,t,o*u,o/n.locationSize*e*u)}}else if(void 0!==d){let i=d[t];if(void 0!==i)switch(i.length){case 2:e.vertexAttrib2fv(n.location,i);break;case 3:e.vertexAttrib3fv(n.location,i);break;case 4:e.vertexAttrib4fv(n.location,i);break;default:e.vertexAttrib1fv(n.location,i)}}}}v()}(r,l,h,b),null!==x&&e.bindBuffer(34963,i.get(x).buffer))},reset:b,resetDefaultState:x,dispose:function(){b();for(let e in s){let t=s[e];for(let e in t){let i=t[e];for(let e in i)h(i[e].object),delete i[e];delete t[e]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0===s[e.id])return;let t=s[e.id];for(let i in t){let e=t[i];for(let t in e)h(e[t].object),delete e[t];delete t[i]}delete s[e.id]},releaseStatesOfProgram:function(e){for(let t in s){let i=s[t];if(void 0===i[e.id])continue;let n=i[e.id];for(let e in n)h(n[e].object),delete n[e];delete i[e.id]}},initAttributes:f,enableAttribute:m,disableUnusedAttributes:v}}function sA(e,t,i,n){let r,a=n.isWebGL2;this.setMode=function(e){r=e},this.render=function(t,n){e.drawArrays(r,t,n),i.update(n,r,1)},this.renderInstances=function(n,o,s){if(0===s)return;let l,c;if(a)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](r,n,o,s),i.update(o,r,s)}}function lA(e,t,i){let n;function r(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let a=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,o=void 0!==i.precision?i.precision:"highp",s=r(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);let l=a||t.has("WEBGL_draw_buffers"),c=!0===i.logarithmicDepthBuffer,d=e.getParameter(34930),u=e.getParameter(35660),h=e.getParameter(3379),p=e.getParameter(34076),f=e.getParameter(34921),m=e.getParameter(36347),g=e.getParameter(36348),v=e.getParameter(36349),y=u>0,b=a||t.has("OES_texture_float");return{isWebGL2:a,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==n)return n;if(!0===t.has("EXT_texture_filter_anisotropic")){let i=t.get("EXT_texture_filter_anisotropic");n=e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:c,maxTextures:d,maxVertexTextures:u,maxTextureSize:h,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:a?e.getParameter(36183):0}}function cA(e){let t=this,i=null,n=0,r=!1,a=!1,o=new YE,s=new f_,l={value:null,needsUpdate:!1};function c(e,i,n,r){let a=null!==e?e.length:0,c=null;if(0!==a){if(c=l.value,!0!==r||null===c){let t=n+4*a,r=i.matrixWorldInverse;s.getNormalMatrix(r),(null===c||c.length<t)&&(c=new Float32Array(t));for(let i=0,l=n;i!==a;++i,l+=4)o.copy(e[i]).applyMatrix4(r,s),o.normal.toArray(c,l),c[l+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){let i=0!==e.length||t||0!==n||r;return r=t,n=e.length,i},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(e,t){i=c(e,t,0)},this.setState=function(o,s,d){let u=o.clippingPlanes,h=o.clipIntersection,p=o.clipShadows,f=e.get(o);if(!r||null===u||0===u.length||a&&!p)a?c(null):(l.value!==i&&(l.value=i,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0);else{let e=a?0:n,t=4*e,r=f.clippingState||null;l.value=r,r=c(u,s,t,d);for(let n=0;n!==t;++n)r[n]=i[n];f.clippingState=r,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=e}}}function dA(e){let t=new WeakMap;function i(e,t){return 303===t?e.mapping=lS:304===t&&(e.mapping=cS),e}function n(e){let i=e.target;i.removeEventListener("dispose",n);let r=t.get(i);void 0!==r&&(t.delete(i),r.dispose())}return{get:function(r){if(r&&r.isTexture&&!1===r.isRenderTargetTexture){let a=r.mapping;if(303===a||304===a){if(t.has(r)){return i(t.get(r).texture,r.mapping)}{let a=r.image;if(a&&a.height>0){let o=new HE(a.height/2);return o.fromEquirectangularTexture(e,r),t.set(r,o),r.addEventListener("dispose",n),i(o.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}var uA=class extends FE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=n,this.near=r,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,n,r,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-e,a=i+e,o=n+t,s=n-t;if(null!==this.view&&this.view.enabled){let e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,a=r+e*this.view.width,o-=t*this.view.offsetY,s=o-t*this.view.height}this.projectionMatrix.makeOrthographic(r,a,o,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}},hA=[.125,.215,.35,.446,.526,.582],pA=20,fA=new uA,mA=new D_,gA=null,vA=(1+Math.sqrt(5))/2,yA=1/vA,bA=[new j_(1,1,1),new j_(-1,1,1),new j_(1,1,-1),new j_(-1,1,-1),new j_(0,vA,yA),new j_(0,vA,-yA),new j_(yA,0,vA),new j_(-yA,0,vA),new j_(vA,yA,0),new j_(-vA,yA,0)],xA=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;gA=this._renderer.getRenderTarget(),this._setSize(256);let r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,i,n,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=CA(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=_A(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(gA),e.scissorTest=!1,SA(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===lS||e.mapping===cS?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),gA=this._renderer.getRenderTarget();let i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:vS,minFilter:vS,generateMipmaps:!1,type:_S,format:ES,encoding:WS,depthBuffer:!1},n=wA(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=wA(e,t,i);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){let t=[],i=[],n=[],r=e,a=e-4+1+hA.length;for(let o=0;o<a;o++){let a=Math.pow(2,r);i.push(a);let s=1/a;o>e-4?s=hA[o-e+4-1]:0===o&&(s=0),n.push(s);let l=1/(a-2),c=-l,d=1+l,u=[c,c,d,c,d,d,c,c,d,d,c,d],h=6,p=6,f=3,m=2,g=1,v=new Float32Array(f*p*h),y=new Float32Array(m*p*h),b=new Float32Array(g*p*h);for(let e=0;e<h;e++){let t=e%3*2/3-1,i=e>2?0:-1,n=[t,i,0,t+2/3,i,0,t+2/3,i+1,0,t,i,0,t+2/3,i+1,0,t,i+1,0];v.set(n,f*p*e),y.set(u,m*p*e);let r=[e,e,e,e,e,e];b.set(r,g*p*e)}let x=new vE;x.setAttribute("position",new oE(v,f)),x.setAttribute("uv",new oE(y,m)),x.setAttribute("faceIndex",new oE(b,g)),t.push(x),r>4&&r--}return{lodPlanes:t,sizeLods:i,sigmas:n}}(n)),this._blurMaterial=function(e,t,i){let n=new Float32Array(pA),r=new j_(0,1,0);return new NE({name:"SphericalGaussianBlur",defines:{n:pA,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(n,e,t)}return n}_compileMaterial(e){let t=new OE(this._lodPlanes[0],e);this._renderer.compile(t,fA)}_sceneToCubeUV(e,t,i,n){let r=new UE(90,1,t,i),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,c=s.toneMapping;s.getClearColor(mA),s.toneMapping=0,s.autoClear=!1;let d=new nE({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),u=new OE(new kE,d),h=!1,p=e.background;p?p.isColor&&(d.color.copy(p),e.background=null,h=!0):(d.color.copy(mA),h=!0);for(let f=0;f<6;f++){let t=f%3;0===t?(r.up.set(0,a[f],0),r.lookAt(o[f],0,0)):1===t?(r.up.set(0,0,a[f]),r.lookAt(0,o[f],0)):(r.up.set(0,a[f],0),r.lookAt(0,0,o[f]));let i=this._cubeSize;SA(n,t*i,f>2?i:0,i,i),s.setRenderTarget(n),h&&s.render(u,r),s.render(e,r)}u.geometry.dispose(),u.material.dispose(),s.toneMapping=c,s.autoClear=l,e.background=p}_textureToCubeUV(e,t){let i=this._renderer,n=e.mapping===lS||e.mapping===cS;n?(null===this._cubemapMaterial&&(this._cubemapMaterial=CA()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=_A());let r=n?this._cubemapMaterial:this._equirectMaterial,a=new OE(this._lodPlanes[0],r);r.uniforms.envMap.value=e;let o=this._cubeSize;SA(t,0,0,3*o,2*o),i.setRenderTarget(t),i.render(a,fA)}_applyPMREM(e){let t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let n=1;n<this._lodPlanes.length;n++){let t=Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]),i=bA[(n-1)%bA.length];this._blur(e,n-1,n,t,i)}t.autoClear=i}_blur(e,t,i,n,r){let a=this._pingPongRenderTarget;this._halfBlur(e,a,t,i,n,"latitudinal",r),this._halfBlur(a,e,i,i,n,"longitudinal",r)}_halfBlur(e,t,i,n,r,a,o){let s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");let c=new OE(this._lodPlanes[n],l),d=l.uniforms,u=this._sizeLods[i]-1,h=isFinite(r)?Math.PI/(2*u):2*Math.PI/39,p=r/h,f=isFinite(r)?1+Math.floor(3*p):pA;f>pA&&console.warn("sigmaRadians, ".concat(r,", is too large and will clip, as it requested ").concat(f," samples when the maximum is set to ").concat(pA));let m=[],g=0;for(let b=0;b<pA;++b){let e=b/p,t=Math.exp(-e*e/2);m.push(t),0===b?g+=t:b<f&&(g+=2*t)}for(let b=0;b<m.length;b++)m[b]=m[b]/g;d.envMap.value=e.texture,d.samples.value=f,d.weights.value=m,d.latitudinal.value="latitudinal"===a,o&&(d.poleAxis.value=o);let{_lodMax:v}=this;d.dTheta.value=h,d.mipInt.value=v-i;let y=this._sizeLods[n];SA(t,3*y*(n>v-4?n-v+4:0),4*(this._cubeSize-y),3*y,2*y),s.setRenderTarget(t),s.render(c,fA)}};function wA(e,t,i){let n=new N_(e,t,i);return n.texture.mapping=dS,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function SA(e,t,i,n,r){e.viewport.set(t,i,n,r),e.scissor.set(t,i,n,r)}function _A(){return new NE({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function CA(){return new NE({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function EA(e){let t=new WeakMap,i=null;function n(e){let i=e.target;i.removeEventListener("dispose",n);let r=t.get(i);void 0!==r&&(t.delete(i),r.dispose())}return{get:function(r){if(r&&r.isTexture){let a=r.mapping,o=303===a||304===a,s=a===lS||a===cS;if(o||s){if(r.isRenderTargetTexture&&!0===r.needsPMREMUpdate){r.needsPMREMUpdate=!1;let n=t.get(r);return null===i&&(i=new xA(e)),n=o?i.fromEquirectangular(r,n):i.fromCubemap(r,n),t.set(r,n),n.texture}if(t.has(r))return t.get(r).texture;{let a=r.image;if(o&&a&&a.height>0||s&&a&&function(e){let t=0,i=6;for(let n=0;n<i;n++)void 0!==e[n]&&t++;return t===i}(a)){null===i&&(i=new xA(e));let a=o?i.fromEquirectangular(r):i.fromCubemap(r);return t.set(r,a),r.addEventListener("dispose",n),a.texture}return null}}}return r},dispose:function(){t=new WeakMap,null!==i&&(i.dispose(),i=null)}}}function AA(e){let t={};function i(i){if(void 0!==t[i])return t[i];let n;switch(i){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(i)}return t[i]=n,n}return{has:function(e){return null!==i(e)},init:function(e){e.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(e){let t=i(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function MA(e,t,i,n){let r={},a=new WeakMap;function o(e){let s=e.target;null!==s.index&&t.remove(s.index);for(let i in s.attributes)t.remove(s.attributes[i]);s.removeEventListener("dispose",o),delete r[s.id];let l=a.get(s);l&&(t.remove(l),a.delete(s)),n.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,i.memory.geometries--}function s(e){let i=[],n=e.index,r=e.attributes.position,o=0;if(null!==n){let e=n.array;o=n.version;for(let t=0,n=e.length;t<n;t+=3){let n=e[t+0],r=e[t+1],a=e[t+2];i.push(n,r,r,a,a,n)}}else{let e=r.array;o=r.version;for(let t=0,n=e.length/3-1;t<n;t+=3){let e=t+0,n=t+1,r=t+2;i.push(e,n,n,r,r,e)}}let s=new(g_(i)?lE:sE)(i,1);s.version=o;let l=a.get(e);l&&t.remove(l),a.set(e,s)}return{get:function(e,t){return!0===r[t.id]||(t.addEventListener("dispose",o),r[t.id]=!0,i.memory.geometries++),t},update:function(e){let i=e.attributes;for(let r in i)t.update(i[r],34962);let n=e.morphAttributes;for(let r in n){let e=n[r];for(let i=0,n=e.length;i<n;i++)t.update(e[i],34962)}},getWireframeAttribute:function(e){let t=a.get(e);if(t){let i=e.index;null!==i&&t.version<i.version&&s(e)}else s(e);return a.get(e)}}}function TA(e,t,i,n){let r,a,o,s=n.isWebGL2;this.setMode=function(e){r=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,n){e.drawElements(r,n,a,t*o),i.update(n,r,1)},this.renderInstances=function(n,l,c){if(0===c)return;let d,u;if(s)d=e,u="drawElementsInstanced";else if(d=t.get("ANGLE_instanced_arrays"),u="drawElementsInstancedANGLE",null===d)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[u](r,l,a,n*o,c),i.update(l,r,c)}}function PA(e){let t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,i,n){switch(t.calls++,i){case 4:t.triangles+=n*(e/3);break;case 1:t.lines+=n*(e/2);break;case 3:t.lines+=n*(e-1);break;case 2:t.lines+=n*e;break;case 0:t.points+=n*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i)}}}}function DA(e,t){return e[0]-t[0]}function OA(e,t){return Math.abs(t[1])-Math.abs(e[1])}function IA(e,t,i){let n={},r=new Float32Array(8),a=new WeakMap,o=new B_,s=[];for(let l=0;l<8;l++)s[l]=[l,0];return{update:function(l,c,d,u){let h=l.morphTargetInfluences;if(!0===t.isWebGL2){let n=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,r=void 0!==n?n.length:0,s=a.get(c);if(void 0===s||s.count!==r){let e=function(){v.dispose(),a.delete(c),c.removeEventListener("dispose",e)};void 0!==s&&s.texture.dispose();let i=void 0!==c.morphAttributes.position,n=void 0!==c.morphAttributes.normal,l=void 0!==c.morphAttributes.color,d=c.morphAttributes.position||[],u=c.morphAttributes.normal||[],h=c.morphAttributes.color||[],p=0;!0===i&&(p=1),!0===n&&(p=2),!0===l&&(p=3);let f=c.attributes.position.count*p,m=1;f>t.maxTextureSize&&(m=Math.ceil(f/t.maxTextureSize),f=t.maxTextureSize);let g=new Float32Array(f*m*4*r),v=new F_(g,f,m,r);v.type=SS,v.needsUpdate=!0;let y=4*p;for(let t=0;t<r;t++){let e=d[t],r=u[t],a=h[t],s=f*m*4*t;for(let t=0;t<e.count;t++){let c=t*y;!0===i&&(o.fromBufferAttribute(e,t),g[s+c+0]=o.x,g[s+c+1]=o.y,g[s+c+2]=o.z,g[s+c+3]=0),!0===n&&(o.fromBufferAttribute(r,t),g[s+c+4]=o.x,g[s+c+5]=o.y,g[s+c+6]=o.z,g[s+c+7]=0),!0===l&&(o.fromBufferAttribute(a,t),g[s+c+8]=o.x,g[s+c+9]=o.y,g[s+c+10]=o.z,g[s+c+11]=4===a.itemSize?o.w:1)}}s={count:r,texture:v,size:new p_(f,m)},a.set(c,s),c.addEventListener("dispose",e)}let l=0;for(let e=0;e<h.length;e++)l+=h[e];let d=c.morphTargetsRelative?1:1-l;u.getUniforms().setValue(e,"morphTargetBaseInfluence",d),u.getUniforms().setValue(e,"morphTargetInfluences",h),u.getUniforms().setValue(e,"morphTargetsTexture",s.texture,i),u.getUniforms().setValue(e,"morphTargetsTextureSize",s.size)}else{let t=void 0===h?0:h.length,i=n[c.id];if(void 0===i||i.length!==t){i=[];for(let e=0;e<t;e++)i[e]=[e,0];n[c.id]=i}for(let e=0;e<t;e++){let t=i[e];t[0]=e,t[1]=h[e]}i.sort(OA);for(let e=0;e<8;e++)e<t&&i[e][1]?(s[e][0]=i[e][0],s[e][1]=i[e][1]):(s[e][0]=Number.MAX_SAFE_INTEGER,s[e][1]=0);s.sort(DA);let a=c.morphAttributes.position,o=c.morphAttributes.normal,l=0;for(let e=0;e<8;e++){let t=s[e],i=t[0],n=t[1];i!==Number.MAX_SAFE_INTEGER&&n?(a&&c.getAttribute("morphTarget"+e)!==a[i]&&c.setAttribute("morphTarget"+e,a[i]),o&&c.getAttribute("morphNormal"+e)!==o[i]&&c.setAttribute("morphNormal"+e,o[i]),r[e]=n,l+=n):(a&&!0===c.hasAttribute("morphTarget"+e)&&c.deleteAttribute("morphTarget"+e),o&&!0===c.hasAttribute("morphNormal"+e)&&c.deleteAttribute("morphNormal"+e),r[e]=0)}let d=c.morphTargetsRelative?1:1-l;u.getUniforms().setValue(e,"morphTargetBaseInfluence",d),u.getUniforms().setValue(e,"morphTargetInfluences",r)}}}}function kA(e,t,i,n){let r=new WeakMap;function a(e){let t=e.target;t.removeEventListener("dispose",a),i.remove(t.instanceMatrix),null!==t.instanceColor&&i.remove(t.instanceColor)}return{update:function(e){let o=n.render.frame,s=e.geometry,l=t.get(e,s);return r.get(l)!==o&&(t.update(l),r.set(l,o)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",a)&&e.addEventListener("dispose",a),i.update(e.instanceMatrix,34962),null!==e.instanceColor&&i.update(e.instanceColor,34962)),l},dispose:function(){r=new WeakMap}}}var RA=new L_,zA=new F_,LA=new class extends L_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=fS,this.minFilter=fS,this.wrapR=hS,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},BA=new WE,NA=[],FA=[],UA=new Float32Array(16),VA=new Float32Array(9),jA=new Float32Array(4);function WA(e,t,i){let n=e[0];if(null==n||n<=0||n>0)return e;let r=t*i,a=NA[r];if(void 0===a&&(a=new Float32Array(r),NA[r]=a),0!==t){n.toArray(a,0);for(let n=1,r=0;n!==t;++n)r+=i,e[n].toArray(a,r)}return a}function HA(e,t){if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(e[i]!==t[i])return!1;return!0}function GA(e,t){for(let i=0,n=t.length;i<n;i++)e[i]=t[i]}function qA(e,t){let i=FA[t];void 0===i&&(i=new Int32Array(t),FA[t]=i);for(let n=0;n!==t;++n)i[n]=e.allocateTextureUnit();return i}function XA(e,t){let i=this.cache;i[0]!==t&&(e.uniform1f(this.addr,t),i[0]=t)}function YA(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(HA(i,t))return;e.uniform2fv(this.addr,t),GA(i,t)}}function QA(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(void 0!==t.r)(i[0]!==t.r||i[1]!==t.g||i[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(HA(i,t))return;e.uniform3fv(this.addr,t),GA(i,t)}}function KA(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(HA(i,t))return;e.uniform4fv(this.addr,t),GA(i,t)}}function ZA(e,t){let i=this.cache,n=t.elements;if(void 0===n){if(HA(i,t))return;e.uniformMatrix2fv(this.addr,!1,t),GA(i,t)}else{if(HA(i,n))return;jA.set(n),e.uniformMatrix2fv(this.addr,!1,jA),GA(i,n)}}function JA(e,t){let i=this.cache,n=t.elements;if(void 0===n){if(HA(i,t))return;e.uniformMatrix3fv(this.addr,!1,t),GA(i,t)}else{if(HA(i,n))return;VA.set(n),e.uniformMatrix3fv(this.addr,!1,VA),GA(i,n)}}function $A(e,t){let i=this.cache,n=t.elements;if(void 0===n){if(HA(i,t))return;e.uniformMatrix4fv(this.addr,!1,t),GA(i,t)}else{if(HA(i,n))return;UA.set(n),e.uniformMatrix4fv(this.addr,!1,UA),GA(i,n)}}function eM(e,t){let i=this.cache;i[0]!==t&&(e.uniform1i(this.addr,t),i[0]=t)}function tM(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(HA(i,t))return;e.uniform2iv(this.addr,t),GA(i,t)}}function iM(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(HA(i,t))return;e.uniform3iv(this.addr,t),GA(i,t)}}function nM(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(HA(i,t))return;e.uniform4iv(this.addr,t),GA(i,t)}}function rM(e,t){let i=this.cache;i[0]!==t&&(e.uniform1ui(this.addr,t),i[0]=t)}function aM(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(HA(i,t))return;e.uniform2uiv(this.addr,t),GA(i,t)}}function oM(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(HA(i,t))return;e.uniform3uiv(this.addr,t),GA(i,t)}}function sM(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(HA(i,t))return;e.uniform4uiv(this.addr,t),GA(i,t)}}function lM(e,t,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture2D(t||RA,r)}function cM(e,t,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(t||LA,r)}function dM(e,t,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(t||BA,r)}function uM(e,t,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(t||zA,r)}function hM(e,t){e.uniform1fv(this.addr,t)}function pM(e,t){let i=WA(t,this.size,2);e.uniform2fv(this.addr,i)}function fM(e,t){let i=WA(t,this.size,3);e.uniform3fv(this.addr,i)}function mM(e,t){let i=WA(t,this.size,4);e.uniform4fv(this.addr,i)}function gM(e,t){let i=WA(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,i)}function vM(e,t){let i=WA(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,i)}function yM(e,t){let i=WA(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,i)}function bM(e,t){e.uniform1iv(this.addr,t)}function xM(e,t){e.uniform2iv(this.addr,t)}function wM(e,t){e.uniform3iv(this.addr,t)}function SM(e,t){e.uniform4iv(this.addr,t)}function _M(e,t){e.uniform1uiv(this.addr,t)}function CM(e,t){e.uniform2uiv(this.addr,t)}function EM(e,t){e.uniform3uiv(this.addr,t)}function AM(e,t){e.uniform4uiv(this.addr,t)}function MM(e,t,i){let n=this.cache,r=t.length,a=qA(i,r);HA(n,a)||(e.uniform1iv(this.addr,a),GA(n,a));for(let o=0;o!==r;++o)i.setTexture2D(t[o]||RA,a[o])}function TM(e,t,i){let n=this.cache,r=t.length,a=qA(i,r);HA(n,a)||(e.uniform1iv(this.addr,a),GA(n,a));for(let o=0;o!==r;++o)i.setTexture3D(t[o]||LA,a[o])}function PM(e,t,i){let n=this.cache,r=t.length,a=qA(i,r);HA(n,a)||(e.uniform1iv(this.addr,a),GA(n,a));for(let o=0;o!==r;++o)i.setTextureCube(t[o]||BA,a[o])}function DM(e,t,i){let n=this.cache,r=t.length,a=qA(i,r);HA(n,a)||(e.uniform1iv(this.addr,a),GA(n,a));for(let o=0;o!==r;++o)i.setTexture2DArray(t[o]||zA,a[o])}var OM=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function(e){switch(e){case 5126:return XA;case 35664:return YA;case 35665:return QA;case 35666:return KA;case 35674:return ZA;case 35675:return JA;case 35676:return $A;case 5124:case 35670:return eM;case 35667:case 35671:return tM;case 35668:case 35672:return iM;case 35669:case 35673:return nM;case 5125:return rM;case 36294:return aM;case 36295:return oM;case 36296:return sM;case 35678:case 36198:case 36298:case 36306:case 35682:return lM;case 35679:case 36299:case 36307:return cM;case 35680:case 36300:case 36308:case 36293:return dM;case 36289:case 36303:case 36311:case 36292:return uM}}(t.type)}},IM=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return hM;case 35664:return pM;case 35665:return fM;case 35666:return mM;case 35674:return gM;case 35675:return vM;case 35676:return yM;case 5124:case 35670:return bM;case 35667:case 35671:return xM;case 35668:case 35672:return wM;case 35669:case 35673:return SM;case 5125:return _M;case 36294:return CM;case 36295:return EM;case 36296:return AM;case 35678:case 36198:case 36298:case 36306:case 35682:return MM;case 35679:case 36299:case 36307:return TM;case 35680:case 36300:case 36308:case 36293:return PM;case 36289:case 36303:case 36311:case 36292:return DM}}(t.type)}},kM=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){if(void 0===t)return;let n=this.seq;for(let r=0,a=n.length;r!==a;++r){let a=n[r];a.setValue(e,t[a.id],i)}}},RM=/(\w+)(\])?(\[|\.)?/g;function zM(e,t){e.seq.push(t),e.map[t.id]=t}function LM(e,t,i){let n=e.name,r=n.length;for(RM.lastIndex=0;;){let a=RM.exec(n),o=RM.lastIndex,s=a[1],l="]"===a[2],c=a[3];if(l&&(s|=0),void 0===c||"["===c&&o+2===r){zM(i,void 0===c?new OM(s,e,t):new IM(s,e,t));break}{let e=i.map[s];void 0===e&&(e=new kM(s),zM(i,e)),i=e}}}var BM=class{constructor(e,t){this.seq=[],this.map={};let i=e.getProgramParameter(t,35718);for(let n=0;n<i;++n){let i=e.getActiveUniform(t,n);LM(i,e.getUniformLocation(t,i.name),this)}}setValue(e,t,i,n){let r=this.map[t];void 0!==r&&r.setValue(e,i,n)}setOptional(e,t,i){let n=t[i];void 0!==n&&this.setValue(e,i,n)}static upload(e,t,i,n){for(let r=0,a=t.length;r!==a;++r){let a=t[r],o=i[a.id];!1!==o.needsUpdate&&a.setValue(e,o.value,n)}}static seqWithValue(e,t){let i=[];for(let n=0,r=e.length;n!==r;++n){let r=e[n];r.id in t&&i.push(r)}return i}};function NM(e,t,i){let n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),n}var FM=0;function UM(e,t,i){let n=e.getShaderParameter(t,35713),r=e.getShaderInfoLog(t).trim();if(n&&""===r)return"";let a=/ERROR: 0:(\d+)/.exec(r);if(a){let n=parseInt(a[1]);return i.toUpperCase()+"\n\n"+r+"\n\n"+function(e,t){let i=e.split("\n"),n=[],r=Math.max(t-6,0),a=Math.min(t+6,i.length);for(let o=r;o<a;o++){let e=o+1;n.push("".concat(e===t?">":" "," ").concat(e,": ").concat(i[o]))}return n.join("\n")}(e.getShaderSource(t),n)}return r}function VM(e,t){let i=function(e){switch(e){case WS:return["Linear","( value )"];case HS:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function jM(e,t){let i;switch(t){case 1:i="Linear";break;case 2:i="Reinhard";break;case 3:i="OptimizedCineon";break;case 4:i="ACESFilmic";break;case 5:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),i="Linear"}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function WM(e){return""!==e}function HM(e,t){let i=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function GM(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var qM=/^[ \t]*#include +<([\w\d./]+)>/gm;function XM(e){return e.replace(qM,YM)}function YM(e,t){let i=tA[t];if(void 0===i)throw new Error("Can not resolve #include <"+t+">");return XM(i)}var QM=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function KM(e){return e.replace(QM,ZM)}function ZM(e,t,i,n){let r="";for(let a=parseInt(t);a<parseInt(i);a++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return r}function JM(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function $M(e,t,i,n){let r,a,o=e.getContext(),s=i.defines,l=i.vertexShader,c=i.fragmentShader,d=function(e){let t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(i),u=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case lS:case cS:t="ENVMAP_TYPE_CUBE";break;case dS:t="ENVMAP_TYPE_CUBE_UV"}return t}(i),h=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===cS&&(t="ENVMAP_MODE_REFRACTION");return t}(i),p=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(i),f=function(e){let t=e.envMapCubeUVHeight;if(null===t)return null;let i=Math.log2(t)-2,n=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,i),112)),texelHeight:n,maxMip:i}}(i),m=i.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(WM).join("\n")}(i),g=function(e){let t=[];for(let i in e){let n=e[i];!1!==n&&t.push("#define "+i+" "+n)}return t.join("\n")}(s),v=o.createProgram(),y=i.glslVersion?"#version "+i.glslVersion+"\n":"";i.isRawShaderMaterial?(r=[g].filter(WM).join("\n"),r.length>0&&(r+="\n"),a=[m,g].filter(WM).join("\n"),a.length>0&&(a+="\n")):(r=[JM(i),"#define SHADER_NAME "+i.shaderName,g,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&!1===i.flatShading?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+d:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(WM).join("\n"),a=[m,JM(i),"#define SHADER_NAME "+i.shaderName,g,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+u:"",i.envMap?"#define "+h:"",i.envMap?"#define "+p:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+d:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==i.toneMapping?"#define TONE_MAPPING":"",0!==i.toneMapping?tA.tonemapping_pars_fragment:"",0!==i.toneMapping?jM("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",tA.encodings_pars_fragment,VM("linearToOutputTexel",i.outputEncoding),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(WM).join("\n")),l=XM(l),l=HM(l,i),l=GM(l,i),c=XM(c),c=HM(c,i),c=GM(c,i),l=KM(l),c=KM(c),i.isWebGL2&&!0!==i.isRawShaderMaterial&&(y="#version 300 es\n",r=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+r,a=["#define varying in",i.glslVersion===KS?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===KS?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+a);let b,x,w=y+a+c,S=NM(o,35633,y+r+l),_=NM(o,35632,w);if(o.attachShader(v,S),o.attachShader(v,_),void 0!==i.index0AttributeName?o.bindAttribLocation(v,0,i.index0AttributeName):!0===i.morphTargets&&o.bindAttribLocation(v,0,"position"),o.linkProgram(v),e.debug.checkShaderErrors){let e=o.getProgramInfoLog(v).trim(),t=o.getShaderInfoLog(S).trim(),i=o.getShaderInfoLog(_).trim(),n=!0,s=!0;if(!1===o.getProgramParameter(v,35714)){n=!1;let t=UM(o,S,"vertex"),i=UM(o,_,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(v,35715)+"\n\nProgram Info Log: "+e+"\n"+t+"\n"+i)}else""!==e?console.warn("THREE.WebGLProgram: Program Info Log:",e):(""===t||""===i)&&(s=!1);s&&(this.diagnostics={runnable:n,programLog:e,vertexShader:{log:t,prefix:r},fragmentShader:{log:i,prefix:a}})}return o.deleteShader(S),o.deleteShader(_),this.getUniforms=function(){return void 0===b&&(b=new BM(o,v)),b},this.getAttributes=function(){return void 0===x&&(x=function(e,t){let i={},n=e.getProgramParameter(t,35721);for(let r=0;r<n;r++){let n=e.getActiveAttrib(t,r),a=n.name,o=1;35674===n.type&&(o=2),35675===n.type&&(o=3),35676===n.type&&(o=4),i[a]={type:n.type,location:e.getAttribLocation(t,a),locationSize:o}}return i}(o,v)),x},this.destroy=function(){n.releaseStatesOfProgram(this),o.deleteProgram(v),this.program=void 0},this.name=i.shaderName,this.id=FM++,this.cacheKey=t,this.usedTimes=1,this.program=v,this.vertexShader=S,this.fragmentShader=_,this}var eT=0,tT=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,i=e.fragmentShader,n=this._getShaderStage(t),r=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return!1===a.has(n)&&(a.add(n),n.usedTimes++),!1===a.has(r)&&(a.add(r),r.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){let t=this.shaderCache,i=t.get(e);return void 0===i&&(i=new iT(e),t.set(e,i)),i}},iT=class{constructor(e){this.id=eT++,this.code=e,this.usedTimes=0}};function nT(e,t,i,n,r,a,o){let s=new PC,l=new tT,c=[],d=r.isWebGL2,u=r.logarithmicDepthBuffer,h=r.vertexTextures,p=r.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(a,s,c,m,g){let v=m.fog,y=g.geometry,b=a.isMeshStandardMaterial?m.environment:null,x=(a.isMeshStandardMaterial?i:t).get(a.envMap||b),w=x&&x.mapping===dS?x.image.height:null,S=f[a.type];null!==a.precision&&(p=r.getMaxPrecision(a.precision),p!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",p,"instead."));let _,C,E,A,M=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,T=void 0!==M?M.length:0,P=0;if(void 0!==y.morphAttributes.position&&(P=1),void 0!==y.morphAttributes.normal&&(P=2),void 0!==y.morphAttributes.color&&(P=3),S){let e=nA[S];_=e.vertexShader,C=e.fragmentShader}else _=a.vertexShader,C=a.fragmentShader,l.update(a),E=l.getVertexShaderID(a),A=l.getFragmentShaderID(a);let D=e.getRenderTarget(),O=a.alphaTest>0,I=a.clearcoat>0,k=a.iridescence>0;return{isWebGL2:d,shaderID:S,shaderName:a.type,vertexShader:_,fragmentShader:C,defines:a.defines,customVertexShaderID:E,customFragmentShaderID:A,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:p,instancing:!0===g.isInstancedMesh,instancingColor:!0===g.isInstancedMesh&&null!==g.instanceColor,supportsVertexTextures:h,outputEncoding:null===D?e.outputEncoding:!0===D.isXRRenderTarget?D.texture.encoding:WS,map:!!a.map,matcap:!!a.matcap,envMap:!!x,envMapMode:x&&x.mapping,envMapCubeUVHeight:w,lightMap:!!a.lightMap,aoMap:!!a.aoMap,emissiveMap:!!a.emissiveMap,bumpMap:!!a.bumpMap,normalMap:!!a.normalMap,objectSpaceNormalMap:1===a.normalMapType,tangentSpaceNormalMap:0===a.normalMapType,decodeVideoTexture:!!a.map&&!0===a.map.isVideoTexture&&a.map.encoding===HS,clearcoat:I,clearcoatMap:I&&!!a.clearcoatMap,clearcoatRoughnessMap:I&&!!a.clearcoatRoughnessMap,clearcoatNormalMap:I&&!!a.clearcoatNormalMap,iridescence:k,iridescenceMap:k&&!!a.iridescenceMap,iridescenceThicknessMap:k&&!!a.iridescenceThicknessMap,displacementMap:!!a.displacementMap,roughnessMap:!!a.roughnessMap,metalnessMap:!!a.metalnessMap,specularMap:!!a.specularMap,specularIntensityMap:!!a.specularIntensityMap,specularColorMap:!!a.specularColorMap,opaque:!1===a.transparent&&1===a.blending,alphaMap:!!a.alphaMap,alphaTest:O,gradientMap:!!a.gradientMap,sheen:a.sheen>0,sheenColorMap:!!a.sheenColorMap,sheenRoughnessMap:!!a.sheenRoughnessMap,transmission:a.transmission>0,transmissionMap:!!a.transmissionMap,thicknessMap:!!a.thicknessMap,combine:a.combine,vertexTangents:!!a.normalMap&&!!y.attributes.tangent,vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!y.attributes.color&&4===y.attributes.color.itemSize,vertexUvs:!!a.map||!!a.bumpMap||!!a.normalMap||!!a.specularMap||!!a.alphaMap||!!a.emissiveMap||!!a.roughnessMap||!!a.metalnessMap||!!a.clearcoatMap||!!a.clearcoatRoughnessMap||!!a.clearcoatNormalMap||!!a.iridescenceMap||!!a.iridescenceThicknessMap||!!a.displacementMap||!!a.transmissionMap||!!a.thicknessMap||!!a.specularIntensityMap||!!a.specularColorMap||!!a.sheenColorMap||!!a.sheenRoughnessMap,uvsVertexOnly:!(a.map||a.bumpMap||a.normalMap||a.specularMap||a.alphaMap||a.emissiveMap||a.roughnessMap||a.metalnessMap||a.clearcoatNormalMap||a.iridescenceMap||a.iridescenceThicknessMap||a.transmission>0||a.transmissionMap||a.thicknessMap||a.specularIntensityMap||a.specularColorMap||a.sheen>0||a.sheenColorMap||a.sheenRoughnessMap)&&!!a.displacementMap,fog:!!v,useFog:!0===a.fog,fogExp2:v&&v.isFogExp2,flatShading:!!a.flatShading,sizeAttenuation:a.sizeAttenuation,logarithmicDepthBuffer:u,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==y.morphAttributes.position,morphNormals:void 0!==y.morphAttributes.normal,morphColors:void 0!==y.morphAttributes.color,morphTargetsCount:T,morphTextureStride:P,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numSpotLightMaps:s.spotLightMap.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numSpotLightShadowsWithMaps:s.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.length>0,shadowMapType:e.shadowMap.type,toneMapping:a.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:a.premultipliedAlpha,doubleSided:2===a.side,flipSided:1===a.side,useDepthPacking:!!a.depthPacking,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionDerivatives:a.extensions&&a.extensions.derivatives,extensionFragDepth:a.extensions&&a.extensions.fragDepth,extensionDrawBuffers:a.extensions&&a.extensions.drawBuffers,extensionShaderTextureLOD:a.extensions&&a.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||n.has("EXT_shader_texture_lod"),customProgramCacheKey:a.customProgramCacheKey()}},getProgramCacheKey:function(t){let i=[];if(t.shaderID?i.push(t.shaderID):(i.push(t.customVertexShaderID),i.push(t.customFragmentShaderID)),void 0!==t.defines)for(let e in t.defines)i.push(e),i.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(function(e,t){e.push(t.precision),e.push(t.outputEncoding),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.combine),e.push(t.vertexUvs),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(i,t),function(e,t){s.disableAll(),t.isWebGL2&&s.enable(0),t.supportsVertexTextures&&s.enable(1),t.instancing&&s.enable(2),t.instancingColor&&s.enable(3),t.map&&s.enable(4),t.matcap&&s.enable(5),t.envMap&&s.enable(6),t.lightMap&&s.enable(7),t.aoMap&&s.enable(8),t.emissiveMap&&s.enable(9),t.bumpMap&&s.enable(10),t.normalMap&&s.enable(11),t.objectSpaceNormalMap&&s.enable(12),t.tangentSpaceNormalMap&&s.enable(13),t.clearcoat&&s.enable(14),t.clearcoatMap&&s.enable(15),t.clearcoatRoughnessMap&&s.enable(16),t.clearcoatNormalMap&&s.enable(17),t.iridescence&&s.enable(18),t.iridescenceMap&&s.enable(19),t.iridescenceThicknessMap&&s.enable(20),t.displacementMap&&s.enable(21),t.specularMap&&s.enable(22),t.roughnessMap&&s.enable(23),t.metalnessMap&&s.enable(24),t.gradientMap&&s.enable(25),t.alphaMap&&s.enable(26),t.alphaTest&&s.enable(27),t.vertexColors&&s.enable(28),t.vertexAlphas&&s.enable(29),t.vertexUvs&&s.enable(30),t.vertexTangents&&s.enable(31),t.uvsVertexOnly&&s.enable(32),e.push(s.mask),s.disableAll(),t.fog&&s.enable(0),t.useFog&&s.enable(1),t.flatShading&&s.enable(2),t.logarithmicDepthBuffer&&s.enable(3),t.skinning&&s.enable(4),t.morphTargets&&s.enable(5),t.morphNormals&&s.enable(6),t.morphColors&&s.enable(7),t.premultipliedAlpha&&s.enable(8),t.shadowMapEnabled&&s.enable(9),t.physicallyCorrectLights&&s.enable(10),t.doubleSided&&s.enable(11),t.flipSided&&s.enable(12),t.useDepthPacking&&s.enable(13),t.dithering&&s.enable(14),t.specularIntensityMap&&s.enable(15),t.specularColorMap&&s.enable(16),t.transmission&&s.enable(17),t.transmissionMap&&s.enable(18),t.thicknessMap&&s.enable(19),t.sheen&&s.enable(20),t.sheenColorMap&&s.enable(21),t.sheenRoughnessMap&&s.enable(22),t.decodeVideoTexture&&s.enable(23),t.opaque&&s.enable(24),e.push(s.mask)}(i,t),i.push(e.outputEncoding)),i.push(t.customProgramCacheKey),i.join()},getUniforms:function(e){let t,i=f[e.type];if(i){let e=nA[i];t=BE.clone(e.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,i){let n;for(let e=0,r=c.length;e<r;e++){let t=c[e];if(t.cacheKey===i){n=t,++n.usedTimes;break}}return void 0===n&&(n=new $M(e,i,t,a),c.push(n)),n},releaseProgram:function(e){if(0===--e.usedTimes){let t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:c,dispose:function(){l.dispose()}}}function rT(){let e=new WeakMap;return{get:function(t){let i=e.get(t);return void 0===i&&(i={},e.set(t,i)),i},remove:function(t){e.delete(t)},update:function(t,i,n){e.get(t)[i]=n},dispose:function(){e=new WeakMap}}}function aT(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function oT(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function sT(){let e=[],t=0,i=[],n=[],r=[];function a(i,n,r,a,o,s){let l=e[t];return void 0===l?(l={id:i.id,object:i,geometry:n,material:r,groupOrder:a,renderOrder:i.renderOrder,z:o,group:s},e[t]=l):(l.id=i.id,l.object=i,l.geometry=n,l.material=r,l.groupOrder=a,l.renderOrder=i.renderOrder,l.z=o,l.group=s),t++,l}return{opaque:i,transmissive:n,transparent:r,init:function(){t=0,i.length=0,n.length=0,r.length=0},push:function(e,t,o,s,l,c){let d=a(e,t,o,s,l,c);o.transmission>0?n.push(d):!0===o.transparent?r.push(d):i.push(d)},unshift:function(e,t,o,s,l,c){let d=a(e,t,o,s,l,c);o.transmission>0?n.unshift(d):!0===o.transparent?r.unshift(d):i.unshift(d)},finish:function(){for(let i=t,n=e.length;i<n;i++){let t=e[i];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){i.length>1&&i.sort(e||aT),n.length>1&&n.sort(t||oT),r.length>1&&r.sort(t||oT)}}}function lT(){let e=new WeakMap;return{get:function(t,i){let n,r=e.get(t);return void 0===r?(n=new sT,e.set(t,[n])):i>=r.length?(n=new sT,r.push(n)):n=r[i],n},dispose:function(){e=new WeakMap}}}function cT(){let e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let i;switch(t.type){case"DirectionalLight":i={direction:new j_,color:new D_};break;case"SpotLight":i={position:new j_,direction:new j_,color:new D_,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new j_,color:new D_,distance:0,decay:0};break;case"HemisphereLight":i={direction:new j_,skyColor:new D_,groundColor:new D_};break;case"RectAreaLight":i={color:new D_,position:new j_,halfWidth:new j_,halfHeight:new j_}}return e[t.id]=i,i}}}var dT=0;function uT(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function hT(e,t){let i=new cT,n=function(){let e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let i;switch(t.type){case"DirectionalLight":case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new p_};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new p_,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=i,i}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let l=0;l<9;l++)r.probe.push(new j_);let a=new j_,o=new yC,s=new yC;return{setup:function(a,o){let s=0,l=0,c=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let d=0,u=0,h=0,p=0,f=0,m=0,g=0,v=0,y=0,b=0;a.sort(uT);let x=!0!==o?Math.PI:1;for(let e=0,t=a.length;e<t;e++){let t=a[e],o=t.color,w=t.intensity,S=t.distance,_=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)s+=o.r*w*x,l+=o.g*w*x,c+=o.b*w*x;else if(t.isLightProbe)for(let e=0;e<9;e++)r.probe[e].addScaledVector(t.sh.coefficients[e],w);else if(t.isDirectionalLight){let e=i.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*x),t.castShadow){let e=t.shadow,i=n.get(t);i.shadowBias=e.bias,i.shadowNormalBias=e.normalBias,i.shadowRadius=e.radius,i.shadowMapSize=e.mapSize,r.directionalShadow[d]=i,r.directionalShadowMap[d]=_,r.directionalShadowMatrix[d]=t.shadow.matrix,m++}r.directional[d]=e,d++}else if(t.isSpotLight){let e=i.get(t);e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(o).multiplyScalar(w*x),e.distance=S,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,r.spot[h]=e;let a=t.shadow;if(t.map&&(r.spotLightMap[y]=t.map,y++,a.updateMatrices(t),t.castShadow&&b++),r.spotLightMatrix[h]=a.matrix,t.castShadow){let e=n.get(t);e.shadowBias=a.bias,e.shadowNormalBias=a.normalBias,e.shadowRadius=a.radius,e.shadowMapSize=a.mapSize,r.spotShadow[h]=e,r.spotShadowMap[h]=_,v++}h++}else if(t.isRectAreaLight){let e=i.get(t);e.color.copy(o).multiplyScalar(w),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),r.rectArea[p]=e,p++}else if(t.isPointLight){let e=i.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*x),e.distance=t.distance,e.decay=t.decay,t.castShadow){let e=t.shadow,i=n.get(t);i.shadowBias=e.bias,i.shadowNormalBias=e.normalBias,i.shadowRadius=e.radius,i.shadowMapSize=e.mapSize,i.shadowCameraNear=e.camera.near,i.shadowCameraFar=e.camera.far,r.pointShadow[u]=i,r.pointShadowMap[u]=_,r.pointShadowMatrix[u]=t.shadow.matrix,g++}r.point[u]=e,u++}else if(t.isHemisphereLight){let e=i.get(t);e.skyColor.copy(t.color).multiplyScalar(w*x),e.groundColor.copy(t.groundColor).multiplyScalar(w*x),r.hemi[f]=e,f++}}p>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=iA.LTC_FLOAT_1,r.rectAreaLTC2=iA.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=iA.LTC_HALF_1,r.rectAreaLTC2=iA.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=s,r.ambient[1]=l,r.ambient[2]=c;let w=r.hash;(w.directionalLength!==d||w.pointLength!==u||w.spotLength!==h||w.rectAreaLength!==p||w.hemiLength!==f||w.numDirectionalShadows!==m||w.numPointShadows!==g||w.numSpotShadows!==v||w.numSpotMaps!==y)&&(r.directional.length=d,r.spot.length=h,r.rectArea.length=p,r.point.length=u,r.hemi.length=f,r.directionalShadow.length=m,r.directionalShadowMap.length=m,r.pointShadow.length=g,r.pointShadowMap.length=g,r.spotShadow.length=v,r.spotShadowMap.length=v,r.directionalShadowMatrix.length=m,r.pointShadowMatrix.length=g,r.spotLightMatrix.length=v+y-b,r.spotLightMap.length=y,r.numSpotLightShadowsWithMaps=b,w.directionalLength=d,w.pointLength=u,w.spotLength=h,w.rectAreaLength=p,w.hemiLength=f,w.numDirectionalShadows=m,w.numPointShadows=g,w.numSpotShadows=v,w.numSpotMaps=y,r.version=dT++)},setupView:function(e,t){let i=0,n=0,l=0,c=0,d=0,u=t.matrixWorldInverse;for(let h=0,p=e.length;h<p;h++){let t=e[h];if(t.isDirectionalLight){let e=r.directional[i];e.direction.setFromMatrixPosition(t.matrixWorld),a.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(u),i++}else if(t.isSpotLight){let e=r.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),e.direction.setFromMatrixPosition(t.matrixWorld),a.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(u),l++}else if(t.isRectAreaLight){let e=r.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),s.identity(),o.copy(t.matrixWorld),o.premultiply(u),s.extractRotation(o),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(s),e.halfHeight.applyMatrix4(s),c++}else if(t.isPointLight){let e=r.point[n];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),n++}else if(t.isHemisphereLight){let e=r.hemi[d];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(u),d++}}},state:r}}function pT(e,t){let i=new hT(e,t),n=[],r=[];return{init:function(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:i},setupLights:function(e){i.setup(n,e)},setupLightsView:function(e){i.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){r.push(e)}}}function fT(e,t){let i=new WeakMap;return{get:function(n){let r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=i.get(n);return void 0===o?(r=new pT(e,t),i.set(n,[r])):a>=o.length?(r=new pT(e,t),o.push(r)):r=o[a],r},dispose:function(){i=new WeakMap}}}var mT=class extends iE{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=GS,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},gT=class extends iE{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new j_,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}};function vT(e,t,i){let n=new ZE,r=new p_,a=new p_,o=new B_,s=new mT({depthPacking:3201}),l=new gT,c={},d=i.maxTextureSize,u={[Gw]:1,[qw]:0,[Xw]:2},h=new NE({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new p_},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=h.clone();p.defines.HORIZONTAL_PASS=1;let f=new vE;f.setAttribute("position",new oE(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new OE(f,h),g=this;function v(i,n){let a=t.update(m);h.defines.VSM_SAMPLES!==i.blurSamples&&(h.defines.VSM_SAMPLES=i.blurSamples,p.defines.VSM_SAMPLES=i.blurSamples,h.needsUpdate=!0,p.needsUpdate=!0),null===i.mapPass&&(i.mapPass=new N_(r.x,r.y)),h.uniforms.shadow_pass.value=i.map.texture,h.uniforms.resolution.value=i.mapSize,h.uniforms.radius.value=i.radius,e.setRenderTarget(i.mapPass),e.clear(),e.renderBufferDirect(n,null,a,h,m,null),p.uniforms.shadow_pass.value=i.mapPass.texture,p.uniforms.resolution.value=i.mapSize,p.uniforms.radius.value=i.radius,e.setRenderTarget(i.map),e.clear(),e.renderBufferDirect(n,null,a,p,m,null)}function y(t,i,n,r,a,o){let d=null,h=!0===n.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==h)d=h;else if(d=!0===n.isPointLight?l:s,e.localClippingEnabled&&!0===i.clipShadows&&Array.isArray(i.clippingPlanes)&&0!==i.clippingPlanes.length||i.displacementMap&&0!==i.displacementScale||i.alphaMap&&i.alphaTest>0||i.map&&i.alphaTest>0){let e=d.uuid,t=i.uuid,n=c[e];void 0===n&&(n={},c[e]=n);let r=n[t];void 0===r&&(r=d.clone(),n[t]=r),d=r}return d.visible=i.visible,d.wireframe=i.wireframe,d.side=3===o?null!==i.shadowSide?i.shadowSide:i.side:null!==i.shadowSide?i.shadowSide:u[i.side],d.alphaMap=i.alphaMap,d.alphaTest=i.alphaTest,d.map=i.map,d.clipShadows=i.clipShadows,d.clippingPlanes=i.clippingPlanes,d.clipIntersection=i.clipIntersection,d.displacementMap=i.displacementMap,d.displacementScale=i.displacementScale,d.displacementBias=i.displacementBias,d.wireframeLinewidth=i.wireframeLinewidth,d.linewidth=i.linewidth,!0===n.isPointLight&&!0===d.isMeshDistanceMaterial&&(d.referencePosition.setFromMatrixPosition(n.matrixWorld),d.nearDistance=r,d.farDistance=a),d}function b(i,r,a,o,s){if(!1===i.visible)return;if(i.layers.test(r.layers)&&(i.isMesh||i.isLine||i.isPoints)&&(i.castShadow||i.receiveShadow&&3===s)&&(!i.frustumCulled||n.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,i.matrixWorld);let n=t.update(i),r=i.material;if(Array.isArray(r)){let t=n.groups;for(let l=0,c=t.length;l<c;l++){let c=t[l],d=r[c.materialIndex];if(d&&d.visible){let t=y(i,d,o,a.near,a.far,s);e.renderBufferDirect(a,null,n,t,i,c)}}}else if(r.visible){let t=y(i,r,o,a.near,a.far,s);e.renderBufferDirect(a,null,n,t,i,null)}}let l=i.children;for(let e=0,t=l.length;e<t;e++)b(l[e],r,a,o,s)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,i,s){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===t.length)return;let l=e.getRenderTarget(),c=e.getActiveCubeFace(),u=e.getActiveMipmapLevel(),h=e.state;h.setBlending(0),h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);for(let p=0,f=t.length;p<f;p++){let l=t[p],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;r.copy(c.mapSize);let u=c.getFrameExtents();if(r.multiply(u),a.copy(c.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(a.x=Math.floor(d/u.x),r.x=a.x*u.x,c.mapSize.x=a.x),r.y>d&&(a.y=Math.floor(d/u.y),r.y=a.y*u.y,c.mapSize.y=a.y)),null===c.map){let e=3!==this.type?{minFilter:fS,magFilter:fS}:{};c.map=new N_(r.x,r.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();let f=c.getViewportCount();for(let e=0;e<f;e++){let t=c.getViewport(e);o.set(a.x*t.x,a.y*t.y,a.x*t.z,a.y*t.w),h.viewport(o),c.updateMatrices(l,e),n=c.getFrustum(),b(i,s,c.camera,l,this.type)}!0!==c.isPointLightShadow&&3===this.type&&v(c,s),c.needsUpdate=!1}g.needsUpdate=!1,e.setRenderTarget(l,c,u)}}function yT(e,t,i){let n=i.isWebGL2;let r=new function(){let t=!1,i=new B_,n=null,r=new B_(0,0,0,0);return{setMask:function(i){n!==i&&!t&&(e.colorMask(i,i,i,i),n=i)},setLocked:function(e){t=e},setClear:function(t,n,a,o,s){!0===s&&(t*=o,n*=o,a*=o),i.set(t,n,a,o),!1===r.equals(i)&&(e.clearColor(t,n,a,o),r.copy(i))},reset:function(){t=!1,n=null,r.set(-1,0,0,0)}}},a=new function(){let t=!1,i=null,n=null,r=null;return{setTest:function(e){e?U(2929):V(2929)},setMask:function(n){i!==n&&!t&&(e.depthMask(n),i=n)},setFunc:function(t){if(n!==t){switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:default:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517)}n=t}},setLocked:function(e){t=e},setClear:function(t){r!==t&&(e.clearDepth(t),r=t)},reset:function(){t=!1,i=null,n=null,r=null}}},o=new function(){let t=!1,i=null,n=null,r=null,a=null,o=null,s=null,l=null,c=null;return{setTest:function(e){t||(e?U(2960):V(2960))},setMask:function(n){i!==n&&!t&&(e.stencilMask(n),i=n)},setFunc:function(t,i,o){(n!==t||r!==i||a!==o)&&(e.stencilFunc(t,i,o),n=t,r=i,a=o)},setOp:function(t,i,n){(o!==t||s!==i||l!==n)&&(e.stencilOp(t,i,n),o=t,s=i,l=n)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,i=null,n=null,r=null,a=null,o=null,s=null,l=null,c=null}}},s=new WeakMap,l=new WeakMap,c={},d={},u=new WeakMap,h=[],p=null,f=!1,m=null,g=null,v=null,y=null,b=null,x=null,w=null,S=!1,_=null,C=null,E=null,A=null,M=null,T=e.getParameter(35661),P=!1,D=0,O=e.getParameter(7938);-1!==O.indexOf("WebGL")?(D=parseFloat(/^WebGL (\d)/.exec(O)[1]),P=D>=1):-1!==O.indexOf("OpenGL ES")&&(D=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),P=D>=2);let I=null,k={},R=e.getParameter(3088),z=e.getParameter(2978),L=(new B_).fromArray(R),B=(new B_).fromArray(z);function N(t,i,n){let r=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let o=0;o<n;o++)e.texImage2D(i+o,0,6408,1,1,0,6408,5121,r);return a}let F={};function U(t){!0!==c[t]&&(e.enable(t),c[t]=!0)}function V(t){!1!==c[t]&&(e.disable(t),c[t]=!1)}F[3553]=N(3553,3553,1),F[34067]=N(34067,34069,6),r.setClear(0,0,0,1),a.setClear(1),o.setClear(0),U(2929),a.setFunc(3),G(!1),q(1),U(2884),H(0);let j={[Yw]:32774,[Qw]:32778,[Kw]:32779};if(n)j[103]=32775,j[104]=32776;else{let e=t.get("EXT_blend_minmax");null!==e&&(j[103]=e.MIN_EXT,j[104]=e.MAX_EXT)}let W={[Zw]:0,[Jw]:1,[$w]:768,[tS]:770,[sS]:776,[aS]:774,[nS]:772,[eS]:769,[iS]:771,[oS]:775,[rS]:773};function H(t,i,n,r,a,o,s,l){if(0!==t){if(!1===f&&(U(3042),f=!0),5===t)a=a||i,o=o||n,s=s||r,(i!==g||a!==b)&&(e.blendEquationSeparate(j[i],j[a]),g=i,b=a),(n!==v||r!==y||o!==x||s!==w)&&(e.blendFuncSeparate(W[n],W[r],W[o],W[s]),v=n,y=r,x=o,w=s),m=t,S=!1;else if(t!==m||l!==S){if((g!==Yw||b!==Yw)&&(e.blendEquation(32774),g=Yw,b=Yw),l)switch(t){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,769,0,1);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFuncSeparate(0,769,0,1);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}v=null,y=null,x=null,w=null,m=t,S=l}}else!0===f&&(V(3042),f=!1)}function G(t){_!==t&&(t?e.frontFace(2304):e.frontFace(2305),_=t)}function q(t){0!==t?(U(2884),t!==C&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):V(2884),C=t}function X(t,i,n){t?(U(32823),(A!==i||M!==n)&&(e.polygonOffset(i,n),A=i,M=n)):V(32823)}return{buffers:{color:r,depth:a,stencil:o},enable:U,disable:V,bindFramebuffer:function(t,i){return d[t]!==i&&(e.bindFramebuffer(t,i),d[t]=i,n&&(36009===t&&(d[36160]=i),36160===t&&(d[36009]=i)),!0)},drawBuffers:function(n,r){let a=h,o=!1;if(n)if(a=u.get(r),void 0===a&&(a=[],u.set(r,a)),n.isWebGLMultipleRenderTargets){let e=n.texture;if(a.length!==e.length||36064!==a[0]){for(let t=0,i=e.length;t<i;t++)a[t]=36064+t;a.length=e.length,o=!0}}else 36064!==a[0]&&(a[0]=36064,o=!0);else 1029!==a[0]&&(a[0]=1029,o=!0);o&&(i.isWebGL2?e.drawBuffers(a):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(a))},useProgram:function(t){return p!==t&&(e.useProgram(t),p=t,!0)},setBlending:H,setMaterial:function(e,t){2===e.side?V(2884):U(2884);let i=1===e.side;t&&(i=!i),G(i),1===e.blending&&!1===e.transparent?H(0):H(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),a.setFunc(e.depthFunc),a.setTest(e.depthTest),a.setMask(e.depthWrite),r.setMask(e.colorWrite);let n=e.stencilWrite;o.setTest(n),n&&(o.setMask(e.stencilWriteMask),o.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),o.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),X(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?U(32926):V(32926)},setFlipSided:G,setCullFace:q,setLineWidth:function(t){t!==E&&(P&&e.lineWidth(t),E=t)},setPolygonOffset:X,setScissorTest:function(e){e?U(3089):V(3089)},activeTexture:function(t){void 0===t&&(t=33984+T-1),I!==t&&(e.activeTexture(t),I=t)},bindTexture:function(t,i,n){void 0===n&&(n=null===I?33984+T-1:I);let r=k[n];void 0===r&&(r={type:void 0,texture:void 0},k[n]=r),(r.type!==t||r.texture!==i)&&(I!==n&&(e.activeTexture(n),I=n),e.bindTexture(t,i||F[t]),r.type=t,r.texture=i)},unbindTexture:function(){let t=k[I];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(t,i){let n=l.get(i);void 0===n&&(n=new WeakMap,l.set(i,n));let r=n.get(t);void 0===r&&(r=e.getUniformBlockIndex(i,t.name),n.set(t,r))},uniformBlockBinding:function(t,i){let n=l.get(i).get(t);s.get(i)!==n&&(e.uniformBlockBinding(i,n,t.__bindingPointIndex),s.set(i,n))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===L.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),L.copy(t))},viewport:function(t){!1===B.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),B.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===n&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),c={},I=null,k={},d={},u=new WeakMap,h=[],p=null,f=!1,m=null,g=null,v=null,y=null,b=null,x=null,w=null,S=!1,_=null,C=null,E=null,A=null,M=null,L.set(0,0,e.canvas.width,e.canvas.height),B.set(0,0,e.canvas.width,e.canvas.height),r.reset(),a.reset(),o.reset()}}}function bT(e,t,i,n,r,a,o){let s,l=r.isWebGL2,c=r.maxTextures,d=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,p=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap,g=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(Ene){}function y(e,t){return v?new OffscreenCanvas(e,t):b_("canvas")}function b(e,t,i,n){let r=1;if((e.width>n||e.height>n)&&(r=n/Math.max(e.width,e.height)),r<1||!0===t){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let n=t?c_:Math.floor,a=n(r*e.width),o=n(r*e.height);void 0===s&&(s=y(a,o));let l=i?y(a,o):s;return l.width=a,l.height=o,l.getContext("2d").drawImage(e,0,0,a,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+o+")."),l}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function x(e){return s_(e.width)&&s_(e.height)}function w(e,t){return e.generateMipmaps&&t&&e.minFilter!==fS&&e.minFilter!==vS}function S(t){e.generateMipmap(t)}function _(i,n,r,a){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!1===l)return n;if(null!==i){if(void 0!==e[i])return e[i];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+i+"'")}let s=n;return 6403===n&&(5126===r&&(s=33326),5131===r&&(s=33325),5121===r&&(s=33321)),33319===n&&(5126===r&&(s=33328),5131===r&&(s=33327),5121===r&&(s=33323)),6408===n&&(5126===r&&(s=34836),5131===r&&(s=34842),5121===r&&(s=a===HS&&!1===o?35907:32856),32819===r&&(s=32854),32820===r&&(s=32855)),(33325===s||33326===s||33327===s||33328===s||34842===s||34836===s)&&t.get("EXT_color_buffer_float"),s}function C(e,t,i){return!0===w(e,i)||e.isFramebufferTexture&&e.minFilter!==fS&&e.minFilter!==vS?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function E(e){return e===fS||1004===e||e===gS?9728:9729}function A(e){let t=e.target;t.removeEventListener("dispose",A),function(e){let t=n.get(e);if(void 0===t.__webglInit)return;let i=e.source,r=g.get(i);if(r){let n=r[t.__cacheKey];n.usedTimes--,0===n.usedTimes&&T(e),0===Object.keys(r).length&&g.delete(i)}n.remove(e)}(t),t.isVideoTexture&&m.delete(t)}function M(t){let i=t.target;i.removeEventListener("dispose",M),function(t){let i=t.texture,r=n.get(t),a=n.get(i);if(void 0!==a.__webglTexture&&(e.deleteTexture(a.__webglTexture),o.memory.textures--),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(let n=0;n<6;n++)e.deleteFramebuffer(r.__webglFramebuffer[n]),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[n]);else{if(e.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&e.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer)for(let t=0;t<r.__webglColorRenderbuffer.length;t++)r.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(r.__webglColorRenderbuffer[t]);r.__webglDepthRenderbuffer&&e.deleteRenderbuffer(r.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(let s=0,l=i.length;s<l;s++){let t=n.get(i[s]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),o.memory.textures--),n.remove(i[s])}n.remove(i),n.remove(t)}(i)}function T(t){let i=n.get(t);e.deleteTexture(i.__webglTexture);let r=t.source;delete g.get(r)[i.__cacheKey],o.memory.textures--}let P=0;function D(e,t){let r=n.get(e);if(e.isVideoTexture&&function(e){let t=o.render.frame;m.get(e)!==t&&(m.set(e,t),e.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&r.__version!==e.version){let i=e.image;if(null===i)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==i.complete)return void z(r,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}i.bindTexture(3553,r.__webglTexture,33984+t)}let O={[uS]:10497,[hS]:33071,[pS]:33648},I={[fS]:9728,[mS]:9984,[gS]:9986,[vS]:9729,[yS]:9985,[bS]:9987};function k(i,a,o){if(o?(e.texParameteri(i,10242,O[a.wrapS]),e.texParameteri(i,10243,O[a.wrapT]),(32879===i||35866===i)&&e.texParameteri(i,32882,O[a.wrapR]),e.texParameteri(i,10240,I[a.magFilter]),e.texParameteri(i,10241,I[a.minFilter])):(e.texParameteri(i,10242,33071),e.texParameteri(i,10243,33071),(32879===i||35866===i)&&e.texParameteri(i,32882,33071),(a.wrapS!==hS||a.wrapT!==hS)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(i,10240,E(a.magFilter)),e.texParameteri(i,10241,E(a.minFilter)),a.minFilter!==fS&&a.minFilter!==vS&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){let o=t.get("EXT_texture_filter_anisotropic");if(a.magFilter===fS||a.minFilter!==gS&&a.minFilter!==bS||a.type===SS&&!1===t.has("OES_texture_float_linear")||!1===l&&a.type===_S&&!1===t.has("OES_texture_half_float_linear"))return;(a.anisotropy>1||n.get(a).__currentAnisotropy)&&(e.texParameterf(i,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,r.getMaxAnisotropy())),n.get(a).__currentAnisotropy=a.anisotropy)}}function R(t,i){let n=!1;void 0===t.__webglInit&&(t.__webglInit=!0,i.addEventListener("dispose",A));let r=i.source,a=g.get(r);void 0===a&&(a={},g.set(r,a));let s=function(e){let t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.encoding),t.join()}(i);if(s!==t.__cacheKey){void 0===a[s]&&(a[s]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,n=!0),a[s].usedTimes++;let r=a[t.__cacheKey];void 0!==r&&(a[t.__cacheKey].usedTimes--,0===r.usedTimes&&T(i)),t.__cacheKey=s,t.__webglTexture=a[s].texture}return n}function z(t,r,o){let s=3553;(r.isDataArrayTexture||r.isCompressedArrayTexture)&&(s=35866),r.isData3DTexture&&(s=32879);let c=R(t,r),d=r.source;i.bindTexture(s,t.__webglTexture,33984+o);let h=n.get(d);if(d.version!==h.__version||!0===c){i.activeTexture(33984+o),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);let t=function(e){return!l&&(e.wrapS!==hS||e.wrapT!==hS||e.minFilter!==fS&&e.minFilter!==vS)}(r)&&!1===x(r.image),n=b(r.image,t,!1,u);n=V(r,n);let p=x(n)||l,f=a.convert(r.format,r.encoding),m=a.convert(r.type),g=_(r.internalFormat,f,m,r.encoding,r.isVideoTexture);k(s,r,p);let v,y=r.mipmaps,E=l&&!0!==r.isVideoTexture,A=void 0===h.__version||!0===c,M=C(r,n,p);if(r.isDepthTexture)g=6402,l?g=r.type===SS?36012:r.type===wS?33190:r.type===CS?35056:33189:r.type===SS&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===AS&&6402===g&&1012!==r.type&&r.type!==wS&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=wS,m=a.convert(r.type)),r.format===MS&&6402===g&&(g=34041,r.type!==CS&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=CS,m=a.convert(r.type))),A&&(E?i.texStorage2D(3553,1,g,n.width,n.height):i.texImage2D(3553,0,g,n.width,n.height,0,f,m,null));else if(r.isDataTexture)if(y.length>0&&p){E&&A&&i.texStorage2D(3553,M,g,y[0].width,y[0].height);for(let e=0,t=y.length;e<t;e++)v=y[e],E?i.texSubImage2D(3553,e,0,0,v.width,v.height,f,m,v.data):i.texImage2D(3553,e,g,v.width,v.height,0,f,m,v.data);r.generateMipmaps=!1}else E?(A&&i.texStorage2D(3553,M,g,n.width,n.height),i.texSubImage2D(3553,0,0,0,n.width,n.height,f,m,n.data)):i.texImage2D(3553,0,g,n.width,n.height,0,f,m,n.data);else if(r.isCompressedTexture)if(r.isCompressedArrayTexture){E&&A&&i.texStorage3D(35866,M,g,y[0].width,y[0].height,n.depth);for(let e=0,t=y.length;e<t;e++)v=y[e],r.format!==ES?null!==f?E?i.compressedTexSubImage3D(35866,e,0,0,0,v.width,v.height,n.depth,f,v.data,0,0):i.compressedTexImage3D(35866,e,g,v.width,v.height,n.depth,0,v.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?i.texSubImage3D(35866,e,0,0,0,v.width,v.height,n.depth,f,m,v.data):i.texImage3D(35866,e,g,v.width,v.height,n.depth,0,f,m,v.data)}else{E&&A&&i.texStorage2D(3553,M,g,y[0].width,y[0].height);for(let e=0,t=y.length;e<t;e++)v=y[e],r.format!==ES?null!==f?E?i.compressedTexSubImage2D(3553,e,0,0,v.width,v.height,f,v.data):i.compressedTexImage2D(3553,e,g,v.width,v.height,0,v.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?i.texSubImage2D(3553,e,0,0,v.width,v.height,f,m,v.data):i.texImage2D(3553,e,g,v.width,v.height,0,f,m,v.data)}else if(r.isDataArrayTexture)E?(A&&i.texStorage3D(35866,M,g,n.width,n.height,n.depth),i.texSubImage3D(35866,0,0,0,0,n.width,n.height,n.depth,f,m,n.data)):i.texImage3D(35866,0,g,n.width,n.height,n.depth,0,f,m,n.data);else if(r.isData3DTexture)E?(A&&i.texStorage3D(32879,M,g,n.width,n.height,n.depth),i.texSubImage3D(32879,0,0,0,0,n.width,n.height,n.depth,f,m,n.data)):i.texImage3D(32879,0,g,n.width,n.height,n.depth,0,f,m,n.data);else if(r.isFramebufferTexture){if(A)if(E)i.texStorage2D(3553,M,g,n.width,n.height);else{let e=n.width,t=n.height;for(let n=0;n<M;n++)i.texImage2D(3553,n,g,e,t,0,f,m,null),e>>=1,t>>=1}}else if(y.length>0&&p){E&&A&&i.texStorage2D(3553,M,g,y[0].width,y[0].height);for(let e=0,t=y.length;e<t;e++)v=y[e],E?i.texSubImage2D(3553,e,0,0,f,m,v):i.texImage2D(3553,e,g,f,m,v);r.generateMipmaps=!1}else E?(A&&i.texStorage2D(3553,M,g,n.width,n.height),i.texSubImage2D(3553,0,0,0,f,m,n)):i.texImage2D(3553,0,g,f,m,n);w(r,p)&&S(s),h.__version=d.version,r.onUpdate&&r.onUpdate(r)}t.__version=r.version}function L(t,r,o,s,l){let c=a.convert(o.format,o.encoding),d=a.convert(o.type),u=_(o.internalFormat,c,d,o.encoding);n.get(r).__hasExternalTextures||(32879===l||35866===l?i.texImage3D(l,0,u,r.width,r.height,r.depth,0,c,d,null):i.texImage2D(l,0,u,r.width,r.height,0,c,d,null)),i.bindFramebuffer(36160,t),U(r)?p.framebufferTexture2DMultisampleEXT(36160,s,l,n.get(o).__webglTexture,0,F(r)):(3553===l||l>=34069&&l<=34074)&&e.framebufferTexture2D(36160,s,l,n.get(o).__webglTexture,0),i.bindFramebuffer(36160,null)}function B(t,i,n){if(e.bindRenderbuffer(36161,t),i.depthBuffer&&!i.stencilBuffer){let r=33189;if(n||U(i)){let t=i.depthTexture;t&&t.isDepthTexture&&(t.type===SS?r=36012:t.type===wS&&(r=33190));let n=F(i);U(i)?p.renderbufferStorageMultisampleEXT(36161,n,r,i.width,i.height):e.renderbufferStorageMultisample(36161,n,r,i.width,i.height)}else e.renderbufferStorage(36161,r,i.width,i.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(i.depthBuffer&&i.stencilBuffer){let r=F(i);n&&!1===U(i)?e.renderbufferStorageMultisample(36161,r,35056,i.width,i.height):U(i)?p.renderbufferStorageMultisampleEXT(36161,r,35056,i.width,i.height):e.renderbufferStorage(36161,34041,i.width,i.height),e.framebufferRenderbuffer(36160,33306,36161,t)}else{let t=!0===i.isWebGLMultipleRenderTargets?i.texture:[i.texture];for(let r=0;r<t.length;r++){let o=t[r],s=a.convert(o.format,o.encoding),l=a.convert(o.type),c=_(o.internalFormat,s,l,o.encoding),d=F(i);n&&!1===U(i)?e.renderbufferStorageMultisample(36161,d,c,i.width,i.height):U(i)?p.renderbufferStorageMultisampleEXT(36161,d,c,i.width,i.height):e.renderbufferStorage(36161,c,i.width,i.height)}}e.bindRenderbuffer(36161,null)}function N(t){let r=n.get(t),a=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!r.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(36160,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(r.depthTexture).__webglTexture||r.depthTexture.image.width!==r.width||r.depthTexture.image.height!==r.height)&&(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),D(r.depthTexture,0);let a=n.get(r.depthTexture).__webglTexture,o=F(r);if(r.depthTexture.format===AS)U(r)?p.framebufferTexture2DMultisampleEXT(36160,36096,3553,a,0,o):e.framebufferTexture2D(36160,36096,3553,a,0);else{if(r.depthTexture.format!==MS)throw new Error("Unknown depthTexture format");U(r)?p.framebufferTexture2DMultisampleEXT(36160,33306,3553,a,0,o):e.framebufferTexture2D(36160,33306,3553,a,0)}}(r.__webglFramebuffer,t)}else if(a){r.__webglDepthbuffer=[];for(let n=0;n<6;n++)i.bindFramebuffer(36160,r.__webglFramebuffer[n]),r.__webglDepthbuffer[n]=e.createRenderbuffer(),B(r.__webglDepthbuffer[n],t,!1)}else i.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),B(r.__webglDepthbuffer,t,!1);i.bindFramebuffer(36160,null)}function F(e){return Math.min(h,e.samples)}function U(e){let i=n.get(e);return l&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==i.__useRenderToTexture}function V(e,i){let n=e.encoding,r=e.format,a=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===ZS||n!==WS&&(n===HS?!1===l?!0===t.has("EXT_sRGB")&&r===ES?(e.format=ZS,e.minFilter=vS,e.generateMipmaps=!1):i=I_.sRGBToLinear(i):(r!==ES||a!==xS)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",n)),i}this.allocateTextureUnit=function(){let e=P;return e>=c&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+c),P+=1,e},this.resetTextureUnits=function(){P=0},this.setTexture2D=D,this.setTexture2DArray=function(e,t){let r=n.get(e);e.version>0&&r.__version!==e.version?z(r,e,t):i.bindTexture(35866,r.__webglTexture,33984+t)},this.setTexture3D=function(e,t){let r=n.get(e);e.version>0&&r.__version!==e.version?z(r,e,t):i.bindTexture(32879,r.__webglTexture,33984+t)},this.setTextureCube=function(t,r){let o=n.get(t);t.version>0&&o.__version!==t.version?function(t,r,o){if(6!==r.image.length)return;let s=R(t,r),c=r.source;i.bindTexture(34067,t.__webglTexture,33984+o);let u=n.get(c);if(c.version!==u.__version||!0===s){i.activeTexture(33984+o),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);let t=r.isCompressedTexture||r.image[0].isCompressedTexture,n=r.image[0]&&r.image[0].isDataTexture,h=[];for(let e=0;e<6;e++)h[e]=t||n?n?r.image[e].image:r.image[e]:b(r.image[e],!1,!0,d),h[e]=V(r,h[e]);let p,f=h[0],m=x(f)||l,g=a.convert(r.format,r.encoding),v=a.convert(r.type),y=_(r.internalFormat,g,v,r.encoding),E=l&&!0!==r.isVideoTexture,A=void 0===u.__version||!0===s,M=C(r,f,m);if(k(34067,r,m),t){E&&A&&i.texStorage2D(34067,M,y,f.width,f.height);for(let e=0;e<6;e++){p=h[e].mipmaps;for(let t=0;t<p.length;t++){let n=p[t];r.format!==ES?null!==g?E?i.compressedTexSubImage2D(34069+e,t,0,0,n.width,n.height,g,n.data):i.compressedTexImage2D(34069+e,t,y,n.width,n.height,0,n.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):E?i.texSubImage2D(34069+e,t,0,0,n.width,n.height,g,v,n.data):i.texImage2D(34069+e,t,y,n.width,n.height,0,g,v,n.data)}}}else{p=r.mipmaps,E&&A&&(p.length>0&&M++,i.texStorage2D(34067,M,y,h[0].width,h[0].height));for(let e=0;e<6;e++)if(n){E?i.texSubImage2D(34069+e,0,0,0,h[e].width,h[e].height,g,v,h[e].data):i.texImage2D(34069+e,0,y,h[e].width,h[e].height,0,g,v,h[e].data);for(let t=0;t<p.length;t++){let n=p[t].image[e].image;E?i.texSubImage2D(34069+e,t+1,0,0,n.width,n.height,g,v,n.data):i.texImage2D(34069+e,t+1,y,n.width,n.height,0,g,v,n.data)}}else{E?i.texSubImage2D(34069+e,0,0,0,g,v,h[e]):i.texImage2D(34069+e,0,y,g,v,h[e]);for(let t=0;t<p.length;t++){let n=p[t];E?i.texSubImage2D(34069+e,t+1,0,0,g,v,n.image[e]):i.texImage2D(34069+e,t+1,y,g,v,n.image[e])}}}w(r,m)&&S(34067),u.__version=c.version,r.onUpdate&&r.onUpdate(r)}t.__version=r.version}(o,t,r):i.bindTexture(34067,o.__webglTexture,33984+r)},this.rebindTextures=function(e,t,i){let r=n.get(e);void 0!==t&&L(r.__webglFramebuffer,e,e.texture,36064,3553),void 0!==i&&N(e)},this.setupRenderTarget=function(t){let s=t.texture,c=n.get(t),d=n.get(s);t.addEventListener("dispose",M),!0!==t.isWebGLMultipleRenderTargets&&(void 0===d.__webglTexture&&(d.__webglTexture=e.createTexture()),d.__version=s.version,o.memory.textures++);let u=!0===t.isWebGLCubeRenderTarget,h=!0===t.isWebGLMultipleRenderTargets,p=x(t)||l;if(u){c.__webglFramebuffer=[];for(let t=0;t<6;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else{if(c.__webglFramebuffer=e.createFramebuffer(),h)if(r.drawBuffers){let i=t.texture;for(let t=0,r=i.length;t<r;t++){let r=n.get(i[t]);void 0===r.__webglTexture&&(r.__webglTexture=e.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(l&&t.samples>0&&!1===U(t)){let n=h?s:[s];c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=[],i.bindFramebuffer(36160,c.__webglMultisampledFramebuffer);for(let i=0;i<n.length;i++){let r=n[i];c.__webglColorRenderbuffer[i]=e.createRenderbuffer(),e.bindRenderbuffer(36161,c.__webglColorRenderbuffer[i]);let o=a.convert(r.format,r.encoding),s=a.convert(r.type),l=_(r.internalFormat,o,s,r.encoding,!0===t.isXRRenderTarget),d=F(t);e.renderbufferStorageMultisample(36161,d,l,t.width,t.height),e.framebufferRenderbuffer(36160,36064+i,36161,c.__webglColorRenderbuffer[i])}e.bindRenderbuffer(36161,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),B(c.__webglDepthRenderbuffer,t,!0)),i.bindFramebuffer(36160,null)}}if(u){i.bindTexture(34067,d.__webglTexture),k(34067,s,p);for(let e=0;e<6;e++)L(c.__webglFramebuffer[e],t,s,36064,34069+e);w(s,p)&&S(34067),i.unbindTexture()}else if(h){let e=t.texture;for(let r=0,a=e.length;r<a;r++){let a=e[r],o=n.get(a);i.bindTexture(3553,o.__webglTexture),k(3553,a,p),L(c.__webglFramebuffer,t,a,36064+r,3553),w(a,p)&&S(3553)}i.unbindTexture()}else{let e=3553;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l?e=t.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(e,d.__webglTexture),k(e,s,p),L(c.__webglFramebuffer,t,s,36064,e),w(s,p)&&S(e),i.unbindTexture()}t.depthBuffer&&N(t)},this.updateRenderTargetMipmap=function(e){let t=x(e)||l,r=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let a=0,o=r.length;a<o;a++){let o=r[a];if(w(o,t)){let t=e.isWebGLCubeRenderTarget?34067:3553,r=n.get(o).__webglTexture;i.bindTexture(t,r),S(t),i.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(l&&t.samples>0&&!1===U(t)){let r=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],a=t.width,o=t.height,s=16384,l=[],c=t.stencilBuffer?33306:36096,d=n.get(t),u=!0===t.isWebGLMultipleRenderTargets;if(u)for(let t=0;t<r.length;t++)i.bindFramebuffer(36160,d.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,null),i.bindFramebuffer(36160,d.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,null,0);i.bindFramebuffer(36008,d.__webglMultisampledFramebuffer),i.bindFramebuffer(36009,d.__webglFramebuffer);for(let i=0;i<r.length;i++){l.push(36064+i),t.depthBuffer&&l.push(c);let h=void 0!==d.__ignoreDepthValues&&d.__ignoreDepthValues;if(!1===h&&(t.depthBuffer&&(s|=256),t.stencilBuffer&&(s|=1024)),u&&e.framebufferRenderbuffer(36008,36064,36161,d.__webglColorRenderbuffer[i]),!0===h&&(e.invalidateFramebuffer(36008,[c]),e.invalidateFramebuffer(36009,[c])),u){let t=n.get(r[i]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,t,0)}e.blitFramebuffer(0,0,a,o,0,0,a,o,s,9728),f&&e.invalidateFramebuffer(36008,l)}if(i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,null),u)for(let t=0;t<r.length;t++){i.bindFramebuffer(36160,d.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,d.__webglColorRenderbuffer[t]);let a=n.get(r[t]).__webglTexture;i.bindFramebuffer(36160,d.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,a,0)}i.bindFramebuffer(36009,d.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=N,this.setupFrameBufferTexture=L,this.useMultisampledRTT=U}function xT(e,t,i){let n=i.isWebGL2;return{convert:function(i){let r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(i===xS)return 5121;if(1017===i)return 32819;if(1018===i)return 32820;if(1010===i)return 5120;if(1011===i)return 5122;if(1012===i)return 5123;if(1013===i)return 5124;if(i===wS)return 5125;if(i===SS)return 5126;if(i===_S)return n?5131:(r=t.get("OES_texture_half_float"),null!==r?r.HALF_FLOAT_OES:null);if(1021===i)return 6406;if(i===ES)return 6408;if(1024===i)return 6409;if(1025===i)return 6410;if(i===AS)return 6402;if(i===MS)return 34041;if(i===ZS)return r=t.get("EXT_sRGB"),null!==r?r.SRGB_ALPHA_EXT:null;if(i===TS)return 6403;if(1029===i)return 36244;if(i===PS)return 33319;if(1031===i)return 33320;if(1033===i)return 36249;if(i===DS||i===OS||i===IS||i===kS)if(a===HS){if(r=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===r)return null;if(i===DS)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===OS)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===IS)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===kS)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(r=t.get("WEBGL_compressed_texture_s3tc"),null===r)return null;if(i===DS)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===OS)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===IS)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===kS)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===i||35841===i||35842===i||35843===i){if(r=t.get("WEBGL_compressed_texture_pvrtc"),null===r)return null;if(35840===i)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===i)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===i)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===i)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===i)return r=t.get("WEBGL_compressed_texture_etc1"),null!==r?r.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===i||37496===i){if(r=t.get("WEBGL_compressed_texture_etc"),null===r)return null;if(37492===i)return a===HS?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(37496===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}if(37808===i||37809===i||37810===i||37811===i||37812===i||37813===i||37814===i||37815===i||37816===i||37817===i||37818===i||37819===i||37820===i||37821===i){if(r=t.get("WEBGL_compressed_texture_astc"),null===r)return null;if(37808===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===i)return a===HS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(i===RS){if(r=t.get("EXT_texture_compression_bptc"),null===r)return null;if(i===RS)return a===HS?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===i||36284===i||36285===i||36286===i){if(r=t.get("EXT_texture_compression_rgtc"),null===r)return null;if(i===RS)return r.COMPRESSED_RED_RGTC1_EXT;if(36284===i)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===i)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===i)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return i===CS?n?34042:(r=t.get("WEBGL_depth_texture"),null!==r?r.UNSIGNED_INT_24_8_WEBGL:null):void 0!==e[i]?e[i]:null}}}var wT=class extends UE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.cameras=e}},ST=class extends WC{constructor(){super(),this.isGroup=!0,this.type="Group"}},_T={type:"move"},CT=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new ST,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new ST,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new j_,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new j_),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new ST,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new j_,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new j_),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let n=null,r=null,a=null,o=this._targetRay,s=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){a=!0;for(let a of e.hand.values()){let e=t.getJointPose(a,i),n=this._getHandJoint(l,a);null!==e&&(n.matrix.fromArray(e.transform.matrix),n.matrix.decompose(n.position,n.rotation,n.scale),n.jointRadius=e.radius),n.visible=null!==e}let n=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],o=n.position.distanceTo(r.position),s=.02,c=.005;l.inputState.pinching&&o>s+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=s-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==s&&e.gripSpace&&(r=t.getPose(e.gripSpace,i),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1));null!==o&&(n=t.getPose(e.targetRaySpace,i),null===n&&null!==r&&(n=r),null!==n&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(_T)))}return null!==o&&(o.visible=null!==n),null!==s&&(s.visible=null!==r),null!==l&&(l.visible=null!==a),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){let i=new ST;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}},ET=class extends L_{constructor(e,t,i,n,r,a,o,s,l,c){if((c=void 0!==c?c:AS)!==AS&&c!==MS)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&c===AS&&(i=wS),void 0===i&&c===MS&&(i=CS),super(null,n,r,a,o,s,c,i,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==o?o:fS,this.minFilter=void 0!==s?s:fS,this.flipY=!1,this.generateMipmaps=!1}},AT=class extends JS{constructor(e,t){super();let i=this,n=null,r=1,a=null,o="local-floor",s=1,l=null,c=null,d=null,u=null,h=null,p=null,f=t.getContextAttributes(),m=null,g=null,v=[],y=[],b=new Set,x=new Map,w=new UE;w.layers.enable(1),w.viewport=new B_;let S=new UE;S.layers.enable(2),S.viewport=new B_;let _=[w,S],C=new wT;C.layers.enable(1),C.layers.enable(2);let E=null,A=null;function M(e){let t=y.indexOf(e.inputSource);if(-1===t)return;let i=v[t];void 0!==i&&i.dispatchEvent({type:e.type,data:e.inputSource})}function T(){n.removeEventListener("select",M),n.removeEventListener("selectstart",M),n.removeEventListener("selectend",M),n.removeEventListener("squeeze",M),n.removeEventListener("squeezestart",M),n.removeEventListener("squeezeend",M),n.removeEventListener("end",T),n.removeEventListener("inputsourceschange",P);for(let e=0;e<v.length;e++){let t=y[e];null!==t&&(y[e]=null,v[e].disconnect(t))}E=null,A=null,e.setRenderTarget(m),h=null,u=null,d=null,n=null,g=null,R.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function P(e){for(let t=0;t<e.removed.length;t++){let i=e.removed[t],n=y.indexOf(i);n>=0&&(y[n]=null,v[n].disconnect(i))}for(let t=0;t<e.added.length;t++){let i=e.added[t],n=y.indexOf(i);if(-1===n){for(let e=0;e<v.length;e++){if(e>=y.length){y.push(i),n=e;break}if(null===y[e]){y[e]=i,n=e;break}}if(-1===n)break}let r=v[n];r&&r.connect(i)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=v[e];return void 0===t&&(t=new CT,v[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=v[e];return void 0===t&&(t=new CT,v[e]=t),t.getGripSpace()},this.getHand=function(e){let t=v[e];return void 0===t&&(t=new CT,v[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){r=e,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==u?u:h},this.getBinding=function(){return d},this.getFrame=function(){return p},this.getSession=function(){return n},this.setSession=async function(c){if(n=c,null!==n){if(m=e.getRenderTarget(),n.addEventListener("select",M),n.addEventListener("selectstart",M),n.addEventListener("selectend",M),n.addEventListener("squeeze",M),n.addEventListener("squeezestart",M),n.addEventListener("squeezeend",M),n.addEventListener("end",T),n.addEventListener("inputsourceschange",P),!0!==f.xrCompatible&&await t.makeXRCompatible(),void 0===n.renderState.layers||!1===e.capabilities.isWebGL2){let i={antialias:void 0!==n.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:r};h=new XRWebGLLayer(n,t,i),n.updateRenderState({baseLayer:h}),g=new N_(h.framebufferWidth,h.framebufferHeight,{format:ES,type:xS,encoding:e.outputEncoding,stencilBuffer:f.stencil})}else{let i=null,a=null,o=null;f.depth&&(o=f.stencil?35056:33190,i=f.stencil?MS:AS,a=f.stencil?CS:wS);let s={colorFormat:32856,depthFormat:o,scaleFactor:r};d=new XRWebGLBinding(n,t),u=d.createProjectionLayer(s),n.updateRenderState({layers:[u]}),g=new N_(u.textureWidth,u.textureHeight,{format:ES,type:xS,depthTexture:new ET(u.textureWidth,u.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,i),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0}),e.properties.get(g).__ignoreDepthValues=u.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(s),l=null,a=await n.requestReferenceSpace(o),R.setContext(n),R.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};let D=new j_,O=new j_;function I(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===n)return;C.near=S.near=w.near=e.near,C.far=S.far=w.far=e.far,(E!==C.near||A!==C.far)&&(n.updateRenderState({depthNear:C.near,depthFar:C.far}),E=C.near,A=C.far);let t=e.parent,i=C.cameras;I(C,t);for(let n=0;n<i.length;n++)I(i[n],t);C.matrixWorld.decompose(C.position,C.quaternion,C.scale),e.matrix.copy(C.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);let r=e.children;for(let n=0,a=r.length;n<a;n++)r[n].updateMatrixWorld(!0);2===i.length?function(e,t,i){D.setFromMatrixPosition(t.matrixWorld),O.setFromMatrixPosition(i.matrixWorld);let n=D.distanceTo(O),r=t.projectionMatrix.elements,a=i.projectionMatrix.elements,o=r[14]/(r[10]-1),s=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],d=(r[8]-1)/r[0],u=(a[8]+1)/a[0],h=o*d,p=o*u,f=n/(-d+u),m=f*-d;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();let g=o+f,v=s+f,y=h-m,b=p+(n-m),x=l*s/v*g,w=c*s/v*g;e.projectionMatrix.makePerspective(y,b,x,w,g,v)}(C,w,S):C.projectionMatrix.copy(w.projectionMatrix)},this.getCamera=function(){return C},this.getFoveation=function(){if(null!==u||null!==h)return s},this.setFoveation=function(e){s=e,null!==u&&(u.fixedFoveation=e),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=e)},this.getPlanes=function(){return b};let k=null;let R=new JE;R.setAnimationLoop(function(t,n){if(c=n.getViewerPose(l||a),p=n,null!==c){let t=c.views;null!==h&&(e.setRenderTargetFramebuffer(g,h.framebuffer),e.setRenderTarget(g));let i=!1;t.length!==C.cameras.length&&(C.cameras.length=0,i=!0);for(let n=0;n<t.length;n++){let r=t[n],a=null;if(null!==h)a=h.getViewport(r);else{let t=d.getViewSubImage(u,r);a=t.viewport,0===n&&(e.setRenderTargetTextures(g,t.colorTexture,u.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(g))}let o=_[n];void 0===o&&(o=new UE,o.layers.enable(n),o.viewport=new B_,_[n]=o),o.matrix.fromArray(r.transform.matrix),o.projectionMatrix.fromArray(r.projectionMatrix),o.viewport.set(a.x,a.y,a.width,a.height),0===n&&C.matrix.copy(o.matrix),!0===i&&C.cameras.push(o)}}for(let e=0;e<v.length;e++){let t=y[e],i=v[e];null!==t&&void 0!==i&&i.update(t,n,l||a)}if(k&&k(t,n),n.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:n.detectedPlanes});let e=null;for(let t of b)n.detectedPlanes.has(t)||(null===e&&(e=[]),e.push(t));if(null!==e)for(let t of e)b.delete(t),x.delete(t),i.dispatchEvent({type:"planeremoved",data:t});for(let t of n.detectedPlanes)if(b.has(t)){let e=x.get(t);t.lastChangedTime>e&&(x.set(t,t.lastChangedTime),i.dispatchEvent({type:"planechanged",data:t}))}else b.add(t),x.set(t,n.lastChangedTime),i.dispatchEvent({type:"planeadded",data:t})}p=null}),this.setAnimationLoop=function(e){k=e},this.dispose=function(){}}};function MT(e,t){function i(i,n){i.opacity.value=n.opacity,n.color&&i.diffuse.value.copy(n.color),n.emissive&&i.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(i.map.value=n.map),n.alphaMap&&(i.alphaMap.value=n.alphaMap),n.bumpMap&&(i.bumpMap.value=n.bumpMap,i.bumpScale.value=n.bumpScale,1===n.side&&(i.bumpScale.value*=-1)),n.displacementMap&&(i.displacementMap.value=n.displacementMap,i.displacementScale.value=n.displacementScale,i.displacementBias.value=n.displacementBias),n.emissiveMap&&(i.emissiveMap.value=n.emissiveMap),n.normalMap&&(i.normalMap.value=n.normalMap,i.normalScale.value.copy(n.normalScale),1===n.side&&i.normalScale.value.negate()),n.specularMap&&(i.specularMap.value=n.specularMap),n.alphaTest>0&&(i.alphaTest.value=n.alphaTest);let r,a,o=t.get(n).envMap;if(o&&(i.envMap.value=o,i.flipEnvMap.value=o.isCubeTexture&&!1===o.isRenderTargetTexture?-1:1,i.reflectivity.value=n.reflectivity,i.ior.value=n.ior,i.refractionRatio.value=n.refractionRatio),n.lightMap){i.lightMap.value=n.lightMap;let t=!0!==e.physicallyCorrectLights?Math.PI:1;i.lightMapIntensity.value=n.lightMapIntensity*t}n.aoMap&&(i.aoMap.value=n.aoMap,i.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap?r=n.clearcoatRoughnessMap:n.iridescenceMap?r=n.iridescenceMap:n.iridescenceThicknessMap?r=n.iridescenceThicknessMap:n.specularIntensityMap?r=n.specularIntensityMap:n.specularColorMap?r=n.specularColorMap:n.transmissionMap?r=n.transmissionMap:n.thicknessMap?r=n.thicknessMap:n.sheenColorMap?r=n.sheenColorMap:n.sheenRoughnessMap&&(r=n.sheenRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),i.uvTransform.value.copy(r.matrix)),n.aoMap?a=n.aoMap:n.lightMap&&(a=n.lightMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),i.uv2Transform.value.copy(a.matrix))}return{refreshFogUniforms:function(t,i){i.color.getRGB(t.fogColor.value,LE(e)),i.isFog?(t.fogNear.value=i.near,t.fogFar.value=i.far):i.isFogExp2&&(t.fogDensity.value=i.density)},refreshMaterialUniforms:function(e,n,r,a,o){n.isMeshBasicMaterial||n.isMeshLambertMaterial?i(e,n):n.isMeshToonMaterial?(i(e,n),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,n)):n.isMeshPhongMaterial?(i(e,n),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,n)):n.isMeshStandardMaterial?(i(e,n),function(e,i){e.roughness.value=i.roughness,e.metalness.value=i.metalness,i.roughnessMap&&(e.roughnessMap.value=i.roughnessMap),i.metalnessMap&&(e.metalnessMap.value=i.metalnessMap),t.get(i).envMap&&(e.envMapIntensity.value=i.envMapIntensity)}(e,n),n.isMeshPhysicalMaterial&&function(e,t,i){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap)),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate())),t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap)),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=i.texture,e.transmissionSamplerSize.value.set(i.width,i.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap)}(e,n,o)):n.isMeshMatcapMaterial?(i(e,n),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,n)):n.isMeshDepthMaterial?i(e,n):n.isMeshDistanceMaterial?(i(e,n),function(e,t){e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,n)):n.isMeshNormalMaterial?i(e,n):n.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,n)):n.isPointsMaterial?function(e,t,i,n){let r;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*i,e.scale.value=.5*n,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?r=t.map:t.alphaMap&&(r=t.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}(e,n,r,a):n.isSpriteMaterial?function(e,t){let i;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?i=t.map:t.alphaMap&&(i=t.alphaMap),void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,n):n.isShadowMaterial?(e.color.value.copy(n.color),e.opacity.value=n.opacity):n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)}}}function TT(e,t,i,n){let r={},a={},o=[],s=i.isWebGL2?e.getParameter(35375):0;function l(e,t,i){let n=e.value;if(void 0===i[t]){if("number"==typeof n)i[t]=n;else{let e=Array.isArray(n)?n:[n],r=[];for(let t=0;t<e.length;t++)r.push(e[t].clone());i[t]=r}return!0}if("number"==typeof n){if(i[t]!==n)return i[t]=n,!0}else{let e=Array.isArray(i[t])?i[t]:[i[t]],r=Array.isArray(n)?n:[n];for(let t=0;t<e.length;t++){let i=e[t];if(!1===i.equals(r[t]))return i.copy(r[t]),!0}}return!1}function c(e){let t={boundary:0,storage:0};return"number"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function d(t){let i=t.target;i.removeEventListener("dispose",d);let n=o.indexOf(i.__bindingPointIndex);o.splice(n,1),e.deleteBuffer(r[i.id]),delete r[i.id],delete a[i.id]}return{bind:function(e,t){let i=t.program;n.uniformBlockBinding(e,i)},update:function(i,u){let h=r[i.id];void 0===h&&(function(e){let t=e.uniforms,i=0,n=16,r=0;for(let a=0,o=t.length;a<o;a++){let e=t[a],o={boundary:0,storage:0},s=Array.isArray(e.value)?e.value:[e.value];for(let t=0,i=s.length;t<i;t++){let e=c(s[t]);o.boundary+=e.boundary,o.storage+=e.storage}if(e.__data=new Float32Array(o.storage/Float32Array.BYTES_PER_ELEMENT),e.__offset=i,a>0){r=i%n,0!==r&&n-r-o.boundary<0&&(i+=n-r,e.__offset=i)}i+=o.storage}r=i%n,r>0&&(i+=n-r),e.__size=i,e.__cache={}}(i),h=function(t){let i=function(){for(let e=0;e<s;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=i;let n=e.createBuffer(),r=t.__size,a=t.usage;return e.bindBuffer(35345,n),e.bufferData(35345,r,a),e.bindBuffer(35345,null),e.bindBufferBase(35345,i,n),n}(i),r[i.id]=h,i.addEventListener("dispose",d));let p=u.program;n.updateUBOMapping(i,p);let f=t.render.frame;a[i.id]!==f&&(function(t){let i=r[t.id],n=t.uniforms,a=t.__cache;e.bindBuffer(35345,i);for(let r=0,o=n.length;r<o;r++){let t=n[r];if(!0===l(t,r,a)){let i=t.__offset,n=Array.isArray(t.value)?t.value:[t.value],r=0;for(let a=0;a<n.length;a++){let o=n[a],s=c(o);"number"==typeof o?(t.__data[0]=o,e.bufferSubData(35345,i+r,t.__data)):o.isMatrix3?(t.__data[0]=o.elements[0],t.__data[1]=o.elements[1],t.__data[2]=o.elements[2],t.__data[3]=o.elements[0],t.__data[4]=o.elements[3],t.__data[5]=o.elements[4],t.__data[6]=o.elements[5],t.__data[7]=o.elements[0],t.__data[8]=o.elements[6],t.__data[9]=o.elements[7],t.__data[10]=o.elements[8],t.__data[11]=o.elements[0]):(o.toArray(t.__data,r),r+=s.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,i,t.__data)}}e.bindBuffer(35345,null)}(i),a[i.id]=f)},dispose:function(){for(let t in r)e.deleteBuffer(r[t]);o=[],r={},a={}}}}function PT(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isWebGLRenderer=!0;let t,i=void 0!==e.canvas?e.canvas:function(){let e=b_("canvas");return e.style.display="block",e}(),n=void 0!==e.context?e.context:null,r=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",d=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;t=null!==n?n.getContextAttributes().alpha:void 0!==e.alpha&&e.alpha;let u=null,h=null,p=[],f=[];this.domElement=i,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=WS,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;let m=this,g=!1,v=0,y=0,b=null,x=-1,w=null,S=new B_,_=new B_,C=null,E=i.width,A=i.height,M=1,T=null,P=null,D=new B_(0,0,E,A),O=new B_(0,0,E,A),I=!1,k=new ZE,R=!1,z=!1,L=null,B=new yC,N=new p_,F=new j_,U={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function V(){return null===b?M:1}let j,W,H,G,q,X,Y,Q,K,Z,J,$,ee,te,ie,ne,re,ae,oe,se,le,ce,de,ue,he=n;function pe(e,t){for(let n=0;n<e.length;n++){let r=e[n],a=i.getContext(r,t);if(null!==a)return a}return null}try{let e={alpha:!0,depth:r,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:d};if("setAttribute"in i&&i.setAttribute("data-engine","three.js r".concat(Uw)),i.addEventListener("webglcontextlost",ge,!1),i.addEventListener("webglcontextrestored",ve,!1),i.addEventListener("webglcontextcreationerror",ye,!1),null===he){let t=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&t.shift(),he=pe(t,e),null===he)throw pe(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===he.getShaderPrecisionFormat&&(he.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(De){throw console.error("THREE.WebGLRenderer: "+De.message),De}function fe(){j=new AA(he),W=new lA(he,j,e),j.init(W),ce=new xT(he,j,W),H=new yT(he,j,W),G=new PA,q=new rT,X=new bT(he,j,H,q,W,ce,G),Y=new dA(m),Q=new EA(m),K=new $E(he,W),de=new oA(he,j,K,W),Z=new MA(he,K,G,de),J=new kA(he,Z,K,G),oe=new IA(he,W,X),ne=new cA(q),$=new nT(m,Y,Q,j,W,de,ne),ee=new MT(m,q),te=new lT,ie=new fT(j,W),ae=new aA(m,Y,Q,H,J,t,s),re=new vT(m,J,W),ue=new TT(he,G,W,H),se=new sA(he,j,G,W),le=new TA(he,j,G,W),G.programs=$.programs,m.capabilities=W,m.extensions=j,m.properties=q,m.renderLists=te,m.shadowMap=re,m.state=H,m.info=G}fe();let me=new AT(m,he);function ge(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function ve(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;let e=G.autoReset,t=re.enabled,i=re.autoUpdate,n=re.needsUpdate,r=re.type;fe(),G.autoReset=e,re.enabled=t,re.autoUpdate=i,re.needsUpdate=n,re.type=r}function ye(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function be(e){let t=e.target;t.removeEventListener("dispose",be),function(e){(function(e){let t=q.get(e).programs;void 0!==t&&(t.forEach(function(e){$.releaseProgram(e)}),e.isShaderMaterial&&$.releaseShaderCache(e))})(e),q.remove(e)}(t)}this.xr=me,this.getContext=function(){return he},this.getContextAttributes=function(){return he.getContextAttributes()},this.forceContextLoss=function(){let e=j.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){let e=j.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return M},this.setPixelRatio=function(e){void 0!==e&&(M=e,this.setSize(E,A,!1))},this.getSize=function(e){return e.set(E,A)},this.setSize=function(e,t,n){me.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(E=e,A=t,i.width=Math.floor(e*M),i.height=Math.floor(t*M),!1!==n&&(i.style.width=e+"px",i.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(e){return e.set(E*M,A*M).floor()},this.setDrawingBufferSize=function(e,t,n){E=e,A=t,M=n,i.width=Math.floor(e*n),i.height=Math.floor(t*n),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return e.copy(S)},this.getViewport=function(e){return e.copy(D)},this.setViewport=function(e,t,i,n){e.isVector4?D.set(e.x,e.y,e.z,e.w):D.set(e,t,i,n),H.viewport(S.copy(D).multiplyScalar(M).floor())},this.getScissor=function(e){return e.copy(O)},this.setScissor=function(e,t,i,n){e.isVector4?O.set(e.x,e.y,e.z,e.w):O.set(e,t,i,n),H.scissor(_.copy(O).multiplyScalar(M).floor())},this.getScissorTest=function(){return I},this.setScissorTest=function(e){H.setScissorTest(I=e)},this.setOpaqueSort=function(e){T=e},this.setTransparentSort=function(e){P=e},this.getClearColor=function(e){return e.copy(ae.getClearColor())},this.setClearColor=function(){ae.setClearColor.apply(ae,arguments)},this.getClearAlpha=function(){return ae.getClearAlpha()},this.setClearAlpha=function(){ae.setClearAlpha.apply(ae,arguments)},this.clear=function(){let e=0;(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(e|=16384),(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(e|=256),(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&(e|=1024),he.clear(e)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",ge,!1),i.removeEventListener("webglcontextrestored",ve,!1),i.removeEventListener("webglcontextcreationerror",ye,!1),te.dispose(),ie.dispose(),q.dispose(),Y.dispose(),Q.dispose(),J.dispose(),de.dispose(),ue.dispose(),$.dispose(),me.dispose(),me.removeEventListener("sessionstart",we),me.removeEventListener("sessionend",Se),L&&(L.dispose(),L=null),_e.stop()},this.renderBufferDirect=function(e,t,i,n,r,a){null===t&&(t=U);let o=r.isMesh&&r.matrixWorld.determinant()<0,s=function(e,t,i,n,r){!0!==t.isScene&&(t=U),X.resetTextureUnits();let a=t.fog,o=n.isMeshStandardMaterial?t.environment:null,s=null===b?m.outputEncoding:!0===b.isXRRenderTarget?b.texture.encoding:WS,l=(n.isMeshStandardMaterial?Q:Y).get(n.envMap||o),c=!0===n.vertexColors&&!!i.attributes.color&&4===i.attributes.color.itemSize,d=!!n.normalMap&&!!i.attributes.tangent,u=!!i.morphAttributes.position,p=!!i.morphAttributes.normal,f=!!i.morphAttributes.color,g=n.toneMapped?m.toneMapping:0,v=i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color,y=void 0!==v?v.length:0,S=q.get(n),_=h.state.lights;if(!0===R&&(!0===z||e!==w)){let t=e===w&&n.id===x;ne.setState(n,e,t)}let C=!1;n.version===S.__version?(S.needsLights&&S.lightsStateVersion!==_.state.version||S.outputEncoding!==s||r.isInstancedMesh&&!1===S.instancing||!r.isInstancedMesh&&!0===S.instancing||r.isSkinnedMesh&&!1===S.skinning||!r.isSkinnedMesh&&!0===S.skinning||S.envMap!==l||!0===n.fog&&S.fog!==a||void 0!==S.numClippingPlanes&&(S.numClippingPlanes!==ne.numPlanes||S.numIntersection!==ne.numIntersection)||S.vertexAlphas!==c||S.vertexTangents!==d||S.morphTargets!==u||S.morphNormals!==p||S.morphColors!==f||S.toneMapping!==g||!0===W.isWebGL2&&S.morphTargetsCount!==y)&&(C=!0):(C=!0,S.__version=n.version);let E=S.currentProgram;!0===C&&(E=Te(n,t,r));let T=!1,P=!1,D=!1,O=E.getUniforms(),I=S.uniforms;if(H.useProgram(E.program)&&(T=!0,P=!0,D=!0),n.id!==x&&(x=n.id,P=!0),T||w!==e){if(O.setValue(he,"projectionMatrix",e.projectionMatrix),W.logarithmicDepthBuffer&&O.setValue(he,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),w!==e&&(w=e,P=!0,D=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){let t=O.map.cameraPosition;void 0!==t&&t.setValue(he,F.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&O.setValue(he,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||r.isSkinnedMesh)&&O.setValue(he,"viewMatrix",e.matrixWorldInverse)}if(r.isSkinnedMesh){O.setOptional(he,r,"bindMatrix"),O.setOptional(he,r,"bindMatrixInverse");let e=r.skeleton;e&&(W.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),O.setValue(he,"boneTexture",e.boneTexture,X),O.setValue(he,"boneTextureSize",e.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let k=i.morphAttributes;if((void 0!==k.position||void 0!==k.normal||void 0!==k.color&&!0===W.isWebGL2)&&oe.update(r,i,n,E),(P||S.receiveShadow!==r.receiveShadow)&&(S.receiveShadow=r.receiveShadow,O.setValue(he,"receiveShadow",r.receiveShadow)),n.isMeshGouraudMaterial&&null!==n.envMap&&(I.envMap.value=l,I.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1),P&&(O.setValue(he,"toneMappingExposure",m.toneMappingExposure),S.needsLights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(I,D),a&&!0===n.fog&&ee.refreshFogUniforms(I,a),ee.refreshMaterialUniforms(I,n,M,A,L),BM.upload(he,S.uniformsList,I,X)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(BM.upload(he,S.uniformsList,I,X),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&O.setValue(he,"center",r.center),O.setValue(he,"modelViewMatrix",r.modelViewMatrix),O.setValue(he,"normalMatrix",r.normalMatrix),O.setValue(he,"modelMatrix",r.matrixWorld),r.previousModelViewMatrix&&O.setValue(he,"previousModelViewMatrix",r.previousModelViewMatrix),e.previousProjectionMatrix&&O.setValue(he,"previousProjectionMatrix",e.previousProjectionMatrix),n.isShaderMaterial||n.isRawShaderMaterial){let e=n.uniformsGroups;for(let t=0,i=e.length;t<i;t++)if(W.isWebGL2){let i=e[t];ue.update(i,E),ue.bind(i,E)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return E}(e,t,i,n,r);H.setMaterial(n,o);let l=i.index,c=1;!0===n.wireframe&&(l=Z.getWireframeAttribute(i),c=2);let d=i.drawRange,u=i.attributes.position,p=d.start*c,f=(d.start+d.count)*c;null!==a&&(p=Math.max(p,a.start*c),f=Math.min(f,(a.start+a.count)*c)),null!==l?(p=Math.max(p,0),f=Math.min(f,l.count)):null!=u&&(p=Math.max(p,0),f=Math.min(f,u.count));let g=f-p;if(g<0||g===1/0)return;de.setup(r,n,s,i,l);let v,y=se;if(null!==l&&(v=K.get(l),y=le,y.setIndex(v)),r.isMesh)!0===n.wireframe?(H.setLineWidth(n.wireframeLinewidth*V()),y.setMode(1)):y.setMode(4);else if(r.isLine){let e=n.linewidth;void 0===e&&(e=1),H.setLineWidth(e*V()),r.isLineSegments?y.setMode(1):r.isLineLoop?y.setMode(2):y.setMode(3)}else r.isPoints?y.setMode(0):r.isSprite&&y.setMode(4);if(r.isInstancedMesh)y.renderInstances(p,g,r.count);else if(i.isInstancedBufferGeometry){let e=void 0!==i._maxInstanceCount?i._maxInstanceCount:1/0,t=Math.min(i.instanceCount,e);y.renderInstances(p,g,t)}else y.render(p,g)},this.compile=function(e,t){function i(e,t,i){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=1,e.needsUpdate=!0,Te(e,t,i),e.side=0,e.needsUpdate=!0,Te(e,t,i),e.side=2):Te(e,t,i)}h=ie.get(e),h.init(),f.push(h),e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(h.pushLight(e),e.castShadow&&h.pushShadow(e))}),h.setupLights(m.physicallyCorrectLights),e.traverse(function(t){let n=t.material;if(n)if(Array.isArray(n))for(let r=0;r<n.length;r++){i(n[r],e,t)}else i(n,e,t)}),f.pop(),h=null};let xe=null;function we(){_e.stop()}function Se(){_e.start()}let _e=new JE;function Ce(e,t,i,n){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)i=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)h.pushLight(e),e.castShadow&&h.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||k.intersectsSprite(e)){n&&F.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B);let t=J.update(e),r=e.material;r.visible&&u.push(e,t,r,i,F.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==G.render.frame&&(e.skeleton.update(),e.skeleton.frame=G.render.frame),!e.frustumCulled||k.intersectsObject(e))){n&&F.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B);let t=J.update(e),r=e.material;if(Array.isArray(r)){let n=t.groups;for(let a=0,o=n.length;a<o;a++){let o=n[a],s=r[o.materialIndex];s&&s.visible&&u.push(e,t,s,i,F.z,o)}}else r.visible&&u.push(e,t,r,i,F.z,null)}let r=e.children;for(let a=0,o=r.length;a<o;a++)Ce(r[a],t,i,n)}function Ee(e,t,i,n){let r=e.opaque,a=e.transmissive,s=e.transparent;h.setupLightsView(i),!0===R&&ne.setGlobalState(m.clippingPlanes,i),a.length>0&&function(e,t,i){let n=W.isWebGL2;null===L&&(L=new N_(1,1,{generateMipmaps:!0,type:j.has("EXT_color_buffer_half_float")?_S:xS,minFilter:bS,samples:n&&!0===o?4:0})),m.getDrawingBufferSize(N),n?L.setSize(N.x,N.y):L.setSize(c_(N.x),c_(N.y));let r=m.getRenderTarget();m.setRenderTarget(L),m.clear();let a=m.toneMapping;m.toneMapping=0,Ae(e,t,i),m.toneMapping=a,X.updateMultisampleRenderTarget(L),X.updateRenderTargetMipmap(L),m.setRenderTarget(r)}(r,t,i),n&&H.viewport(S.copy(n)),r.length>0&&Ae(r,t,i),a.length>0&&Ae(a,t,i),s.length>0&&Ae(s,t,i),H.buffers.depth.setTest(!0),H.buffers.depth.setMask(!0),H.buffers.color.setMask(!0),H.setPolygonOffset(!1)}function Ae(e,t,i){let n=!0===t.isScene?t.overrideMaterial:null;for(let r=0,a=e.length;r<a;r++){let a=e[r],o=a.object,s=a.geometry,l=null===n?a.material:n,c=a.group;o.layers.test(i.layers)&&Me(o,t,i,s,l,c)}}function Me(e,t,i,n,r,a){e.onBeforeRender(m,t,i,n,r,a),e.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),r.onBeforeRender(m,t,i,n,e,a),!0===r.transparent&&2===r.side&&!1===r.forceSinglePass?(r.side=1,r.needsUpdate=!0,m.renderBufferDirect(i,t,n,r,e,a),r.side=0,r.needsUpdate=!0,m.renderBufferDirect(i,t,n,r,e,a),r.side=2):m.renderBufferDirect(i,t,n,r,e,a),e.onAfterRender(m,t,i,n,r,a)}function Te(e,t,i){!0!==t.isScene&&(t=U);let n=q.get(e),r=h.state.lights,a=h.state.shadowsArray,o=r.state.version,s=$.getParameters(e,r.state,a,t,i),l=$.getProgramCacheKey(s),c=n.programs;n.environment=e.isMeshStandardMaterial?t.environment:null,n.fog=t.fog,n.envMap=(e.isMeshStandardMaterial?Q:Y).get(e.envMap||n.environment),void 0===c&&(e.addEventListener("dispose",be),c=new Map,n.programs=c);let d=c.get(l);if(void 0!==d){if(n.currentProgram===d&&n.lightsStateVersion===o)return Pe(e,s),d}else s.uniforms=$.getUniforms(e),e.onBuild(i,s,m),e.onBeforeCompile(s,m),d=$.acquireProgram(s,l),c.set(l,d),n.uniforms=s.uniforms;let u=n.uniforms;(!e.isShaderMaterial&&!e.isRawShaderMaterial||!0===e.clipping)&&(u.clippingPlanes=ne.uniform),Pe(e,s),n.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),n.lightsStateVersion=o,n.needsLights&&(u.ambientLightColor.value=r.state.ambient,u.lightProbe.value=r.state.probe,u.directionalLights.value=r.state.directional,u.directionalLightShadows.value=r.state.directionalShadow,u.spotLights.value=r.state.spot,u.spotLightShadows.value=r.state.spotShadow,u.rectAreaLights.value=r.state.rectArea,u.ltc_1.value=r.state.rectAreaLTC1,u.ltc_2.value=r.state.rectAreaLTC2,u.pointLights.value=r.state.point,u.pointLightShadows.value=r.state.pointShadow,u.hemisphereLights.value=r.state.hemi,u.directionalShadowMap.value=r.state.directionalShadowMap,u.directionalShadowMatrix.value=r.state.directionalShadowMatrix,u.spotShadowMap.value=r.state.spotShadowMap,u.spotLightMatrix.value=r.state.spotLightMatrix,u.spotLightMap.value=r.state.spotLightMap,u.pointShadowMap.value=r.state.pointShadowMap,u.pointShadowMatrix.value=r.state.pointShadowMatrix);let p=d.getUniforms(),f=BM.seqWithValue(p.seq,u);return n.currentProgram=d,n.uniformsList=f,d}function Pe(e,t){let i=q.get(e);i.outputEncoding=t.outputEncoding,i.instancing=t.instancing,i.skinning=t.skinning,i.morphTargets=t.morphTargets,i.morphNormals=t.morphNormals,i.morphColors=t.morphColors,i.morphTargetsCount=t.morphTargetsCount,i.numClippingPlanes=t.numClippingPlanes,i.numIntersection=t.numClipIntersection,i.vertexAlphas=t.vertexAlphas,i.vertexTangents=t.vertexTangents,i.toneMapping=t.toneMapping}_e.setAnimationLoop(function(e){xe&&xe(e)}),typeof self<"u"&&_e.setContext(self),this.setAnimationLoop=function(e){xe=e,me.setAnimationLoop(e),null===e?_e.stop():_e.start()},me.addEventListener("sessionstart",we),me.addEventListener("sessionend",Se),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===g)return;!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===me.enabled&&!0===me.isPresenting&&(!0===me.cameraAutoUpdate&&me.updateCamera(t),t=me.getCamera()),!0===e.isScene&&e.onBeforeRender(m,e,t,b),h=ie.get(e,f.length),h.init(),f.push(h),B.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),k.setFromProjectionMatrix(B),z=this.localClippingEnabled,R=ne.init(this.clippingPlanes,z),u=te.get(e,p.length),u.init(),p.push(u),Ce(e,t,0,m.sortObjects),u.finish(),!0===m.sortObjects&&u.sort(T,P),!0===R&&ne.beginShadows();let i=h.state.shadowsArray;if(re.render(i,e,t),!0===R&&ne.endShadows(),!0===this.info.autoReset&&this.info.reset(),ae.render(u,e),h.setupLights(m.physicallyCorrectLights),t.isArrayCamera){let i=t.cameras;for(let t=0,n=i.length;t<n;t++){let n=i[t];Ee(u,e,n,n.viewport)}}else Ee(u,e,t);null!==b&&(X.updateMultisampleRenderTarget(b),X.updateRenderTargetMipmap(b)),!0===e.isScene&&e.onAfterRender(m,e,t),de.resetDefaultState(),x=-1,w=null,f.pop(),h=f.length>0?f[f.length-1]:null,p.pop(),u=p.length>0?p[p.length-1]:null},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(e,t,i){q.get(e.texture).__webglTexture=t,q.get(e.depthTexture).__webglTexture=i;let n=q.get(e);n.__hasExternalTextures=!0,n.__hasExternalTextures&&(n.__autoAllocateDepthBuffer=void 0===i,n.__autoAllocateDepthBuffer||!0===j.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),n.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){let i=q.get(e);i.__webglFramebuffer=t,i.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;b=e,v=t,y=i;let n=!0,r=null,a=!1,o=!1;if(e){let i=q.get(e);void 0!==i.__useDefaultFramebuffer?(H.bindFramebuffer(36160,null),n=!1):void 0===i.__webglFramebuffer?X.setupRenderTarget(e):i.__hasExternalTextures&&X.rebindTextures(e,q.get(e.texture).__webglTexture,q.get(e.depthTexture).__webglTexture);let s=e.texture;(s.isData3DTexture||s.isDataArrayTexture||s.isCompressedArrayTexture)&&(o=!0);let l=q.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=l[t],a=!0):r=W.isWebGL2&&e.samples>0&&!1===X.useMultisampledRTT(e)?q.get(e).__webglMultisampledFramebuffer:l,S.copy(e.viewport),_.copy(e.scissor),C=e.scissorTest}else S.copy(D).multiplyScalar(M).floor(),_.copy(O).multiplyScalar(M).floor(),C=I;if(H.bindFramebuffer(36160,r)&&W.drawBuffers&&n&&H.drawBuffers(e,r),H.viewport(S),H.scissor(_),H.setScissorTest(C),a){let n=q.get(e.texture);he.framebufferTexture2D(36160,36064,34069+t,n.__webglTexture,i)}else if(o){let n=q.get(e.texture),r=t||0;he.framebufferTextureLayer(36160,36064,n.__webglTexture,i||0,r)}x=-1},this.readRenderTargetPixels=function(e,t,i,n,r,a,o){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){H.bindFramebuffer(36160,s);try{let o=e.texture,s=o.format,l=o.type;if(s!==ES&&ce.convert(s)!==he.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");let c=l===_S&&(j.has("EXT_color_buffer_half_float")||W.isWebGL2&&j.has("EXT_color_buffer_float"));if(l!==xS&&ce.convert(l)!==he.getParameter(35738)&&(l!==SS||!(W.isWebGL2||j.has("OES_texture_float")||j.has("WEBGL_color_buffer_float")))&&!c)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-n&&i>=0&&i<=e.height-r&&he.readPixels(t,i,n,r,ce.convert(s),ce.convert(l),a)}finally{let e=null!==b?q.get(b).__webglFramebuffer:null;H.bindFramebuffer(36160,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,i,n,r,a,o){if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){let o=e.texture,l=o.format,c=o.type;if(t>=0&&t<=e.width-n&&i>=0&&i<=e.height-r){H.bindFramebuffer(he.FRAMEBUFFER,s);let e=he.createBuffer();he.bindBuffer(he.PIXEL_PACK_BUFFER,e),he.bufferData(he.PIXEL_PACK_BUFFER,a.byteLength,he.STREAM_READ),he.readPixels(t,i,n,r,ce.convert(l),ce.convert(c),0);let o=null!==b?q.get(b).__webglFramebuffer:null;H.bindFramebuffer(he.FRAMEBUFFER,o);let d=he.fenceSync(he.SYNC_GPU_COMMANDS_COMPLETE,0);return he.flush(),await function(e,t,i){return new Promise(function(n,r){setTimeout(function a(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:r();break;case e.TIMEOUT_EXPIRED:setTimeout(a,i);break;default:n()}},i)})}(he,d,4),he.bindBuffer(he.PIXEL_PACK_BUFFER,e),he.getBufferSubData(he.PIXEL_PACK_BUFFER,0,a),he.deleteBuffer(e),he.deleteSync(d),a}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Math.pow(2,-i),r=Math.floor(t.image.width*n),a=Math.floor(t.image.height*n);X.setTexture2D(t,0),he.copyTexSubImage2D(3553,i,0,0,e.x,e.y,r,a),H.unbindTexture()},this.copyTextureToTexture=function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=t.image.width,a=t.image.height,o=ce.convert(i.format),s=ce.convert(i.type);X.setTexture2D(i,0),he.pixelStorei(37440,i.flipY),he.pixelStorei(37441,i.premultiplyAlpha),he.pixelStorei(3317,i.unpackAlignment),t.isDataTexture?he.texSubImage2D(3553,n,e.x,e.y,r,a,o,s,t.image.data):t.isCompressedTexture?he.compressedTexSubImage2D(3553,n,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):he.texSubImage2D(3553,n,e.x,e.y,o,s,t.image),0===n&&i.generateMipmaps&&he.generateMipmap(3553),H.unbindTexture()},this.copyTextureToTexture3D=function(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");let a,o=e.max.x-e.min.x+1,s=e.max.y-e.min.y+1,l=e.max.z-e.min.z+1,c=ce.convert(n.format),d=ce.convert(n.type);if(n.isData3DTexture)X.setTexture3D(n,0),a=32879;else{if(!n.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");X.setTexture2DArray(n,0),a=35866}he.pixelStorei(37440,n.flipY),he.pixelStorei(37441,n.premultiplyAlpha),he.pixelStorei(3317,n.unpackAlignment);let u=he.getParameter(3314),h=he.getParameter(32878),p=he.getParameter(3316),f=he.getParameter(3315),g=he.getParameter(32877),v=i.isCompressedTexture?i.mipmaps[0]:i.image;he.pixelStorei(3314,v.width),he.pixelStorei(32878,v.height),he.pixelStorei(3316,e.min.x),he.pixelStorei(3315,e.min.y),he.pixelStorei(32877,e.min.z),i.isDataTexture||i.isData3DTexture?he.texSubImage3D(a,r,t.x,t.y,t.z,o,s,l,c,d,v.data):i.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),he.compressedTexSubImage3D(a,r,t.x,t.y,t.z,o,s,l,c,v.data)):he.texSubImage3D(a,r,t.x,t.y,t.z,o,s,l,c,d,v),he.pixelStorei(3314,u),he.pixelStorei(32878,h),he.pixelStorei(3316,p),he.pixelStorei(3315,f),he.pixelStorei(32877,g),0===r&&n.generateMipmaps&&he.generateMipmap(a),H.unbindTexture()},this.initRenderTarget=function(e){void 0===q.get(e).__webglFramebuffer&&X.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?X.setTextureCube(e,0):e.isData3DTexture?X.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?X.setTexture2DArray(e,0):X.setTexture2D(e,0),H.unbindTexture()},this.resetState=function(){v=0,y=0,b=null,H.reset(),de.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class extends PT{}).prototype.isWebGL1Renderer=!0;var DT=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.isFog=!0,this.name="",this.color=new D_(e),this.near=t,this.far=i}clone(){return new DT(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},OT=class extends WC{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}},IT=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=QS,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=n_()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let n=0,r=this.stride;n<r;n++)this.array[e+n]=t.array[i+n];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=n_()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=n_()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},kT=new j_,RT=class{constructor(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)kT.fromBufferAttribute(this,t),kT.applyMatrix4(e),this.setXYZ(t,kT.x,kT.y,kT.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)kT.fromBufferAttribute(this,t),kT.applyNormalMatrix(e),this.setXYZ(t,kT.x,kT.y,kT.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)kT.fromBufferAttribute(this,t),kT.transformDirection(e),this.setXYZ(t,kT.x,kT.y,kT.z);return this}setX(e,t){return this.normalized&&(t=u_(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=u_(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=u_(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=u_(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=d_(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=d_(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=d_(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=d_(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=u_(t,this.array),i=u_(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=u_(t,this.array),i=u_(i,this.array),n=u_(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this}setXYZW(e,t,i,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=u_(t,this.array),i=u_(i,this.array),n=u_(n,this.array),r=u_(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this.data.array[e+3]=r,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let i=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[i+t])}return new oE(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new RT(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let i=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[i+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},zT=class extends WC{constructor(){super(),this.isBone=!0,this.type="Bone"}},LT=class extends L_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(null,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:fS,arguments.length>9&&void 0!==arguments[9]?arguments[9]:fS,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>10?arguments[10]:void 0,arguments.length>11?arguments[11]:void 0),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},BT=new yC,NT=new yC,FT=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.uuid=n_(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new yC)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let t=new yC;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){let e=this.bones,t=this.boneInverses,i=this.boneMatrices,n=this.boneTexture;for(let r=0,a=e.length;r<a;r++){let n=e[r]?e[r].matrixWorld:NT;BT.multiplyMatrices(n,t[r]),BT.toArray(i,16*r)}null!==n&&(n.needsUpdate=!0)}clone(){return new FT(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=l_(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let i=new LT(t,e,e,ES,SS);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){let i=this.bones[t];if(i.name===e)return i}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,n=e.bones.length;i<n;i++){let n=e.bones[i],r=t[n];void 0===r&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),r=new zT),this.bones.push(r),this.boneInverses.push((new yC).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,i=this.boneInverses;for(let n=0,r=t.length;n<r;n++){let r=t[n];e.bones.push(r.uuid);let a=i[n];e.boneInverses.push(a.toArray())}return e}},UT=class extends oE{constructor(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},VT=new yC,jT=new yC,WT=[],HT=new yC,GT=new OE,qT=class extends OE{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new UT(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1;for(let n=0;n<i;n++)this.setMatrixAt(n,HT)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){let i=this.matrixWorld,n=this.count;if(GT.geometry=this.geometry,GT.material=this.material,void 0!==GT.material)for(let r=0;r<n;r++){this.getMatrixAt(r,VT),jT.multiplyMatrices(i,VT),GT.matrixWorld=jT,GT.raycast(e,WT);for(let e=0,i=WT.length;e<i;e++){let i=WT[e];i.instanceId=r,i.object=this,t.push(i)}WT.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new UT(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},XT=class extends iE{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new D_(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},YT=new j_,QT=new j_,KT=new yC,ZT=new vC,JT=new cC,$T=class extends WC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new vE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new XT;super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,i=[0];for(let e=1,n=t.count;e<n;e++)YT.fromBufferAttribute(t,e-1),QT.fromBufferAttribute(t,e),i[e]=i[e-1],i[e]+=YT.distanceTo(QT);e.setAttribute("lineDistance",new cE(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let i=this.geometry,n=this.matrixWorld,r=e.params.Line.threshold,a=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),JT.copy(i.boundingSphere),JT.applyMatrix4(n),JT.radius+=r,!1===e.ray.intersectsSphere(JT))return;KT.copy(n).invert(),ZT.copy(e.ray).applyMatrix4(KT);let o=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=new j_,c=new j_,d=new j_,u=new j_,h=this.isLineSegments?2:1,p=i.index,f=i.attributes.position;if(null!==p){for(let i=Math.max(0,a.start),n=Math.min(p.count,a.start+a.count)-1;i<n;i+=h){let n=p.getX(i),r=p.getX(i+1);if(l.fromBufferAttribute(f,n),c.fromBufferAttribute(f,r),ZT.distanceSqToSegment(l,c,u,d)>s)continue;u.applyMatrix4(this.matrixWorld);let a=e.ray.origin.distanceTo(u);a<e.near||a>e.far||t.push({distance:a,point:d.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this})}}else{for(let i=Math.max(0,a.start),n=Math.min(f.count,a.start+a.count)-1;i<n;i+=h){if(l.fromBufferAttribute(f,i),c.fromBufferAttribute(f,i+1),ZT.distanceSqToSegment(l,c,u,d)>s)continue;u.applyMatrix4(this.matrixWorld);let n=e.ray.origin.distanceTo(u);n<e.near||n>e.far||t.push({distance:n,point:d.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let i=e[t[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=i.length;e<t;e++){let t=i[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}},eP=new j_,tP=new j_,iP=class extends $T{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,i=[];for(let e=0,n=t.count;e<n;e+=2)eP.fromBufferAttribute(t,e),tP.fromBufferAttribute(t,e+1),i[e]=0===e?0:i[e-1],i[e+1]=i[e]+eP.distanceTo(tP);e.setAttribute("lineDistance",new cE(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},nP=class extends L_{constructor(e,t,i,n,r,a,o,s,l){super(e,t,i,n,r,a,o,s,l),this.isVideoTexture=!0,this.minFilter=void 0!==a?a:vS,this.magFilter=void 0!==r?r:vS,this.generateMipmaps=!1;let c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function t(){c.needsUpdate=!0,e.requestVideoFrameCallback(t)})}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},rP=class extends L_{constructor(e,t,i,n,r,a,o,s,l){super(e,t,i,n,r,a,o,s,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},aP=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t,i=[],n=this.getPoint(0),r=0;i.push(0);for(let a=1;a<=e;a++)t=this.getPoint(a/e),r+=t.distanceTo(n),i.push(r),n=t;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let i,n=this.getLengths(),r=0,a=n.length;i=t||e*n[a-1];let o,s=0,l=a-1;for(;s<=l;)if(r=Math.floor(s+(l-s)/2),o=n[r]-i,o<0)s=r+1;else{if(!(o>0)){l=r;break}l=r-1}if(r=l,n[r]===i)return r/(a-1);let c=n[r];return(r+(i-c)/(n[r+1]-c))/(a-1)}getTangent(e,t){let i=e-1e-4,n=e+1e-4;i<0&&(i=0),n>1&&(n=1);let r=this.getPoint(i),a=this.getPoint(n),o=t||(r.isVector2?new p_:new j_);return o.copy(a).sub(r).normalize(),o}getTangentAt(e,t){let i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){let i=new j_,n=[],r=[],a=[],o=new j_,s=new yC;for(let h=0;h<=e;h++){let t=h/e;n[h]=this.getTangentAt(t,new j_)}r[0]=new j_,a[0]=new j_;let l=Number.MAX_VALUE,c=Math.abs(n[0].x),d=Math.abs(n[0].y),u=Math.abs(n[0].z);c<=l&&(l=c,i.set(1,0,0)),d<=l&&(l=d,i.set(0,1,0)),u<=l&&i.set(0,0,1),o.crossVectors(n[0],i).normalize(),r[0].crossVectors(n[0],o),a[0].crossVectors(n[0],r[0]);for(let h=1;h<=e;h++){if(r[h]=r[h-1].clone(),a[h]=a[h-1].clone(),o.crossVectors(n[h-1],n[h]),o.length()>Number.EPSILON){o.normalize();let e=Math.acos(r_(n[h-1].dot(n[h]),-1,1));r[h].applyMatrix4(s.makeRotationAxis(o,e))}a[h].crossVectors(n[h],r[h])}if(!0===t){let t=Math.acos(r_(r[0].dot(r[e]),-1,1));t/=e,n[0].dot(o.crossVectors(r[0],r[e]))>0&&(t=-t);for(let i=1;i<=e;i++)r[i].applyMatrix4(s.makeRotationAxis(n[i],t*i)),a[i].crossVectors(n[i],r[i])}return{tangents:n,normals:r,binormals:a}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},oP=class extends aP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=a,this.aClockwise=o,this.aRotation=s}getPoint(e,t){let i=t||new p_,n=2*Math.PI,r=this.aEndAngle-this.aStartAngle,a=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(r=a?0:n),!0===this.aClockwise&&!a&&(r===n?r=-n:r-=n);let o=this.aStartAngle+e*r,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){let e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),i=s-this.aX,n=l-this.aY;s=i*e-n*t+this.aX,l=i*t+n*e+this.aY}return i.set(s,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}};function sP(){let e=0,t=0,i=0,n=0;function r(r,a,o,s){e=r,t=o,i=-3*r+3*a-2*o-s,n=2*r-2*a+o+s}return{initCatmullRom:function(e,t,i,n,a){r(t,i,a*(i-e),a*(n-t))},initNonuniformCatmullRom:function(e,t,i,n,a,o,s){let l=(t-e)/a-(i-e)/(a+o)+(i-t)/o,c=(i-t)/o-(n-t)/(o+s)+(n-i)/s;l*=o,c*=o,r(t,i,l,c)},calc:function(r){let a=r*r;return e+t*r+i*a+n*(a*r)}}}var lP=new j_,cP=new sP,dP=new sP,uP=new sP;function hP(e,t,i,n,r){let a=.5*(n-t),o=.5*(r-i),s=e*e;return(2*i-2*n+a+o)*(e*s)+(-3*i+3*n-2*a-o)*s+a*e+i}function pP(e,t,i,n){return function(e,t){let i=1-e;return i*i*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,i)+function(e,t){return e*e*t}(e,n)}function fP(e,t,i,n,r){return function(e,t){let i=1-e;return i*i*i*t}(e,t)+function(e,t){let i=1-e;return 3*i*i*e*t}(e,i)+function(e,t){return 3*(1-e)*e*e*t}(e,n)+function(e,t){return e*e*e*t}(e,r)}var mP=class extends aP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new p_,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new p_,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new p_,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new p_;super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=n}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new p_,i=this.v0,n=this.v1,r=this.v2,a=this.v3;return t.set(fP(e,i.x,n.x,r.x,a.x),fP(e,i.y,n.y,r.y,a.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},gP=class extends aP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new j_,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new j_,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new j_,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new j_;super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=n}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new j_,i=this.v0,n=this.v1,r=this.v2,a=this.v3;return t.set(fP(e,i.x,n.x,r.x,a.x),fP(e,i.y,n.y,r.y,a.y),fP(e,i.z,n.z,r.z,a.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},vP=class extends aP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new p_,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new p_;super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new p_;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let i=t||new p_;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},yP=class extends aP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new j_,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new j_;super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new j_;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},bP=class extends aP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new p_,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new p_,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new p_;super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new p_,i=this.v0,n=this.v1,r=this.v2;return t.set(pP(e,i.x,n.x,r.x),pP(e,i.y,n.y,r.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},xP=class extends aP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new p_,i=this.points,n=(i.length-1)*e,r=Math.floor(n),a=n-r,o=i[0===r?r:r-1],s=i[r],l=i[r>i.length-2?i.length-1:r+1],c=i[r>i.length-3?i.length-1:r+2];return t.set(hP(a,o.x,s.x,l.x,c.x),hP(a,o.y,s.y,l.y,c.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let i=e.points[t];this.points.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){let i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let i=e.points[t];this.points.push((new p_).fromArray(i))}return this}},wP=Object.freeze({__proto__:null,ArcCurve:class extends oP{constructor(e,t,i,n,r,a){super(e,t,i,i,n,r,a),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class extends aP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=n}getPoint(e){let t,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new j_,r=this.points,a=r.length,o=(a-(this.closed?0:1))*e,s=Math.floor(o),l=o-s;this.closed?s+=s>0?0:(Math.floor(Math.abs(s)/a)+1)*a:0===l&&s===a-1&&(s=a-2,l=1),this.closed||s>0?t=r[(s-1)%a]:(lP.subVectors(r[0],r[1]).add(r[0]),t=lP);let c=r[s%a],d=r[(s+1)%a];if(this.closed||s+2<a?i=r[(s+2)%a]:(lP.subVectors(r[a-1],r[a-2]).add(r[a-1]),i=lP),"centripetal"===this.curveType||"chordal"===this.curveType){let e="chordal"===this.curveType?.5:.25,n=Math.pow(t.distanceToSquared(c),e),r=Math.pow(c.distanceToSquared(d),e),a=Math.pow(d.distanceToSquared(i),e);r<1e-4&&(r=1),n<1e-4&&(n=r),a<1e-4&&(a=r),cP.initNonuniformCatmullRom(t.x,c.x,d.x,i.x,n,r,a),dP.initNonuniformCatmullRom(t.y,c.y,d.y,i.y,n,r,a),uP.initNonuniformCatmullRom(t.z,c.z,d.z,i.z,n,r,a)}else"catmullrom"===this.curveType&&(cP.initCatmullRom(t.x,c.x,d.x,i.x,this.tension),dP.initCatmullRom(t.y,c.y,d.y,i.y,this.tension),uP.initCatmullRom(t.z,c.z,d.z,i.z,this.tension));return n.set(cP.calc(l),dP.calc(l),uP.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){let i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let i=e.points[t];this.points.push((new j_).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},CubicBezierCurve:mP,CubicBezierCurve3:gP,EllipseCurve:oP,LineCurve:vP,LineCurve3:yP,QuadraticBezierCurve:bP,QuadraticBezierCurve3:class extends aP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new j_,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new j_,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new j_;super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new j_,i=this.v0,n=this.v1,r=this.v2;return t.set(pP(e,i.x,n.x,r.x),pP(e,i.y,n.y,r.y),pP(e,i.z,n.z,r.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},SplineCurve:xP}),SP=class extends aP{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new vP(t,e))}getPoint(e,t){let i=e*this.getLength(),n=this.getCurveLengths(),r=0;for(;r<n.length;){if(n[r]>=i){let e=n[r]-i,a=this.curves[r],o=a.getLength(),s=0===o?0:1-e/o;return a.getPointAt(s,t)}r++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let i=0,n=this.curves.length;i<n;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,i=[];for(let n=0,r=this.curves;n<r.length;n++){let a=r[n],o=a.isEllipseCurve?2*t:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o);for(let t=0;t<s.length;t++){let n=s[t];e&&e.equals(n)||(i.push(n),e=n)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){let i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){let i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){let i=e.curves[t];this.curves.push((new wP[i.type]).fromJSON(i))}return this}},_P=class extends SP{constructor(e){super(),this.type="Path",this.currentPoint=new p_,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let i=new vP(this.currentPoint.clone(),new p_(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,n){let r=new bP(this.currentPoint.clone(),new p_(e,t),new p_(i,n));return this.curves.push(r),this.currentPoint.set(i,n),this}bezierCurveTo(e,t,i,n,r,a){let o=new mP(this.currentPoint.clone(),new p_(e,t),new p_(i,n),new p_(r,a));return this.curves.push(o),this.currentPoint.set(r,a),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),i=new xP(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,n,r,a){let o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,i,n,r,a),this}absarc(e,t,i,n,r,a){return this.absellipse(e,t,i,i,n,r,a),this}ellipse(e,t,i,n,r,a,o,s){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,i,n,r,a,o,s),this}absellipse(e,t,i,n,r,a,o,s){let l=new oP(e,t,i,n,r,a,o,s);if(this.curves.length>0){let e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},CP=class extends vE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new p_(0,-.5),new p_(.5,0),new p_(0,.5)],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},t=Math.floor(t),n=r_(n,0,2*Math.PI);let r=[],a=[],o=[],s=[],l=[],c=1/t,d=new j_,u=new p_,h=new j_,p=new j_,f=new j_,m=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,h.x=1*g,h.y=-m,h.z=0*g,f.copy(h),h.normalize(),s.push(h.x,h.y,h.z);break;case e.length-1:s.push(f.x,f.y,f.z);break;default:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,h.x=1*g,h.y=-m,h.z=0*g,p.copy(h),h.x+=f.x,h.y+=f.y,h.z+=f.z,h.normalize(),s.push(h.x,h.y,h.z),f.copy(p)}for(let v=0;v<=t;v++){let r=i+v*c*n,h=Math.sin(r),p=Math.cos(r);for(let i=0;i<=e.length-1;i++){d.x=e[i].x*h,d.y=e[i].y,d.z=e[i].x*p,a.push(d.x,d.y,d.z),u.x=v/t,u.y=i/(e.length-1),o.push(u.x,u.y);let n=s[3*i+0]*h,r=s[3*i+1],c=s[3*i+0]*p;l.push(n,r,c)}}for(let v=0;v<t;v++)for(let t=0;t<e.length-1;t++){let i=t+v*e.length,n=i,a=i+e.length,o=i+e.length+1,s=i+1;r.push(n,a,s),r.push(o,s,a)}this.setIndex(r),this.setAttribute("position",new cE(a,3)),this.setAttribute("uv",new cE(o,2)),this.setAttribute("normal",new cE(l,3))}static fromJSON(e){return new CP(e.points,e.segments,e.phiStart,e.phiLength)}},EP=class extends vE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:n,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s};let l=this;n=Math.floor(n),r=Math.floor(r);let c=[],d=[],u=[],h=[],p=0,f=[],m=i/2,g=0;function v(i){let r=p,a=new p_,f=new j_,v=0,y=!0===i?e:t,b=!0===i?1:-1;for(let e=1;e<=n;e++)d.push(0,m*b,0),u.push(0,b,0),h.push(.5,.5),p++;let x=p;for(let e=0;e<=n;e++){let t=e/n*s+o,i=Math.cos(t),r=Math.sin(t);f.x=y*r,f.y=m*b,f.z=y*i,d.push(f.x,f.y,f.z),u.push(0,b,0),a.x=.5*i+.5,a.y=.5*r*b+.5,h.push(a.x,a.y),p++}for(let e=0;e<n;e++){let t=r+e,n=x+e;!0===i?c.push(n,n+1,t):c.push(n+1,n,t),v+=3}l.addGroup(g,v,!0===i?1:2),g+=v}(function(){let a=new j_,v=new j_,y=0,b=(t-e)/i;for(let l=0;l<=r;l++){let c=[],g=l/r,y=g*(t-e)+e;for(let e=0;e<=n;e++){let t=e/n,r=t*s+o,l=Math.sin(r),f=Math.cos(r);v.x=y*l,v.y=-g*i+m,v.z=y*f,d.push(v.x,v.y,v.z),a.set(l,b,f).normalize(),u.push(a.x,a.y,a.z),h.push(t,1-g),c.push(p++)}f.push(c)}for(let e=0;e<n;e++)for(let t=0;t<r;t++){let i=f[t][e],n=f[t+1][e],r=f[t+1][e+1],a=f[t][e+1];c.push(i,n,a),c.push(n,r,a),y+=6}l.addGroup(g,y,0),g+=y})(),!1===a&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new cE(d,3)),this.setAttribute("normal",new cE(u,3)),this.setAttribute("uv",new cE(h,2))}static fromJSON(e){return new EP(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},AP=class extends EP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;super(0,e,t,i,n,r,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:a,thetaLength:o}}static fromJSON(e){return new AP(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},MP=class extends vE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:n};let r=[],a=[];function o(e,t,i,n){let r=n+1,a=[];for(let o=0;o<=r;o++){a[o]=[];let n=e.clone().lerp(i,o/r),s=t.clone().lerp(i,o/r),l=r-o;for(let e=0;e<=l;e++)a[o][e]=0===e&&o===r?n:n.clone().lerp(s,e/l)}for(let o=0;o<r;o++)for(let e=0;e<2*(r-o)-1;e++){let t=Math.floor(e/2);e%2===0?(s(a[o][t+1]),s(a[o+1][t]),s(a[o][t])):(s(a[o][t+1]),s(a[o+1][t+1]),s(a[o+1][t]))}}function s(e){r.push(e.x,e.y,e.z)}function l(t,i){let n=3*t;i.x=e[n+0],i.y=e[n+1],i.z=e[n+2]}function c(e,t,i,n){n<0&&1===e.x&&(a[t]=e.x-1),0===i.x&&0===i.z&&(a[t]=n/2/Math.PI+.5)}function d(e){return Math.atan2(e.z,-e.x)}function u(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(function(e){let i=new j_,n=new j_,r=new j_;for(let a=0;a<t.length;a+=3)l(t[a+0],i),l(t[a+1],n),l(t[a+2],r),o(i,n,r,e)})(n),function(e){let t=new j_;for(let i=0;i<r.length;i+=3)t.x=r[i+0],t.y=r[i+1],t.z=r[i+2],t.normalize().multiplyScalar(e),r[i+0]=t.x,r[i+1]=t.y,r[i+2]=t.z}(i),function(){let e=new j_;for(let t=0;t<r.length;t+=3){e.x=r[t+0],e.y=r[t+1],e.z=r[t+2];let i=d(e)/2/Math.PI+.5,n=u(e)/Math.PI+.5;a.push(i,1-n)}(function(){let e=new j_,t=new j_,i=new j_,n=new j_,o=new p_,s=new p_,l=new p_;for(let u=0,h=0;u<r.length;u+=9,h+=6){e.set(r[u+0],r[u+1],r[u+2]),t.set(r[u+3],r[u+4],r[u+5]),i.set(r[u+6],r[u+7],r[u+8]),o.set(a[h+0],a[h+1]),s.set(a[h+2],a[h+3]),l.set(a[h+4],a[h+5]),n.copy(e).add(t).add(i).divideScalar(3);let p=d(n);c(o,h+0,e,p),c(s,h+2,t,p),c(l,h+4,i,p)}})(),function(){for(let e=0;e<a.length;e+=6){let t=a[e+0],i=a[e+2],n=a[e+4],r=Math.max(t,i,n),o=Math.min(t,i,n);r>.9&&o<.1&&(t<.2&&(a[e+0]+=1),i<.2&&(a[e+2]+=1),n<.2&&(a[e+4]+=1))}}()}(),this.setAttribute("position",new cE(r,3)),this.setAttribute("normal",new cE(r.slice(),3)),this.setAttribute("uv",new cE(a,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new MP(e.vertices,e.indices,e.radius,e.details)}},TP=class extends MP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(1+Math.sqrt(5))/2,n=1/i;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new TP(e.radius,e.detail)}},PP=class extends _P{constructor(e){super(e),this.uuid=n_(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let i=0,n=this.holes.length;i<n;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){let i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){let i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){let i=e.holes[t];this.holes.push((new _P).fromJSON(i))}return this}},DP=function(e,t){let i,n,r,a,o,s,l,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,d=t&&t.length,u=d?t[0]*c:e.length,h=OP(e,0,u,c,!0),p=[];if(!h||h.next===h.prev)return p;if(d&&(h=function(e,t,i,n){let r,a,o,s,l,c=[];for(r=0,a=t.length;r<a;r++)o=t[r]*n,s=r<a-1?t[r+1]*n:e.length,l=OP(e,o,s,n,!1),l===l.next&&(l.steiner=!0),c.push(jP(l));for(c.sort(NP),r=0;r<c.length;r++)i=FP(c[r],i);return i}(e,t,h,c)),e.length>80*c){i=r=e[0],n=a=e[1];for(let t=c;t<u;t+=c)o=e[t],s=e[t+1],o<i&&(i=o),s<n&&(n=s),o>r&&(r=o),s>a&&(a=s);l=Math.max(r-i,a-n),l=0!==l?32767/l:0}return kP(h,p,c,i,n,l,0),p};function OP(e,t,i,n,r){let a,o;if(r===function(e,t,i,n){let r=0;for(let a=t,o=i-n;a<i;a+=n)r+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return r}(e,t,i,n)>0)for(a=t;a<i;a+=n)o=JP(a,e[a],e[a+1],o);else for(a=i-n;a>=t;a-=n)o=JP(a,e[a],e[a+1],o);return o&&qP(o,o.next)&&($P(o),o=o.next),o}function IP(e,t){if(!e)return e;t||(t=e);let i,n=e;do{if(i=!1,n.steiner||!qP(n,n.next)&&0!==GP(n.prev,n,n.next))n=n.next;else{if($P(n),n=t=n.prev,n===n.next)break;i=!0}}while(i||n!==t);return t}function kP(e,t,i,n,r,a,o){if(!e)return;!o&&a&&function(e,t,i,n){let r=e;do{0===r.z&&(r.z=VP(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){let t,i,n,r,a,o,s,l,c=1;do{for(i=e,e=null,a=null,o=0;i;){for(o++,n=i,s=0,t=0;t<c&&(s++,n=n.nextZ,n);t++);for(l=c;s>0||l>0&&n;)0!==s&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,s--):(r=n,n=n.nextZ,l--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;i=n}a.nextZ=null,c*=2}while(o>1)}(r)}(e,n,r,a);let s,l,c=e;for(;e.prev!==e.next;)if(s=e.prev,l=e.next,a?zP(e,n,r,a):RP(e))t.push(s.i/i|0),t.push(e.i/i|0),t.push(l.i/i|0),$P(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?kP(e=LP(IP(e),t,i),t,i,n,r,a,2):2===o&&BP(e,t,i,n,r,a):kP(IP(e),t,i,n,r,a,1);break}}function RP(e){let t=e.prev,i=e,n=e.next;if(GP(t,i,n)>=0)return!1;let r=t.x,a=i.x,o=n.x,s=t.y,l=i.y,c=n.y,d=r<a?r<o?r:o:a<o?a:o,u=s<l?s<c?s:c:l<c?l:c,h=r>a?r>o?r:o:a>o?a:o,p=s>l?s>c?s:c:l>c?l:c,f=n.next;for(;f!==t;){if(f.x>=d&&f.x<=h&&f.y>=u&&f.y<=p&&WP(r,s,a,l,o,c,f.x,f.y)&&GP(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function zP(e,t,i,n){let r=e.prev,a=e,o=e.next;if(GP(r,a,o)>=0)return!1;let s=r.x,l=a.x,c=o.x,d=r.y,u=a.y,h=o.y,p=s<l?s<c?s:c:l<c?l:c,f=d<u?d<h?d:h:u<h?u:h,m=s>l?s>c?s:c:l>c?l:c,g=d>u?d>h?d:h:u>h?u:h,v=VP(p,f,t,i,n),y=VP(m,g,t,i,n),b=e.prevZ,x=e.nextZ;for(;b&&b.z>=v&&x&&x.z<=y;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==r&&b!==o&&WP(s,d,l,u,c,h,b.x,b.y)&&GP(b.prev,b,b.next)>=0||(b=b.prevZ,x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==o&&WP(s,d,l,u,c,h,x.x,x.y)&&GP(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;b&&b.z>=v;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==r&&b!==o&&WP(s,d,l,u,c,h,b.x,b.y)&&GP(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;x&&x.z<=y;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==o&&WP(s,d,l,u,c,h,x.x,x.y)&&GP(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function LP(e,t,i){let n=e;do{let r=n.prev,a=n.next.next;!qP(r,a)&&XP(r,n,n.next,a)&&KP(r,a)&&KP(a,r)&&(t.push(r.i/i|0),t.push(n.i/i|0),t.push(a.i/i|0),$P(n),$P(n.next),n=e=a),n=n.next}while(n!==e);return IP(n)}function BP(e,t,i,n,r,a){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&HP(o,e)){let s=ZP(o,e);return o=IP(o,o.next),s=IP(s,s.next),kP(o,t,i,n,r,a,0),void kP(s,t,i,n,r,a,0)}e=e.next}o=o.next}while(o!==e)}function NP(e,t){return e.x-t.x}function FP(e,t){let i=function(e,t){let i,n=t,r=-1/0,a=e.x,o=e.y;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){let e=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=a&&e>r&&(r=e,i=n.x<n.next.x?n:n.next,e===a))return i}n=n.next}while(n!==t);if(!i)return null;let s,l=i,c=i.x,d=i.y,u=1/0;n=i;do{a>=n.x&&n.x>=c&&a!==n.x&&WP(o<d?a:r,o,c,d,o<d?r:a,o,n.x,n.y)&&(s=Math.abs(o-n.y)/(a-n.x),KP(n,e)&&(s<u||s===u&&(n.x>i.x||n.x===i.x&&UP(i,n)))&&(i=n,u=s)),n=n.next}while(n!==l);return i}(e,t);if(!i)return t;let n=ZP(i,e);return IP(n,n.next),IP(i,i.next)}function UP(e,t){return GP(e.prev,e,t.prev)<0&&GP(t.next,e,e.next)<0}function VP(e,t,i,n,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function jP(e){let t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function WP(e,t,i,n,r,a,o,s){return(r-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(n-s)>=(i-o)*(t-s)&&(i-o)*(a-s)>=(r-o)*(n-s)}function HP(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&XP(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(KP(e,t)&&KP(t,e)&&function(e,t){let i=e,n=!1,r=(e.x+t.x)/2,a=(e.y+t.y)/2;do{i.y>a!=i.next.y>a&&i.next.y!==i.y&&r<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n}(e,t)&&(GP(e.prev,e,t.prev)||GP(e,t.prev,t))||qP(e,t)&&GP(e.prev,e,e.next)>0&&GP(t.prev,t,t.next)>0)}function GP(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function qP(e,t){return e.x===t.x&&e.y===t.y}function XP(e,t,i,n){let r=QP(GP(e,t,i)),a=QP(GP(e,t,n)),o=QP(GP(i,n,e)),s=QP(GP(i,n,t));return!!(r!==a&&o!==s||0===r&&YP(e,i,t)||0===a&&YP(e,n,t)||0===o&&YP(i,e,n)||0===s&&YP(i,t,n))}function YP(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function QP(e){return e>0?1:e<0?-1:0}function KP(e,t){return GP(e.prev,e,e.next)<0?GP(e,t,e.next)>=0&&GP(e,e.prev,t)>=0:GP(e,t,e.prev)<0||GP(e,e.next,t)<0}function ZP(e,t){let i=new eD(e.i,e.x,e.y),n=new eD(t.i,t.x,t.y),r=e.next,a=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,a.next=n,n.prev=a,n}function JP(e,t,i,n){let r=new eD(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function $P(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function eD(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}var tD=class{static area(e){let t=e.length,i=0;for(let n=t-1,r=0;r<t;n=r++)i+=e[n].x*e[r].y-e[r].x*e[n].y;return.5*i}static isClockWise(e){return tD.area(e)<0}static triangulateShape(e,t){let i=[],n=[],r=[];iD(e),nD(i,e);let a=e.length;t.forEach(iD);for(let s=0;s<t.length;s++)n.push(a),a+=t[s].length,nD(i,t[s]);let o=DP(i,n);for(let s=0;s<o.length;s+=3)r.push(o.slice(s,s+3));return r}};function iD(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function nD(e,t){for(let i=0;i<t.length;i++)e.push(t[i].x),e.push(t[i].y)}var rD=class extends MP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(1+Math.sqrt(5))/2;super([-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new rD(e.radius,e.detail)}},aD=class extends vE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));let s=Math.min(a+o,Math.PI),l=0,c=[],d=new j_,u=new j_,h=[],p=[],f=[],m=[];for(let g=0;g<=i;g++){let h=[],v=g/i,y=0;0==g&&0==a?y=.5/t:g==i&&s==Math.PI&&(y=-.5/t);for(let i=0;i<=t;i++){let s=i/t;d.x=-e*Math.cos(n+s*r)*Math.sin(a+v*o),d.y=e*Math.cos(a+v*o),d.z=e*Math.sin(n+s*r)*Math.sin(a+v*o),p.push(d.x,d.y,d.z),u.copy(d).normalize(),f.push(u.x,u.y,u.z),m.push(s+y,1-v),h.push(l++)}c.push(h)}for(let g=0;g<i;g++)for(let e=0;e<t;e++){let t=c[g][e+1],n=c[g][e],r=c[g+1][e],o=c[g+1][e+1];(0!==g||a>0)&&h.push(t,n,o),(g!==i-1||s<Math.PI)&&h.push(n,r,o)}this.setIndex(h),this.setAttribute("position",new cE(p,3)),this.setAttribute("normal",new cE(f,3)),this.setAttribute("uv",new cE(m,2))}static fromJSON(e){return new aD(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},oD=class extends vE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:48,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,arc:r},i=Math.floor(i),n=Math.floor(n);let a=[],o=[],s=[],l=[],c=new j_,d=new j_,u=new j_;for(let h=0;h<=i;h++)for(let a=0;a<=n;a++){let p=a/n*r,f=h/i*Math.PI*2;d.x=(e+t*Math.cos(f))*Math.cos(p),d.y=(e+t*Math.cos(f))*Math.sin(p),d.z=t*Math.sin(f),o.push(d.x,d.y,d.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),u.subVectors(d,c).normalize(),s.push(u.x,u.y,u.z),l.push(a/n),l.push(h/i)}for(let h=1;h<=i;h++)for(let e=1;e<=n;e++){let t=(n+1)*h+e-1,i=(n+1)*(h-1)+e-1,r=(n+1)*(h-1)+e,o=(n+1)*h+e;a.push(t,i,o),a.push(i,r,o)}this.setIndex(a),this.setAttribute("position",new cE(o,3)),this.setAttribute("normal",new cE(s,3)),this.setAttribute("uv",new cE(l,2))}static fromJSON(e){return new oD(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}},sD=class extends vE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:n,p:r,q:a},i=Math.floor(i),n=Math.floor(n);let o=[],s=[],l=[],c=[],d=new j_,u=new j_,h=new j_,p=new j_,f=new j_,m=new j_,g=new j_;for(let y=0;y<=i;++y){let o=y/i*r*Math.PI*2;v(o,r,a,e,h),v(o+.01,r,a,e,p),m.subVectors(p,h),g.addVectors(p,h),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let e=0;e<=n;++e){let r=e/n*Math.PI*2,a=-t*Math.cos(r),o=t*Math.sin(r);d.x=h.x+(a*g.x+o*f.x),d.y=h.y+(a*g.y+o*f.y),d.z=h.z+(a*g.z+o*f.z),s.push(d.x,d.y,d.z),u.subVectors(d,h).normalize(),l.push(u.x,u.y,u.z),c.push(y/i),c.push(e/n)}}for(let y=1;y<=i;y++)for(let e=1;e<=n;e++){let t=(n+1)*(y-1)+(e-1),i=(n+1)*y+(e-1),r=(n+1)*y+e,a=(n+1)*(y-1)+e;o.push(t,i,a),o.push(i,r,a)}function v(e,t,i,n,r){let a=Math.cos(e),o=Math.sin(e),s=i/t*e,l=Math.cos(s);r.x=n*(2+l)*.5*a,r.y=n*(2+l)*o*.5,r.z=n*Math.sin(s)*.5}this.setIndex(o),this.setAttribute("position",new cE(s,3)),this.setAttribute("normal",new cE(l,3)),this.setAttribute("uv",new cE(c,2))}static fromJSON(e){return new sD(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}},lD=class extends NE{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}};function cD(e,t,i){return uD(e)?new e.constructor(e.subarray(t,void 0!==i?i:e.length)):e.slice(t,i)}function dD(e,t,i){return!e||!i&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function uD(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function hD(e){let t=e.length,i=new Array(t);for(let n=0;n!==t;++n)i[n]=n;return i.sort(function(t,i){return e[t]-e[i]}),i}function pD(e,t,i){let n=e.length,r=new e.constructor(n);for(let a=0,o=0;o!==n;++a){let n=i[a]*t;for(let i=0;i!==t;++i)r[o++]=e[n+i]}return r}function fD(e,t,i,n){let r=1,a=e[0];for(;void 0!==a&&void 0===a[n];)a=e[r++];if(void 0===a)return;let o=a[n];if(void 0!==o)if(Array.isArray(o))do{o=a[n],void 0!==o&&(t.push(a.time),i.push.apply(i,o)),a=e[r++]}while(void 0!==a);else if(void 0!==o.toArray)do{o=a[n],void 0!==o&&(t.push(a.time),o.toArray(i,i.length)),a=e[r++]}while(void 0!==a);else do{o=a[n],void 0!==o&&(t.push(a.time),i.push(o)),a=e[r++]}while(void 0!==a)}var mD=class{constructor(e,t,i,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,i=this._cachedIndex,n=t[i],r=t[i-1];e:{t:{let a;i:{n:if(!(e<n)){for(let a=i+2;;){if(void 0===n){if(e<r)break n;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(r=n,n=t[++i],e<n)break t}a=t.length;break i}if(!(e>=r)){let o=t[1];e<o&&(i=2,r=o);for(let a=i-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(i===a)break;if(n=r,r=t[--i-1],e>=r)break t}a=i,i=0;break i}break e}for(;i<a;){let n=i+a>>>1;e<t[n]?a=n:i=n+1}if(n=t[i],r=t[i-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===n)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=e*n;for(let a=0;a!==n;++a)t[a]=i[r+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},gD=class extends mD{constructor(e,t,i,n){super(e,t,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:FS,endingEnd:FS}}intervalChanged_(e,t,i){let n=this.parameterPositions,r=e-2,a=e+1,o=n[r],s=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case US:r=e,o=2*t-i;break;case VS:r=n.length-2,o=t+n[r]-n[r+1];break;default:r=e,o=i}if(void 0===s)switch(this.getSettings_().endingEnd){case US:a=e,s=2*i-t;break;case VS:a=1,s=i+n[1]-n[0];break;default:a=e-1,s=t}let l=.5*(i-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-i),this._offsetPrev=r*c,this._offsetNext=a*c}interpolate_(e,t,i,n){let r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=this._offsetPrev,d=this._offsetNext,u=this._weightPrev,h=this._weightNext,p=(i-t)/(n-t),f=p*p,m=f*p,g=-u*m+2*u*f-u*p,v=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*p+1,y=(-1-h)*m+(1.5+h)*f+.5*p,b=h*m-h*f;for(let x=0;x!==o;++x)r[x]=g*a[c+x]+v*a[l+x]+y*a[s+x]+b*a[d+x];return r}},vD=class extends mD{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e,t,i,n){let r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=(i-t)/(n-t),d=1-c;for(let u=0;u!==o;++u)r[u]=a[l+u]*d+a[s+u]*c;return r}},yD=class extends mD{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e){return this.copySampleValue_(e-1)}},bD=class{constructor(e,t,i,n){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=dD(t,this.TimeBufferType),this.values=dD(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){let t,i=e.constructor;if(i.toJSON!==this.toJSON)t=i.toJSON(e);else{t={name:e.name,times:dD(e.times,Array),values:dD(e.values,Array)};let i=e.getInterpolation();i!==e.DefaultInterpolation&&(t.interpolation=i)}return t.type=e.ValueTypeName,t}InterpolantFactoryMethodDiscrete(e){return new yD(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new vD(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new gD(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case LS:t=this.InterpolantFactoryMethodDiscrete;break;case BS:t=this.InterpolantFactoryMethodLinear;break;case NS:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){let t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return LS;case this.InterpolantFactoryMethodLinear:return BS;case this.InterpolantFactoryMethodSmooth:return NS}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){let t=this.times;for(let i=0,n=t.length;i!==n;++i)t[i]+=e}return this}scale(e){if(1!==e){let t=this.times;for(let i=0,n=t.length;i!==n;++i)t[i]*=e}return this}trim(e,t){let i=this.times,n=i.length,r=0,a=n-1;for(;r!==n&&i[r]<e;)++r;for(;-1!==a&&i[a]>t;)--a;if(++a,0!==r||a!==n){r>=a&&(a=Math.max(a,1),r=a-1);let e=this.getValueSize();this.times=cD(i,r,a),this.values=cD(this.values,r*e,a*e)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let i=this.times,n=this.values,r=i.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==r;o++){let t=i[o];if("number"==typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,t),e=!1;break}if(null!==a&&a>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,t,a),e=!1;break}a=t}if(void 0!==n&&uD(n))for(let o=0,s=n.length;o!==s;++o){let t=n[o];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,t),e=!1;break}}return e}optimize(){let e=cD(this.times),t=cD(this.values),i=this.getValueSize(),n=this.getInterpolation()===NS,r=e.length-1,a=1;for(let o=1;o<r;++o){let r=!1,s=e[o];if(s!==e[o+1]&&(1!==o||s!==e[0]))if(n)r=!0;else{let e=o*i,n=e-i,a=e+i;for(let o=0;o!==i;++o){let i=t[e+o];if(i!==t[n+o]||i!==t[a+o]){r=!0;break}}}if(r){if(o!==a){e[a]=e[o];let n=o*i,r=a*i;for(let e=0;e!==i;++e)t[r+e]=t[n+e]}++a}}if(r>0){e[a]=e[r];for(let e=r*i,n=a*i,o=0;o!==i;++o)t[n+o]=t[e+o];++a}return a!==e.length?(this.times=cD(e,0,a),this.values=cD(t,0,a*i)):(this.times=e,this.values=t),this}clone(){let e=cD(this.times,0),t=cD(this.values,0),i=new(0,this.constructor)(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}};bD.prototype.TimeBufferType=Float32Array,bD.prototype.ValueBufferType=Float32Array,bD.prototype.DefaultInterpolation=BS;var xD=class extends bD{};xD.prototype.ValueTypeName="bool",xD.prototype.ValueBufferType=Array,xD.prototype.DefaultInterpolation=LS,xD.prototype.InterpolantFactoryMethodLinear=void 0,xD.prototype.InterpolantFactoryMethodSmooth=void 0;var wD=class extends bD{};wD.prototype.ValueTypeName="color";var SD=class extends bD{};SD.prototype.ValueTypeName="number";var _D=class extends mD{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e,t,i,n){let r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(i-t)/(n-t),l=e*o;for(let c=l+o;l!==c;l+=4)V_.slerpFlat(r,0,a,l-o,a,l,s);return r}},CD=class extends bD{InterpolantFactoryMethodLinear(e){return new _D(this.times,this.values,this.getValueSize(),e)}};CD.prototype.ValueTypeName="quaternion",CD.prototype.DefaultInterpolation=BS,CD.prototype.InterpolantFactoryMethodSmooth=void 0;var ED=class extends bD{};ED.prototype.ValueTypeName="string",ED.prototype.ValueBufferType=Array,ED.prototype.DefaultInterpolation=LS,ED.prototype.InterpolantFactoryMethodLinear=void 0,ED.prototype.InterpolantFactoryMethodSmooth=void 0;var AD=class extends bD{};AD.prototype.ValueTypeName="vector";var MD=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:jS;this.name=e,this.tracks=i,this.duration=t,this.blendMode=n,this.uuid=n_(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],i=e.tracks,n=1/(e.fps||1);for(let a=0,o=i.length;a!==o;++a)t.push(TD(i[a]).scale(n));let r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){let t=[],i=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,a=i.length;r!==a;++r)t.push(bD.toJSON(i[r]));return n}static CreateFromMorphTargetSequence(e,t,i,n){let r=t.length,a=[];for(let o=0;o<r;o++){let e=[],s=[];e.push((o+r-1)%r,o,(o+1)%r),s.push(0,1,0);let l=hD(e);e=pD(e,1,l),s=pD(s,1,l),!n&&0===e[0]&&(e.push(r),s.push(s[0])),a.push(new SD(".morphTargetInfluences["+t[o].name+"]",e,s).scale(1/i))}return new this(e,-1,a)}static findByName(e,t){let i=e;if(!Array.isArray(e)){let t=e;i=t.geometry&&t.geometry.animations||t.animations}for(let n=0;n<i.length;n++)if(i[n].name===t)return i[n];return null}static CreateClipsFromMorphTargetSequences(e,t,i){let n={},r=/^([\w-]*?)([\d]+)$/;for(let o=0,s=e.length;o<s;o++){let t=e[o],i=t.name.match(r);if(i&&i.length>1){let e=i[1],r=n[e];r||(n[e]=r=[]),r.push(t)}}let a=[];for(let o in n)a.push(this.CreateFromMorphTargetSequence(o,n[o],t,i));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let i=function(e,t,i,n,r){if(0!==i.length){let a=[],o=[];fD(i,a,o,n),0!==a.length&&r.push(new e(t,a,o))}},n=[],r=e.name||"default",a=e.fps||30,o=e.blendMode,s=e.length||-1,l=e.hierarchy||[];for(let c=0;c<l.length;c++){let e=l[c].keys;if(e&&0!==e.length)if(e[0].morphTargets){let t,i={};for(t=0;t<e.length;t++)if(e[t].morphTargets)for(let n=0;n<e[t].morphTargets.length;n++)i[e[t].morphTargets[n]]=-1;for(let r in i){let i=[],a=[];for(let n=0;n!==e[t].morphTargets.length;++n){let n=e[t];i.push(n.time),a.push(n.morphTarget===r?1:0)}n.push(new SD(".morphTargetInfluence["+r+"]",i,a))}s=i.length*a}else{let r=".bones["+t[c].name+"]";i(AD,r+".position",e,"pos",n),i(CD,r+".quaternion",e,"rot",n),i(AD,r+".scale",e,"scl",n)}}return 0===n.length?null:new this(r,s,n,o)}resetDuration(){let e=0;for(let t=0,i=this.tracks.length;t!==i;++t){let i=this.tracks[t];e=Math.max(e,i.times[i.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function TD(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return SD;case"vector":case"vector2":case"vector3":case"vector4":return AD;case"color":return wD;case"quaternion":return CD;case"bool":case"boolean":return xD;case"string":return ED}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){let t=[],i=[];fD(e.keys,t,i,"value"),e.times=t,e.values=i}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var PD={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},DD=class{constructor(e,t,i){let n,r=this,a=!1,o=0,s=0,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(e){s++,!1===a&&void 0!==r.onStart&&r.onStart(e,o,s),a=!0},this.itemEnd=function(e){o++,void 0!==r.onProgress&&r.onProgress(e,o,s),o===s&&(a=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return n?n(e):e},this.setURLModifier=function(e){return n=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){let t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,i=l.length;t<i;t+=2){let i=l[t],n=l[t+1];if(i.global&&(i.lastIndex=0),i.test(e))return n}return null}}},OD=new DD,ID=class{constructor(e){this.manager=void 0!==e?e:OD,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let i=this;return new Promise(function(n,r){i.load(e,n,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},kD={},RD=class extends Error{constructor(e,t){super(e),this.response=t}},zD=class extends ID{constructor(e){super(e)}load(e,t,i,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let r=PD.get(e);if(void 0!==r)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(void 0!==kD[e])return void kD[e].push({onLoad:t,onProgress:i,onError:n});kD[e]=[],kD[e].push({onLoad:t,onProgress:i,onError:n});let a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,s=this.responseType;fetch(a).then(t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===t.body||void 0===t.body.getReader)return t;let i=kD[e],n=t.body.getReader(),r=t.headers.get("Content-Length")||t.headers.get("X-File-Size"),a=r?parseInt(r):0,o=0!==a,s=0,l=new ReadableStream({start(e){!function t(){n.read().then(n=>{let{done:r,value:l}=n;if(r)e.close();else{s+=l.byteLength;let n=new ProgressEvent("progress",{lengthComputable:o,loaded:s,total:a});for(let e=0,t=i.length;e<t;e++){let t=i[e];t.onProgress&&t.onProgress(n)}e.enqueue(l),t()}})}()}});return new Response(l)}throw new RD('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)}).then(e=>{switch(s){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then(e=>(new DOMParser).parseFromString(e,o));case"json":return e.json();default:if(void 0===o)return e.text();{let t=/charset="?([^;"\s]*)"?/i.exec(o),i=t&&t[1]?t[1].toLowerCase():void 0,n=new TextDecoder(i);return e.arrayBuffer().then(e=>n.decode(e))}}}).then(t=>{PD.add(e,t);let i=kD[e];delete kD[e];for(let e=0,n=i.length;e<n;e++){let n=i[e];n.onLoad&&n.onLoad(t)}}).catch(t=>{let i=kD[e];if(void 0===i)throw this.manager.itemError(e),t;delete kD[e];for(let e=0,n=i.length;e<n;e++){let n=i[e];n.onError&&n.onError(t)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},LD=class extends ID{constructor(e){super(e)}load(e,t,i,n){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let r=this,a=PD.get(e);if(void 0!==a)return r.manager.itemStart(e),setTimeout(function(){t&&t(a),r.manager.itemEnd(e)},0),a;let o=b_("img");function s(){c(),PD.add(e,this),t&&t(this),r.manager.itemEnd(e)}function l(t){c(),n&&n(t),r.manager.itemError(e),r.manager.itemEnd(e)}function c(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(e),o.src=e,o}},BD=class extends ID{constructor(e){super(e)}load(e,t,i,n){let r=new L_,a=new LD(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(e){r.image=e,r.needsUpdate=!0,void 0!==t&&t(r)},i,n),r}},ND=class extends WC{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new D_(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}},FD=class extends ND{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(WC.DEFAULT_UP),this.updateMatrix(),this.groundColor=new D_(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},UD=new yC,VD=new j_,jD=new j_,WD=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new p_(512,512),this.map=null,this.mapPass=null,this.matrix=new yC,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ZE,this._frameExtents=new p_(1,1),this._viewportCount=1,this._viewports=[new B_(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,i=this.matrix;VD.setFromMatrixPosition(e.matrixWorld),t.position.copy(VD),jD.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(jD),t.updateMatrixWorld(),UD.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(UD),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(UD)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){let e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},HD=class extends WD{constructor(){super(new UE(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,i=2*i_*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(i!==t.fov||n!==t.aspect||r!==t.far)&&(t.fov=i,t.aspect=n,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},GD=class extends ND{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(WC.DEFAULT_UP),this.updateMatrix(),this.target=new WC,this.distance=i,this.angle=n,this.penumbra=r,this.decay=a,this.map=null,this.shadow=new HD}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},qD=new yC,XD=new j_,YD=new j_,QD=class extends WD{constructor(){super(new UE(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new p_(4,2),this._viewportCount=6,this._viewports=[new B_(2,1,1,1),new B_(0,1,1,1),new B_(3,1,1,1),new B_(1,1,1,1),new B_(3,0,1,1),new B_(1,0,1,1)],this._cubeDirections=[new j_(1,0,0),new j_(-1,0,0),new j_(0,0,1),new j_(0,0,-1),new j_(0,1,0),new j_(0,-1,0)],this._cubeUps=[new j_(0,1,0),new j_(0,1,0),new j_(0,1,0),new j_(0,1,0),new j_(0,0,1),new j_(0,0,-1)]}updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.camera,n=this.matrix,r=e.distance||i.far;r!==i.far&&(i.far=r,i.updateProjectionMatrix()),XD.setFromMatrixPosition(e.matrixWorld),i.position.copy(XD),YD.copy(i.position),YD.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(YD),i.updateMatrixWorld(),n.makeTranslation(-XD.x,-XD.y,-XD.z),qD.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(qD)}},KD=class extends ND{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=n,this.shadow=new QD}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},ZD=class extends WD{constructor(){super(new uA(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},JD=class extends ND{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(WC.DEFAULT_UP),this.updateMatrix(),this.target=new WC,this.shadow=new ZD}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},$D=class extends vE{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},eO=class extends ID{constructor(e){super(e)}load(e,t,i,n){let r=this,a=new zD(r.manager);a.setPath(r.path),a.setRequestHeader(r.requestHeader),a.setWithCredentials(r.withCredentials),a.load(e,function(i){try{t(r.parse(JSON.parse(i)))}catch(a){n?n(a):console.error(a),r.manager.itemError(e)}},i,n)}parse(e){let t={},i={};function n(e,n){if(void 0!==t[n])return t[n];let r=e.interleavedBuffers[n],a=function(e,t){if(void 0!==i[t])return i[t];let n=e.arrayBuffers[t],r=new Uint32Array(n).buffer;return i[t]=r,r}(e,r.buffer),o=y_(r.type,a),s=new IT(o,r.stride);return s.uuid=r.uuid,t[n]=s,s}let r=e.isInstancedBufferGeometry?new $D:new vE,a=e.data.index;if(void 0!==a){let e=y_(a.type,a.array);r.setIndex(new oE(e,1))}let o=e.data.attributes;for(let d in o){let t,i=o[d];if(i.isInterleavedBufferAttribute){let r=n(e.data,i.data);t=new RT(r,i.itemSize,i.offset,i.normalized)}else{let e=y_(i.type,i.array);t=new(i.isInstancedBufferAttribute?UT:oE)(e,i.itemSize,i.normalized)}void 0!==i.name&&(t.name=i.name),void 0!==i.usage&&t.setUsage(i.usage),void 0!==i.updateRange&&(t.updateRange.offset=i.updateRange.offset,t.updateRange.count=i.updateRange.count),r.setAttribute(d,t)}let s=e.data.morphAttributes;if(s)for(let d in s){let t=s[d],i=[];for(let r=0,a=t.length;r<a;r++){let a,o=t[r];if(o.isInterleavedBufferAttribute){let t=n(e.data,o.data);a=new RT(t,o.itemSize,o.offset,o.normalized)}else{let e=y_(o.type,o.array);a=new oE(e,o.itemSize,o.normalized)}void 0!==o.name&&(a.name=o.name),i.push(a)}r.morphAttributes[d]=i}e.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);let l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let d=0,u=l.length;d!==u;++d){let e=l[d];r.addGroup(e.start,e.count,e.materialIndex)}let c=e.data.boundingSphere;if(void 0!==c){let e=new j_;void 0!==c.center&&e.fromArray(c.center),r.boundingSphere=new cC(e,c.radius)}return e.name&&(r.name=e.name),e.userData&&(r.userData=e.userData),r}},tO=class{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=iO(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=iO();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function iO(){return(typeof performance>"u"?Date:performance).now()}var nO=class{constructor(e,t,i){let n,r,a;switch(this.binding=e,this.valueSize=i,t){case"quaternion":n=this._slerp,r=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":n=this._select,r=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:n=this._lerp,r=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=r,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let i=this.buffer,n=this.valueSize,r=e*n+n,a=this.cumulativeWeight;if(0===a){for(let e=0;e!==n;++e)i[r+e]=i[e];a=t}else{a+=t;let e=t/a;this._mixBufferRegion(i,r,0,e,n)}this.cumulativeWeight=a}accumulateAdditive(e){let t=this.buffer,i=this.valueSize,n=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,n,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,i=this.buffer,n=e*t+t,r=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){let e=t*this._origIndex;this._mixBufferRegion(i,n,e,1-r,t)}a>0&&this._mixBufferRegionAdditive(i,n,this._addIndex*t,1,t);for(let s=t,l=t+t;s!==l;++s)if(i[s]!==i[s+t]){o.setValue(i,n);break}}saveOriginalState(){let e=this.binding,t=this.buffer,i=this.valueSize,n=i*this._origIndex;e.getValue(t,n);for(let r=i,a=n;r!==a;++r)t[r]=t[n+r%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,n,r){if(n>=.5)for(let a=0;a!==r;++a)e[t+a]=e[i+a]}_slerp(e,t,i,n){V_.slerpFlat(e,t,e,t,e,i,n)}_slerpAdditive(e,t,i,n,r){let a=this._workIndex*r;V_.multiplyQuaternionsFlat(e,a,e,t,e,i),V_.slerpFlat(e,t,e,t,e,a,n)}_lerp(e,t,i,n,r){let a=1-n;for(let o=0;o!==r;++o){let r=t+o;e[r]=e[r]*a+e[i+o]*n}}_lerpAdditive(e,t,i,n,r){for(let a=0;a!==r;++a){let r=t+a;e[r]=e[r]+e[i+a]*n}}},rO="\\[\\]\\.:\\/",aO=new RegExp("["+rO+"]","g"),oO="[^"+rO+"]",sO="[^"+rO.replace("\\.","")+"]",lO=/((?:WC+[\/:])*)/.source.replace("WC",oO),cO=/(WCOD+)?/.source.replace("WCOD",sO),dO=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",oO),uO=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",oO),hO=new RegExp("^"+lO+cO+dO+uO+"$"),pO=["material","materials","bones","map"],fO=class{constructor(e,t,i){this.path=t,this.parsedPath=i||fO.parseTrackName(t),this.node=fO.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new fO.Composite(e,t,i):new fO(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(aO,"")}static parseTrackName(e){let t=hO.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){let e=i.nodeName.substring(n+1);-1!==pO.indexOf(e)&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=e)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){let i=e.skeleton.getBoneByName(t);if(void 0!==i)return i}if(e.children){let i=function(e){for(let n=0;n<e.length;n++){let r=e[n];if(r.name===t||r.uuid===t)return r;let a=i(r.children);if(a)return a}return null},n=i(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)e[t++]=i[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,i=t.objectName,n=t.propertyName,r=t.propertyIndex;if(e||(e=fO.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(i){let n=t.objectIndex;switch(i){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===n){n=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[i]}if(void 0!==n){if(void 0===e[n])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[n]}}let a=e[n];if(void 0===a){let i=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i+"."+n+" but it wasn't found.",e)}let o=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}s=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=r}else void 0!==a.fromArray&&void 0!==a.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(s=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=n;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};fO.Composite=class{constructor(e,t,i){let n=i||fO.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}getValue(e,t){this.bind();let i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(e,t)}setValue(e,t){let i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}},fO.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},fO.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},fO.prototype.GetterByBindingType=[fO.prototype._getValue_direct,fO.prototype._getValue_array,fO.prototype._getValue_arrayElement,fO.prototype._getValue_toArray],fO.prototype.SetterByBindingTypeAndVersioning=[[fO.prototype._setValue_direct,fO.prototype._setValue_direct_setNeedsUpdate,fO.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[fO.prototype._setValue_array,fO.prototype._setValue_array_setNeedsUpdate,fO.prototype._setValue_array_setMatrixWorldNeedsUpdate],[fO.prototype._setValue_arrayElement,fO.prototype._setValue_arrayElement_setNeedsUpdate,fO.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[fO.prototype._setValue_fromArray,fO.prototype._setValue_fromArray_setNeedsUpdate,fO.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var mO=class{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.blendMode;this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=n;let r=t.tracks,a=r.length,o=new Array(a),s={endingStart:FS,endingEnd:FS};for(let l=0;l!==a;++l){let e=r[l].createInterpolant(null);o[l]=e,e.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){let i=this._clip.duration,n=e._clip.duration,r=n/i,a=i/n;e.warp(1,r,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){let e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){let n=this._mixer,r=n.time,a=this.timeScale,o=this._timeScaleInterpolant;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);let s=o.parameterPositions,l=o.sampleValues;return s[0]=r,s[1]=r+i,l[0]=e/a,l[1]=t/a,this}stopWarping(){let e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,n){if(!this.enabled)return void this._updateWeight(e);let r=this._startTime;if(null!==r){let n=(e-r)*i;n<0||0===i?t=0:(this._startTime=null,t=i*n)}t*=this._updateTimeScale(e);let a=this._updateTime(t),o=this._updateWeight(e);if(o>0){let e=this._interpolants,t=this._propertyBindings;if(2501===this.blendMode)for(let i=0,n=e.length;i!==n;++i)e[i].evaluate(a),t[i].accumulateAdditive(o);else for(let i=0,r=e.length;i!==r;++i)e[i].evaluate(a),t[i].accumulate(n,o)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let i=this._weightInterpolant;if(null!==i){let n=i.evaluate(e)[0];t*=n,e>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let i=this._timeScaleInterpolant;if(null!==i){t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,i=this.loop,n=this.time+e,r=this._loopCount,a=i===zS;if(0===e)return-1===r?n:a&&1===(1&r)?t-n:n;if(2200===i){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else{if(!(n<0)){this.time=n;break e}n=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),n>=t||n<0){let i=Math.floor(n/t);n-=t*i,r+=Math.abs(i);let o=this.repetitions-r;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=e>0?t:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){let t=e<0;this._setEndings(t,!t,a)}else this._setEndings(!1,!1,a);this._loopCount=r,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:i})}}else this.time=n;if(a&&1===(1&r))return t-n}return n}_setEndings(e,t,i){let n=this._interpolantSettings;i?(n.endingStart=US,n.endingEnd=US):(n.endingStart=e?this.zeroSlopeAtStart?US:FS:VS,n.endingEnd=t?this.zeroSlopeAtEnd?US:FS:VS)}_scheduleFading(e,t,i){let n=this._mixer,r=n.time,a=this._weightInterpolant;null===a&&(a=n._lendControlInterpolant(),this._weightInterpolant=a);let o=a.parameterPositions,s=a.sampleValues;return o[0]=r,s[0]=t,o[1]=r+e,s[1]=i,this}},gO=new Float32Array(1),vO=class extends JS{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let i=e._localRoot||this._root,n=e._clip.tracks,r=n.length,a=e._propertyBindings,o=e._interpolants,s=i.uuid,l=this._bindingsByRootAndName,c=l[s];void 0===c&&(c={},l[s]=c);for(let d=0;d!==r;++d){let e=n[d],r=e.name,l=c[r];if(void 0!==l)++l.referenceCount,a[d]=l;else{if(l=a[d],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,s,r));continue}let n=t&&t._propertyBindings[d].binding.parsedPath;l=new nO(fO.create(i,r,n),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,s,r),a[d]=l}o[d].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){let t=(e._localRoot||this._root).uuid,i=e._clip.uuid,n=this._actionsByClip[i];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,i,t)}let t=e._propertyBindings;for(let e=0,i=t.length;e!==i;++e){let i=t[e];0===i.useCount++&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let e=0,i=t.length;e!==i;++e){let i=t[e];0===--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,i){let n=this._actions,r=this._actionsByClip,a=r[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=a;else{let t=a.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=n.length,n.push(e),a.actionByRoot[i]=e}_removeInactiveAction(e){let t=this._actions,i=t[t.length-1],n=e._cacheIndex;i._cacheIndex=n,t[n]=i,t.pop(),e._cacheIndex=null;let r=e._clip.uuid,a=this._actionsByClip,o=a[r],s=o.knownActions,l=s[s.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let i=0,n=t.length;i!==n;++i){let e=t[i];0===--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){let t=this._actions,i=e._cacheIndex,n=this._nActiveActions++,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r}_takeBackAction(e){let t=this._actions,i=e._cacheIndex,n=--this._nActiveActions,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r}_addInactiveBinding(e,t,i){let n=this._bindingsByRootAndName,r=this._bindings,a=n[t];void 0===a&&(a={},n[t]=a),a[i]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){let t=this._bindings,i=e.binding,n=i.rootNode.uuid,r=i.path,a=this._bindingsByRootAndName,o=a[n],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete o[r],0===Object.keys(o).length&&delete a[n]}_lendBinding(e){let t=this._bindings,i=e._cacheIndex,n=this._nActiveBindings++,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r}_takeBackBinding(e){let t=this._bindings,i=e._cacheIndex,n=--this._nActiveBindings,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,i=e[t];return void 0===i&&(i=new vD(new Float32Array(2),new Float32Array(2),1,gO),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){let t=this._controlInterpolants,i=e.__cacheIndex,n=--this._nActiveControlInterpolants,r=t[n];e.__cacheIndex=n,t[n]=e,r.__cacheIndex=i,t[i]=r}clipAction(e,t,i){let n=t||this._root,r=n.uuid,a="string"==typeof e?MD.findByName(n,e):e,o=null!==a?a.uuid:e,s=this._actionsByClip[o],l=null;if(void 0===i&&(i=null!==a?a.blendMode:jS),void 0!==s){let e=s.actionByRoot[r];if(void 0!==e&&e.blendMode===i)return e;l=s.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;let c=new mO(this,a,t,i);return this._bindAction(c,l),this._addInactiveAction(c,o,r),c}existingAction(e,t){let i=t||this._root,n=i.uuid,r="string"==typeof e?MD.findByName(i,e):e,a=r?r.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[n]||null}stopAllAction(){let e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;let t=this._actions,i=this._nActiveActions,n=this.time+=e,r=Math.sign(e),a=this._accuIndex^=1;for(let l=0;l!==i;++l)t[l]._update(n,e,r,a);let o=this._bindings,s=this._nActiveBindings;for(let l=0;l!==s;++l)o[l].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,i=e.uuid,n=this._actionsByClip,r=n[i];if(void 0!==r){let e=r.knownActions;for(let i=0,n=e.length;i!==n;++i){let n=e[i];this._deactivateAction(n);let r=n._cacheIndex,a=t[t.length-1];n._cacheIndex=null,n._byClipCacheIndex=null,a._cacheIndex=r,t[r]=a,t.pop(),this._removeInactiveBindingsForAction(n)}delete n[i]}}uncacheRoot(e){let t=e.uuid,i=this._actionsByClip;for(let r in i){let e=i[r].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}let n=this._bindingsByRootAndName[t];if(void 0!==n)for(let r in n){let e=n[r];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){let i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}},yO=class{constructor(e){this.value=e}clone(){return new yO(void 0===this.value.clone?this.value:this.value.clone())}},bO=class{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new vC(e,t),this.near=i,this.far=n,this.camera=null,this.layers=new PC,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return wO(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort(xO),t}intersectObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let n=0,r=e.length;n<r;n++)wO(e[n],this,i,t);return i.sort(xO),i}};function xO(e,t){return e.distance-t.distance}function wO(e,t,i,n){if(e.layers.test(t.layers)&&e.raycast(t,i),!0===n){let n=e.children;for(let e=0,r=n.length;e<r;e++)wO(n[e],t,i,!0)}}var SO=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(r_(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}},_O=new p_,CO=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new p_(1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new p_(-1/0,-1/0);this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=_O.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return _O.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},EO=new j_,AO=new j_,MO=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new j_,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new j_;this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){EO.subVectors(e,this.start),AO.subVectors(this.end,this.start);let i=AO.dot(AO),n=AO.dot(EO)/i;return t&&(n=r_(n,0,1)),n}closestPointToPoint(e,t,i){let n=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(n).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},TO=new j_,PO=class extends WC{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let i=new vE,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,s=32;a<s;a++,o++){let e=a/s*Math.PI*2,t=o/s*Math.PI*2;n.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}i.setAttribute("position",new cE(n,3));let r=new XT({fog:!1,toneMapped:!1});this.cone=new iP(i,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),TO.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(TO),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},DO=class extends OE{constructor(e,t,i){super(new aD(t,4,2),new nE({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},OO=new j_,IO=new j_,kO=new j_,RO=class extends WC{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",void 0===t&&(t=1);let n=new vE;n.setAttribute("position",new cE([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let r=new XT({fog:!1,toneMapped:!1});this.lightPlane=new $T(n,r),this.add(this.lightPlane),n=new vE,n.setAttribute("position",new cE([0,0,0,0,0,1],3)),this.targetLine=new $T(n,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),OO.setFromMatrixPosition(this.light.matrixWorld),IO.setFromMatrixPosition(this.light.target.matrixWorld),kO.subVectors(IO,OO),this.lightPlane.lookAt(IO),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(IO),this.targetLine.scale.z=kO.length()}},zO=new j_,LO=new FE,BO=class extends iP{constructor(e){let t=new vE,i=new XT({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],r=[],a={};function o(e,t){s(e),s(t)}function s(e){n.push(0,0,0),r.push(0,0,0),void 0===a[e]&&(a[e]=[]),a[e].push(n.length/3-1)}o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4"),t.setAttribute("position",new cE(n,3)),t.setAttribute("color",new cE(r,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();let l=new D_(16755200),c=new D_(16711680),d=new D_(43775),u=new D_(16777215),h=new D_(3355443);this.setColors(l,c,d,u,h)}setColors(e,t,i,n,r){let a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,n.r,n.g,n.b),a.setXYZ(39,n.r,n.g,n.b),a.setXYZ(40,r.r,r.g,r.b),a.setXYZ(41,r.r,r.g,r.b),a.setXYZ(42,r.r,r.g,r.b),a.setXYZ(43,r.r,r.g,r.b),a.setXYZ(44,r.r,r.g,r.b),a.setXYZ(45,r.r,r.g,r.b),a.setXYZ(46,r.r,r.g,r.b),a.setXYZ(47,r.r,r.g,r.b),a.setXYZ(48,r.r,r.g,r.b),a.setXYZ(49,r.r,r.g,r.b),a.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap;LO.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),NO("c",t,e,LO,0,0,-1),NO("t",t,e,LO,0,0,1),NO("n1",t,e,LO,-1,-1,-1),NO("n2",t,e,LO,1,-1,-1),NO("n3",t,e,LO,-1,1,-1),NO("n4",t,e,LO,1,1,-1),NO("f1",t,e,LO,-1,-1,1),NO("f2",t,e,LO,1,-1,1),NO("f3",t,e,LO,-1,1,1),NO("f4",t,e,LO,1,1,1),NO("u1",t,e,LO,.7,1.1,-1),NO("u2",t,e,LO,-.7,1.1,-1),NO("u3",t,e,LO,0,2,-1),NO("cf1",t,e,LO,-1,0,1),NO("cf2",t,e,LO,1,0,1),NO("cf3",t,e,LO,0,-1,1),NO("cf4",t,e,LO,0,1,1),NO("cn1",t,e,LO,-1,0,-1),NO("cn2",t,e,LO,1,0,-1),NO("cn3",t,e,LO,0,-1,-1),NO("cn4",t,e,LO,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function NO(e,t,i,n,r,a,o){zO.set(r,a,o).unproject(n);let s=t[e];if(void 0!==s){let e=i.getAttribute("position");for(let t=0,i=s.length;t<i;t++)e.setXYZ(s[t],zO.x,zO.y,zO.z)}}var FO=class extends iP{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960,i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new vE;n.setIndex(new oE(i,1)),n.setAttribute("position",new cE([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(n,new XT({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},UO=class extends iP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=new vE;i.setAttribute("position",new cE(t,3)),i.setAttribute("color",new cE([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(i,new XT({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,i){let n=new D_,r=this.geometry.attributes.color.array;return n.set(e),n.toArray(r,0),n.toArray(r,3),n.set(t),n.toArray(r,6),n.toArray(r,9),n.set(i),n.toArray(r,12),n.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},VO=function(){let e=new ArrayBuffer(4),t=new Float32Array(e),i=new Uint32Array(e),n=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){let e=l-127;e<-27?(n[l]=0,n[256|l]=32768,r[l]=24,r[256|l]=24):e<-14?(n[l]=1024>>-e-14,n[256|l]=1024>>-e-14|32768,r[l]=-e-1,r[256|l]=-e-1):e<=15?(n[l]=e+15<<10,n[256|l]=e+15<<10|32768,r[l]=13,r[256|l]=13):e<128?(n[l]=31744,n[256|l]=64512,r[l]=24,r[256|l]=24):(n[l]=31744,n[256|l]=64512,r[l]=13,r[256|l]=13)}let a=new Uint32Array(2048),o=new Uint32Array(64),s=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;0===(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,a[l]=e|t}for(let l=1024;l<2048;++l)a[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(s[l]=1024);return{floatView:t,uint32View:i,baseTable:n,shiftTable:r,mantissaTable:a,exponentTable:o,offsetTable:s}}();var jO=Object.freeze({__proto__:null,fromHalfFloat:function(e){let t=e>>10;return VO.uint32View[0]=VO.mantissaTable[VO.offsetTable[t]+(1023&e)]+VO.exponentTable[t],VO.floatView[0]},toHalfFloat:function(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=r_(e,-65504,65504),VO.floatView[0]=e;let t=VO.uint32View[0],i=t>>23&511;return VO.baseTable[i]+((8388607&t)>>VO.shiftTable[i])}});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Uw}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Uw);var WO=".",HO=Symbol("target"),GO=Symbol("unsubscribe");function qO(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}var XO=Array.isArray;function YO(e){return"symbol"==typeof e}var QO={after:(e,t)=>XO(e)?e.slice(t.length):""===t?e:e.slice(t.length+1),concat:(e,t)=>XO(e)?(e=[...e],t&&e.push(t),e):t&&void 0!==t.toString?(""!==e&&(e+=WO),YO(t)?e+t.toString():e+t):e,initial:e=>{if(XO(e))return e.slice(0,-1);if(""===e)return e;let t=e.lastIndexOf(WO);return-1===t?"":e.slice(0,t)},last:e=>{if(XO(e))return e[e.length-1]||"";if(""===e)return e;let t=e.lastIndexOf(WO);return-1===t?e:e.slice(t+1)},walk:(e,t)=>{if(XO(e))for(let i of e)t(i);else if(""!==e){let i=0,n=e.indexOf(WO);if(-1===n)t(e);else for(;i<e.length;)-1===n&&(n=e.length),t(e.slice(i,n)),i=n+1,n=e.indexOf(WO,i)}},get(e,t){return this.walk(t,t=>{e&&(e=e[t])}),e}},KO=QO;function ZO(e,t,i){return e.isUnsubscribed||t.ignoreSymbols&&YO(i)||t.ignoreUnderscores&&"_"===i.charAt(0)||"ignoreKeys"in t&&t.ignoreKeys.includes(i)}var JO=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return void 0===this._descriptorCache&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),i=t.get(e);return void 0===i&&(i={},t.set(e,i)),i}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let i=this._getProperties(e),n=i[t];return void 0===n&&(n=Reflect.getOwnPropertyDescriptor(e,t),i[t]=n),n}getProxy(e,t,i,n){if(this.isUnsubscribed)return e;let r=e[n],a=r||e;this._pathCache.set(a,t);let o=this._proxyCache.get(a);return void 0===o&&(o=void 0===r?new Proxy(e,i):e,this._proxyCache.set(a,o)),o}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,KO.get(t,this.getPath(e)))}defineProperty(e,t,i){return!!Reflect.defineProperty(e,t,i)&&(this.isUnsubscribed||(this._getProperties(e)[t]=i),!0)}setProperty(e,t,i,n,r){if(!this._equals(r,i)||!(t in e)){let r=this._getOwnPropertyDescriptor(e,t);return void 0!==r&&"set"in r?Reflect.set(e,t,i,n):Reflect.set(e,t,i)}return!0}deleteProperty(e,t,i){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let n=this._getDescriptorCache().get(e);n&&(delete n[t],this._pathCache.delete(i))}return!0}return!1}isSameDescriptor(e,t,i){let n=this._getOwnPropertyDescriptor(t,i);return void 0!==e&&void 0!==n&&Object.is(e.value,n.value)&&(e.writable||!1)===(n.writable||!1)&&(e.enumerable||!1)===(n.enumerable||!1)&&(e.configurable||!1)===(n.configurable||!1)&&e.get===n.get&&e.set===n.set}isGetInvariant(e,t){let i=this._getOwnPropertyDescriptor(e,t);return void 0!==i&&!0!==i.configurable&&!0!==i.writable}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function $O(e){return"[object Object]"===toString.call(e)}function eI(){return!0}function tI(e,t){return e.length!==t.length||e.some((e,i)=>t[i]!==e)}var iI=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),nI=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),rI={push:eI,pop:eI,shift:eI,unshift:eI,copyWithin:tI,reverse:tI,sort:tI,splice:tI,flat:tI,fill:tI},aI=new Set([...iI,...nI,...Object.keys(rI)]);function oI(e,t){if(e.size!==t.size)return!0;for(let i of e)if(!t.has(i))return!0;return!1}var sI=["keys","values","entries"],lI=new Set(["has","toString"]),cI={add:oI,clear:oI,delete:oI,forEach:oI},dI=new Set([...lI,...Object.keys(cI),...sI]);function uI(e,t){if(e.size!==t.size)return!0;let i;for(let[n,r]of e)if(i=t.get(n),i!==r||void 0===i&&!t.has(n))return!0;return!1}var hI=new Set([...lI,"get"]),pI={set:uI,clear:uI,delete:uI,forEach:uI},fI=new Set([...hI,...Object.keys(pI),...sI]),mI=class{constructor(e,t,i,n){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=n,this._changes=n?[]:null,this.clone=void 0===t?e:this._shallowClone(e)}static isHandledMethod(e){return iI.has(e)}_shallowClone(e){let t=e;if($O(e))t=c({},e);else if(XO(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map(e=>this._shallowClone(e)));else if(e instanceof Map){t=new Map;for(let[i,n]of e.entries())t.set(i,this._shallowClone(n))}return this._clonedCache.add(t),t}preferredThisArg(e,t,i,n){return e?(XO(n)?this._onIsChanged=rI[t]:n instanceof Set?this._onIsChanged=cI[t]:n instanceof Map&&(this._onIsChanged=pI[t]),n):i}update(e,t,i){let n=KO.after(e,this._path);if("length"!==t){let e=this.clone;KO.walk(n,t=>{e&&e[t]&&(this._clonedCache.has(e[t])||(e[t]=this._shallowClone(e[t])),e=e[t])}),this._hasOnValidate&&this._changes.push({path:n,property:t,previous:i}),e&&e[t]&&(e[t]=i)}this._isChanged=!0}undo(e){let t;for(let i=this._changes.length-1;-1!==i;i--)t=this._changes[i],KO.get(e,t.path)[t.property]=t.previous}isChanged(e){return void 0===this._onIsChanged?this._isChanged:this._onIsChanged(this.clone,e)}},gI=class extends mI{static isHandledMethod(e){return aI.has(e)}},vI=class extends mI{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},yI=class extends mI{static isHandledMethod(e){return dI.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},bI=class extends mI{static isHandledMethod(e){return fI.has(e)}undo(e){for(let[t,i]of this.clone.entries())e.set(t,i);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},xI=class extends mI{constructor(e,t,i,n){super(void 0,t,i,n),this._arg1=i[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},wI=class extends mI{constructor(e,t,i,n){super(void 0,t,i,n),this._weakKey=i[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},SI=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return $O(e)||XO(e)||qO(e)}static isHandledMethod(e,t){return $O(e)?mI.isHandledMethod(t):XO(e)?gI.isHandledMethod(t):e instanceof Set?yI.isHandledMethod(t):e instanceof Map?bI.isHandledMethod(t):qO(e)}get isCloning(){return this._stack.length>0}start(e,t,i){let n=mI;XO(e)?n=gI:e instanceof Date?n=vI:e instanceof Set?n=yI:e instanceof Map?n=bI:e instanceof WeakSet?n=xI:e instanceof WeakMap&&(n=wI),this._stack.push(new n(e,t,i,this._hasOnValidate))}update(e,t,i){this._stack[this._stack.length-1].update(e,t,i)}preferredThisArg(e,t,i){let{name:n}=e,r=SI.isHandledMethod(i,n);return this._stack[this._stack.length-1].preferredThisArg(r,n,t,i)}isChanged(e,t,i){return this._stack[this._stack.length-1].isChanged(e,t,i)}undo(e){void 0!==this._previousClone&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},_I={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},CI=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i=c(c({},_I),i);let n=Symbol("ProxyTarget"),{equals:r,isShallow:a,ignoreDetached:o,details:s}=i,l=new JO(r),d="function"==typeof i.onValidate,u=new SI(d),h=(e,t,n,r,a)=>!d||u.isCloning||!0===i.onValidate(KO.concat(l.getPath(e),t),n,r,a),p=(t,n,r,a)=>{!ZO(l,i,n)&&(!o||!l.isDetached(t,e))&&f(l.getPath(t),n,r,a)},f=(e,i,n,r,a)=>{u.isCloning?u.update(e,i,r):t(KO.concat(e,i),n,r,a)},m=e=>e&&(e[n]||e),g=(t,r,s,c)=>function(e){return("object"==typeof e?null===e:"function"!=typeof e)||e instanceof RegExp}(t)||"constructor"===s||a&&!SI.isHandledMethod(r,s)||ZO(l,i,s)||l.isGetInvariant(r,s)||o&&l.isDetached(r,e)?t:(void 0===c&&(c=l.getPath(r)),l.getProxy(t,KO.concat(c,s),v,n)),v={get(e,t,i){if(YO(t)){if(t===n||t===HO)return e;if(t===GO&&!l.isUnsubscribed&&0===l.getPath(e).length)return l.unsubscribe(),e}let r=qO(e)?Reflect.get(e,t):Reflect.get(e,t,i);return g(r,e,t)},set(e,t,i,a){i=m(i);let o=e[n]||e,s=o[t];if(r(s,i)&&t in e)return!0;let c=h(e,t,i,s);return c&&l.setProperty(o,t,i,a,s)?(p(e,t,e[t],s),!0):!c},defineProperty(e,t,i){if(!l.isSameDescriptor(i,e,t)){let n=e[t];h(e,t,i.value,n)&&l.defineProperty(e,t,i,n)&&p(e,t,i.value,n)}return!0},deleteProperty(e,t){if(!Reflect.has(e,t))return!0;let i=Reflect.get(e,t),n=h(e,t,void 0,i);return n&&l.deleteProperty(e,t,i)?(p(e,t,void 0,i),!0):!n},apply(t,i,a){let o=i[n]||i;if(l.isUnsubscribed)return Reflect.apply(t,o,a);if((!1===s||!0!==s&&!s.includes(t.name))&&SI.isHandledType(o)){let n=KO.initial(l.getPath(t)),s=SI.isHandledMethod(o,t.name);u.start(o,n,a);let c=Reflect.apply(t,u.preferredThisArg(t,i,o),s?a.map(e=>m(e)):a),d=u.isChanged(o,r),p=u.stop();if(SI.isHandledType(c)&&s&&(i instanceof Map&&"get"===t.name&&(n=KO.concat(n,a[0])),c=l.getProxy(c,n,v)),d){let i={name:t.name,args:a,result:c},r=u.isCloning?KO.initial(n):n,s=u.isCloning?KO.last(n):"";h(KO.get(e,r),s,o,p,i)?f(r,s,o,p,i):u.undo(o)}return(i instanceof Map||i instanceof Set)&&function(e){return"object"==typeof e&&"function"==typeof e.next}(c)?function(e,t,i,n,r){let a=e.next;if("entries"===t.name)e.next=function(){let e=a.call(this);return!1===e.done&&(e.value[0]=r(e.value[0],t,e.value[0],n),e.value[1]=r(e.value[1],t,e.value[0],n)),e};else if("values"===t.name){let o=i[HO].keys();e.next=function(){let e=a.call(this);return!1===e.done&&(e.value=r(e.value,t,o.next().value,n)),e}}else e.next=function(){let e=a.call(this);return!1===e.done&&(e.value=r(e.value,t,e.value,n)),e};return e}(c,t,i,n,g):c}return Reflect.apply(t,i,a)}},y=l.getProxy(e,i.pathAsArray?[]:"",v);return t=t.bind(y),d&&(i.onValidate=i.onValidate.bind(y)),y};CI.target=e=>e&&e[HO]||e,CI.unsubscribe=e=>e[GO]||e;var EI=CI,AI="object"==typeof global&&global&&global.Object===Object&&global,MI="object"==typeof self&&self&&self.Object===Object&&self,TI=AI||MI||Function("return this")(),PI=TI.Symbol,DI=Object.prototype,OI=DI.hasOwnProperty,II=DI.toString,kI=PI?PI.toStringTag:void 0;var RI=function(e){var t=OI.call(e,kI),i=e[kI];try{e[kI]=void 0;var n=!0}catch(Ane){}var r=II.call(e);return n&&(t?e[kI]=i:delete e[kI]),r},zI=Object.prototype.toString;var LI=function(e){return zI.call(e)},BI=PI?PI.toStringTag:void 0;var NI=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":BI&&BI in Object(e)?RI(e):LI(e)};var FI=function(e){return null!=e&&"object"==typeof e};var UI=function(e){return"symbol"==typeof e||FI(e)&&"[object Symbol]"==NI(e)};var VI=function(e,t){for(var i=-1,n=null==e?0:e.length,r=Array(n);++i<n;)r[i]=t(e[i],i,e);return r},jI=Array.isArray,WI=1/0,HI=PI?PI.prototype:void 0,GI=HI?HI.toString:void 0;var qI=function e(t){if("string"==typeof t)return t;if(jI(t))return VI(t,e)+"";if(UI(t))return GI?GI.call(t):"";var i=t+"";return"0"==i&&1/t==-WI?"-0":i},XI=/\s/;var YI=function(e){for(var t=e.length;t--&&XI.test(e.charAt(t)););return t},QI=/^\s+/;var KI=function(e){return e&&e.slice(0,YI(e)+1).replace(QI,"")};var ZI=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},JI=/^[-+]0x[0-9a-f]+$/i,$I=/^0b[01]+$/i,ek=/^0o[0-7]+$/i,tk=parseInt;var ik=function(e){if("number"==typeof e)return e;if(UI(e))return NaN;if(ZI(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ZI(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=KI(e);var i=$I.test(e);return i||ek.test(e)?tk(e.slice(2),i?2:8):JI.test(e)?NaN:+e};var nk=function(e){return e};var rk=function(e){if(!ZI(e))return!1;var t=NI(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},ak=TI["__core-js_shared__"],ok=function(){var e=/[^.]+$/.exec(ak&&ak.keys&&ak.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var sk=function(e){return!!ok&&ok in e},lk=Function.prototype.toString;var ck=function(e){if(null!=e){try{return lk.call(e)}catch(t){}try{return e+""}catch(i){}}return""},dk=/^\[object .+?Constructor\]$/,uk=Function.prototype,hk=Object.prototype,pk=uk.toString,fk=hk.hasOwnProperty,mk=RegExp("^"+pk.call(fk).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var gk=function(e){return!(!ZI(e)||sk(e))&&(rk(e)?mk:dk).test(ck(e))};var vk=function(e,t){return null===e||void 0===e?void 0:e[t]};var yk=function(e,t){var i=vk(e,t);return gk(i)?i:void 0},bk=yk(TI,"WeakMap"),xk=Object.create,wk=function(){function e(){}return function(t){if(!ZI(t))return{};if(xk)return xk(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}(),Sk=wk;var _k=function(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)};var Ck=function(e,t){var i=-1,n=e.length;for(t||(t=Array(n));++i<n;)t[i]=e[i];return t},Ek=Date.now;var Ak=function(e){var t=0,i=0;return function(){var n=Ek(),r=16-(n-i);if(i=n,r>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}};var Mk=function(e){return function(){return e}},Tk=function(){try{var e=yk(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),Pk=Tk,Dk=Pk?function(e,t){return Pk(e,"toString",{configurable:!0,enumerable:!1,value:Mk(t),writable:!0})}:nk,Ok=Ak(Dk);var Ik=function(e,t){for(var i=-1,n=null==e?0:e.length;++i<n&&!1!==t(e[i],i,e););return e};var kk=function(e,t,i,n){for(var r=e.length,a=i+(n?1:-1);n?a--:++a<r;)if(t(e[a],a,e))return a;return-1};var Rk=function(e){return e!==e};var zk=function(e,t,i){for(var n=i-1,r=e.length;++n<r;)if(e[n]===t)return n;return-1};var Lk=function(e,t,i){return t===t?zk(e,t,i):kk(e,Rk,i)},Bk=/^(?:0|[1-9]\d*)$/;var Nk=function(e,t){var i=typeof e;return!!(t=null!==t&&void 0!==t?t:9007199254740991)&&("number"==i||"symbol"!=i&&Bk.test(e))&&e>-1&&e%1==0&&e<t};var Fk=function(e,t,i){"__proto__"==t&&Pk?Pk(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i};var Uk=function(e,t){return e===t||e!==e&&t!==t},Vk=Object.prototype.hasOwnProperty;var jk=function(e,t,i){var n=e[t];(!Vk.call(e,t)||!Uk(n,i)||void 0===i&&!(t in e))&&Fk(e,t,i)};var Wk=function(e,t,i,n){var r=!i;i||(i={});for(var a=-1,o=t.length;++a<o;){var s=t[a],l=n?n(i[s],e[s],s,i,e):void 0;void 0===l&&(l=e[s]),r?Fk(i,s,l):jk(i,s,l)}return i},Hk=Math.max;var Gk=function(e,t,i){return t=Hk(void 0===t?e.length-1:t,0),function(){for(var n=arguments,r=-1,a=Hk(n.length-t,0),o=Array(a);++r<a;)o[r]=n[t+r];r=-1;for(var s=Array(t+1);++r<t;)s[r]=n[r];return s[t]=i(o),_k(e,this,s)}};var qk=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var Xk=function(e){return null!=e&&qk(e.length)&&!rk(e)},Yk=Object.prototype;var Qk=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Yk)};var Kk=function(e,t){for(var i=-1,n=Array(e);++i<e;)n[i]=t(i);return n};var Zk=function(e){return FI(e)&&"[object Arguments]"==NI(e)},Jk=Object.prototype,$k=Jk.hasOwnProperty,eR=Jk.propertyIsEnumerable,tR=Zk(function(){return arguments}())?Zk:function(e){return FI(e)&&$k.call(e,"callee")&&!eR.call(e,"callee")},iR=tR;var nR=function(){return!1},rR="object"==typeof exports&&exports&&!exports.nodeType&&exports,aR=rR&&"object"==typeof module&&module&&!module.nodeType&&module,oR=aR&&aR.exports===rR?TI.Buffer:void 0,sR=(oR?oR.isBuffer:void 0)||nR,lR={};lR["[object Float32Array]"]=lR["[object Float64Array]"]=lR["[object Int8Array]"]=lR["[object Int16Array]"]=lR["[object Int32Array]"]=lR["[object Uint8Array]"]=lR["[object Uint8ClampedArray]"]=lR["[object Uint16Array]"]=lR["[object Uint32Array]"]=!0,lR["[object Arguments]"]=lR["[object Array]"]=lR["[object ArrayBuffer]"]=lR["[object Boolean]"]=lR["[object DataView]"]=lR["[object Date]"]=lR["[object Error]"]=lR["[object Function]"]=lR["[object Map]"]=lR["[object Number]"]=lR["[object Object]"]=lR["[object RegExp]"]=lR["[object Set]"]=lR["[object String]"]=lR["[object WeakMap]"]=!1;var cR=function(e){return FI(e)&&qk(e.length)&&!!lR[NI(e)]};var dR=function(e){return function(t){return e(t)}},uR="object"==typeof exports&&exports&&!exports.nodeType&&exports,hR=uR&&"object"==typeof module&&module&&!module.nodeType&&module,pR=hR&&hR.exports===uR&&AI.process,fR=function(){try{return hR&&hR.require&&hR.require("util").types||pR&&pR.binding&&pR.binding("util")}catch(e){}}(),mR=fR&&fR.isTypedArray,gR=mR?dR(mR):cR,vR=Object.prototype.hasOwnProperty;var yR=function(e,t){var i=jI(e),n=!i&&iR(e),r=!i&&!n&&sR(e),a=!i&&!n&&!r&&gR(e),o=i||n||r||a,s=o?Kk(e.length,String):[],l=s.length;for(var c in e)(t||vR.call(e,c))&&(!o||!("length"==c||r&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Nk(c,l)))&&s.push(c);return s};var bR=function(e,t){return function(i){return e(t(i))}},xR=bR(Object.keys,Object),wR=Object.prototype.hasOwnProperty;var SR=function(e){if(!Qk(e))return xR(e);var t=[];for(var i in Object(e))wR.call(e,i)&&"constructor"!=i&&t.push(i);return t};var _R=function(e){return Xk(e)?yR(e):SR(e)};var CR=function(e){var t=[];if(null!=e)for(var i in Object(e))t.push(i);return t},ER=Object.prototype.hasOwnProperty;var AR=function(e){if(!ZI(e))return CR(e);var t=Qk(e),i=[];for(var n in e)"constructor"==n&&(t||!ER.call(e,n))||i.push(n);return i};var MR=function(e){return Xk(e)?yR(e,!0):AR(e)},TR=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,PR=/^\w*$/;var DR=function(e,t){if(jI(e))return!1;var i=typeof e;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=e&&!UI(e))||(PR.test(e)||!TR.test(e)||null!=t&&e in Object(t))},OR=yk(Object,"create");var IR=function(){this.__data__=OR?OR(null):{},this.size=0};var kR=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},RR=Object.prototype.hasOwnProperty;var zR=function(e){var t=this.__data__;if(OR){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return RR.call(t,e)?t[e]:void 0},LR=Object.prototype.hasOwnProperty;var BR=function(e){var t=this.__data__;return OR?void 0!==t[e]:LR.call(t,e)};var NR=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=OR&&void 0===t?"__lodash_hash_undefined__":t,this};function FR(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}FR.prototype.clear=IR,FR.prototype.delete=kR,FR.prototype.get=zR,FR.prototype.has=BR,FR.prototype.set=NR;var UR=FR;var VR=function(){this.__data__=[],this.size=0};var jR=function(e,t){for(var i=e.length;i--;)if(Uk(e[i][0],t))return i;return-1},WR=Array.prototype.splice;var HR=function(e){var t=this.__data__,i=jR(t,e);return!(i<0)&&(i==t.length-1?t.pop():WR.call(t,i,1),--this.size,!0)};var GR=function(e){var t=this.__data__,i=jR(t,e);return i<0?void 0:t[i][1]};var qR=function(e){return jR(this.__data__,e)>-1};var XR=function(e,t){var i=this.__data__,n=jR(i,e);return n<0?(++this.size,i.push([e,t])):i[n][1]=t,this};function YR(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}YR.prototype.clear=VR,YR.prototype.delete=HR,YR.prototype.get=GR,YR.prototype.has=qR,YR.prototype.set=XR;var QR=YR,KR=yk(TI,"Map");var ZR=function(){this.size=0,this.__data__={hash:new UR,map:new(KR||QR),string:new UR}};var JR=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var $R=function(e,t){var i=e.__data__;return JR(t)?i["string"==typeof t?"string":"hash"]:i.map};var ez=function(e){var t=$R(this,e).delete(e);return this.size-=t?1:0,t};var tz=function(e){return $R(this,e).get(e)};var iz=function(e){return $R(this,e).has(e)};var nz=function(e,t){var i=$R(this,e),n=i.size;return i.set(e,t),this.size+=i.size==n?0:1,this};function rz(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}rz.prototype.clear=ZR,rz.prototype.delete=ez,rz.prototype.get=tz,rz.prototype.has=iz,rz.prototype.set=nz;var az=rz;function oz(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var i=function(){var n=arguments,r=t?t.apply(this,n):n[0],a=i.cache;if(a.has(r))return a.get(r);var o=e.apply(this,n);return i.cache=a.set(r,o)||a,o};return i.cache=new(oz.Cache||az),i}oz.Cache=az;var sz=oz;var lz=function(e){var t=sz(e,function(e){return 500===i.size&&i.clear(),e}),i=t.cache;return t},cz=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dz=/\\(\\)?/g,uz=lz(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(cz,function(e,i,n,r){t.push(n?r.replace(dz,"$1"):i||e)}),t}),hz=uz;var pz=function(e){return null==e?"":qI(e)};var fz=function(e,t){return jI(e)?e:DR(e,t)?[e]:hz(pz(e))},mz=1/0;var gz=function(e){if("string"==typeof e||UI(e))return e;var t=e+"";return"0"==t&&1/e==-mz?"-0":t};var vz=function(e,t){for(var i=0,n=(t=fz(t,e)).length;null!=e&&i<n;)e=e[gz(t[i++])];return i&&i==n?e:void 0};var yz=function(e,t){for(var i=-1,n=t.length,r=e.length;++i<n;)e[r+i]=t[i];return e},bz=PI?PI.isConcatSpreadable:void 0;var xz=function(e){return jI(e)||iR(e)||!!(bz&&e&&e[bz])};var wz=function e(t,i,n,r,a){var o=-1,s=t.length;for(n||(n=xz),a||(a=[]);++o<s;){var l=t[o];i>0&&n(l)?i>1?e(l,i-1,n,r,a):yz(a,l):r||(a[a.length]=l)}return a};var Sz=function(e){return(null==e?0:e.length)?wz(e,1):[]};var _z=function(e){return Ok(Gk(e,void 0,Sz),e+"")},Cz=bR(Object.getPrototypeOf,Object),Ez=Function.prototype,Az=Object.prototype,Mz=Ez.toString,Tz=Az.hasOwnProperty,Pz=Mz.call(Object);var Dz=function(e){if(!FI(e)||"[object Object]"!=NI(e))return!1;var t=Cz(e);if(null===t)return!0;var i=Tz.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&Mz.call(i)==Pz};var Oz=function(e,t,i){var n=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(i=i>r?r:i)<0&&(i+=r),r=t>i?0:i-t>>>0,t>>>=0;for(var a=Array(r);++n<r;)a[n]=e[n+t];return a};var Iz=function(e,t,i){var n=e.length;return i=void 0===i?n:i,!t&&i>=n?e:Oz(e,t,i)},kz=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Rz=function(e){return kz.test(e)};var zz=function(e){return e.split("")},Lz="\\ud800-\\udfff",Bz="["+Lz+"]",Nz="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Fz="\\ud83c[\\udffb-\\udfff]",Uz="[^"+Lz+"]",Vz="(?:\\ud83c[\\udde6-\\uddff]){2}",jz="[\\ud800-\\udbff][\\udc00-\\udfff]",Wz="(?:"+Nz+"|"+Fz+")"+"?",Hz="[\\ufe0e\\ufe0f]?",Gz=Hz+Wz+("(?:\\u200d(?:"+[Uz,Vz,jz].join("|")+")"+Hz+Wz+")*"),qz="(?:"+[Uz+Nz+"?",Nz,Vz,jz,Bz].join("|")+")",Xz=RegExp(Fz+"(?="+Fz+")|"+qz+Gz,"g");var Yz=function(e){return e.match(Xz)||[]};var Qz=function(e){return Rz(e)?Yz(e):zz(e)};var Kz=function(){this.__data__=new QR,this.size=0};var Zz=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i};var Jz=function(e){return this.__data__.get(e)};var $z=function(e){return this.__data__.has(e)};var eL=function(e,t){var i=this.__data__;if(i instanceof QR){var n=i.__data__;if(!KR||n.length<199)return n.push([e,t]),this.size=++i.size,this;i=this.__data__=new az(n)}return i.set(e,t),this.size=i.size,this};function tL(e){var t=this.__data__=new QR(e);this.size=t.size}tL.prototype.clear=Kz,tL.prototype.delete=Zz,tL.prototype.get=Jz,tL.prototype.has=$z,tL.prototype.set=eL;var iL=tL;var nL=function(e,t){return e&&Wk(t,_R(t),e)};var rL=function(e,t){return e&&Wk(t,MR(t),e)},aL="object"==typeof exports&&exports&&!exports.nodeType&&exports,oL=aL&&"object"==typeof module&&module&&!module.nodeType&&module,sL=oL&&oL.exports===aL?TI.Buffer:void 0,lL=sL?sL.allocUnsafe:void 0;var cL=function(e,t){if(t)return e.slice();var i=e.length,n=lL?lL(i):new e.constructor(i);return e.copy(n),n};var dL=function(e,t){for(var i=-1,n=null==e?0:e.length,r=0,a=[];++i<n;){var o=e[i];t(o,i,e)&&(a[r++]=o)}return a};var uL=function(){return[]},hL=Object.prototype.propertyIsEnumerable,pL=Object.getOwnPropertySymbols,fL=pL?function(e){return null==e?[]:(e=Object(e),dL(pL(e),function(t){return hL.call(e,t)}))}:uL,mL=fL;var gL=function(e,t){return Wk(e,mL(e),t)},vL=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)yz(t,mL(e)),e=Cz(e);return t}:uL,yL=vL;var bL=function(e,t){return Wk(e,yL(e),t)};var xL=function(e,t,i){var n=t(e);return jI(e)?n:yz(n,i(e))};var wL=function(e){return xL(e,_R,mL)};var SL=function(e){return xL(e,MR,yL)},_L=yk(TI,"DataView"),CL=yk(TI,"Promise"),EL=yk(TI,"Set"),AL="[object Map]",ML="[object Promise]",TL="[object Set]",PL="[object WeakMap]",DL="[object DataView]",OL=ck(_L),IL=ck(KR),kL=ck(CL),RL=ck(EL),zL=ck(bk),LL=NI;(_L&&LL(new _L(new ArrayBuffer(1)))!=DL||KR&&LL(new KR)!=AL||CL&&LL(CL.resolve())!=ML||EL&&LL(new EL)!=TL||bk&&LL(new bk)!=PL)&&(LL=function(e){var t=NI(e),i="[object Object]"==t?e.constructor:void 0,n=i?ck(i):"";if(n)switch(n){case OL:return DL;case IL:return AL;case kL:return ML;case RL:return TL;case zL:return PL}return t});var BL=LL,NL=Object.prototype.hasOwnProperty;var FL=function(e){var t=e.length,i=new e.constructor(t);return t&&"string"==typeof e[0]&&NL.call(e,"index")&&(i.index=e.index,i.input=e.input),i},UL=TI.Uint8Array;var VL=function(e){var t=new e.constructor(e.byteLength);return new UL(t).set(new UL(e)),t};var jL=function(e,t){var i=t?VL(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)},WL=/\w*$/;var HL=function(e){var t=new e.constructor(e.source,WL.exec(e));return t.lastIndex=e.lastIndex,t},GL=PI?PI.prototype:void 0,qL=GL?GL.valueOf:void 0;var XL=function(e){return qL?Object(qL.call(e)):{}};var YL=function(e,t){var i=t?VL(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)};var QL=function(e,t,i){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return VL(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return jL(e,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return YL(e,i);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return HL(e);case"[object Symbol]":return XL(e)}};var KL=function(e){return"function"!=typeof e.constructor||Qk(e)?{}:Sk(Cz(e))};var ZL=function(e){return FI(e)&&"[object Map]"==BL(e)},JL=fR&&fR.isMap,$L=JL?dR(JL):ZL;var eB=function(e){return FI(e)&&"[object Set]"==BL(e)},tB=fR&&fR.isSet,iB=tB?dR(tB):eB,nB="[object Arguments]",rB="[object Function]",aB="[object Object]",oB={};oB[nB]=oB["[object Array]"]=oB["[object ArrayBuffer]"]=oB["[object DataView]"]=oB["[object Boolean]"]=oB["[object Date]"]=oB["[object Float32Array]"]=oB["[object Float64Array]"]=oB["[object Int8Array]"]=oB["[object Int16Array]"]=oB["[object Int32Array]"]=oB["[object Map]"]=oB["[object Number]"]=oB[aB]=oB["[object RegExp]"]=oB["[object Set]"]=oB["[object String]"]=oB["[object Symbol]"]=oB["[object Uint8Array]"]=oB["[object Uint8ClampedArray]"]=oB["[object Uint16Array]"]=oB["[object Uint32Array]"]=!0,oB["[object Error]"]=oB[rB]=oB["[object WeakMap]"]=!1;var sB=function e(t,i,n,r,a,o){var s,l=1&i,c=2&i,d=4&i;if(n&&(s=a?n(t,r,a,o):n(t)),void 0!==s)return s;if(!ZI(t))return t;var u=jI(t);if(u){if(s=FL(t),!l)return Ck(t,s)}else{var h=BL(t),p=h==rB||"[object GeneratorFunction]"==h;if(sR(t))return cL(t,l);if(h==aB||h==nB||p&&!a){if(s=c||p?{}:KL(t),!l)return c?bL(t,rL(s,t)):gL(t,nL(s,t))}else{if(!oB[h])return a?t:{};s=QL(t,h,l)}}o||(o=new iL);var f=o.get(t);if(f)return f;o.set(t,s),iB(t)?t.forEach(function(r){s.add(e(r,i,n,r,t,o))}):$L(t)&&t.forEach(function(r,a){s.set(a,e(r,i,n,a,t,o))});var m=u?void 0:(d?c?SL:wL:c?MR:_R)(t);return Ik(m||t,function(r,a){m&&(r=t[a=r]),jk(s,a,e(r,i,n,a,t,o))}),s};var lB=function(e){return sB(e,5)};var cB=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var dB=function(e){return this.__data__.has(e)};function uB(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new az;++t<i;)this.add(e[t])}uB.prototype.add=uB.prototype.push=cB,uB.prototype.has=dB;var hB=uB;var pB=function(e,t){for(var i=-1,n=null==e?0:e.length;++i<n;)if(t(e[i],i,e))return!0;return!1};var fB=function(e,t){return e.has(t)};var mB=function(e,t,i,n,r,a){var o=1&i,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var c=a.get(e),d=a.get(t);if(c&&d)return c==t&&d==e;var u=-1,h=!0,p=2&i?new hB:void 0;for(a.set(e,t),a.set(t,e);++u<s;){var f=e[u],m=t[u];if(n)var g=o?n(m,f,u,t,e,a):n(f,m,u,e,t,a);if(void 0!==g){if(g)continue;h=!1;break}if(p){if(!pB(t,function(e,t){if(!fB(p,t)&&(f===e||r(f,e,i,n,a)))return p.push(t)})){h=!1;break}}else if(f!==m&&!r(f,m,i,n,a)){h=!1;break}}return a.delete(e),a.delete(t),h};var gB=function(e){var t=-1,i=Array(e.size);return e.forEach(function(e,n){i[++t]=[n,e]}),i};var vB=function(e){var t=-1,i=Array(e.size);return e.forEach(function(e){i[++t]=e}),i},yB=PI?PI.prototype:void 0,bB=yB?yB.valueOf:void 0;var xB=function(e,t,i,n,r,a,o){switch(i){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new UL(e),new UL(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Uk(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=gB;case"[object Set]":var l=1&n;if(s||(s=vB),e.size!=t.size&&!l)return!1;var c=o.get(e);if(c)return c==t;n|=2,o.set(e,t);var d=mB(s(e),s(t),n,r,a,o);return o.delete(e),d;case"[object Symbol]":if(bB)return bB.call(e)==bB.call(t)}return!1},wB=Object.prototype.hasOwnProperty;var SB=function(e,t,i,n,r,a){var o=1&i,s=wL(e),l=s.length;if(l!=wL(t).length&&!o)return!1;for(var c=l;c--;){var d=s[c];if(!(o?d in t:wB.call(t,d)))return!1}var u=a.get(e),h=a.get(t);if(u&&h)return u==t&&h==e;var p=!0;a.set(e,t),a.set(t,e);for(var f=o;++c<l;){var m=e[d=s[c]],g=t[d];if(n)var v=o?n(g,m,d,t,e,a):n(m,g,d,e,t,a);if(!(void 0===v?m===g||r(m,g,i,n,a):v)){p=!1;break}f||(f="constructor"==d)}if(p&&!f){var y=e.constructor,b=t.constructor;y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(p=!1)}return a.delete(e),a.delete(t),p},_B="[object Arguments]",CB="[object Array]",EB="[object Object]",AB=Object.prototype.hasOwnProperty;var MB=function(e,t,i,n,r,a){var o=jI(e),s=jI(t),l=o?CB:BL(e),c=s?CB:BL(t),d=(l=l==_B?EB:l)==EB,u=(c=c==_B?EB:c)==EB,h=l==c;if(h&&sR(e)){if(!sR(t))return!1;o=!0,d=!1}if(h&&!d)return a||(a=new iL),o||gR(e)?mB(e,t,i,n,r,a):xB(e,t,l,i,n,r,a);if(!(1&i)){var p=d&&AB.call(e,"__wrapped__"),f=u&&AB.call(t,"__wrapped__");if(p||f){var m=p?e.value():e,g=f?t.value():t;return a||(a=new iL),r(m,g,i,n,a)}}return!!h&&(a||(a=new iL),SB(e,t,i,n,r,a))};var TB=function e(t,i,n,r,a){return t===i||(null==t||null==i||!FI(t)&&!FI(i)?t!==t&&i!==i:MB(t,i,n,r,e,a))};var PB=function(e,t){return null!=e&&t in Object(e)};var DB=function(e,t,i){for(var n=-1,r=(t=fz(t,e)).length,a=!1;++n<r;){var o=gz(t[n]);if(!(a=null!=e&&i(e,o)))break;e=e[o]}return a||++n!=r?a:!!(r=null==e?0:e.length)&&qk(r)&&Nk(o,r)&&(jI(e)||iR(e))};var OB=function(e,t){return null!=e&&DB(e,t,PB)},IB=function(){return TI.Date.now()},kB=Math.max,RB=Math.min;var zB=function(e,t,i){var n,r,a,o,s,l,c=0,d=!1,u=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var i=n,a=r;return n=r=void 0,c=t,o=e.apply(a,i)}function f(e){var i=e-l;return void 0===l||i>=t||i<0||u&&e-c>=a}function m(){var e=IB();if(f(e))return g(e);s=setTimeout(m,function(e){var i=t-(e-l);return u?RB(i,a-(e-c)):i}(e))}function g(e){return s=void 0,h&&n?p(e):(n=r=void 0,o)}function v(){var e=IB(),i=f(e);if(n=arguments,r=this,l=e,i){if(void 0===s)return function(e){return c=e,s=setTimeout(m,t),d?p(e):o}(l);if(u)return clearTimeout(s),s=setTimeout(m,t),p(l)}return void 0===s&&(s=setTimeout(m,t)),o}return t=ik(t)||0,ZI(i)&&(d=!!i.leading,a=(u="maxWait"in i)?kB(ik(i.maxWait)||0,t):a,h="trailing"in i?!!i.trailing:h),v.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=l=r=s=void 0},v.flush=function(){return void 0===s?o:g(IB())},v};var LB=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};var BB=function(e,t){return e>t};var NB=function(e,t){return t.length<2?e:vz(e,Oz(t,0,-1))};var FB=function(e,t){return TB(e,t)};var UB=function(e,t,i){for(var n=-1,r=e.length;++n<r;){var a=e[n],o=t(a);if(null!=o&&(void 0===s?o===o&&!UI(o):i(o,s)))var s=o,l=a}return l};var VB=function(e){return e&&e.length?UB(e,nk,BB):void 0};var jB=function(e,t){return t=fz(t,e),null==(e=NB(e,t))||delete e[gz(LB(t))]};var WB=function(e){return Dz(e)?void 0:e},HB=_z(function(e,t){var i={};if(null==e)return i;var n=!1;t=VI(t,function(t){return t=fz(t,e),n||(n=t.length>1),t}),Wk(e,SL(e),i),n&&(i=sB(i,7,WB));for(var r=t.length;r--;)jB(i,t[r]);return i}),GB=HB;var qB=function(e,t,i,n){if(!ZI(e))return e;for(var r=-1,a=(t=fz(t,e)).length,o=a-1,s=e;null!=s&&++r<a;){var l=gz(t[r]),c=i;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(r!=o){var d=s[l];void 0===(c=n?n(d,l,s):void 0)&&(c=ZI(d)?d:Nk(t[r+1])?[]:{})}jk(s,l,c),s=s[l]}return e};var XB=function(e,t,i){for(var n=-1,r=t.length,a={};++n<r;){var o=t[n],s=vz(e,o);i(s,o)&&qB(a,fz(o,e),s)}return a};var YB=function(e,t){return XB(e,t,function(t,i){return OB(e,i)})},QB=_z(function(e,t){return null==e?{}:YB(e,t)}),KB=QB;var ZB=function(e,t,i){var n=!0,r=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return ZI(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),zB(e,t,{leading:n,maxWait:t,trailing:r})};var JB=function(e,t){for(var i=e.length;i--&&Lk(t,e[i],0)>-1;);return i};var $B=function(e,t,i){if((e=pz(e))&&(i||void 0===t))return e.slice(0,YI(e)+1);if(!e||!(t=qI(t)))return e;var n=Qz(e),r=JB(n,Qz(t))+1;return Iz(n,0,r).join("")};function eN(e){for(let t of Object.keys(e))void 0===e[t]&&delete e[t];return e}function tN(e,t){return Object.setPrototypeOf(e,t),e}var iN=!(typeof window>"u")&&window.navigator.userAgent.toLowerCase().includes(" electron/"),nN=(iN&&(()=>{var e;if(typeof window>"u")return;let t=new URLSearchParams(window.location.search).get("desktop-app-version");t?window.localStorage.setItem("desktop-app-version",t):e=window.localStorage.getItem("desktop-app-version")})(),!(typeof window>"u")&&window.navigator.platform.toUpperCase().includes("MAC")),rN=!(typeof window>"u")&&(/iPad|iPhone|iPod/.test(window.navigator.userAgent)||nN&&"ontouchend"in document),aN=!(typeof window>"u")&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,oN=!(typeof window>"u")&&("ontouchstart"in window||navigator.maxTouchPoints>0),sN=(()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)})(),lN=Number((()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]})());function cN(e){return Array.isArray(e)?e:[e]}function dN(e,t){let i=0;for(;i<e.length&&i<t.length;){if(e[i]<t[i])return-1;if(e[i]>t[i])return 1;i+=1}return i!==t.length?-1:i!==e.length?1:0}function uN(e){return nN?e.metaKey:e.ctrlKey}var hN=[],pN={},fN={},mN={};function gN(e){hN.includes(e)||hN.push(e)}function vN(e){delete pN[e.pointerId];for(let t=0;t<hN.length;t++)if(hN[t].pointerId===e.pointerId){hN.splice(t,1);break}}function yN(e){if("touch"!==e.pointerType)return;let t=pN[e.pointerId];void 0===t&&(t={x:0,y:0},pN[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function bN(e){let t=e.pointerId===hN[0].pointerId?hN[1]:hN[0];return pN[t.pointerId]}function xN(e){fN[e.key]=!0,mN[e.key]=void 0===mN[e.key]?1:mN[e.key]+1}function wN(e){if(nN&&fN.Meta)for(let t in fN)fN[t]=!1;else fN[e.key]=!1;mN={}}var SN,_N,CN=new Promise(e=>{SN=e});function EN(e){if(_N)return _N;return _N=async function(){let t=null!==e&&void 0!==e?e:"https://unpkg.com/@splinetool/navmesh-wasm@1.10.48/build",n=i.e(208).then(i.bind(i,208)),[r,a]=await Promise.all([n,fetch("".concat(t,"/navmesh.wasm")).then(e=>e.arrayBuffer())]),o=r.default,s=await o({wasmBinary:a});SN(s)}()}var AN,MN,TN=new Promise(e=>{AN=e});function PN(){if(MN)return MN;return MN=async function(){let e=await i.e(293).then(i.bind(i,293));await e.init(),AN(e)}()}var DN=class{modifyById(e,t){let i=this;if(void 0===i[e])throw new Error("not expected");{let n=c(c({},i),{},{[e]:t});return Object.setPrototypeOf(n,DN.prototype),n}}add(e,t){var i,n;return null!==(i=null===(n=this.runOp({type:1,id:e,data:t}))||void 0===n?void 0:n.data)&&void 0!==i?i:this}runOp(e){let t=this;if(1===e.type){let i,n=t[e.id];i=void 0===n?{type:2,id:e.id}:{type:1,id:e.id,data:n};let{id:r,data:a}=e,o=c(c({},t),{},{[r]:a});return Object.setPrototypeOf(o,DN.prototype),{data:o,actual:e,reverse:i}}if(2===e.type){let{id:i}=e,n=t[i];if(void 0===n)return null;{let r=c({},t);return Object.setPrototypeOf(r,DN.prototype),delete r[i],{data:r,actual:e,reverse:{type:1,id:i,data:n}}}}return null}};function ON(e){if(void 0!==e.deepFreeze)return void e.deepFreeze(e);let t=Object.getOwnPropertyNames(e);for(let i of t){let t=e[i];t&&"object"==typeof t&&ON(t)}return Object.freeze(e)}var IN=class extends Error{};function kN(e){let t=c({},e);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function RN(e,t,i){if(void 0===e?void 0===t?(e=0,t=10):e=t-10:void 0===t&&(t=e+10),e>t){let i=e;e=t,t=i}let n=[],r=1/(i+1);for(let a=0;a<i;a++){let i=e+(t-e)*(a+.75+.5*Math.random())*r;n.push(i)}return n}function zN(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function LN(e,t){for(let i of e)!0!==t(i.id,i.data)&&LN(i.children,t)}function BN(e,t){if(!0!==t(e.id,e.data))for(let i of e.children)BN(i,t)}var NN,FN=class extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,FN.prototype)}deepFreeze(){let e=0;for(;e<this.length;)ON(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let i of e.children)this.fillCaches0(i,e.id)}fillCaches(){if(void 0===this.objCaches){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(0!==e.length)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,t){if(!this.has(e))return!0;for(;e;){let i=this.parent(e);if(i===t)return!0;e=i}return!1}rootAcestor(e){for(;e;){let t=this.parent(e);if(!t)return e;e=t}return e}isDescendantOf(e,t){for(;e;){let i=this.parent(e);if(i===t)return!0;e=i}return!1}data(e){var t;return null===(t=this.get(e))||void 0===t?void 0:t.data}has(e){return void 0!==this.childrenOf(e)}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){var t;return null===e?this:null===(t=this.get(e))||void 0===t?void 0:t.children}traverseFrom(e,t){if(null===e)this.traverse(t);else{let i=this.get(e);i&&BN(i,t)}}traverse(e){LN(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return null===e?this:this.get(e).children}modifyById(e,t){if(void 0===this.get(e))throw new Error("not expected");{let i=this.parent(e),n=this.childrenArray(i),r=n.findIndex(t=>t.id===e);if(r<0)throw new Error("not expected");let a=n[r];return n=[...n],n[r]=c(c({},a),{},{data:t}),this.modifyArrayBy(i,n)}}modifyArrayBy(e,t){let i=e,n=t;for(;null!==i;){let e=n,t=i;if(i=this.parent(i),void 0===i)throw new Error;n=this.childrenArray(i);let r=n.findIndex(e=>e.id===t);if(r<0)throw new Error;n=[...n],n[r]=c(c({},n[r]),{},{children:e})}Object.setPrototypeOf(n,FN.prototype);let r=n;return r.fillCaches(),r}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec(e){let{id:t,children:i}=e;if(void 0!==this.get(t))return!0;for(let n of i)if(this.checkDuplicatedIdRec(n))return!0;return!1}addOp(e){let{parent:t,fi:i,id:n,data:r,children:a}=e;if(null!==t&&void 0===this.get(t))return null;if(this.checkDuplicatedIdRec(e))return null;{let o=t,s=this.childrenArray(o),l={fi:i,id:n,data:r,children:a};return s=[...s,l],s.sort((e,t)=>e.fi-t.fi),e.localIndex=s.indexOf(l),{data:this.modifyArrayBy(o,s),actual:e,reverse:{type:8,id:n}}}}deleteOp(e){let{id:t}=e;if(null===this.get(t))return null;{let i=this.parent(t);if(void 0===i)return null;let n=this.childrenArray(i),r=n.findIndex(e=>e.id===t);e.localIndex=r,n=[...n];let a=n.splice(r,1)[0];return{data:this.modifyArrayBy(i,n),actual:e,reverse:c(c({type:7},a),{},{parent:i})}}}moveOp(e){let{parent:t,fi:i,id:n}=e;if(null!==t&&void 0===this.get(t))return this.deleteOp({type:8,id:n});if(null!==t){let e=t;for(;null!==e;){if(void 0===e)throw new Error;if(e===n)throw new IN("cyclic tree");e=this.parent(e)}}let r=this.parent(n);if(void 0===r)return null;let a=r,o=this.childrenArray(r),s=o.findIndex(e=>e.id===n);o=[...o];let l=o.splice(s,1)[0],d=this.modifyArrayBy(r,o);r=t,o=d.childrenArray(r);let u=l.fi;return l=c(c({},l),{},{fi:i}),o=[...o,l],o.sort((e,t)=>e.fi-t.fi),e.localIndex=o.indexOf(l),d=d.modifyArrayBy(r,o),{data:d,actual:e,reverse:{type:9,parent:a,fi:u,id:n}}}previous(e,t){if(null===t){let t=this.childrenArray(e);return 0===t.length?null:t[t.length-1].id}let i=null;for(let n of this.childrenArray(e)){if(n.id===t)return i;i=n.id}return null}traverseSortNext(e){let t=this.parent(e);if(void 0!==t){let i=this.childrenArray(t),n=i.findIndex(t=>t.id===e)+1;if(n<i.length)return i[n].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(void 0!==t){let i=this.childrenArray(t),n=i.findIndex(t=>t.id===e)-1;return n>=0?this.traverseSortPrevious(i[n].id):t}}getAllSorted(e){let t=[];for(let i of e){let e=this.getWithSortKey(i.id);void 0!==e&&t.push(c(c({},i),e))}t.sort((e,t)=>function(e,t){let i=0;for(;i<e.length&&i<t.length;){if(e[i]<t[i])return-1;if(e[i]>t[i])return 1;i+=1}return i!==t.length?-1:i!==e.length?1:0}(e.sortKey,t.sortKey));for(let i of t)delete i.sortKey;return t}getWithSortKey(e){var t=e;let i=[],n=this.get(t),r=n;if(void 0!==n){for(;t;)i.splice(0,0,n.fi),null!==(t=this.parent(t))&&(n=this.get(t));return c(c({},r),{},{sortKey:i})}}insertBeforeHelper(e,t,i){return this.insertAfterHelper(e,this.previous(e,t),i)}insertAfterHelper(e,t,i){let n=this.childrenArray(e);if(null===t){if(0===n.length)return RN(0,i,i);{let e=n[0].fi;return RN(e-i,e,i)}}{let r=this.get(t);if(void 0===r||this.parent(t)!==e)throw new Error("illegal args");let a=n.find(e=>e.fi>r.fi);if(void 0===a){let e=n[n.length-1].fi;return RN(e,e+i,i)}return RN(r.fi,a.fi,i)}}};(e=>{e.runOp=function(e,t){if(0!==t.type)return null;if(Array.isArray(e)){let i=t.props,n={},r=[...e],a=!1;if(i)for(let e of Object.keys(i)){let t=parseInt(e);if(isNaN(t))throw new Error("wrong index");n[e]=r[t],r[t]=i[e],a=!0}return a?{data:r,actual:t,reverse:{type:0,props:n}}:null}{let i=t.props,n={},r=c({},e),a=!1;if(i)for(let e of Object.keys(i)){n[e]=r[e];let t=i[e];void 0===t?delete r[e]:r[e]=t,a=!0}return a?{data:r,actual:t,reverse:{type:0,props:n}}:null}}})(NN||(NN={}));var UN=class extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,UN.prototype)}deepFreeze(){let e=0;for(;e<this.length;)ON(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(void 0===this.objCaches){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(0!==e.length)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var t;return null===(t=this.get(e))||void 0===t?void 0:t.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(void 0===this.get(e))throw new Error("not expected");{let i=this,n=i.findIndex(t=>t.id===e);if(n<0)throw new Error("not expected");let r=i[n];return i=[...i],i[n]=c(c({},r),{},{data:t}),this.modifyArrayBy(i)}}modifyArrayBy(e){Object.setPrototypeOf(e,UN.prototype);let t=e;return typeof process<"u"||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:i,data:n}=e,r=this,a={fi:t,id:i,data:n};return r=[...r,a],r.sort((e,t)=>e.fi-t.fi),e.localIndex=r.indexOf(a),{data:this.modifyArrayBy(r),actual:e,reverse:{type:5,id:i}}}deleteOp(e){let{id:t}=e,i=this,n=i.findIndex(e=>e.id===t);if(-1===n)return null;e.localIndex=n,i=[...i];let r=i.splice(n,1)[0];return{data:this.modifyArrayBy(i),actual:e,reverse:c({type:4},r)}}moveOp(e){let{fi:t,id:i}=e,n=this;n=[...n];let r=n.findIndex(e=>e.id===i);if(-1===r)return null;let a=n[r].fi,o=c(c({},n[r]),{},{fi:t});return n[r]=o,n.sort((e,t)=>e.fi-t.fi),e.localIndex=n.indexOf(o),{data:this.modifyArrayBy(n),actual:e,reverse:{type:6,fi:a,id:i}}}previous(e){if(null===e)return 0===this.length?null:this[this.length-1].id;let t=null;for(let i of this){if(i.id===e)return t;t=i.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let i=this;if(null===e){if(0===i.length)return RN(0,t,t);{let e=i[0].fi;return RN(e-t,e,t)}}{let n=this.get(e);if(void 0===n)throw new Error("illegal args");let r=i.find(e=>e.fi>n.fi);if(void 0===r){let e=i[i.length-1].fi;return RN(e,e+t,t)}return RN(n.fi,r.fi,t)}}};function VN(e){return e&&"object"==typeof e&&e instanceof XN}var jN,WN,HN,GN,qN,XN=class{unusedFunOverridesTable(e){}runOp(e){let t=[],i=this,n=0,r={};for(;n<e.path.length;){if(t.push(i),i=void 0===i?void 0:i[e.path[n]],void 0!==i&&!VN(i))return null;n+=1}i=i?kN(i):new XN;for(let[a,o]of Object.entries(e.props)){let e=i[a];r[a]=e,void 0===o?delete i[a]:i[a]=o}for(;n>0;){if(0===Object.keys(i).length){let r=t[n-1];r&&(i=kN(r),delete i[e.path[n-1]])}else{let r=t[n-1];if(r){let t=kN(r);t[e.path[n-1]]=i,i=t}else{let t=new XN;t[e.path[n-1]]=i,i=t}}n-=1}return{data:Object.setPrototypeOf(i,XN.prototype),actual:e,reverse:c(c({},e),{},{props:r})}}};function YN(e,t){if(void 0===t)return;let i=!1,n=e.map(e=>{let n=e.id,r=QN(e.data,t[n]);if(i=i||void 0!==r,void 0===r&&(r=e.data),e.children){let a=YN(e.children,t);return void 0!==a?i=!0:a=e.children,c(c({},e),{},{id:n,data:r,children:a})}return c(c({},e),{},{id:n,data:r})});return i?n:void 0}function QN(e,t){if(!VN(t))return t;if(e instanceof FN){let i=YN(e,t);return void 0!==i&&Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}if(e instanceof UN)return function(e,t){if(void 0===t)return;let i=!1,n=e.map(e=>{let n=e.id,r=QN(e.data,t[n]);return i=i||void 0!==r,void 0===r&&(r=e.data),c(c({},e),{},{id:n,data:r})});return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}(e,t);if(Array.isArray(e)){let i=!1,n=e.map((e,n)=>{let r=QN(e,t[n]);return i=i||void 0!==r,void 0===r&&(r=e),r});return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}if(e instanceof XN)return KN(e,t);if(e&&"object"==typeof e){let i={},n=!1;for(let[r,a]of Object.entries(e)){let e=QN(a,t[r]);n=n||void 0!==e,void 0===e&&(e=a),i[r]=e}return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}}function KN(e,t){if(void 0===e)return t;if(void 0===t)return e;if(!VN(t))return t;if(!VN(e))return jN.apply(e,t);let i=new Set;for(let r of Object.keys(e))i.add(r);for(let r of Object.keys(t))i.add(r);let n=new XN;for(let r of i){let i=KN(void 0===e?void 0:e[r],void 0===t?void 0:t[r]);n[r]=i}return n}function ZN(e,t){var i;let n={cur:[],result:[],len:0};return[e=null!==(i=tF(e,t,n))&&void 0!==i?i:e,n.result]}function JN(e,t){return null===e?null:(e.cur[e.len]=t,e.len+=1,e)}function $N(e){e&&(e.len-=1)}function eF(e,t,i){let n=!1,r=e.map(e=>{let r=e.id,a=t[r];if(void 0!==a&&"string"==typeof a&&(n=!0,r=a,null!==i))throw new Error("not supported");let o=tF(e.data,t,JN(i,r));$N(i),n=n||void 0!==o,void 0===o&&(o=e.data);let s=eF(e.children,t,i);return void 0!==s?n=!0:s=e.children,c(c({},e),{},{id:r,data:o,children:s})});if(n)return r}function tF(e,t,i){if(e instanceof FN){let n=eF(e,t,i);return void 0!==n&&Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}if(e instanceof UN)return function(e,t,i){let n=!1,r=e.map(e=>{let r=e.id,a=t[r];if(void 0!==a&&"string"==typeof a&&(n=!0,r=a,null!==i))throw new Error("not supported");let o=tF(e.data,t,JN(i,r));return $N(i),n=n||void 0!==o,void 0===o&&(o=e.data),c(c({},e),{},{id:r,data:o})});if(n)return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}(e,t,i);if(Array.isArray(e)){let n=!1,r=e.map((e,r)=>{let a=tF(e,t,JN(i,r));return $N(i),n=n||void 0!==a,void 0===a&&(a=e),a});return n?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}if(e&&"object"==typeof e&&!zN(e)){let n={},r=!1;for(let[a,o]of Object.entries(e))if("name"!==a&&"variableId"!==a){let e=t[a];if("string"==typeof e){if(null!==i)throw new Error("not supported");r=!0,a=e}let s=tF(o,t,JN(i,a));$N(i),r=r||void 0!==s,void 0===s&&(s=o),n[a]=s}else n[a]=o;return r?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}if("string"==typeof e){let n=t[e];return void 0!==n&&function(e){if(null===e)return null;e.result.push(e.cur.slice(0,e.len))}(i),n}}(WN=jN||(jN={})).apply=function(e,t){var i;return null!==(i=QN(e,t))&&void 0!==i?i:e},WN.merge=function(e,t){return KN(e,t)},WN.filterOp=function(e,t){let i=0,n=t.path,r=e;for(;i<n.length&&void 0!==r;){if(r=fF.zoomOnce(r,n[i]),void 0===r)return t;if(!VN(r))return;i+=1}if(void 0===r)return t;if(VN(r)){if(0===t.type){let e=c({},t.props);for(let t of Object.keys(r))delete e[t];return c(c({},t),{},{props:e})}if(1===t.type||4===t.type||7===t.type){let e=YN([t],r);return e?(console.log(e),e):t}return t}},(e=>{e.replaceProps=function(e,t){let i=fF.zoom(t,e.path);if("object"==typeof i){let t={};for(let n of Object.keys(e.props))t[n]=i[n];return c(c({},e),{},{props:t})}return c(c({},e),{},{props:{}})}})(HN||(HN={})),(e=>{function t(e,t){let i=t.path;for(var n=[];;){let o;if(e instanceof XN&&0===t.type&&(o=e.runOp(c(c({},t),{},{path:i.slice(n.length)})),null===o&&(o=void 0)),void 0===o&&n.length===i.length&&(o=e instanceof FN||e instanceof UN||e instanceof DN?e.runOp(t):NN.runOp(e,t)),void 0!==o){if(null!==o){let e=o.data;for(let t=n.length-1;t>=0;t--){let r=i[t],a=n[t];if(a instanceof FN){if("number"==typeof r)throw new Error("illegal arg");e=a.modifyById(r,e)}else if(a instanceof UN){if("number"==typeof r)throw new Error("illegal arg");e=a.modifyById(r,e)}else if(a instanceof DN){if("number"==typeof r)throw new Error("illegal arg");e=a.modifyById(r,e)}else if(a instanceof XN){let t=c(c({},a),{},{[r]:e});e=Object.setPrototypeOf(t,XN.prototype)}else{if("object"!=typeof a)return null;if(Array.isArray(a)){if("string"==typeof r&&(r=parseInt(r),isNaN(r)))throw new Error("Invalid path");let t=e;e=[...a],e[r]=t}else e=c(c({},a),{},{[r]:e})}}return{data:e,actual:c(c({},o.actual),{},{path:i}),reverse:c(c({},o.reverse),{},{path:i})}}return null}let s,l=i[n.length];if(e instanceof FN){var r;if("number"==typeof l)throw new Error("");s=null===(r=e.get(l))||void 0===r?void 0:r.data}else if(e instanceof UN){var a;if("number"==typeof l)throw new Error("");s=null===(a=e.get(l))||void 0===a?void 0:a.data}else null!==e&&(s=e[l]);if(void 0===s)return null;n.push(e),e=s}}function i(e,t){for(let i=0;i<e.length&&i<t.length;i++)if(e[i]!==t[i])return!0;return!1}function n(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}e.drop=function(e,t){return c(c({},e),{},{path:e.path.slice(t)})},e.applySimple=function(e,i){var n,r;return null!==(n=null===(r=t(e,i))||void 0===r?void 0:r.data)&&void 0!==n?n:e},e.apply=t,e.pathDisjoint=i,e.pathEq=n,e.commutative=function(e,t){return i(e.path,t.path)},e.subsumed=function(e,t){return!(0!==e.type||0!==t.type||!n(e.path,t.path))&&Object.keys(e.props).every(e=>void 0!==t.props[e])}})(GN||(GN={})),(e=>{function t(e,t){var i=e;let n=[],r=[];for(let o of t)try{if(3===o.type||5===o.type&&"variables"===o.path[o.path.length-1]){let e,t,a;if(3===o.type?(e=fF.zoom(i,[...o.path,o.id]),a=GN.apply(i,c(c({},o),{},{type:2}))):(e=fF.zoom(i,[...o.path,o.id,"value"]),a=GN.apply(i,o)),null!==a){i=a.data;let[s,l]=ZN(i,{[o.id]:e});i=s;for(let a=0;a<l.length;a++){let s=l[a],d=s.pop();if("number"==typeof d){let n=[d];for(let e=a+1;e<l.length;e++){let t=l[e],i=t[t.length-1];if("number"!=typeof i||!fF.equal(s,t.slice(0,t.length-1)))break;n.push(i),l.splice(e,1)}let r=fF.zoom(i,s);t=r.map((e,t)=>n.includes(t)?o.id:e),e=r,d=s.pop()}else{if("alphaOverride"===d||"alpha"===d){e/=100;let t=e,n=fF.zoom(i,s.slice(0,s.length-2)),r=n.layers.map(e=>e.id===s[s.length-1]?c(c({},e),{},{data:c(c({},e.data),{},{[d]:t})}):e);Object.setPrototypeOf(r,Object.getPrototypeOf(n.layers)),n.layers=r}t=o.id}n.push({type:0,path:s,props:{[d]:e}}),r.push({type:0,path:s,props:{[d]:t}})}r.push(a.reverse),n.push(a.actual)}}else{let e=GN.apply(i,o);null!==e&&(n.push(e.actual),i=e.data,r.push(e.reverse))}}catch(a){if(a instanceof IN)return null;throw a}return{data:i,actual:n,reverse:r.reverse()}}e.empty=function(){return[]},e.removePrefix=function(e,t){let i=[];for(let n of e){let[e,...r]=n.path;e===t&&i.push(c(c({},n),{},{path:r}))}return i},e.addPrefix=function(e,t){return e.map(e=>c(c({},e),{},{path:[t,...e.path]}))},e.concat=function(e,t){return[...e,...t]},e.compress=function(e,t){return[...e.filter(e=>!t.some(t=>GN.subsumed(e,t))),...t]},e.commutative=function(e,t){return e.every(e=>t.every(t=>GN.commutative(e,t)))},e.applyAll=function(e,i){for(let n of i){let i=t(e,n);null!==i&&(e=i.data)}return e},e.apply=t})(qN||(qN={}));var iF=Symbol(),nF=Symbol(),rF=Symbol(),aF=class{reportOp(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=this;if(null===t)return;n._current=t.data;let r=i;for(;!(n instanceof mF);){let e=n._path,t=n._current;if(""!==e&&r.splice(0,0,e),n=n._parent,null===n)return;n.update(e,t)}n.push(r,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let i=t[rF];i&&i(),delete this._children[e]}}}},oF=class extends aF{constructor(e,t,i){super(),this._parent=e,this._path=t,this._current=i}update(e,t){if(Array.isArray(this._current)){if("string"==typeof e&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current=c(c({},this._current),{},{[e]:t})}runOp(e){this.reportOp(e,NN.runOp(this._current,e),e.path)}},sF=class extends aF{constructor(e,t,i){super(),this._parent=e,this._path=t,this._current=i}update(e,t){this._current=c(c({},this._current),{},{[e]:t}),Object.setPrototypeOf(this._current,DN.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},lF={get(e,t){if(t===rF)return()=>{e._parent=null};if(t===iF)return e._current;if(t===nF)return e;let{_current:i,_children:n}=e;if("push"===t&&Array.isArray(i))throw new Error("not supported to expand array");let r=void 0===n?void 0:n[t];if(void 0!==r)return r;let a=i[t],o=gF(e,t,a);return o!==a?(void 0===n&&(n={},e._children=n),n[t]=o,o):a},has:(e,t)=>t in e._current,ownKeys:e=>Reflect.ownKeys(e._current),defineProperty(){throw Error("not supported")},getPrototypeOf:e=>Object.getPrototypeOf(e._current),setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let i=e._current,n=Reflect.getOwnPropertyDescriptor(i,t);return n&&{writable:!0,configurable:!0,enumerable:n.enumerable,value:i[t]}}},cF=c(c({},lF),{},{set(e,t,i){var n;let r={type:0,props:{[t]:null!==(n=bF(i))&&void 0!==n?n:i}};return e.deleteChildren(t),e.runOp(r),!0},deleteProperty(e,t){let i={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(i),!0}}),dF=c(c({},lF),{},{set(e,t,i){return void 0===i?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:i})),!0},deleteProperty:(e,t)=>(e.runOp({type:2,id:t}),!0)}),uF=class extends aF{constructor(e,t,i){super(),this._children={},this._parent=e,this._path=t,this._current=i,this[rF]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse((t,i)=>{e(t,this.data(t))})}data(e){var t;let{_current:i,_children:n}=this,r=void 0===n?void 0:n[e];if(void 0!==r)return r;let a=null===(t=i.get(e))||void 0===t?void 0:t.data,o=gF(this,e,a);return o!==a?(void 0===n&&(n={},this._children=n),n[e]=o,o):a}add(e,t,i,n,r){this.runOp({type:7,parent:e,fi:t,id:i,data:n,children:r})}move(e,t,i){this.runOp({type:9,parent:e,fi:t,id:i})}insertAfter(e,t,i){let n=this._current.insertAfterHelper(e,t,i.length);for(let r=0;r<i.length;r++){let t=i[r];this.add(e,n[r],t.id,t.data,t.children)}}insertBefore(e,t,i){let n=this._current.insertBeforeHelper(e,t,i.length);for(let r=0;r<i.length;r++){let t=i[r];this.add(e,n[r],t.id,t.data,t.children)}}moveAfter(e,t,i){let n=this._current.insertAfterHelper(e,t,i.length);for(let r=0;r<i.length;r++){let t=i[r];this.move(e,n[r],t)}}moveBefore(e,t,i){let n=this._current.insertBeforeHelper(e,t,i.length);for(let r=0;r<i.length;r++){let t=i[r];this.move(e,n[r],t)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},hF=class extends aF{constructor(e,t,i){super(),this._children={},this._parent=e,this._path=t,this._current=i,this[rF]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let i=0;i<t;i++){let t=this._current[i].id,n=this._current[i].fi;e(this.data(this._current[i].id),t,n)}}find(e){let t=this.length;for(let i=0;i<t;i++){let t=this._current[i].id;if(e(this.data(t),t))return this.get(t)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return c(c({},this._current.get(e)),{},{data:this.data(e)})}data(e){var t;let{_current:i,_children:n}=this,r=void 0===n?void 0:n[e];if(void 0!==r)return r;let a=null===(t=i.get(e))||void 0===t?void 0:t.data,o=gF(this,e,a);return o!==a?(void 0===n&&(n={},this._children=n),n[e]=o,o):a}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,i){this.runOp({type:4,fi:e,id:t,data:i})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let i=this._current.insertAfterHelper(e,t.length);for(let n=0;n<t.length;n++){let e=t[n];this.add(i[n],e.id,e.data)}}insertBefore(e,t){let i=this._current.insertBeforeHelper(e,t.length);for(let n=0;n<t.length;n++){let e=t[n];this.add(i[n],e.id,e.data)}}moveAfter(e,t){let i=this._current.insertAfterHelper(e,t.length);for(let n=0;n<t.length;n++){let e=t[n];this.move(i[n],e)}}moveBefore(e,t){let i=this._current.insertBeforeHelper(e,t.length);for(let n=0;n<t.length;n++){let e=t[n];this.move(i[n],e)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function pF(e,t,i){if(e.length>0){let n=e[e.length-1];if(0===n.type&&0===t.type&&fF.equal(n.path,i))return void Object.assign(n.props,t.props)}e.push(c(c({},t),{},{path:i}))}var fF,mF=class extends aF{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(""!==e)throw new Error("");this._current=t}push(e,t,i,n){pF(this.ts,t,e),pF(this.actual,i,e),pF(this.reverse,n,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function gF(e,t,i){return i instanceof FN?new uF(e,t,i):i instanceof UN?new hF(e,t,i):i instanceof DN?new Proxy(new sF(e,t,i),dF):null!==i&&"object"==typeof i?zN(i)?i:new Proxy(new oF(e,t,i),cF):i}function vF(e){let t=new mF(e);return[gF(t,"",e),t]}function yF(e,t){let[i,n]=vF(e);return t(i),n.result()}function bF(e){return e instanceof uF||e instanceof hF?e._current:null!==e&&"object"==typeof e?e[iF]:e}function xF(e,t){let i=[];if(!(t.length<=e.length))return null;for(var n=0;n<t.length;){if("*"===t[n])i.push(e[n]);else if(e[n]!==t[n])return null;n+=1}return i}(e=>{function t(e,t){return(e instanceof FN||e instanceof uF)&&"string"==typeof t||(e instanceof UN||e instanceof hF)&&"string"==typeof t?e.data(t):"number"==typeof t&&Array.isArray(e)||"string"==typeof t&&"object"==typeof e&&null!==e?e[t]:void 0}function i(e,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(;n<i.length&&void 0!==e;)e=t(e,i[n]),n+=1;return e}e.equal=function(e,t){if(t.length!==e.length)return!1;for(var i=0;i<e.length;){if(e[i]!==t[i])return!1;i+=1}return!0},e.removeOverridden=function(e,t,n){let r=i(n,e);if(void 0!==r&&"object"==typeof r&&null!==r){let e=c({},t);return Object.keys(r).forEach(t=>{delete e[t]}),e}return t},e.zoomOnce=t,e.zoom=i})(fF||(fF={}));var wF,SF=class{},_F=class extends SF{constructor(e){super(),this.id=e}},CF=class extends SF{constructor(e){super(),this.data=e}};try{wF=new TextDecoder}catch(Mne){}var EF,AF,MF,TF,PF,DF,OF,IF=0,kF=[],RF=kF,zF=0,LF={},BF=0,NF=0,FF=[],UF={useRecords:!1,mapsAsObjects:!0},VF=class{},jF=new VF;jF.name="MessagePack 0xC1";var WF=!1,HF=class{constructor(e){e&&(!1===e.useRecords&&void 0===e.mapsAsObjects&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(EF)return mU(()=>(gU(),this?this.unpack(e,t):HF.prototype.unpack.call(UF,e,t)));AF=t>-1?t:e.length,IF=0,zF=0,NF=0,TF=null,RF=kF,PF=null,EF=e;try{OF=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(WN){throw EF=null,e instanceof Uint8Array?WN:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&"object"==typeof e?e.constructor.name:typeof e))}if(this instanceof HF){if(LF=this,this.structures)return MF=this.structures,GF();(!MF||MF.length>0)&&(MF=[])}else LF=UF,(!MF||MF.length>0)&&(MF=[]);return GF()}unpackMultiple(e,t){let i,n=0;try{WF=!0;let r=e.length,a=this?this.unpack(e,r):bU.unpack(e,r);if(!t){for(i=[a];IF<r;)n=IF,i.push(GF());return i}for(t(a);IF<r;)if(n=IF,!1===t(GF()))return}catch(BV){throw BV.lastPosition=n,BV.values=i,BV}finally{WF=!1,gU()}}_mergeStructures(e,t){for(let i=0,n=(e=e||[]).length;i<n;i++){let t=e[i];t&&(t.isShared=!0,i>=32&&(t.highByte=i-32>>5))}e.sharedLength=e.length;for(let i in t||[])if(i>=0){let n=e[i],r=t[i];r&&(n&&((e.restoreStructures||(e.restoreStructures=[]))[i]=n),e[i]=r)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function GF(){try{if(!LF.trusted&&!WF){let e=MF.sharedLength||0;e<MF.length&&(MF.length=e)}let e=XF();if(IF==AF)MF.restoreStructures&&qF(),MF=null,EF=null,DF&&(DF=null);else{if(IF>AF){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}if(!WF)throw new Error("Data read, but end of buffer not reached")}return e}catch(Lq){throw MF.restoreStructures&&qF(),gU(),(Lq instanceof RangeError||Lq.message.startsWith("Unexpected end of buffer"))&&(Lq.incomplete=!0),Lq}}function qF(){for(let e in MF.restoreStructures)MF[e]=MF.restoreStructures[e];MF.restoreStructures=null}function XF(){let e=EF[IF++];if(e<160){if(e<128){if(e<64)return e;{let t=MF[63&e]||LF.getStructures&&ZF()[63&e];return t?(t.read||(t.read=QF(t,63&e)),t.read()):e}}if(e<144){if(e-=128,LF.mapsAsObjects){let t={};for(let i=0;i<e;i++)t[uU()]=XF();return t}{let t=new Map;for(let i=0;i<e;i++)t.set(XF(),XF());return t}}{e-=144;let t=new Array(e);for(let i=0;i<e;i++)t[i]=XF();return t}}if(e<192){let t=e-160;if(NF>=IF)return TF.slice(IF-BF,(IF+=t)-BF);if(0==NF&&AF<140){let e=t<16?sU(t):oU(t);if(null!=e)return e}return JF(t)}{let t;switch(e){case 192:return null;case 193:return PF?(t=XF(),t>0?PF[1].slice(PF.position1,PF.position1+=t):PF[0].slice(PF.position0,PF.position0-=t)):jF;case 194:return!1;case 195:return!0;case 196:return lU(EF[IF++]);case 197:return t=OF.getUint16(IF),IF+=2,lU(t);case 198:return t=OF.getUint32(IF),IF+=4,lU(t);case 199:return cU(EF[IF++]);case 200:return t=OF.getUint16(IF),IF+=2,cU(t);case 201:return t=OF.getUint32(IF),IF+=4,cU(t);case 202:if(t=OF.getFloat32(IF),LF.useFloat32>2){let e=vU[(127&EF[IF])<<1|EF[IF+1]>>7];return IF+=4,(e*t+(t>0?.5:-.5)|0)/e}return IF+=4,t;case 203:return t=OF.getFloat64(IF),IF+=8,t;case 204:return EF[IF++];case 205:return t=OF.getUint16(IF),IF+=2,t;case 206:return t=OF.getUint32(IF),IF+=4,t;case 207:return LF.int64AsNumber?(t=4294967296*OF.getUint32(IF),t+=OF.getUint32(IF+4)):t=OF.getBigUint64(IF),IF+=8,t;case 208:return OF.getInt8(IF++);case 209:return t=OF.getInt16(IF),IF+=2,t;case 210:return t=OF.getInt32(IF),IF+=4,t;case 211:return LF.int64AsNumber?(t=4294967296*OF.getInt32(IF),t+=OF.getUint32(IF+4)):t=OF.getBigInt64(IF),IF+=8,t;case 212:if(t=EF[IF++],114==t)return hU(63&EF[IF++]);{let e=FF[t];if(e)return e.read?(IF++,e.read(XF())):e.noBuffer?(IF++,e()):e(EF.subarray(IF,++IF));throw new Error("Unknown extension "+t)}case 213:return t=EF[IF],114==t?(IF++,hU(63&EF[IF++],EF[IF++])):cU(2);case 214:return cU(4);case 215:return cU(8);case 216:return cU(16);case 217:return t=EF[IF++],NF>=IF?TF.slice(IF-BF,(IF+=t)-BF):$F(t);case 218:return t=OF.getUint16(IF),NF>=(IF+=2)?TF.slice(IF-BF,(IF+=t)-BF):eU(t);case 219:return t=OF.getUint32(IF),NF>=(IF+=4)?TF.slice(IF-BF,(IF+=t)-BF):tU(t);case 220:return t=OF.getUint16(IF),IF+=2,nU(t);case 221:return t=OF.getUint32(IF),IF+=4,nU(t);case 222:return t=OF.getUint16(IF),IF+=2,rU(t);case 223:return t=OF.getUint32(IF),IF+=4,rU(t);default:if(e>=224)return e-256;if(void 0===e){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}throw new Error("Unknown MessagePack token "+e)}}}var YF=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function QF(e,t){function i(){if(i.count++>2){let i=e.read=new Function("r","return function(){return {"+e.map(e=>YF.test(e)?e+":r()":"["+JSON.stringify(e)+"]:r()").join(",")+"}}")(XF);return 0===e.highByte&&(e.read=KF(t,e.read)),i()}let n={};for(let t=0,i=e.length;t<i;t++){n[e[t]]=XF()}return n}return i.count=0,0===e.highByte?KF(t,i):i}var KF=(e,t)=>function(){let i=EF[IF++];if(0===i)return t();let n=e<32?-(e+(i<<5)):e+(i<<5),r=MF[n]||ZF()[n];if(!r)throw new Error("Record id is not defined for "+n);return r.read||(r.read=QF(r,e)),r.read()};function ZF(){let e=mU(()=>(EF=null,LF.getStructures()));return MF=LF._mergeStructures(e,MF)}var JF=iU,$F=iU,eU=iU,tU=iU;function iU(e){let t;if(e<16&&(t=sU(e)))return t;if(e>64&&wF)return wF.decode(EF.subarray(IF,IF+=e));let i=IF+e,n=[];for(t="";IF<i;){let e=EF[IF++];if(0===(128&e))n.push(e);else if(192===(224&e)){let t=63&EF[IF++];n.push((31&e)<<6|t)}else if(224===(240&e)){let t=63&EF[IF++],i=63&EF[IF++];n.push((31&e)<<12|t<<6|i)}else if(240===(248&e)){let t=(7&e)<<18|(63&EF[IF++])<<12|(63&EF[IF++])<<6|63&EF[IF++];t>65535&&(t-=65536,n.push(t>>>10&1023|55296),t=56320|1023&t),n.push(t)}else n.push(e);n.length>=4096&&(t+=aU.apply(String,n),n.length=0)}return n.length>0&&(t+=aU.apply(String,n)),t}function nU(e){let t=new Array(e);for(let i=0;i<e;i++)t[i]=XF();return t}function rU(e){if(LF.mapsAsObjects){let t={};for(let i=0;i<e;i++)t[uU()]=XF();return t}{let t=new Map;for(let i=0;i<e;i++)t.set(XF(),XF());return t}}var aU=String.fromCharCode;function oU(e){let t=IF,i=new Array(e);for(let n=0;n<e;n++){let e=EF[IF++];if((128&e)>0)return void(IF=t);i[n]=e}return aU.apply(String,i)}function sU(e){if(e<4){if(e<2){if(0===e)return"";{let e=EF[IF++];return(128&e)>1?void(IF-=1):aU(e)}}{let t=EF[IF++],i=EF[IF++];if((128&t)>0||(128&i)>0)return void(IF-=2);if(e<3)return aU(t,i);let n=EF[IF++];return(128&n)>0?void(IF-=3):aU(t,i,n)}}{let t=EF[IF++],i=EF[IF++],n=EF[IF++],r=EF[IF++];if((128&t)>0||(128&i)>0||(128&n)>0||(128&r)>0)return void(IF-=4);if(e<6){if(4===e)return aU(t,i,n,r);{let e=EF[IF++];return(128&e)>0?void(IF-=5):aU(t,i,n,r,e)}}if(e<8){let a=EF[IF++],o=EF[IF++];if((128&a)>0||(128&o)>0)return void(IF-=6);if(e<7)return aU(t,i,n,r,a,o);let s=EF[IF++];return(128&s)>0?void(IF-=7):aU(t,i,n,r,a,o,s)}{let a=EF[IF++],o=EF[IF++],s=EF[IF++],l=EF[IF++];if((128&a)>0||(128&o)>0||(128&s)>0||(128&l)>0)return void(IF-=8);if(e<10){if(8===e)return aU(t,i,n,r,a,o,s,l);{let e=EF[IF++];return(128&e)>0?void(IF-=9):aU(t,i,n,r,a,o,s,l,e)}}if(e<12){let c=EF[IF++],d=EF[IF++];if((128&c)>0||(128&d)>0)return void(IF-=10);if(e<11)return aU(t,i,n,r,a,o,s,l,c,d);let u=EF[IF++];return(128&u)>0?void(IF-=11):aU(t,i,n,r,a,o,s,l,c,d,u)}{let c=EF[IF++],d=EF[IF++],u=EF[IF++],h=EF[IF++];if((128&c)>0||(128&d)>0||(128&u)>0||(128&h)>0)return void(IF-=12);if(e<14){if(12===e)return aU(t,i,n,r,a,o,s,l,c,d,u,h);{let e=EF[IF++];return(128&e)>0?void(IF-=13):aU(t,i,n,r,a,o,s,l,c,d,u,h,e)}}{let p=EF[IF++],f=EF[IF++];if((128&p)>0||(128&f)>0)return void(IF-=14);if(e<15)return aU(t,i,n,r,a,o,s,l,c,d,u,h,p,f);let m=EF[IF++];return(128&m)>0?void(IF-=15):aU(t,i,n,r,a,o,s,l,c,d,u,h,p,f,m)}}}}}function lU(e){return LF.copyBuffers?Uint8Array.prototype.slice.call(EF,IF,IF+=e):EF.subarray(IF,IF+=e)}function cU(e){let t=EF[IF++];if(FF[t])return FF[t](EF.subarray(IF,IF+=e));throw new Error("Unknown extension type "+t)}var dU=new Array(4096);function uU(){let e=EF[IF++];if(!(e>=160&&e<192))return IF--,XF();if(e-=160,NF>=IF)return TF.slice(IF-BF,(IF+=e)-BF);if(!(0==NF&&AF<180))return JF(e);let t,i=4095&(e<<5^(e>1?OF.getUint16(IF):e>0?EF[IF]:0)),n=dU[i],r=IF,a=IF+e-3,o=0;if(n&&n.bytes==e){for(;r<a;){if(t=OF.getUint32(r),t!=n[o++]){r=1879048192;break}r+=4}for(a+=3;r<a;)if(t=EF[r++],t!=n[o++]){r=1879048192;break}if(r===a)return IF=r,n.string;a-=3,r=IF}for(n=[],dU[i]=n,n.bytes=e;r<a;)t=OF.getUint32(r),n.push(t),r+=4;for(a+=3;r<a;)t=EF[r++],n.push(t);let s=e<16?sU(e):oU(e);return n.string=null!=s?s:JF(e)}var hU=(e,t)=>{var i=XF();let n=e;void 0!==t&&(e=e<32?-((t<<5)+e):(t<<5)+e,i.highByte=t);let r=MF[e];return r&&r.isShared&&((MF.restoreStructures||(MF.restoreStructures=[]))[e]=r),MF[e]=i,i.read=QF(i,n),i.read()},pU="object"==typeof self?self:global;FF[0]=()=>{},FF[0].noBuffer=!0,FF[101]=()=>{let e=XF();return(pU[e[0]]||Error)(e[1])},FF[105]=e=>{let t=OF.getUint32(IF-4);DF||(DF=new Map);let i,n=EF[IF];i=n>=144&&n<160||220==n||221==n?[]:{};let r={target:i};DF.set(t,r);let a=XF();return r.used?Object.assign(i,a):(r.target=a,a)},FF[112]=e=>{let t=OF.getUint32(IF-4),i=DF.get(t);return i.used=!0,i.target},FF[115]=()=>new Set(XF());var fU=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");function mU(e){let t=AF,i=IF,n=zF,r=BF,a=NF,o=TF,s=RF,l=DF,c=PF,d=new Uint8Array(EF.slice(0,AF)),u=MF,h=MF.slice(0,MF.length),p=LF,f=WF,m=e();return AF=t,IF=i,zF=n,BF=r,NF=a,TF=o,RF=s,DF=l,PF=c,EF=d,WF=f,(MF=u).splice(0,MF.length,...h),LF=p,OF=new DataView(EF.buffer,EF.byteOffset,EF.byteLength),m}function gU(){EF=null,DF=null,MF=null}FF[116]=e=>{let t=e[0],i=fU[t];if(!i)throw new Error("Could not find typed array for code "+t);return new pU[i](Uint8Array.prototype.slice.call(e,1).buffer)},FF[120]=()=>{let e=XF();return new RegExp(e[0],e[1])},FF[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],i=IF;IF+=t-4,(PF=[XF(),XF()]).position0=0,PF.position1=0;let n=IF;IF=i;try{return XF()}finally{IF=n}},FF[255]=e=>4==e.length?new Date(1e3*(16777216*e[0]+(e[1]<<16)+(e[2]<<8)+e[3])):8==e.length?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+1e3*(4294967296*(3&e[3])+16777216*e[4]+(e[5]<<16)+(e[6]<<8)+e[7])):12==e.length?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+1e3*((128&e[4]?-281474976710656:0)+1099511627776*e[6]+4294967296*e[7]+16777216*e[8]+(e[9]<<16)+(e[10]<<8)+e[11])):new Date("invalid");var vU=new Array(147);for(let i=0;i<256;i++)vU[i]=+("1e"+Math.floor(45.15-.30103*i));var yU,bU=new HF({useRecords:!1}),xU=(bU.unpack,bU.unpackMultiple,bU.unpack,new Float32Array(1));new Uint8Array(xU.buffer,0,4);try{yU=new TextEncoder}catch(Tne){}var wU,SU,_U,CU,EU,AU=typeof Buffer<"u",MU=AU?Buffer.allocUnsafeSlow:Uint8Array,TU=AU?Buffer:Uint8Array,PU=AU?4294967296:2144337920,DU=0,OU=null,IU=/[\u0080-\uFFFF]/,kU=Symbol("record-id"),RU=class extends HF{constructor(e){super(e),this.offset=0;let t,i,n,r,a,o=0,s=TU.prototype.utf8Write?function(e,t,i){return _U.utf8Write(e,t,i)}:!(!yU||!yU.encodeInto)&&function(e,t){return yU.encodeInto(e,_U.subarray(t)).written},l=this;e||(e={});let c=e&&e.sequential,d=e.structures||e.saveStructures,u=e.maxSharedStructures;if(null==u&&(u=d?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");let h=e.maxOwnStructures;null==h&&(h=d?32:64),c&&!e.saveStructures&&(this.structures=[]);let p=u>32||h+u>64,f=u+64,m=u+h+64;if(m>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],v=0,y=0;this.pack=this.encode=function(e,s){if(_U||(_U=new MU(8192),CU=new DataView(_U.buffer,0,8192),DU=0),(EU=_U.length-10)-DU<2048?(_U=new MU(_U.length),CU=new DataView(_U.buffer,0,_U.length),EU=_U.length-10,DU=0):DU=DU+7&2147483640,t=DU,a=l.structuredClone?new Map:null,l.bundleStrings?(OU=["",""],_U[DU++]=214,_U[DU++]=98,OU.position=DU-t,DU+=4):OU=null,i=l.structures,i){i.uninitialized&&(i=l._mergeStructures(l.getStructures()));let e=i.sharedLength||0;if(e>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let t=0;t<e;t++){let e=i[t];if(!e)continue;let n,r=i.transitions;for(let t=0,i=e.length;t<i;t++){let i=e[t];n=r[i],n||(n=r[i]=Object.create(null)),r=n}r[kU]=t+64}o=e}c||(i.nextId=e+64)}n&&(n=!1),r=i||[];try{if(b(e),OU){CU.setUint32(OU.position+t,DU-OU.position-t);let e=OU;OU=null,b(e[0]),b(e[1])}if(l.offset=DU,a&&a.idsToInsert){(DU+=6*a.idsToInsert.length)>EU&&w(DU),l.offset=DU;let e=function(e,t){let i,n=6*t.length,r=e.length-n;for(t.sort((e,t)=>e.offset>t.offset?1:-1);i=t.pop();){let t=i.offset,a=i.id;e.copyWithin(t+n,t,r),n-=6;let o=t+n;e[o++]=214,e[o++]=105,e[o++]=a>>24,e[o++]=a>>16&255,e[o++]=a>>8&255,e[o++]=255&a,r=t}return e}(_U.subarray(t,DU),a.idsToInsert);return a=null,e}return s&XU?(_U.start=t,_U.end=DU,_U):_U.subarray(t,DU)}finally{if(i){if(y<10&&y++,v>1e4)i.transitions=null,y=0,v=0,g.length>0&&(g=[]);else if(g.length>0&&!c){for(let e=0,t=g.length;e<t;e++)g[e][kU]=0;g=[]}if(n&&l.saveStructures){let n=i.sharedLength||u;i.length>n&&(i=i.slice(0,n));let r=_U.subarray(t,DU);return!1===l.saveStructures(i,o)?(l._mergeStructures(l.getStructures()),l.pack(e)):(o=n,r)}}s&YU&&(DU=t)}};let b=e=>{DU>EU&&(_U=w(DU));var i,n=typeof e;if("string"===n){let t,n=e.length;if(OU&&n>=8&&n<4096){let t=IU.test(e);return OU[t?0:1]+=e,_U[DU++]=193,void b(t?-n:n)}t=n<32?1:n<256?2:n<65536?3:5;let r=3*n;if(DU+r>EU&&(_U=w(DU+r)),n<64||!s){let r,a,o,s=DU+t;for(r=0;r<n;r++)a=e.charCodeAt(r),a<128?_U[s++]=a:a<2048?(_U[s++]=a>>6|192,_U[s++]=63&a|128):55296===(64512&a)&&56320===(64512&(o=e.charCodeAt(r+1)))?(a=65536+((1023&a)<<10)+(1023&o),r++,_U[s++]=a>>18|240,_U[s++]=a>>12&63|128,_U[s++]=a>>6&63|128,_U[s++]=63&a|128):(_U[s++]=a>>12|224,_U[s++]=a>>6&63|128,_U[s++]=63&a|128);i=s-DU-t}else i=s(e,DU+t,r);i<32?_U[DU++]=160|i:i<256?(t<2&&_U.copyWithin(DU+2,DU+1,DU+1+i),_U[DU++]=217,_U[DU++]=i):i<65536?(t<3&&_U.copyWithin(DU+3,DU+2,DU+2+i),_U[DU++]=218,_U[DU++]=i>>8,_U[DU++]=255&i):(t<5&&_U.copyWithin(DU+5,DU+3,DU+3+i),_U[DU++]=219,CU.setUint32(DU,i),DU+=4),DU+=i}else if("number"===n)if(e>>>0===e)e<64?_U[DU++]=e:e<256?(_U[DU++]=204,_U[DU++]=e):e<65536?(_U[DU++]=205,_U[DU++]=e>>8,_U[DU++]=255&e):(_U[DU++]=206,CU.setUint32(DU,e),DU+=4);else if((e|0)===e)e>=-32?_U[DU++]=256+e:e>=-128?(_U[DU++]=208,_U[DU++]=e+256):e>=-32768?(_U[DU++]=209,CU.setInt16(DU,e),DU+=2):(_U[DU++]=210,CU.setInt32(DU,e),DU+=4);else{let t;if((t=this.useFloat32)>0&&e<4294967296&&e>=-2147483648){let i;if(_U[DU++]=202,CU.setFloat32(DU,e),t<4||((i=e*vU[(127&_U[DU])<<1|_U[DU+1]>>7])|0)===i)return void(DU+=4);DU--}_U[DU++]=203,CU.setFloat64(DU,e),DU+=8}else if("object"===n)if(e){if(a){let i=a.get(e);if(i){if(!i.id){let e=a.idsToInsert||(a.idsToInsert=[]);i.id=e.push(i)}return _U[DU++]=214,_U[DU++]=112,CU.setUint32(DU,i.id),void(DU+=4)}a.set(e,{offset:DU-t})}let n=e.constructor;if(n===Object)x(e,!0);else if(n===Array){(i=e.length)<16?_U[DU++]=144|i:i<65536?(_U[DU++]=220,_U[DU++]=i>>8,_U[DU++]=255&i):(_U[DU++]=221,CU.setUint32(DU,i),DU+=4);for(let t=0;t<i;t++)b(e[t])}else if(n===Map){(i=e.size)<16?_U[DU++]=128|i:i<65536?(_U[DU++]=222,_U[DU++]=i>>8,_U[DU++]=255&i):(_U[DU++]=223,CU.setUint32(DU,i),DU+=4);for(let[t,i]of e)b(t),b(i)}else{for(let t=0,i=wU.length;t<i;t++){if(e instanceof SU[t]){let i=wU[t];if(i.write)return i.type&&(_U[DU++]=212,_U[DU++]=i.type,_U[DU++]=0),void b(i.write.call(this,e));let n,r=_U,a=CU,o=DU;_U=null;try{n=i.pack.call(this,e,e=>(_U=r,r=null,(DU+=e)>EU&&w(DU),{target:_U,targetView:CU,position:DU-e}),b)}finally{r&&(CU=a,DU=o,EU=(_U=r).length-10)}return void(n&&(n.length+DU>EU&&w(n.length+DU),DU=BU(n,_U,DU,i.type)))}}x(e,!e.hasOwnProperty)}}else _U[DU++]=192;else if("boolean"===n)_U[DU++]=e?195:194;else if("bigint"===n){if(e<BigInt(1)<<BigInt(63)&&e>=-(BigInt(1)<<BigInt(63)))_U[DU++]=211,CU.setBigInt64(DU,e);else if(e<BigInt(1)<<BigInt(64)&&e>0)_U[DU++]=207,CU.setBigUint64(DU,e);else{if(!this.largeBigIntToFloat)throw new RangeError(e+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");_U[DU++]=203,CU.setFloat64(DU,Number(e))}DU+=8}else if("undefined"===n)this.encodeUndefinedAsNil?_U[DU++]=192:(_U[DU++]=212,_U[DU++]=0,_U[DU++]=0);else{if("function"!==n)throw new Error("Unknown type: "+n);b(this.writeFunction&&this.writeFunction())}},x=!1===this.useRecords?this.variableMapSize?e=>{let t,i=Object.keys(e),n=i.length;n<16?_U[DU++]=128|n:n<65536?(_U[DU++]=222,_U[DU++]=n>>8,_U[DU++]=255&n):(_U[DU++]=223,CU.setUint32(DU,n),DU+=4);for(let r=0;r<n;r++)b(t=i[r]),b(e[t])}:(e,i)=>{_U[DU++]=222;let n=DU-t;DU+=2;let r=0;for(let t in e)(i||e.hasOwnProperty(t))&&(b(t),b(e[t]),r++);_U[n+++t]=r>>8,_U[n+t]=255&r}:e=>{let t,i=Object.keys(e),a=r.transitions||(r.transitions=Object.create(null)),o=0;for(let n=0,r=i.length;n<r;n++){let e=i[n];t=a[e],t||(t=a[e]=Object.create(null),o++),a=t}let s=a[kU];if(s)s>=96&&p?(_U[DU++]=96+(31&(s-=96)),_U[DU++]=s>>5):_U[DU++]=s;else{s=r.nextId,s||(s=64),s<f&&this.shouldShareStructure&&!this.shouldShareStructure(i)?(s=r.nextOwnId,s<m||(s=f),r.nextOwnId=s+1):(s>=m&&(s=f),r.nextId=s+1);let e=i.highByte=s>=96&&p?s-96>>5:-1;a[kU]=s,r[s-64]=i,s<f?(i.isShared=!0,r.sharedLength=s-63,n=!0,e>=0?(_U[DU++]=96+(31&s),_U[DU++]=e):_U[DU++]=s):(e>=0?(_U[DU++]=213,_U[DU++]=114,_U[DU++]=96+(31&s),_U[DU++]=e):(_U[DU++]=212,_U[DU++]=114,_U[DU++]=s),o&&(v+=y*o),g.length>=h&&(g.shift()[kU]=0),g.push(a),b(i))}for(let n=0,r=i.length;n<r;n++)b(e[i[n]])},w=e=>{let i;if(e>16777216){if(e-t>PU)throw new Error("Packed buffer would be larger than maximum buffer size");i=Math.min(PU,4096*Math.round(Math.max((e-t)*(e>67108864?1.25:2),4194304)/4096))}else i=1+(Math.max(e-t<<2,_U.length-1)>>12)<<12;let n=new MU(i);return CU=new DataView(n.buffer,0,i),_U.copy?_U.copy(n,0,t,e):n.set(_U.slice(t,e)),DU-=t,t=0,EU=n.length-10,_U=n}}useBuffer(e){_U=e,CU=new DataView(_U.buffer,_U.byteOffset,_U.byteLength),DU=0}};function zU(e,t,i,n){let r=e.byteLength;if(r+1<256){var{target:a,position:o}=i(4+r);a[o++]=199,a[o++]=r+1}else if(r+1<65536){var{target:a,position:o}=i(5+r);a[o++]=200,a[o++]=r+1>>8,a[o++]=r+1&255}else{var{target:a,position:o,targetView:s}=i(7+r);a[o++]=201,s.setUint32(o,r+1),o+=4}a[o++]=116,a[o++]=t,a.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),o)}function LU(e,t){let i=e.byteLength;var n,r;if(i<256){var{target:n,position:r}=t(i+2);n[r++]=196,n[r++]=i}else if(i<65536){var{target:n,position:r}=t(i+3);n[r++]=197,n[r++]=i>>8,n[r++]=255&i}else{var{target:n,position:r,targetView:a}=t(i+5);n[r++]=198,a.setUint32(r,i),r+=4}n.set(e,r)}function BU(e,t,i,n){let r=e.length;switch(r){case 1:t[i++]=212;break;case 2:t[i++]=213;break;case 4:t[i++]=214;break;case 8:t[i++]=215;break;case 16:t[i++]=216;break;default:r<256?(t[i++]=199,t[i++]=r):r<65536?(t[i++]=200,t[i++]=r>>8,t[i++]=255&r):(t[i++]=201,t[i++]=r>>24,t[i++]=r>>16&255,t[i++]=r>>8&255,t[i++]=255&r)}return t[i++]=n,t.set(e,i),i+=r}function NU(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");SU.unshift(e.Class),wU.unshift(e)}!function(e){e.unpack?FF[e.type]=e.unpack:FF[e.type]=e}(e)}SU=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,VF],wU=[{pack(e,t,i){let n=e.getTime()/1e3;if((this.useTimestamp32||0===e.getMilliseconds())&&n>=0&&n<4294967296){let{target:e,targetView:i,position:r}=t(6);e[r++]=214,e[r++]=255,i.setUint32(r,n)}else if(n>0&&n<17179869184){let{target:i,targetView:r,position:a}=t(10);i[a++]=215,i[a++]=255,r.setUint32(a,4e6*e.getMilliseconds()+(n/1e3/4294967296|0)),r.setUint32(a+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return t(0),i(this.onInvalidDate());let{target:e,targetView:n,position:r}=t(3);e[r++]=212,e[r++]=255,e[r++]=255}else{let{target:i,targetView:r,position:a}=t(15);i[a++]=199,i[a++]=12,i[a++]=255,r.setUint32(a,1e6*e.getMilliseconds()),r.setBigInt64(a+4,BigInt(Math.floor(n)))}}},{pack(e,t,i){let n=Array.from(e),{target:r,position:a}=t(this.structuredClone?3:0);this.structuredClone&&(r[a++]=212,r[a++]=115,r[a++]=0),i(n)}},{pack(e,t,i){let{target:n,position:r}=t(this.structuredClone?3:0);this.structuredClone&&(n[r++]=212,n[r++]=101,n[r++]=0),i([e.name,e.message])}},{pack(e,t,i){let{target:n,position:r}=t(this.structuredClone?3:0);this.structuredClone&&(n[r++]=212,n[r++]=120,n[r++]=0),i([e.source,e.flags])}},{pack(e,t){this.structuredClone?zU(e,16,t):LU(AU?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let i=e.constructor;i!==TU&&this.structuredClone?zU(e,fU.indexOf(i.name),t):LU(e,t)}},{pack(e,t){let{target:i,position:n}=t(1);i[n]=193}}];var FU,UU,VU,jU=new RU({useRecords:!1}),{NEVER:WU,ALWAYS:HU,DECIMAL_ROUND:GU,DECIMAL_FIT:qU}=(jU.pack,jU.pack,{NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4}),XU=512,YU=1024,QU=new RU({structuredClone:!0});function KU(e){if(zN(e))return e;if(Array.isArray(e))return e.map(KU);if("object"==typeof e&&null!==e){let t={};for(let i of Object.keys(e).sort())t[i]=KU(e[i]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}return e}function ZU(e){return"MouseDown"===e||"MouseUp"===e||"KeyDown"===e||"KeyUp"===e||"Collision"===e||"Trigger"===e}NU({Class:DN.prototype.constructor,type:1,write:e=>c({},e),read:e=>(Object.setPrototypeOf(e,DN.prototype),e)}),NU({Class:UN.prototype.constructor,type:2,write:e=>[...e],read:e=>(Object.setPrototypeOf(e,UN.prototype),e)}),NU({Class:FN.prototype.constructor,type:3,write:e=>[...e],read:e=>(Object.setPrototypeOf(e,FN.prototype),e)}),NU({Class:_F.prototype.constructor,type:4,write:e=>e.id,read:e=>new _F(e)}),NU({Class:CF.prototype.constructor,type:5,write:e=>e.data,read:e=>new CF(e)}),NU({Class:XN.prototype.constructor,type:6,write:e=>c({},e),read:e=>(Object.setPrototypeOf(e,XN.prototype),e)}),(e=>{function t(e){return QU.pack(e)}e.serialize=t,e.deserialize=function(e){return QU.unpack(e)},e.checksum=function(e){return function(e){var t=0;if(0===e.length)return t;for(let i=0;i<e.length;i++)t=(t<<5)-t+e[i],t&=t;return t}(t(KU(e))).toString()}})(FU||(FU={})),(VU=UU||(UU={})).toEventUIType=function(e){return"Conditional"===e.type?"Distance"===e.condition.type?"Distance":"StateChange":e.type},VU.fromEventUIType=function(e){return"Distance"===e||"StateChange"===e?"Conditional":e};var JU,$U,eV,tV,iV,nV,rV,aV,oV,sV,lV,cV,dV,uV,hV,pV,fV,mV,gV,vV,yV={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Particles","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseHover:["Transition","Animation","Particles","Create","Destroy","SwitchCamera","SceneTransition","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Scroll:["Transition","Animation","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Start:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Conditional:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MousePress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyPress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],GameControl:["Transition","Animation","Audio","Particles","Create","Conditional"],Collision:["Transition","Animation","Audio","Particles","Video","Create","Destroy","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Trigger:["Transition","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Resize:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],VariableChange:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],API:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],WEBHOOK:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],AIAssistantListener:["SetVariable"],AIAssistantTrigger:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"]};(e=>{e.is=function(e){return"MouseDown"===e.type||"MouseUp"===e.type||"MousePress"===e.type||"KeyDown"===e.type||"KeyUp"===e.type||"KeyPress"===e.type},e.defaultData=function(e){return"MouseDown"===e||"MouseUp"===e||"MousePress"===e?{type:e,mode:"Object",disabled:!1,actions:new UN}:{type:e,disabled:!1,key:void 0,actions:new UN}}})(JU||(JU={})),(e=>{e.propertyDefaultData=function(e){return{type:"Property",value:[null!==e&&void 0!==e?e:null,"position","x"]}},e.valueDefaultData={type:"Literal",value:0}})($U||($U={})),(e=>{e.comparisonDefaultData=function(e){return{type:"Comparison",operator:"==",lOperand:$U.propertyDefaultData(e),rOperand:c({},$U.valueDefaultData)}},e.distanceDefaultData=function(e){return{type:"Distance",toObject:null!==e&&void 0!==e?e:null,fromObject:null!==e&&void 0!==e?e:null,distance:200}},e.stateDefaultData=function(e,t){return{type:"State",object:null!==e&&void 0!==e?e:null,state:null!==t&&void 0!==t?t:null}}})(eV||(eV={})),(e=>{e.isConditionalSubActions=function(e){return void 0!==e.find(e=>"ifActions"===e||"elseActions"===e)}})(tV||(tV={})),(e=>{e.is=function(e){return"Conditional"===e.type},e.defaultData=function(e){return{type:"Conditional",disabled:!1,inActions:new UN,outActions:new UN,condition:eV.distanceDefaultData(e)}}})(iV||(iV={})),(e=>{e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new UN,drop:new UN}}})(nV||(nV={})),(e=>{e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new UN}})(rV||(rV={})),(e=>{e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5}})(aV||(aV={})),(e=>{e.is=function(e){return"MouseHover"===e.type},e.defaultData=function(){return{type:"MouseHover",disabled:!1,actions:new UN}}})(oV||(oV={})),(e=>{e.is=function(e){return"Scroll"===e.type},e.defaultData=function(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new UN}}})(sV||(sV={})),(e=>{e.is=function(e){return"Start"===e.type},e.defaultData=function(){return{type:"Start",disabled:!1,actions:new UN}}})(lV||(lV={})),(e=>{e.is=function(e){return"Collision"===e.type},e.defaultData=function(){return{type:"Collision",disabled:!1,target:"character",actions:new UN}}})(cV||(cV={})),(e=>{e.is=function(e){return"Trigger"===e.type},e.defaultData=function(e,t){return{type:"Trigger",disabled:!1,target:"all",triggeringObjects:[],actions:new UN,triggerZone:"box",position:t.toArray(),rotation:[0,0,0],size:e.toArray(),radius:e.length()/2,helperVisible:!0}}})(dV||(dV={})),(hV=uV||(uV={})).defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]},hV.is=function(e){return"Resize"===e.type},hV.sizeToDevice=function(e){return"string"==typeof e?e:"custom"},hV.deviceToSize=function(e){return"string"==typeof e?[...hV.defaultSizes[e]]:[...e]},hV.defaultData=function(){let e={size:"mobile",operator:"<",actions:new UN},t={size:"tablet",operator:"<",actions:new UN},i={size:[...hV.defaultSizes.custom],operator:"<>",actions:new UN},n=new UN;return n.push({id:h_.generateUUID(),fi:0,data:e},{id:h_.generateUUID(),fi:1,data:t},{id:h_.generateUUID(),fi:2,data:i}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:n}},hV.defaultBreakpointData=function(){return{size:[...hV.defaultSizes.custom],operator:"<>",actions:new UN}},(e=>{e.propertyPaths={Position:["position"],"Position X":["position","x"],"Position Y":["position","y"],"Position Z":["position","z"],Rotation:["rotation"],"Rotation X":["rotation","x"],"Rotation Y":["rotation","y"],"Rotation Z":["rotation","z"],Scale:["scale"],"Scale X":["scale","x"],"Scale Y":["scale","y"],"Scale Z":["scale","z"],Width:["width"],Height:["height"],Depth:["depth"],"Mouse Position X":["mouse","x"],"Mouse Position Y":["mouse","y"],"Mouse Pressed":["mouse","pressed"],"Screen Width":["mouse","width"],"Screen Height":["mouse","height"],"Hit Position X":["raycast","x"],"Hit Position Y":["raycast","y"],"Hit Position Z":["raycast","z"],"Hit Object Position X":["raycast","objX"],"Hit Object Position Y":["raycast","objY"],"Hit Object Position Z":["raycast","objZ"]},e.is=function(e){return"VariableChange"===e.type},e.defaultData=function(){return{disabled:!1,type:"VariableChange",actions:new UN,variableId:"",objectId:null,property:"Position X"}}})(pV||(pV={})),(e=>{e.is=function(e){return"API"===e.type},e.defaultData=function(){return{disabled:!1,type:"API",successActions:new UN,errorActions:new UN,userAPIId:""}}})(fV||(fV={})),(e=>{e.is=function(e){return"WEBHOOK"===e.type},e.defaultData=function(){return{disabled:!1,type:"WEBHOOK",actions:new UN,userWebhookId:""}}})(mV||(mV={})),(e=>{e.is=function(e){return"AIAssistantListener"===e.type},e.defaultData=function(){return{disabled:!1,type:"AIAssistantListener",actions:new UN,analysis:"average",analysisRange:[0,71],analysisSingle:0}}})(gV||(gV={})),(e=>{e.is=function(e){return"AIAssistantTrigger"===e.type},e.defaultData=function(){return{disabled:!1,description:"",type:"AIAssistantTrigger",actions:new UN}}})(vV||(vV={}));var bV,xV,wV,SV,_V,CV,EV,AV,MV,TV,PV,DV,OV="personal camera",IV="a218fcc3-276b-49b9-b485-49037fd14f5f",kV=5526619;(e=>{function t(e,t){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function i(e,i){return Math.sqrt(t(e,i))}function n(t,i,n){let r=e.sub(i,t),a=e.sub(n,t),o=e.dot(r,a)/e.dot(r,r),s=e.scalarMultiply(r,o);return e.add(t,s)}e.isEqual=function(e,t){return e[0]===t[0]&&e[1]===t[1]},e.lerp=function(e,t,i){return[e[0]+(t[0]-e[0])*i,e[1]+(t[1]-e[1])*i]},e.add=function(e,t){return[e[0]+t[0],e[1]+t[1]]},e.sub=function(e,t){return[e[0]-t[0],e[1]-t[1]]},e.multiply=function(e,t){return[e[0]*t[0],e[1]*t[1]]},e.divide=function(e,t){return[e[0]/t[0],e[1]/t[1]]},e.distanceSquared=t,e.distance=i,e.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},e.scalarMultiply=function(e,t){return[e[0]*t,e[1]*t]},e.projectionOnto=n,e.projectionOntoDistance=function(e,t,r){return i(e,n(e,t,r))},e.center=function(e,t){return[.5*(e[0]+t[0]),.5*(e[1]+t[1])]}})(bV||(bV={})),(wV=xV||(xV={})).isEqual=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},wV.add=function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]},wV.sub=function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]},wV.div=function(e,t){return[e[0]/t[0],e[1]/t[1],e[2]/t[2]]},wV.mul=function(e,t){return[e[0]*t[0],e[1]*t[1],e[2]*t[2]]},wV.dist=function(e,t){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])},wV.lerp=function(e,t,i){return[e[0]+(t[0]-e[0])*i,e[1]+(t[1]-e[1])*i,e[2]+(t[2]-e[2])*i]},(e=>{e.isEqual=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},e.lerp=function(e,t,i){return[e[0]+(t[0]-e[0])*i,e[1]+(t[1]-e[1])*i,e[2]+(t[2]-e[2])*i,e[3]+(t[3]-e[3])*i]}})(SV||(SV={})),(e=>{let t=180/Math.PI,i=Math.PI/180;function n(e){return"number"==typeof e?e*t:e}function r(e){return"number"==typeof e?e*i:e}e.radToDeg=function(e){return[n(e[0]),n(e[1]),n(e[2])]},e.degToRad=function(e){return[r(e[0]),r(e[1]),r(e[2])]}})(_V||(_V={})),(EV=CV||(CV={})).identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],EV.isEqual=function(e,t){for(let i=0;i<16;i++)if(e[i]!==t[i])return!1;return!0},EV.simplify=function(e){return null!==e&&void 0!==e?e:EV.identity},EV.applyMatrix4=function(e,t){let i=t.slice(0);for(var n=0,r=t.length;n<r;n+=3){let r=e[3]*t[n]+e[7]*t[n+1]+e[11]*t[n+2]+e[15];i[n]=(e[0]*t[n]+e[4]*t[n+1]+e[8]*t[n+2]+e[12])/r,i[n+1]=(e[1]*t[n]+e[5]*t[n+1]+e[9]*t[n+2]+e[13])/r,i[n+2]=(e[2]*t[n]+e[6]*t[n+1]+e[10]*t[n+2]+e[14])/r}return i},(MV=AV||(AV={})).isRGB=function(e){return"object"==typeof e&&"number"==typeof e.r&&"number"==typeof e.g&&"number"==typeof e.b},MV.white={r:1,g:1,b:1},MV.red={r:1,g:0,b:0},MV.black={r:0,g:0,b:0},MV.toRgb255a1=function(e){return{r:Math.round(255*e.r),g:Math.round(255*e.g),b:Math.round(255*e.b),a:1}},MV.clone=function(e){return{r:e.r,g:e.g,b:e.b}},MV.fromHex=function(e){return{r:((e=Math.floor(e))>>16&255)/255,g:(e>>8&255)/255,b:(255&e)/255}},MV.toHex=function(e){return 65536*Math.round(255*e.r)+256*Math.round(255*e.g)+Math.round(255*e.b)},MV.equals=function(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b},MV.equalsFixed=function(e,t){return e.r.toFixed(2)===t.r.toFixed(2)&&e.g.toFixed(2)===t.g.toFixed(2)&&e.b.toFixed(2)===t.b.toFixed(2)},MV.lerp=function(e,t,i){return{r:e.r+(t.r-e.r)*i,g:e.g+(t.g-e.g)*i,b:e.b+(t.b-e.b)*i}},(PV=TV||(TV={})).white=c(c({},AV.white),{},{a:1}),PV.transparent=c(c({},AV.white),{},{a:0}),PV.from0to1=function(e){return{r:e[0],g:e[1],b:e[2],a:e[3]}},PV.fromHexAndA=function(e,t){return c(c({},AV.fromHex(e)),{},{a:t})},PV.toRgb255a1=function(e){return{r:Math.round(255*e.r),g:Math.round(255*e.g),b:Math.round(255*e.b),a:e.a}},PV.equals=function(e,t){return AV.equals(e,t)&&e.a===t.a},PV.equalsFixed=function(e,t){return AV.equalsFixed(e,t)&&e.a.toFixed(2)===t.a.toFixed(2)},PV.lerp=function(e,t,i){return{r:e.r+(t.r-e.r)*i,g:e.g+(t.g-e.g)*i,b:e.b+(t.b-e.b)*i,a:e.a+(t.a-e.a)*i}},PV.toStyle=function(){let{r:e,g:t,b:i,a:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:PV.white;return"rgba(".concat(255*e,", ").concat(255*t,", ").concat(255*i,", ").concat(n,")")},(e=>{e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]}})(DV||(DV={}));var RV,zV,LV,BV,NV,FV,UV,VV,jV=(e=>(e[e.LINEAR=0]="LINEAR",e[e.EASE=1]="EASE",e[e.EASE_IN=2]="EASE_IN",e[e.EASE_OUT=3]="EASE_OUT",e[e.EASE_IN_OUT=4]="EASE_IN_OUT",e[e.CUBIC=5]="CUBIC",e[e.SPRING=6]="SPRING",e))(jV||{});function WV(e){return"string"==typeof e&&36===e.length&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)}(e=>{e.defaultData={mass:1,stiffness:80,damping:10,velocity:0}})(RV||(RV={})),(e=>{e.defaultData={control1:[.5,0],control2:[.5,1]}})(zV||(zV={})),(BV=LV||(LV={})).linear=[0,0,1,1],BV.ease=[.25,.1,.25,1],BV.easeIn=[.42,0,1,1],BV.easeOut=[0,0,.58,1],BV.easeInOut=[.42,0,.58,1],(e=>{e.all=["PerspectiveCamera","OrthographicCamera"],e.is=function(t){return e.all.includes(t)}})(NV||(NV={})),(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset},e.getZoom=function(e){var t,i,n,r;return"PerspectiveCamera"===e.type?null!==(t=null===(i=e.perspective)||void 0===i?void 0:i.zoom)&&void 0!==t?t:1:null!==(n=null===(r=e.orthographic)||void 0===r?void 0:r.zoom)&&void 0!==n?n:1}})(FV||(FV={})),(e=>{e.defaultData=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:2*Math.max(e[0],e[1]),start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[e[0]+e[0]*t,0,0]},grid:{count:[2,2,2],size:e.map(e=>e*(1+t)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}},e.merge=function(e,t){let i=c({},e);if(tj.forEach(n=>{var r;Object.assign(i,{[n]:null!==(r=t[n])&&void 0!==r?r:e[n]})}),i.radial=c({},e.radial),t.radial){let n=e.radial,r=t.radial;ij.forEach(e=>{var t;Object.assign(i.radial,{[e]:null!==(t=r[e])&&void 0!==t?t:n[e]})})}if(i.linear=c({},e.linear),t.linear){let n=e.linear,r=t.linear;nj.forEach(e=>{var t;Object.assign(i.linear,{[e]:null!==(t=r[e])&&void 0!==t?t:n[e]})})}if(i.grid=c({},e.grid),t.grid){let n=e.grid,r=t.grid;rj.forEach(e=>{var t;Object.assign(i.grid,{[e]:null!==(t=r[e])&&void 0!==t?t:n[e]})})}if(i.toObject=c({},e.toObject),t.toObject){let n=e.toObject,r=t.toObject;aj.forEach(e=>{var t;Object.assign(i.toObject,{[e]:null!==(t=r[e])&&void 0!==t?t:n[e]})})}if(i.randomnessObject=c({},e.randomnessObject),t.randomnessObject){let n=e.randomnessObject,r=t.randomnessObject;oj.forEach(e=>{var t;Object.assign(i.randomnessObject,{[e]:null!==(t=r[e])&&void 0!==t?t:n[e]})})}return i}})(UV||(UV={})),(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];e.toOps=function(e,i){let n=[];void 0!==e.count&&n.push({type:0,path:i,props:{count:e.count}});for(let r of t){let t=e[r];t&&Object.keys(t).length>0&&n.push({type:0,path:[...i,r],props:t})}return n}})(VV||(VV={}));var HV,GV,qV,XV,YV,QV,KV,ZV,JV,$V,ej,tj=["count"],ij=["radius","start","end","position","scale","rotation"],nj=["position","scale","rotation"],rj=["count","size"],aj=["count","position","scale","rotation"],oj=["strength","scale","rotation","position","movement","seed","freqScale"];(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"],e.is=function(t){return e.all.includes(t)}})(HV||(HV={})),(e=>{e.defaultData=function(e){return function(e){if("PointLight"===e)return{type:e,color:TV.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if("SpotLight"===e)return{type:e,color:TV.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if("DirectionalLight"===e)return{type:e,color:TV.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}(e)}})(GV||(GV={})),(e=>{e.defaultShapeData={type:"PlaneEmitterShape",size:[100,100,100]},e.defaultCollisionData={colliderEntityId:null,collisionBounce:.75},e.defaultData=c({renderMaterial:{type:"particleMaterial",color:{r:1,g:.2,b:.545,a:1},color2:{r:.945,g:.714,b:.184,a:1},coloring:"gradient",ease:"linearFadeOut",easeSize:"linearFadeOut",transparent:!0,size:[40,40],texture:"pt_default_particle",spriteRotation:[0,0]},birthRatePerSec:50,gravity:1,noiseStrength:0,noiseScale:0,noiseSeed:1,noiseType:"curl",randomRotation:0,randomScale:.2,randomMass:.5,rootObjectType:"instancedMesh",life:1,direction:[0,0,0],directionMode:"axis",speed:10,shape:e.defaultShapeData,autoPlay:!0,emitTimeDelay:0,emitTimeCycle:"infinity",emitTimeDuration:1},e.defaultCollisionData)})(qV||(qV={})),(e=>{e.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]}})(XV||(XV={})),(e=>{e.defaultData={castShadow:!0,receiveShadow:!0},e.equals=function(e,t){return e.castShadow===t.castShadow&&e.receiveShadow===t.receiveShadow}})(YV||(YV={})),(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0},e.equals=function(e,t){return e.flatShading===t.flatShading&&e.side===t.side&&e.wireframe===t.wireframe}})(QV||(QV={})),(e=>{e.defaultData=c(c({},QV.defaultData),YV.defaultData)})(KV||(KV={})),(e=>{e.getMaterialData=function(e,t){let i=[];if("material"in e){var n,r;let a="string"==typeof e.material?null!==(n=t.materials[e.material])&&void 0!==n?n:null===(r=t.lib.materials[e.material])||void 0===r?void 0:r.asset:e.material;a&&i.push(a)}else if("materials"in e)for(let s of e.materials){var a,o;let e="string"==typeof s?null!==(a=t.materials[s])&&void 0!==a?a:null===(o=t.lib.materials[s])||void 0===o?void 0:o.asset:s;e&&i.push(e)}return i}})(ZV||(ZV={})),(e=>{e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7})(JV||(JV={})),(e=>{e.is=function(e){return"texture"===e||"video"===e||"color"===e||"depth"===e||"normal"===e||"gradient"===e||"noise"===e||"fresnel"===e||"rainbow"===e||"toon"===e||"outline"===e||"particle"===e||"transmission"===e||"matcap"===e||"displace"===e||"pattern"===e||"light"===e}})($V||($V={})),(e=>{e.is=function(e){return"phong"===e||"toon"===e||"lambert"===e||"physical"===e}})(ej||(ej={}));var sj,lj,cj,dj,uj=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],hj=["wrapping","image","video","name","minFilter","magFilter"];(e=>{e.patch=function(e,t){let{texture:i}=t,n=r(t,vw);if(Object.assign(e,n),i){let t=e.texture;t&&Object.assign(t,i)}},e.defaultData=function(e,t){return"light"===e&&t?function(e){let t={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(e){case"phong":return c(c({},t),{},{category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6});case"toon":return c(c({},t),{},{category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1});case"lambert":return c(c({},t),{},{category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0});case"physical":return c(c({},t),{},{category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0})}}(t):function(e){let t={alpha:1,mode:0,isMask:!1,visible:!0};switch(e){case"texture":return c(c({},t),{},{type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1});case"video":return c(c({},t),{},{type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:JV.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1});case"color":return c(c({},t),{},{type:"color",color:AV.fromHex(kV)});case"depth":return c(c({},t),{},{type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200});case"normal":return c(c({},t),{},{type:"normal",cnormal:[1,1,1]});case"gradient":return c(c({},t),{},{type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]});case"noise":return c(c({},t),{},{type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:c(c({},AV.fromHex(6710886)),{},{a:1}),colorB:c(c({},AV.fromHex(6710886)),{},{a:1}),colorC:c(c({},AV.fromHex(16777215)),{},{a:1}),colorD:c(c({},AV.fromHex(16777215)),{},{a:1}),distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1});case"fresnel":return c(c({},t),{},{type:"fresnel",color:TV.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1});case"rainbow":return c(c({},t),{},{type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]});case"toon":return c(c({},t),{},{type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:TV.fromHexAndA(0,0),offset:[0,0,0]});case"outline":return c(c({},t),{},{type:"outline",outlineColor:TV.fromHexAndA(0,1),contourColor:TV.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0});case"matcap":return c(c({},t),{},{type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006}});case"transmission":return c(c({},t),{},{type:"transmission",thickness:10,ior:1.5,roughness:1});case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return c(c({},t),{},{type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:c(c({},AV.fromHex(0)),{},{a:1}),colorB:c(c({},AV.fromHex(16777215)),{},{a:1}),frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6})}}(e)}})(sj||(sj={})),(e=>{function t(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"layer1",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"layer2",n=new UN;return n.push({fi:0,data:sj.defaultData("light",e),id:t}),n.push({fi:1,data:sj.defaultData("color"),id:i}),{layers:n}}e.isMergable=function(e){return!e.layers.some(e=>"texture"===e.data.type&&0!==e.data.projection||"depth"===e.data.type&&!e.data.isWorldSpace||"noise"===e.data.type||"displace"===e.data.type)},e.getHash=function(e){let t="";return e.layers.forEach(e=>{Object.entries(e.data).forEach(e=>{let[i,n]=e;t+="".concat(i).concat(n),Array.isArray(n)?n.forEach(e=>t+="".concat(e)):"object"==typeof n?Object.values(n).forEach(e=>{t+="".concat("number"==typeof e?e.toFixed(4):e)}):t+="".concat(n)})}),t},e.defaultEmptyData=function(){return{layers:new UN}},e.defaultData=function(){return t("phong",arguments.length>0&&void 0!==arguments[0]?arguments[0]:"layer1",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"layer2")},e.withName=function(e,t){return c(c({},e),{},{name:t})},e.defaultTwoLayerData=t,e.defaultUIObjectMaterial=function(e){let t=sj.defaultData("texture");e&&Object.assign(t.texture,{image:e});let i=new UN;return i.push({fi:0,data:t,id:"layer1"}),i.push({fi:1,data:c(c({},sj.defaultData("transmission")),{},{alpha:1}),id:"layer2"}),i.push({fi:2,data:c(c({},sj.defaultData("light","lambert")),{},{alpha:0}),id:"layer3"}),{layers:i}},e.defaultTwoLayerTextureData=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"phong",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"layer1",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"layer2",r=sj.defaultData("texture");Object.assign(r.texture,{image:e});let a=new UN;return a.push({fi:0,data:r,id:i}),a.push({fi:1,data:sj.defaultData("light",t),id:n}),{layers:a}},e.defaultTwoLayerVideoTextureData=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"phong",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"layer1",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"layer2",r=sj.defaultData("video");Object.assign(r.texture,{video:e});let a=new UN;return a.push({fi:0,data:r,id:i}),a.push({fi:1,data:sj.defaultData("light",t),id:n}),{layers:a}}})(lj||(lj={})),(e=>{e.defaultData=function(){return{points:new UN,roundness:0,shapeHoles:[],isClosed:!1}}})(cj||(cj={})),(e=>{e.defaultData=function(){return{points:new UN,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}})(dj||(dj={}));var pj,fj={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0};(e=>{e.merge=function(e,t){let i=c({},e);return bj.forEach(n=>{var r;Object.assign(i,{[n]:null!==(r=t[n])&&void 0!==r?r:e[n]})}),i}})(pj||(pj={}));var mj,gj,vj,yj={shape:fj,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},bj=["depth","offset","angle","twist","startScale","endScale"];(e=>{e.is2DParametricMesh=function(e){return"PolygonGeometry"===e||"RectangleGeometry"===e||"StarGeometry"===e||"TriangleGeometry"===e||"EllipseGeometry"===e||"UIGeometry"===e},e.isParametricMesh=function(e){return"PolygonGeometry"===e||"PolygonGeometry"===e||"RectangleGeometry"===e||"StarGeometry"===e||"TriangleGeometry"===e||"EllipseGeometry"===e||"PathGeometry"===e||"VectorGeometry"===e||"ConeGeometry"===e||"CubeGeometry"===e||"CylinderGeometry"===e||"DodecahedronGeometry"===e||"HelixGeometry"===e||"IcosahedronGeometry"===e||"LatheGeometry"===e||"PyramidGeometry"===e||"SphereGeometry"===e||"PlaneGeometry"===e||"BackdropGeometry"===e||"TorusGeometry"===e||"TorusKnotGeometry"===e||"BooleanGeometry"===e||"TextGeometry"===e||"InputGeometry"===e}})(mj||(mj={})),(e=>{e.merge=function(e,t){let i=c({},e);return Object.assign(i,t),"PathGeometry"===i.type&&"extrusion"in t&&t.extrusion&&(i.extrusion=c({},e.extrusion),Object.assign(i.extrusion,pj.merge(i.extrusion,t.extrusion))),i}})(gj||(gj={})),(e=>{e.defaultData=function(t){if("RectangleGeometry"===t)return{width:320,height:320,type:t,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if("UIGeometry"===t)return{type:t,frame:"",cornerRadius:[0,0,0,0],cornerType:0,width:1,height:1};if("PathGeometry"===t)return{type:t,width:1,height:1,depth:1,path:dj.defaultData(),extrusion:yj};if("VectorGeometry"===t)return{width:1,height:1,type:t,subdivisions:12,shape:cj.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if("BooleanGeometry"===t)return{type:t,operation:2,width:0,height:0,depth:0,phongAngle:35};if("ShapeBlendGeometry"===t)return{type:t,width:0,height:0,depth:0,resolutionLevel:6,blendRange:100,useChildrenColors:!1};if("TextGeometry"===t)return{type:t,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",editable:!1,extrudeBevelSize:0,extrudeBevelSegments:1};if("InputGeometry"===t)return c(c({},e.defaultData("TextGeometry")),{},{type:t,editable:!0});if("SphereGeometry"===t)return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}})(vj||(vj={}));var xj,wj,Sj,_j,Cj,Ej,Aj,Mj,Tj,Pj,Dj,Oj,Ij,kj,Rj,zj,Lj,Bj,Nj,Fj,Uj,Vj,jj,Wj,Hj,Gj,qj,Xj,Yj,Qj,Kj,Zj,Jj,$j,eW,tW,iW,nW,rW,aW,oW,sW,lW=["width","height","depth"];function cW(e){e.layers.forEach(e=>{if("depth"===e.type&&void 0!==e.colorA){let t=e.colorA,i=e.colorB,n=[[t.r,t.g,t.b,t.a],[i.r,i.g,i.b,i.a]],r=[0,1];for(let e=2;e<10;e++)n.push(n[1]),r.push(1);let a=c(c({},KB(bF(e),"type","visible","isVector","isWorldSpace","origin","alpha","mode")),{},{near:Math.max(0,e.near),far:Math.max(0,e.far),colors:n,steps:r,num:2,direction:[1,0,0],smooth:!1,gradientType:1});Object.assign(e,a)}else if("depth"===e.type&&1===e.gradientType&&(e.near<0||e.far<0)){let t=c(c({},bF(e)),{},{near:Math.max(e.near,0),far:Math.max(e.far,0)});Object.assign(e,t)}})}function dW(e,t){Object.values(e.shared.materials).forEach(e=>t(e))}function uW(e,t){e.scene.objects.traverse((e,i)=>{"materials"in i?i.materials.forEach((e,n)=>{void 0===e&&(i.materials[n]=lj.defaultData(),e=i.materials[n]),"string"!=typeof e&&t(e)}):"material"in i?"string"!=typeof i.material&&(void 0===i.material&&(i.material=lj.defaultData()),t(i.material)):"Mesh"===i.type&&(void 0===i.material&&(i.material=lj.defaultData()),t(i.material)),"overrides"in i&&Object.values(i.overrides).forEach(e=>{e.material&&"string"!=typeof e.material&&Object.getPrototypeOf(e.material)!==XN.prototype&&t(e.material)})})}function hW(e){void 0===e.layers&&Object.assign(e,lj.defaultTwoLayerData("lambert"))}function pW(e){!e.layers||e.layers.forEach(e=>{if("depth"===e.type&&10===e.colors.length){let t=[...e.colors];t.push(e.colors[9]);let i=[...e.steps];i.push(e.steps[9]);let n=c(c({},bF(e)),{},{colors:t,steps:i});Object.assign(e,n)}})}function fW(e){e.scene.objects.traverse((e,t)=>{"materials"in t?t.materials.forEach(e=>{"string"!=typeof e&&pW(e)}):"material"in t&&"string"!=typeof t.material&&pW(t.material)}),Object.values(e.shared.materials).forEach(e=>pW(e))}function mW(e){e.layers&&e.layers.forEach(e=>{"depth"===e.type&&void 0!==e.num&&(e.colors=e.colors.slice(0,e.num),e.steps=e.steps.slice(0,e.num),delete e.num)})}function gW(e){e.layers&&e.layers.forEach(e=>{(function(e){return"displace"!==e.type})(e)&&void 0===e.isMask&&(e.isMask=!1),("texture"===e.type||"video"===e.type)&&void 0===e.blending&&(e.blending=0),("noise"===e.type||"displace"===e.type&&"noise"===e.displacementType)&&(void 0===e.voronoiStyle&&(e.voronoiStyle=0),void 0===e.highCut&&(e.highCut=1),void 0===e.lowCut&&(e.lowCut=0),void 0===e.smoothness&&(e.smoothness=.3),void 0===e.seed&&(e.seed=0),void 0===e.quality&&(e.quality=1))})}function vW(e){var t;let i=null===(t=e.layers.find(e=>"light"===e.type))||void 0===t?void 0:t.data;if("basic"===(null===i||void 0===i?void 0:i.category)){let e=sj.defaultData("light","phong"),t=i;Object.assign(t,e),t.visible=!1}}function yW(e){dW(e,vW),uW(e,vW)}function bW(e){e.layers.forEach(e=>{"light"===e.type&&"toon"!==e.category&&void 0===e.occlusion&&(e.occlusion=!0)})}function xW(e){e.layers&&e.layers.forEach(e=>{"light"===e.type&&void 0===e.bumpMapIntensity&&(e.bumpMapIntensity=5)})}function wW(e,t){if(t<1&&(uW(e,cW),dW(e,cW),e.schema=1),t<2&&(function(e){Object.assign(e.scene.publish,{orbitControls:c(c({},Hj.defaultData),bF(e.scene.publish.orbitControls))})}(e),e.schema=2),t<3&&(function(e){function t(e){if(e.layers)for(let t of Object.values(e.layers))if(t)for(let[e,i]of Object.entries(t))if((uj.includes(e)||"boolean"==typeof i)&&delete t[e],"texture"===e)for(let[t,n]of Object.entries(i))(hj.includes(t)||"boolean"==typeof n)&&delete i[t]}e.scene.objects.traverse((e,i)=>{i.states.forEach(e=>{let i=e;i.material?t(i.material):i.materials&&i.materials.forEach(e=>{t(e)})})})}(e),e.schema=3),t<4&&(function(e){e.scene.publish.withBackground=!0}(e),e.schema=4),t<5&&(function(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}(e),e.schema=5),t<6&&(function(e){e.scene.objects.traverse((e,t)=>{let i=t.cloner;i&&(i.radial.scale=i.radial.scale.map(e=>e+1),i.linear.scale=i.linear.scale.map(e=>e+1))})}(e),e.schema=6),t<7&&(function(e){e.scene.objects.traverse((e,t)=>{let i=t.geometry;i&&("DodecahedronGeometry"===i.type||"IcosahedronGeometry"===i.type)&&(i.detail=Math.round(i.detail))})}(e),e.schema=7),t<8&&(e.schema=8),t<9&&(fW(e),e.schema=9),t<10&&(function(e){e.scene.objects.traverse((e,t)=>{"Mesh"===t.type&&("BooleanGeometry"===t.geometry.type||"SubdivGeometry"===t.geometry.type)&&(t.geometry.phongAngle=35)})}(e),e.schema=10),t<11&&(function(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse((e,t)=>{("DirectionalLight"===t.type||"SpotLight"===t.type)&&(t.shadowResolution=1024,t.shadowRadius=1,t.depth=1e5)}),e.shared.penumbraSize=new Array(5).fill(.5)}(e),e.schema=11),t<12&&(fW(e),e.schema=12),t<13&&(function(e){e.shared.audios=tN({},DN.prototype)}(e),e.schema=13),t<14&&(function(e){let t=e.shared.materials;Object.entries(t).forEach(e=>{let[i,n]=e;if(!n.layers){let e={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[i]:e})}})}(e),e.schema=14),t<15&&(function(e){Object.entries(bF(e.shared.images)).filter(e=>!1===e[1].asset).map(e=>e[0]).forEach(t=>{delete e.shared.images[t]}),Object.entries(bF(e.shared.audios)).filter(e=>!1===e[1].asset).map(e=>e[0]).forEach(t=>{delete e.shared.audios[t]})}(e),e.schema=15),t<16&&(function(e){e.scene.publish.settings.web.preload=!1}(e),e.schema=16),t<17&&(uW(e,mW),dW(e,mW),e.schema=17),t<18&&(uW(e,hW),dW(e,hW),e.schema=18),t<19&&(function(e){Object.assign(e.scene.publish.settings,{video:c(c({},Gj.defaultData.settings.video),bF(e.scene.publish.settings.video))})}(e),e.schema=19),t<20&&(function(e){e.shared.fonts=tN({},DN.prototype)}(e),function(e){let t=[];e.scene.objects.traverse((i,n)=>{let r=n;if("TextFrame"===r.type){let n=lj.defaultTwoLayerData("phong"),a="string"==typeof r.color?e.shared.colors[r.color]:r.color;n.layers[1].data.color={r:a.r,g:a.g,b:a.b},n.layers[1].data.alpha=r.alpha;let o=function(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}(r.font);void 0===e.shared.fonts[o]&&(e.shared.fonts[o]={name:o});let s=c(c(c({name:r.name},Oj.defaultData),Lj.defaultData),{},{flatShading:!1,wireframe:!1,geometry:c(c({},vj.defaultData("TextGeometry")),{},{width:r.width,height:r.height,font:o,depth:0,horizontalAlign:r.horizontalAlign,verticalAlign:r.verticalAlign,fontSize:1.40625*r.fontSize,lineHeight:r.lineHeight/1.40625,letterSpacing:r.letterSpacing-1,text:r.text,textTransform:r.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1}),material:n,states:bF(r.states),events:bF(r.events),visible:r.visible,raycastLock:r.raycastLock,position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix}),l=bF(e.scene.objects).parent(i);e.scene.objects.insertAfter(null!==l&&void 0!==l?l:null,i,[{id:i+"new",data:s,children:[]}]),t.push(i)}}),t.forEach(t=>{e.scene.objects.delete(t)})}(e),e.schema=20),t<21&&(function(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse((e,i)=>{i.events.forEach(e=>{if(t[Number(e.type)])if(Object.assign(e,{type:t[Number(e.type)]}),"Audio"===e.type&&"audioEvent"in e&&(Object.assign(e,{playAudio:e.audioEvent}),delete e.audioEvent),"GameControl"===e.type)Object.assign(e,{gameActions:{idle:new UN,move:new UN,jump:new UN}});else{let t=new UN;Object.assign(e,{actions:t}),("MouseDown"===e.type||"MouseUp"===e.type||"KeyDown"===e.type||"KeyUp"===e.type)&&"url"in e&&t.push({fi:0,id:h_.generateUUID(),data:{type:"Link",url:e.url,delay:0}}),"targets"in e&&(e.targets.forEach((e,i,n)=>{let r={easing:e.easing,duration:e.duration};6===e.easing?Object.assign(r,KB(e,"mass","stiffness","damping","velocity")):5===e.easing&&Object.assign(r,{control1:c({},e.control1),control2:c({},e.control2)});let a={repeat:e.repeat?-1:0,delay:e.delay,delayDirection:e.delayDirection,direction:e.cycle&&e.rewind?"pingpong-rewind":e.cycle?"pingpong":"normal"},o=c(c({state:e.state},a),r),s={allowSlerp:!0,type:"Transition",object:e.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new UN({fi:0,id:h_.generateUUID(),data:{state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4}},{fi:1,id:h_.generateUUID(),data:o})};t.push({fi:n,id:i,data:s})}),delete e.targets)}})})}(e),function(e){e.scene.objects.traverse((e,t)=>{function i(e,i){let n=new UN,r=[];if(t.events.forEach((e,t,a)=>{if("Audio"===e.type&&e.trigger===i){let i;r.push(t),"play"===e.interaction?i=c(c({},KB(e,"interaction","audio","delay","volume","loop")),{},{triggerAfter:"after"in e?e.after:void 0,toggle:"after"in e?e.toggle:void 0,type:"Audio"}):("pause"===e.interaction||"stop"===e.interaction)&&(i=c(c({},KB(e,"interaction","delay","object","playAudio")),{},{type:"Audio"})),i&&n.push({fi:a,id:t,data:i})}}),r.forEach(e=>t.events.delete(e)),n.length){var a;let i=null===(a=t.events.find(t=>t.type===e))||void 0===a?void 0:a.data;i?"actions"in i&&i.actions.insertBefore(null,n):t.events.insertBefore(null,[{id:h_.generateUUID(),data:{type:e,actions:n}}])}}i("Start","start"),i("MouseDown","mouseDown"),i("MouseUp","mouseUp"),i("KeyDown","keyDown"),i("KeyUp","keyUp")})}(e),e.schema=21),t<22&&(yW(e),e.schema=22),t<23&&(function(e){e.scene.objects.traverse((e,t)=>{"Mesh"===t.type&&"SubdivGeometry"===t.geometry.type&&(t.geometry.scaleBaked||(t.geometry.scaleBaked=[1,1,1]))})}(e),e.schema=23),t<24&&(function(e){e.scene.objects.traverse((e,t)=>{("Empty"===t.type||"Mesh"===t.type)&&t.cloner&&!t.cloner.randomnessObject&&!t.cloner.toObject&&!t.cloner.randomness&&(t.cloner=c(c({},t.cloner),{},{toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}))})}(e),e.schema=24),(t<25||void 0===e.shared.videos)&&(function(e){e.shared.videos=tN({},DN.prototype)}(e),t<25&&(e.schema=25)),t<26&&(function(e){e.scene.objects.traverse((t,i)=>{let n=e.scene.objects.unproxy().parent(t);if(n){let t=bF(e.scene.objects.data(n));t&&"Mesh"===t.type&&"BooleanGeometry"===t.geometry.type&&"Mesh"===i.type&&(i.visible=!0!==bF(i).booleanExclude)}})}(e),e.schema=26),t<27&&(function(e){e.scene.objects.traverse((e,t)=>{if("Mesh"===t.type){let e=t;"NonParametricGeometry"===t.geometry.type?void 0!==e.material&&delete e.material:void 0!==e.materials&&delete e.materials}})}(e),e.schema=27),t<28&&(yW(e),e.schema=28),t<29&&(function(e){function t(e){Object.setPrototypeOf(e,XN.prototype),e.texture&&Object.setPrototypeOf(e.texture,XN.prototype)}function i(e){Object.setPrototypeOf(e,XN.prototype);for(let i in e)t(e[i])}e.scene.objects.traverse((e,t)=>{t.states.forEach(e=>{let t=e;if(t.material){let e=bF(t.material).layers;i(e),t.material.layers=e}if(t.materials)for(let n=0;n<t.materials.length;n++){let e=t.materials[n],r=bF(e).layers;i(r),e.layers=r}})})}(e),e.schema=29),t<30&&(function(e){e.scene.objects.traverse((e,t)=>{"Mesh"===t.type&&"NonParametricGeometry"===t.geometry.type&&!("material"in t)&&!("materials"in t)&&(t.material=lj.defaultTwoLayerData("phong"))})}(e),e.schema=30),t<31&&(function(e){void 0===e.scene.publish.orbitControls.autoZoom&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse((e,t)=>{("OrthographicCamera"===t.type||"PerspectiveCamera"===t.type)&&(void 0===t.orthographic.autoZoom&&(t.orthographic.autoZoom=!1),void 0===t.orthographic.autoZoomFrustumSize&&(t.orthographic.autoZoomFrustumSize=790))})}(e),e.schema=31),t<33&&(function(e){e.scene.objects.traverse((e,t)=>{void 0===t.pathSnapping&&(t.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),void 0===t.pathSnapping.offset&&(t.pathSnapping.offset=0)})}(e),e.schema=33),t<34&&(function(e){void 0===e.scene.publish.mouseEventTarget&&(e.scene.publish.mouseEventTarget="canvas"),void 0===e.scene.publish.settings.web.hint&&(e.scene.publish.settings.web.hint=!1)}(e),e.schema=34),t<35&&(function(e){let{video:t}=e.scene.publish.settings;"gif"===t.format&&t.fps>48&&(t.fps=15)}(e),e.schema=35),t<36&&(function(e){e.scene.objects.traverse((e,t)=>{t.events.forEach(e=>{"GameControl"===e.type&&(e.resetYPosition=Math.abs(e.resetYPosition-t.position[1]))})})}(e),e.schema=36),t<37&&(function(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse((e,i)=>{t&&null===i.physics?i.collision=!1:i.collision="visibility"})}(e),e.schema=37),t<38&&(uW(e,gW),dW(e,gW),e.schema=38),t<39&&(function(e){e.scene.objects.traverse((e,t)=>{t.events.forEach(e=>{"GameControl"===e.type&&(e.navmesh=sW.defaultDataThirdPerson.navmesh)})})}(e),e.schema=39),t<40&&(function(e){e.scene.styles||(e.scene.styles=Yj.defaultData())}(e),e.schema=40),t<41&&(function(e){void 0===e.scene.environment.ambientLight.occlusion&&(e.scene.environment.ambientLight.occlusion=!1),void 0===e.scene.environment.ambientLight.aoFullRes&&(e.scene.environment.ambientLight.aoFullRes=!1),void 0===e.scene.environment.ambientLight.radius&&(e.scene.environment.ambientLight.radius=256),void 0===e.scene.environment.ambientLight.bias&&(e.scene.environment.ambientLight.bias=.5),void 0===e.scene.environment.ambientLight.aoColor&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),uW(e,bW),dW(e,bW)}(e),e.schema=41),t<42&&(function(e){e.scene.objects.traverse((e,t)=>{t.events.forEach(e=>{"GameControl"===e.type&&Object.assign(e.gameActions,{run:new UN})})})}(e),e.schema=42),t<43&&(function(e){e.scene.objects.traverse((e,t)=>{t.events.forEach(e=>{"GameControl"===e.type&&(e.keyAssignments=[...e.keyAssignments,["run","\u21e7"],["none","Ctrl"]])})})}(e),e.schema=43),t<99){var i;uW(e,xW),dW(e,xW),null===e.scene.publish.playCamera&&(e.scene.publish.playCamera=OV);let t=bF(e.scene.objects),n=e.scene.objects;e.scene.publish.playPage=IV,n.insertBefore(null,null,[{id:IV,data:c(c({},Vj.defaultData),{},{backgroundColor:e.scene.backgroundColor,fog:e.scene.fog,postprocessing:e.scene.postprocessing,ao:KB(e.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:e.scene.publish.playCamera,gameControlObject:e.scene.publish.gameControlObject},shadow:KB(e.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:c(c({},Ej.defaultData),KB(e.scene.environment,"usePhysics","gravity")),camera:null!==(i=bF(e.scene.ownerCamera))&&void 0!==i?i:Vj.defaultData.camera,name:"Scene"}),children:[]}]);for(let e of t)e.id!==Kj.TRASH_CAN_ID&&n.move(IV,e.fi,e.id);let r=0,a=0;e.shared.penumbraSize&&e.scene.objects.traverse((t,i)=>{var n;"DirectionalLight"===i.type?(i.penumbraSize=e.shared.penumbraSize[Math.min(r,2)],r+=1):"SpotLight"===i.type&&(i.penumbraSize=e.shared.penumbraSize[3+Math.min(a,1)],a+=1),(void 0===i.physics||null===i.physics)&&"Instance"!==i.type&&(i.physics={},Object.assign(i.physics,XV.defaultData)),void 0!==i.physics&&null!==i.physics&&(i.physics.enabled=null!==(n=i.collision)&&void 0!==n?n:"visibility",delete i.collision)}),e.schema=99}}function SW(e){e.layers&&e.layers.forEach(e=>{"light"===e.type&&void 0===e.alphaOverride&&(e.alphaOverride=1)})}(e=>{e.defaultData={enabled:!1,useBackgroundColor:!1,color:AV.white,near:.1,far:2e3}})(xj||(xj={})),(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:c(c({},t),{},{blendFunction:16,granularity:15}),bloom:c(c({},t),{},{blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3}),chromaticAberration:c(c({},t),{},{offset:[2,2]}),vignette:c(c({},t),{},{darkness:1,offset:0}),hueSaturation:c(c({},t),{},{hue:3,saturation:0}),brightnessContrast:c(c({},t),{},{brightness:.25,contrast:0}),depthOfField:c(c({},t),{},{focusDistance:100,focalLength:20,bokehScale:5}),noise:c(c({},t),{},{blendFunction:16})}})(wj||(wj={})),(e=>{e.defaultData={softShadowQuality:"low"}})(Sj||(Sj={})),(e=>{e.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75}})(_j||(_j={})),(e=>{e.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}}})(Cj||(Cj={})),(e=>{e.defaultData={usePhysics:!1,gravity:-10}})(Ej||(Ej={})),(e=>{e.defaultData={playCamera:OV,gameControlObject:null}})(Aj||(Aj={})),(e=>{e.defaultData={backgroundColor:TV.fromHexAndA(2960946,1),postprocessing:wj.defaultData,fog:xj.defaultData,globalPhysics:Ej.defaultData,ambient:_j.defaultData,ao:Cj.defaultData,shadow:Sj.defaultData,publish:Aj.defaultData}})(Mj||(Mj={})),(e=>{e.defaultData={colliderType:"box",size:[100,100,100],colliderHelperVisible:!0,forceType:"collider",forceRange:"global",forceIntensity:.5,forceDambing:.95}})(Tj||(Tj={})),(e=>{e.isComponentRelated=function(e){return"Component"===e||"Instance"===e},e.isEmptyOrComponent=function(e){return"Empty"===e||"Instance"===e}})(Pj||(Pj={})),(e=>{e.identity=c(c({},DV.identity),{},{hiddenMatrix:CV.identity}),e.fromObject=function(e){return{position:e.position,rotation:e.rotation,scale:e.scale,hiddenMatrix:e.hiddenMatrix}},e.merge=function(e,t){return{position:(null===t||void 0===t?void 0:t.position)||e.position,rotation:(null===t||void 0===t?void 0:t.rotation)||e.rotation,scale:(null===t||void 0===t?void 0:t.scale)||e.scale,hiddenMatrix:(null===t||void 0===t?void 0:t.hiddenMatrix)||e.hiddenMatrix}},e.diff=function(e,t){return eN({position:xV.isEqual(e.position,t.position)?void 0:t.position,rotation:xV.isEqual(e.rotation,t.rotation)?void 0:t.rotation,scale:xV.isEqual(e.scale,t.scale)?null:t.scale,hiddenMatrix:CV.isEqual(e.hiddenMatrix,t.hiddenMatrix)?void 0:t.hiddenMatrix})}})(Dj||(Dj={})),(e=>{e.defaultData=c(c({states:new UN,events:new UN,visible:!0,raycastLock:!1,physics:XV.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"}},Dj.identity),{},{cloner:null})})(Oj||(Oj={})),(e=>{e.defaultData=c({type:"Empty"},Oj.defaultData)})(Ij||(Ij={})),(e=>{e.defaultData=c(c({type:"ParticleCollider"},Tj.defaultData),Oj.defaultData)})(kj||(kj={})),(e=>{e.defaultData=c({type:"Component"},Oj.defaultData)})(Rj||(Rj={})),(e=>{e.defaultData=c(c({type:"Particle"},Oj.defaultData),qV.defaultData)})(zj||(zj={})),(e=>{e.defaultData=c(c({type:"Mesh"},Oj.defaultData),KV.defaultData)})(Lj||(Lj={})),(e=>{e.defaultData=c(c(c({},Oj.defaultData),Dj.identity),{},{position:[0,0,FV.DefaultTargetOffset]},FV.defaultData)})(Bj||(Bj={})),(e=>{e.defaultData=function(e){return c(c({},Oj.defaultData),GV.defaultData(e))},e.defaultDirectionalLightData=c(c({},e.defaultData("DirectionalLight")),{},{position:[200,300,300],name:"Directional Light",intensity:.7})})(Nj||(Nj={})),(e=>{function t(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(;i<t.length;){let n=e?e[t[i]]:void 0;if(t.length===i+1)return n;if(!n)return;e=n.descendants,i+=1}}e.resolveWithDes=t,e.resolve=function(e,i){let n=t(e,i,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0);if(n){let e=Object.keys(n);if(1===e.length&&"descendants"===e[0])return}return n}})(Fj||(Fj={})),(e=>{function t(e,t){return c(c(c({},Oj.defaultData),t),{},{component:e,overrides:new XN,physics:void 0,events:void 0,type:"Instance"})}e.rootOverrideProps=["physics","events"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"],e.ofComponent=t,e.fromComponentData=function(e){let i=Dj.fromObject(e.data);return t(e.id,i)}})(Uj||(Uj={})),(e=>{e.defaultData=c(c(c({type:"Page"},Oj.defaultData),{},{physics:c(c({},XV.defaultData),{},{fusedBody:!1})},Mj.defaultData),{},{camera:Bj.defaultData}),e.isUIPage=function(e){return void 0!==e.uiScene}})(Vj||(Vj={})),(e=>{e.defaultCamera=c({position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:CV.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:XV.defaultData,states:new UN,events:new UN,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0}},FV.defaultData),e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject=c(c(c({name:"Rectangle"},Oj.defaultData),Lj.defaultData),{},{geometry:vj.defaultData("RectangleGeometry"),material:lj.defaultTwoLayerData("phong","layer1","layer2")}),e.defaultBooleanObject=c(c(c({name:"Boolean"},Oj.defaultData),Lj.defaultData),{},{geometry:vj.defaultData("BooleanGeometry"),material:lj.defaultTwoLayerData("phong","layer1","layer2")}),e.defaultShapeBlendObject=c(c(c({name:"Shape Blend"},Oj.defaultData),Lj.defaultData),{},{geometry:vj.defaultData("ShapeBlendGeometry"),material:lj.defaultTwoLayerData("phong","layer1","layer2")}),e.defaultTextObject=c(c(c({name:"Text"},Oj.defaultData),Lj.defaultData),{},{geometry:vj.defaultData("TextGeometry"),material:lj.defaultTwoLayerData("phong","layer1","layer2")}),e.defaultInputObject=c(c(c({name:"Input"},Oj.defaultData),Lj.defaultData),{},{geometry:vj.defaultData("InputGeometry"),material:lj.defaultTwoLayerData("phong","layer1","layer2")})})(jj||(jj={})),(e=>{e.newEmpty=function(e,t){let i={name:t};return"Mesh"===e.type?(i.geometry={},"material"in e&&(i.material={layers:new XN}),"materials"in e&&(i.materials=e.materials.map(e=>({layers:new XN})))):NV.is(e.type)&&(i.perspective={},i.orthographic={}),i},e.toOps=function(e,t){let i,n=[],a={orthographic:0,perspective:0,geometry:0};function o(e,t){for(let[i,a]of Object.entries(t.layers)){let{texture:t}=a,o=r(a,yw);if(void 0!==t&&Object.keys(t).length>0){let r={path:[...e,"layers",i,"texture"],props:t,type:0};n.push(r)}if(Object.keys(o).length>0){let t={path:[...e,"layers",i],props:o,type:0};n.push(t)}}}for(let[r,s]of Object.entries(t))if("name"!==r)if("cloner"===r)n.push(...VV.toOps(s,["cloner"]));else if("pathSnapping"===r)n.push({path:[r],props:{slide:s.slide,offset:s.offset},type:0});else if("material"===r)o(["material"],s);else if("materials"===r)for(let[e,t]of Object.entries(s))o(["materials",e],t);else if(0===a[r]){if("geometry"===r&&void 0!==s.extrusion){let e={path:[r,"extrusion"],props:s.extrusion,type:0};n.push(e),s=c({},s),delete s.extrusion}if(Object.keys(s).length>0){let e={path:[r],props:s,type:0};n.push(e)}}else void 0===i&&(i={path:[],props:{},type:0},n.push(i)),i.props[r]=s;return n},e.patch=function(e,t){var i,n,r,a,o,s,l,d;if(void 0===t)return e;let u=c({},e);if(Object.assign(u,Dj.merge(u,t)),Object.assign(u,{pathSnapping:Object.assign({},u.pathSnapping,{slide:null!==(i=null!==(n=null===(r=t.pathSnapping)||void 0===r?void 0:r.slide)&&void 0!==n?n:null===(a=u.pathSnapping)||void 0===a?void 0:a.slide)&&void 0!==i?i:0,offset:null!==(o=null!==(s=null===(l=t.pathSnapping)||void 0===l?void 0:l.offset)&&void 0!==s?s:null===(d=u.pathSnapping)||void 0===d?void 0:d.offset)&&void 0!==o?o:0})}),NV.is(e.type)){var h,p;u.orthographic=c({},u.orthographic),u.perspective=c({},u.perspective);let e=t;void 0!==(null===(h=e.orthographic)||void 0===h?void 0:h.zoom)&&(u.orthographic.zoom=e.orthographic.zoom),void 0!==(null===(p=e.perspective)||void 0===p?void 0:p.zoom)&&(u.perspective.zoom=e.perspective.zoom),void 0!==e.isUpVectorFlipped&&(u.isUpVectorFlipped=e.isUpVectorFlipped),void 0!==e.targetOffset&&(u.targetOffset=e.targetOffset)}else if("Mesh"===e.type)"geometry"in t&&Object.assign(u,{geometry:gj.merge(u.geometry,t.geometry)}),(t.material||t.materials)&&(u=function(e,t){if(void 0===t)return e;let i=c({},e);return"material"in i&&"material"in t&&t.material&&(i.material=yF(i.material,e=>{if("string"!=typeof e)for(let[i,n]of Object.entries(t.material.layers)){let t=e.layers.data(i);t&&sj.patch(t,n)}}).data),i.materials&&t.materials&&(i.materials=yF(i.materials,e=>{for(let r=0;r<i.materials.length;r++){let i=t.materials[r];if("string"!=typeof i)for(let[t,a]of Object.entries(i.layers)){var n;let i=null===(n=e[r])||void 0===n||null===(n=n.layers)||void 0===n?void 0:n.data(t);i&&sj.patch(i,a)}}}).data),i}(u,t)),u.cloner&&"cloner"in t&&Object.assign(u,{cloner:UV.merge(u.cloner,t.cloner)});else if("Empty"===e.type)u.cloner&&"cloner"in t&&Object.assign(u,{cloner:UV.merge(u.cloner,t.cloner)});else if(HV.is(e.type)){let e=t;void 0!==e.intensity&&(u.intensity=e.intensity),void 0!==e.color&&("string"==typeof e.color?u.color=e.color:u.color=AV.clone(e.color))}return u}})(Wj||(Wj={})),(e=>{e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0}})(Hj||(Hj={})),(e=>{e.defaultData={orbitControls:Hj.defaultData,playPage:IV,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((e,t)=>{let i=0,n=0;return t<5?n=-30:t<10&&(n=30),0===t||10===t||5===t?i=30:(4===t||11===t||9===t)&&(i=-30),[120,[i,n],"show"]}),settings:{image:{format:"jpg",ratio:1},videoStatic:{fps:60,mbps:150,ratio:1,duration:1e3},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1,imageQuality:70,pixelRatioMobile:0,pixelRatioDesktop:0}},stopRaycast:!0,hdTransmission:!1}})(Gj||(Gj={})),(e=>{e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""}})(qj||(qj={})),(e=>{e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0}})(Xj||(Xj={})),(e=>{e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:c({},qj.defaultData),isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:Xj.defaultData}),e.generateSeed=()=>Math.round(1e5*Math.random())})(Yj||(Yj={})),(e=>{e.physicsEnabled=function(e){return void 0!==e.find(e=>"Page"===e.data.type&&e.data.globalPhysics.usePhysics)},e.traverseModuleInstances=function(e,t,i){e.scene.objects.traverseFrom(t,(t,n)=>{if("Instance"===n.type){var r;let a=null===(r=AW.getComponentData(e,n.component))||void 0===r?void 0:r.data;a&&i(t,n,a.events)}else i(t,n,n.events)})}})(Qj||(Qj={})),(e=>{function t(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],r=jj.defaultMeshObject;t&&(n.push(c({},e.defaultLight)),n.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:r,children:[]})),n.push(...i);let a=new FN;return a.push({fi:1,id:IV,data:c(c({},Vj.defaultData),{},{name:"Scene 1"}),children:n}),a}function i(t){return c(c({},e.defaultData),{},{objects:tN(t,FN.prototype)})}e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222",e.defaultLight={fi:-1,data:Nj.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]},e.createDefaultObjectTreeWithPage=t,e.defaultData={objects:t(),publish:Gj.defaultData,styles:Yj.defaultData()},e.emptyDataWithoutPage=function(){return{objects:new FN,publish:Gj.defaultData,styles:Yj.defaultData()}},e.emptyDataWithPage=function(){return{objects:t(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]),publish:Gj.defaultData,styles:Yj.defaultData()}},e.emptyData=function(){return{objects:new FN,publish:c({},Gj.defaultData),styles:Yj.defaultData()}},e.withObjs=i,e.withObj=function(e,t){return i([{id:e,data:t,children:[],fi:0}])}})(Kj||(Kj={})),(e=>{e.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}}})(Zj||(Zj={})),(e=>{e.defaultData=e=>({url:e,name:"New Webhook",parametersSchemas:new UN}),e.defaultParameterValueByType=e=>"number"===e?0:"boolean"!==e&&""})(Jj||(Jj={})),(e=>{e.defaultData=function(e){return{url:e,method:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",name:"New API",headers:new UN,queries:new UN,autoStart:!0}}})($j||($j={})),(e=>{function t(e){return void 0!==e.textValue}function i(e){return"boolean"==typeof e}e.isTextValue=t,e.isNumber=function(e){return"number"==typeof e},e.isBoolean=i,e.typeOfVariable=function(e){return t(e)?"string":i(e)?"boolean":"number"},e.getDisplayedValue=function(t){var i;return e.isTextValue(t)?Array.isArray(t.textValue)?t.textValue.map(e=>{var i;return e.toString().padStart(null!==(i=t.padding)&&void 0!==i?i:2,"0")}).join(null!==(i=t.deliminator)&&void 0!==i?i:":")+(void 0!==t.suffix?" "+t.suffix:""):t.textValue.toString():e.isBoolean(t)?t?"True":"False":e.isNumber(t)?parseFloat(t.toFixed(3)).toString():t.toString()}})(eW||(eW={})),(e=>{e.all=["images","videos","colors","audios","particles","fonts","materials","variables"]})(tW||(tW={})),(e=>{e.all=[...tW.all,"components"]})(iW||(iW={})),(e=>{e.defaultData=function(){return{images:new DN,videos:new DN,colors:new DN,audios:new DN,particles:new DN,fonts:new DN,materials:new DN,components:new DN,variables:new DN,userAPIs:new DN,userWebhooks:new DN}}})(nW||(nW={})),(e=>{e.defaultData=function(){return{images:new DN,videos:new DN,colors:new DN,audios:new DN,particles:new DN,fonts:new DN,materials:new DN,components:new DN,variables:new DN,userAPIs:new DN,userWebhooks:new DN}}})(rW||(rW={})),(e=>{e.defaultColors=function(){let e={"89b10010-844c-11ec-a8a3-0242ac120002":{r:.5,g:.5,b:.5,a:1,name:"Default Color"}};return tN(e,DN.prototype)},e.defaultImages=function(){return tN({},DN.prototype)},e.emptyData=function(){return{catelogs:new DN,materials:new DN,images:new DN,videos:new DN,colors:new DN,audios:new DN,particles:new DN,fonts:new DN,variables:new UN,userAPIs:new DN,userWebhooks:new DN,lib:rW.defaultData()}},e.defaultVariables=function(e){switch(e){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let t=[0,0,0];return{name:"Time",value:{textValue:t,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:t,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",e)}},e.getFormattedTimerTime=function(e,t){if("HH:mm:ss"===t.format){let t=Math.floor(e/3600),i=Math.floor((e-3600*t)/60);return{textValue:[t,i,Math.round(e-3600*t-60*i)]}}if("mm:ss"===t.format){let t=Math.floor(e/60);return{textValue:[t,Math.round(e-60*t)]}}return e="number"===t.format?Math.round(e):Math.round(1e3*e)/1e3}})(aW||(aW={})),(e=>{e.list=["idle","move","jump","run"]})(oW||(oW={})),(e=>{e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","\u25b2"],["rotPosY","\u25c0"],["rotNegX","\u25bc"],["rotNegY","\u25b6"],["jump","Space"],["run","\u21e7"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new UN,move:new UN,jump:new UN,run:new UN},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:TV.fromHexAndA(3728051,1)}}})(sW||(sW={}));var _W=180/Math.PI;function CW(e){e.rotation=e.rotation.slice(0,3).map(e=>e*_W)}function EW(e){var t,i,n;CW(e),"Page"===e.type&&CW(e.camera),null===(t=e.states)||void 0===t||t.forEach(e=>{void 0===e.rotation||null===e.rotation||(e.rotation=e.rotation.slice(0,3).map(e=>e*_W))});let r=e.geometry;r&&"SphereGeometry"===r.type&&(r.thetaLength=(null!==(i=r.thetaLength)&&void 0!==i?i:180)*_W),r&&"TorusGeometry"===r.type&&(r.arc=r.arc*_W),r&&"PathGeometry"===r.type&&(r.extrusion.angle*=_W,r.extrusion.twist*=_W),"Mesh"===e.type&&"TextGeometry"===e.geometry.type&&(e.geometry.text={textValue:e.geometry.text}),Array.isArray(bF(e.events))&&(null===(n=e.events)||void 0===n||n.forEach(e=>{("MouseDown"===e.type||"MouseUp"===e.type||"MousePress"===e.type||"KeyDown"===e.type||"KeyUp"===e.type||"KeyPress"===e.type||"Collision"===e.type||"Trigger"===e.type)&&(e.runMode=e.toggle?"Toggle":"Repeat")}))}var AW,MW,TW,PW,DW,OW,IW,kW,RW,zW,LW,BW,NW,FW,UW,VW,jW,WW,HW,GW,qW=117;function XW(e,t){t(e.data);for(let i of e.children)XW(i,t)}function YW(e){var t;let i=null!==(t=e.schema)&&void 0!==t?t:104;i!==qW&&i<105&&(XW(e.asset,EW),e.schema=105)}function QW(e){var t;let i=null!==(t=e.schema)&&void 0!==t?t:0;if(i!==qW){console.warn("updating from ",i,"to ",qW),wW(e,i),i<100&&(void 0===e.scene.publish.joystickSizeAndXYOffset&&(e.scene.publish.joystickSizeAndXYOffset=Gj.defaultData.joystickSizeAndXYOffset),e.schema=100),i<101&&(uW(e,SW),dW(e,SW),e.schema=101),i<102&&(function(e){e.scene.objects.traverse((e,t)=>{let i=t.geometry;i&&"PathGeometry"===i.type&&(i.extrusion.capType="flat",i.extrusion.bevel=50,i.extrusion.bevelSides=6,"Custom"===i.extrusion.shape.type&&(i.extrusion.shape.shapeQuality="low"))})}(e),e.schema=102),i<104&&(e.shared.catelogs=new DN,e.shared.lib=rW.defaultData(),e.schema=104),i<105&&(function(e){e.shared.variables=tN({},DN.prototype)}(e),e.scene.objects.traverse((e,t)=>{EW(t)}),e.schema=105);for(let t of Object.values(e.shared.lib.components))YW(t);i<106&&(function(e){let t=bF(e.shared.variables);e.shared.variables=tN(Object.entries(null!==t&&void 0!==t?t:{}).map((e,t)=>{let[i,n]=e;return{fi:t,id:i,data:n}}),UN.prototype)}(e),e.schema=106),i<107&&(e.shared.lib.variables=rW.defaultData().variables,e.schema=107),i<109&&(function(e){e.shared.particles=tN({},DN.prototype),e.shared.lib&&(e.shared.lib.particles=rW.defaultData().particles)}(e),e.schema=109),i<110&&(function(e){e.scene.objects.traverse((e,t)=>{"Particle"===t.type&&"number"==typeof t.renderMaterial.size&&Object.assign(t.renderMaterial,{size:[t.renderMaterial.size,t.renderMaterial.size]})})}(e),e.schema=110),i<111&&(e.scene.objects.traverse((e,t)=>{!function(e){var t;Array.isArray(bF(e.events))&&(null===(t=e.events)||void 0===t||t.forEach(e=>{"disabled"in e||(e.disabled=!1),("MouseDown"===e.type||"MouseUp"===e.type||"MousePress"===e.type)&&(e.mode=e.mode||"Object")}))}(t)}),e.schema=111),i<112&&(function(e){e.scene.objects.traverse((e,t)=>{"Page"===t.type&&(t.postprocessing.depthOfField.focusDistance=100,t.postprocessing.depthOfField.focalLength=20,t.postprocessing.depthOfField.bokehScale=5)})}(e),e.schema=112),i<113&&(function(e){e.scene.objects.traverse((e,t)=>{var i;!1!==Array.isArray(bF(t.events))&&(null===(i=t.events)||void 0===i||i.forEach(e=>{var t,i,n,r,a,o,s,l,c;let d=e.runMode;"MouseDown"===e.type||"MouseUp"===e.type||"KeyDown"===e.type||"KeyUp"===e.type||"Collision"===e.type||"Trigger"===e.type?null===(t=e.actions)||void 0===t||t.forEach(e=>{"Transition"===e.type&&(e.runMode=null!==d&&void 0!==d?d:"Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle"===d?"Toggle":"Normal")}):"MouseHover"===e.type||"MousePress"===e.type||"KeyPress"===e.type?null===(i=e.actions)||void 0===i||i.forEach(e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")}):"GameControl"===e.type?(delete e.actions,Object.keys(e.gameActions).forEach(t=>{var i;null===(i=e.gameActions[t])||void 0===i||i.forEach(e=>{"Transition"===e.type&&(e.runMode="Repeat"),"Animation"===e.type&&(e.runMode="Normal")})})):"DragDrop"===e.type?(delete e.actions,null!==(n=e.dragDropActions)&&void 0!==n&&null!==(n=n.drag)&&void 0!==n&&n.forEach(e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")}),null===(r=e.dragDropActions)||void 0===r||null===(r=r.drop)||void 0===r||r.forEach(e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")})):"Resize"===e.type?(delete e.actions,null===(a=e.breakpoints)||void 0===a||a.forEach(e=>{var t;null===(t=e.actions)||void 0===t||t.forEach(e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")})})):"Start"===e.type?null===(o=e.actions)||void 0===o||o.forEach(e=>{"Transition"===e.type&&(e.runMode="Once"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")}):"VariableChange"===e.type||"Scroll"===e.type?null===(s=e.actions)||void 0===s||s.forEach(e=>{"Transition"===e.type&&(e.runMode="Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")}):"Conditional"===e.type&&(delete e.actions,null!==(l=e.inActions)&&void 0!==l&&l.forEach(e=>{"Transition"===e.type&&(e.runMode="Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")}),null===(c=e.outActions)||void 0===c||c.forEach(e=>{"Transition"===e.type&&(e.runMode="Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")}))}))})}(e),e.schema=113),i<114&&(void 0===e.scene.publish.settings.web.imageQuality&&(e.scene.publish.settings.web.imageQuality=70),e.schema=114),i<115&&(function(e){e.shared.userAPIs=tN({},DN.prototype),e.shared.userWebhooks=tN({},DN.prototype),e.shared.lib&&(e.shared.lib.userAPIs=rW.defaultData().userAPIs,e.shared.lib.userWebhooks=rW.defaultData().userWebhooks)}(e),e.schema=115),i<116&&(function(e){void 0===e.scene.publish.settings.videoStatic&&(e.scene.publish.settings.videoStatic=Gj.defaultData.settings.videoStatic)}(e),e.schema=116),i<117&&(void 0===e.scene.publish.settings.web.pixelRatioMobile&&(e.scene.publish.settings.web.pixelRatioMobile=0),void 0===e.scene.publish.settings.web.pixelRatioDesktop&&(e.scene.publish.settings.web.pixelRatioDesktop=0),e.schema=117)}}function KW(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=null!==e[0].index,n=new Set(Object.keys(e[0].attributes)),r=new Set(Object.keys(e[0].morphAttributes)),a={},o={},s=e[0].morphTargetsRelative,l=new vE,c=0;for(let d=0;d<e.length;++d){let u=e[d],h=0;if(i!==(null!==u.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let e in u.attributes){if(!n.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+'. All geometries must have compatible attributes; make sure "'+e+'" attribute exists among all geometries, or in none of them.'),null;void 0===a[e]&&(a[e]=[]),a[e].push(u.attributes[e]),h++}if(h!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". Make sure all geometries have the same number of attributes."),null;if(s!==u.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let e in u.morphAttributes){if(!r.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[e]&&(o[e]=[]),o[e].push(u.morphAttributes[e])}if(t){let e;if(i)e=u.index.count;else{if(void 0===u.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". The geometry must have either an index or a position attribute"),null;e=u.attributes.position.count}l.addGroup(c,e,d),c+=e}}if(i){let t=0,i=[];for(let n=0;n<e.length;++n){let r=e[n].index;for(let e=0;e<r.count;++e)i.push(r.getX(e)+t);t+=e[n].attributes.position.count}l.setIndex(i)}for(let d in a){let e=ZW(a[d]);if(!e)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+d+" attribute."),null;l.setAttribute(d,e)}for(let d in o){let e=o[d][0].length;if(0===e)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[d]=[];for(let t=0;t<e;++t){let e=[];for(let n=0;n<o[d].length;++n)e.push(o[d][n][t]);let i=ZW(e);if(!i)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+d+" morphAttribute."),null;l.morphAttributes[d].push(i)}}return l}function ZW(e){let t,i,n,r=0;for(let s=0;s<e.length;++s){let a=e[s];if(a.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===t&&(t=a.array.constructor),t!==a.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===i&&(i=a.itemSize),i!==a.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===n&&(n=a.normalized),n!==a.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=a.array.length}let a=new t(r),o=0;for(let s=0;s<e.length;++s)a.set(e[s].array,o),o+=e[s].array.length;return new oE(a,i,n)}(e=>{e.defaultData={schema:qW,scene:Kj.defaultData,frames:(new DN).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Zj.defaultData),shared:c(c({},aW.emptyData()),{},{colors:aW.defaultColors()})},e.emptyDataForImports=function(){let e=Kj.emptyDataWithPage();return{schema:qW,scene:e,frames:(new DN).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Zj.defaultData),shared:c(c({},aW.emptyData()),{},{colors:aW.defaultColors(),images:aW.defaultImages()})}},e.emptyData=function(){return{schema:qW,scene:Kj.emptyDataWithPage(),frames:(new DN).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Zj.defaultData),shared:aW.emptyData()}},e.clipboard2dData=function(){return{schema:qW,scene:Kj.emptyData(),frames:new DN,shared:aW.emptyData()}},e.collabHelper=c(c({},qN),{},{updateSchema(e){var t,i;return(null!==(t=e.schema)&&void 0!==t?t:0)<qW?yF(e,QW):(null!==(i=e.schema)&&void 0!==i?i:0)-qW}}),e.updateSchemaDirectly=function(t){let i=e.collabHelper.updateSchema(t);return"number"==typeof i?0===i?t:null:i.data},e.withoutLib=function(e){return c(c({},e),{},{shared:c(c({},e.shared),{},{lib:rW.defaultData()})})},e.getComponentData=function(e,t){let i=e.scene.objects.get(t);if(i&&"Component"===i.data.type)return i;{let i=e.shared.lib.components[t];if(i)return i.asset}},e.hasSensitiveData=function(e){let t=Object.values(e.shared.userAPIs);for(let i of t){let e=i.headers;for(let t of e)if("authorization"===t.data.key.toLowerCase()&&""!==t.data.value)return!0}return!1}})(AW||(AW={})),(e=>{e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"}})(MW||(MW={})),(e=>{e.is=function(e){return!0}})(TW||(TW={})),(e=>{e.defaultData={position:[0,0],scale:[1,1],rotation:0,shear:[0,0]},e.merge=function(e,t){var i,n,r,a;return{position:null!==(i=null===t||void 0===t?void 0:t.position)&&void 0!==i?i:e.position,rotation:null!==(n=null===t||void 0===t?void 0:t.rotation)&&void 0!==n?n:e.rotation,scale:null!==(r=null===t||void 0===t?void 0:t.scale)&&void 0!==r?r:e.scale,shear:null!==(a=null===t||void 0===t?void 0:t.shear)&&void 0!==a?a:e.shear}},e.diff=function(e,t){return eN({position:bV.isEqual(e.position,t.position)?void 0:t.position,rotation:e.rotation===t.rotation?void 0:t.rotation,scale:bV.isEqual(e.scale,t.scale)?void 0:t.scale,shear:e.shear&&t.shear&&bV.isEqual(e.shear,t.shear)?void 0:t.shear})}})(PW||(PW={})),(e=>{e.defaultData={horizontalConstraint:0,verticalConstraint:0}})(DW||(DW={})),(e=>{e.defaultData={direction:"row",wrap:"unwrap",align:"top-left",gap:10,rowGap:10,autoGap:!1,autoRowGap:!1,leftPadding:8,rightPadding:8,topPadding:8,bottomPadding:8}})(OW||(OW={})),(e=>{e.defaultData={opacity:1,fill:{color:TV.fromHexAndA(kV,1),enabled:!0},stroke:{color:TV.from0to1([0,0,0,1]),thickness:1,enabled:!1,mode:"inside"},layerBlur:{radius:2,enabled:!1},backgroundBlur:{radius:2,enabled:!1},dropShadow:{offset:[10,10],blurRadius:10,color:TV.from0to1([0,0,0,1]),enabled:!1,spread:0},innerShadow:{offset:[10,10],blurRadius:10,color:TV.from0to1([0,0,0,1]),enabled:!1,spread:0}}})(IW||(IW={})),(e=>{e.newEmpty=function(e,t){return{name:t}},e.patch=function(e,t){if(void 0===t)return e;let i=c({},e);return Object.assign(i,PW.merge(i,t)),i=function(e,t){if(void 0===t)return e;let i=c({},e),n=["width","height","cornerRadius"];for(let r of n)r in i&&r in t&&void 0!==t[r]&&Object.assign(i,{[r]:t[r]});return i}(i,t),i=function(e,t){if(void 0===t)return e;let i=c({},e);return"fill"in i&&"fill"in t&&void 0!==t.fill&&Object.assign(i,{fill:c(c({},i.fill),t.fill)}),"stroke"in i&&"stroke"in t&&void 0!==t.stroke&&Object.assign(i,{stroke:c(c({},i.stroke),t.stroke)}),"layerBlur"in i&&"layerBlur"in t&&void 0!==t.layerBlur&&Object.assign(i,{layerBlur:c(c({},i.layerBlur),t.layerBlur)}),"backgroundBlur"in i&&"backgroundBlur"in t&&void 0!==t.backgroundBlur&&Object.assign(i,{backgroundBlur:c(c({},i.backgroundBlur),t.backgroundBlur)}),"dropShadow"in i&&"dropShadow"in t&&void 0!==t.dropShadow&&Object.assign(i,{dropShadow:c(c({},i.dropShadow),t.dropShadow)}),"innerShadow"in i&&"innerShadow"in t&&void 0!==t.innerShadow&&Object.assign(i,{innerShadow:c(c({},i.innerShadow),t.innerShadow)}),i}(i,t),i},e.toOps=function(e,t){let i,n=[];for(let[r,a]of Object.entries(t))"name"!==r&&(void 0===i&&(i={path:[],props:{},type:0},n.push(i)),i.props[r]=a);return n}})(kW||(kW={})),(e=>{e.defaultData=c(c(c({},PW.defaultData),DW.defaultData),{},{states:new UN,events:new UN,visible:!0,raycastLock:!1})})(RW||(RW={})),(e=>{e.defaultData=c(c({},RW.defaultData),IW.defaultData)})(zW||(zW={})),(e=>{e.defaultData={cornerRadius:[0,0,0,0]}})(LW||(LW={})),(e=>{e.defaultData=c(c({},zW.defaultData),{},{type:"ellipse2d",width:100,height:100,name:"Ellipse"})})(BW||(BW={})),(e=>{e.defaultData=c(c(c({},zW.defaultData),LW.defaultData),{},{type:"rectangle2d",width:100,height:100,name:"Rectangle"})})(NW||(NW={})),(e=>{e.defaultData=c(c({},zW.defaultData),{},{type:"text2d",width:100,height:100,fontSize:12,lineHeight:1.2,letterSpacing:0,text:{textValue:"Hello world"},horizontalAlign:1,verticalAlign:1,textTransform:1,font:"Roboto_regular",name:"Text"})})(FW||(FW={})),(e=>{e.defaultData=c(c({},zW.defaultData),{},{type:"path2d",path:"",name:"Path"})})(UW||(UW={})),(e=>{e.is=function(e){return"ellipse2d"===e.type||"rectangle2d"===e.type||"text2d"===e.type||"vector2d"===e.type||"path2d"===e.type}})(VW||(VW={})),(e=>{e.defaultData=c(c({},RW.defaultData),{},{name:"Group",type:"group2d"})})(jW||(jW={})),(e=>{e.defaultData=()=>c(c(c(c({},RW.defaultData),LW.defaultData),IW.defaultData),{},{name:"Frame",type:"frame2d",clipped:!0,width:200,height:200,fill:{color:TV.fromHexAndA(4737101,1),enabled:!0},stroke:{color:TV.fromHexAndA(0,1),thickness:1,enabled:!1,mode:"inside"},backgroundBlur:{radius:2,enabled:!1},layerBlur:{radius:2,enabled:!1}})})(WW||(WW={})),(e=>{e.defaultData=function(e){switch(e){case"rectangle2d":case"vector2d":return c({},NW.defaultData);case"ellipse2d":return c({},BW.defaultData);case"text2d":return c({},FW.defaultData);case"path2d":return c({},UW.defaultData);case"frame2d":return c({},WW.defaultData());case"group2d":return c({},jW.defaultData)}},e.getPivot=function(e){return"width"in e&&"height"in e?["number"==typeof e.width?.5*e.width:0,"number"==typeof e.height?.5*e.height:0]:[0,0]},e.isResizeable=function(e){return"rectangle2d"===e.type||"ellipse2d"===e.type||"text2d"===e.type||"frame2d"===e.type},e.isAutoLayoutable=function(e){return"frame2d"===e.type&&void 0!==e.autoLayout},e.hasCorners=function(e){return"rectangle2d"===e.type||"frame2d"===e.type}})(HW||(HW={})),(e=>{e.defaultData={name:"UI",type:"scene2d",objects:new FN},e.emptyData=function(){return{type:"scene2d",objects:new FN}}})(GW||(GW={}));var JW=Math.pow(2,-24),$W=class{constructor(){}};function eH(e,t,i){return i.min.x=t[e],i.min.y=t[e+1],i.min.z=t[e+2],i.max.x=t[e+3],i.max.y=t[e+4],i.max.z=t[e+5],i}function tH(e){let t=-1,i=-1/0;for(let n=0;n<3;n++){let r=e[n+3]-e[n];r>i&&(i=r,t=n)}return t}function iH(e,t){t.set(e)}function nH(e,t,i){let n,r;for(let a=0;a<3;a++){let o=a+3;n=e[a],r=t[a],i[a]=n<r?n:r,n=e[o],r=t[o],i[o]=n>r?n:r}}function rH(e,t,i){for(let n=0;n<3;n++){let r=t[e+2*n],a=t[e+2*n+1],o=r-a,s=r+a;o<i[n]&&(i[n]=o),s>i[n+3]&&(i[n+3]=s)}}function aH(e){let t=e[3]-e[0],i=e[4]-e[1],n=e[5]-e[2];return 2*(t*i+i*n+n*t)}function oH(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=1/0,o=1/0,s=1/0,l=-1/0,c=-1/0,d=-1/0,u=1/0,h=1/0,p=1/0,f=-1/0,m=-1/0,g=-1/0,v=null!==r;for(let y=6*t,b=6*(t+i);y<b;y+=6){let t=e[y+0],i=e[y+1],n=t-i,r=t+i;n<a&&(a=n),r>l&&(l=r),v&&t<u&&(u=t),v&&t>f&&(f=t);let b=e[y+2],x=e[y+3],w=b-x,S=b+x;w<o&&(o=w),S>c&&(c=S),v&&b<h&&(h=b),v&&b>m&&(m=b);let _=e[y+4],C=e[y+5],E=_-C,A=_+C;E<s&&(s=E),A>d&&(d=A),v&&_<p&&(p=_),v&&_>g&&(g=_)}n[0]=a,n[1]=o,n[2]=s,n[3]=l,n[4]=c,n[5]=d,v&&(r[0]=u,r[1]=h,r[2]=p,r[3]=f,r[4]=m,r[5]=g)}var sH=32,lH=(e,t)=>e.candidate-t.candidate,cH=new Array(sH).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),dH=new Float32Array(6);function uH(e,t){function i(e){h&&h(e/p)}function n(t,r,h){let p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,m=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!f&&m>=l&&(f=!0,c&&(console.warn("MeshBVH: Max depth of ".concat(l," reached when generating BVH. Consider increasing maxDepth.")),console.warn(e))),h<=d||m>=l)return i(r+h),t.offset=r,t.count=h,t;let g=function(e,t,i,n,r,a){let o=-1,s=0;if(0===a)o=tH(t),-1!==o&&(s=(t[o]+t[o+3])/2);else if(1===a)o=tH(e),-1!==o&&(s=function(e,t,i,n){let r=0;for(let a=t,o=t+i;a<o;a++)r+=e[6*a+2*n];return r/i}(i,n,r,o));else if(2===a){let a=aH(e),l=1.25*r,c=6*n,d=6*(n+r);for(let e=0;e<3;e++){let n=t[e],u=(t[e+3]-n)/sH;if(r<8){let t=[...cH];t.length=r;let n=0;for(let r=c;r<d;r+=6,n++){let a=t[n];a.candidate=i[r+2*e],a.count=0;let{bounds:o,leftCacheBounds:s,rightCacheBounds:l}=a;for(let e=0;e<3;e++)l[e]=1/0,l[e+3]=-1/0,s[e]=1/0,s[e+3]=-1/0,o[e]=1/0,o[e+3]=-1/0;rH(r,i,o)}t.sort(lH);let u=r;for(let e=0;e<u;e++){let i=t[e];for(;e+1<u&&t[e+1].candidate===i.candidate;)t.splice(e+1,1),u--}for(let r=c;r<d;r+=6){let n=i[r+2*e];for(let e=0;e<u;e++){let a=t[e];n>=a.candidate?rH(r,i,a.rightCacheBounds):(rH(r,i,a.leftCacheBounds),a.count++)}}for(let i=0;i<u;i++){let n=t[i],c=n.count,d=r-n.count,u=n.leftCacheBounds,h=n.rightCacheBounds,p=0;0!==c&&(p=aH(u)/a);let f=0;0!==d&&(f=aH(h)/a);let m=1+1.25*(p*c+f*d);m<l&&(o=e,l=m,s=n.candidate)}}else{for(let e=0;e<sH;e++){let t=cH[e];t.count=0,t.candidate=n+u+e*u;let i=t.bounds;for(let e=0;e<3;e++)i[e]=1/0,i[e+3]=-1/0}for(let r=c;r<d;r+=6){let t=~~((i[r+2*e]-n)/u);t>=sH&&(t=31);let a=cH[t];a.count++,rH(r,i,a.bounds)}let t=cH[31];iH(t.bounds,t.rightCacheBounds);for(let e=30;e>=0;e--){let t=cH[e],i=cH[e+1];nH(t.bounds,i.rightCacheBounds,t.rightCacheBounds)}let h=0;for(let i=0;i<31;i++){let t=cH[i],n=t.count,c=t.bounds,d=cH[i+1].rightCacheBounds;0!==n&&(0===h?iH(c,dH):nH(c,dH,dH)),h+=n;let u=0,p=0;0!==h&&(u=aH(dH)/a);let f=r-h;0!==f&&(p=aH(d)/a);let m=1+1.25*(u*h+p*f);m<l&&(o=e,l=m,s=t.candidate)}}}}else console.warn("MeshBVH: Invalid build strategy value ".concat(a," used."));return{axis:o,pos:s}}(t.boundingData,p,o,r,h,u);if(-1===g.axis)return i(r+h),t.offset=r,t.count=h,t;let v=function(e,t,i,n,r){let a=i,o=i+n-1,s=r.pos,l=2*r.axis;for(;;){for(;a<=o&&t[6*a+l]<s;)a++;for(;a<=o&&t[6*o+l]>=s;)o--;if(!(a<o))return a;for(let i=0;i<3;i++){let n=e[3*a+i];e[3*a+i]=e[3*o+i],e[3*o+i]=n;let r=t[6*a+2*i+0];t[6*a+2*i+0]=t[6*o+2*i+0],t[6*o+2*i+0]=r;let s=t[6*a+2*i+1];t[6*a+2*i+1]=t[6*o+2*i+1],t[6*o+2*i+1]=s}a++,o--}}(s,o,r,h,g);if(v===r||v===r+h)i(r+h),t.offset=r,t.count=h;else{t.splitAxis=g.axis;let e=new $W,i=r,s=v-r;t.left=e,e.boundingData=new Float32Array(6),oH(o,i,s,e.boundingData,a),n(e,i,s,a,m+1);let l=new $W,c=v,d=h-s;t.right=l,l.boundingData=new Float32Array(6),oH(o,c,d,l.boundingData,a),n(l,c,d,a,m+1)}return t}!function(e,t){if(!e.index){let i,n=e.attributes.position.count,r=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;i=n>65535?new Uint32Array(new r(4*n)):new Uint16Array(new r(2*n)),e.setIndex(new oE(i,1));for(let e=0;e<n;e++)i[e]=e}}(e,t);let r=new Float32Array(6),a=new Float32Array(6),o=function(e,t){let i=e.attributes.position,n=e.index.array,r=n.length/3,a=new Float32Array(6*r),o=i.normalized,s=i.array,l=i.offset||0,c=3;i.isInterleavedBufferAttribute&&(c=i.data.stride);let d=["getX","getY","getZ"];for(let u=0;u<r;u++){let e,r,h,p=3*u,f=6*u;o?(e=n[p+0],r=n[p+1],h=n[p+2]):(e=n[p+0]*c+l,r=n[p+1]*c+l,h=n[p+2]*c+l);for(let n=0;n<3;n++){let l,c,u;o?(l=i[d[n]](e),c=i[d[n]](r),u=i[d[n]](h)):(l=s[e+n],c=s[r+n],u=s[h+n]);let p=l;c<p&&(p=c),u<p&&(p=u);let m=l;c>m&&(m=c),u>m&&(m=u);let g=(m-p)/2,v=2*n;a[f+v+0]=p+g,a[f+v+1]=g+(Math.abs(p)+g)*JW,p<t[n]&&(t[n]=p),m>t[n+3]&&(t[n+3]=m)}}return a}(e,r),s=e.index.array,l=t.maxDepth,c=t.verbose,d=t.maxLeafTris,u=t.strategy,h=t.onProgress,p=e.index.count/3,f=!1,m=[],g=function(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],i=new Set;for(let r of e.groups)i.add(r.start),i.add(r.start+r.count);let n=Array.from(i.values()).sort((e,t)=>e-t);for(let r=0;r<n.length-1;r++){let e=n[r],i=n[r+1];t.push({offset:e/3,count:(i-e)/3})}return t}(e);if(1===g.length){let e=g[0],t=new $W;t.boundingData=r,function(e,t,i,n){let r=1/0,a=1/0,o=1/0,s=-1/0,l=-1/0,c=-1/0;for(let d=6*t,u=6*(t+i);d<u;d+=6){let t=e[d+0];t<r&&(r=t),t>s&&(s=t);let i=e[d+2];i<a&&(a=i),i>l&&(l=i);let n=e[d+4];n<o&&(o=n),n>c&&(c=n)}n[0]=r,n[1]=a,n[2]=o,n[3]=s,n[4]=l,n[5]=c}(o,e.offset,e.count,a),n(t,e.offset,e.count,a),m.push(t)}else for(let v of g){let e=new $W;e.boundingData=new Float32Array(6),oH(o,v.offset,v.count,e.boundingData,a),n(e,v.offset,v.count,a),m.push(e)}return m}var hH=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let i=1/0,n=-1/0;for(let r=0,a=e.length;r<a;r++){let a=e[r][t];i=a<i?a:i,n=a>n?a:n}this.min=i,this.max=n}setFromPoints(e,t){let i=1/0,n=-1/0;for(let r=0,a=t.length;r<a;r++){let a=t[r],o=e.dot(a);i=o<i?o:i,n=o>n?o:n}this.min=i,this.max=n}isSeparated(e){return this.min>e.max||e.min>this.max}};hH.prototype.setFromBox=function(){let e=new j_;return function(t,i){let n=i.min,r=i.max,a=1/0,o=-1/0;for(let s=0;s<=1;s++)for(let i=0;i<=1;i++)for(let l=0;l<=1;l++){e.x=n.x*s+r.x*(1-s),e.y=n.y*i+r.y*(1-i),e.z=n.z*l+r.z*(1-l);let c=t.dot(e);a=Math.min(c,a),o=Math.max(c,o)}this.min=a,this.max=o}}();!function(){let e=new hH}();var pH=function(){let e=new j_,t=new j_,i=new j_;return function(n,r,a){let o=n.start,s=e,l=r.start,c=t;i.subVectors(o,l),e.subVectors(n.end,n.start),t.subVectors(r.end,r.start);let d,u,h=i.dot(c),p=c.dot(s),f=c.dot(c),m=i.dot(s),g=s.dot(s)*f-p*p;d=0!==g?(h*p-m*f)/g:0,u=(h+d*p)/f,a.x=d,a.y=u}}(),fH=function(){let e=new p_,t=new j_,i=new j_;return function(n,r,a,o){pH(n,r,e);let s=e.x,l=e.y;if(s>=0&&s<=1&&l>=0&&l<=1)return n.at(s,a),void r.at(l,o);if(s>=0&&s<=1)return l<0?r.at(0,o):r.at(1,o),void n.closestPointToPoint(o,!0,a);if(l>=0&&l<=1)return s<0?n.at(0,a):n.at(1,a),void r.closestPointToPoint(a,!0,o);{let e,c;e=s<0?n.start:n.end,c=l<0?r.start:r.end;let d=t,u=i;return n.closestPointToPoint(c,!0,t),r.closestPointToPoint(e,!0,i),d.distanceToSquared(c)<=u.distanceToSquared(e)?(a.copy(d),void o.copy(c)):(a.copy(e),void o.copy(u))}}}(),mH=function(){let e=new j_,t=new j_,i=new YE,n=new MO;return function(r,a){let{radius:o,center:s}=r,{a:l,b:c,c:d}=a;if(n.start=l,n.end=c,n.closestPointToPoint(s,!0,e).distanceTo(s)<=o||(n.start=l,n.end=d,n.closestPointToPoint(s,!0,e).distanceTo(s)<=o)||(n.start=c,n.end=d,n.closestPointToPoint(s,!0,e).distanceTo(s)<=o))return!0;let u=a.getPlane(i);if(Math.abs(u.distanceToPoint(s))<=o){let e=u.projectPoint(s,t);if(a.containsPoint(e))return!0}return!1}}();function gH(e){return Math.abs(e)<1e-15}var vH=class extends eE{constructor(){super(...arguments),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new j_),this.satBounds=new Array(4).fill().map(()=>new hH),this.points=[this.a,this.b,this.c],this.sphere=new cC,this.plane=new YE,this.needsUpdate=!0}intersectsSphere(e){return mH(e,this)}update(){let e=this.a,t=this.b,i=this.c,n=this.points,r=this.satAxes,a=this.satBounds,o=r[0],s=a[0];this.getNormal(o),s.setFromPoints(o,n);let l=r[1],c=a[1];l.subVectors(e,t),c.setFromPoints(l,n);let d=r[2],u=a[2];d.subVectors(t,i),u.setFromPoints(d,n);let h=r[3],p=a[3];h.subVectors(i,e),p.setFromPoints(h,n),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(o,e),this.needsUpdate=!1}};vH.prototype.closestPointToSegment=function(){let e=new j_,t=new j_,i=new MO;return function(n){let r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,{start:s,end:l}=n,c=this.points,d=1/0;for(let u=0;u<3;u++){let s=(u+1)%3;i.start.copy(c[u]),i.end.copy(c[s]),fH(i,n,e,t),r=e.distanceToSquared(t),r<d&&(d=r,a&&a.copy(e),o&&o.copy(t))}return this.closestPointToPoint(s,e),r=s.distanceToSquared(e),r<d&&(d=r,a&&a.copy(e),o&&o.copy(s)),this.closestPointToPoint(l,e),r=l.distanceToSquared(e),r<d&&(d=r,a&&a.copy(e),o&&o.copy(l)),Math.sqrt(d)}}(),vH.prototype.intersectsTriangle=function(){let e=new vH,t=new Array(3),i=new Array(3),n=new hH,r=new hH,a=new j_,o=new j_,s=new j_,l=new j_,c=new MO,d=new MO,u=new MO;return function(h){let p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,f=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.needsUpdate&&this.update(),h.isExtendedTriangle?h.needsUpdate&&h.update():(e.copy(h),e.update(),h=e);let m=this.plane,g=h.plane;if(Math.abs(m.normal.dot(g.normal))>1-1e-10){let e=this.satBounds,o=this.satAxes;i[0]=h.a,i[1]=h.b,i[2]=h.c;for(let t=0;t<4;t++){let r=e[t],a=o[t];if(n.setFromPoints(a,i),r.isSeparated(n))return!1}let s=h.satBounds,l=h.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let i=0;i<4;i++){let e=s[i],r=l[i];if(n.setFromPoints(r,t),e.isSeparated(n))return!1}for(let c=0;c<4;c++){let e=o[c];for(let o=0;o<4;o++){let s=l[o];if(a.crossVectors(e,s),n.setFromPoints(a,t),r.setFromPoints(a,i),n.isSeparated(r))return!1}}return p&&(f||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),p.start.set(0,0,0),p.end.set(0,0,0)),!0}{let e=this.points,t=!1,i=0;for(let s=0;s<3;s++){let n=e[s],r=e[(s+1)%3];c.start.copy(n),c.end.copy(r),c.delta(o);let a=t?d.start:d.end,l=gH(g.distanceToPoint(n));if(gH(g.normal.dot(o))&&l){d.copy(c),i=2;break}if((g.intersectLine(c,a)||l)&&!gH(a.distanceTo(r))){if(i++,t)break;t=!0}}if(1===i&&h.containsPoint(d.end))return p&&(p.start.copy(d.end),p.end.copy(d.end)),!0;if(2!==i)return!1;let n=h.points,r=!1,a=0;for(let o=0;o<3;o++){let e=n[o],t=n[(o+1)%3];c.start.copy(e),c.end.copy(t),c.delta(s);let i=r?u.start:u.end,l=gH(m.distanceToPoint(e));if(gH(m.normal.dot(s))&&l){u.copy(c),a=2;break}if((m.intersectLine(c,i)||l)&&!gH(i.distanceTo(t))){if(a++,r)break;r=!0}}if(1===a&&this.containsPoint(u.end))return p&&(p.start.copy(u.end),p.end.copy(u.end)),!0;if(2!==a)return!1;if(d.delta(o),u.delta(s),o.dot(s)<0){let e=u.start;u.start=u.end,u.end=e}let f=d.start.dot(o),v=d.end.dot(o),y=u.start.dot(o),b=u.end.dot(o);return(f===b||y===v||v<y!==f<b)&&(p&&(l.subVectors(d.start,u.start),l.dot(o)>0?p.start.copy(d.start):p.start.copy(u.start),l.subVectors(d.end,u.end),l.dot(o)<0?p.end.copy(d.end):p.end.copy(u.end)),!0)}}}(),vH.prototype.distanceToPoint=function(){let e=new j_;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),vH.prototype.distanceToTriangle=function(){let e=new j_,t=new j_,i=["a","b","c"],n=new MO,r=new MO;return function(a){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=o||s?n:null;if(this.intersectsTriangle(a,l))return(o||s)&&(o&&l.getCenter(o),s&&l.getCenter(s)),0;let c=1/0;for(let t=0;t<3;t++){let n,r=i[t],l=a[r];this.closestPointToPoint(l,e),n=l.distanceToSquared(e),n<c&&(c=n,o&&o.copy(e),s&&s.copy(l));let d=this[r];a.closestPointToPoint(d,e),n=d.distanceToSquared(e),n<c&&(c=n,o&&o.copy(d),s&&s.copy(e))}for(let d=0;d<3;d++){let l=i[d],u=i[(d+1)%3];n.set(this[l],this[u]);for(let d=0;d<3;d++){let l=i[d],u=i[(d+1)%3];r.set(a[l],a[u]),fH(n,r,e,t);let h=e.distanceToSquared(t);h<c&&(c=h,o&&o.copy(e),s&&s.copy(t))}}return Math.sqrt(c)}}();var yH=class{constructor(e,t,i){this.isOrientedBox=!0,this.min=new j_,this.max=new j_,this.matrix=new yC,this.invMatrix=new yC,this.points=new Array(8).fill().map(()=>new j_),this.satAxes=new Array(3).fill().map(()=>new j_),this.satBounds=new Array(3).fill().map(()=>new hH),this.alignedSatBounds=new Array(3).fill().map(()=>new hH),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),i&&this.matrix.copy(i)}set(e,t,i){this.min.copy(e),this.max.copy(t),this.matrix.copy(i),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};yH.prototype.update=function(){let e=this.matrix,t=this.min,i=this.max,n=this.points;for(let l=0;l<=1;l++)for(let r=0;r<=1;r++)for(let a=0;a<=1;a++){let o=n[1*l|2*r|4*a];o.x=l?i.x:t.x,o.y=r?i.y:t.y,o.z=a?i.z:t.z,o.applyMatrix4(e)}let r=this.satBounds,a=this.satAxes,o=n[0];for(let l=0;l<3;l++){let e=a[l],t=r[l],i=n[1<<l];e.subVectors(o,i),t.setFromPoints(e,n)}let s=this.alignedSatBounds;s[0].setFromPointsField(n,"x"),s[1].setFromPointsField(n,"y"),s[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},yH.prototype.intersectsBox=function(){let e=new hH;return function(t){this.needsUpdate&&this.update();let i=t.min,n=t.max,r=this.satBounds,a=this.satAxes,o=this.alignedSatBounds;if(e.min=i.x,e.max=n.x,o[0].isSeparated(e)||(e.min=i.y,e.max=n.y,o[1].isSeparated(e))||(e.min=i.z,e.max=n.z,o[2].isSeparated(e)))return!1;for(let s=0;s<3;s++){let i=a[s],n=r[s];if(e.setFromBox(i,t),n.isSeparated(e))return!1}return!0}}(),yH.prototype.intersectsTriangle=function(){let e=new vH,t=new Array(3),i=new hH,n=new hH,r=new j_;return function(a){this.needsUpdate&&this.update(),a.isExtendedTriangle?a.needsUpdate&&a.update():(e.copy(a),e.update(),a=e);let o=this.satBounds,s=this.satAxes;t[0]=a.a,t[1]=a.b,t[2]=a.c;for(let e=0;e<3;e++){let n=o[e],r=s[e];if(i.setFromPoints(r,t),n.isSeparated(i))return!1}let l=a.satBounds,c=a.satAxes,d=this.points;for(let e=0;e<3;e++){let t=l[e],n=c[e];if(i.setFromPoints(n,d),t.isSeparated(i))return!1}for(let e=0;e<3;e++){let a=s[e];for(let e=0;e<4;e++){let o=c[e];if(r.crossVectors(a,o),i.setFromPoints(r,t),n.setFromPoints(r,d),i.isSeparated(n))return!1}}return!0}}(),yH.prototype.closestPointToPoint=function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t},yH.prototype.distanceToPoint=function(){let e=new j_;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),yH.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map(()=>new MO),i=new Array(12).fill().map(()=>new MO),n=new j_,r=new j_;return function(a){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.needsUpdate&&this.update(),this.intersectsBox(a))return(s||l)&&(a.getCenter(r),this.closestPointToPoint(r,n),a.closestPointToPoint(n,r),s&&s.copy(n),l&&l.copy(r)),0;let c=o*o,d=a.min,u=a.max,h=this.points,p=1/0;for(let e=0;e<8;e++){let t=h[e];r.copy(t).clamp(d,u);let i=t.distanceToSquared(r);if(i<p&&(p=i,s&&s.copy(t),l&&l.copy(r),i<c))return Math.sqrt(i)}let f=0;for(let n=0;n<3;n++)for(let r=0;r<=1;r++)for(let a=0;a<=1;a++){let o=(n+1)%3,s=(n+2)%3,l=1<<n|r<<o|a<<s,c=h[r<<o|a<<s],p=h[l];t[f].set(c,p);let m=e[n],g=e[o],v=e[s],y=i[f],b=y.start,x=y.end;b[m]=d[m],b[g]=r?d[g]:u[g],b[v]=a?d[v]:u[g],x[m]=u[m],x[g]=r?d[g]:u[g],x[v]=a?d[v]:u[g],f++}for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let i=0;i<=1;i++){r.x=e?u.x:d.x,r.y=t?u.y:d.y,r.z=i?u.z:d.z,this.closestPointToPoint(r,n);let a=r.distanceToSquared(n);if(a<p&&(p=a,s&&s.copy(n),l&&l.copy(r),a<c))return Math.sqrt(a)}for(let e=0;e<12;e++){let a=t[e];for(let e=0;e<12;e++){let t=i[e];fH(a,t,n,r);let o=n.distanceToSquared(r);if(o<p&&(p=o,s&&s.copy(n),l&&l.copy(r),o<c))return Math.sqrt(o)}}return Math.sqrt(p)}}();var bH=new j_,xH=new j_,wH=new j_,SH=new p_,_H=new p_,CH=new p_,EH=new j_,AH=new j_,MH=new j_,TH=new j_;function PH(e,t,i,n,r){let a=3*n,o=e.index.getX(a),s=e.index.getX(a+1),l=e.index.getX(a+2),{position:c,normal:d,uv:u,uv1:h}=e.attributes,p=function(e,t,i,n,r,a,o,s,l){bH.fromBufferAttribute(t,a),xH.fromBufferAttribute(t,o),wH.fromBufferAttribute(t,s);let c=function(e,t,i,n,r,a){let o;return o=1===a?e.intersectTriangle(n,i,t,!0,r):e.intersectTriangle(t,i,n,2!==a,r),null===o?null:{distance:e.origin.distanceTo(r),point:r.clone()}}(e,bH,xH,wH,TH,l);if(c){n&&(SH.fromBufferAttribute(n,a),_H.fromBufferAttribute(n,o),CH.fromBufferAttribute(n,s),c.uv=eE.getInterpolation(TH,bH,xH,wH,SH,_H,CH,new p_)),r&&(SH.fromBufferAttribute(r,a),_H.fromBufferAttribute(r,o),CH.fromBufferAttribute(r,s),c.uv1=eE.getInterpolation(TH,bH,xH,wH,SH,_H,CH,new p_)),i&&(EH.fromBufferAttribute(i,a),AH.fromBufferAttribute(i,o),MH.fromBufferAttribute(i,s),c.normal=eE.getInterpolation(TH,bH,xH,wH,EH,AH,MH,new j_),c.normal.dot(e.direction)>0&&c.normal.multiplyScalar(-1));let t={a:a,b:o,c:s,normal:new j_,materialIndex:0};eE.getNormal(bH,xH,wH,t.normal),c.face=t,c.faceIndex=a}return c}(i,c,d,u,h,o,s,l,t);return p?(p.faceIndex=n,r&&r.push(p),p):null}function DH(e,t,i,n){let r=e.a,a=e.b,o=e.c,s=t,l=t+1,c=t+2;i&&(s=i.getX(t),l=i.getX(t+1),c=i.getX(t+2)),r.x=n.getX(s),r.y=n.getY(s),r.z=n.getZ(s),a.x=n.getX(l),a.y=n.getY(l),a.z=n.getZ(l),o.x=n.getX(c),o.y=n.getY(c),o.z=n.getZ(c)}function OH(e,t,i,n,r,a,o){let s=i.index,l=i.attributes.position;for(let c=e,d=t+e;c<d;c++)if(DH(o,3*c,s,l),o.needsUpdate=!0,n(o,c,r,a))return!0;return!1}var IH=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function kH(e,t){return 65535===t[e+15]}function RH(e,t){return t[e+6]}function zH(e,t){return t[e+14]}function LH(e){return e+8}function BH(e,t){return t[e+6]}var NH=new G_,FH=new j_,UH=["x","y","z"];function VH(e,t,i,n,r){let a=2*e,o=XH,s=YH,l=QH;if(kH(a,s)){!function(e,t,i,n,r,a){for(let o=n,s=n+r;o<s;o++)PH(e,t,i,o,a)}(t,i,n,RH(e,l),zH(a,s),r)}else{let a=LH(e);GH(a,o,n,FH)&&VH(a,t,i,n,r);let s=BH(e,l);GH(s,o,n,FH)&&VH(s,t,i,n,r)}}function jH(e,t,i,n){let r=2*e,a=XH,o=YH,s=QH;if(kH(r,o)){return function(e,t,i,n,r){let a=1/0,o=null;for(let s=n,l=n+r;s<l;s++){let n=PH(e,t,i,s);n&&n.distance<a&&(o=n,a=n.distance)}return o}(t,i,n,RH(e,s),zH(r,o))}{let r,o,l=function(e,t){return t[e+7]}(e,s),c=UH[l],d=n.direction[c]>=0;d?(r=LH(e),o=BH(e,s)):(r=BH(e,s),o=LH(e));let u=GH(r,a,n,FH)?jH(r,t,i,n):null;if(u){let e=u.point[c];if(d?e<=a[o+l]:e>=a[o+l+3])return u}let h=GH(o,a,n,FH)?jH(o,t,i,n):null;return u&&h?u.distance<=h.distance?u:h:u||h||null}}var WH=function(){let e,t,i=[],n=new IH(()=>new G_);return function(){e=n.getPrimitive(),t=n.getPrimitive(),i.push(e,t);let a=r(...arguments);n.releasePrimitive(e),n.releasePrimitive(t),i.pop(),i.pop();let o=i.length;return o>0&&(t=i[o-1],e=i[o-2]),a};function r(i,n,a,o){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;function d(e){let t=2*e,i=YH,n=QH;for(;!kH(t,i);)t=2*(e=LH(e));return RH(e,n)}function u(e){let t=2*e,i=YH,n=QH;for(;!kH(t,i);)t=2*(e=BH(e,n));return RH(e,n)+zH(t,i)}let h=2*i,p=XH,f=YH,m=QH;if(kH(h,f)){let t=RH(i,m),n=zH(h,f);return eH(i,p,e),o(t,n,!1,c,l+i,e)}{let h,g,v,y,b=LH(i),x=BH(i,m),w=b,S=x;if(s&&(v=e,y=t,eH(w,p,v),eH(S,p,y),h=s(v),g=s(y),g<h)){w=x,S=b;let e=h;h=g,g=e,v=y}v||(v=e,eH(w,p,v));let _,C=a(v,kH(2*w,f),h,c+1,l+w);if(2===C){let e=d(w);_=o(e,u(w)-e,!0,c+1,l+w,v)}else _=C&&r(w,n,a,o,s,l,c+1);if(_)return!0;y=t,eH(S,p,y);let E,A=a(y,kH(2*S,f),g,c+1,l+S);if(2===A){let e=d(S);E=o(e,u(S)-e,!0,c+1,l+S,y)}else E=A&&r(S,n,a,o,s,l,c+1);return!!E}}}(),HH=function(){let e=new vH,t=new vH,i=new yC,n=new yH,r=new yH;return function a(o,s,l,c){let d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=2*o,h=XH,p=YH,f=QH;if(null===d&&(l.boundingBox||l.computeBoundingBox(),n.set(l.boundingBox.min,l.boundingBox.max,c),d=n),!kH(u,p)){let e=o+8,t=f[o+6];return eH(e,h,NH),!!(d.intersectsBox(NH)&&a(e,s,l,c,d)||(eH(t,h,NH),d.intersectsBox(NH)&&a(t,s,l,c,d)))}{let n=s,a=n.index,d=n.attributes.position,m=l.index,g=l.attributes.position,v=RH(o,f),y=zH(u,p);if(i.copy(c).invert(),l.boundsTree)return eH(o,h,r),r.matrix.copy(i),r.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:e=>r.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(c),e.b.applyMatrix4(c),e.c.applyMatrix4(c),e.needsUpdate=!0;for(let i=3*v,n=3*(y+v);i<n;i+=3)if(DH(t,i,a,d),t.needsUpdate=!0,e.intersectsTriangle(t))return!0;return!1}});for(let r=3*v,o=y+3*v;r<o;r+=3){DH(e,r,a,d),e.a.applyMatrix4(i),e.b.applyMatrix4(i),e.c.applyMatrix4(i),e.needsUpdate=!0;for(let i=0,n=m.count;i<n;i+=3)if(DH(t,i,m,g),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}}}();function GH(e,t,i,n){return eH(e,t,NH),i.intersectBox(NH,n)}var qH,XH,YH,QH,KH=[];function ZH(e){qH&&KH.push(qH),qH=e,XH=new Float32Array(e),YH=new Uint16Array(e),QH=new Uint32Array(e)}function JH(){qH=null,XH=null,YH=null,QH=null,KH.length&&ZH(KH.pop())}var $H=Symbol("skip tree generation"),eG=new G_,tG=new G_,iG=new yC,nG=new yH,rG=new yH,aG=new j_,oG=new j_,sG=new j_,lG=new j_,cG=new j_,dG=new G_,uG=new IH(()=>new vH),hG=class{static serialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),hG.serialize(arguments[0],{cloneBuffers:void 0===arguments[2]||arguments[2]});t=c({cloneBuffers:!0},t);let i,n=e.geometry,r=e._roots,a=n.getIndex();return i=t.cloneBuffers?{roots:r.map(e=>e.slice()),index:a.array.slice()}:{roots:r,index:a.array},i}static deserialize(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("boolean"==typeof i)return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),hG.deserialize(arguments[0],arguments[1],{setIndex:void 0===arguments[2]||arguments[2]});i=c({setIndex:!0},i);let{index:n,roots:r}=e,a=new hG(t,c(c({},i),{},{[$H]:!0}));if(a._roots=r,i.setIndex){let i=t.getIndex();if(null===i){let i=new oE(e.index,1,!1);t.setIndex(i)}else i.array!==n&&(i.array.set(n),i.needsUpdate=!0)}return a}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[$H]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[$H]||(this._roots=function(e,t){let i,n,r,a=uH(e,t),o=[],s=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let d=0;d<a.length;d++){let e=a[d],t=new s(32*l(e));i=new Float32Array(t),n=new Uint32Array(t),r=new Uint16Array(t),c(0,e),o.push(t)}return o;function l(e){return e.count?1:1+l(e.left)+l(e.right)}function c(e,t){let a=e/4,o=e/2,s=!!t.count,l=t.boundingData;for(let n=0;n<6;n++)i[a+n]=l[n];if(s){let i=t.offset,s=t.count;return n[a+6]=i,r[o+14]=s,r[o+15]=65535,e+32}{let i,r=t.left,o=t.right,s=t.splitAxis;if(i=c(e+32,r),i/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[a+6]=i/4,i=c(i,o),n[a+7]=s,i}}}(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new G_))),this.geometry=e}refit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&Array.isArray(e)&&(e=new Set(e));let t,i,n,r,a=this.geometry,o=a.index.array,s=a.attributes.position,l=0,c=this._roots;for(let u=0,h=c.length;u<h;u++)t=c[u],i=new Uint32Array(t),n=new Uint16Array(t),r=new Float32Array(t),d(0,l),l+=t.byteLength;function d(t,a){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=2*t;if(65535===n[c+15]){let e=i[t+6],a=1/0,l=1/0,d=1/0,u=-1/0,h=-1/0,p=-1/0;for(let t=3*e,i=3*(e+n[c+14]);t<i;t++){let e=o[t],i=s.getX(e),n=s.getY(e),r=s.getZ(e);i<a&&(a=i),i>u&&(u=i),n<l&&(l=n),n>h&&(h=n),r<d&&(d=r),r>p&&(p=r)}return(r[t+0]!==a||r[t+1]!==l||r[t+2]!==d||r[t+3]!==u||r[t+4]!==h||r[t+5]!==p)&&(r[t+0]=a,r[t+1]=l,r[t+2]=d,r[t+3]=u,r[t+4]=h,r[t+5]=p,!0)}{let n=t+8,o=i[t+6],s=n+a,c=o+a,u=l,h=!1,p=!1;e?u||(h=e.has(s),p=e.has(c),u=!h&&!p):(h=!0,p=!0);let f=u||p,m=!1;(u||h)&&(m=d(n,a,u));let g=!1;f&&(g=d(o,a,u));let v=m||g;if(v)for(let e=0;e<3;e++){let i=n+e,a=o+e,s=r[i],l=r[i+3],c=r[a],d=r[a+3];r[t+e]=s<c?s:c,r[t+e+3]=l>d?l:d}return v}}}traverse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this._roots[t],n=new Uint32Array(i),r=new Uint16Array(i);!function t(a){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=2*a,l=65535===r[s+15];if(l){let t=n[a+6],c=r[s+14];e(o,l,new Float32Array(i,4*a,6),t,c)}else{let r=a+8,s=n[a+6],c=n[a+7];e(o,l,new Float32Array(i,4*a,6),c)||(t(r,o+1),t(s,o+1))}}(0)}raycast(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this._roots,n=this.geometry,r=[],a=t.isMaterial,o=Array.isArray(t),s=n.groups,l=a?t.side:t;for(let c=0,d=i.length;c<d;c++){let a=o?t[s[c].materialIndex].side:l,d=r.length;if(ZH(i[c]),VH(0,n,a,e,r),JH(),o){let e=s[c].materialIndex;for(let t=d,i=r.length;t<i;t++)r[t].face.materialIndex=e}}return r}raycastFirst(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this._roots,n=this.geometry,r=t.isMaterial,a=Array.isArray(t),o=null,s=n.groups,l=r?t.side:t;for(let c=0,d=i.length;c<d;c++){let r=a?t[s[c].materialIndex].side:l;ZH(i[c]);let d=jH(0,n,r,e);JH(),null!=d&&(null==o||d.distance<o.distance)&&(o=d,a&&(d.face.materialIndex=s[c].materialIndex))}return o}intersectsGeometry(e,t){let i=this.geometry,n=!1;for(let r of this._roots)if(ZH(r),n=HH(0,i,e,t),JH(),n)break;return n}shapecast(e,t,i){let n=this.geometry;if(e instanceof Function){if(t){let e=t;t=(t,i,n,r)=>{let a=3*i;return e(t,a,a+1,a+2,n,r)}}e={boundsTraverseOrder:i,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let r=uG.getPrimitive(),{boundsTraverseOrder:a,intersectsBounds:o,intersectsRange:s,intersectsTriangle:l}=e;if(s&&l){let e=s;s=(t,i,a,o,s)=>!!e(t,i,a,o,s)||OH(t,i,n,l,a,o,r)}else s||(s=l?(e,t,i,a)=>OH(e,t,n,l,i,a,r):(e,t,i)=>i);let c=!1,d=0;for(let u of this._roots){if(ZH(u),c=WH(0,n,o,s,a,d),JH(),c)break;d+=u.byteLength}return uG.releasePrimitive(r),c}bvhcast(e,t,i){let{intersectsRanges:n,intersectsTriangles:r}=i,a=this.geometry.index,o=this.geometry.attributes.position,s=e.geometry.index,l=e.geometry.attributes.position;iG.copy(t).invert();let c=uG.getPrimitive(),d=uG.getPrimitive();if(r){let e=function(e,i,n,u,h,p,f,m){for(let g=n,v=n+u;g<v;g++){DH(d,3*g,s,l),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let t=e,n=e+i;t<n;t++)if(DH(c,3*t,a,o),c.needsUpdate=!0,r(c,d,t,g,h,p,f,m))return!0}return!1};if(n){let t=n;n=function(i,n,r,a,o,s,l,c){return!!t(i,n,r,a,o,s,l,c)||e(i,n,r,a,o,s,l,c)}}else n=e}e.getBoundingBox(tG),tG.applyMatrix4(t);let u=this.shapecast({intersectsBounds:e=>tG.intersectsBox(e),intersectsRange:(t,i,r,a,o,s)=>(eG.copy(s),eG.applyMatrix4(iG),e.shapecast({intersectsBounds:e=>eG.intersectsBox(e),intersectsRange:(e,r,s,l,c)=>n(t,i,e,r,a,o,l,c)}))});return uG.releasePrimitive(c),uG.releasePrimitive(d),u}intersectsBox(e,t){return nG.set(e.min,e.max,t),nG.needsUpdate=!0,this.shapecast({intersectsBounds:e=>nG.intersectsBox(e),intersectsTriangle:e=>nG.intersectsTriangle(e)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0;e.boundingBox||e.computeBoundingBox(),nG.set(e.boundingBox.min,e.boundingBox.max,t),nG.needsUpdate=!0;let o=this.geometry,s=o.attributes.position,l=o.index,c=e.attributes.position,d=e.index,u=uG.getPrimitive(),h=uG.getPrimitive(),p=oG,f=sG,m=null,g=null;n&&(m=lG,g=cG);let v=1/0,y=null,b=null;return iG.copy(t).invert(),rG.matrix.copy(iG),this.shapecast({boundsTraverseOrder:e=>nG.distanceToBox(e),intersectsBounds:(e,t,i)=>i<v&&i<a&&(t&&(rG.min.copy(e.min),rG.max.copy(e.max),rG.needsUpdate=!0),!0),intersectsRange:(i,n)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:e=>rG.distanceToBox(e),intersectsBounds:(e,t,i)=>i<v&&i<a,intersectsRange:(e,a)=>{for(let o=3*e,x=3*(e+a);o<x;o+=3){DH(h,o,d,c),h.a.applyMatrix4(t),h.b.applyMatrix4(t),h.c.applyMatrix4(t),h.needsUpdate=!0;for(let e=3*i,t=3*(i+n);e<t;e+=3){DH(u,e,l,s),u.needsUpdate=!0;let t=u.distanceToTriangle(h,p,m);if(t<v&&(f.copy(p),g&&g.copy(m),v=t,y=e/3,b=o/3),t<r)return!0}}}});for(let e=0,a=d?d.count:c.count;e<a;e+=3){DH(h,e,d,c),h.a.applyMatrix4(t),h.b.applyMatrix4(t),h.c.applyMatrix4(t),h.needsUpdate=!0;for(let t=3*i,a=3*(i+n);t<a;t+=3){DH(u,t,l,s),u.needsUpdate=!0;let i=u.distanceToTriangle(h,p,m);if(i<v&&(f.copy(p),g&&g.copy(m),v=i,y=t/3,b=e/3),i<r)return!0}}}}),uG.releasePrimitive(u),uG.releasePrimitive(h),v===1/0?null:(i.point?i.point.copy(f):i.point=f.clone(),i.distance=v,i.faceIndex=y,n&&(n.point?n.point.copy(g):n.point=g.clone(),n.point.applyMatrix4(iG),f.applyMatrix4(iG),n.distance=f.sub(n.point).length(),n.faceIndex=b),i)}closestPointToPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,r=i*i,a=n*n,o=1/0,s=null;if(this.shapecast({boundsTraverseOrder:t=>(aG.copy(e).clamp(t.min,t.max),aG.distanceToSquared(e)),intersectsBounds:(e,t,i)=>i<o&&i<a,intersectsTriangle:(t,i)=>{t.closestPointToPoint(e,aG);let n=e.distanceToSquared(aG);return n<o&&(oG.copy(aG),o=n,s=i),n<r}}),o===1/0)return null;let l=Math.sqrt(o);return t.point?t.point.copy(oG):t.point=oG.clone(),t.distance=l,t.faceIndex=s,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{eH(0,new Float32Array(t),dG),e.union(dG)}),e}},pG=Ow(kw()),fG=.5*(Math.sqrt(3)-1),mG=(3-Math.sqrt(3))/6,gG=1/3,vG=1/6,yG=(Math.sqrt(5),Math.sqrt(5),e=>0|Math.floor(e)),bG=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),xG=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function wG(e){let t=new Uint8Array(512);for(let i=0;i<256;i++)t[i]=i;for(let i=0;i<255;i++){let n=i+~~(e()*(256-i)),r=t[i];t[i]=t[n],t[n]=r}for(let i=256;i<512;i++)t[i]=t[i-256];return t}var SG,_G=new eE,CG=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||3!==t.attributes.position.itemSize)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let n=0;n<e.count;n+=3){let i=1;_G.a.fromBufferAttribute(e,n),_G.b.fromBufferAttribute(e,n+1),_G.c.fromBufferAttribute(e,n+2),i*=_G.getArea(),t[n/3]=i}this.distribution=new Float32Array(e.count/3);let i=0;for(let n=0;n<t.length;n++)i+=t[n],this.distribution[n]=i;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let i=this.distribution[this.distribution.length-1],n=this.binarySearch(this.randomFunction()*i);return this.sampleFace(n,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,i=0,n=t.length-1,r=-1;for(;i<=n;){let a=Math.ceil((i+n)/2);if(0===a||t[a-1]<=e&&t[a]>e){r=a;break}e<t[a]?n=a-1:i=a+1}return r}sampleFace(e,t,i){let n=this.randomFunction(),r=this.randomFunction();return n+r>1&&(n=1-n,r=1-r),_G.a.fromBufferAttribute(this.positionAttribute,3*e),_G.b.fromBufferAttribute(this.positionAttribute,3*e+1),_G.c.fromBufferAttribute(this.positionAttribute,3*e+2),t.set(0,0,0).addScaledVector(_G.a,n).addScaledVector(_G.b,r).addScaledVector(_G.c,1-(n+r)),_G.getNormal(i),this}},EG=Ow(Rw()),AG=new yC,MG=new yC,TG=new yC;(e=>{e.is=function(e){return e&&e.__isSPEObject}})(SG||(SG={}));var PG,DG=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new yC,this.copyPreviousMatrix=!0,this.hiddenMatrix=new yC,this.matrixWorldRigid=new yC,this.shearScale=new yC,this.shearScaleInv=new yC}get __isSPEObject(){return!0}isDescendantOf(e){e instanceof WC&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(let t of this.children)t.updateMatrixWorld(e)}updateWorldMatrix(e,t){let i=this.parent;if(e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),t)for(let n of this.children)n.updateWorldMatrix(!1,!0)}traverseChildren(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let i of this.children)SG.is(i)&&i.traverseObject(e,t+1)}traverseObject(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t))for(let i of this.children)SG.is(i)&&i.traverseObject(e,t+1)}updateMatrixWorldSVD(){let e=this.matrixWorld.elements,t=[[e[0],e[4],e[8]],[e[1],e[5],e[9]],[e[2],e[6],e[10]]],{u:i,v:n,q:r}=(0,EG.SVD)(t),a=AG.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),o=MG.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),s=TG.copy(o).transpose();this.shearScale.makeScale(r[0],r[1],r[2]).multiply(s).premultiply(o),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(a,s).copyPosition(this.matrixWorld),r.every(e=>Math.abs(r[0]-e)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(e,t){this.updateWorldMatrix(!0,!1);let i=(new yC).copy(this.matrixWorld).invert();return null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),i.multiply(e.parent.matrixWorld)),"hiddenMatrix"in e&&e.hiddenMatrix instanceof yC?e.hiddenMatrix.premultiply(i):e.applyMatrix4(i),e.updateWorldMatrix(!1,!1),this.add(e),void 0!==t&&(this.children.pop(),this.children.splice(t,0,e)),this}copy(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return super.copy(e,t),this.hasNonUniformScale=e.hasNonUniformScale,this}onAfterRender(e,t,i,n,r,a){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},OG=class extends(DG(WC)){},IG=class extends OG{constructor(e){super(),this.object=e,this.matrixAutoUpdate=!1,this.hasNonUniformScale=e.hasNonUniformScale}raycast(e,t){}expand(){let e=0,t=this.object.entityChildren(e);for(;t;){var i;let n=this.children[e];(null===(i=n)||void 0===i?void 0:i.object)!==t&&(n&&this.remove(n),n=new IG(t),this.add(n),this.children.splice(e,0,this.children.pop()),n.matrixWorldNeedsUpdate=!0,n.matrixAutoUpdate=!1,n.matrix=t.matrix,n.hiddenMatrix=t.hiddenMatrix),n.expand(),e+=1,t=this.object.entityChildren(e)}for(;this.children.length>e;)this.remove(this.children[e])}get visible(){var e;return void 0!==this.playModeVisible?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&!0===(null===(e=this.object.dataPatched.cloner)||void 0===e?void 0:e.hideBase)}set visible(e){}get castShadow(){return this.object.castShadow}set castShadow(e){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(e){}get isMesh(){return"Mesh"===this.object.type}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(e){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},kG=new j_,RG=new j_,zG=new yC,LG=[new j_(-1,1,1),new j_(-1,-1,1),new j_(1,-1,1),new j_(1,1,1),new j_(-1,1,-1),new j_(-1,-1,-1),new j_(1,-1,-1),new j_(1,1,-1)],BG=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],NG=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],FG=(e,t,i)=>{e.updateEntityBoxSize(kG,RG),zG.copy(t).multiply(e.matrixWorld),0===RG.x&&0===RG.y&&0===RG.z?i.push(new j_(kG.x,kG.y,kG.z).applyMatrix4(zG)):LG.forEach(e=>{i.push(e.clone().multiply(RG).add(kG).applyMatrix4(zG))})},UG=class extends G_{constructor(){super(...arguments),this.matrix=new yC,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map(e=>e.clone()),this.faces=e.faces.map(e=>e.clone()),this.edges=e.edges.map(e=>e.clone()),this.centerEdges=e.centerEdges.map(e=>e.clone()),this}setFromObjectSize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let i=(new yC).copy(e.matrixWorld).invert();return this.expandByObjectSize(e,i,t)}expandByObjectSize(e,t){let i=[];return!0===(arguments.length>2&&void 0!==arguments[2]&&arguments[2])?e.traverseEntity(e=>{if(e.visible||e.cloner&&e.data.visible){if(!("geometry"in e))return void i.push(new j_);FG(e,t,i)}}):FG(e,t,i),this.setFromPoints(i)}getCenter(e){return(e=super.getCenter(e)).applyMatrix4(this.matrix),e}getPositionToCenter(e){return(e=super.getCenter(e)).applyMatrix4(zG.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(RG).multiplyScalar(.5),this.getCenter(kG),zG.copy(this.matrix).setPosition(kG),this.vertices=LG.map(e=>e.clone().multiply(RG).applyMatrix4(zG))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=BG.map(e=>{let[t,i]=e;return new MO(this.vertices[t],this.vertices[i])}),this.centerEdges=this.edges.map(e=>e.getCenter(new j_))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=NG.map(e=>{let[t,i]=e;return this.vertices[t].clone().add(this.vertices[i]).multiplyScalar(.5)})}},VG={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},jG=class extends SP{constructor(){super()}getPoints(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,i=[],n=this.getCurveLengths(),r=n[n.length-1]/n.length;for(let a=0,o=this.curves;a<o.length;a++){let s=o[a],l=0===a?n[a]:n[a]-n[a-1],c=Math.ceil(t*l/r),d=s.getPoints(c);for(let t=0;t<d.length;t++){let n=d[t];e&&e.equals(n)||(i.push(n),e=n)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}},WG=.001;function HG(e,t,i){return t.clone().sub(e).cross(t.clone().sub(i)).length()<=WG}function GG(e,t){let i=new j_(...e.position),n=new j_(...e.controlNext.position),r=new j_(...t.controlPrevious.position),a=new j_(...t.position);return HG(i,n,a)&&HG(i,r,a)}function qG(e){let t=e.points.map(e=>new j_(...e.data.position)),i=[e.points[0]],n=new j_(...i[0].data.position);for(let c=0;c<e.points.length-1;c++)HG(n,t[c],t[c+1])||(i.push(e.points[c]),n=t[c]);i.push(e.points[e.points.length-1]);let r=e.isClosed,a=i.length-(r?0:1),o=i.length,s=[];for(let u=0;u<o;u++){let t=i[u].data,n=new j_(...t.position),a=new j_(...t.controlPrevious.position),l=new j_(...t.controlNext.position),d={position:n,baseRoundness:t.roundness,controlPrevious:a,controlNext:l};if(0===t.roundness||!e.isClosed&&(0===u||u===o-1)){s[u]=c(c({},d),{},{removedLength:0});continue}let h=r&&u==o-1?0:u+1,p=i[r&&0==u?o-1:u-1].data,f=i[h].data,m=new j_(...p.position),g=new j_(...f.position),v=m.clone().sub(n).normalize(),y=g.clone().sub(n).normalize();Object.assign(d,{prevDir:v,nextDir:y});let b=GG(p,t),x=GG(t,f);if(b&&x){let e=v.clone().add(y).normalize(),i=e.clone().cross(v).length()/v.dot(e);s[u]=c(c({},d),{},{tan:i,removedLength:t.roundness/i})}else s[u]=c(c({},d),{},{removedLength:0})}for(let c=0;c<a;c++){let e=r&&c===o-1?0:c+1,t=s[c],i=s[e];if(0!==t.removedLength||0!==i.removedLength){let e=t.position.distanceTo(i.position);t.removedLength=Math.min(t.removedLength,e/2),i.removedLength=Math.min(i.removedLength,e/2)}}let l=[];for(let c=0;c<a;c++){let e=c,t=r&&c===o-1?0:c+1,n=s[e],a=s[t],d=null;if(GG(i[e].data,i[t].data)){let e=n.position.clone(),t=a.position.clone();(0!==n.removedLength||0!==a.removedLength)&&(n.nextDir&&e.add(n.nextDir.clone().setLength(n.removedLength)),a.prevDir&&t.add(a.prevDir.clone().setLength(a.removedLength))),e.distanceTo(t)>WG&&(d=new gP(e,e.clone().lerp(t,.3),t.clone().lerp(e,.3),t))}else n.position.distanceTo(a.position)>WG&&(d=new gP(n.position,n.controlNext,a.controlPrevious,a.position));l[2*c+1]=d}for(let c=0;c<o;c++){let e=s[c];if(0===e.removedLength){l[2*c]=null;continue}let t=e.position,i=e.prevDir.clone().multiplyScalar(e.removedLength).add(t),n=e.nextDir.clone().multiplyScalar(e.removedLength).add(t),r=e.tan*e.removedLength,a=e.prevDir.clone().add(e.nextDir).normalize(),o=i.clone().lerp(n,.5),d=i.distanceTo(n)/2,u=a.clone().multiplyScalar(Math.sqrt(Math.pow(r,2)-Math.pow(d,2))).add(o),h=a.clone().multiplyScalar(-r).add(u),p=t.distanceTo(h)/t.distanceTo(o),f=e.prevDir.clone().multiplyScalar(p*t.distanceTo(i)).add(t),m=f.clone().lerp(h,2),g=i.clone().lerp(f,4/3),v=n.clone().lerp(m,4/3);l[2*c]=new gP(i,g,v,n)}let d=new jG;return l.forEach(e=>{e&&d.add(e)}),d}(e=>{e.is=function(e){return e&&e.__isEntity}})(PG||(PG={}));var XG=e=>PG.is(e),YG={type:"completeState",isfromEntity:!0},QG=["x","y","z"],KG=new j_,ZG=(new j_).set(0,1,0),JG=e=>class extends(DG(e)){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new UG,this._recursiveBBox=new UG,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(e){let t=this.children[e];if(PG.is(t))return t}entityChildrenCount(){let e=this.children.length;for(;e--;)if(PG.is(this.children[e]))return e+1;return 0}get isConcreteEntity(){return"string"==typeof this.identity}get isVirtualEntity(){return"string"!=typeof this.identity}get isInstanceRoot(){return this.isConcreteEntity&&"Instance"===this.data.type}nearestInstanceSelfOrParent(){let e=this;for(;"Instance"!==e.data.type;){let t=e.parent;if(!PG.is(t))return;e=t}return e}forInstancesRec(e){this.instances.forEach(t=>{t.disposed||e(t),t.forInstancesRec(e)})}super_Entity(e,t){"string"==typeof e&&(this.uuid=e),this.identity=e,this.data=t,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==this.data.states.length||i){for(let e of this.data.states)Wj.toOps(this.data,e.data).forEach(e=>{let i=HN.replaceProps(e,this.data);this.dataPatched=this.data,this.updateByPatchedOp(i,this.data,t)});if(null!==e){let i=this.data.states.data(e);i&&(this.dataPatched=Wj.patch(this.data,i),Wj.toOps(this.data,i).forEach(e=>{this.updateByPatchedOp(e,this.dataPatched,t)}))}i&&this.updateTransformState(this.dataPatched,t),this.stateSelection=e,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(e,t){e.setScalar(0),t.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{XG(e)&&e.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(e=>{e.resetBBoxNeedsUpdateSelf()})}find(e){let t;return this.traverseEntity(i=>{i.uuid===e&&(t=i)}),t}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children,i=t.indexOf(this)+1;if(PG.is(t[i]))return t[i];if(PG.is(e))return e.traverseSortNextHelper()}}sortNext(){let e=this.children;return this.children.length>0&&PG.is(this.children[0])?e[0]:this.traverseSortNextHelper()}goUp(e){let t=this;for(;e>0&&null!==t;)t=t.parent,e-=1;return t}hasAnccestorOrSelf(e){return this===e||this.hasAnccestor(e)}hasAnccestor(e){let t=this.parent;for(;t;){if(e===t)return!0;t=t.parent}return!1}countToAccestor(e){let t=0,i=this;for(;i!==e;){if(null===i)return-1;i=i.parent,t+=1}return t}forEachEntity(e){for(let t of this.children)XG(t)&&e(t)}traverseEntityAncestors(e){this.traverseAncestors(t=>{PG.is(t)&&e(t)})}traverseConcreteEntity(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t))for(let i of this.children)XG(i)&&i.isConcreteEntity&&i.traverseEntity(e,t+1)}traverseEntity(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t))for(let i of this.children)XG(i)&&i.traverseEntity(e,t+1)}traverseVisibleEntity(e){e(this);for(let t of this.children)XG(t)&&t.visible&&t.traverseVisibleEntity(e)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(e){super.updateMatrixWorld(e),this.dispatchEvent({type:"updateMatrixWorld"})}copy(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return super.copy(e,t),this.dataPatched=e.dataPatched,this.raycastLock=e.raycastLock,this.scaleLock=e.scaleLock,this.hiddenMatrix.copy(e.hiddenMatrix),this}hasEntityChild(){return this.children.some(e=>XG(e))}isAncestorOf(e){if(this.uuid===e)return!1;let t=!1;return this.traverseEntity(i=>{i.uuid===e&&(t=!0)}),t}toObjectTransformState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.updateWorldMatrix(!0,!1);let t={position:this.position.toArray(),rotation:[this.rotation.x*h_.RAD2DEG,this.rotation.y*h_.RAD2DEG,this.rotation.z*h_.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return GB(t,e)}getTransformValues(e,t,i){return t[e].map((t,n)=>{var r;return null!==(r=null===i||void 0===i?void 0:i.shared.getVariable(t,[this.uuid,e,QG[n]]))&&void 0!==r?r:t})}updateTransformState(e,t){var i;let n=!1;return e.position&&(this.position.fromArray(this.getTransformValues("position",e,t)),n=!0),e.rotation&&(KG.fromArray(this.getTransformValues("rotation",e,t)).multiplyScalar(h_.DEG2RAD),this.rotation.setFromVector3(KG),n=!0),e.scale&&(this.scale.fromArray(this.getTransformValues("scale",e,t)),n=!0),void 0!==e.hiddenMatrix&&(n=!0,this.hiddenMatrix.fromArray(null!==(i=e.hiddenMatrix)&&void 0!==i?i:CV.identity)),n&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(e=>{e.invalidateClonerTransform(this)})),e.position&&e.rotation&&e.scale&&void 0!==e.hiddenMatrix&&this.updateWorldMatrix(!1,!0),n}onVariableUpdate(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.resetBBoxNeedsUpdate():(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(e=>{e.invalidateClonerTransform(this)}))}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let e of this.children)PG.is(e)&&e.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(e=>{PG.is(e)&&e.disposeRecursively()})}toState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=c({name:this.name,visible:this.visible,raycastLock:this.raycastLock},this.toObjectTransformState(e));return GB(t,e)}updateByObjUpdateOp(e,t){void 0!==e&&this.updateByOp({type:0,props:e,path:[]},c(c({},this.data),e),t,!1)}updateByOp(e,t,i,n){let a=this.data;this.data=t;let o=e,s=xF(e.path,["states","*"]);if(null!==s){if(0===e.type){let[t]=s;if((null===this||void 0===this?void 0:this.stateSelection)===t){let t=c({},e.props);if(delete t.name,Object.values(e.props).some(e=>void 0===e)){let i=this.data;if(void 0!==i){let n=fF.zoom(i,e.path.slice(2));if(n)for(let i in e.props)void 0===e.props[i]&&i in n&&(t[i]=n[i])}}o=c(c({},e),{},{props:t,path:e.path.slice(2)})}}}else if(0===e.type){let t=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(void 0!==t){if(void 0!==e.props.name&&t.name){let{name:e}=t;t=r(t,bw)}if(void 0!==e.props.material&&"material"in t){let{material:e}=t;t=r(t,xw)}let i=fF.removeOverridden(e.path,e.props,t);o=c(c({},e),{},{props:i})}}if(this.updateByPatchedOpBase(o,Wj.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i),xF(e.path,["overrides"])){let n=[],r=[...e.path];for(n.push(r[1]),r.splice(0,2);r.length>0&&"descendants"===r[0];)n.push(r[1]),r.splice(0,2);if(void 0===n[n.length-1]){if(0===e.type)for(let t of Object.keys(e.props)){n[n.length-1]=t;let r=i.scene.findInstance([this.uuid,...n]);r&&(r.overrideData=e.props[t],r.updateState(jN.apply(r.component.data,r.overrideData),i))}}else{let a=i.scene.findInstance([this.uuid,...n]);if(a){let o=fF.zoom(a.component.data,r);if(0===(e=c(c({},e),{},{path:r})).type){let t=e.props;if(o)for(let[i,n]of Object.entries(e.props))void 0===n&&(t===e.props&&(t=c({},e.props)),t[i]=o[i]);e=c(c({},e),{},{props:t})}a.overrideData=Fj.resolve(t.overrides,n),a.updateByOp(e,GN.applySimple(a.data,e),i,!1)}}}else if(this.instances.length>0){let n;if(0===e.path.length&&0===e.type){let t;for(let i of Uj.rootOverrideProps)i in e.props&&(void 0===t&&(t={}),t[i]=e.props[i]);t&&(n=c(c({},e),{},{props:t}))}else for(let t of Uj.rootOverrideProps)if(xF(e.path,[t])){n=e;break}void 0!==n&&this.instances.forEach(e=>{if(e.isInstanceRoot){let t=jN.filterOp(e.overrideData,n);t&&e.updateByOp(t,GN.applySimple(e.data,t),i,!0)}}),this.instances.forEach(n=>{if(!n.isInstanceRoot){let r=jN.filterOp(n.overrideData,e);if(r){let o;o=a===n.data&&e===r?t:GN.applySimple(n.data,r),n.updateByOp(r,o,i,!0)}}})}}updateByPatchedOpBase(e,t,i){if(this.dataPatched=t,0===e.path.length&&0===e.type)void 0!==e.props.type&&!NV.is(e.props.type)&&VG.changeEntityProptotype(this,t,i);else if(1===e.path.length&&"geometry"===e.path[0]&&0===e.type&&"type"in e.props){VG.changeEntityProptotype(this,t,i);for(let e of this.children)PG.is(e)&&e.updateVisible(i.scene)}this.updateByPatchedOp(e,t,i)}updateByPatchedOp(e,t,i){if(0===e.path.length&&0===e.type?this.updateState(e.props,i):0===e.type&&("resolutionLevel"in e.props||"useChildrenColors"in e.props)&&this.updateState(t,i),"morphTargetInfluences"===e.path[0]&&0===e.type){var n;let r=null===(n=t.morphTargetInfluences.get(e.path[1]))||void 0===n?void 0:n.data.name;r&&this.updateMorphInfluences(r,i.shared.getVariable(e.props.value,[this.uuid,"morphTargetInfluences",r]))}if(null!==xF(e.path,["pathSnapping"])&&this.updatePathSnapping(t.pathSnapping),null!==xF(e.path,["cloner"])){let n=GN.drop(e,1);0===n.path.length&&0===n.type&&!0===n.props.disabled?this.setFromClonerState(null,i):this.cloner?this.cloner.updateState(t.cloner,i.scene):(this.setFromClonerState(t.cloner,i),this.expandCloner(i.scene)),this.updateVisible(i.scene)}}updatePathSnapping(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dataPatched.pathSnapping;this._updatedPathSnapping=e,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(e){var t,i,n,r,a,o,s,l,d,u,h;let p=null!==(t=null===(i=this._updatedPathSnapping)||void 0===i?void 0:i.pathId)&&void 0!==t?t:this.dataPatched.pathSnapping.pathId,f=null!==(n=null!==(r=null===(a=this._updatedPathSnapping)||void 0===a?void 0:a.slide)&&void 0!==r?r:this.dataPatched.pathSnapping.slide)&&void 0!==n?n:0,m=null!==(o=null!==(s=null===(l=this._updatedPathSnapping)||void 0===l?void 0:l.offset)&&void 0!==s?s:this.dataPatched.pathSnapping.offset)&&void 0!==o?o:0,g=null!==(d=null===(u=this._updatedPathSnapping)||void 0===u?void 0:u.orientation)&&void 0!==d?d:this.dataPatched.pathSnapping.orientation;if(null===p)return;let v=e.find(p);if(!v||!1===this._needApplyPathSnapping)return;this._needApplyPathSnapping=!1;let y=v.data;if(y.geometry.path.points.length<=1)return;let b=qG(y.geometry.path),x=(f+m)%1;f+m===1&&0===x&&(x=1);let w=null;try{w=b.curves.length?b.getPointAt(x):null}catch(E){}if(null===w)return;let S=this.parent?null===(h=this.parent)||void 0===h?void 0:h.matrixWorld:new yC;v.updateMatrixWorld();let _=(new yC).multiplyMatrices(S.clone().invert(),v.matrixWorld);w.applyMatrix4(_);let C={position:w.toArray(),rotation:y.rotation};if("tangential"===g){let e=(new yC).extractRotation(v.matrixWorld),t=b.getTangentAt(x).applyMatrix4(e).add(w),i=(new yC).lookAt(w,t,ZG),n=KG.setFromEuler((new TC).setFromRotationMatrix(i)).multiplyScalar(h_.RAD2DEG);C=c(c({},C),{},{rotation:n.toArray()})}this.updateTransformState(C),this.traverseEntity(e=>{e._cameraType&&e.dispatchEvent(YG)})}updateVisible(e){var t,i;if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||null!==(t=this.dataPatched.cloner.disabled)&&void 0!==t&&t||!0!==(null===(i=this.dataPatched.cloner)||void 0===i?void 0:i.hideBase)),!e)return;let n=!1;this.traverseEntity(e=>{if("Splat"===e.data.type)return n=!0,!0}),n&&e.reloadSplats()}updateState_Entity(e,t){void 0!==e.name&&(this.name=e.name),void 0!==e.raycastLock&&(this.raycastLock=e.raycastLock),void 0!==e.visible&&(this.updateVisible(null===t||void 0===t?void 0:t.scene),this.resetBBoxNeedsUpdate()),t&&"cloner"in e&&void 0!==e.cloner&&(this.setFromClonerState(e.cloner,t),this.updateVisible(t.scene)),this.updateTransformState(e,t)}get attachedSurfaceCloners(){return this.children.filter(e=>e instanceof VG.Cloner&&"toObject"===e.parameters.type)}setFromClonerState(e,t){this.disposed||(null===e||e.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):void 0===this.cloner?(this.cloner=new VG.Cloner(this,e),t.scene.addPendingExpandCloner(this)):this.cloner.updateState(e,t.scene))}expandCloner(e){!this.disposed&&this.cloner&&this.cloner.expandClones(e)}invalidateClonerTransform(e){this.cloner&&this.cloner.invalidateTransform(e)}requestRender(){this.dispatchEvent({type:"requestRender"})}},$G=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r,a,o,s,l;let c=null===(i=e.parameters)||void 0===i?void 0:i.radiusTop,d=null===(n=e.parameters)||void 0===n?void 0:n.radiusBottom,u=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters);u.thetaLength=h_.clamp(u.thetaLength,0,360);let h=u.width/2,p=null!==(a=u.radiusTop)&&void 0!==a?a:h,f=null!==(o=u.radiusBottom)&&void 0!==o?o:h;if(p===f?(p=h,f=h):p>f?(p=h,f=f*h/p):(p=p*h/f,f=h),u.shapeBlendNode){p=null!==c&&void 0!==c?c:h,f=null!==d&&void 0!==d?d:h;let e=2*Math.max(p,f);u.width=e,u.depth=e}return{parameters:Object.assign(u,{width:Math.abs(u.width),height:Math.abs(null!==(s=u.height)&&void 0!==s?s:u.width),depth:Math.abs(null!==(l=u.depth)&&void 0!==l?l:u.width),radiusTop:p,radiusBottom:f})}}static build(e){let t,{width:i,depth:n,height:r,radialSegments:a,heightSegments:o,openEnded:s,thetaStart:l,thetaLength:d,radiusTop:u,radiusBottom:h,cornerRadius:p,cornerSegments:f,hollow:m}=e.parameters;return 0===d?(t=new vE,t.setAttribute("position",new cE([],3))):t=p||m?new iq(u,h,r,a,o,s,l,d*Math.PI/180,p,p,f,m):new EP(u,h,r,a,o,s,l,d*Math.PI/180),t.scale(1,1,n/i),Object.assign(t,{userData:c(c({},e),{},{type:"CylinderGeometry"})})}};function eq(e,t,i){i.x=e.x*t.x,i.y=e.y,i.z=e.x*t.y}function tq(e){return new p_(e.y,-e.x)}var iq=class extends vE{constructor(e,t,i,n,r,a,o,s,l,c,d,u){let h=arguments.length>12&&void 0!==arguments[12]&&arguments[12];super(),this.type="RoundedCylinderBufferGeometry",e=void 0!==e?e:1,t=void 0!==t?t:1,i=i||1,n=Math.floor(n)||8,r=Math.floor(r)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI,a&&(l=0,c=0);let p=[],f=[],m=[],g=[],v=0,y=i/2,b=new j_,x=new j_;h&&0==e&&(e=l),h&&0==t&&(t=c);let w=new p_(e,y),S=new p_(t,-y),_=null,C=null,E=null,A=null,M=w.clone().sub(S),T=0,P=0,D=0;u>0&&(T=Math.min(e,t)*(1-u),P=e-T,D=t-T);let O=w.clone();O.x-=T;let I=Math.PI-M.angle(),k=M.angle(),R=Math.tan(k/2),z=Math.tan(I/2),L=R+z,B=u?L:z,N=u?L:R;if(l=Math.min(l,(e-P)/B,M.length()/L),c=Math.min(c,(t-D)/N,M.length()/L),l>0){let e=l/R;_=w.clone().sub(new p_(e,l)),u&&(E=_.clone(),E.x-=T-L*l),w.sub(M.clone().setLength(e))}if(c>0){let e=c/z;C=S.clone().sub(new p_(e,-c)),S.add(M.clone().setLength(e)),u&&(A=C.clone(),A.x-=T-L*c,O.sub(M.clone().setLength(e)))}M=w.clone().sub(S);let F=M.length()<.5,U=[];for(let H=0;H<=n;H++){let d=[],h=H/n,p=h*s+o,y=new p_(Math.sin(p),Math.cos(p));if(A&&C?(V(d,h,y,I,c,A,-1,!0),V(d,h,y,k,c,C,-1,!1)):C?(j(d,y,C.x,0,-1),V(d,h,y,k,c,C,-1,!1)):a||j(d,y,t,D,-1),eq(tq(M).normalize(),y,b),!F)for(let e=0;e<=r;e++){let t=e/r;eq(M.clone().multiplyScalar(t).add(S),y,x),f.push(x.x,x.y,x.z),m.push(b.x,b.y,b.z),g.push(h,.5+x.y/i),d.push(v++)}if(E&&_?(V(d,h,y,I,l,_,1,!1),V(d,h,y,k,l,E,1,!0)):_?(V(d,h,y,I,l,_,1,!1),j(d,y,_.x,0,1)):a||j(d,y,e,P,1),u&&!F){eq(tq(M).multiplyScalar(-1).normalize(),y,b);for(let e=0;e<=r;e++){let t=e/r;eq(M.clone().multiplyScalar(-t).add(O),y,x),f.push(x.x,x.y,x.z),m.push(b.x,b.y,b.z),g.push(h,.5+x.y/i),d.push(v++)}}u&&!a&&d.push(d[0]),U.push(d)}for(let H=0;H<U.length-1;H++)for(let e=0;e<U[0].length-1;e++){if(a&&u&&e==r)continue;let t=U[H][e],i=U[H+1][e],n=U[H+1][e+1],o=U[H][e+1],s=f[3*n+0],l=f[3*n+2];p.push(t,i,o),(0!=s||0!=l)&&p.push(i,n,o)}function V(e,t,n,r,a,o,s,l){for(let c=0;c<d+1;c++){let u=c/d,h=s<0?u:1-u;l&&(h-=1),h*=r;let p=new p_(Math.sin(h),Math.cos(h)*s);eq(p.clone().multiplyScalar(a).add(o),n,x),f.push(x.x,x.y,x.z),eq(p,n,b),m.push(b.x,b.y,b.z),g.push(t,.5+x.y/i),e.push(v++)}}function j(e,t,i,n,r){let a=new j_,o=new p_,s=[i,n];r<0&&s.reverse();for(let l of s)o.set(l,y*r),eq(o,t,a),f.push(a.x,a.y,a.z),m.push(0,r,0),g.push(.5,.5),e.push(v++)}function W(i,n,r){let a=new p_(Math.sin(r),Math.cos(r)),o=new p_(-Math.cos(r),Math.sin(r)),s=new j_,l=i<0?(e,t,i)=>p.push(e,t,i):(e,t,i)=>p.push(e,i,t);eq(new p_((e+t+P+D)/4,0),a,s),f.push(s.x,s.y,s.z),m.push(o.x,0,o.y),g.push(.5,.5);let c=v++;for(let e of n){let t=f.slice(3*e,3*e+3);f.push(...t),m.push(o.x,0,o.y);let i=g.slice(2*e,2*e+2);g.push(...i),v++}for(let e=c+1;e<v-1;e++)l(c,e,e+1);l(c,v-1,c+1)}s<2*Math.PI&&(W(-1,U[0],o),W(1,U[U.length-1],o+s)),this.setIndex(p),this.setAttribute("position",new cE(f,3)),this.setAttribute("normal",new cE(m,3)),this.setAttribute("uv",new cE(g,2))}},nq=Math.PI/2,rq=class extends vE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:4;super(),this.type="BoxGeometry",n=Math.floor(n),r=Math.floor(r),a=Math.floor(a),s=Math.floor(s),o=Math.min(o,e/2,t/2,i/2);let l=[],c=[],d=[],u=[],h=0;function p(e,t,i,n,r,a,s,p,f,m){let g=(a-2*o)/f,v=(s-2*o)/m,y=a/2-o,b=s/2-o,x=p/2,w=f+1,S=m+1,_=0,C=new j_;for(let o=0;o<S;o++){let a=o*v-b;for(let s=0;s<w;s++){let l=s*g-y;C[e]=l*n,C[t]=a*r,C[i]=x,c.push(C.x,C.y,C.z),C[e]=0,C[t]=0,C[i]=p>0?1:-1,d.push(C.x,C.y,C.z),u.push(s/f),u.push(1-o/m),_+=1}}for(let o=0;o<m;o++)for(let e=0;e<f;e++){let t=h+e+w*o,i=h+e+w*(o+1),n=h+(e+1)+w*(o+1),r=h+(e+1)+w*o;l.push(t,i,r),l.push(i,n,r)}h+=_}function f(e,t,i,n,r,a,p,f,m,g){let v=(p-2*o)/g,y=p/2-o,b=f/2-o,x=m/2,w=g+1,S=0,_=new j_,C=new j_;for(let l=0;l<s+1;l++){let h=l/s*nq,p=Math.sin(h)*o,f=(1-Math.cos(h))*o,m=Math.sin(h),E=Math.cos(h);_[t]=(b+p)*r,_[i]=(x-f)*a,C[e]=0,C[t]=m*Math.sign(_[t]),C[i]=E*Math.sign(_[i]);for(let t=0;t<w;t++){let i=t*v-y;_[e]=i*n,c.push(_.x,_.y,_.z),d.push(C.x,C.y,C.z),u.push(t/g),u.push(0),S+=1}}for(let o=0;o<s;o++)for(let e=0;e<g;e++){let t=h+e+w*o,i=h+e+w*(o+1),n=h+(e+1)+w*(o+1),r=h+(e+1)+w*o;l.push(t,i,r),l.push(i,n,r)}h+=S}function m(n,r,a){let p=new j_,f=new j_(e/2,t/2,i/2);f.subScalar(o);let m=[],g=n*r*a>0?(e,t,i)=>l.push(e,t,i):(e,t,i)=>l.push(e,i,t);for(let e=0;e<=s;e++){let t=[],i=nq*(1-e/s),l=Math.cos(i),g=Math.sin(i),v=0;for(let s=0;s<=e;s++){let i=Math.cos(v),s=Math.sin(v);p.x=l*i,p.y=g,p.z=l*s;let m=f.clone().addScaledVector(p,o);c.push(n*m.x,r*m.y,a*m.z),d.push(n*p.x,r*p.y,a*p.z),u.push(0,0),t.push(h++),v+=nq/e}m.push(t)}let v=m.length-1;for(let e=0;e<v;e++){let t=m[e],i=m[e+1],n=t.length-1;g(t[0],i[1],i[0]);for(let e=1;e<=n;e++)g(t[e-1],t[e],i[e]),g(t[e],i[e+1],i[e])}}p("z","y","x",-1,-1,i,t,e,a,r),p("z","y","x",1,-1,i,t,-e,a,r),p("x","z","y",1,1,e,i,t,n,a),p("x","z","y",1,-1,e,i,-t,n,a),p("x","y","z",1,-1,e,t,i,n,r),p("x","y","z",-1,-1,e,t,-i,n,r),o>0&&(f("z","y","x",-1,-1,1,i,t,e,a),f("z","y","x",1,-1,-1,i,t,e,a),f("z","y","x",-1,1,-1,i,t,e,a),f("z","y","x",1,1,1,i,t,e,a),f("x","y","z",-1,-1,-1,e,t,i,n),f("x","y","z",1,-1,1,e,t,i,n),f("x","y","z",-1,1,1,e,t,i,n),f("x","y","z",1,1,-1,e,t,i,n),f("y","x","z",-1,-1,1,t,e,i,r),f("y","x","z",1,-1,-1,t,e,i,r),f("y","x","z",1,1,1,t,e,i,r),f("y","x","z",-1,1,-1,t,e,i,r),m(1,1,1),m(-1,1,1),m(1,-1,1),m(-1,-1,1),m(1,1,-1),m(-1,1,-1),m(1,-1,-1),m(-1,-1,-1)),this.setIndex(l),this.setAttribute("position",new cE(c,3)),this.setAttribute("normal",new cE(d,3)),this.setAttribute("uv",new cE(u,2))}},aq=class extends vE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4;super(),this.type="PolyhedronGeometryRound";let o=[],s=[],l=[];return function(){r=Math.min(.99999,r),0==r&&(a=0);let s={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[i],c=new j_,d=c.clone(),u=new eE,h=r*n,p=n-h,f=a+1,m=new j_,g=(e,t)=>m.subVectors(e,t).normalize(),v=(e,t)=>Array(e).fill(void 0).map(t),y=v(e.length/3,(t,i)=>(new j_).fromArray(e,3*i).setLength(n)),b=[],x=1e6;for(let e=0;e<y.length;e++){let i,n,r,a=y[e],o=[],s=1e10,l=-1;for(;-1!=(l=t.indexOf(e,l+1));){let e=l-l%3;i=t[e+(l+1)%3],n=t[e+(l+2)%3],r=a.distanceToSquared(y[i]),s=Math.min(s,r),o.push([i,n,r])}s+=1e-6;let c=[],d=0,u=o.length;for(let t=0;t<u;t++){var w;[i,n,r]=o[d];let t=1==(null===(w=b[i])||void 0===w?void 0:w.includes(e));r<=s&&c.push(i+ +t*x),d=o.findIndex(e=>e[0]==n)}b.push(c)}let S=[];{let e,t,i=0,n=0,r=3==s;for(let o=0;o<=a;o++){e=o*(o+1)/2,t=(o+1)*(o+2)/2;for(let s=0;s<a-o;s++)[i,n]=[e+s+o+2,t+s+o+3],S.push(e,t,...r?[n,e]:[i,t],n,i),[e,t]=[i,n];S.push(e,t,e+a+2)}}let _=c.clone(),C=c.clone(),E=c.clone(),A=c.clone(),M=c.clone(),T=[],P=v(y.length,()=>v(s,()=>c.clone()));for(let e=0;e<y.length;e++){c.copy(y[e]).normalize(),_.copy(c).multiplyScalar(p);let t=b[e];for(let a=0;a<t.length;a++){let i=t[a],n=t[(a+1)%s];u.setFromPointsAndIndices(y,e,i%x,n%x),u.b.sub(u.a).setLength(1e10).add(u.a),u.c.sub(u.a).setLength(1e10).add(u.a),u.closestPointToPoint(_,P[e][a])}let i=[],n=[],r=[],v=new j_;0==a&&[...P[e]].reduce((e,t)=>e.add(t),v).multiplyScalar(1/s);for(let o=0;o<s;o++){let t=[],l=(o-1+s)%s,u=P[e][l],y=P[e][o];c.copy(u).sub(_),d.copy(y).sub(_);let b=_.angleTo(c),x=c.angleTo(d),w=Math.cos(b)*h;0==a?C.copy(v):C.copy(_).setLength(p+w),n.push(w);let S=[C,u,y];for(let e=0;e<2;e++){let n=S[e],r=S[e+1];A.subVectors(n,_),M.subVectors(r,_),E.crossVectors(A,M).normalize();for(let a=0;a<f;a++){let r=[b,x][e]*a/f;c.copy(A).applyAxisAngle(E,r).add(_),i.push(c.clone()),e&&(g(c,_),t.push([0==a?n:c.clone(),m.clone()]))}e&&(g(r,_),t.push([r,m.clone()]))}r.push(t)}T.push(r);let w=2*f,D=2;for(let e=0;e<s;e++){let t=w*e,r=w*((e+1)%s),a=[i[t]];for(let o=1;o<f;o++){A=i[t+o],M=i[r+o],a.push(A);for(let t=1,i=o-D+1;t<=i;t++)c.lerpVectors(A,M,t/(i+1)),c.sub(_).setLength(n[e]).add(_),a.push(c.clone());a.push(M)}for(let e=0;e<f;e++)a.push(i[e+f+t]);a.push(i[r+f]);let d=S.map(e=>a[e]);o.push(...d.map(e=>[e.x,e.y,e.z]).flat()),l.push(...d.map(e=>(g(e,_),[m.x,m.y,m.z])).flat())}}let D=[];for(let e=0;e<b.length;e++)for(let t=0;t<s;t++){let i=b[e][t];if(i<x){let n=b[i].findIndex(t=>t%x==e),r=T[e][t],a=T[i][n];for(let e=0;e<f;e++){let t=r[e],i=a[f-e],n=r[e+1];[t,i,n,n,i,a[f-(e+1)]].forEach(e=>{o.push(e[0].x,e[0].y,e[0].z),l.push(e[1].x,e[1].y,e[1].z)})}D.push(r[0][0],a[f][0],r[f][0],a[0][0])}}for(;D.length;){let e,t,i,n;[e,t]=D.splice(0,2);let r=[e];for(;e!=t;)r.push(t),i=D.indexOf(t),n=i%2,t=D.splice(i-n,2)[1-n];m.subVectors(r[0],r[1]).cross(c.subVectors(r[0],r[2])).normalize();let a=m.dot(r[0])<0;a&&m.negate();for(let s=1;s<=r.length-2;s++)[r[s+ +a],r[s+1-+a],r[0]].forEach(e=>{o.push(e.x,e.y,e.z),l.push(m.x,m.y,m.z)})}}(),function(){let e=new j_;for(let p=0;p<o.length;p+=3){e.x=o[p+0],e.y=o[p+1],e.z=o[p+2];let t=u(e)/2/Math.PI+.5,i=h(e)/Math.PI+.5;s.push(t,1-i)}let t=new j_,i=new j_,n=new j_,r=new j_,a=new p_,l=new p_,c=new p_,d=(e,t,i,n)=>{n<0&&1===e.x&&(s[t]=e.x-1),0===i.x&&0===i.z&&(s[t]=n/2/Math.PI+.5)};for(let p=0,f=0;p<o.length;p+=9,f+=6){t.set(o[p+0],o[p+1],o[p+2]),i.set(o[p+3],o[p+4],o[p+5]),n.set(o[p+6],o[p+7],o[p+8]),a.set(s[f+0],s[f+1]),l.set(s[f+2],s[f+3]),c.set(s[f+4],s[f+5]),r.copy(t).add(i).add(n).divideScalar(3);let e=u(r);d(a,f+0,t,e),d(l,f+2,i,e),d(c,f+4,n,e)}for(let o=0;o<s.length;o+=6){let e=s[o+0],t=s[o+2],i=s[o+4],n=Math.max(e,t,i),r=Math.min(e,t,i);n>.9&&r<.1&&(e<.2&&(s[o+0]+=1),t<.2&&(s[o+2]+=1),i<.2&&(s[o+4]+=1))}function u(e){return Math.atan2(e.z,-e.x)}function h(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}}(),this.setAttribute("position",new cE(o,3)),this.setAttribute("normal",new cE(l,3)),void this.setAttribute("uv",new cE(s,2))}static fromJSON(e){return new aq(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},oq=class extends aq{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=(1+Math.sqrt(5))/2,r=1/n,a="DodecahedronGeometry";super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,e,t,i),this.type=a}static fromJSON(e){return new oq(e.radius,e.corner,e.cornerSides)}},sq=1e-12,lq=class{constructor(e){this.position=new p_,this.startPosition=new p_,this.uuid=h_.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new lq(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},cq=class extends lq{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new cq(this.parent).copy(this)}},dq=class extends lq{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new cq(this),new cq(this))}static create(e,t){let i=new dq(e,new p_(...t.position));return i.controls[0].position.set(...t.controlPrevious.position),i.controls[1].position.set(...t.controlNext.position),i.roundness=t.roundness,i.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,i}getOppositeControl(e){let t=this.controls.indexOf(e);return 0===t?this.controls[1]:1===t?this.controls[0]:null}applyOffsetToControls(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;for(let i=0,n=this.controls.length;i<n;i++){let n=this.controls[i];this.position.distanceTo(n.position)<=t?n.position.copy(this.position):n.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new dq(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var e,t;return[null===(e=this.curveBefore)||void 0===e?void 0:e.getTangentAt(1),null===(t=this.curveAfter)||void 0===t?void 0:t.getTangentAt(0)]}computeNormals(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new p_,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new p_,[i,n]=this.computeTangents();return i&&n&&(uq(i,e),uq(n,t)),[e,t]}computeTangent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new p_,[t,i]=this.computeTangents();return t&&i&&e.copy(t).add(i).normalize(),e}computeNormal(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new p_,[t,i]=this.computeNormals();return e.copy(t).add(i).normalize(),e}};function uq(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new p_,i=e.length();return t.set(-e.y/i,e.x/i)}var hq=e=>e,pq=new p_,fq=new p_,mq=new p_,gq=new p_,vq=new p_,yq=new p_,bq=new j_,xq=new j_;function wq(e){let t=new p_;t.addVectors(e.v0,pq.subVectors(e.v1,e.v0).multiplyScalar(2/3));let i=new p_;return i.addVectors(e.v2,fq.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new mP(e.v0,t,i,e.v2)}function Sq(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return Math.abs(e-t)<i}function _q(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return e.distanceTo(t)<i}function Cq(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return e.distanceTo(t)<i}function Eq(e,t,i){let n=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),r=Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)),a=Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2));return Math.acos((r*r+n*n-a*a)/(2*r*n))}function Aq(e,t,i){return Iq(e,t)&&Iq(t,i)&&Mq(e.position,t.position,i.position)}function Mq(e,t,i){return 0===pq.copy(t).sub(e).cross(fq.copy(i).sub(e))}function Tq(e,t,i,n,r){let a=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),o=(e.y+t.y)/2,s=(e.x+t.x)/2,l=Math.sqrt(Math.pow(i,2)-Math.pow(a/2,2))*(e.y-t.y)/a,c=Math.sqrt(Math.pow(i,2)-Math.pow(a/2,2))*(t.x-e.x)/a;return n.set(s+l,o+c),r.set(s-l,o-c),[n,r]}function Pq(e,t,i){return e.distanceTo(i)<t.distanceTo(i)?t:e}function Dq(e,t,i,n,r,a){let o,s=t.x-e.x,l=t.y-e.y,c=i.x-e.x,d=i.y-e.y,u=Math.sqrt((s+c)*(s+c)+(l+d)*(l+d));return Eq(t,e,i)>Math.PI&&(u*=-1),o=Sq(d,l)?(l+d)*(n/u-.5)*8/3/(s-c):(s+c)*(n/u-.5)*8/3/(d-l),r.set(t.x-o*l,t.y+o*s),a.set(i.x+o*d,i.y-o*c),[r,a]}function Oq(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function Iq(e,t){return Mq(e.position,e.controls[1].position,t.position)&&Mq(e.position,t.controls[0].position,t.position)}function kq(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[];for(let r=0,a=e.length;r<a;r++){let a=e[r],o=0;if(i&&void 0!==a.roundedCurveCorner){let e=.5*Rq(a.roundedCurveCorner,t);r>0&&(n[r-1]+=e),o+=e}void 0!==a.curveAfter&&(o+=Rq(a.curveAfter,t)),n.push(o)}return e.length>0&&i&&void 0!==e[0].roundedCurveCorner&&(n[e.length-1]+=.5*Rq(e[0].roundedCurveCorner,t)),n}function Rq(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return e&&e instanceof oP?2*t:e&&(e instanceof vP||e instanceof yP)?1:e&&e instanceof xP?t*e.points.length:t}var zq,Lq,Bq,Nq=new p_,Fq=new p_,Uq=new p_,Vq=new p_,jq=new p_,Wq=new p_,Hq=class extends PP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;super(),this.points=[],this.shapeHoles=[],this.plane=new YE(new j_(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=h_.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,i){let n=new Hq;return n.isClosed=e.isClosed,n.points=e.points.map(e=>dq.create(e.id,e.data)),"number"==typeof e.roundness&&(n.roundness=e.roundness),n.shapeHoles=e.shapeHoles.map(e=>Hq.createFromState(e)),void 0!==t&&void 0!==i&&n.applySize(t,i),n.update(),n}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,i=this.points.length;t<i;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map(e=>this.getPointIndexById(e)).filter(e=>e>=0)}getPointIndexById(e){let t=this.points.length,i=this.points.findIndex(t=>t.uuid===e);if(i<0){let i=t;for(let t=0,n=this.shapeHoles.length;t<n;t++){let n=this.shapeHoles[t],r=n.points.length,a=n.getPointIndexById(e);if(!(a<0))return a+i;i+=r}}return i}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0){let t=this.points.length;for(let i=0,n=this.shapeHoles.length;i<n;i++){let n=this.shapeHoles[i],r=e-t;if(r<=n.points.length-1)return n.points[r];t+=n.points.length}}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let i=0,n=this.shapeHoles.length;i<n;i++){let n=this.shapeHoles[i],r=n.points.indexOf(e);if(r>=0)return t+r;t+=n.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map(e=>e.points));return[...this.points,...e]}applySize(e,t){0===e&&(e=.001),0===t&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let i=Nq.set(e,t);for(let n=0,r=this.points.length;n<r;n++){let e=this.points[n];e.position.multiply(i),e.controls[0].position.multiply(i),e.controls[1].position.multiply(i)}for(let n=0,r=this.shapeHoles.length;n<r;n++)this.shapeHoles[n].applyScale(e,t);this._update()}createPoint(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h_.generateUUID();t=e instanceof p_?e:new p_(e,i);let r=new dq(n,t);return r.roundness=this.roundness,r}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,i=this.points.length;t<i;t++){let i=this.points[t];if(i.uuid===e)return i}for(let t=0,i=this.shapeHoles.length;t<i;t++){let i=this.shapeHoles[t].getPointByUuid(e);if(i)return i}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find(t=>t.uuid===e);t&&this.removePoint(t)}update(){for(let e=0,t=this.shapeHoles.length;e<t;e++)this.shapeHoles[e].update();this._update()}extractShapePointsToBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.subdivision=t,void 0===this.curveDivisions&&this.computeCurveDivisions(t);let n=i?this.roundedCurveDivisions:this.curveDivisions;return function(e,t){let i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=xq.set(0,0,0),o=0,s=[];for(let l=0;l<t.length;l++){let r=hq(t[l]),c=pq,d=Rq(r,n);s.push(d);for(let t=0;t<=d;t++)if(r instanceof mP||r instanceof bP||r instanceof vP){if(r.getPoint(t/d,c),a.set(c.x,c.y,0),void 0!==i&&Cq(i,a))continue;void 0===i&&(i=bq),i.copy(a),e.setXYZ(o,a.x,a.y,a.z),o++}}r&&o>1&&!(e.getX(o-1)===e.getX(0)&&e.getY(o-1)===e.getY(0)&&e.getZ(o-1)===e.getZ(0))&&(e.setXYZ(o,e.getX(0),e.getY(0),e.getZ(0)),o++)}(e,i?this.roundedCurves:this.curves,t,this.autoClose),n.reduce((e,t)=>e+t,0)+1}computeCurveDivisions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;return this.curveDivisions=kq(this.points,e,!1),this.roundedCurveDivisions=kq(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12;return 2*function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=xq.set(0,0,0),o=0,s=[];for(let c=0;c<t.length;c++){if(!1===i[c])continue;let r,d=hq(t[c]),u=pq,h=Rq(d,n);s.push(h);for(let t=0;t<=h;t++)if(d instanceof mP||d instanceof bP||d instanceof vP){var l;if(d.getPoint(t/h,u),a.set(u.x,u.y,0),null!==(l=r)&&void 0!==l&&l.equals(a))continue;void 0===r?r=bq:(e.setXYZ(o,r.x,r.y,r.z),o++,e.setXYZ(o,a.x,a.y,a.z),o++),r.copy(a)}}return r&&o>1&&!(e.getX(o-1)===e.getX(0)&&e.getY(o-1)===e.getY(0)&&e.getZ(o-1)===e.getZ(0))&&(e.setXYZ(o,e.getX(0),e.getY(0),e.getZ(0)),o++),s}(e,this.curves,t,i,this.autoClose).reduce((e,t)=>e+t,0)}extractShapePointsToFlatArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return this.subdivision=t,void 0===this.curveDivisions&&this.computeCurveDivisions(t),function(e,t){let i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=0;for(let o=0;o<t.length;o++){let r=hq(t[o]),s=Rq(r,n),l=pq;for(let t=0;t<=s;t++)if(r instanceof mP||r instanceof bP||r instanceof vP){if(r.getPoint(t/s,l),void 0!==i&&_q(i,l,sq))continue;void 0===i&&(i=fq),i.copy(l),e.push(l.x,l.y),a++}}return Sq(e[0],e[e.length-2],sq)&&Sq(e[1],e[e.length-1],sq)&&(e.pop(),e.pop()),r&&a>1&&!(Sq(e[a-1],e[1],sq)&&Sq(e[a-2],e[0],sq))&&(e.push(e[0],e[1]),a++),e}(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=0;void 0===this.curveDivisions&&this.computeCurveDivisions(this.subdivision);let n=t?this.roundedCurveDivisions:this.curveDivisions,r=0;t&&void 0!==this.points[0].roundedCurveCorner&&(r=.5*Rq(this.points[0].roundedCurveCorner,this.subdivision));let a=e-r;a<0&&(a+=n.reduce((e,t)=>e+t,0));for(let o=0,s=n.length;o<s;o++){let e=n[o];if(a<i+e)return[o,(a-i+1)/e];i+=e}return[0,1]}getCurveT(e,t,i){let n=this.points[e],r=this.points[e>=this.points.length-1?0:e+1],a=this.curveDivisions,o=a[e];if(Oq(n,r)){let e=n.position.distanceTo(r.position);return n.position.distanceTo(Nq.set(i.x,i.y))/e}let s=0;for(let l=0;l<e;l++)s+=a[l];return(t-s)/o}dispose(){}_applyCurveForPoint(e,t){Oq(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let i=this.curves[this.curves.length-1];e.curveBefore=i,t.curveAfter=i;let n=i.clone();e.roundedCurveBefore=n,t.roundedCurveAfter=n,e.roundedCurveCorner=void 0,this.roundedCurves.push(n)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let n=0,r=this.points.length;n<r;n++){let e=this.points[n];if(0===n)this.moveTo(e.position.x,e.position.y);else{let t=this.points[n-1];this._applyCurveForPoint(e,t)}}let e=this.getLastPoint();if(null!==e&&void 0!==e&&e.curveAfter&&(e.curveAfter=void 0),this.isClosed){let e=this.points[0],t=this.points[this.points.length-1];this._applyCurveForPoint(e,t)}if(this.points.length>2){let e=0;for(let n=0,r=this.points.length;n<r;n++){var t,i;let r=this.points[n],a=null!==(t=this.points[n-1])&&void 0!==t?t:this.points[this.points.length-1],o=null!==(i=this.points[n+1])&&void 0!==i?i:this.points[0],s=r.roundness,l=a&&o&&Aq(a,r,o);if(!r.controlsMoved()&&s>0&&!l){let t=r.curveBefore,i=r.curveAfter;if(void 0===t||void 0===i)continue;let a,o=r.roundedCurveBefore,l=r.roundedCurveAfter,c=t.getLength(),d=i.getLength(),u=Math.min(s,.499*c),h=Math.min(s,.499*d),p=Math.min(u,h),f=1-p/c,m=p/d,g=t.getPointAt(f,Nq),v=i.getPointAt(m,Fq);if(this._subSplitCurve(t,o,f,g,void 0),this._subSplitCurve(i,l,m,void 0,v),this.useCubicForRoundedCorners){let e=Eq(g,r.position,v)/2,t=Math.tan(e)*g.distanceTo(r.position),[i,n]=Tq(g,v,t,Uq,Vq),o=Pq(i,n,r.position),[s,l]=Dq(o,g,v,t,jq,Wq);a=new mP(g.clone(),s.clone(),l.clone(),v.clone())}else a=new bP(g.clone(),r.position.clone(),v.clone());r.roundedCurveCorner=a,this.roundedCurves.splice(n+e,0,a),e++}}}}_subSplitCurve(e,t,i,n,r){if(!(e instanceof vP)){let a=e,o=t,s=a.getUtoTmapping(i,0),l=function(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,a=pq.subVectors(t,e).multiplyScalar(r).add(e),o=fq.subVectors(i,t).multiplyScalar(r).add(t),s=mq.subVectors(n,i).multiplyScalar(r).add(i),l=a,c=gq.subVectors(o,a).multiplyScalar(r).add(a),d=vq.subVectors(s,o).multiplyScalar(r).add(o),u=s,h=yq.subVectors(d,c).multiplyScalar(r).add(c);return[e.x,e.y,l.x,l.y,c.x,c.y,h.x,h.y,d.x,d.y,u.x,u.y,n.x,n.y]}(a.v0,a.v1,a.v2,a.v3,s);return void 0!==n&&(o.v0.set(l[0],l[1]),o.v1.set(l[2],l[3]),o.v2.set(l[4],l[5]),o.v3.set(l[6],l[7])),void 0!==r&&(o.v0.set(l[6],l[7]),o.v1.set(l[8],l[9]),o.v2.set(l[10],l[11]),o.v3.set(l[12],l[13])),o}return void 0!==n&&t.v2.copy(n),void 0!==r&&t.v1.copy(r),t}clone(){let e=new Hq(this._width,this._height);return e.points=this.points.map(e=>e.clone()),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map(e=>e.clone()),e}toJSON(){return{points:this.points.reduce((e,t)=>e.concat(t.toJSON()),[]),shapeHoles:this.shapeHoles.map(e=>e.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){var t;this.points=[],this.pointIDs=0;let i=e.points.length/7;for(let n=0;n<i;n++){let t=7*n,i=e.points[t+0],r=e.points[t+1],a=e.points[t+2],o=e.points[t+3],s=e.points[t+4],l=e.points[t+5],c=e.points[t+6],d=new dq(h_.generateUUID(),new p_(i,r));d.controls[0].position.set(a,o),d.controls[1].position.set(s,l),d.roundness=c,this.points.push(d)}return this.shapeHoles=null!==(t=e.shapeHoles)&&void 0!==t&&t.length?e.shapeHoles.map(e=>{let t=new Hq;return t.fromJSON(e),t}):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isText=t;let i=(e,t)=>{t instanceof mP&&t.v3.equals(e.position)&&e.controls[0].position.copy(t.v2)};return this.points=(e=>{let t,n,r=[];for(t=0,n=e.length;t<n;t++)e[t]instanceof bP&&(e[t]=wq(e[t]));for(t=0,n=e.length;t<n;t++){let n,a=e[t],o=t>0?e[t-1]:null;a instanceof mP?(n=this.createPoint(a.v0),n.controls[1].position.copy(a.v1)):a instanceof vP&&(n=this.createPoint(a.v1)),void 0!==n&&(null!==o&&i(n,o),r.push(n))}let a=e[e.length-1],o=!1;return a instanceof mP?a.v3.equals(r[0].position)&&(r[0].controls[0].position.copy(a.v2),o=!0):a instanceof vP&&a.v2.equals(r[0].position)&&(o=!0),this.isClosed=o,r})(e.curves),e instanceof PP&&(this.shapeHoles=e.holes.map(e=>{let t=new Hq;return t.fromShape(e),t})),this.update(),this}updatePoint(e,t){let i=this.getPointByUuid(e);i&&(void 0!==t.position&&i.position.fromArray(t.position),void 0!==t.roundness&&(i.roundness=t.roundness),void 0!==t.areControlsDirectionsMirrored&&(i.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(e,t){var i;let n=null===(i=this.getPointByUuid(e))||void 0===i?void 0:i.controls[0];n&&(t.position&&n.position.fromArray(t.position),this.needsUpdate=!0)}updateNextControl(e,t){var i;let n=null===(i=this.getPointByUuid(e))||void 0===i?void 0:i.controls[1];n&&(t.position&&n.position.fromArray(t.position),this.needsUpdate=!0)}},Gq=2*Math.PI;function qq(e,t,i,n,r){let{x:a,y:o}=e;return{x:a*t+n,y:o*i+r}}function Xq(e,t){let i=1.5707963267948966===t?.551915024494:-1.5707963267948966===t?-.551915024494:1.3333333333333333*Math.tan(t/4),n=Math.cos(e),r=Math.sin(e),a=Math.cos(e+t),o=Math.sin(e+t);return[{x:n-r*i,y:r+n*i},{x:a+o*i,y:o-a*i},{x:a,y:o}]}function Yq(e,t,i,n){let r=e*n-t*i<0?-1:1,a=Math.min(1,Math.max(-1,e*i+t*n));return r*Math.acos(a)}function Qq(e){let{px:t,py:i,cx:n,cy:r,rx:a,ry:o,largeArcFlag:s,sweepFlag:l}=e,c=[];if(0===a||0===o)return[];let d=(t-n)/2,u=(i-r)/2;if(0===d&&0===u)return[];a=Math.abs(a),o=Math.abs(o);let h=Math.pow(d,2)/Math.pow(a,2)+Math.pow(u,2)/Math.pow(o,2);h>1&&(a*=Math.sqrt(h),o*=Math.sqrt(h));let p=function(e,t,i,n,r,a,o,s,l,c){let d=Math.pow(r,2),u=Math.pow(a,2),h=Math.pow(o,2),p=Math.pow(s,2),f=d*u-d*p-u*h;f<0&&(f=0),f/=d*p+u*h,f=Math.sqrt(f)*(l===c?-1:1);let m=f*r/a*s,g=f*-a/r*o,v=m+(e+i)/2,y=g+(t+n)/2,b=(o-m)/r,x=(s-g)/a,w=(-o-m)/r,S=(-s-g)/a,_=Yq(1,0,b,x),C=Yq(b,x,w,S);return!c&&C>0&&(C-=Gq),c&&C<0&&(C+=Gq),{centerx:v,centery:y,ang1:_,ang2:C}}(t,i,n,r,a,o,d,u,s,l),{ang1:f,ang2:m}=p,{centerx:g,centery:v}=p,y=Math.abs(m)/(Gq/4);Math.abs(1-y)<1e-7&&(y=1);let b=Math.max(Math.ceil(y),1);m/=b;for(let x=0;x<b;x++)c.push(Xq(f,m)),f+=m;return c.map(e=>{let{x:t,y:i}=qq(e[0],a,o,g,v),{x:n,y:r}=qq(e[1],a,o,g,v),{x:s,y:l}=qq(e[2],a,o,g,v);return{x1:t,y1:i,x2:n,y2:r,x:s,y:l}})}function Kq(e,t){if(!e)throw t||"Assertion Failed!"}(Lq=zq||(zq={}))[Lq.ODD=0]="ODD",Lq[Lq.NONZERO=1]="NONZERO",Lq[Lq.POSITIVE=2]="POSITIVE",Lq[Lq.NEGATIVE=3]="NEGATIVE",Lq[Lq.ABS_GEQ_TWO=4]="ABS_GEQ_TWO",function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"}(Bq||(Bq={}));var Zq=function(){function e(){}return e.vertEq=function(e,t){return e.s===t.s&&e.t===t.t},e.vertLeq=function(e,t){return e.s<t.s||e.s===t.s&&e.t<=t.t},e.transLeq=function(e,t){return e.t<t.t||e.t===t.t&&e.s<=t.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(e,t){return Math.abs(e.s-t.s)+Math.abs(e.t-t.t)},e.edgeEval=function(t,i,n){Kq(e.vertLeq(t,i)&&e.vertLeq(i,n));var r=i.s-t.s,a=n.s-i.s;return r+a>0?r<a?i.t-t.t+(t.t-n.t)*(r/(r+a)):i.t-n.t+(n.t-t.t)*(a/(r+a)):0},e.edgeSign=function(t,i,n){Kq(e.vertLeq(t,i)&&e.vertLeq(i,n));var r=i.s-t.s,a=n.s-i.s;return r+a>0?(i.t-n.t)*r+(i.t-t.t)*a:0},e.transEval=function(t,i,n){Kq(e.transLeq(t,i)&&e.transLeq(i,n));var r=i.t-t.t,a=n.t-i.t;return r+a>0?r<a?i.s-t.s+(t.s-n.s)*(r/(r+a)):i.s-n.s+(n.s-t.s)*(a/(r+a)):0},e.transSign=function(t,i,n){Kq(e.transLeq(t,i)&&e.transLeq(i,n));var r=i.t-t.t,a=n.t-i.t;return r+a>0?(i.s-n.s)*r+(i.s-t.s)*a:0},e.vertCCW=function(e,t,i){return e.s*(t.t-i.t)+t.s*(i.t-e.t)+i.s*(e.t-t.t)>=0},e.interpolate=function(e,t,i,n){return(e=e<0?0:e)<=(i=i<0?0:i)?0===i?(t+n)/2:t+e/(e+i)*(n-t):n+i/(e+i)*(t-n)},e.intersect=function(t,i,n,r,a){var o,s,l;e.vertLeq(t,i)||(l=t,t=i,i=l),e.vertLeq(n,r)||(l=n,n=r,r=l),e.vertLeq(t,n)||(l=t,t=n,n=l,l=i,i=r,r=l),e.vertLeq(n,i)?e.vertLeq(i,r)?((o=e.edgeEval(t,n,i))+(s=e.edgeEval(n,i,r))<0&&(o=-o,s=-s),a.s=e.interpolate(o,n.s,s,i.s)):((o=e.edgeSign(t,n,i))+(s=-e.edgeSign(t,r,i))<0&&(o=-o,s=-s),a.s=e.interpolate(o,n.s,s,r.s)):a.s=(n.s+i.s)/2,e.transLeq(t,i)||(l=t,t=i,i=l),e.transLeq(n,r)||(l=n,n=r,r=l),e.transLeq(t,n)||(l=t,t=n,n=l,l=i,i=r,r=l),e.transLeq(n,i)?e.transLeq(i,r)?((o=e.transEval(t,n,i))+(s=e.transEval(n,i,r))<0&&(o=-o,s=-s),a.t=e.interpolate(o,n.t,s,i.t)):((o=e.transSign(t,n,i))+(s=-e.transSign(t,r,i))<0&&(o=-o,s=-s),a.t=e.interpolate(o,n.t,s,r.t)):a.t=(n.t+i.t)/2},e}(),Jq=function(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1},$q=function(){function e(e){this.side=e,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(e){this.Sym.Lface=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(e){this.Sym.Org=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(e){this.Sym.Lnext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(e){this.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(e){this.Lnext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(e){this.Sym.Onext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(e){this.Sym.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(e){this.Sym.Lnext.Sym=e},enumerable:!0,configurable:!0}),e}(),eX=function(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0},tX=function(){function e(){var e=new eX,t=new Jq,i=new $q(0),n=new $q(1);e.next=e.prev=e,e.anEdge=null,t.next=t.prev=t,i.next=i,i.Sym=n,n.next=n,n.Sym=i,this.vHead=e,this.fHead=t,this.eHead=i,this.eHeadSym=n}return e.prototype.makeEdge_=function(e){var t=new $q(0),i=new $q(1);e.Sym.side<e.side&&(e=e.Sym);var n=e.Sym.next;return i.next=n,n.Sym.next=t,t.next=e,e.Sym.next=i,t.Sym=i,t.Onext=t,t.Lnext=i,t.Org=null,t.Lface=null,t.winding=0,t.activeRegion=null,i.Sym=t,i.Onext=i,i.Lnext=t,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,t},e.prototype.splice_=function(e,t){var i=e.Onext,n=t.Onext;i.Sym.Lnext=t,n.Sym.Lnext=e,e.Onext=n,t.Onext=i},e.prototype.makeVertex_=function(e,t,i){var n=e;Kq(n,"Vertex can't be null!");var r=i.prev;n.prev=r,r.next=n,n.next=i,i.prev=n,n.anEdge=t;var a=t;do{a.Org=n,a=a.Onext}while(a!==t)},e.prototype.makeFace_=function(e,t,i){var n=e;Kq(n,"Face can't be null");var r=i.prev;n.prev=r,r.next=n,n.next=i,i.prev=n,n.anEdge=t,n.trail=null,n.marked=!1,n.inside=i.inside;var a=t;do{a.Lface=n,a=a.Lnext}while(a!==t)},e.prototype.killEdge_=function(e){e.Sym.side<e.side&&(e=e.Sym);var t=e.next,i=e.Sym.next;t.Sym.next=i,i.Sym.next=t},e.prototype.killVertex_=function(e,t){var i=e.anEdge,n=i;do{n.Org=t,n=n.Onext}while(n!==i);var r=e.prev,a=e.next;a.prev=r,r.next=a},e.prototype.killFace_=function(e,t){var i=e.anEdge,n=i;do{n.Lface=t,n=n.Lnext}while(n!==i);var r=e.prev,a=e.next;a.prev=r,r.next=a},e.prototype.makeEdge=function(){var e=new eX,t=new eX,i=new Jq,n=this.makeEdge_(this.eHead);return this.makeVertex_(e,n,this.vHead),this.makeVertex_(t,n.Sym,this.vHead),this.makeFace_(i,n,this.fHead),n},e.prototype.splice=function(e,t){var i=!1,n=!1;if(e!==t){if(t.Org!==e.Org&&(n=!0,this.killVertex_(t.Org,e.Org)),t.Lface!==e.Lface&&(i=!0,this.killFace_(t.Lface,e.Lface)),this.splice_(t,e),!n){var r=new eX;this.makeVertex_(r,t,e.Org),e.Org.anEdge=e}if(!i){var a=new Jq;this.makeFace_(a,t,e.Lface),e.Lface.anEdge=e}}},e.prototype.delete=function(e){var t=e.Sym,i=!1;if(e.Lface!==e.Rface&&(i=!0,this.killFace_(e.Lface,e.Rface)),e.Onext===e)this.killVertex_(e.Org,null);else if(e.Rface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev),!i){var n=new Jq;this.makeFace_(n,e,e.Lface)}t.Onext===t?(this.killVertex_(t.Org,null),this.killFace_(t.Lface,null)):(e.Lface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev)),this.killEdge_(e)},e.prototype.addEdgeVertex=function(e){var t=this.makeEdge_(e),i=t.Sym;this.splice_(t,e.Lnext),t.Org=e.Dst;var n=new eX;return this.makeVertex_(n,i,t.Org),t.Lface=i.Lface=e.Lface,t},e.prototype.splitEdge=function(e){var t=this.addEdgeVertex(e).Sym;return this.splice_(e.Sym,e.Sym.Oprev),this.splice_(e.Sym,t),e.Dst=t.Org,t.Dst.anEdge=t.Sym,t.Rface=e.Rface,t.winding=e.winding,t.Sym.winding=e.Sym.winding,t.idx=e.idx,t.Sym.idx=e.Sym.idx,t},e.prototype.connect=function(e,t){var i=!1,n=this.makeEdge_(e),r=n.Sym;if(t.Lface!==e.Lface&&(i=!0,this.killFace_(t.Lface,e.Lface)),this.splice_(n,e.Lnext),this.splice_(r,t),n.Org=e.Dst,r.Org=t.Org,n.Lface=r.Lface=e.Lface,e.Lface.anEdge=r,!i){var a=new Jq;this.makeFace_(a,n,e.Lface)}return n},e.prototype.zapFace=function(e){var t,i,n,r,a,o=e.anEdge;i=o.Lnext;do{i=(t=i).Lnext,t.Lface=null,null===t.Rface&&(t.Onext===t?this.killVertex_(t.Org,null):(t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev)),(n=t.Sym).Onext===n?this.killVertex_(n.Org,null):(n.Org.anEdge=n.Onext,this.splice_(n,n.Oprev)),this.killEdge_(t))}while(t!=o);r=e.prev,(a=e.next).prev=r,r.next=a},e.prototype.countFaceVerts_=function(e){var t=e.anEdge,i=0;do{i++,t=t.Lnext}while(t!==e.anEdge);return i},e.prototype.mergeConvexFaces=function(e){var t,i,n,r,a;for(t=this.fHead.next;t!==this.fHead;t=t.next)if(t.inside)for(a=(i=t.anEdge).Org;n=i.Lnext,(r=i.Sym)&&r.Lface&&r.Lface.inside&&(this.countFaceVerts_(t)+this.countFaceVerts_(r.Lface)-2<=e&&Zq.vertCCW(i.Lprev.Org,i.Org,r.Lnext.Lnext.Org)&&Zq.vertCCW(r.Lprev.Org,r.Org,i.Lnext.Lnext.Org)&&(n=r.Lnext,this.delete(r),i=null,r=null)),!i||i.Lnext.Org!==a;)i=n;return!0},e.prototype.check=function(){var e,t,i,n,r,a,o=this.fHead,s=this.vHead,l=this.eHead;for(t=o,t=o;(e=t.next)!==o;t=e){Kq(e.prev===t),r=e.anEdge;do{Kq(r.Sym!==r),Kq(r.Sym.Sym===r),Kq(r.Lnext.Onext.Sym===r),Kq(r.Onext.Sym.Lnext===r),Kq(r.Lface===e),r=r.Lnext}while(r!==e.anEdge)}for(Kq(e.prev===t&&null===e.anEdge),n=s,n=s;(i=n.next)!==s;n=i){Kq(i.prev===n),r=i.anEdge;do{Kq(r.Sym!==r),Kq(r.Sym.Sym===r),Kq(r.Lnext.Onext.Sym===r),Kq(r.Onext.Sym.Lnext===r),Kq(r.Org===i),r=r.Onext}while(r!==i.anEdge)}for(Kq(i.prev===n&&null===i.anEdge),a=l,a=l;(r=a.next)!==l;a=r)Kq(r.Sym.next===a.Sym),Kq(r.Sym!==r),Kq(r.Sym.Sym===r),Kq(null!==r.Org),Kq(null!==r.Dst),Kq(r.Lnext.Onext.Sym===r),Kq(r.Onext.Sym.Lnext===r);Kq(r.Sym.next===a.Sym&&r.Sym===this.eHeadSym&&r.Sym.Sym===r&&null===r.Org&&null===r.Dst&&null===r.Lface&&null===r.Rface)},e}(),iX=function(){this.handle=null},nX=function(){this.key=null,this.node=0},rX=function(){function e(e,t){this.leq=t,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=e,this.nodes=[],this.handles=[];for(var i=0;i<e+1;i++)this.nodes[i]=new iX,this.handles[i]=new nX;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(e){var t,i,n,r=this.nodes,a=this.handles;for(t=r[e].handle;;){if((n=e<<1)<this.size&&this.leq(a[r[n+1].handle].key,a[r[n].handle].key)&&++n,Kq(n<=this.max),i=r[n].handle,n>this.size||this.leq(a[t].key,a[i].key)){r[e].handle=t,a[t].node=e;break}r[e].handle=i,a[i].node=e,e=n}},e.prototype.floatUp_=function(e){var t,i,n,r=this.nodes,a=this.handles;for(t=r[e].handle;;){if(i=r[n=e>>1].handle,0===n||this.leq(a[i].key,a[t].key)){r[e].handle=t,a[t].node=e;break}r[e].handle=i,a[i].node=e,e=n}},e.prototype.init=function(){for(var e=this.size;e>=1;--e)this.floatDown_(e);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(e){var t,i;if(2*(t=++this.size)>this.max){var n,r;for(this.max*=2,r=this.nodes.length,this.nodes.length=this.max+1,n=r;n<this.nodes.length;n++)this.nodes[n]=new iX;for(r=this.handles.length,this.handles.length=this.max+1,n=r;n<this.handles.length;n++)this.handles[n]=new nX}return 0===this.freeList?i=t:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[t].handle=i,this.handles[i].node=t,this.handles[i].key=e,this.initialized&&this.floatUp_(t),i},e.prototype.extractMin=function(){var e=this.nodes,t=this.handles,i=e[1].handle,n=t[i].key;return this.size>0&&(e[1].handle=e[this.size].handle,t[e[1].handle].node=1,t[i].key=null,t[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),n},e.prototype.delete=function(e){var t,i=this.nodes,n=this.handles;Kq(e>=1&&e<=this.max&&null!==n[e].key),i[t=n[e].node].handle=i[this.size].handle,n[i[t].handle].node=t,--this.size,t<=this.size&&(t<=1||this.leq(n[i[t>>1].handle].key,n[i[t].handle].key)?this.floatDown_(t):this.floatUp_(t)),n[e].key=null,n[e].node=this.freeList,this.freeList=e},e}(),aX=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},oX=function(){this.key=null,this.next=null,this.prev=null},sX=function(){function e(e,t){this.frame=e,this.leq=t,this.head=new oX,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(e){return this.insertBefore(this.head,e)},e.prototype.search=function(e){var t=this.head;do{t=t.next}while(null!==t.key&&!this.leq(this.frame,e,t.key));return t},e.prototype.insertBefore=function(e,t){do{e=e.prev}while(null!==e.key&&!this.leq(this.frame,e.key,t));var i=new oX;return i.key=t,i.next=e.next,e.next.prev=i,i.prev=e,e.next=i,i},e.prototype.delete=function(e){e.next.prev=e.prev,e.prev.next=e.next},e}(),lX=function(){function e(){}return e.regionBelow=function(e){return e.nodeUp.prev.key},e.regionAbove=function(e){return e.nodeUp.next.key},e.debugEvent=function(e){},e.addWinding=function(e,t){e.winding+=t.winding,e.Sym.winding+=t.Sym.winding},e.edgeLeq=function(e,t,i){var n=e.event,r=t.eUp,a=i.eUp;return r.Dst===n?a.Dst===n?Zq.vertLeq(r.Org,a.Org)?Zq.edgeSign(a.Dst,r.Org,a.Org)<=0:Zq.edgeSign(r.Dst,a.Org,r.Org)>=0:Zq.edgeSign(a.Dst,n,a.Org)<=0:a.Dst===n?Zq.edgeSign(r.Dst,n,r.Org)>=0:Zq.edgeEval(r.Dst,n,r.Org)>=Zq.edgeEval(a.Dst,n,a.Org)},e.deleteRegion=function(e,t){t.fixUpperEdge&&Kq(0===t.eUp.winding),t.eUp.activeRegion=null,e.dict.delete(t.nodeUp)},e.fixUpperEdge=function(e,t,i){Kq(t.fixUpperEdge),e.mesh.delete(t.eUp),t.fixUpperEdge=!1,t.eUp=i,i.activeRegion=t},e.topLeftRegion=function(t,i){var n,r=i.eUp.Org;do{i=e.regionAbove(i)}while(i.eUp.Org===r);if(i.fixUpperEdge){if(null===(n=t.mesh.connect(e.regionBelow(i).eUp.Sym,i.eUp.Lnext)))return null;e.fixUpperEdge(t,i,n),i=e.regionAbove(i)}return i},e.topRightRegion=function(t){var i=t.eUp.Dst;do{t=e.regionAbove(t)}while(t.eUp.Dst===i);return t},e.addRegionBelow=function(e,t,i){var n=new aX;return n.eUp=i,n.nodeUp=e.dict.insertBefore(t.nodeUp,n),n.fixUpperEdge=!1,n.sentinel=!1,n.dirty=!1,i.activeRegion=n,n},e.isWindingInside=function(e,t){switch(e.windingRule){case zq.ODD:return 0!==(1&t);case zq.NONZERO:return 0!==t;case zq.POSITIVE:return t>0;case zq.NEGATIVE:return t<0;case zq.ABS_GEQ_TWO:return t>=2||t<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,i){i.windingNumber=e.regionAbove(i).windingNumber+i.eUp.winding,i.inside=e.isWindingInside(t,i.windingNumber)},e.finishRegion=function(t,i){var n=i.eUp,r=n.Lface;r.inside=i.inside,r.anEdge=n,e.deleteRegion(t,i)},e.finishLeftRegions=function(t,i,n){for(var r,a=null,o=i,s=i.eUp;o!==n;){if(o.fixUpperEdge=!1,(r=(a=e.regionBelow(o)).eUp).Org!=s.Org){if(!a.fixUpperEdge){e.finishRegion(t,o);break}r=t.mesh.connect(s.Lprev,r.Sym),e.fixUpperEdge(t,a,r)}s.Onext!==r&&(t.mesh.splice(r.Oprev,r),t.mesh.splice(s,r)),e.finishRegion(t,o),s=a.eUp,o=a}return s},e.addRightEdges=function(t,i,n,r,a,o){var s,l,c,d,u=!0;c=n;do{Kq(Zq.vertLeq(c.Org,c.Dst)),e.addRegionBelow(t,i,c.Sym),c=c.Onext}while(c!==r);for(null===a&&(a=e.regionBelow(i).eUp.Rprev),l=i,d=a;(c=(s=e.regionBelow(l)).eUp.Sym).Org===d.Org;)c.Onext!==d&&(t.mesh.splice(c.Oprev,c),t.mesh.splice(d.Oprev,c)),s.windingNumber=l.windingNumber-c.winding,s.inside=e.isWindingInside(t,s.windingNumber),l.dirty=!0,!u&&e.checkForRightSplice(t,l)&&(e.addWinding(c,d),e.deleteRegion(t,l),t.mesh.delete(d)),u=!1,l=s,d=c;l.dirty=!0,Kq(l.windingNumber-c.winding===s.windingNumber),o&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(e,t,i){e.mesh.splice(t,i)},e.vertexWeights=function(e,t,i){var n=Zq.vertL1dist(t,e),r=Zq.vertL1dist(i,e),a=.5*r/(n+r),o=.5*n/(n+r);e.coords[0]+=a*t.coords[0]+o*i.coords[0],e.coords[1]+=a*t.coords[1]+o*i.coords[1],e.coords[2]+=a*t.coords[2]+o*i.coords[2]},e.getIntersectData=function(t,i,n,r,a,o){i.coords[0]=i.coords[1]=i.coords[2]=0,i.idx=-1,e.vertexWeights(i,n,r),e.vertexWeights(i,a,o)},e.checkForRightSplice=function(t,i){var n=e.regionBelow(i),r=i.eUp,a=n.eUp;if(Zq.vertLeq(r.Org,a.Org)){if(Zq.edgeSign(a.Dst,r.Org,a.Org)>0)return!1;Zq.vertEq(r.Org,a.Org)?r.Org!==a.Org&&(t.pq.delete(r.Org.pqHandle),e.spliceMergeVertices(t,a.Oprev,r)):(t.mesh.splitEdge(a.Sym),t.mesh.splice(r,a.Oprev),i.dirty=n.dirty=!0)}else{if(Zq.edgeSign(r.Dst,a.Org,r.Org)<0)return!1;e.regionAbove(i).dirty=i.dirty=!0,t.mesh.splitEdge(r.Sym),t.mesh.splice(a.Oprev,r)}return!0},e.checkForLeftSplice=function(t,i){var n,r=e.regionBelow(i),a=i.eUp,o=r.eUp;if(Kq(!Zq.vertEq(a.Dst,o.Dst)),Zq.vertLeq(a.Dst,o.Dst)){if(Zq.edgeSign(a.Dst,o.Dst,a.Org)<0)return!1;e.regionAbove(i).dirty=i.dirty=!0,n=t.mesh.splitEdge(a),t.mesh.splice(o.Sym,n),n.Lface.inside=i.inside}else{if(Zq.edgeSign(o.Dst,a.Dst,o.Org)>0)return!1;i.dirty=r.dirty=!0,n=t.mesh.splitEdge(o),t.mesh.splice(a.Lnext,o.Sym),n.Rface.inside=i.inside}return!0},e.checkForIntersect=function(t,i){var n,r,a=e.regionBelow(i),o=i.eUp,s=a.eUp,l=o.Org,c=s.Org,d=o.Dst,u=s.Dst,h=new eX;if(Kq(!Zq.vertEq(u,d)),Kq(Zq.edgeSign(d,t.event,l)<=0),Kq(Zq.edgeSign(u,t.event,c)>=0),Kq(l!==t.event&&c!==t.event),Kq(!i.fixUpperEdge&&!a.fixUpperEdge),l===c||Math.min(l.t,d.t)>Math.max(c.t,u.t))return!1;if(Zq.vertLeq(l,c)){if(Zq.edgeSign(u,l,c)>0)return!1}else if(Zq.edgeSign(d,c,l)<0)return!1;return e.debugEvent(t),Zq.intersect(d,l,u,c,h),Kq(Math.min(l.t,d.t)<=h.t),Kq(h.t<=Math.max(c.t,u.t)),Kq(Math.min(u.s,d.s)<=h.s),Kq(h.s<=Math.max(c.s,l.s)),Zq.vertLeq(h,t.event)&&(h.s=t.event.s,h.t=t.event.t),n=Zq.vertLeq(l,c)?l:c,Zq.vertLeq(n,h)&&(h.s=n.s,h.t=n.t),Zq.vertEq(h,l)||Zq.vertEq(h,c)?(e.checkForRightSplice(t,i),!1):!Zq.vertEq(d,t.event)&&Zq.edgeSign(d,t.event,h)>=0||!Zq.vertEq(u,t.event)&&Zq.edgeSign(u,t.event,h)<=0?u===t.event?(t.mesh.splitEdge(o.Sym),t.mesh.splice(s.Sym,o),i=e.topLeftRegion(t,i),o=e.regionBelow(i).eUp,e.finishLeftRegions(t,e.regionBelow(i),a),e.addRightEdges(t,i,o.Oprev,o,o,!0),!0):d===t.event?(t.mesh.splitEdge(s.Sym),t.mesh.splice(o.Lnext,s.Oprev),a=i,i=e.topRightRegion(i),r=e.regionBelow(i).eUp.Rprev,a.eUp=s.Oprev,s=e.finishLeftRegions(t,a,null),e.addRightEdges(t,i,s.Onext,o.Rprev,r,!0),!0):(Zq.edgeSign(d,t.event,h)>=0&&(e.regionAbove(i).dirty=i.dirty=!0,t.mesh.splitEdge(o.Sym),o.Org.s=t.event.s,o.Org.t=t.event.t),Zq.edgeSign(u,t.event,h)<=0&&(i.dirty=a.dirty=!0,t.mesh.splitEdge(s.Sym),s.Org.s=t.event.s,s.Org.t=t.event.t),!1):(t.mesh.splitEdge(o.Sym),t.mesh.splitEdge(s.Sym),t.mesh.splice(s.Oprev,o),o.Org.s=h.s,o.Org.t=h.t,o.Org.pqHandle=t.pq.insert(o.Org),e.getIntersectData(t,o.Org,l,d,c,u),e.regionAbove(i).dirty=i.dirty=a.dirty=!0,!1)},e.walkDirtyRegions=function(t,i){for(var n,r,a=e.regionBelow(i);;){for(;a.dirty;)i=a,a=e.regionBelow(a);if(!i.dirty&&(a=i,null===(i=e.regionAbove(i))||!i.dirty))return;if(i.dirty=!1,n=i.eUp,r=a.eUp,n.Dst!==r.Dst&&e.checkForLeftSplice(t,i)&&(a.fixUpperEdge?(e.deleteRegion(t,a),t.mesh.delete(r),r=(a=e.regionBelow(i)).eUp):i.fixUpperEdge&&(e.deleteRegion(t,i),t.mesh.delete(n),n=(i=e.regionAbove(a)).eUp)),n.Org!==r.Org)if(n.Dst===r.Dst||i.fixUpperEdge||a.fixUpperEdge||n.Dst!==t.event&&r.Dst!==t.event)e.checkForRightSplice(t,i);else if(e.checkForIntersect(t,i))return;n.Org===r.Org&&n.Dst===r.Dst&&(e.addWinding(r,n),e.deleteRegion(t,i),t.mesh.delete(n),i=e.regionAbove(a))}},e.connectRightVertex=function(t,i,n){var r,a=n.Onext,o=e.regionBelow(i),s=i.eUp,l=o.eUp,c=!1;s.Dst!==l.Dst&&e.checkForIntersect(t,i),Zq.vertEq(s.Org,t.event)&&(t.mesh.splice(a.Oprev,s),i=e.topLeftRegion(t,i),a=e.regionBelow(i).eUp,e.finishLeftRegions(t,e.regionBelow(i),o),c=!0),Zq.vertEq(l.Org,t.event)&&(t.mesh.splice(n,l.Oprev),n=e.finishLeftRegions(t,o,null),c=!0),c?e.addRightEdges(t,i,n.Onext,a,a,!0):(r=Zq.vertLeq(l.Org,s.Org)?l.Oprev:s,r=t.mesh.connect(n.Lprev,r),e.addRightEdges(t,i,r,r.Onext,r.Onext,!1),r.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,i))},e.connectLeftDegenerate=function(t,i,n){var r,a,o,s,l;return r=i.eUp,Zq.vertEq(r.Org,n)?(Kq(!1),void e.spliceMergeVertices(t,r,n.anEdge)):Zq.vertEq(r.Dst,n)?(Kq(!1),i=e.topRightRegion(i),a=s=(o=(l=e.regionBelow(i)).eUp.Sym).Onext,l.fixUpperEdge&&(Kq(a!==o),e.deleteRegion(t,l),t.mesh.delete(o),o=a.Oprev),t.mesh.splice(n.anEdge,o),Zq.edgeGoesLeft(a)||(a=null),void e.addRightEdges(t,i,o.Onext,s,a,!0)):(t.mesh.splitEdge(r.Sym),i.fixUpperEdge&&(t.mesh.delete(r.Onext),i.fixUpperEdge=!1),t.mesh.splice(n.anEdge,r),void e.sweepEvent(t,n))},e.connectLeftVertex=function(t,i){var n,r,a,o,s,l,c=new aX;if(c.eUp=i.anEdge.Sym,n=t.dict.search(c).key,r=e.regionBelow(n)){if(o=n.eUp,s=r.eUp,0===Zq.edgeSign(o.Dst,i,o.Org))return void e.connectLeftDegenerate(t,n,i);if(a=Zq.vertLeq(s.Dst,o.Dst)?n:r,n.inside||a.fixUpperEdge){if(a===n)l=t.mesh.connect(i.anEdge.Sym,o.Lnext);else l=t.mesh.connect(s.Dnext,i.anEdge).Sym;a.fixUpperEdge?e.fixUpperEdge(t,a,l):e.computeWinding(t,e.addRegionBelow(t,n,l)),e.sweepEvent(t,i)}else e.addRightEdges(t,n,i.anEdge,i.anEdge,null,!0)}},e.sweepEvent=function(t,i){t.event=i,e.debugEvent(t);for(var n=i.anEdge;null===n.activeRegion;)if((n=n.Onext)===i.anEdge)return void e.connectLeftVertex(t,i);var r=e.topLeftRegion(t,n.activeRegion);Kq(null!==r);var a=e.regionBelow(r),o=a.eUp,s=e.finishLeftRegions(t,a,null);s.Onext===o?e.connectRightVertex(t,r,s):e.addRightEdges(t,r,s.Onext,o,o,!0)},e.addSentinel=function(e,t,i,n){var r=new aX,a=e.mesh.makeEdge();a.Org.s=i,a.Org.t=n,a.Dst.s=t,a.Dst.t=n,e.event=a.Dst,r.eUp=a,r.windingNumber=0,r.inside=!1,r.fixUpperEdge=!1,r.sentinel=!0,r.dirty=!1,r.nodeUp=e.dict.insert(r)},e.initEdgeDict=function(t){t.dict=new sX(t,e.edgeLeq);var i=t.bmax[0]-t.bmin[0],n=t.bmax[1]-t.bmin[1],r=t.bmin[0]-i,a=t.bmax[0]+i,o=t.bmin[1]-n,s=t.bmax[1]+n;e.addSentinel(t,r,a,o),e.addSentinel(t,r,a,s)},e.doneEdgeDict=function(t){for(var i,n=0;null!==(i=t.dict.min().key);)i.sentinel||(Kq(i.fixUpperEdge),Kq(1===++n)),Kq(0===i.windingNumber),e.deleteRegion(t,i)},e.removeDegenerateEdges=function(t){var i,n,r,a=t.mesh.eHead;for(i=a.next;i!==a;i=n)n=i.next,r=i.Lnext,Zq.vertEq(i.Org,i.Dst)&&i.Lnext.Lnext!==i&&(e.spliceMergeVertices(t,r,i),t.mesh.delete(i),r=(i=r).Lnext),r.Lnext===i&&(r!==i&&((r===n||r===n.Sym)&&(n=n.next),t.mesh.delete(r)),(i===n||i===n.Sym)&&(n=n.next),t.mesh.delete(i))},e.initPriorityQ=function(e){var t,i,n,r=0;for(i=(n=e.mesh.vHead).next;i!==n;i=i.next)r++;for(r+=8,t=e.pq=new rX(r,Zq.vertLeq),i=(n=e.mesh.vHead).next;i!==n;i=i.next)i.pqHandle=t.insert(i);return i===n&&(t.init(),!0)},e.donePriorityQ=function(e){e.pq=null},e.removeDegenerateFaces=function(t,i){var n,r,a;for(n=i.fHead.next;n!==i.fHead;n=r)r=n.next,Kq((a=n.anEdge).Lnext!==a),a.Lnext.Lnext===a&&(e.addWinding(a.Onext,a),t.mesh.delete(a));return!0},e.computeInterior=function(t,i){var n,r;if(void 0===i&&(i=!0),e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);null!==(n=t.pq.extractMin());){for(;null!==(r=t.pq.min())&&Zq.vertEq(r,n);)r=t.pq.extractMin(),e.spliceMergeVertices(t,n.anEdge,r.anEdge);e.sweepEvent(t,n)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),!!e.removeDegenerateFaces(t,t.mesh)&&(i&&t.mesh.check(),!0)},e}(),cX=function(){function e(){this.mesh=new tX,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=zq.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.prototype.normalize_=function(e){var t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(!t)throw"Zero-size vector!";t=Math.sqrt(t),e[0]/=t,e[1]/=t,e[2]/=t},e.prototype.longAxis_=function(e){var t=0;return Math.abs(e[1])>Math.abs(e[0])&&(t=1),Math.abs(e[2])>Math.abs(e[t])&&(t=2),t},e.prototype.computeNormal_=function(e){var t,i,n,r,a,o,s=[0,0,0],l=[0,0,0],c=[0,0,0],d=[0,0,0],u=[0,0,0],h=[null,null,null],p=[null,null,null],f=this.mesh.vHead;t=f.next;for(var m=0;m<3;++m)r=t.coords[m],l[m]=r,p[m]=t,s[m]=r,h[m]=t;for(t=f.next;t!==f;t=t.next)for(var g=0;g<3;++g)(r=t.coords[g])<l[g]&&(l[g]=r,p[g]=t),r>s[g]&&(s[g]=r,h[g]=t);var v=0;if(s[1]-l[1]>s[0]-l[0]&&(v=1),s[2]-l[2]>s[v]-l[v]&&(v=2),l[v]>=s[v])return e[0]=0,e[1]=0,void(e[2]=1);for(o=0,i=p[v],n=h[v],c[0]=i.coords[0]-n.coords[0],c[1]=i.coords[1]-n.coords[1],c[2]=i.coords[2]-n.coords[2],t=f.next;t!==f;t=t.next)d[0]=t.coords[0]-n.coords[0],d[1]=t.coords[1]-n.coords[1],d[2]=t.coords[2]-n.coords[2],u[0]=c[1]*d[2]-c[2]*d[1],u[1]=c[2]*d[0]-c[0]*d[2],u[2]=c[0]*d[1]-c[1]*d[0],(a=u[0]*u[0]+u[1]*u[1]+u[2]*u[2])>o&&(o=a,e[0]=u[0],e[1]=u[1],e[2]=u[2]);o<=0&&(e[0]=e[1]=e[2]=0,e[this.longAxis_(c)]=1)},e.prototype.checkOrientation_=function(){for(var e,t,i=this.mesh.fHead,n=this.mesh.vHead,r=0,a=i.next;a!==i;a=a.next)if(!((t=a.anEdge).winding<=0))do{r+=(t.Org.s-t.Dst.s)*(t.Org.t+t.Dst.t),t=t.Lnext}while(t!==a.anEdge);if(r<0){for(e=n.next;e!==n;e=e.next)e.t=-e.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var e,t,i=this.mesh.vHead,n=[0,0,0],r=!1;n[0]=this.normal[0],n[1]=this.normal[1],n[2]=this.normal[2],!n[0]&&!n[1]&&!n[2]&&(this.computeNormal_(n),r=!0),e=this.sUnit,t=this.tUnit;var a=this.longAxis_(n);e[a]=0,e[(a+1)%3]=1,e[(a+2)%3]=0,t[a]=0,t[(a+1)%3]=0,t[(a+2)%3]=n[a]>0?1:-1;for(var o=i.next;o!==i;o=o.next)o.s=this.dot_(o.coords,e),o.t=this.dot_(o.coords,t);r&&this.checkOrientation_();for(var s=!0,l=i.next;l!==i;l=l.next)s?(this.bmin[0]=this.bmax[0]=l.s,this.bmin[1]=this.bmax[1]=l.t,s=!1):(l.s<this.bmin[0]&&(this.bmin[0]=l.s),l.s>this.bmax[0]&&(this.bmax[0]=l.s),l.t<this.bmin[1]&&(this.bmin[1]=l.t),l.t>this.bmax[1]&&(this.bmax[1]=l.t))},e.prototype.addWinding_=function(e,t){e.winding+=t.winding,e.Sym.winding+=t.Sym.winding},e.prototype.tessellateMonoRegion_=function(e,t){var i,n;if((i=t.anEdge).Lnext===i||i.Lnext.Lnext===i)throw"Mono region invalid";for(;Zq.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;Zq.vertLeq(i.Org,i.Dst);i=i.Lnext);n=i.Lprev;for(;i.Lnext!==n;)if(Zq.vertLeq(i.Dst,n.Org)){for(;n.Lnext!==i&&(Zq.edgeGoesLeft(n.Lnext)||Zq.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);)n=e.connect(n.Lnext,n).Sym;n=n.Lprev}else{for(;n.Lnext!==i&&(Zq.edgeGoesRight(i.Lprev)||Zq.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)i=e.connect(i,i.Lprev).Sym;i=i.Lnext}if(n.Lnext===i)throw"Mono region invalid";for(;n.Lnext.Lnext!==i;)n=e.connect(n.Lnext,n).Sym;return!0},e.prototype.tessellateInterior_=function(e){for(var t,i=e.fHead.next;i!==e.fHead;i=t)if(t=i.next,i.inside&&!this.tessellateMonoRegion_(e,i))return!1;return!0},e.prototype.discardExterior_=function(e){for(var t,i=e.fHead.next;i!==e.fHead;i=t)t=i.next,i.inside||e.zapFace(i)},e.prototype.setWindingNumber_=function(e,t,i){for(var n,r=e.eHead.next;r!==e.eHead;r=n)n=r.next,r.Rface.inside!==r.Lface.inside?r.winding=r.Lface.inside?t:-t:i?e.delete(r):r.winding=0},e.prototype.getNeighbourFace_=function(e){return e.Rface&&e.Rface.inside?e.Rface.n:-1},e.prototype.outputPolymesh_=function(e,t,i,n){var r,a,o=0,s=0;i>3&&e.mergeConvexFaces(i);for(var l=e.vHead.next;l!==e.vHead;l=l.next)l.n=-1;for(var c=e.fHead.next;c!==e.fHead;c=c.next)if(c.n=-1,c.inside){r=c.anEdge,a=0;do{-1===(l=r.Org).n&&(l.n=s,s++),a++,r=r.Lnext}while(r!==c.anEdge);if(a>i)throw"Face vertex greater that support polygon";c.n=o,++o}this.elementCount=o,t===Bq.CONNECTED_POLYGONS&&(o*=2),this.elements=[],this.elements.length=o*i,this.vertexCount=s,this.vertices=[],this.vertices.length=s*n,this.vertexIndices=[],this.vertexIndices.length=s;for(l=e.vHead.next;l!==e.vHead;l=l.next)if(-1!==l.n){var d=l.n*n;this.vertices[d+0]=l.coords[0],this.vertices[d+1]=l.coords[1],n>2&&(this.vertices[d+2]=l.coords[2]),this.vertexIndices[l.n]=l.idx}var u=0;for(c=e.fHead.next;c!==e.fHead;c=c.next)if(c.inside){r=c.anEdge,a=0;do{l=r.Org;this.elements[u++]=l.n,a++,r=r.Lnext}while(r!==c.anEdge);for(var h=a;h<i;++h)this.elements[u++]=-1;if(t===Bq.CONNECTED_POLYGONS){r=c.anEdge;do{this.elements[u++]=this.getNeighbourFace_(r),r=r.Lnext}while(r!==c.anEdge);for(var p=a;p<i;++p)this.elements[u++]=-1}}},e.prototype.outputContours_=function(e,t){var i,n,r=0,a=0;this.vertexCount=0,this.elementCount=0;for(var o=e.fHead.next;o!==e.fHead;o=o.next)if(o.inside){n=i=o.anEdge;do{this.vertexCount++,i=i.Lnext}while(i!==n);this.elementCount++}this.elements=[],this.elements.length=2*this.elementCount,this.vertices=[],this.vertices.length=this.vertexCount*t,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var s=0,l=0,c=0;r=0;for(o=e.fHead.next;o!==e.fHead;o=o.next)if(o.inside){a=0,n=i=o.anEdge;do{this.vertices[s++]=i.Org.coords[0],this.vertices[s++]=i.Org.coords[1],t>2&&(this.vertices[s++]=i.Org.coords[2]),this.vertexIndices[l++]=this.vertexIdCallback?this.vertexIdCallback(i):i.Org.idx,a++,i=i.Lnext}while(i!==n);this.elements[c++]=r,this.elements[c++]=a,r+=a}},e.prototype.addContour=function(e,t){null===this.mesh&&(this.mesh=new tX),e<2&&(e=2),e>3&&(e=3);for(var i=null,n=0;n<t.length;n+=e)null===i?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=t[n+0],i.Org.coords[1]=t[n+1],i.Org.coords[2]=e>2?t[n+2]:0,i.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(i),i.winding=1,i.Sym.winding=-1},e.prototype.tesselate=function(e,t,i,n,r,a){if(void 0===e&&(e=zq.ODD),void 0===t&&(t=Bq.POLYGONS),void 0===a&&(a=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,r&&(this.normal[0]=r[0],this.normal[1]=r[1],this.normal[2]=r[2]),this.windingRule=e,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),lX.computeInterior(this,a);var o=this.mesh;return t===Bq.BOUNDARY_CONTOURS?this.setWindingNumber_(o,1,!0):this.tessellateInterior_(o),a&&o.check(),t===Bq.BOUNDARY_CONTOURS?this.outputContours_(o,n):this.outputPolymesh_(o,t,i,n),!0},e}();function dX(e){var t=e.windingRule,i=void 0===t?zq.ODD:t,n=e.elementType,r=void 0===n?Bq.POLYGONS:n,a=e.polySize,o=void 0===a?3:a,s=e.vertexSize,l=void 0===s?2:s,c=e.normal,d=void 0===c?[0,0,1]:c,u=e.contours,h=void 0===u?[]:u,p=e.strict,f=void 0===p||p,m=e.debug,g=void 0!==m&&m;if(!h&&f)throw new Error("Contours can't be empty");if(h){var v=new cX;e.edgeCreateCallback&&(v.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(v.vertexIdCallback=e.vertexIdCallback);for(var y=0;y<h.length;y++)v.addContour(l||2,h[y]);return v.tesselate(i,r,o,l,d,f),{vertices:v.vertices,vertexIndices:v.vertexIndices,vertexCount:v.vertexCount,elements:v.elements,elementCount:v.elementCount,mesh:g?v.mesh:void 0}}}zq.ODD,zq.NONZERO,zq.POSITIVE,zq.NEGATIVE,zq.ABS_GEQ_TWO,Bq.POLYGONS,Bq.CONNECTED_POLYGONS,Bq.BOUNDARY_CONTOURS;var uX=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log("allocating with cap ".concat(e));let i=e*uX.eSize;this.buffer=new ArrayBuffer(i);let n=Float32Array.BYTES_PER_ELEMENT,r=0;this.positions=new Float32Array(this.buffer,r*n,3*e),r+=3*e,this.normals=new Float32Array(this.buffer,r*n,3*e),r+=3*e,this.uvs=new Float32Array(this.buffer,r*n,2*e)}realloc(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log("resizing from ".concat(this.capacity," \u2192 ").concat(e));let i=e*uX.eSize,n=new ArrayBuffer(i),r=Float32Array.BYTES_PER_ELEMENT,a=0,o=new Float32Array(n,a*r,3*e);a+=3*e;let s=new Float32Array(n,a*r,3*e);a+=3*e;let l=new Float32Array(n,a*r,2*e);t?(o.set(this.positions.subarray(0,3*this.size)),s.set(this.normals.subarray(0,3*this.size)),l.set(this.uvs.subarray(0,2*this.size))):(o.set(this.positions),s.set(this.normals),l.set(this.uvs)),this.buffer=n,this.positions=o,this.normals=s,this.uvs=l,this.capacity=e}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.size+e;if(t>this.capacity){let e=this.capacity;for(;t>e;)e*=2;this.realloc(e)}let i=this.size;return this.size=t,i}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log("shrinking ".concat(this.capacity," \u2192 ").concat(this.size)),this.realloc(this.size,!0)}},hX=uX;hX.eSize=8*Float32Array.BYTES_PER_ELEMENT;var pX=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t)=>e<t?-1:e>t?1:0;if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;let e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:t,compare:i}=this,n=t[e];for(;e>0;){let r=e-1>>1,a=t[r];if(i(n,a)>=0)break;t[e]=a,e=r}t[e]=n}_down(e){let{data:t,compare:i}=this,n=this.length>>1,r=t[e];for(;e<n;){let n=1+(e<<1),a=n+1;if(a<this.length&&i(t[a],t[n])<0&&(n=a),i(t[n],r)>=0)break;t[e]=t[n],e=n}t[e]=r}};function fX(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=1/0,a=1/0,o=-1/0,s=-1/0;for(let[y,b]of e[0])y<r&&(r=y),b<a&&(a=b),y>o&&(o=y),b>s&&(s=b);let l=o-r,c=s-a,d=Math.max(i,Math.min(l,c));if(d===i){let e=[r,a];return e.distance=0,e.distance}let u=new pX([],(e,t)=>t.max-e.max),h=function(e){let t=0,i=0,n=0,r=e[0];for(let o=0,s=r.length,l=s-1;o<s;l=o++){let e=r[o],a=r[l],s=e[0]*a[1]-a[0]*e[1];i+=(e[0]+a[0])*s,n+=(e[1]+a[1])*s,t+=3*s}let a=new mX(i/t,n/t,0,e);return 0===t||a.d<0?new mX(r[0][0],r[0][1],0,e):a}(e),p=new mX(r+l/2,a+c/2,0,e);p.d>h.d&&(h=p);let f=2;function m(r,a,o){let s=new mX(r,a,o,e);if(f++,s.max>h.d+i&&u.push(s),s.d>h.d&&(h=s,n&&console.log("found best ".concat(Math.round(1e4*s.d)/1e4," after ").concat(f," probes")),h.d>t))return t}let g=d/2;for(let y=r;y<o;y+=d)for(let e=a;e<s;e+=d)m(y+g,e+g,g);for(;u.length;){let{max:e,x:t,y:n,h:r}=u.pop();if(e-h.d<=i)break;g=r/2,m(t-g,n-g,g),m(t+g,n-g,g),m(t-g,n+g,g),m(t+g,n+g,g)}n&&console.log("num probes: ".concat(f,"\nbest distance: ").concat(h.d));let v=[h.x,h.y];return v.distance=h.d,v.distance}function mX(e,t,i,n){this.x=e,this.y=t,this.h=i,this.d=function(e,t,i){let n=!1,r=1/0;for(let a of i)for(let i=0,o=a.length,s=o-1;i<o;s=i++){let o=a[i],l=a[s];o[1]>t!=l[1]>t&&e<(l[0]-o[0])*(t-o[1])/(l[1]-o[1])+o[0]&&(n=!n),r=Math.min(r,gX(e,t,o,l))}return 0===r?0:(n?1:-1)*Math.sqrt(r)}(e,t,n),this.max=this.d+this.h*Math.SQRT2}function gX(e,t,i,n){let r=i[0],a=i[1],o=n[0]-r,s=n[1]-a;if(0!==o||0!==s){let i=((e-r)*o+(t-a)*s)/(o*o+s*s);i>1?(r=n[0],a=n[1]):i>0&&(r+=o*i,a+=s*i)}return o=e-r,s=t-a,o*o+s*s}var vX={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},yX={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},bX={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},xX=(e,t)=>i=>{let[n,r]=i;return r<n&&(r+=t),(e>=n?e:e+t)<=r},wX=class extends vE{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:zq.ODD,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];super(),this.forPathBevel=o,this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._curveSegments=n,this._bevelSegmentsInput=r;let s,l,c,d=this._shape.extractShapePointsToFlatArray([],n),u=this._shape.shapeHoles.map(e=>{let t=e.extractShapePointsToFlatArray([],n),i=[];for(let n=t.length-1;n>=1;n-=2){let e=t[n-1],r=t[n-0];i.push(e,r)}return i}),h=[],p=[];for(let T=0;T<d.length;T+=2)p.push([d[T],d[T+1]]);h.push(p);for(let T=0;T<u.length;T++){let e=u[T],t=[];for(let i=0;i<e.length;i+=2)t.push([e[i],e[i+1]]);h.push(t)}s=e.isText?.1*(new CO).setFromPoints(e.points.map(e=>e.position)).getSize(new p_).length():0===h[0].length?i:i>0?fX(h,i):1e-5,i<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(i,s,t/2),this._bevelSegments=Math.floor(r));try{l=dX({windingRule:a,elementType:Bq.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[d]})}catch(E){l=vX}try{c=dX({windingRule:zq.ODD,elementType:Bq.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...u]})}catch(A){c=yX}if(!l)throw new Error("error generating geometry");let f=l.elementCount;if(c){l.elementCount+=c.elementCount;for(let e=0;e<c.elements.length;e++){let t=c.elements[e],i=e%2===0?l.vertexCount:0;l.elements.push(t+i)}for(let e=0;e<c.vertexIndices.length;e++){let t=c.vertexIndices[e],i=l.vertexCount;l.vertexIndices.push(t+i)}for(let e=0;e<c.vertices.length;e++){let t=c.vertices[e];l.vertices.push(t)}}let m=1/0,g=-1/0,v=1/0,y=-1/0;for(let T=0,P=l.vertexCount;T<P;T++){let e=2*T,t=l.vertices[e+0],i=l.vertices[e+1];t<m&&(m=t),t>g&&(g=t),i<v&&(v=i),i>y&&(y=i)}this._minX=m,this._minY=v,this._width=g-m,this._height=y-v,this._buffer=new hX(this._computeBufferEstimatedSize(l));let b=[],x=[];for(let T=l.elementCount-1;T>=0;T--){let e=T>=f,t=2*T,i=l.elements[t+0],r=l.elements[t+1],a=i+r,c={start:i,count:r,normals:[],continuous:[],concave:[]},d=i,h=a-1,p=i+1,m=this._shape.roundedCurves.length;do{let t=d-i,n=l.vertices[2*h+0],o=l.vertices[2*h+1],s=l.vertices[2*d+0],u=l.vertices[2*d+1],f=l.vertices[2*p+0],g=l.vertices[2*p+1],v=s-n,y=u-o,b=Math.sqrt(v*v+y*y);v/=b,y/=b;let x=s-f,w=u-g,S=Math.sqrt(x*x+w*w);x/=S,w/=S,c.normals[2*t+0]=-w,c.normals[2*t+1]=x,c.concave[t]=v*w-y*x>0;let _=l.vertexIndices[d];if(Array.isArray(_))c.continuous[t]=!1;else{let[e,i]=this._shape.getCurveIndexFromVertexId(_-1,!0);if(i>0&&i<1)c.continuous[t]=!0;else{let n=1===i?e+1:e-1;n=(n+m)%m;let r=1===i?0:1,a=this._shape.roundedCurves[e].getTangent(i),o=this._shape.roundedCurves[n].getTangent(r);c.continuous[t]=a.dot(o)>.95}}e&&(c.normals[2*t+0]*=-1,c.normals[2*t+1]*=-1),[h,d,p]=[d,p,p+1],p>=a&&(p-=r)}while(p!==i+1);let g=[];g.push({bevelI:0,angle:0,size:0,boundary:{vertices:l.vertices.slice(2*i,2*a),vertexCount:r,vertexIndices:new Array(r).fill(!0).map((e,t)=>[t,t]),elements:[0,r],elementCount:1,mesh:null},reverseMap:[],insetPoints:l.vertices.slice(2*i,2*a)});let v=0;for(let o=1;o<=this._bevelSegments;o++){let t=o/this._bevelSegments*Math.PI/2,i=(1-Math.cos(t))*this._bevel,a=[],s=[],d=[],u=[],h=0;for(let o=0;o<r;o++){let t=2*o,p=(o-1+r)%r*2,f=l.vertices[2*c.start+t+0],m=l.vertices[2*c.start+t+1],g=-c.normals[p+0]*i,v=-c.normals[p+1]*i,y=-c.normals[t+0]*i,b=-c.normals[t+1]*i;if(c.concave[o]||!c.concave[o]&&e){let t=Math.atan2(v,g),r=Math.atan2(b,y);r>t&&(r-=2*Math.PI);let s=r-t;if(c.continuous[o]||e){let n=t+s/2,r=Math.cos(n)*i,l=Math.sin(n)*i;a[2*h+0]=f+r*(e?-1:1),a[2*h+1]=m+l*(e?-1:1),u[h]=o,h++}else{let e=Math.max(1,Math.floor(n/4*Math.abs(s)/Math.PI));for(let n=0;n<=e;n++){let r=t+s*(n/e),l=Math.cos(r)*i,c=Math.sin(r)*i;a[2*h+0]=f+l,a[2*h+1]=m+c,u[h]=o,h++}}}else a[2*h+0]=f+g,a[2*h+1]=m+v,u[h]=o,s[o]=h,h++,a[2*h+0]=f,a[2*h+1]=m,u[h]=o,h++,a[2*h+0]=f+y,a[2*h+1]=m+b,u[h]=o,d[o]=h,h++}let p=dX({windingRule:zq.POSITIVE,elementType:Bq.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[a],edgeCreateCallback:e=>{let t=e.Org.idx,i=u[t],n=u[(t+1)%u.length];e.idx=[i,n],e.Sym.idx=[n,i]},vertexIdCallback:e=>{let t=e.Lprev.idx;return[t?t[1]:0,e.idx?e.idx[0]:0]}});if(!p)throw console.log("Error"),new Error("error generating bevel geometry for ".concat(o,"'th loop"));if(!p.vertexCount){let e=(o-1)/this._bevelSegments*Math.PI/2;v=(1-Math.sin(e))*this._bevel;break}for(let e=0;e<p.vertexIndices.length;e++){let[t,i]=p.vertexIndices[e];if(t===i)continue;let n=i;i<t&&(n+=r);for(let a=t;a<n;a++){let n=a%r,o=(a+1)%r;if(!c.continuous[n]||!c.continuous[o]){p.vertexIndices[e]=[t,n],p.vertexIndices.splice(e+1,0,[o,i]),p.vertices.splice(2*(e+1),0,p.vertices[2*e],p.vertices[2*e+1]);break}}}g.push({bevelI:o,angle:t,size:i,boundary:p,reverseMap:u,insetPoints:a})}let y=(e,t,i)=>{let n=0,r=e.boundary.vertexIndices.length;for(;n<r&&i(e.boundary.vertexIndices[t]);)t=(t+1)%r,n++;return n},w=b.length;for(let n=1;n<g.length;n++){let e=g[n-1],t=g[n],i=e.boundary.vertexIndices.length,a=t.boundary.vertexIndices.length;if(!i||!a)break;let s=c.concave.length,l=0,d=xX(l,r);for(;!e.boundary.vertexIndices.filter(d).length||!t.boundary.vertexIndices.filter(d).length;)l++,d=xX(l,r);let u=e.boundary.vertexIndices.findIndex(d),h=t.boundary.vertexIndices.findIndex(d);do{u=(u+1)%i}while(d(e.boundary.vertexIndices[u]));do{h=(h+1)%a}while(d(t.boundary.vertexIndices[h]));l=(l+1)%r;let p,f,m=l,v=0,x=this._buildBevelVert(c,e,(u-1+i)%i,void 0,v),w=this._buildBevelVert(c,t,(h-1+a)%a,void 0,v),S=!1;do{v=(l||s)/s,d=xX(l,r);let n=y(e,u,d),m=y(t,h,d),g=S;if(S=!1,n&&!m){for(let t=0;t<n;t++)p=this._buildBevelVert(c,e,(u+t)%i,t/(n-1),v),b.push(x.topN,p.topP,w.topN),!1===o&&b.push(p.bottomP,x.bottomN,w.bottomN),x=p;S=!0}else if(!n&&m)for(let e=0;e<m;e++)f=this._buildBevelVert(c,t,(h+e)%a,e/(m-1),v),b.push(w.topN,x.topP,f.topP),!1===o&&b.push(x.bottomP,w.bottomN,f.bottomP),w=f;else if(n&&m)if(p=this._buildBevelVert(c,e,u,0,v),f=this._buildBevelVert(c,t,h,0,v),g?(b.push(x.topN,f.topP,w.topN),b.push(x.topN,p.topP,f.topP),!1===o&&(b.push(f.bottomP,x.bottomN,w.bottomN),b.push(f.bottomP,p.bottomP,x.bottomN))):(b.push(w.topN,x.topN,p.topP),b.push(w.topN,p.topP,f.topP),!1===o&&(b.push(p.bottomP,x.bottomN,w.bottomN),b.push(p.bottomP,w.bottomN,f.bottomP))),x=p,w=f,n===m)for(let r=1;r<n;r++)p=this._buildBevelVert(c,e,(u+r)%i,r/(n-1),v),f=this._buildBevelVert(c,t,(h+r)%a,r/(m-1),v),b.push(x.topN,p.topP,w.topN),b.push(w.topN,p.topP,f.topP),!1===o&&(b.push(p.bottomP,x.bottomN,w.bottomN),b.push(p.bottomP,w.bottomN,f.bottomP)),x=p,w=f;else if(n>m){let r=n/m,s=0;for(let l=1;l<n;l++)p=this._buildBevelVert(c,e,(u+l)%i,l/(n-1),v),b.push(x.topN,p.topP,w.topN),!1===o&&b.push(p.bottomP,x.bottomN,w.bottomN),x=p,l>(s+1)*r&&(s++,f=this._buildBevelVert(c,t,(h+s)%a,s/(m-1),v),b.push(w.topN,p.topP,f.topP),!1===o&&b.push(p.bottomP,w.bottomN,f.bottomP),w=f)}else{let r=m/n,s=0;for(let l=1;l<m;l++)f=this._buildBevelVert(c,t,(h+l)%a,l/(m-1),v),b.push(w.topN,p.topP,f.topP),!1===o&&b.push(p.bottomP,w.bottomN,f.bottomP),w=f,l>(s+1)*r&&(s++,p=this._buildBevelVert(c,e,(u+s)%i,s/(n-1),v),b.push(x.topN,p.topP,w.topN),!1===o&&b.push(p.bottomP,x.bottomN,w.bottomN),x=p)}u=(u+n)%i,h=(h+m)%a,l=(l+1)%s}while(l!==m)}if(!1===o&&this._depth>2*this._bevel&&this._buildWall(g,c,b),e){let e=[];for(let t=b.length-1;t>=w+2;t-=3){let i=b[t-2],n=b[t-1],r=b[t-0];e.push(r,n,i)}b.splice(w,b.length-w,...e)}if(e){let e=[];for(let t=g[g.length-1].boundary.vertices.length-1;t>=1;t-=2){let i=g[g.length-1].boundary.vertices[t-1],n=g[g.length-1].boundary.vertices[t-0];e.push(i,n)}x.push(e)}if(!e){let e,t=g[g.length-1];try{e=dX({windingRule:g.length>1?zq.POSITIVE:zq.ODD,elementType:Bq.POLYGONS,vertexSize:2,strict:!0,contours:[t.insetPoints,...x]})}catch(M){e=bX}if(!e)throw new Error("Error generating geometry for surface");0===u.length&&this._bevel<s&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let i=0;i<3*e.elementCount;i+=3){let t=this._buildSurfaceVert(e,e.elements[i+0],v),n=this._buildSurfaceVert(e,e.elements[i+1],v),r=this._buildSurfaceVert(e,e.elements[i+2],v);b.push(t.top,n.top,r.top),!1===o&&b.push(r.bottom,n.bottom,t.bottom)}}this.vertexCache={}}this._buffer.shrink();let w=new oE(Uint32Array.from(b),1),S=new oE(this._buffer.positions,3),_=new oE(this._buffer.normals,3),C=new oE(this._buffer.uvs,2);S.needsUpdate=!0,_.needsUpdate=!0,C.needsUpdate=!0,w.needsUpdate=!0,this.setAttribute("position",S),this.setAttribute("normal",_),this.setAttribute("uv",C),this.setIndex(w)}_computeBufferEstimatedSize(e){return 2*e.vertexCount*(2+this._bevelSegments)}_buildWall(e,t,i){let n=e[0];for(let r=0,a=n.boundary.vertexCount;r<a;r++){let e=this._buildBevelVert(t,n,r),o=this._buildBevelVert(t,n,(r+1)%a);i.push(o.topP,e.topN,e.bottomN),i.push(o.topP,e.bottomN,o.bottomP)}}_buildSurfaceVert(e,t,i){let n=t.toString();if(n in this.vertexCache)return this.vertexCache[n];let r=e.vertices[2*t+0],a=e.vertices[2*t+1],o=(r-this._minX)/this._width,s=(a-this._minY)/this._height;this.forPathBevel&&(s=1);let l=this._buffer.get(this.forPathBevel?1:2),c=3*l,d=2*l,u={top:l+0,bottom:l+1};return this._buffer.positions[c+0]=r,this._buffer.positions[c+1]=a,this._buffer.positions[c+2]=this.forPathBevel?this._bevel:this._depth-i,this._buffer.normals[c+0]=0,this._buffer.normals[c+1]=0,this._buffer.normals[c+2]=1,this._buffer.uvs[d+0]=o,this._buffer.uvs[d+1]=s,!1===this.forPathBevel&&(this._buffer.positions[c+3]=r,this._buffer.positions[c+4]=a,this._buffer.positions[c+5]=i,this._buffer.normals[c+3]=0,this._buffer.normals[c+4]=0,this._buffer.normals[c+5]=-1,this._buffer.uvs[d+2]=o,this._buffer.uvs[d+3]=s),this.vertexCache[n]=u,u}_buildBevelVert(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4?arguments[4]:void 0,a="".concat(t.bevelI,":").concat(i);if(a in this.vertexCache&&0!==r&&1!==r&&(!r||r===this.vertexCache[a].pathBevelUCoord))return this.vertexCache[a];let o,s,l,c,[d,u]=t.boundary.vertexIndices[i];d!==u?(s=d,o=u,c=!1,l=e.continuous[s]&&e.continuous[o]):(o=d,s=(o-1+e.count)%e.count,c=e.concave[o]&&t.bevelI>0,l=e.continuous[o]||c);let h=Math.cos(t.angle),p=Math.sin(t.angle),f=2*i,m=2*o,g=2*s,v=t.boundary.vertices[f+0],y=t.boundary.vertices[f+1],b=(1-p)*this._bevel,x=(v-this._minX)/this._width,w=(y-this._minY)/this._height;this.forPathBevel&&(void 0!==r&&(x=r),w=1);let S=e.normals[m+0],_=e.normals[m+1],C=e.normals[g+0],E=e.normals[g+1];if(c){S+=(C-S)*(1-n),_+=(E-_)*(1-n);let e=Math.sqrt(S*S+_*_);S/=e,_/=e}let A=this.forPathBevel?this._buffer.get(l?1:2):this._buffer.get(l?2:4),M=3*A,T=2*A,P={i:i,fi:o,topP:A+0,topN:A+0,bottomP:A+1,bottomN:A+1,pathBevelUCoord:r};return this._buffer.positions[M+0]=v,this._buffer.positions[M+1]=y,this._buffer.positions[M+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[M+0]=S*h,this._buffer.normals[M+1]=_*h,this._buffer.normals[M+2]=p,this._buffer.uvs[T+0]=x,this._buffer.uvs[T+1]=w,!1===this.forPathBevel&&(this._buffer.positions[M+3]=v,this._buffer.positions[M+4]=y,this._buffer.positions[M+5]=b,this._buffer.normals[M+3]=S*h,this._buffer.normals[M+4]=_*h,this._buffer.normals[M+5]=-p,this._buffer.uvs[T+2]=w,this._buffer.uvs[T+3]=x),l||(this.forPathBevel?(A+=1,M+=3,T+=2):(A+=2,M+=6,T+=4),P.topP=A+0,P.bottomP=A+1,this._buffer.positions[M+0]=v,this._buffer.positions[M+1]=y,this._buffer.positions[M+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[M+0]=C*h,this._buffer.normals[M+1]=E*h,this._buffer.normals[M+2]=p,this._buffer.uvs[T+0]=x,this._buffer.uvs[T+1]=w,!1===this.forPathBevel&&(this._buffer.positions[M+3]=v,this._buffer.positions[M+4]=y,this._buffer.positions[M+5]=b,this._buffer.normals[M+3]=C*h,this._buffer.normals[M+4]=E*h,this._buffer.normals[M+5]=-p,this._buffer.uvs[T+2]=w,this._buffer.uvs[T+3]=x)),this.vertexCache[a]=P,P}clone(){let e=new wX(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=lB(this.userData),e}},SX=class extends vE{constructor(e){var t,i,n,r,a,o;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.type="ShapeGeometry",this.windingRule=zq.ODD,this.elementType=Bq.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=s,this._triangulationOptions=Object.assign({windingRule:zq.ODD,elementType:Bq.POLYGONS,polySize:3,vertexSize:2,strict:!0},l);let c,d,u,h=this._shape.extractShapePointsToFlatArray([],this._curveSegments),p=this._shape.shapeHoles.map(e=>e.extractShapePointsToFlatArray([],this._curveSegments)),f=!0,m=!0;for(let b=0,x=h.length/2;b<x;b++){let e=2*b,t=h[e+0],i=h[e+1];if(void 0!==d&&t!==d&&(f=!1),void 0!==u&&i!==u&&(m=!1),d=t,u=i,!f&&!m)break}if(!f&&!m)try{c=dX({contours:[h,...p],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch(y){c=vX}let g=null!==(t=null===(i=c)||void 0===i?void 0:i.vertexCount)&&void 0!==t?t:1,v=null!==(n=null===(r=c)||void 0===r?void 0:r.elementCount)&&void 0!==n?n:1;if(this._positionAttribute=new oE(new Float32Array(3*g),3),this._normalAttribute=new oE(new Float32Array(3*g),3),this._uvAttribute=new oE(new Float32Array(2*g),2),this._indexAttribute=new oE(new Uint32Array(3*v),1),c){let e=1/0,t=-1/0,i=1/0,n=-1/0;for(let o=0,s=g;o<s;o++){let r=2*o,a=c.vertices[r+0],s=c.vertices[r+1];a<e&&(e=a),a>t&&(t=a),s<i&&(i=s),s>n&&(n=s)}let r=t-e,a=n-i;for(let o=0,s=g;o<s;o++){let t=2*o,n=c.vertices[t+0],s=c.vertices[t+1],l=(n-e)/r,d=(s-i)/a;this._positionAttribute.setXYZ(o,n,s,0),this._normalAttribute.setXYZ(o,0,0,1),this._uvAttribute.setXY(o,l,d)}for(let o=0,s=v;o<s;o++){let e=3*o,t=c.elements[e+0],i=c.elements[e+1],n=c.elements[e+2];this._indexAttribute.setX(e+0,t),this._indexAttribute.setX(e+1,i),this._indexAttribute.setX(e+2,n)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,3*(null!==(a=null===(o=c)||void 0===o?void 0:o.elementCount)&&void 0!==a?a:1))}clone(){let e=new SX(this._shape,this._curveSegments);return e.userData=lB(this.userData),e}},_X=class extends wX{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,arguments.length>5&&void 0!==arguments[5]?arguments[5]:zq.ODD),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return 2*e.vertexCount*(2+this._bevelSegments)}_buildWall(e,t,i){let n=e[0];for(let r=0,a=n.boundary.vertexCount;r<a;r++){let e=this._buildBevelVert(t,n,r),o=this._buildBevelVert(t,n,(r+1)%a);i.push(o.topP,e.topN,e.bottomN),i.push(o.topP,e.bottomN,o.bottomP)}}clone(){let e=new _X(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=lB(this.userData),e}},CX=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r,a,o,s,l,c;let d=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:zq.ODD},e.parameters),u=Math.abs(d.width),h=Math.abs(null!==(n=d.height)&&void 0!==n?n:d.width),p=Math.abs(null!==(r=d.depth)&&void 0!==r?r:0),f=null!==(a=e.shape)&&void 0!==a?a:null===t||void 0===t?void 0:t.shape,m=null!==(o=null===(s=f)||void 0===s?void 0:s.roundness)&&void 0!==o?o:d.roundness;void 0!==f&&(f instanceof Hq?(f.width!==u||f.height!==h)&&f.applySize(u,h):f=new Hq(u,h).fromJSON(f),void 0!==(null===(l=e.parameters)||void 0===l?void 0:l.roundness)&&(null===(c=e.parameters)||void 0===c?void 0:c.roundness)>0&&f.update());let g=null!==f&&void 0!==f?f:new Hq(u,h);return{parameters:Object.assign(d,{width:u,height:h,depth:p,roundness:m}),shape:g}}static build(e){let t,{depth:i,extrudeBevelSize:n,extrudeBevelSegments:r,subdivisions:a,roundness:o,windingRule:s}=e.parameters;return e.shape.roundness=o,t=i<=0?new SX(e.shape,a,{windingRule:s}):new _X(e.shape,i,n,a,r,s),Object.assign(t,{userData:c(c({},e),{},{type:"VectorGeometry"})})}},EX=2*Math.PI,AX=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r;let a=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return a.angle=h_.clamp(a.angle,0,360),{shape:e.shape&&e.shape instanceof Hq?e.shape:new Hq,parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(n=a.height)&&void 0!==n?n:a.width),depth:Math.abs(null!==(r=a.depth)&&void 0!==r?r:0)})}}static build(e){let t,{width:i,height:n,spikes:r,angle:a,innerRadius:o,depth:s,extrudeBevelSize:l,extrudeBevelSegments:d}=e.parameters,u=e.shape,h=function(e,t,i,n,r,a){if(n>=EX)return r>30||r%4===0?(function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=.5522847498,s=t*o,l=i*o;e.addPoint(PX(r-t,a,r-t,a-l,r-t,a+l)),e.addPoint(PX(r,a+i,r-s,a+i,r+s,a+i)),e.addPoint(PX(r+t,a,r+t,a+l,r+t,a-l)),e.addPoint(PX(r,a-i,r+s,a-i,r-s,a-i)),n>0&&OX(e,t,i,n)}(e,t,i,a),Math.round(r/4)):MX(e,n,r,t,i,a);n=Math.max(n,.001);let o={x:0,y:i},s=n+.5*Math.PI,l={x:Math.cos(s)*t,y:Math.sin(s)*i},c=Qq({px:o.x,py:o.y,cx:l.x,cy:l.y,rx:t,ry:i,largeArcFlag:n>Math.PI,sweepFlag:!0});return r>30||r%c.length===0?function(e,t,i,n,r,a,o,s){let l=Math.round(r/n.length);e.addPoint(TX(t,i));for(let c=0,d=n.length;c<d;c++){let t=n[c],i=e.points[c],r=TX(t.x,t.y);i.controls[1].position.set(t.x1,t.y1),r.controls[0].position.set(t.x2,t.y2),e.addPoint(r)}return s>0?DX(e,a,o,s):e.addPoint(TX(0,0)),l}(e,o.x,o.y,c,r,t,i,a):MX(e,n,r,t,i,a)}(u,.5*i,.5*n,a*Math.PI/180,r,o);return u.isClosed=!0,u.update(),0===a?(t=new vE,t.setAttribute("position",new cE([],3))):t=CX.create({shape:u,parameters:{subdivisions:h,depth:s,extrudeBevelSize:l,extrudeBevelSegments:d}}),Object.assign(t,{userData:c(c({},e),{},{type:"EllipseGeometry"})})}};function MX(e,t,i,n,r,a){let o=-t/i;for(let s=0;s<=i;s++){let t=o*s,i=Math.sin(t)*n,a=Math.cos(t)*r;e.addPoint(TX(i,a))}return t<EX?a>0?DX(e,n,r,a):e.addPoint(TX(0,0)):(e.removePoint(e.points[e.points.length-1]),a>0&&OX(e,n,r,a)),1}function TX(e,t){return new dq(h_.generateUUID(),new p_(e,t))}function PX(e,t,i,n,r,a){let o=TX(e,t);return o.controls[0].position.set(i,n),o.controls[1].position.set(r,a),o}function DX(e,t,i,n){IX(e,t,i,n).forEach(t=>e.addPoint(t))}function OX(e,t,i,n){let r=IX(e,t,i,n),a=new Hq;r.forEach(e=>a.addPoint(e)),a.isClosed=!0,e.shapeHoles.push(a)}function IX(e,t,i,n){let r=n*t/100,a=r*(Math.abs(i)/Math.abs(t)),o=new p_(r/t,a/i),s=e.points.map(e=>{let t=e.clone();return t.uuid=h_.generateUUID(),t}).reverse();return s.forEach(e=>{e.position.multiply(o);let t=e.controls[0].position.clone().multiply(o),i=e.controls[1].position.clone().multiply(o);e.controls[0].position.copy(i),e.controls[1].position.copy(t)}),s}var kX=new lE([0,0,0],1),RX=class extends vE{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,o=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,s=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,l=arguments.length>11&&void 0!==arguments[11]?arguments[11]:1;if(super(),0===n)return;let c=e&&1===n;c&&(l=0),s>100&&(s=100),0===s&&(l=0);let d,u,h,p,f,m,g,v,y=()=>new j_,b=new j_,x=y(),w=y(),S=y(),_=y(),C=y(),E=y(),A=y(),M=y(),T=y(),P=y(),D=y(),O=t-2*a+.001,I=O/n,k=Math.ceil(r*n),R=k+1,z=O/k,L=-O/2,B=o+1,N=2*Math.PI/o,F=Math.PI/2/l,U=Math.min((1-s/100)*a,a-.01),V=a-U,j=0,W=2*l+2,H=B*W/2,G=H+B*R,q=Math.max(0,B*(R+W)),[X,Y,Q]=[3,3,2].map(e=>Array(q*e).fill(0)),K=[],Z=i-a;function J(t,i){let n=Math.PI/2;m=i*z,v=2*Math.PI*(m%I)/I+n,m+=L,g=Math.sin(v)*Z,f=Math.cos(v)*Z,e?t.set(f,g,m):t.set(f,m,g)}J(b,-1e-10),J(x,0),_.copy(b),J(b,1);let $=b.distanceTo(x),ee=c?0:V+U,te=$*k+2*ee,ie=U,ne=te-ee;for(let se=0;se<=k;se++){J(w,se),D.subVectors(w,_).normalize(),_.copy(w),T.copy(w).setComponent(+e+1,0).normalize(),P.crossVectors(D,T).normalize();let t=0===se,i=se===k,n=t?3*Math.PI/2:F,r=t?ie:ne,s=t?B:G,d=t?0:q-B,u=D.clone().multiplyScalar(t?-V:V).add(w),h=D.clone().multiplyScalar(t?-1:1).normalize();for(let e=0;e<B;e++){let p=e*N;if(C.addVectors(b.copy(T).multiplyScalar(a*Math.cos(p)),x.copy(P).multiplyScalar(a*Math.sin(p))),E.copy(C).normalize(),t||i){c||(j=d+e,[0,1,2].forEach(e=>{X[3*j+e]=u.getComponent(e),Y[3*j+e]=h.getComponent(e)}),Q[2*j]=+i,Q[2*j+1]=e/o),x.copy(E).multiplyScalar(U),S.addVectors(w,x);for(let i=0;i<l;i++){let a=i*F+n;A.addVectors(b.copy(D).multiplyScalar(V*Math.sin(a)),x.copy(E).multiplyScalar(V*Math.cos(a))),M.copy(A).normalize(),x.addVectors(S,A),A.normalize(),j=s+i*B+e,[0,1,2].forEach(e=>{X[3*j+e]=x.getComponent(e),Y[3*j+e]=M.getComponent(e)});let l=+t+Math.sin(a);Q[2*j]=(r+V*l)/te,Q[2*j+1]=e/o}}x.addVectors(w,C),j=H+se*B+e,[0,1,2].forEach(e=>{X[3*j+e]=x.getComponent(e),Y[3*j+e]=E.getComponent(e)}),Q[2*j]=(ee+se*$)/te,Q[2*j+1]=e/o}}let re=R+2*l+2,[ae,oe]=[+c,re-1];for(let se=ae;se<=oe-1;se++){let e=c&&se===oe-1;for(let t=0;t<B-1;t++)d=se*B+t,u=d+1,h=(e?t:d)+B,p=(e?t+1:u)+B,0===se?K.push(u,p,h):se===re-2?K.push(d,u,h):K.push(d,u,h,u,p,h)}this.setIndex(K),this.setAttribute("position",new cE(X,3)),this.setAttribute("normal",new cE(Y,3)),this.setAttribute("uv",new cE(Q,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e,t,i,n,r=this.userData.parameters,a=Math.ceil(r.tubularSegments),o=r.radialSegments+1,s=Array.from(this.getIndex().array),l=6*(a-1)*r.radialSegments,c=a,d=c===a;for(let u=0;u<r.radialSegments;u++)e=c*o+u,t=e+1,i=(d?u:e)+o,n=(d?u+1:t)+o,s[l++]=e,s[l++]=t,s[l++]=i,s[l++]=t,s[l++]=n,s[l++]=i;return s.length=l,kX.array=s,kX.count=s.length,kX}},zX=class extends aq{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=(1+Math.sqrt(5))/2,r="IcosahedronGeometry";super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],r,e,t,i),this.type=r}static fromJSON(e){return new zX(e.radius,e.corner,e.cornerSides)}},LX=new yC,BX=new WC,NX=new j_,FX=class extends JS{constructor(){super(),this.uuid=h_.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=(new f_).getNormalMatrix(e);for(let i=0,n=this.vertices.length;i<n;i++)this.vertices[i].applyMatrix4(e);for(let i=0,n=this.faces.length;i<n;i++){let e=this.faces[i];e.normal.applyMatrix3(t).normalize();for(let i=0,n=e.vertexNormals.length;i<n;i++)e.vertexNormals[i].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return LX.makeRotationX(e),this.applyMatrix4(LX),this}rotateY(e){return LX.makeRotationY(e),this.applyMatrix4(LX),this}rotateZ(e){return LX.makeRotationZ(e),this.applyMatrix4(LX),this}translate(e,t,i){return LX.makeTranslation(e,t,i),this.applyMatrix4(LX),this}scale(e,t,i){return LX.makeScale(e,t,i),this.applyMatrix4(LX),this}lookAt(e){return BX.lookAt(e),BX.updateMatrix(),this.applyMatrix4(BX.matrix),this}fromBufferGeometry(e){let t=this,i=null!==e.index?e.index:void 0,n=e.attributes;if(void 0===n.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let r=n.position,a=n.normal,o=n.color,s=n.uv,l=n.uv2;void 0!==l&&(this.faceVertexUvs[1]=[]);for(let u=0;u<r.count;u++)t.vertices.push((new j_).fromBufferAttribute(r,u)),void 0!==o&&t.colors.push((new D_).fromBufferAttribute(o,u));function c(e,i,n,r){let c=void 0===o?[]:[t.colors[e].clone(),t.colors[i].clone(),t.colors[n].clone()],d=void 0===a?[]:[(new j_).fromBufferAttribute(a,e),(new j_).fromBufferAttribute(a,i),(new j_).fromBufferAttribute(a,n)],u=new VX(e,i,n,d,c,r);t.faces.push(u),void 0!==s&&t.faceVertexUvs[0].push([(new p_).fromBufferAttribute(s,e),(new p_).fromBufferAttribute(s,i),(new p_).fromBufferAttribute(s,n)]),void 0!==l&&t.faceVertexUvs[1].push([(new p_).fromBufferAttribute(l,e),(new p_).fromBufferAttribute(l,i),(new p_).fromBufferAttribute(l,n)])}let d=e.groups;if(d.length>0)for(let u=0;u<d.length;u++){let e=d[u],t=e.start;for(let n=t,r=t+e.count;n<r;n+=3)void 0!==i?c(i.getX(n),i.getX(n+1),i.getX(n+2),e.materialIndex):c(n,n+1,n+2,e.materialIndex)}else if(void 0!==i)for(let u=0;u<i.count;u+=3)c(i.getX(u),i.getX(u+1),i.getX(u+2));else for(let u=0;u<r.count;u+=3)c(u,u+1,u+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(NX).negate(),this.translate(NX.x,NX.y,NX.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,i=0===t?1:1/t,n=new yC;return n.set(i,0,0,-i*e.x,0,i,0,-i*e.y,0,0,i,-i*e.z,0,0,0,1),this.applyMatrix4(n),this}computeFaceNormals(){let e=new j_,t=new j_;for(let i=0,n=this.faces.length;i<n;i++){let n=this.faces[i],r=this.vertices[n.a],a=this.vertices[n.b],o=this.vertices[n.c];e.subVectors(o,a),t.subVectors(r,a),e.cross(t),e.normalize(),n.normal.copy(e)}}computeVertexNormals(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=new Array(this.vertices.length);for(let i=0,n=this.vertices.length;i<n;i++)t[i]=new j_;if(e){let e=new j_,i=new j_;for(let n=0,r=this.faces.length;n<r;n++){let r=this.faces[n],a=this.vertices[r.a],o=this.vertices[r.b],s=this.vertices[r.c];e.subVectors(s,o),i.subVectors(a,o),e.cross(i),t[r.a].add(e),t[r.b].add(e),t[r.c].add(e)}}else{this.computeFaceNormals();for(let e=0,i=this.faces.length;e<i;e++){let i=this.faces[e];t[i.a].add(i.normal),t[i.b].add(i.normal),t[i.c].add(i.normal)}}for(let i=0,n=this.vertices.length;i<n;i++)t[i].normalize();for(let i=0,n=this.faces.length;i<n;i++){let e=this.faces[i],n=e.vertexNormals;3===n.length?(n[0].copy(t[e.a]),n[1].copy(t[e.b]),n[2].copy(t[e.c])):(n[0]=t[e.a].clone(),n[1]=t[e.b].clone(),n[2]=t[e.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let t=this.faces[e],i=t.vertexNormals;3===i.length?(i[0].copy(t.normal),i[1].copy(t.normal),i[2].copy(t.normal)):(i[0]=t.normal.clone(),i[1]=t.normal.clone(),i[2]=t.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,i=this.faces.length;t<i;t++){let e=this.faces[t];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]);for(let t=0,i=e.vertexNormals.length;t<i;t++)e.__originalVertexNormals[t]?e.__originalVertexNormals[t].copy(e.vertexNormals[t]):e.__originalVertexNormals[t]=e.vertexNormals[t].clone()}let e=new FX;e.faces=this.faces;for(let t=0,i=this.morphTargets.length;t<i;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let e=this.morphNormals[t].faceNormals,i=this.morphNormals[t].vertexNormals;for(let t=0,n=this.faces.length;t<n;t++){let t=new j_,n={a:new j_,b:new j_,c:new j_};e.push(t),i.push(n)}}let i=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let e=0,t=this.faces.length;e<t;e++){let t=this.faces[e],n=i.faceNormals[e],r=i.vertexNormals[e];n.copy(t.normal),r.a.copy(t.vertexNormals[0]),r.b.copy(t.vertexNormals[1]),r.c.copy(t.vertexNormals[2])}}for(let t=0,i=this.faces.length;t<i;t++){let e=this.faces[t];e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals}}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new G_),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new cC),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||!e.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);let n,r=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,l=e.faces,c=this.colors,d=e.colors;void 0!==t&&(n=(new f_).getNormalMatrix(t));for(let u=0,h=o.length;u<h;u++){let e=o[u].clone();void 0!==t&&e.applyMatrix4(t),a.push(e)}for(let u=0,h=d.length;u<h;u++)c.push(d[u].clone());for(let u=0,h=l.length;u<h;u++){let e,t,a=l[u],o=a.vertexNormals,c=a.vertexColors,d=new VX(a.a+r,a.b+r,a.c+r);d.normal.copy(a.normal),void 0!==n&&d.normal.applyMatrix3(n).normalize();for(let i=0,r=o.length;i<r;i++)e=o[i].clone(),void 0!==n&&e.applyMatrix3(n).normalize(),d.vertexNormals.push(e);d.color.copy(a.color);for(let i=0,n=c.length;i<n;i++)t=c[i],d.vertexColors.push(t.clone());d.materialIndex=a.materialIndex+i,s.push(d)}for(let u=0,h=e.faceVertexUvs.length;u<h;u++){let t=e.faceVertexUvs[u];void 0===this.faceVertexUvs[u]&&(this.faceVertexUvs[u]=[]);for(let e=0,i=t.length;e<i;e++){let i=t[e],n=[];for(let e=0,t=i.length;e<t;e++)n.push(i[e].clone());this.faceVertexUvs[u].push(n)}}}mergeMesh(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)}mergeVertices(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,t={},i=[],n=[],r=Math.pow(10,e);for(let s=0,l=this.vertices.length;s<l;s++){let e=this.vertices[s],a=Math.round(e.x*r)+"_"+Math.round(e.y*r)+"_"+Math.round(e.z*r);void 0===t[a]?(t[a]=s,i.push(this.vertices[s]),n[s]=i.length-1):n[s]=n[t[a]]}let a=[];for(let s=0,l=this.faces.length;s<l;s++){let e=this.faces[s];e.a=n[e.a],e.b=n[e.b],e.c=n[e.c];let t=[e.a,e.b,e.c];for(let i=0;i<3;i++)if(t[i]===t[(i+1)%3]){a.push(s);break}}for(let s=a.length-1;s>=0;s--){let e=a[s];this.faces.splice(e,1);for(let t=0,i=this.faceVertexUvs.length;t<i;t++)this.faceVertexUvs[t].splice(e,1)}let o=this.vertices.length-i.length;return this.vertices=i,o}setFromPoints(e){this.vertices=[];for(let t=0,i=e.length;t<i;t++){let i=e[t];this.vertices.push(new j_(i.x,i.y,i.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let o=0;o<t;o++)e[o]._id=o;e.sort(function(e,t){return e.materialIndex-t.materialIndex});let i,n,r=this.faceVertexUvs[0],a=this.faceVertexUvs[1];r&&r.length===t&&(i=[]),a&&a.length===t&&(n=[]);for(let o=0;o<t;o++){let t=e[o]._id;i&&i.push(r[t]),n&&n.push(a[t])}i&&(this.faceVertexUvs[0]=i),n&&(this.faceVertexUvs[1]=n)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){let t=this.parameters;for(let i in t)void 0!==t[i]&&(e[i]=t[i]);return e}let t=[];for(let p=0;p<this.vertices.length;p++){let e=this.vertices[p];t.push(e.x,e.y,e.z)}let i=[],n=[],r={},a=[],o={},s=[],l={};for(let p=0;p<this.faces.length;p++){let e=this.faces[p],t=!0,n=!1,r=void 0!==this.faceVertexUvs[0][p],a=e.normal.length()>0,o=e.vertexNormals.length>0,s=1!==e.color.r||1!==e.color.g||1!==e.color.b,l=e.vertexColors.length>0,f=0;if(f=c(f,0,0),f=c(f,1,t),f=c(f,2,n),f=c(f,3,r),f=c(f,4,a),f=c(f,5,o),f=c(f,6,s),f=c(f,7,l),i.push(f),i.push(e.a,e.b,e.c),i.push(e.materialIndex),r){let e=this.faceVertexUvs[0][p];i.push(h(e[0]),h(e[1]),h(e[2]))}if(a&&i.push(d(e.normal)),o){let t=e.vertexNormals;i.push(d(t[0]),d(t[1]),d(t[2]))}if(s&&i.push(u(e.color)),l){let t=e.vertexColors;i.push(u(t[0]),u(t[1]),u(t[2]))}}function c(e,t,i){return i?e|1<<t:e&~(1<<t)}function d(e){let t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==r[t]||(r[t]=n.length/3,n.push(e.x,e.y,e.z)),r[t]}function u(e){let t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==o[t]||(o[t]=a.length,a.push(e.getHex())),o[t]}function h(e){let t=e.x.toString()+e.y.toString();return void 0!==l[t]||(l[t]=s.length/2,s.push(e.x,e.y)),l[t]}return e.data={},e.data.vertices=t,e.data.normals=n,a.length>0&&(e.data.colors=a),s.length>0&&(e.data.uvs=[s]),e.data.faces=i,e}clone(){return(new FX).copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let u=0,h=t.length;u<h;u++)this.vertices.push(t[u].clone());let i=e.colors;for(let u=0,h=i.length;u<h;u++)this.colors.push(i[u].clone());let n=e.faces;for(let u=0,h=n.length;u<h;u++)this.faces.push(n[u].clone());for(let u=0,h=e.faceVertexUvs.length;u<h;u++){let t=e.faceVertexUvs[u];void 0===this.faceVertexUvs[u]&&(this.faceVertexUvs[u]=[]);for(let e=0,i=t.length;e<i;e++){let i=t[e],n=[];for(let e=0,t=i.length;e<t;e++){let t=i[e];n.push(t.clone())}this.faceVertexUvs[u].push(n)}}let r=e.morphTargets;for(let u=0,h=r.length;u<h;u++){let e={};if(e.name=r[u].name,void 0!==r[u].vertices){e.vertices=[];for(let t=0,i=r[u].vertices.length;t<i;t++)e.vertices.push(r[u].vertices[t].clone())}if(void 0!==r[u].normals){e.normals=[];for(let t=0,i=r[u].normals.length;t<i;t++)e.normals.push(r[u].normals[t].clone())}this.morphTargets.push(e)}let a=e.morphNormals;for(let u=0,h=a.length;u<h;u++){let e={};if(void 0!==a[u].vertexNormals){e.vertexNormals=[];for(let t=0,i=a[u].vertexNormals.length;t<i;t++){let i=a[u].vertexNormals[t],n={};n.a=i.a.clone(),n.b=i.b.clone(),n.c=i.c.clone(),e.vertexNormals.push(n)}}if(void 0!==a[u].faceNormals){e.faceNormals=[];for(let t=0,i=a[u].faceNormals.length;t<i;t++)e.faceNormals.push(a[u].faceNormals[t].clone())}this.morphNormals.push(e)}let o=e.skinWeights;for(let u=0,h=o.length;u<h;u++)this.skinWeights.push(o[u].clone());let s=e.skinIndices;for(let u=0,h=s.length;u<h;u++)this.skinIndices.push(s[u].clone());let l=e.lineDistances;for(let u=0,h=l.length;u<h;u++)this.lineDistances.push(l[u]);let c=e.boundingBox;null!==c&&(this.boundingBox=c.clone());let d=e.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=(new UX).fromGeometry(this),t=new vE,i=new Float32Array(3*e.vertices.length);if(t.setAttribute("position",GX.call(new oE(i,3),e.vertices)),e.normals.length>0){let i=new Float32Array(3*e.normals.length);t.setAttribute("normal",GX.call(new oE(i,3),e.normals))}if(e.colors.length>0){let i=new Float32Array(3*e.colors.length);t.setAttribute("color",WX.call(new oE(i,3),e.colors))}if(e.uvs.length>0){let i=new Float32Array(2*e.uvs.length);t.setAttribute("uv",HX.call(new oE(i,2),e.uvs))}if(e.uvs2.length>0){let i=new Float32Array(2*e.uvs2.length);t.setAttribute("uv2",HX.call(new oE(i,2),e.uvs2))}t.groups=e.groups;for(let n in e.morphTargets){let i=[],r=e.morphTargets[n];for(let e=0,t=r.length;e<t;e++){let t=r[e],n=new cE(3*t.data.length,3);n.name=t.name,i.push(GX.call(n,t.data))}t.morphAttributes[n]=i}if(e.skinIndices.length>0){let i=new cE(4*e.skinIndices.length,4);t.setAttribute("skinIndex",qX.call(i,e.skinIndices))}if(e.skinWeights.length>0){let i=new cE(4*e.skinWeights.length,4);t.setAttribute("skinWeight",qX.call(i,e.skinWeights))}return null!==e.boundingSphere&&(t.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new vE,i=e.geometry;if(e.isPoints||e.isLine){let e=new cE(3*i.vertices.length,3),n=new cE(3*i.colors.length,3);if(t.setAttribute("position",GX.call(e,i.vertices)),t.setAttribute("color",WX.call(n,i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length){let e=new cE(i.lineDistances.length,1);t.setAttribute("lineDistance",jX.call(e,i.lineDistances))}null!==i.boundingSphere&&(t.boundingSphere=i.boundingSphere.clone()),null!==i.boundingBox&&(t.boundingBox=i.boundingBox.clone())}else e.isMesh&&(t=i.toBufferGeometry());return t}};FX.prototype.isGeometry=!0;var UX=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t,i,n,r=[],a=e.faces;for(i=0;i<a.length;i++){let e=a[i];e.materialIndex!==n&&(n=e.materialIndex,void 0!==t&&(t.count=3*i-t.start,r.push(t)),t={start:3*i,materialIndex:n})}void 0!==t&&(t.count=3*i-t.start,r.push(t)),this.groups=r}fromGeometry(e){let t,i=e.faces,n=e.vertices,r=e.faceVertexUvs,a=r[0]&&r[0].length>0,o=r[1]&&r[1].length>0,s=e.morphTargets,l=s.length;if(l>0){t=[];for(let e=0;e<l;e++)t[e]={name:s[e].name,data:[]};this.morphTargets.position=t}let c,d=e.morphNormals,u=d.length;if(u>0){c=[];for(let e=0;e<u;e++)c[e]={name:d[e].name,data:[]};this.morphTargets.normal=c}let h=e.skinIndices,p=e.skinWeights,f=h.length===n.length,m=p.length===n.length;n.length>0&&0===i.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let g=0;g<i.length;g++){let e=i[g];this.vertices.push(n[e.a],n[e.b],n[e.c]);let v=e.vertexNormals;if(3===v.length)this.normals.push(v[0],v[1],v[2]);else{let t=e.normal;this.normals.push(t,t,t)}let y=e.vertexColors;if(3===y.length)this.colors.push(y[0],y[1],y[2]);else{let t=e.color;this.colors.push(t,t,t)}if(!0===a){let e=r[0][g];void 0!==e?this.uvs.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",g),this.uvs.push(new p_,new p_,new p_))}if(!0===o){let e=r[1][g];void 0!==e?this.uvs2.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",g),this.uvs2.push(new p_,new p_,new p_))}for(let i=0;i<l;i++){let n=s[i].vertices;t[i].data.push(n[e.a],n[e.b],n[e.c])}for(let t=0;t<u;t++){let e=d[t].vertexNormals[g];c[t].data.push(e.a,e.b,e.c)}f&&this.skinIndices.push(h[e.a],h[e.b],h[e.c]),m&&this.skinWeights.push(p[e.a],p[e.b],p[e.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}},VX=class{constructor(e,t,i,n,r){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this.a=e,this.b=t,this.c=i,this.normal=n&&n.isVector3?n:new j_,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new D_,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=a}clone(){return(new this.constructor).copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,i=e.vertexNormals.length;t<i;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,i=e.vertexColors.length;t<i;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function jX(e){return this.array.set(e),this}function WX(e){let t=this.array,i=0;for(let n=0,r=e.length;n<r;n++){let r=e[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),r=new D_),t[i++]=r.r,t[i++]=r.g,t[i++]=r.b}return this}function HX(e){let t=this.array,i=0;for(let n=0,r=e.length;n<r;n++){let r=e[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),r=new p_),t[i++]=r.x,t[i++]=r.y}return this}function GX(e){let t=this.array,i=0;for(let n=0,r=e.length;n<r;n++){let r=e[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),r=new j_),t[i++]=r.x,t[i++]=r.y,t[i++]=r.z}return this}function qX(e){let t=this.array,i=0;for(let n=0,r=e.length;n<r;n++){let r=e[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),r=new B_),t[i++]=r.x,t[i++]=r.y,t[i++]=r.z,t[i++]=r.w}return this}var XX=["a","b","c"];function YX(e,t){switch(t){case"c":return e.c;case"b":return e.b;default:return e.a}}function QX(e,t,i){let n=Math.min(e,t)+"_"+Math.max(e,t);return i.get(n)}function KX(e,t,i,n,r,a){let o,s=Math.min(e,t),l=Math.max(e,t),c=s+"_"+l;if(n.has(c))o=n.get(c);else{o={a:i[s],b:i[l],newEdge:null,faces:[]},n.set(c,o)}o.faces.push(r),a[e].edges.push(o),a[t].edges.push(o)}function ZX(e,t,i,n,r){e.push(new VX(t,i,n,void 0,void 0,r))}function JX(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function $X(e,t,i,n){e.push([t.clone(),i.clone(),n.clone()])}var eY=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.subdivisions=e}modify(e){(e=e instanceof vE?(new FX).fromBufferGeometry(e):e.clone()).mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t,i,n,r,a,o=new j_,s=e.vertices,l=e.faces,c=e.faceVertexUvs[0],d=void 0!==c&&c.length>0,u=[],h=new Map;!function(e,t,i,n){let r,a,o;for(r=0,a=e.length;r<a;r++)i[r]={edges:[]};for(r=0,a=t.length;r<a;r++)o=t[r],KX(o.a,o.b,e,n,o,i),KX(o.b,o.c,e,n,o,i),KX(o.c,o.a,e,n,o,i)}(s,l,u,h);let p,f,m,g,v,y,b,x=[];for(let W of Array.from(h.keys())){for(f=h.get(W),m=new j_,v=3/8,y=1/8,b=f.faces.length,2!=b&&(v=.5,y=0),m.addVectors(f.a,f.b).multiplyScalar(v),o.set(0,0,0),r=0;r<b;r++){for(g=f.faces[r],a=0;a<3&&(p=s[YX(g,XX[a])],p===f.a||p===f.b);a++);p&&o.add(p)}o.multiplyScalar(y),m.add(o),f.newEdge=x.length,x.push(m)}let w,S,_,C,E,A,M,T=[];for(i=0,n=s.length;i<n;i++){for(A=s[i],E=u[i].edges,t=E.length,3==t?w=3/16:t>3&&(w=3/(8*t)),S=1-t*Number(w),_=w,t<=2&&(2==t&&(S=3/4,_=1/8)),M=A.clone().multiplyScalar(S),o.set(0,0,0),r=0;r<t;r++)C=E[r],p=C.a!==A?C.a:C.b,o.add(p);o.multiplyScalar(Number(_)),M.add(o),T.push(M)}let P,D,O,I,k,R,z,L=T.concat(x),B=T.length,N=[],F=[],U=new p_,V=new p_,j=new p_;for(i=0,n=l.length;i<n;i++)g=l[i],P=Number(QX(g.a,g.b,h).newEdge)+B,D=Number(QX(g.b,g.c,h).newEdge)+B,O=Number(QX(g.c,g.a,h).newEdge)+B,ZX(N,P,D,O,g.materialIndex),ZX(N,g.a,P,O,g.materialIndex),ZX(N,g.b,D,P,g.materialIndex),ZX(N,g.c,O,D,g.materialIndex),d&&(I=c[i],k=I[0],R=I[1],z=I[2],U.set(JX(k.x,R.x),JX(k.y,R.y)),V.set(JX(R.x,z.x),JX(R.y,z.y)),j.set(JX(k.x,z.x),JX(k.y,z.y)),$X(F,U,V,j),$X(F,k,U,j),$X(F,R,V,U),$X(F,z,j,V));e.vertices=L,e.faces=N,d&&(e.faceVertexUvs[0]=F)}},tY=new j_,iY=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r;let a=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof Hq?e.shape:new Hq,parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(n=a.height)&&void 0!==n?n:a.width),depth:Math.abs(null!==(r=a.depth)&&void 0!==r?r:0)})}}static build(e){let{width:t,height:i,spikes:n,cornerRadius:r,depth:a,extrudeBevelSize:o,extrudeBevelSegments:s}=e.parameters,l=e.shape,d=.5*t,u=.5*i,h=2*Math.PI/n;for(let c=0;c<n;c++){let e=h*c,t=0+Math.sin(e)*d,i=0+Math.cos(e)*u;l.addPoint(l.createPoint(t,i))}l.isClosed=!0;for(let c=0,f=l.points.length;c<f;c++)l.points[c].roundness=r;l.roundness=r,l.update();let p=CX.create({shape:l,parameters:{roundness:r,depth:a,extrudeBevelSize:o,extrudeBevelSegments:s}});return Object.assign(p,{userData:c(c({},e),{},{type:"PolygonGeometry"})})}};function nY(e,t,i){i.x=e.x*t.x,i.y=e.y,i.z=e.x*t.y}function rY(e,t,i,n,r,a){let o=t.clone().sub(e),s=i.clone().sub(e),l=o.angleTo(s);if(o.normalize(),s.normalize(),n===r){let t=o.add(s).normalize();a.copy(e).addScaledVector(t,n/Math.sin(l/2))}else{let t=o.angleTo(s);a.copy(e),a.addScaledVector(o,r/Math.sin(t)),a.addScaledVector(s,n/Math.sin(t))}}function aY(e,t,i){let n=e.clone().sub(t),r=i.clone().sub(t);return n.projectOnVector(r),n.add(t)}var oY=class extends vE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:4;super(),i=Math.floor(Math.max(3,i)),n=Math.floor(n),o=Math.floor(o);let s,l=[],c=[],d=[],u=[],h=0,p=t/2,f=Math.PI/i,m=e*Math.cos(Math.PI/i),g=2*Math.PI/i,v=(i-2)*Math.PI/i,y=Math.PI-v,b=new j_(0,-p,0),x=new j_(0,p,0),w=new p_(e,-p),S=new p_(m,-p),_=new p_(0,x.y).sub(S),C=new p_(0,x.y).sub(w),E=new p_(_.y,-_.x).normalize(),A=new p_(C.y,-C.x).normalize(),M=e*Math.cos(Math.PI/i)*Math.tan((Math.PI-_.angle())/2)-1e-8;a=Math.min(a,M);{let e=new j_(E.x,E.y,0),t=new j_(Math.cos(g)*e.x,e.y,Math.sin(g)*e.x);s=e.angleTo(t)}let T=a/Math.tan((Math.PI-_.angle())/2),P=a/Math.tan((Math.PI-s)/2),D=new j_;if(!r){c.push(b.x,b.y,b.z),d.push(0,-1,0),u.push(0,0);let e=h++,t=[],n=w.clone(),r=T/Math.cos(Math.PI/i);n.x-=r;for(let a=0;a<i;a++){let e=a/i*Math.PI*2+f;nY(n,new p_(Math.sin(e),Math.cos(e)),D),c.push(D.x,D.y,D.z),d.push(0,-1,0),u.push(0,0),t.push(h++)}for(let i=0;i<t.length;i++)l.push(t[i],e,t[(i+1)%t.length])}let O=[];{let e=new j_,t=new j_,n=new j_,r=new j_,p=new j_,m=new j_;for(let g=0;g<i;g++){let v=g/i*Math.PI*2+f,y=(g+.5)/i*Math.PI*2+f,S=(g+1)/i*Math.PI*2+f,C=new p_(Math.sin(v),Math.cos(v)),M=new p_(Math.sin(y),Math.cos(y)),D=new p_(Math.sin(S),Math.cos(S));nY(w,C,t),nY(w,D,n),nY(E,M,e),rY(x,t,n,P,P,r),c.push(r.x,r.y,r.z),rY(t,x,n,P,T,p),c.push(p.x,p.y,p.z),rY(n,t,x,T,P,m),c.push(m.x,m.y,m.z),d.push(e.x,e.y,e.z),d.push(e.x,e.y,e.z),d.push(e.x,e.y,e.z),u.push(0,0),u.push(0,0),u.push(0,0);let R=h++,z=h++,L=h++;if(l.push(R,z,L),a>0){{let e=t.clone().add(n).multiplyScalar(.5),i=x.clone().sub(e).normalize(),r=b.clone().sub(e).normalize().add(i).normalize().multiplyScalar(-1);I(e,m.clone().sub(p),r,_.angle())}let f,g;{let e=new j_;nY(A,D,e);let t=m.clone().add(r).multiplyScalar(.5);t=aY(t,n,x);let i=m.clone().sub(r);[f,g]=I(t,i,e,s,r.y)}{let e=f,t=e.clone().setY(0).normalize(),i=new j_(0,-1,0),n=t.clone().cross(i);k(e,t,i,n)}O.concat(g);{let t=_.angle(),n=Math.PI-t,r=x.clone();r.y-=a/Math.sin(t-Math.PI/2);let s=new j_,p=[];for(let l=0;l<o;l++){let t=[],f=Math.PI/2-n*l/o,m=Math.cos(f),g=Math.sin(f),v=y;for(let n=0;n<=l;n++){let n=Math.cos(v),o=Math.sin(v);e.x=m*o,e.y=g,e.z=m*n,s.copy(r).addScaledVector(e,a),c.push(s.x,s.y,s.z),d.push(e.x,e.y,e.z),u.push(0,0),t.push(h++),v+=2*Math.PI/l/i}p.push(t)}g.reverse(),p.push(g);let f=p.length-1;for(let e=0;e<f;e++){let t=p[e],i=p[e+1],n=t.length-1;l.push(i[1],t[0],i[0]);for(let e=1;e<=n;e++)l.push(t[e],t[e-1],i[e]),l.push(i[e+1],t[e],i[e])}}}}}function I(e,t,i,n,r){let s=-n/2,p=(Math.PI-n)/2,f=t.clone().normalize().cross(i);e.addScaledVector(i,-a/Math.sin(p));let m=new j_,g=new j_,v=h,y=[];for(let l=0;l<=o;l++){let p=s+l/o*n;g.set(0,0,0),g.addScaledVector(f,Math.sin(p)),g.addScaledVector(i,Math.cos(p));for(let i=0;i<=1;i++){let n=i/1-.5;if(m.copy(e),m.addScaledVector(t,n),m.addScaledVector(g,a),null!=r){let e=Math.max(0,m.y-r);m.addScaledVector(t,-e/t.y)}c.push(m.x,m.y,m.z),d.push(g.x,g.y,g.z),u.push(0,0),0===i&&y.push(h),h++}}for(let a=0;a<o;a++)for(let e=0;e<1;e++){let t=v+e+2*a,i=t+2,n=i+1,r=t+1;l.push(t,i,r),l.push(i,n,r)}return[e.clone().addScaledVector(t,.5),y]}function k(e,t,i,n){let r=Math.PI/2,s=C.angle()-r,p=[],f=new j_,m=new j_;for(let l=0;l<=o;l++){let g=[],v=l/o;for(let o=0;o<=l;o++){let p=((l?o/l:0)-.5)*y,b=Math.cos(p),x=Math.sin(p),w=(r+Math.atan(Math.tan(s)*b))*v,S=Math.cos(w),_=Math.sin(w);f.set(0,0,0),f.addScaledVector(t,_*b),f.addScaledVector(i,S),f.addScaledVector(n,_*x),m.copy(e).addScaledVector(f,a),c.push(m.x,m.y,m.z),d.push(f.x,f.y,f.z),u.push(0,0),g.push(h++)}p.push(g)}let g=p.length-1;for(let a=0;a<g;a++){let e=p[a],t=p[a+1],i=e.length-1;l.push(e[0],t[1],t[0]);for(let n=1;n<=i;n++)l.push(e[n-1],e[n],t[n]),l.push(e[n],t[n+1],t[n])}}this.setIndex(l),this.setAttribute("position",new cE(c,3)),this.setAttribute("normal",new cE(d,3)),this.setAttribute("uv",new cE(u,2))}},sY=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r,a;let o=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),s=Object.assign(null!==(n=null===t||void 0===t?void 0:t.ui)&&void 0!==n?n:{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof Hq?e.shape:new Hq,parameters:Object.assign(o,{width:Math.abs(o.width),height:Math.abs(null!==(r=o.height)&&void 0!==r?r:o.width),depth:Math.abs(null!==(a=o.depth)&&void 0!==a?a:0)}),ui:s}}static build(e){let t=e.shape,{width:i,height:n,cornerRadius:r,cornerType:a,depth:o,extrudeBevelSize:s,extrudeBevelSegments:l}=e.parameters,d={x:.5*i,y:.5*n},u={x:-d.x,y:-d.y},h={x:d.x,y:d.y};function p(e,t,r){return t>i&&r>n?Math.min(e*i/t,e*n/r):t>i?e*i/t:r>n?e*n/r:e}let f=[];f[0]=0===r[0]?0:p(r[0],r[0]+r[3],r[0]+r[1]),f[1]=0===r[1]?0:p(r[1],r[1]+r[2],r[1]+r[0]),f[2]=0===r[2]?0:p(r[2],r[2]+r[1],r[2]+r[3]),f[3]=0===r[3]?0:p(r[3],r[3]+r[0],r[3]+r[2]);let m=u.x,g=h.x,v=h.y,y=u.y;t.addPoint(t.createPoint(m,v)),t.addPoint(t.createPoint(g,v)),t.addPoint(t.createPoint(g,y)),t.addPoint(t.createPoint(m,y)),t.isClosed=!0;let b=!0;for(let c=0,w=t.points.length;c<w;c++)t.points[c].roundness=f[c],c>0&&f[c]!==f[c-1]&&(b=!1);b&&(t.roundness=f[0]),t.useCubicForRoundedCorners=1!==a,t.update();let x=CX.create({shape:t,parameters:{depth:o,extrudeBevelSize:s,extrudeBevelSegments:l}});return Object.assign(x,{userData:c(c({},e),{},{type:"RectangleGeometry"})})}},lY=class extends vE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:90,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:24;super(),this.type="BackdropGeometry";let o=[],s=[],l=[],c=.001;0==r&&(a=1),a=Math.max(1,Math.floor(a)),r=Math.min(r,100),n=Math.min(180-c,n),n*=Math.PI/180;let d=[],u=Math.PI/2,h=function(){return new j_(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)},p=h(),f=h(),[m,g,v]=[t/2,e/2,i/2],y=-g,b=+g,[x,w,S]=[h(y,-m,+v),h(y,-m,-v),h(y,+m,-v)],_=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Math.sin(e-Math.PI/(+t+1))},C=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Math.cos(e-Math.PI/(+t+1))};S.y=Math.sin(n)*t-m;let E=Math.cos(n)*t-v,A=x.z-c;n<=u?(S.z=Math.min(E,A),S.z==A&&(S.y-=(E-A)/Math.tan(u-n))):w.z=Math.min(w.z-E-v,x.z-c),p.subVectors(x,w),f.subVectors(S,w);let M=Math.min(p.length(),f.length())*r/100,T=M*Math.tan(n/2),P=M/Math.cos(n/2),D=p.clone().normalize().add(f.normalize()).setLength(P).add(w);p.set(0,_(n,!0),C(n,!0)),d.push([S,p.clone()]);let O=(Math.PI-n)/a;for(let j=0;j<=a;j++){let e=u+n+j*O;p.set(0,Math.sin(e)*T,Math.cos(e)*T),p.add(D),f.set(0,_(e),C(e)),d.push([p.clone(),f.clone()])}d.push([x,h(0,1,0)]);let I=Math.sin(O/2)*T*2,k=d.length-1,R=d[0][0].distanceTo(d[1][0]),z=R+I*a+d[k-1][0].distanceTo(d[k][0]);d[0].push(1);for(let j=0;j<=a;j++)d[j+1].push(1-(R+j*I)/z);d[k].push(0);let L,B,N,[F,U,V]=d[0];for(let j=1;j<d.length;j++)[L,B,N]=d[j],o.push(y,F.y,F.z,y,L.y,L.z,b,F.y,F.z,b,F.y,F.z,y,L.y,L.z,b,L.y,L.z),s.push(0,U.y,U.z,0,B.y,B.z,0,U.y,U.z,0,U.y,U.z,0,B.y,B.z,0,B.y,B.z),l.push(0,V,0,N,1,V,1,V,0,N,1,N),[F,U,V]=[L,B,N];this.setAttribute("position",new cE(o,3)),this.setAttribute("normal",new cE(s,3)),this.setAttribute("uv",new cE(l,2))}},cY=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r;let a=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof Hq?e.shape:new Hq,parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(n=a.height)&&void 0!==n?n:a.width),depth:Math.abs(null!==(r=a.depth)&&void 0!==r?r:0)})}}static build(e){let{width:t,height:i,innerRadiusPercent:n,spikes:r,cornerRadius:a,angle:o,depth:s,extrudeBevelSize:l,extrudeBevelSegments:d}=e.parameters,u=e.shape,h=.5*t,p=.5*i,f=o*Math.PI/360/r,m=Math.PI/2*3*-1,g=h*n/100,v=p*n/100;if(3===r&&50===n){f=2*Math.PI/r;for(let e=0;e<r;e++){let t=f*e,i=0+Math.sin(t)*h,n=0+Math.cos(t)*p;u.addPoint(u.createPoint(i,n))}}else for(let c=0;c<r;c++){let e=0+Math.cos(m)*h,t=0+Math.sin(m)*p;u.addPoint(u.createPoint(e,t)),m+=f,e=0+Math.cos(m)*g,t=0+Math.sin(m)*v,u.addPoint(u.createPoint(e,t)),m+=f}u.isClosed=!0;for(let c=0,b=u.points.length;c<b;c++)u.points[c].roundness=a;u.roundness=a,u.update();let y=CX.create({shape:u,parameters:{roundness:a,depth:s,extrudeBevelSize:l,extrudeBevelSegments:d}});return Object.assign(y,{userData:c(c({},e),{},{type:"StarGeometry"})})}};var dY={parseRgba:function(e){return/^(rgba)?\(\s*(\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(e.toLowerCase())},hsvToRgb:function(e,t,i){let n,r,a,o=Math.floor(6*e),s=6*e-o,l=i*(1-t),c=i*(1-s*t),d=i*(1-(1-s)*t);switch(o%6){case 0:n=i,r=d,a=l;break;case 1:n=c,r=i,a=l;break;case 2:n=l,r=i,a=d;break;case 3:n=l,r=c,a=i;break;case 4:n=d,r=l,a=i;break;default:n=i,r=l,a=c}return{r:255*n,g:255*r,b:255*a}},rgbToHsv:function(e,t,i){e/=255,t/=255,i/=255;let n,r=Math.max(e,t,i),a=Math.min(e,t,i),o=r,s=r-a,l=0==r?0:s/r;if(r==a)n=0;else{switch(r){case e:n=(t-i)/s+(t<i?6:0);break;case t:n=(i-e)/s+2;break;default:n=(e-t)/s+4}n/=6}return{h:n,s:l,v:o}},hexToRgb:function(e){return{r:(e=Math.floor(e))>>16&255,g:e>>8&255,b:255&e}},rgbToHex:function(e,t,i){return(e<<16)+(t<<8)+i},rgbToHexString:function(e,t,i){return"#"+[e=Math.round(e),t=Math.round(t),i=Math.round(i)].map(e=>e.toString(16).padStart(2,"0")).join("").toUpperCase()},hexStringToRgb:function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,i,n)=>String(t+t+i+i+n+n));let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}},uY=class{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+uY.version}static addUnaryOp(e){return uY.max_unop_len=Math.max(e.length,uY.max_unop_len),uY.unary_ops[e]=1,uY}static addBinaryOp(e,t,i){return uY.max_binop_len=Math.max(e.length,uY.max_binop_len),uY.binary_ops[e]=t,i?uY.right_associative.add(e):uY.right_associative.delete(e),uY}static addIdentifierChar(e){return uY.additional_identifier_chars.add(e),uY}static addLiteral(e,t){return uY.literals[e]=t,uY}static removeUnaryOp(e){return delete uY.unary_ops[e],e.length===uY.max_unop_len&&(uY.max_unop_len=uY.getMaxKeyLen(uY.unary_ops)),uY}static removeAllUnaryOps(){return uY.unary_ops={},uY.max_unop_len=0,uY}static removeIdentifierChar(e){return uY.additional_identifier_chars.delete(e),uY}static removeBinaryOp(e){return delete uY.binary_ops[e],e.length===uY.max_binop_len&&(uY.max_binop_len=uY.getMaxKeyLen(uY.binary_ops)),uY.right_associative.delete(e),uY}static removeAllBinaryOps(){return uY.binary_ops={},uY.max_binop_len=0,uY}static removeLiteral(e){return delete uY.literals[e],uY}static removeAllLiterals(){return uY.literals={},uY}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(e){this.expr=e,this.index=0}static parse(e){return new uY(e).parse()}static getMaxKeyLen(e){return Math.max(0,...Object.keys(e).map(e=>e.length))}static isDecimalDigit(e){return e>=48&&e<=57}static binaryPrecedence(e){return uY.binary_ops[e]||0}static isIdentifierStart(e){return e>=65&&e<=90||e>=97&&e<=122||e>=128&&!uY.binary_ops[String.fromCharCode(e)]||uY.additional_identifier_chars.has(String.fromCharCode(e))}static isIdentifierPart(e){return uY.isIdentifierStart(e)||uY.isDecimalDigit(e)}throwError(e){let t=new Error(e+" at character "+this.index);throw t.index=this.index,t.description=e,t}runHook(e,t){if(uY.hooks[e]){let i={context:this,node:t};return uY.hooks.run(e,i),i.node}return t}searchHook(e){if(uY.hooks[e]){let t={context:this};return uY.hooks[e].find(function(e){return e.call(t.context,t),t.node}),t.node}}gobbleSpaces(){let e=this.code;for(;e===uY.SPACE_CODE||e===uY.TAB_CODE||e===uY.LF_CODE||e===uY.CR_CODE;)e=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let e=this.gobbleExpressions(),t=1===e.length?e[0]:{type:uY.COMPOUND,body:e};return this.runHook("after-all",t)}gobbleExpressions(e){let t,i,n=[];for(;this.index<this.expr.length;)if(t=this.code,t===uY.SEMCOL_CODE||t===uY.COMMA_CODE)this.index++;else if(i=this.gobbleExpression())n.push(i);else if(this.index<this.expr.length){if(t===e)break;this.throwError('Unexpected "'+this.char+'"')}return n}gobbleExpression(){let e=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",e)}gobbleBinaryOp(){this.gobbleSpaces();let e=this.expr.substr(this.index,uY.max_binop_len),t=e.length;for(;t>0;){if(uY.binary_ops.hasOwnProperty(e)&&(!uY.isIdentifierStart(this.code)||this.index+e.length<this.expr.length&&!uY.isIdentifierPart(this.expr.charCodeAt(this.index+e.length))))return this.index+=t,e;e=e.substr(0,--t)}return!1}gobbleBinaryExpression(){let e,t,i,n,r,a,o,s,l;if(a=this.gobbleToken(),!a||(t=this.gobbleBinaryOp(),!t))return a;for(r={value:t,prec:uY.binaryPrecedence(t),right_a:uY.right_associative.has(t)},o=this.gobbleToken(),o||this.throwError("Expected expression after "+t),n=[a,r,o];t=this.gobbleBinaryOp();){if(i=uY.binaryPrecedence(t),0===i){this.index-=t.length;break}r={value:t,prec:i,right_a:uY.right_associative.has(t)},l=t;let s=e=>r.right_a&&e.right_a?i>e.prec:i<=e.prec;for(;n.length>2&&s(n[n.length-2]);)o=n.pop(),t=n.pop().value,a=n.pop(),e={type:uY.BINARY_EXP,operator:t,left:a,right:o},n.push(e);e=this.gobbleToken(),e||this.throwError("Expected expression after "+l),n.push(r,e)}for(s=n.length-1,e=n[s];s>1;)e={type:uY.BINARY_EXP,operator:n[s-1].value,left:n[s-2],right:e},s-=2;return e}gobbleToken(){let e,t,i,n;if(this.gobbleSpaces(),n=this.searchHook("gobble-token"),n)return this.runHook("after-token",n);if(e=this.code,uY.isDecimalDigit(e)||e===uY.PERIOD_CODE)return this.gobbleNumericLiteral();if(e===uY.SQUOTE_CODE||e===uY.DQUOTE_CODE)n=this.gobbleStringLiteral();else if(e===uY.OBRACK_CODE)n=this.gobbleArray();else{for(t=this.expr.substr(this.index,uY.max_unop_len),i=t.length;i>0;){if(uY.unary_ops.hasOwnProperty(t)&&(!uY.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!uY.isIdentifierPart(this.expr.charCodeAt(this.index+t.length)))){this.index+=i;let e=this.gobbleToken();return e||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:uY.UNARY_EXP,operator:t,argument:e,prefix:!0})}t=t.substr(0,--i)}uY.isIdentifierStart(e)?(n=this.gobbleIdentifier(),uY.literals.hasOwnProperty(n.name)?n={type:uY.LITERAL,value:uY.literals[n.name],raw:n.name}:n.name===uY.this_str&&(n={type:uY.THIS_EXP})):e===uY.OPAREN_CODE&&(n=this.gobbleGroup())}return n?(n=this.gobbleTokenProperty(n),this.runHook("after-token",n)):this.runHook("after-token",!1)}gobbleTokenProperty(e){this.gobbleSpaces();let t=this.code;for(;t===uY.PERIOD_CODE||t===uY.OBRACK_CODE||t===uY.OPAREN_CODE||t===uY.QUMARK_CODE;){let i;if(t===uY.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==uY.PERIOD_CODE)break;i=!0,this.index+=2,this.gobbleSpaces(),t=this.code}this.index++,t===uY.OBRACK_CODE?(e={type:uY.MEMBER_EXP,computed:!0,object:e,property:this.gobbleExpression()},this.gobbleSpaces(),t=this.code,t!==uY.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):t===uY.OPAREN_CODE?e={type:uY.CALL_EXP,arguments:this.gobbleArguments(uY.CPAREN_CODE),callee:e}:(t===uY.PERIOD_CODE||i)&&(i&&this.index--,this.gobbleSpaces(),e={type:uY.MEMBER_EXP,computed:!1,object:e,property:this.gobbleIdentifier()}),i&&(e.optional=!0),this.gobbleSpaces(),t=this.code}return e}gobbleNumericLiteral(){let e,t,i="";for(;uY.isDecimalDigit(this.code);)i+=this.expr.charAt(this.index++);if(this.code===uY.PERIOD_CODE)for(i+=this.expr.charAt(this.index++);uY.isDecimalDigit(this.code);)i+=this.expr.charAt(this.index++);if(e=this.char,"e"===e||"E"===e){for(i+=this.expr.charAt(this.index++),e=this.char,("+"===e||"-"===e)&&(i+=this.expr.charAt(this.index++));uY.isDecimalDigit(this.code);)i+=this.expr.charAt(this.index++);uY.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+i+this.char+")")}return t=this.code,uY.isIdentifierStart(t)?this.throwError("Variable names cannot start with a number ("+i+this.char+")"):(t===uY.PERIOD_CODE||1===i.length&&i.charCodeAt(0)===uY.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:uY.LITERAL,value:parseFloat(i),raw:i}}gobbleStringLiteral(){let e="",t=this.index,i=this.expr.charAt(this.index++),n=!1;for(;this.index<this.expr.length;){let t=this.expr.charAt(this.index++);if(t===i){n=!0;break}if("\\"===t)switch(t=this.expr.charAt(this.index++),t){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=t}else e+=t}return n||this.throwError('Unclosed quote after "'+e+'"'),{type:uY.LITERAL,value:e,raw:this.expr.substring(t,this.index)}}gobbleIdentifier(){let e=this.code,t=this.index;for(uY.isIdentifierStart(e)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(e=this.code,uY.isIdentifierPart(e));)this.index++;return{type:uY.IDENTIFIER,name:this.expr.slice(t,this.index)}}gobbleArguments(e){let t=[],i=!1,n=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let r=this.code;if(r===e){i=!0,this.index++,e===uY.CPAREN_CODE&&n&&n>=t.length&&this.throwError("Unexpected token "+String.fromCharCode(e));break}if(r===uY.COMMA_CODE){if(this.index++,n++,n!==t.length)if(e===uY.CPAREN_CODE)this.throwError("Unexpected token ,");else if(e===uY.CBRACK_CODE)for(let e=t.length;e<n;e++)t.push(null)}else if(t.length!==n&&0!==n)this.throwError("Expected comma");else{let e=this.gobbleExpression();(!e||e.type===uY.COMPOUND)&&this.throwError("Expected comma"),t.push(e)}}return i||this.throwError("Expected "+String.fromCharCode(e)),t}gobbleGroup(){this.index++;let e=this.gobbleExpressions(uY.CPAREN_CODE);if(this.code===uY.CPAREN_CODE)return this.index++,1===e.length?e[0]:!!e.length&&{type:uY.SEQUENCE_EXP,expressions:e};this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:uY.ARRAY_EXP,elements:this.gobbleArguments(uY.CBRACK_CODE)}}},hY=new class{add(e,t,i){if("string"!=typeof arguments[0])for(let n in arguments[0])this.add(n,arguments[0][n],arguments[1]);else(Array.isArray(e)?e:[e]).forEach(function(e){this[e]=this[e]||[],t&&this[e][i?"unshift":"push"](t)},this)}run(e,t){this[e]=this[e]||[],this[e].forEach(function(e){e.call(t&&t.context?t.context:t,t)})}};Object.assign(uY,{hooks:hY,plugins:new class{constructor(e){this.jsep=e,this.registered={}}register(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(e=>{if("object"!=typeof e||!e.name||!e.init)throw new Error("Invalid JSEP plugin format");this.registered[e.name]||(e.init(this.jsep),this.registered[e.name]=e)})}}(uY),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"}),uY.max_unop_len=uY.getMaxKeyLen(uY.unary_ops),uY.max_binop_len=uY.getMaxKeyLen(uY.binary_ops);var pY=e=>new uY(e).parse();Object.getOwnPropertyNames(uY).forEach(e=>{void 0===pY[e]&&"prototype"!==e&&(pY[e]=uY[e])}),pY.Jsep=uY;var fY={name:"ternary",init(e){e.hooks.add("after-expression",function(t){if(t.node&&this.code===e.QUMARK_CODE){this.index++;let i=t.node,n=this.gobbleExpression();if(n||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;let r=this.gobbleExpression();if(r||this.throwError("Expected expression"),t.node={type:"ConditionalExpression",test:i,consequent:n,alternate:r},i.operator&&e.binary_ops[i.operator]<=.9){let n=i;for(;n.right.operator&&e.binary_ops[n.right.operator]<=.9;)n=n.right;t.node.test=n.right,n.right=t.node,t.node=i}}else this.throwError("Expected :")}})}};function mY(e){return{all:e=e||new Map,on:function(t,i){var n=e.get(t);n?n.push(i):e.set(t,[i])},off:function(t,i){var n=e.get(t);n&&(i?n.splice(n.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var n=e.get(t);n&&n.slice().map(function(e){e(i)}),(n=e.get("*"))&&n.slice().map(function(e){e(t,i)})}}}pY.plugins.register(fY);var gY=class{constructor(e,t,i){var n;this.id=e,this.userAPI=t,this.result=void 0,this.error="null",this.isPrefetched=!1,this.isLoading=!1,this.isLoaded=!1,this.prefetchPromise=new Promise(e=>e()),this.emitter=mY(),this._innerCallUserAPI=async e=>{this.emitter.emit("start",{userAPIId:this.id}),this.isLoading=!0,this.isLoading=!1;try{this.result=await async function(e,t){var i,n,r,a,o;let s,l,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new AbortController,d=e.url,u=null!==(i=null===(n=e.proxy)||void 0===n?void 0:n.enabled)&&void 0!==i&&i;if("OpenAI"===(null===(r=e.integration)||void 0===r?void 0:r.type)){let i=bY(""===e.integration.prompt?[]:JSON.parse(e.integration.prompt),t),n=""===e.integration.behavior?[]:bY(JSON.parse(e.integration.behavior),t);l='{\n\t\t"model": "'.concat(e.integration.model,'",\n\t\t"messages": [').concat(e.integration.useBehavior?'\n\t\t{\n\t\t\t"role": "system",\n\t\t\t"content": "'.concat(n,'"\n\t\t},'):"",'\n\t\t{\n\t\t\t"role": "user",\n\t\t\t"content": "').concat(i,'"\n\t\t}\n\t\t]\n\t}')}if(u){let i;d="".concat("https://apis.spline.design/","file/").concat(e.proxy.fileId,"/external-api/request?uuidexternalapi=").concat(e.proxy.proxyId),void 0!==l?i=l:"POST"===e.method&&e.body&&(i=bY(JSON.parse(e.body),t)),void 0!==i&&(d+="&data=".concat(encodeURIComponent(i.replace(/(\r\n|\n|\r|\t)/gm,""))))}else"OpenAI"===(null===(a=e.integration)||void 0===a?void 0:a.type)?s=l:"POST"===e.method&&e.body&&(s=bY(JSON.parse(e.body),t));let h=await fetch(d,{method:u?"GET":e.method,headers:u?void 0:vY(e),signal:c.signal,body:s});if(!h.ok)throw new Error("status:"+h.status+"_:_"+h.statusText);if("OpenAI"===(null===(o=e.integration)||void 0===o?void 0:o.type)){let e=await h.json();return u&&(e=e.response),{content:e.choices[0].message.content}}{let e=await h.json();return u&&(e=e.response),e}}(this.userAPI,e),this.error="null",this.emitter.emit("success",{userAPIId:this.id})}catch(t){var i,n;let r=null!==(i=null===(n=t.message)||void 0===n||null===(n=n.split("_:_"))||void 0===n||null===(n=n[0])||void 0===n?void 0:n.replace("status:",""))&&void 0!==i?i:"null";this.error=r,this.result=null,this.emitter.emit("error",{userAPIId:this.id})}this.isLoading=!1,this.isPrefetched=!0,this.isLoaded=!0},"OpenAI"===(null===t||void 0===t||null===(n=t.integration)||void 0===n?void 0:n.type)?this.result={content:""}:"GET"===t.method&&""!==t.url&&(this.prefetchPromise=this.prefetch(i)),this._debouncedCallUserAPI=this._innerCallUserAPI,this._updateDebouncedCallUserAPI(),this._debouncedPrefetch=zB(this.prefetch,1e3,{trailing:!0})}_updateDebouncedCallUserAPI(){this._debouncedCallUserAPI=void 0!==this.userAPI.debounce&&this.userAPI.debounce>0?zB(this._innerCallUserAPI,this.userAPI.debounce,{leading:!0,trailing:!0}):this._innerCallUserAPI}async prefetch(e){await this.callUserAPI(e)}async callUserAPI(e){await this._debouncedCallUserAPI(e)}update(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.userAPI=e,this._updateDebouncedCallUserAPI(),""!==this.userAPI.url&&"GET"===this.userAPI.method&&i&&this._debouncedPrefetch(t)}retrieveValue(e){if(this.result)try{return fF.zoom(this.result,e)}catch(VU){console.error(VU)}}retrieveZoomedKeyValues(e){if(this.result){let t=e&&e.length?fF.zoom(this.result,e):this.result;if(function(e){return"object"==typeof e&&null!==e}(t))return Object.entries(t);if(function(e){return Array.isArray(e)}(t))return t.map((e,t)=>[t.toString(),e]);throw function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(t)?new Error("This path points to a value, use retrieveValue() instead. "+(null===e||void 0===e?void 0:e.join("."))):new Error("Path error"+(null===e||void 0===e?void 0:e.join(".")))}}dispose(){}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}get autostart(){return this.userAPI.autoStart}};function vY(e){let t=new Headers;return e.headers.forEach(e=>{""!==e.data.key&&t.append(e.data.key,e.data.value)}),t}var yY=(e,t)=>{if("string"==typeof e){let i=t.getVariable(e);if(i)return yY(i,t)}return eW.isBoolean(e)?eW.getDisplayedValue(e).toLowerCase():eW.getDisplayedValue(e)},bY=(e,t)=>e.map((e,i)=>{if("text"in e)return e.text;if("type"in e){if("paragraph"===e.type)return(i>0?"\n":"")+bY(e.children,t);if("variable"===e.type){let i=t.getVariable(e.variableId);if(void 0!==i)return yY(i,t)}}return""}).join(""),xY=["+","-","*","/","(",")","==","!=",">","<",">=","<=","and","or","!","%","^",","],wY=["0","1","2","3","4","5","6","7","8","9","."],SY=["sin","cos","tan","asin","acos","atan","atan2","sqrt","abs","log","exp","floor","ceil","round","min","max","random"];function _Y(e){return"string"==typeof e&&(!isNaN(e)&&!isNaN(parseFloat(e)))}function CY(e,t){let i,n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"number",a="";for(let s=0;s<e.length;s++){let i=e[s];if("objType"in i&&"api"===i.objType){let e=JSON.parse(i.id),n=e[0],r=t.getUserAPI(n);if(void 0!==r&&r instanceof gY){let t=r.retrieveValue(e.slice(1));void 0!==t&&(a+=t)}continue}if("objType"in i&&"webhook"===i.objType){let e=JSON.parse(i.id),[n,r]=e,o=t.getUserWebhook(n);if(void 0!==o){let e=o.getParameterValue(r);void 0!==e&&(a+=e)}continue}if("objType"in i&&"aiAssistant"===i.objType){var o;let e=t.openAIRealtime;if("objId"in i&&void 0!==i.objId){let n;if(t.scene.data.objects.traverse((e,t)=>{var r;let a=null===(r=t.events)||void 0===r?void 0:r.find(e=>e.id===i.objId);a&&(n=a)}),void 0!==n&&"AIAssistantListener"===n.data.type){let t=null===e||void 0===e?void 0:e.computeAnalysisForListenerEvent(n.data);if(void 0!==t){a+=t;continue}}}a+=null!==(o=null===e||void 0===e?void 0:e.voice)&&void 0!==o?o:0;continue}if("id"in i){let n=e[s-1];if(s>0&&"id"in n)return void console.error("Two variables in a row",e);let o=t.getVariable(i.id),l=eW.getDisplayedValue(o);"number"===r&&eW.isTextValue(o)&&Array.isArray(o.textValue)&&1===o.textValue.length?l=parseFloat(l).toString():"boolean"===r&&eW.isBoolean(o)?l=o?"true":"false":"boolean"===r&&eW.isTextValue(o)&&!Array.isArray(o.textValue)&&(l='"'+l+'"'),a+=l;continue}"string"!==r?"and"!==i.name?"or"!==i.name?"True"!==i.name?"False"!==i.name?"boolean"!==r||_Y(i.name)||wY.includes(i.name)||xY.includes(i.name)||SY.includes(i.name.replace(/\($/g,""))?a+=i.name:a+='"'+i.name+'"':a+="false":a+="true":a+="||":a+="&&":('"'!==i.name&&("+"!==i.name||i.escaped)&&(a+=i.name),"+"===i.name&&!i.escaped&&"\\"===a[a.length-1]&&(a=a.slice(0,-1)+i.name))}if("string"===r)return a;if(0===e.length){if("number"===r)return 0;if("boolean"===r)return!1}try{i=pY(a)}catch(hV){return void console.error(a,hV)}try{n=EY(i)}catch(hV){console.error(a,i,hV)}return n}function EY(e){switch(e.type){case"BinaryExpression":switch(e.operator){case"==":return Number(EY(e.left)===EY(e.right));case"!=":return Number(EY(e.left)!==EY(e.right));case">":return Number(EY(e.left)>EY(e.right));case">=":return Number(EY(e.left)>=EY(e.right));case"<":return Number(EY(e.left)<EY(e.right));case"<=":return Number(EY(e.left)<=EY(e.right));case"+":return EY(e.left)+EY(e.right);case"-":return EY(e.left)-EY(e.right);case"*":return EY(e.left)*EY(e.right);case"/":return EY(e.left)/EY(e.right);case"%":return EY(e.left)%EY(e.right);case"&&":return EY(e.left)&&EY(e.right);case"||":return EY(e.left)||EY(e.right);case"^":return Math.pow(EY(e.left),EY(e.right));default:throw new Error("Unknown operator: "+e.operator)}case"UnaryExpression":switch(e.operator){case"-":return-EY(e.argument);case"!":return Number(!EY(e.argument));default:throw new Error("Unknown operator: "+e.operator)}case"Identifier":throw new Error("Unknown identifier: "+e.name);case"Literal":return e.value;case"CallExpression":if("Identifier"===e.callee.type){if("random"===e.callee.name){let t=0,i=1;if(e.arguments.length>=1)try{t=EY(e.arguments[0])}catch(WN){console.warn(WN)}if(e.arguments.length>=2)try{i=EY(e.arguments[1])}catch(WN){console.warn(WN)}return t=Math.min(i,t),i=Math.max(i,t),t+Math.random()*(i-t)}return Math[e.callee.name].apply(null,e.arguments.map(EY))}throw new Error("Unknown node");default:throw new Error("Unknown node type: "+e.type)}}pY.addBinaryOp("^",11,!0);var AY=new yC,MY=new yC;var TY=class extends vE{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&1===this.inputs.parameters.extrusion.depth}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&1===e.depth)||!function(e,t){let i=2*Math.PI;return(e%i+i)%i===(t%i+i)%i}(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:i,offset:n}=this.inputs.parameters.extrusion;i=Math.max(0,Math.min(i,1)),n=Math.max(0,Math.min(n,1));let r=this.inputs.path.isClosed?e.length:e.length-1,a=Math.floor(n*r),o=this.inputs.path.isClosed?Math.ceil((i+n)*r):Math.ceil(Math.min(1,i+n)*r),s=Math.min(Math.max(2,o-a+1),r+2),l=[],c=[];for(let R=0;R<s;R++){let i=this.inputs.path.isClosed?(R+a)%e.length:Math.min(R+a,e.length-1);l.push(e[i].clone()),c.push(t[i].clone())}let d=(e,t,i)=>{l[e]=l[e].clone().lerp(l[t],i),c[e]=function(e,t,i){let n=[new j_,new j_,new j_],r=[new j_,new j_,new j_];return e.extractBasis(n[0],n[1],n[2]),t.extractBasis(r[0],r[1],r[2]),n.forEach((e,t)=>{let n=r[t],a=h_.lerp(e.length(),n.length(),i);e.lerp(n,i).setLength(a)}),(new yC).makeBasis(n[0],n[1],n[2])}(c[e],c[t],i)},u=0,h=n*r%1;(!this.inputs.path.isClosed||i<=1)&&(h||0===n)&&(u=h,d(0,1,u));let p=0,f=(n+i)*r%1;if((this.inputs.path.isClosed&&i<=1||!this.inputs.path.isClosed&&n+i<1)&&f&&(p=f,d(l.length-1,l.length-2,1-p)),0===i){let e=l.length-1;l[e].copy(l[0]),c[e].copy(c[0])}this._applyPathModifiers(c,u,p);let{bevel:m,bevelSides:g}=this.inputs.parameters.extrusion,v=m>0?this.inputs.parameters.extrusion.capType:"flat",y=5;"Custom"===this.inputs.parameters.extrusion.shape.type&&(y="low"===this.inputs.parameters.extrusion.shape.shapeQuality?5:12);let b,{regions:x,infos:w,vertices:S}=this._computeShapePoints(y),_=0;"round"===v&&(b=new wX(this.inputs.shapeData,2*m,m,y,g,void 0,!0),_=b.getAttribute("position").count);let C=0,E=0;w.sort((e,t)=>e.start-t.start),w.forEach(e=>{e.verticesStart=C,e.verticesCount=e.continuous.reduce((e,t,i)=>e+(0!==i&&t?1:2),0),E+=e.verticesCount,C=E});let A,M=E*s,T=0;if(this._isOpenEnded()&&"flat"===v){try{A=dX({windingRule:zq.ODD,elementType:Bq.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:x})}catch(k){A=bX}T=A.vertexCount}let P=M+2*T+2*_,D=M+2*T,O={positions:new Float32Array(3*P),normals:new Float32Array(3*P),uvs:new Float32Array(2*P)},I=[];if(w.forEach(e=>{this._extrudeRegion(e,S,c,l,O,I,this._isGeometryClosed()&&!this._isOpenEnded())}),A&&(this._closeEnd(A,M,I,O,c[0],l[0],!1),this._closeEnd(A,M+T,I,O,c[c.length-1],l[l.length-1],!0)),b){O.positions.set(b.getAttribute("position").array,3*D),O.normals.set(b.getAttribute("normal").array,3*D),O.uvs.set(b.getAttribute("uv").array,2*D);for(let n=D;n<D+_;n++)O.uvs[2*n+1]=1e-4;let e=I.length;I.push(...b.getIndex().array.map(e=>e+D)),D+=_,O.positions.set(b.getAttribute("position").array,3*D),O.normals.set(b.getAttribute("normal").array,3*D),O.uvs.set(b.getAttribute("uv").array,2*D);let t=I.length;I.push(...b.getIndex().array.map(e=>e+D)),this.setAttribute("position",new oE(O.positions,3)),this.setAttribute("normal",new oE(O.normals,3)),this.setAttribute("uv",new oE(O.uvs,2)),this.setIndex(I);let i=AY;i.copy(c[c.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(i,D,P),i.copy(c[0]).setPosition(l[0]).multiply(MY.makeScale(1,1,-1)),this.applyMatrix4OnRange(i,D-_,D),this.reverseIndicesOnRange(e,t)}else this.setAttribute("position",new oE(O.positions,3)),this.setAttribute("normal",new oE(O.normals,3)),this.setAttribute("uv",new oE(O.uvs,2)),this.setIndex(I)}_extractPathPoints(){let e=qG(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach(e=>{t[t.length-1].distanceToSquared(e)>.001&&t.push(e)}),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],i=e.length,n=this.inputs.path.isClosed,r=new j_,a=new j_,o=new j_,s=new j_,l=new j_(0,1,0);for(let f=0;f<i;f++){let c,d,u=e[f];c=0===f?n?e[e.length-2]:u.clone().multiplyScalar(2).sub(e[1]):e[f-1],d=f===i-1?n?e[1]:u.clone().multiplyScalar(2).sub(e[f-1]):e[f+1];let h=u.clone().sub(c).normalize(),p=d.clone().sub(u).normalize(),m=h.clone().add(p).normalize();o.copy(m),0===f&&(m.equals(l)||m.clone().negate().equals(l))&&l.set(0,0,1);let g=l.clone().cross(m).normalize(),v=m.clone().cross(g).normalize();l.copy(v),s.copy(g),0===f&&(r.copy(v),a.copy(m));let y=(new yC).makeBasis(g,v,m);t.push(y)}let c=n?a:o,d=n?r:new j_(0,1,0),u=c.clone().cross(s).normalize(),h=Math.acos(d.dot(u));if(isNaN(h))return t;let p=d.clone().cross(u);c.dot(p)>0&&(h*=-1);for(let f=1;f<t.length;f++){let e=(new yC).makeRotationZ(h*f/t.length);t[f].multiply(e)}return t}_applyPathModifiers(e,t,i){let n=e.length,{angle:r,twist:a,startScale:o,endScale:s}=this.inputs.parameters.extrusion,l=new yC,c=new yC;return e.forEach((e,d)=>{let u=0===d?0:d===n-1?1:(d-t)/(n-(0===i?0:1)-(t+(1-i)));l.makeRotationZ(h_.lerp(r,r+a,u)*h_.DEG2RAD);let h=h_.lerp(o,s,u);c.makeScale(h,h,h),e.multiply(l).multiply(c)}),e}_computeShapePoints(){let e,t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zq.ODD,r=this.inputs.shapeData,a=r.extractShapePointsToFlatArray([],i),o=r.shapeHoles.map(e=>{let t=e.extractShapePointsToFlatArray([],i),n=[];for(let i=t.length-1;i>=1;i-=2){let e=t[i-1],r=t[i-0];n.push(e,r)}return n});try{e=dX({windingRule:n,elementType:Bq.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[a]})}catch(p){e=vX}try{t=dX({windingRule:zq.ODD,elementType:Bq.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...o]})}catch(f){t=yX}if(!e)throw new Error("error generating geometry");let s=e.elementCount;if(t){e.elementCount+=t.elementCount;for(let i=0;i<t.elements.length;i++){let n=t.elements[i],r=i%2===0?e.vertexCount:0;e.elements.push(n+r)}for(let i=0;i<t.vertexIndices.length;i++){let n=t.vertexIndices[i],r=e.vertexCount;e.vertexIndices.push(n+r)}for(let i=0;i<t.vertices.length;i++){let n=t.vertices[i];e.vertices.push(n)}}let l=1/0,c=-1/0,d=1/0,u=-1/0;for(let m=0,g=e.vertexCount;m<g;m++){let t=2*m,i=e.vertices[t+0],n=e.vertices[t+1];i<l&&(l=i),i>c&&(c=i),n<d&&(d=n),n>u&&(u=n)}let h=[];for(let m=e.elementCount-1;m>=0;m--){let t=m>=s,i=2*m,n=e.elements[i+0],a=e.elements[i+1],o=n+a,l={start:n,count:a,normals:[],isHole:t,continuous:[],verticesStart:0,verticesCount:0};h.push(l);let c=n,d=o-1,u=n+1,p=r.roundedCurves.length;do{let i=c-n,s=e.vertices[2*d+0],h=e.vertices[2*d+1],f=e.vertices[2*c+0],m=e.vertices[2*c+1],g=e.vertices[2*u+0],v=e.vertices[2*u+1],y=f-s,b=m-h,x=Math.sqrt(y*y+b*b);y/=x,b/=x;let w=f-g,S=m-v,_=Math.sqrt(w*w+S*S);w/=_,S/=_,l.normals[2*i+0]=-S,l.normals[2*i+1]=w;let C=e.vertexIndices[c];if(Array.isArray(C))l.continuous[i]=!1;else{let[e,t]=r.getCurveIndexFromVertexId(C-1,!0);if(t>0&&t<1)l.continuous[i]=!0;else{let n=1===t?e+1:e-1;n=(n+p)%p;let a=1===t?0:1,o=r.roundedCurves[e].getTangent(t),s=r.roundedCurves[n].getTangent(a);l.continuous[i]=o.dot(s)>.95}}t&&(l.normals[2*i+0]*=-1,l.normals[2*i+1]*=-1),[d,c,u]=[c,u,u+1],u>=o&&(u-=a)}while(u!==n+1)}return{regions:[a,...o],infos:h,vertices:e.vertices}}_insertVertex(e,t,i,n,r){let a=2*t,o=3*t;e.positions[o+0]=i.x,e.positions[o+1]=i.y,e.positions[o+2]=i.z,e.normals[o+0]=n.x,e.normals[o+1]=n.y,e.normals[o+2]=n.z,e.uvs[a+0]=r.x,e.uvs[a+1]=r.y}_extrudeRegion(e,t,i,n,r,a,o){let s=new j_,l=new j_,c=new j_,d=new j_,u=new p_;i.forEach((a,o)=>{let h=n[o],p=e.verticesStart*i.length+e.verticesCount*o;for(let n=0;n<e.count;n++){let f=2*(e.start+n);if(s.set(t[f+0],t[f+1],0),c.copy(s).applyMatrix4(a).add(h),e.continuous[n])d.set(e.normals[2*n+0],e.normals[2*n+1],0);else{let i=0===n?2*(e.start+e.count-1):f-2;l.set(t[i+0],t[i+1],0),d.copy(s).sub(l),d.set(-d.y,d.x,0),e.isHole||d.negate()}if(d.applyMatrix4(a).normalize(),u.set(0===n?1:n/e.count,o/(i.length-1)),this._insertVertex(r,p,c,d,u),p++,!e.continuous[n]||0===n){if(0===n)d.set(e.normals[2*n+0],e.normals[2*n+1],0),u.set(0,o/(i.length-1));else{let i=n===e.count-1?2*e.start:f+2;l.set(t[i+0],t[i+1],0),d.copy(l).sub(s),d.set(-d.y,d.x,0),e.isHole||d.negate()}d.applyMatrix4(a).normalize(),this._insertVertex(r,p,c,d,u),p++}}});let h=i.length-1;for(let p=0;p<h;p++){let t=e.verticesStart*i.length+e.verticesCount*p,n=e.verticesStart*i.length+e.verticesCount*(p+1),r=0;for(let i=0;i<e.count;i++){(!e.continuous[i]||0===i)&&r++;let o=i===e.count-1?0:r+1,s=t+r,l=t+o,c=n+o,d=n+r;e.isHole?a.push(s,c,l,s,d,c):a.push(s,l,c,s,c,d),r++}}}_closeEnd(e,t,i,n,r,a,o){let s=e.vertexCount,l=new j_(0,0,o?-1:1).applyMatrix4(r),c=new j_,d=new p_;for(let h=0;h<s;h++){let i=2*h;c.set(e.vertices[i+0],e.vertices[i+1],0).applyMatrix4(r).add(a),this._insertVertex(n,t+h,c,l,d)}let u=e.elements;for(let h=0;h<e.elementCount;h++){let e=3*h,n=u[e+0]+t,r=u[e+(o?1:2)]+t,a=u[e+(o?2:1)]+t;i.push(n,r,a)}}applyMatrix4OnRange(e,t,i){let n,r,a,o,s=e.elements,l=(new f_).getNormalMatrix(e).elements,c=this.attributes.position,d=this.attributes.normal;if(!c||!d)return;let u=c.array,h=d.array,p=c.itemSize;for(let f=t*p,m=i*p;f<m;f+=p)n=u[f+0],r=u[f+1],a=u[f+2],o=1/(s[3]*n+s[7]*r+s[11]*a+s[15]),u[f+0]=(s[0]*n+s[4]*r+s[8]*a+s[12])*o,u[f+1]=(s[1]*n+s[5]*r+s[9]*a+s[13])*o,u[f+2]=(s[2]*n+s[6]*r+s[10]*a+s[14])*o,n=h[f+0],r=h[f+1],a=h[f+2],h[f+0]=l[0]*n+l[3]*r+l[6]*a,h[f+1]=l[1]*n+l[4]*r+l[7]*a,h[f+2]=l[2]*n+l[5]*r+l[8]*a;c.needsUpdate=!0,d.needsUpdate=!0}reverseIndicesOnRange(e,t){let i=this.index;if(i){for(let n=e;n<t;n+=3){let e=i.getX(n),t=i.getX(n+1),r=i.getX(n+2);i.setXYZ(n,r,t,e)}i.needsUpdate=!0}}};function PY(){let e=new vE;return e.setAttribute("position",new oE(new Float32Array([]),3)),e.setIndex(new oE(new Uint16Array([]),1)),e}var DY=PY().attributes,OY=class extends vE{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,DY),this.userData={parameters:e,type:"TextGeometry"};let i=t.getFont(e.font);null!==i&&void 0!==i&&i.isLoaded?(this.font=i,this.update(e,t)):this.updateFont(e.font,t).then(()=>{this.update(e,t),null===t||void 0===t||t.requestRender()})}async updateFont(e,t){let i=t.getFont(e);i&&(this.font=i,await i.loadingPromise)}update(e,t){let i=this.font;if(this.userData={parameters:e,type:"TextGeometry"},null===i||void 0===i||!i.isLoaded)return void console.warn("Cannot update text because its font is not loaded");let{width:n,height:r,depth:a,extrudeBevelSize:o,extrudeBevelSegments:s,text:l,textTransform:c}=e,d=eW.getDisplayedValue(l),u=function(e,t,i,n){let r="string"==typeof e.width?Number(n.getVariable(e.width)):e.width,a=[""],o="";for(let s of i)o+=s," "===s||"\n"===s?(a[a.length-1]+=o,o="","\n"===s&&a.push("")):t.getTextWidth(a[a.length-1]+o,e)>r&&(a[a.length-1].length&&a.push(""),t.getTextWidth(a[a.length-1]+o,e)>r&&(1===o.length?(a[a.length-1]+=o,o=""):(a[a.length-1]+=o.slice(0,-1),o=o[o.length-1],a.push(""))));return a[a.length-1]+=o,a}(e,i,2===c?d.toUpperCase():3===c?d.toLowerCase():d,t),{shapes:h,charWidths:p,charCoords:f}=i.generateShapes(u,e,t),m=.5*("number"==typeof n?n:Number(t.getVariable(n))),g=.5*("number"==typeof r?r:Number(t.getVariable(r))),v=h.map(e=>(new Hq).fromShape(e,!0));this.vectorShapes=v;let y=v.map(e=>CX.create({shape:e,parameters:{depth:a,extrudeBevelSegments:s,extrudeBevelSize:o,windingRule:a<=0?zq.NONZERO:zq.ODD,subdivisions:this.isLowResolution&&a>0?1:12}})),b=y.length?KW(y):PY();b.translate(-m,g,0),this.dispose(),this.wrappedText=u,this.charCoords=f,this.charWidths=p,this.deleteAttribute("extrudeNormal"),Object.entries(b.attributes).forEach(e=>{let[t,i]=e;this.setAttribute(t,i)}),this.setIndex(b.index),this.computeBoundingSphere()}clone(){let e=tN(new vE,OY.prototype);return e.copy(this),console.log("CloneGeometry",this,e),e}copy(e){return Object.entries(e.attributes).forEach(e=>{let[t,i]=e;this.setAttribute(t,i)}),this.setIndex(e.index),this.userData={parameters:c({},e.userData.parameters),type:"TextGeometry"},this}async setText(e,t){this.font&&await this.font.loadingPromise,await this.update(c(c({},this.userData.parameters),{},{text:{textValue:e}}),t)}get text(){var e;return null!==(e=this.userData.parameters.text)&&void 0!==e?e:""}};var IY,kY,RY=new Promise(e=>{IY=e}),zY=!1;function LY(e){if(!zY)return kY||(kY=async function(){let t=null!==e&&void 0!==e?e:"https://unpkg.com/@splinetool/modelling-wasm@1.10.48/build",n=i.e(917).then(i.bind(i,917)),[r,a]=await Promise.all([n,fetch("".concat(t,"/process.wasm")).then(e=>e.arrayBuffer())]),o=r.default,s=await o({wasmBinary:a});IY(s),zY=!0}(),kY)}var BY=["font"];function NY(e,t,i,n){let r,a,o;"PathGeometry"===e.type?(a=JSON.parse(JSON.stringify(e)),o=[[],["extrusion"]]):(a=c({},e),o=[[]]);for(let c of o){let e=a;for(let t of c)e=e[t];for(r in e){let i=e[r];WV(i)&&!BY.includes(r)&&(e[r]=t.getVariable(i,[n.uuid,"geometry",...c,r]),WV(e[r])&&(e[r]=1))}}let s,l={parameters:a,type:a.type};if("PathGeometry"===a.type)l.path=a.path;else if("VectorGeometry"===a.type){let e=Hq.createFromState(a.shape,a.width,a.height);l.shape=e}else if("NonParametricGeometry"===a.type){var d;if(a.data.groups&&null!==(d=a.data.groups)&&void 0!==d&&d.forEach(e=>{var t;return e.materialIndex=Math.max(null!==(t=e.materialIndex)&&void 0!==t?t:0,0)}),l.geometry=(new eO).parse(a),0===l.geometry.groups.length){var u,h;let e=l.geometry;e.addGroup(0,Math.max(null!==(u=null===(h=e.getIndex())||void 0===h?void 0:h.count)&&void 0!==u?u:0,e.getAttribute("position").count),0)}}else{if("SubdivGeometry"===a.type){let t=new XY(a,i);return t.data=e,t}if("TextGeometry"===a.type)return new OY(a,t);if("InputGeometry"===a.type)return new OY(a,t);if("UIGeometry"===a.type)return sY.create({parameters:{width:a.width,height:a.height,cornerRadius:a.cornerRadius,cornerType:a.cornerType}})}try{s=vQ(l)}catch(PV){console.error(PV)}if(!s){let e=Hq.createFromState(cj.defaultData(),100,100);l.shape=e,s=vQ(l)}return s}var FY=new yC;function UY(e,t,i,n){let r,a,o,s=e.position.array,l=e.normal.array,c=FY.makeScale(t,i,n).invert().elements;for(var d=0,u=s.length;d<u;d+=3)s[d]*=t,s[d+1]*=i,s[d+2]*=n,r=l[d],a=l[d+1],o=l[d+2],l[d]=c[0]*r+c[4]*a+c[8]*o,l[d+1]=c[1]*r+c[5]*a+c[9]*o,l[d+2]=c[2]*r+c[6]*a+c[10]*o;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var VY,jY=new G_,WY=new j_;RY.then(e=>{VY=e});var HY=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),GY=new Uint32Array([0,1,2,3]),qY=new Uint8Array([4]),XY=class extends vE{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let i=this.data.scaleBaked,n=xV.div(t,i);this.subdividedGeometry&&UY(this.subdividedGeometry.attributes,...n),this.originalGeometry&&UY(this.originalGeometry.attributes,...n),this.data=e;let r=this.userData.parameters;this.userData.parameters={width:r.width*n[0],height:r.height*n[1],depth:r.depth*n[2]},this.originalGeometry.boundingSphere.center.multiply(WY.fromArray(n));let a=WY.set(r.width,r.height,r.depth).length();this.originalGeometry.boundingSphere.radius=a/2}ensureSubdivPointer(){return 0===this.subdivPointer&&this.rebuild(),this.subdivPointer}rebuild(){var e;let t,i,n;try{({originalGeometry:t,subdividedGeometry:i,subdivPointer:n}=XY.build(this.data,void 0,!this.flatShading,void 0))}catch(a){t=new kE(100,100,100),n=0}this.subdivPointer=n,this.originalGeometry=t,this.subdividedGeometry=null!==i&&void 0!==i?i:void 0;let r=null!==(e=this.subdividedGeometry)&&void 0!==e?e:this.originalGeometry;Object.assign(this,r),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(XY.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;null===e.boundingSphere&&(e.boundingSphere=new cC,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,i=e.boundingSphere.center;jY.setFromBufferAttribute(t),jY.getCenter(i),e.boundingSphere.radius=i.distanceTo(jY.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),jY.getSize(WY);let n={width:WY.x,height:WY.y,depth:WY.z};return this.userData.parameters=n,n}static build(e,t,i,n){var r;let a,o,s,l=null!==(r=null===e||void 0===e?void 0:e.phongAngle)&&void 0!==r?r:35;!1===i&&(l=-1),t&&(VY.free_bvh(t),VY.free_subdivision_surface(t));try{a=XY.allocate(e,n)}catch(c){console.error(c,e),a=XY.allocate({positionWASM:HY,indexWASM:GY,verticesPerFaceWASM:qY},n)}if(VY.set_destination_refinement_level(a,0),o=XY.buildLevel(a,!0,l),e.subdivisions>0)try{VY.set_destination_refinement_level(a,e.subdivisions),s=XY.buildLevel(a,!1,l)}catch(d){try{VY.set_destination_refinement_level(a,e.subdivisions-1),s=XY.buildLevel(a,!1,l)}catch(u){s=null}}else s=null;return{subdivPointer:a,originalGeometry:o,subdividedGeometry:s}}static primitiveToQuads(e,t,i){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),"DodecahedronGeometry"===e.type&&(e.detail=0);let n,r,a,o,s,l,c=void 0!==e.shape||void 0!==e.path?t.geometry:NY(e,i,!1);if(n="TorusGeometry"===e.type&&e.arc===2*Math.PI?c.getClosedTorusIndicesForBooleanOrSubdiv():c.getIndex(),({positions:r,triIndices:s}=QY(c.getAttribute("position"),n)),"CylinderGeometry"===e.type&&0===e.cornerRadius&&0===e.hollow&&!1===e.openEnded){let t=e.radialSegments*e.heightSegments*3*2;l=[t,t+3*e.radialSegments]}return({indices:a,verticesPerFace:o}=eQ(r,s,c,l)),{positions:r,indices:a,verticesPerFace:o}}static allocate(e,t){var i;let n,r,a,o=[],s=[];e.positionWASM&&e.positionWASM.length>0?(n=e.positionWASM,r=e.indexWASM,a=e.verticesPerFaceWASM):(n=HY,r=GY,a=qY);let l,c=n.length,d=r.length,u=a.length,h=n.length+o.length+s.length,p=r.length+a.length,f=h*Float32Array.BYTES_PER_ELEMENT+p*Uint32Array.BYTES_PER_ELEMENT,m=h*Float32Array.BYTES_PER_ELEMENT,g=(Uint32Array.BYTES_PER_ELEMENT,VY._malloc(f)),v=new Float32Array(VY.HEAPF32.buffer,g,h),y=new Uint32Array(VY.HEAPU32.buffer,g+m,p);v.set(n,0),v.set(o,n.length),v.set(s,n.length+o.length),y.set(r,0),y.set(a,r.length),null!==e&&void 0!==e&&null!==(i=e.scaleBaked)&&void 0!==i&&i.some(e=>1!==e)&&(l=(new yC).makeScale(...e.scaleBaked)),t&&(l?l.premultiply(t):l=t);let b=l?VY.alloc_subdivision_surface2(g,c,g+m,d,g+m+r.length*Uint32Array.BYTES_PER_ELEMENT,u,l.elements):VY.alloc_subdivision_surface(g,c,g+m,d,g+m+r.length*Uint32Array.BYTES_PER_ELEMENT,u);return VY._free(g),b}static buildLevel(e,t,i,n,r){let a=r?VY.get_mesh_data2(e,t?VY.Level.CONTROL:VY.Level.REFINED,i,r.elements):VY.get_mesh_data(e,t?VY.Level.CONTROL:VY.Level.REFINED,i),o=VY.HEAPU32.subarray(a>>2,8+(a>>2)),s=o.subarray(4,8),l=0,c=VY.HEAPU32[o[l]>>2],d=VY.HEAPF32.subarray(c>>2,(c>>2)+s[l]);l++;let u=VY.HEAPU32[o[l]>>2],h=VY.HEAPF32.subarray(u>>2,(u>>2)+s[l]);l++;let p=VY.HEAPU32[o[l]>>2],f=VY.HEAPU32.subarray(p>>2,(p>>2)+s[l]);l++;let m=VY.HEAPU32[o[l]>>2],g=VY.HEAPU32.subarray(m>>2,(m>>2)+s[l]);if(l++,void 0===n){let e=new vE;if(e.setIndex(new lE(g,1)),e.setAttribute("position",new cE(d,3)),e.setAttribute("normal",new cE(h,3)),t){e.setAttribute("faceMap",new lE(f,1));let t=new Float32Array(h.length/3*4).fill(0);e.setAttribute("color",new oE(t,4))}return VY.free_mesh_data(a),e.userData.type="SubdivGeometry",e}n.getAttribute("position").copyArray(d),n.getAttribute("normal").copyArray(h),n.attributes.position.needsUpdate=!0,n.attributes.normal.needsUpdate=!0,VY.free_mesh_data(a)}static freeSubdivPointer(e){VY.free_bvh(e),VY.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,i){let n=VY.get_wireframe_data_for_base_level(e),r=VY.HEAPU32.subarray(n>>2,4+(n>>2)),a=r.subarray(2,4),o=0,s=VY.HEAPU32[r[o]>>2],l=VY.HEAPF32.subarray(s>>2,(s>>2)+a[o]);o++;let c=VY.HEAPU32[r[o]>>2],d=VY.HEAPU32.subarray(c>>2,(c>>2)+a[o]);if(void 0===t){let e=new vE;e.setAttribute("position",new cE(l,3));let t=new Float32Array(l.length);for(let n=0,r=l.length;n<r;)t[n++]=i.r,t[n++]=i.g,t[n++]=i.b;return e.setAttribute("color",new oE(t,3)),e.setIndex(new lE(d,1)),VY.free_wireframe_data_for_base_level(n),e}t.getAttribute("position").copyArray(l),t.attributes.position.needsUpdate=!0,VY.free_wireframe_data_for_base_level(n)}static updateCollabMesh(e,t,i){let n=0===t;n||VY.set_destination_refinement_level(e,t);let r=i?VY.get_topological_data2(e,n?VY.Level.CONTROL:VY.Level.REFINED,i.elements):VY.get_topological_data(e,n?VY.Level.CONTROL:VY.Level.REFINED),a=VY.HEAPU32.subarray(r>>2,6+(r>>2)),o=a.subarray(3,6),s=0,l=VY.HEAPU32[a[s]>>2],c=new Float32Array(VY.HEAPF32.subarray(l>>2,(l>>2)+o[s]));s++;let d=VY.HEAPU32[a[s]>>2],u=new Uint32Array(VY.HEAPU32.subarray(d>>2,(d>>2)+o[s]));s++;let h=VY.HEAPU32[a[s]>>2],p=new Uint8Array(VY.HEAPU32.subarray(h>>2,(h>>2)+o[s]));return VY.free_topological_data(r),{positions:c,indices:u,verticesPerFace:p}}},YY=["getX","getY","getZ"];function QY(e,t){let i={},n=t?t.count:e.count,r=0,a=[],o=[];for(let l=0;l<n;l++){let n=t?t.getX(l):l,s="";for(let t=0;t<3;t++)s+="".concat(~~(1e4*e[YY[t]](n)),",");if(s in i)a.push(i[s]);else{for(let t=0;t<3;t++)o.push(e[YY[t]](n));i[s]=r,a.push(r),r++}}let s=[];for(let l=0;l<a.length;l+=3)a[l]===a[l+1]||a[l]===a[l+2]||a[l+1]===a[l+2]||s.push(a[l],a[l+1],a[l+2]);return{positions:o,triIndices:s}}var KY=new j_,ZY=new j_,JY=new j_,$Y=new j_;function eQ(e,t,i,n){let r=[],a=[];if(void 0!==i.userData.shape&&0===i.userData.parameters.depth&&0===i.userData.shape.shapeHoles.length){let t=i.userData.shape.extractShapePointsToFlatArray([]),n=i.userData.parameters.spikes;if("EllipseGeometry"===i.userData.type&&n<=24&&n%4===0&&i.userData.parameters.angle>=360){let e=t.length/2/n;t=t.filter((t,i)=>Math.floor(i/2)%e===0)}let o=0;for(let e=0;e<t.length;e+=2)o+=(t[e]-t[(0===e?t.length:e)-2])*(t[e+1]+t[(0===e?t.length:e)-1]);e.length=0;let s=0;if(o<0)for(let i=0;i<t.length;i+=2)e.push(t[i],t[i+1],0),r.push(s++);else for(let i=t.length-2;i>=0;i-=2)e.push(t[i],t[i+1],0),r.push(s++);return a.push(s),{indices:r,verticesPerFace:a}}let o=new Float32Array([i.userData.parameters.depth])[0],s=0;for(;s<t.length;){if(i.useNgonForTopBottomFaceDuringBake){let i=0;if((e[3*t[s]+2]===o||0===e[3*t[s]+2])&&i++,(e[3*t[s+1]+2]===o||0===e[3*t[s+1]+2])&&i++,(e[3*t[s+2]+2]===o||0===e[3*t[s+2]+2])&&i++,3===i)break}if(t[s+1]===t[s+3]&&t[s+2]===t[s+5]||t[s+0]===t[s+3]&&t[s+2]===t[s+4]){KY.set(e[3*t[s]],e[3*t[s]+1],e[3*t[s]+2]),ZY.set(e[3*t[s+1]],e[3*t[s+1]+1],e[3*t[s+1]+2]),JY.set(e[3*t[s+4]],e[3*t[s+4]+1],e[3*t[s+4]+2]),$Y.set(e[3*t[s+5]],e[3*t[s+5]+1],e[3*t[s+5]+2]),ZY.sub(KY).normalize(),JY.sub(KY).normalize(),$Y.sub(KY).normalize();let i=ZY.cross(JY).dot($Y);Math.abs(i)>.005||n&&n.some((e,t)=>t%2!==1&&(s>=n[t]&&s<n[t+1]))?(r.push(t[s],t[s+1],t[s+2]),a.push(3),s+=3):(r.push(t[s],t[s+1],t[s+4],t[s+5]),a.push(4),s+=6)}else r.push(t[s],t[s+1],t[s+2]),a.push(3),s+=3}if(i.useNgonForTopBottomFaceDuringBake){let t=[],n=[],s=0;for(let i=0,r=0;i<e.length;i+=3,r++)0===e[i+2]&&(t.push(r),s++),e[i+2]===o&&n.push(r);if(0===i.userData.parameters.extrudeBevelSize){let e=n[0];n[0]=n[1],n[1]=e}t.reverse(),r.push(...t,...n),a.push(s,s)}return{indices:r,verticesPerFace:a}}var tQ={};((e,t)=>{for(var i in t)Ew(e,i,{get:t[i],enumerable:!0})})(tQ,{calcBoolean:()=>uQ,calcBooleanTopological:()=>dQ,freeMeshSet:()=>mQ,getMeshSet:()=>hQ,hasOpenEdges:()=>pQ,transformMeshSet:()=>fQ});var iQ,nQ,rQ,aQ,oQ=new Promise(e=>{iQ=e});function sQ(e){if(nQ)return nQ;return nQ=async function(){let t=null!==e&&void 0!==e?e:"https://unpkg.com/@splinetool/boolean-wasm@1.10.48/build",n=i.e(516).then(i.bind(i,516)),[r,a]=await Promise.all([n,fetch("".concat(t,"/boolean.wasm")).then(e=>e.arrayBuffer())]),o=r.default,s=await o({wasmBinary:a});iQ(s)}(),nQ}function lQ(e){let t=e.length,i=t*Uint32Array.BYTES_PER_ELEMENT,n=t*Float32Array.BYTES_PER_ELEMENT,r=Number.isInteger(e[0])?i:n,a=rQ._malloc(r);return(Number.isInteger(e[0])?new Uint32Array(rQ.HEAPU32.buffer,a,t):new Float32Array(rQ.HEAPF32.buffer,a,t)).set(e,0),a}function cQ(e){switch(e){case 0:return rQ.OP.UNION;case 1:return rQ.OP.INTERSECTION;case 2:return rQ.OP.A_MINUS_B;default:throw new Error("Unknown boolean operation "+e)}}function dQ(e,t){void 0===aQ&&(aQ=rQ.init_csg());let i=lQ(e),n=rQ.csg_calc_topological(aQ,i,e.length,cQ(t));rQ._free(i);let r=rQ.HEAPU32.subarray(n>>2,6+(n>>2)),a=r.subarray(3,6),o=0,s=rQ.HEAPU32[r[o]>>2],l=new Float32Array(rQ.HEAPF32.subarray(s>>2,(s>>2)+a[o]));o++;let c=rQ.HEAPU32[r[o]>>2],d=new Uint32Array(rQ.HEAPU32.subarray(c>>2,(c>>2)+a[o]));o++;let u=rQ.HEAPU32[r[o]>>2],h=new Uint8Array(rQ.HEAPU32.subarray(u>>2,(u>>2)+a[o]));return rQ.free_mesh_data(n),{positions:l,indices:d,verticesPerFace:h}}function uQ(e,t,i,n){void 0===aQ&&(aQ=rQ.init_csg());let r=lQ(e),a=rQ.csg_calc(aQ,r,e.length,n,cQ(t));rQ._free(r);let o=rQ.HEAPU32.subarray(a>>2,5+(a>>2)),s=o.subarray(2,5),l=0,c=rQ.HEAPU32[o[l]>>2],d=rQ.HEAPF32.subarray(c>>2,(c>>2)+s[l]);l++;let u=rQ.HEAPU32[o[l]>>2],h=rQ.HEAPF32.subarray(u>>2,(u>>2)+s[l]);l++;let p=s[l];i.setAttribute("position",new cE(d,3)),i.setAttribute("normal",new cE(h,3));let f=rQ.HEAPF32.subarray(5+(a>>2),5+(a>>2)+6);return null===i.boundingSphere&&(i.boundingSphere=new cC),i.boundingSphere.center.set(f[0],f[1],f[2]),i.boundingSphere.radius=(f[3]**2+f[4]**2+f[5]**2)**.5,i.userData.parameters={width:2*f[3],height:2*f[4],depth:2*f[5]},rQ.free_mesh_data(a),p}function hQ(e,t,i){if(void 0===rQ)return-1;let n,r,a;if(t&&void 0!==e.userData.positions){let t=e.userData;a=t.verticesPerFace.length,n=t.positions,r=Array(t.verticesPerFace.reduce((e,t)=>e+t,0)+a);for(let e=0,i=0,n=0;e<t.verticesPerFace.length;e++){r[n++]=t.verticesPerFace[e];for(let a=0;a<t.verticesPerFace[e];a++)r[n++]=t.indices[i++]}}else({positions:n,faceIndices:r,nFaces:a}=function(e,t,i){let n,r;r="TorusGeometry"===e.userData.parameters.type&&e.userData.parameters.arc===2*Math.PI?e.getClosedTorusIndicesForBooleanOrSubdiv():e.getIndex();let a,{positions:o,triIndices:s}=QY(e.getAttribute("position"),r);if(t&&i){let{indices:t,verticesPerFace:i}=eQ(o,s,e);a=i.length,n=[];for(let e=0,r=0;e<a;e++){n.push(i[e]);for(let a=0;a<i[e];a++)n.push(t[r++])}}else{let e=s.length;n=Array(e+e/3),a=0;for(let t=0,i=0;i<n.length;)n[i++]=3,a++,n[i++]=s[t++],n[i++]=s[t++],n[i++]=s[t++]}return{positions:o,faceIndices:n,nFaces:a}}(e,t,i));let o=n.length,s=r.length,l=n.length,c=r.length,d=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,u=l*Float32Array.BYTES_PER_ELEMENT,h=(Uint32Array.BYTES_PER_ELEMENT,rQ._malloc(d)),p=new Float32Array(rQ.HEAPF32.buffer,h,l),f=new Uint32Array(rQ.HEAPU32.buffer,h+u,c);p.set(n,0),f.set(r,0);let m=rQ.get_csg_mesh(h,o,h+u,s,a);return rQ._free(h),m}function pQ(e){return rQ.has_open_edges(e)}function fQ(e,t){rQ.transform_csg_mesh(e,t.elements)}function mQ(e){rQ.free_csg_mesh(e)}oQ.then(e=>rQ=e);var gQ={ConeGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r;let a=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return a.thetaLength=h_.clamp(a.thetaLength,0,360),{parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(n=a.height)&&void 0!==n?n:a.width),depth:Math.abs(null!==(r=a.depth)&&void 0!==r?r:a.width)})}}static build(e){let t,{width:i,depth:n,height:r,radialSegments:a,heightSegments:o,openEnded:s,thetaStart:l,thetaLength:d,cornerRadiusTop:u,cornerRadiusBottom:h,cornerSegments:p}=e.parameters;return 0===d?(t=new vE,t.setAttribute("position",new cE([],3))):t=u>0||h>0||d<360?new iq(0,i/2,r,a,o,s,l,d*Math.PI/180,u,h,p,0,!0):new AP(i/2,r,a,o,s),t.scale(1,1,n/i),Object.assign(t,{userData:c(c({},e),{},{type:"ConeGeometry"})})}},CubeGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r;let a=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(n=a.height)&&void 0!==n?n:a.width),depth:Math.abs(null!==(r=a.depth)&&void 0!==r?r:a.width)})}}static build(e){let t,{width:i,height:n,depth:r,widthSegments:a,heightSegments:o,depthSegments:s,cornerRadius:l,cornerSegments:d}=e.parameters;return t=0===l?new kE(i,n,r,a,o,s):new rq(i,n,r,a,o,s,l,d),Object.assign(t,{userData:c(c({},e),{},{type:"CubeGeometry"})})}},CylinderGeometry:$G,DodecahedronGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r;let a=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(n=a.height)&&void 0!==n?n:a.width),depth:Math.abs(null!==(r=a.depth)&&void 0!==r?r:a.width)})}}static build(e){let{width:t,height:i,depth:n,detail:r,corner:a,cornerSides:o}=e.parameters,s=0===r&&0!==a?new oq(.5*t,a,o):new TP(.5*t,r);return s.scale(1,i/t,n/t),Object.assign(s,{userData:c(c({},e),{},{type:"DodecahedronGeometry"})})}},EllipseGeometry:AX,HelixGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r;let a=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),o=Math.abs(a.width),s=Math.abs(null!==(n=a.height)&&void 0!==n?n:o),l=Math.abs(null!==(r=a.depth)&&void 0!==r?r:o),c=Math.abs(Math.min(o,l))/2;return{parameters:Object.assign(a,{width:o,height:s,depth:l,radius:c,segments:Math.round(a.segments),pathSegments:Math.round(a.pathSegments),cornerSegments:Math.round(a.cornerSegments)})}}static build(e){let{width:t,height:i,depth:n,radius:r,revolutions:a,segments:o,pathRadius:s,pathType:l,pathSegments:d,cornerRadius:u,cornerSegments:h}=e.parameters,p=new RX(!1,t,i,n,r,a,o,s,l,d,u,h);return Object.assign(p,{userData:c(c({},e),{},{type:"HelixGeometry"})})}},IcosahedronGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r;let a=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(n=a.height)&&void 0!==n?n:a.width),depth:Math.abs(null!==(r=a.depth)&&void 0!==r?r:a.width)})}}static build(e){let{width:t,height:i,depth:n,detail:r,corner:a,cornerSides:o}=e.parameters,s=0===r&&0!==a?new zX(.5*t,a,o):new rD(.5*t,r);return s.scale(1,i/t,n/t),Object.assign(s,{userData:c(c({},e),{},{type:"IcosahedronGeometry"})})}},LatheGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r,a,o;(null!==(i=null===(n=e.parameters)||void 0===n?void 0:n.points)&&void 0!==i?i:[]).forEach(e=>{Array.isArray(e)&&(e.x=e[0],e.y=e[1])});let s=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(a=s.height)&&void 0!==a?a:s.width),depth:Math.abs(null!==(o=s.depth)&&void 0!==o?o:s.width)})}}static build(e){let{points:t,segments:i,verticalSegments:n}=e.parameters,r=new PP;r.moveTo(t[0].x,t[0].y),r.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let a=new CP(r.extractPoints(n).shape,i);return a.rotateZ(Math.PI),Object.assign(a,{userData:c(c({},e),{},{type:"LatheGeometry"})})}},NonParametricGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n;let r,a=null!==(i=null!==(n=e.geometry)&&void 0!==n?n:null===t||void 0===t?void 0:t.geometry)&&void 0!==i?i:(new vE).copy(new kE(100,100,100));void 0===t?(a.computeBoundingBox(),a.boundingBox.getSize(tY),r={width:tY.x,height:tY.y,depth:tY.z,subdivisions:0}):r=t.parameters;let o=c(c({},r),e.parameters);return{parameters:{width:Math.abs(o.width),height:Math.abs(o.height),depth:Math.abs(o.depth),subdivisions:Math.abs(o.subdivisions)},geometry:a}}static build(e){var t;let{width:i,height:n,depth:r,subdivisions:a}=e.parameters,o=null!==(t=e.geometry)&&void 0!==t?t:(new vE).copy(new kE(100,100,100)),s=o.userData.parameters;void 0===s?(o.computeBoundingBox(),o.boundingBox.getSize(tY)):tY.set(s.width,s.height,s.depth),(i!==tY.x||n!==tY.y||r!==tY.z)&&o.scale(0===tY.x?1:i/tY.x,0===tY.y?1:n/tY.y,0===tY.z?1:r/tY.z);let l=o.originalGeometry;try{a>0?(void 0===l||(null===s||void 0===s?void 0:s.subdivisions)!==a)&&(void 0===l&&(l=o),o=new eY(a).modify(l).toBufferGeometry()):(void 0!==l&&(o=l),l=void 0,void 0===o.getAttribute("normal")&&o.computeVertexNormals())}catch(d){void 0!==l&&(o=l),l=void 0,void 0===o.getAttribute("normal")&&o.computeVertexNormals()}return void 0!==l&&Object.assign(o,{originalGeometry:l}),delete e.geometry,Object.assign(o,{userData:c(c({},e),{},{type:"NonParametricGeometry"})})}static loadFromUrl(e,t,i){new eO(i).load(e,e=>{let i=this.normalizeInputs({geometry:e});e.boundingBox.getSize(tY);let n=100/tY.x;Object.assign(i.parameters,{width:100,height:tY.y*n,depth:tY.z*n}),t(this.build(i))})}},PolygonGeometry:iY,PyramidGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r;let a=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(n=a.height)&&void 0!==n?n:a.width),depth:Math.abs(null!==(r=a.depth)&&void 0!==r?r:a.width)})}}static build(e){let{width:t,height:i,depth:n,radialSegments:r,heightSegments:a,openEnded:o,cornerRadius:s,cornerSegments:l}=e.parameters,d=new oY(.5*t,i,r,a,o,s,l);return d.scale(1,1,n/t),Object.assign(d,{userData:c(c({},e),{},{type:"PyramidGeometry"})})}},RectangleGeometry:sY,SphereGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r;let a=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},e.parameters);return a.thetaLength=h_.clamp(a.thetaLength,0,180),{parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(n=a.height)&&void 0!==n?n:a.width),depth:Math.abs(null!==(r=a.depth)&&void 0!==r?r:a.width)})}}static build(e){let t,{width:i=100,height:n=i,depth:r=i,widthSegments:a=64,heightSegments:o=64,phiStart:s,phiLength:l,thetaStart:d,thetaLength:u}=e.parameters;return 0===u?(t=new vE,t.setAttribute("position",new cE([],3))):t=new aD(.5*i,a,o,s,l,d,u*h_.DEG2RAD),t.scale(1,n/i,r/i),Object.assign(t,{userData:c(c({},e),{},{type:"SphereGeometry"})})}},PlaneGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n;let r=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(null!==(n=r.height)&&void 0!==n?n:r.width),depth:0})}}static build(e){let{width:t=100,height:i=t,widthSegments:n=8,heightSegments:r=8}=e.parameters,a=new eA(t,i,n,r);return a.scale(1,1,1),Object.assign(a,{userData:c(c({},e),{},{type:"PlaneGeometry"})})}},BackdropGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r;let a=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(n=a.height)&&void 0!==n?n:a.width),depth:Math.abs(null!==(r=a.depth)&&void 0!==r?r:a.width)})}}static build(e){let{width:t,height:i,depth:n,angle:r,cornerRadius:a,cornerSegments:o}=e.parameters,s=new lY(t,i,n,r,a,o);return Object.assign(s,{userData:c(c({},e),{},{type:"BackdropGeometry"})})}},StarGeometry:cY,TextFrameGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r;let a=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,depth:0},e.parameters);return{parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(n=a.height)&&void 0!==n?n:a.width),depth:Math.abs(null!==(r=a.depth)&&void 0!==r?r:0)})}}static build(e){let{width:t,height:i}=e.parameters,n=new eA(t,i);return Object.assign(n,{userData:c(c({},e),{},{type:"TextFrameGeometry"})})}},TorusGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r;let a=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},e.parameters),o=Math.abs(a.width),s=Math.abs(null!==(n=a.height)&&void 0!==n?n:a.width);a.shapeBlendNode&&(s=o);let l=Math.round(Math.abs(null!==(r=a.depth)&&void 0!==r?r:.25*a.width));return{parameters:Object.assign(a,{width:o,height:s,depth:l})}}static build(e){let{width:t,height:i,depth:n,radialSegments:r,tubularSegments:a,arc:o,cornerRadius:s,cornerSegments:l}=e.parameters,d=function(e,t,i,n,r,a,o,s,l,c,d){[t,i]=[i,t],o=t/2;let u=h_.clamp(r/360,0,1);if(0===u){let e=new vE;return e.setAttribute("position",new cE([],3)),e}return 1===u&&(c=0),new RX(!0,e,t,i,n,u,a,o,s,l,c,d)}(t,i,n,.5*t,o,a,0,0,r,s,l);return d.scale(1,i/t,1),Object.assign(d,{userData:c(c({},e),{},{type:"TorusGeometry"})})}},TorusKnotGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r,a;let o=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(o,{width:Math.abs(o.width),height:Math.abs(null!==(n=o.height)&&void 0!==n?n:o.width),depth:Math.abs(null!==(r=o.depth)&&void 0!==r?r:o.width),tube:null!==(a=o.tube)&&void 0!==a?a:.125*o.width})}}static build(e){let{width:t,tube:i,tubularSegments:n,radialSegments:r,p:a,q:o}=e.parameters,s=.5*t;s!==i&&(s-=i);let l=new sD(s,i,n,r,a,o);return Object.assign(l,{userData:c(c({},e),{},{type:"TorusKnotGeometry"})})}},TriangleGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r;let a=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof Hq?e.shape:new Hq,parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(n=a.height)&&void 0!==n?n:a.width*(a.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(null!==(r=a.depth)&&void 0!==r?r:0)})}}static build(e){let{width:t=100,height:i,cornerRadius:n,depth:r,extrudeBevelSize:a,extrudeBevelSegments:o,isRect:s}=e.parameters,l=e.shape,d=.5*t,u=.5*i;s?(l.addPoint(l.createPoint(-d,u)),l.addPoint(l.createPoint(d,-u)),l.addPoint(l.createPoint(-d,-u))):(l.addPoint(l.createPoint(0,u)),l.addPoint(l.createPoint(d,-u)),l.addPoint(l.createPoint(-d,-u))),l.isClosed=!0;for(let c=0,p=l.points.length;c<p;c++)l.points[c].roundness=n;l.roundness=n,l.update();let h=CX.create({shape:l,parameters:{roundness:n,depth:r,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(h,{userData:c(c({},e),{},{type:"TriangleGeometry"})})}},PathGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,r,a,o;let s=Object.assign({},null!==(i=null===t||void 0===t?void 0:t.parameters)&&void 0!==i?i:{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),l=Math.abs(s.width),d=Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width),u=Math.abs(null!==(r=s.depth)&&void 0!==r?r:0),h=null!==(a=null===t||void 0===t?void 0:t.shapeData)&&void 0!==a?a:AX.create({parameters:fj}).userData.shape;return{path:null!==(o=e.path)&&void 0!==o?o:dj.defaultData(),parameters:Object.assign(s,{width:l,height:d,depth:u,extrusion:c(c({},yj),s.extrusion)}),shapeData:h}}static build(e){if(e.path.points.length>=2){let t=new TY(e);return Object.assign(t,{userData:c(c({},e),{},{type:"PathGeometry"})})}return Object.assign(new vE,{userData:c(c({},e),{},{type:"PathGeometry"})})}},VectorGeometry:CX},vQ=e=>gQ[e.type].create(e);function yQ(e){return null!==e&&"booleanOp"in e}var bQ=class extends(JG(OE)){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new yC}updateVisible(e){super.updateVisible(e),this.visible=!yQ(this.parent)&&this.visible,yQ(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){-1!==this.booleanMeshSetAddress&&(tQ.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.booleanWasTransformed=!0:this.freeBooleanPointer(),yQ(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof bQ&&(e.freeBooleanPointer(),yQ(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e,t){let i=super.updateTransformState(e,t);return i&&yQ(this.parent)&&this.invalidateDownstreamBooleanData(!0),i}onVariableUpdate(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super.onVariableUpdate(e),yQ(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},xQ=new G_;function wQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.count,n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,a=1/0,o=1/0,s=1/0,l=-1/0,c=-1/0,d=-1/0;for(let u=t;u<i;u++){let t=e.getX(u),i=e.getY(u),n=e.getZ(u);t<a&&(a=t),i<o&&(o=i),n<s&&(s=n),t>l&&(l=t),i>c&&(c=i),n>d&&(d=n)}xQ.min.set(a,o,s),xQ.max.set(l,c,d),xQ.getCenter(n),xQ.getSize(r).multiplyScalar(.5)}var SQ=new vE,_Q=new nE,CQ=class extends bQ{constructor(e,t){super(SQ,_Q),this.super_Entity(e,t)}updateState(e,t){this.updateState_Entity(e,t)}updateEntityBoxSize(e,t){let i=this.geometry.getAttribute("position");void 0!==i?wQ(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,e,t):super.updateEntityBoxSize(e,t)}},EQ=class{constructor(e){if(this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},null===EQ.uuidContext)throw new Error("plz startContext");EQ.uuidContext===EQ.globalContext?this.uuid="_gid"+EQ.uuidContext.nodeContextUuid++:this.uuid="_uid"+EQ.uuidContext.nodeContextUuid++,this.type=e,this.name=""}static startContext(e){null===this.uuidContext||this.uuidContext===EQ.globalContext?this.uuidContext=e:console.error("Can't start context twice")}static endContext(e){this.uuidContext!==e&&console.error("Can't end context twice"),this.uuidContext=null}analyze(e,t){t=null!==t&&void 0!==t?t:{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,i){return i=null!==i&&void 0!==i?i:{},this.analyze(e,i),this.flow(e,t,i)}flow(e,t,i){i=null!==i&&void 0!==i?i:{},e.addFlow(i.slot,i.cache,i.context);let n={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),n}build(e,t,i){t=null!==t&&void 0!==t?t:this.getType(e,t);let n=e.getNodeData(null!==i&&void 0!==i?i:this);return e.analyzing&&this.appendDepsNode(e,n,t),-1===e.nodes.indexOf(this)&&e.nodes.push(this),void 0!==this.updateFrame&&-1===e.updaters.indexOf(this)&&e.updaters.push(this),this.generate(e,t,i)}updateFrame(e){}generateReadonly(e,t,i,n,r,a){return""}generate(e,t,i,n,r){return""}parse(e,t,i,n){}appendDepsNode(e,t,i){t.deps=(t.deps||0)+1;let n=e.getTypeLength(i);(n>(t.outputMax||0)||this.getType(e,i))&&(t.outputMax=n,t.output=i)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return"sampler2D"===t||"samplerCube"===t?t:this.type}},AQ=EQ;AQ.globalContext={nodeContextUuid:0},AQ.uuidContext=EQ.globalContext;var MQ=class{constructor(e){e=null!==e&&void 0!==e?e:{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},TQ=new class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,i){i=void 0===i||i,this.keywords[e]={callback:t,cache:i}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return void 0!==this.nodes[e]}containsKeyword(e){return void 0!==this.keywords[e]}},PQ=class extends AQ{constructor(e,t){super(e),this.scope="",t=null!==t&&void 0!==t?t:{},this.shared=void 0===t.shared||t.shared,this.unique=void 0!==t.unique&&t.unique}build(e,t,i,n){if(t=null!==t&&void 0!==t?t:this.getType(e),this.getShared(e,t)){let r=this.getUnique(e,t);r&&void 0===this.uuid&&(this.uuid=h_.generateUUID()),i=e.getUUID(null!==i&&void 0!==i?i:this.getUUID(),!r);let a=e.getNodeData(i),o=a.output||this.getType(e);if(e.analyzing)return(a.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,a,t),this.generate(e,t,i)):super.build(e,t,i);if(r)return a.name=a.name||super.build(e,t,i),a.name;if(!this.getLabel()&&(!this.getShared(e,o)||e.context.ignoreCache||1===a.deps))return super.build(e,t,i);i=this.getUUID(!1);let s=this.getTemp(e,i);if(s)return e.format(s,o,t);{s=super.generate(e,t,i,a.output,n);let r=this.generate(e,o,i);return e.addNodeCode(s+" = "+r+";"),e.format(s,o,t)}}return super.build(e,t,i)}getShared(e,t){return"sampler2D"!==t&&"samplerCube"!==t&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return"string"==typeof this.scope&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let i=e.getVars()[t];return i?i.name:void 0}generate(e,t,i,n,r){return this.getShared(e,t)||console.error("TempNode is not shared"),i=null!==i&&void 0!==i?i:this.uuid,e.getTempVar(i,null!==n&&void 0!==n?n:this.getType(e),r,this.getLabel()).name}},DQ=class extends PQ{constructor(e,t){(t=null!==t&&void 0!==t?t:{}).shared=void 0!==t.shared&&t.shared,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,i,n,r,a){i=e.getUUID(null!==i&&void 0!==i?i:this.getUUID()),n=null!==n&&void 0!==n?n:this.getType(e);let o=e.getNodeData(i);return this.getReadonly()&&void 0!==this.generateReadonly?this.generateReadonly(e,t,i,n,r,a):e.isShader("vertex")?(o.vertex||(o.vertex=e.createVertexUniform(n,this,r,a,this.getLabel())),e.format(o.vertex.name,n,t)):(o.fragment||(o.fragment=e.createFragmentUniform(n,this,r,a,this.getLabel())),e.format(o.fragment.name,n,t))}},OQ=class extends DQ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;super("v2"),this.nodeType="Vector2",this.value=e instanceof p_?e:new p_(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,i,n,r,a){return e.format("vec2("+this.value.x+", "+this.value.y+")",n,t)}},IQ=class extends DQ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;super("v3"),this.nodeType="Vector3",this.value=e instanceof j_?e:new j_(e,t,i)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}get z(){return this.value.z}set z(e){this.value.z=e}generateReadonly(e,t,i,n,r,a){return e.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",n,t)}},kQ=class extends D_{constructor(e,t,i,n){super(e,t,i),this.isColorA=!0,this.a=n}setRGBA(e,t,i,n){super.setRGB(e,t,i),this.a=n}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}equals(e){return super.equals(e)&&this.a===e.a}setStyle(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"srgb";if("transparent"===e)return this.setRGBA(0,0,0,0),this;if(t=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(e)){let n,r=t[1],a=t[2];switch(r){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.a="rgba"===r?parseFloat(n[4]):1,super.setStyle(e,i);break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.a="hsla"===r?parseFloat(n[4]):1,super.setStyle(e,i)}}return super.setStyle(e,i)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},RQ=class extends DQ{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof kQ?e:new kQ(e.r,e.g,e.b,e.a)}generateReadonly(e,t,i,n,r,a){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",n,t)}},zQ=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,LQ=/[a-z_0-9]+/gi,BQ=class extends PQ{constructor(e,t,i,n,r){super(r),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=void 0===r,this.isInterface=!1,this.parse(e,t,i,n)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,i,n,r){let a,o=0,s=this.src;if(this.includes)for(let c=0;c<this.includes.length;c++)e.include(this.includes[c],this);for(let c in this.extensions)e.extensions[c]=!0;let l=[];for(;a=LQ.exec(this.src);)l.push(a);for(let c=0;c<l.length;c++){let t=l[c],i=t[0],n=!this.isMethod||!this.getInputByName(i),r=i;if(this.keywords[i]||this.useKeywords&&n&&TQ.containsKeyword(i)){let t=this.keywords[i];if(!t){let n=TQ.getKeywordData(i);n.cache&&(t=e.keywords[i]),t=t||TQ.getKeyword(i,e),n.cache&&(e.keywords[i]=t)}r=t.build(e)}i!==r&&"."!==s[t.index+o-1]&&(s=s.substring(0,t.index+o)+r+s.substring(t.index+i.length+o),o+=r.length-i.length),void 0===this.getIncludeByName(r)&&TQ.contains(r)&&e.include(TQ.get(r))}return"source"===t?s:this.isMethod?(this.isInterface||e.include(this,void 0,s),this.name):e.format("( "+s+" )",this.getType(e),t)}parse(e,t,i,n){if(this.src=e||"",this.includes=null!==t&&void 0!==t?t:[],this.extensions=null!==i&&void 0!==i?i:{},this.keywords=null!==n&&void 0!==n?n:{},this.isMethod){let e=zQ.exec(this.src);if(this.inputs=[],e&&4==e.length){this.type=e[1],this.name=e[2];let t=e[3].match(LQ);if(t){let e=0;for(;e<t.length;){let i,n=t[e++];"in"===n||"out"===n||"inout"===n?i=t[e++]:(i=n,n="");let r=t[e++];this.inputs.push({name:r,type:i,qualifier:n})}}this.isInterface=-1===this.src.indexOf("{")}else this.type="",this.name=""}}},NQ=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,FQ=class extends PQ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||FQ.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,i,n,r){this.src=e||"";let a,o,s="",l=NQ.exec(e);this.useDefine=null!==r&&void 0!==r?r:"#"===this.src.charAt(0),l&&l.length>1?(o=l[1],a=l[2],s=l[3]):(a=this.src,o="f"),this.name=a,this.type=o,this.value=s}build(e,t){if("source"===t){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,i,n,r){return e.format(this.name,this.getType(e),t)}},UQ=FQ;UQ.PI="PI",UQ.PI2="PI2",UQ.RECIPROCAL_PI="RECIPROCAL_PI",UQ.RECIPROCAL_PI2="RECIPROCAL_PI2",UQ.LOG2="LOG2",UQ.EPSILON="EPSILON";var VQ=new RegExp("^structs*([a-z_0-9]+)s*{s*((.|\n)*?)}","gim"),jQ=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),WQ=class extends PQ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,i,n,r){return"source"===t?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.src=e,this.inputs=[];let t=VQ.exec(e);if(t){let e,i=t[2];for(;e=jQ.exec(i);)this.inputs.push({type:e[1],name:e[2]});this.name=t[1]}else this.name="";this.type=this.name}},HQ=class extends PQ{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=null!==e&&void 0!==e?e:0}generate(e,t){e.requires.uv[this.index]=!0;let i=this.index>0?this.index+1:"",n=e.isShader("vertex")?"uv"+i:"vUv"+i;return e.format(n,this.getType(e),t)}};TQ.addKeyword("uv",function(){return new HQ}),TQ.addKeyword("uv2",function(){return new HQ(1)});var GQ=class extends PQ{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=null!==t&&void 0!==t?t:GQ.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case WS:return["Linear"];case HS:return["sRGB"];default:return[]}}generate(e,t){var i;let n=this.input.build(e,"v4"),r=this.getType(e),a=GQ.Nodes[this.method],o=e.include(a);if(o===GQ.LINEAR_TO_LINEAR)return e.format(n,r,t);if(2===(null===(i=a.inputs)||void 0===i?void 0:i.length)){let i=this.factor.build(e,"f");return e.format(o+"( "+n+", "+i+" )",r,t)}return e.format(o+"( "+n+" )",r,t)}fromEncoding(e){let t=GQ.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=GQ.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},qQ=GQ;qQ.Nodes={LinearToLinear:new BQ(["vec4 LinearToLinear( in vec4 value ) {","\treturn value;","}"].join("\n")),sRGBToLinear:new BQ(["vec4 sRGBToLinear( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join("\n")),LinearTosRGB:new BQ(["vec4 LinearTosRGB( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join("\n"))},qQ.LINEAR_TO_LINEAR="LinearToLinear",qQ.SRGB_TO_LINEAR="sRGBToLinear",qQ.LINEAR_TO_SRGB="LinearTosRGB";var XQ=class extends BQ{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",arguments.length>4?arguments[4]:void 0,arguments.length>3?arguments[3]:void 0,arguments.length>2?arguments[2]:void 0,arguments.length>1?arguments[1]:void 0),this.nodeType="Expression"}},YQ=class extends DQ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new L_,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=null!==t&&void 0!==t?t:new HQ,this.bias=i,this.project=void 0!==n&&n}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){var i;if("sampler2D"===t)return this.getTexture(e,t);let n,r,a=this.getTexture(e,t),o=this.uv.build(e,this.project?"v4":"v2"),s=this.bias?this.bias.build(e,"f"):void 0;void 0===s&&e.context.bias&&(s=e.context.bias.setTexture(this).build(e,"f")),n=this.project?"texture2DProj":s?"tex2DBias":"tex2D",r=s?n+"( "+a+", "+o+", "+s+" )":n+"( "+a+", "+o+" )";let l={include:e.isShader("vertex"),ignoreCache:!0},c=this.getType(e);return e.addContext(l),this.colorSpace=null!==(i=this.colorSpace)&&void 0!==i?i:new qQ(new XQ("",c)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(r),r=this.colorSpace.build(e,c),e.removeContext(),e.format(r,c,t)}},QQ=class extends DQ{constructor(e){super("f"),this.nodeType="Float",this.value=null!==e&&void 0!==e?e:0}generateReadonly(e,t,i,n,r,a){return e.format(this.value+(this.value%1?"":".0"),n,t)}},KQ=class extends PQ{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=null!==t&&void 0!==t?t:[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,i,n,r){n=this.getType(e);let a=this.value,o=a.build(e,t)+"( ",s=[];if(a.inputs){for(let t=0;t<a.inputs.length;t++){let i=a.inputs[t],n=this.inputs[t]||this.inputs[i.name];s.push(n.build(e,e.getTypeByFormat(i.type)))}o+=s.join(", ")+" )"}return e.format(o,n,t)}},ZQ=class extends PQ{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ZQ.ADD;super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=i}getType(e){let t=this.a.getType(e),i=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(i)>e.getTypeLength(t)?i:t}generate(e,t){let i=this.getType(e);this.type=i;let n=this.a.build(e,i),r=this.b.build(e,i);return e.format("( "+n+" "+this.op+" "+r+" )",i,t)}},JQ=ZQ;JQ.ADD="+",JQ.SUB="-",JQ.MUL="*",JQ.DIV="/";var $Q=class extends PQ{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$Q.ABS,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;super(),this.nodeType="Math",this.a=e,"string"!=typeof t?this.b=t:n=t,"string"!=typeof i?this.c=i:n=i,this.method=n,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case $Q.MIX:case $Q.CLAMP:case $Q.REFRACT:case $Q.SMOOTHSTEP:case $Q.FACEFORWARD:return 3;case $Q.MIN:case $Q.MAX:case $Q.MOD:case $Q.STEP:case $Q.REFLECT:case $Q.DISTANCE:case $Q.DOT:case $Q.CROSS:case $Q.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),i=this.b?e.getTypeLength(this.b.getType(e)):0,n=this.c?e.getTypeLength(this.c.getType(e)):0;return t>i&&t>n?this.a.getType(e):i>n?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case $Q.LENGTH:case $Q.DISTANCE:case $Q.DOT:return"f";case $Q.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let i,n,r,a=this.a?e.getTypeLength(this.a.getType(e)):0,o=this.b?e.getTypeLength(this.b.getType(e)):0,s=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),c=this.getType(e);switch(this.type=c,this.method){case $Q.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case $Q.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case $Q.CROSS:i=this.a.build(e,"v3"),n=this.b.build(e,"v3");break;case $Q.STEP:i=this.a.build(e,1===a?"f":l),n=this.b.build(e,l);break;case $Q.MIN:case $Q.MAX:case $Q.MOD:i=this.a.build(e,l),n=this.b.build(e,1===o?"f":l);break;case $Q.REFRACT:i=this.a.build(e,l),n=this.b.build(e,l),r=this.c.build(e,"f");break;case $Q.MIX:i=this.a.build(e,l),n=this.b.build(e,l),r=this.c.build(e,1===s?"f":l);break;default:i=this.a.build(e,l),this.b&&(n=this.b.build(e,l)),this.c&&(r=this.c.build(e,l))}let d=[];d.push(i),n&&d.push(n),r&&d.push(r);let u=this.getNumInputs(e);if(d.length!==u)throw Error('Arguments not match used in "'.concat(this.method,'". Require ').concat(u,", currently ").concat(d.length,"."));return e.format(this.method+"( "+d.join(", ")+" )",c,t)}},eK=$Q;eK.RAD="radians",eK.DEG="degrees",eK.EXP="exp",eK.EXP2="exp2",eK.LOG="log",eK.LOG2="log2",eK.SQRT="sqrt",eK.INV_SQRT="inversesqrt",eK.FLOOR="floor",eK.CEIL="ceil",eK.NORMALIZE="normalize",eK.FRACT="fract",eK.SATURATE="saturate",eK.SIN="sin",eK.COS="cos",eK.TAN="tan",eK.ASIN="asin",eK.ACOS="acos",eK.ARCTAN="atan",eK.ABS="abs",eK.SIGN="sign",eK.LENGTH="length",eK.NEGATE="negate",eK.INVERT="invert",eK.MIN="min",eK.MAX="max",eK.MOD="mod",eK.STEP="step",eK.REFLECT="reflect",eK.DISTANCE="distance",eK.DOT="dot",eK.CROSS="cross",eK.POW="pow",eK.MIX="mix",eK.CLAMP="clamp",eK.REFRACT="refract",eK.SMOOTHSTEP="smoothstep",eK.FACEFORWARD="faceforward";var tK=class extends PQ{constructor(e,t,i){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=i}bilinearCubeUV(e,t,i,n){var r,a,o,s;let l=new KQ(tK.Nodes.bilinearCubeUV,[t,i,n]);this.colorSpaceTL=null!==(r=this.colorSpaceTL)&&void 0!==r?r:new qQ(new XQ("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(l.build(e)+".tl"),this.colorSpaceTR=null!==(a=this.colorSpaceTR)&&void 0!==a?a:new qQ(new XQ("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(l.build(e)+".tr"),this.colorSpaceBL=null!==(o=this.colorSpaceBL)&&void 0!==o?o:new qQ(new XQ("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(l.build(e)+".bl"),this.colorSpaceBR=null!==(s=this.colorSpaceBR)&&void 0!==s?s:new qQ(new XQ("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(l.build(e)+".br");let c={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(c),this.colorSpaceTLExp=new XQ(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new XQ(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new XQ(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new XQ(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let d=new XQ("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return d.keywords.cubeUV_TL=this.colorSpaceTLExp,d.keywords.cubeUV_TR=this.colorSpaceTRExp,d.keywords.cubeUV_BL=this.colorSpaceBLExp,d.keywords.cubeUV_BR=this.colorSpaceBRExp,d.keywords.cubeUV=l,d}generate(e,t){if(e.isShader("fragment")){let i=this.uv,n=this.bias||e.context.roughness,r=new KQ(tK.Nodes.roughnessToMip,[n]),a=new eK(r,tK.Nodes.m0,tK.Nodes.cubeUV_maxMipLevel,eK.CLAMP),o=new eK(a,eK.FLOOR),s=new eK(a,eK.FRACT),l=this.bilinearCubeUV(e,this.value,i,o),c=this.bilinearCubeUV(e,this.value,i,new JQ(o,new QQ(1).setReadonly(!0),JQ.ADD)),d=new eK(l,c,s,eK.MIX);return e.format(d.build(e),"v4",t)}return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},iK=tK;iK.Nodes=function(){let e=new WQ("struct TextureCubeUVData {\n\t\t\tvec4 tl;\n\t\t\tvec4 tr;\n\t\t\tvec4 br;\n\t\t\tvec4 bl;\n\t\t\tvec2 f;\n\t\t}"),t=new UQ("float cubeUV_maxMipLevel 8.0",!0),i=new UQ("float cubeUV_minMipLevel 4.0",!0),n=new UQ("float cubeUV_maxTileSize 256.0",!0),r=new UQ("float cubeUV_minTileSize 16.0",!0),a=new BQ("float getFace(vec3 direction) {\n\t\t\t\tvec3 absDirection = abs(direction);\n\t\t\t\tfloat face = -1.0;\n\t\t\t\tif (absDirection.x > absDirection.z) {\n\t\t\t\t\tif (absDirection.x > absDirection.y)\n\t\t\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t} else {\n\t\t\t\t\tif (absDirection.z > absDirection.y)\n\t\t\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t}\n\t\t\t\treturn face;\n\t\t}");a.useKeywords=!1;let o=new BQ("vec2 getUV(vec3 direction, float face) {\n\t\t\t\tvec2 uv;\n\t\t\t\tif (face == 0.0) {\n\t\t\t\t\tuv = vec2(direction.z, direction.y) / abs(direction.x); // pos x\n\t\t\t\t} else if (face == 1.0) {\n\t\t\t\t\tuv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y\n\t\t\t\t} else if (face == 2.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z\n\t\t\t\t} else if (face == 3.0) {\n\t\t\t\t\tuv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x\n\t\t\t\t} else if (face == 4.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y\n\t\t\t\t} else {\n\t\t\t\t\tuv = vec2(direction.x, direction.y) / abs(direction.z); // neg z\n\t\t\t\t}\n\t\t\t\treturn 0.5 * (uv + 1.0);\n\t\t}");o.useKeywords=!1;let s=new BQ("TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n\t\t\tfloat face = getFace(direction);\n\t\t\tfloat filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n\t\t\tmipInt = max(mipInt, cubeUV_minMipLevel);\n\t\t\tfloat faceSize = exp2(mipInt);\n\t\t\tfloat texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n\t\t\tvec2 uv = getUV(direction, face) * (faceSize - 1.0);\n\t\t\tvec2 f = fract(uv);\n\t\t\tuv += 0.5 - f;\n\t\t\tif (face > 2.0) {\n\t\t\t\tuv.y += faceSize;\n\t\t\t\tface -= 3.0;\n\t\t\t}\n\t\t\tuv.x += face * faceSize;\n\t\t\tif(mipInt < cubeUV_maxMipLevel){\n\t\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t\t}\n\t\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\t\tuv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n\t\t\tuv *= texelSize;\n\t\t\tvec4 tl = texture2D(envMap, uv);\n\t\t\tuv.x += texelSize;\n\t\t\tvec4 tr = texture2D(envMap, uv);\n\t\t\tuv.y += texelSize;\n\t\t\tvec4 br = texture2D(envMap, uv);\n\t\t\tuv.x -= texelSize;\n\t\t\tvec4 bl = texture2D(envMap, uv);\n\t\t\treturn TextureCubeUVData( tl, tr, br, bl, f );\n\t\t}",[e,a,o,t,i,n,r]);s.useKeywords=!1;let l=new UQ("float r0 1.0",!0),c=new UQ("float v0 0.339",!0),d=new UQ("float m0 -2.0",!0),u=new UQ("float r1 0.8",!0),h=new UQ("float v1 0.276",!0),p=new UQ("float m1 -1.0",!0),f=new UQ("float r4 0.4",!0),m=new UQ("float v4 0.046",!0),g=new UQ("float m4 2.0",!0),v=new UQ("float r5 0.305",!0),y=new UQ("float v5 0.016",!0),b=new UQ("float m5 3.0",!0),x=new UQ("float r6 0.21",!0),w=new UQ("float v6 0.0038",!0),S=new UQ("float m6 4.0",!0);return{bilinearCubeUV:s,roughnessToMip:new BQ("float roughnessToMip(float roughness) {\n\t\t\tfloat mip = 0.0;\n\t\t\tif (roughness >= r1) {\n\t\t\t\tmip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n\t\t\t} else if (roughness >= r4) {\n\t\t\t\tmip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n\t\t\t} else if (roughness >= r5) {\n\t\t\t\tmip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n\t\t\t} else if (roughness >= r6) {\n\t\t\t\tmip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n\t\t\t} else {\n\t\t\t\tmip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25\n\t\t\t}\n\t\t\treturn mip;\n\t\t}",[l,c,d,u,h,p,f,m,g,v,y,b,x,w,S]),m0:d,cubeUV_maxMipLevel:t}}();var nK=class extends PQ{constructor(e){super("v3"),this.nodeType="Normal",this.scope=null!==e&&void 0!==e?e:nK.VIEW}getShared(){return this.scope===nK.WORLD}build(e,t,i,n){let r=e.context[this.scope+"Normal"];return r?r.build(e,t,i,n):super.build(e,t,i)}generate(e,t,i,n,r){let a;switch(this.scope){case nK.VIEW:a=e.isShader("vertex")?"transformedNormal":"geometryNormal";break;case nK.LOCAL:e.isShader("vertex")?a="objectNormal":(e.requires.normal=!0,a="vObjectNormal");break;case nK.WORLD:e.isShader("vertex")?a="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,a="vWNormal")}return e.format(a,this.getType(e),t)}},rK=nK;rK.LOCAL="local",rK.WORLD="world",rK.VIEW="view",rK.NORMAL="normal",TQ.addKeyword("viewNormal",function(){return new rK(rK.VIEW)}),TQ.addKeyword("localNormal",function(){return new rK(rK.NORMAL)}),TQ.addKeyword("worldNormal",function(){return new rK(rK.WORLD)});var aK=class extends PQ{constructor(e){super("v3"),this.nodeType="Position",this.scope=null!==e&&void 0!==e?e:aK.LOCAL}getType(){return this.scope===aK.PROJECTION?"v4":this.type}getShader(){switch(this.scope){case aK.LOCAL:case aK.WORLD:return!1}return!0}generate(e,t,i,n,r){let a;switch(this.scope){case aK.LOCAL:e.isShader("vertex")?a="transformed":(e.requires.position=!0,a="vPosition");break;case aK.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,a="vWPosition";break;case aK.VIEW:a=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case aK.PROJECTION:a=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )"}return e.format(a,this.getType(),t)}},oK=aK;oK.LOCAL="local",oK.WORLD="world",oK.VIEW="view",oK.PROJECTION="projection",TQ.addKeyword("position",function(){return new oK}),TQ.addKeyword("worldPosition",function(){return new oK(oK.WORLD)}),TQ.addKeyword("viewPosition",function(){return new oK(oK.VIEW)});var sK=class extends PQ{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=null!==e&&void 0!==e?e:sK.CUBE}getUnique(e){return!e.context.viewNormal}getType(){return this.scope===sK.SPHERE?"v2":this.type}generate(e,t){let i=this.getUnique(e);if(e.isShader("fragment")){let n;switch(this.scope){case sK.VECTOR:{let t=new rK(rK.VIEW),r=e.context.roughness,a=t.build(e,"v3"),o=new oK(oK.VIEW).build(e,"v3"),s=r?r.build(e,"f"):void 0,l="reflect( -normalize( ".concat(o," ), ").concat(a," )");s&&(l="normalize( mix( ".concat(l,", ").concat(a,", ").concat(s," * ").concat(s," ) )"));let c="inverseTransformDirection( ".concat(l,", viewMatrix )");i?(e.addNodeCode("vec3 reflectVec = ".concat(c,";")),n="reflectVec"):n=c;break}case sK.CUBE:{let t=new sK(sK.VECTOR).build(e,"v3"),r="vec3( -"+t+".x, "+t+".yz )";i?(e.addNodeCode("vec3 reflectCubeVec = ".concat(r,";")),n="reflectCubeVec"):n=r;break}case sK.SPHERE:{let t="normalize( ( viewMatrix * vec4( "+new sK(sK.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";i?(e.addNodeCode("vec2 reflectSphereVec = ".concat(t,";")),n="reflectSphereVec"):n=t;break}}return e.format(n,this.getType(),t)}return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},lK=sK;lK.CUBE="cube",lK.SPHERE="sphere",lK.VECTOR="vector";var cK=class extends PQ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new YQ,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new iK(this.value,null!==t&&void 0!==t?t:new lK(lK.VECTOR),i),this.irradianceNode=new iK(this.value,new rK(rK.WORLD),new QQ(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),("irradiance"===e.slot?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},dK=class extends DQ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new WE,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=null!==t&&void 0!==t?t:new lK,this.bias=i}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){var i,n;if("samplerCube"===t)return this.getTexture(e,t);let r,a=this.getTexture(e,t),o=null===(i=this.uv)||void 0===i?void 0:i.build(e,"v3"),s=this.bias?this.bias.build(e,"f"):void 0;void 0===s&&e.context.bias&&(s=e.context.bias.setTexture(this).build(e,"f")),r=s?"texCubeBias( "+a+", "+o+", "+s+" )":"texCube( "+a+", "+o+" )";let l={include:e.isShader("vertex"),ignoreCache:!0},c=this.getType(e);return e.addContext(l),this.colorSpace=null!==(n=this.colorSpace)&&void 0!==n?n:new qQ(new XQ("",c)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(r),r=this.colorSpace.build(e,c),e.removeContext(),e.format(r,c,t)}},uK=["x","y","z","w"],hK=["float","vec2","vec3","vec4"],pK={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},fK={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},mK=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(e,t){return e.deps.length-t.deps.length}return function(t,i){let n=this.getIncludes(t,i);if(!n)return"";let r="";n=n.sort(e);for(let e=0;e<n.length;e++)n[e].src&&(r+=n[e].src+"\n");return r}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCube(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif","\n\t\t\t// NOTE: Include Spline's blending modes. This could be part of BlendNode\n\t\t\t#define SPE_BLENDING_NORMAL 0\n\t\t\t#define SPE_BLENDING_MULTIPLY 1\n\t\t\t#define SPE_BLENDING_SCREEN 2\n\t\t\t#define SPE_BLENDING_OVERLAY 3\n\n\t\t\tvec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\treturn mix( a, b, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\treturn mix( a, a * b, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\tvec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );\n\t\t\t\treturn mix( a, tmp, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\tvec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );\n\t\t\t\treturn clamp( mix( a, tmp, alpha ), 0.0, 1.0 );\n\t\t\t}\n\n\t\t\tvec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {\n\t\t\t\tif ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );\n\t\t\t\treturn vec3( 1.0 );\n\t\t\t}\n\t\t\t","#include <packing>","#include <common>"].join("\n"),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join("\n"),fragment:["float accumAlpha = 0.0;","void accumulateAlpha(float alpha) {\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * alpha;\n\t\t\t\t}",""].join("\n")},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode("\nuniform int frameIndex;\nuniform vec2 resolution;\nuniform mat4 previousModelViewMatrix;\nuniform mat4 previousProjectionMatrix;\n\nvarying vec4 vCurrentPosition;\nvarying vec4 vPreviousPosition;\n"),this.addFragmentParsCode("\nlayout(location = 1) out vec4 gVelocity;\n\nuniform int frameIndex;\nuniform vec2 resolution;\n\nvarying vec4 vCurrentPosition;\nvarying vec4 vPreviousPosition;\n\nconst vec2 haltonSequence[16] = vec2[16](\nvec2( 0.000000,-0.333334),\nvec2(-0.500000, 0.333334),\nvec2( 0.500000,-0.777778),\nvec2(-0.750000,-0.111112),\nvec2( 0.250000, 0.555556),\nvec2(-0.250000,-0.555556),\nvec2( 0.750000, 0.111112),\nvec2(-0.875000, 0.777778),\nvec2(0.125000, -0.925926),\nvec2(-0.375000, -0.259260),\nvec2(0.625000, 0.407408),\nvec2(-0.625000, -0.703704),\nvec2(0.375000, -0.037038),\nvec2(-0.125000, 0.629630),\nvec2(0.875000, -0.481482),\nvec2(-0.937500, 0.185186));\n\nvec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {\n  const float goldenAngle = 2.399963f; // radians\n  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));\n  float theta = float(sampleIndex) * goldenAngle + angle;\n  float sine = sin(theta);\n  float cosine = cos(theta);\n  return vec2(cosine, sine) * r;\n}\n\n// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso\nfloat getNoiseInterleavedGradient(vec2 screenPos) {\n    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);\n    return fract(magic.z * fract(dot(screenPos, magic.xy)));\n}\n\n"),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let i=0;i<this.requires.uv.length;i++)if(this.requires.uv[i]){let e=i>0?i+1:"";this.addVaryCode("varying vec2 vUv"+e+";"),i>0&&this.addVertexParsCode("attribute vec2 uv"+e+";"),this.addVertexFinalCode("vUv"+e+" = uv"+e+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("\n\t\t\t\t#ifndef SHAPEBLEND \n\t\t\t\t\tvObjectNormal = normal;\n\t\t\t\t#else\n\t\t\t\t\tvObjectNormal = objectNormal;\n\t\t\t\t#endif\n\t\t\t")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode("\n// TODO: This could be generated CPU side and passed to the shader every frame\nconst vec2 haltonSequence[16] = vec2[16](\nvec2( 0.000000,-0.333334),\nvec2(-0.500000, 0.333334),\nvec2( 0.500000,-0.777778),\nvec2(-0.750000,-0.111112),\nvec2( 0.250000, 0.555556),\nvec2(-0.250000,-0.555556),\nvec2( 0.750000, 0.111112),\nvec2(-0.875000, 0.777778),\nvec2(0.125000, -0.925926),\nvec2(-0.375000, -0.259260),\nvec2(0.625000, 0.407408),\nvec2(-0.625000, -0.703704),\nvec2(0.375000, -0.037038),\nvec2(-0.125000, 0.629630),\nvec2(0.875000, -0.481482),\nvec2(-0.937500, 0.185186));\n\n// TODO: Pass correct view size\nvec2 offset = haltonSequence[frameIndex];\noffset.x /= resolution.x;\noffset.y /= resolution.y;\n\nvec4 currentPosition = gl_Position;\nvec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);\n\n// We want to calculate the velocity with unjittered positions\n// so that things that are not moving get a velocity = 0\nvCurrentPosition = currentPosition;\nvPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);\n#ifdef OUTLINE_COMPENSATION\nvPreviousPosition.xy += OUTLINE_COMPENSATION;\n#endif\ngl_Position = currentPositionJittered;\n\n"),this.addFragmentFinalCode("\nvec2 oldPos = vPreviousPosition.xy;\n    oldPos /= vPreviousPosition.w;\n    oldPos.xy = (oldPos.xy+1.)/2.0;\n\nvec2 newPos = vCurrentPosition.xy;\n    newPos /= vCurrentPosition.w;\n    newPos.xy = (newPos.xy+1.)/2.0;\n\nvec2 velocity = (newPos - oldPos);\n\n// Discard fully transparent pixels \nif (gl_FragColor.a <= 0.0) discard;\n\ngVelocity = vec4(velocity, 0.0, 1.0);\n")),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,i){return this.addSlot(e).addCache(t).addContext(i)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=null!==e&&void 0!==e?e:"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){void 0===this.fragmentVariables[e]&&(this.addFragmentCode("".concat(t," ").concat(e,";")),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){void 0===this.fragmentParsVariables[e]&&(this.addFragmentParsCode("".concat(t," ").concat(e,";")),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){void 0===this.vertexParsVariables[e]&&(this.addVertexParsCode("".concat(t," ").concat(e,";")),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[null!==t&&void 0!==t?t:this.shader]+=e+"\n"}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[null!==t&&void 0!==t?t:this.shader]+=e+"\n"}clearNodeCode(e){e=null!==e&&void 0!==e?e:this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[null!==t&&void 0!==t?t:this.shader]+=e+"\n"}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[null!==t&&void 0!==t?t:this.shader]+=e+"\n"}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return-1!==this.caches.indexOf(e)}isSlot(e){return-1!==this.slots.indexOf(e)}define(e,t){this.defines[e]=void 0===t?1:t}require(e){this.requires[e]=!0}isDefined(e){return void 0!==this.defines[e]}getVar(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"varying",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"V",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=this.getVars(n),s=o[e];if(!s){let n=o.length;s={name:i||"node"+r+n+(a?"_"+a:""),type:t},o.push(s),o[e]=s}return s}getTempVar(e,t,i,n){return this.getVar(e,t,i,this.shader,"T",n)}getAttribute(e,t){if(!this.attributes[e]){let i=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(i.name+" = "+e+";"),this.attributes[e]={varying:i,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join("\n")}getVarListCode(e,t){t=null!==t&&void 0!==t?t:"";let i="";for(let n=0,r=e.length;n<r;++n){let r=e[n],a=r.type,o=r.name,s=r.size,l=this.getFormatByType(a);if(void 0===l)throw new Error("Node pars "+l+" not found.");l.includes("[]")?i+=t+" "+l.substring(0,l.length-2)+" "+o+"[".concat(s,"];\n"):i+=t+" "+l+" "+o+";\n"}return i}getVars(e){return this.inputs.vars[null!==e&&void 0!==e?e:this.shader]}getNodeData(e){let t=e instanceof AQ?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,i,n,r,a){if(t.includes("[]")){let o=this.inputs.arrayUniforms,s=o.list.length,l=new MQ({type:t,size:i.size,name:n||"nodeUA"+s+(a?"_"+a:""),node:i,needsUpdate:r});return o.list.push(l),o[e].push(l),o[e][l.name]=l,this.uniforms[l.name]=l,l}{let o=this.inputs.uniforms,s=o.list.length,l=new MQ({type:t,name:n||"nodeU"+s+(a?"_"+a:""),node:i,needsUpdate:r});return o.list.push(l),o[e].push(l),o[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,i,n,r){return this.createUniform("vertex",e,t,i,n,r)}createFragmentUniform(e,t,i,n,r){return this.createUniform("fragment",e,t,i,n,r)}include(e,t,i){let n;if(e="string"==typeof e?TQ.get(e):e,!1===this.context.include)return e.name;e instanceof BQ?n=this.includes.functions:e instanceof UQ?n=this.includes.consts:e instanceof WQ&&(n=this.includes.structs);let r=n[this.shader]=n[this.shader]||[];if(e){var a;let n=r[e.name];if(n||(n=r[e.name]={node:e,deps:[]},r.push(n),n.src=e.build(this,"source")),e instanceof BQ&&t&&r[t.name]&&-1===r[t.name].deps.indexOf(e)&&(r[t.name].deps.push(e),null!==(a=e.includes)&&void 0!==a&&a.length)){let i=0;do{this.include(e.includes[i++],t)}while(i<e.includes.length)}return i&&(n.src=i),e.name}throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return hK[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return"f"===e?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return 1===e?"f":"v"+e}findNode(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(let n=0;n<arguments.length;n++){let e=t[n];if(null!==e&&void 0!==e&&e.isNode)return e}}resolve(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(let n=0;n<arguments.length;n++){let e=t[n];if(void 0!==e){if(e.isNode)return e;if(e.isTexture)switch(e.mapping){case lS:case cS:return new dK(e);case dS:return new cK(new YQ(e));default:return new YQ(e)}else{if(e.isVector2)return new OQ(e);if(e.isVector3)return new IQ(e);if(e.isVector4)return new RQ(e)}}}}format(e,t,i){switch(this.colorToVector(i+" <- "+t)){case"f <- v2":case"f <- v3":case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":case"i <- v3":case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return pK[e]||e}getFormatByType(e){return fK[e]||e}getUUID(e,t){return(t=void 0===t||t)&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return uK[e]}getIndexByElement(e){return uK.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=WS,t===WS&&this.context.gamma&&(t=HS),t}},gK=class extends DQ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;super("c"),this.nodeType="Color",this.value=e instanceof kQ?e:new kQ(e||0,t,i,n)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,i,n,r,a){i=e.getUUID(null!==i&&void 0!==i?i:this.getUUID()),n=null!==n&&void 0!==n?n:this.getType(e);let o=e.getNodeData(i),s=this.getReadonly()&&void 0!==this.generateReadonly;if(this.alpha){let t=this.alpha.build(e,"f");e.addFragmentNodeCode("accumAlpha += ( 1.0 - accumAlpha ) * ".concat(t,";"))}return s?this.generateReadonly(e,t,i,n,r,a):e.isShader("vertex")?(o.vertex||(o.vertex=e.createVertexUniform(n,this,r,a,this.getLabel())),e.format(o.vertex.name,n,t)):(o.fragment||(o.fragment=e.createFragmentUniform(n,this,r,a,this.getLabel())),e.format(o.fragment.name,n,t))}generateReadonly(e,t,i,n,r,a){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",n,t)}},vK=class extends DQ{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(null!==e&&void 0!==e?e:0)}generateReadonly(e,t,i,n,r,a){return e.format(this.value.toString(),n,t)}},yK=class extends DQ{constructor(e){super("b"),this.nodeType="Bool",this.value=null!==e&&void 0!==e&&e}generateReadonly(e,t,i,n){return e.format(this.value?"true":"false",n,t)}},bK=class extends DQ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:"number"==typeof t?new Array(e).fill(t):new Array(e).fill(0)}},xK=class extends DQ{},wK=class extends xK{constructor(e){super("v3"),this.image=e,this._value=new j_}get value(){var e,t;return this._value.x=this.image.isVideo?null!==(e=this.image.img.videoWidth)&&void 0!==e?e:0:this.image.img.width,this._value.y=this.image.isVideo?null!==(t=this.image.img.videoHeight)&&void 0!==t?t:0:this.image.img.height,this._value}},SK=class extends xK{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1008,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1006;super("t"),this.image=e,this.wrap=t,this.minFilter=i,this.magFilter=n}get value(){return this.image.getTexture(this.wrap,this.minFilter,this.magFilter)}},_K=class extends DQ{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=null!==e&&void 0!==e?e:new f_}generateReadonly(e,t,i,n,r,a){return e.format("mat3("+this.value.elements.join(", ")+")",n,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},CK=class extends DQ{constructor(e){super("m4"),this.nodeType="Matrix4",this.value=null!==e&&void 0!==e?e:new yC}generateReadonly(e,t,i,n,r,a){return e.format("mat4("+this.value.elements.join(", ")+")",n,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}};function EK(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;e.setUvTransform(i[0],i[1],t[0],t[1],0,0,0).premultiply((new f_).makeRotation(n*h_.DEG2RAD))}var AK=class extends _K{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(new f_),this.repeat=e,this.offset=t,this.rotation=i,EK(this.value,e,t,i)}updateMatrix(){EK(this.value,this.repeat,this.offset,this.rotation)}},MK=class extends DQ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof B_?new Array(e).fill(t):new Array(e).fill(new B_(0))}},TK=class extends PQ{constructor(e,t,i,n){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=i,this.mode=n}generate(e,t){if(e.isShader("fragment")){let i=[];return i.push(this.a.build(e,"c")),i.push(this.b.build(e,"c")),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),e.format("spe_blend("+i.join(",")+")",this.getType(e),t)}return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},PK=class extends PQ{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.isShader("fragment")){let i=e.include(PK.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.color.build(e,"v3")),n.push(this.mask?"luminance(".concat(this.mask.build(e,"v3"),")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}return console.warn("CustomColorNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},DK=PK;DK.Nodes={customColor:new BQ("vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {\n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha;\n\n\t\t\t\treturn color;\n\t\t\t}")};var OK=class extends PQ{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.isShader("fragment")){let i=e.include(OK.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.cnormal.build(e,"v3")),n.push("normal"),n.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},IK=OK;IK.Nodes={customNormal:new BQ("vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {\n\t\t\t\tvec3 normal = packNormalToRGB( norm ).rgb;\n\t\t\t\tnormal *= step( vec3(0.5), cnormal );\n\n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * lalpha;\n\n\t\t\t\treturn normal;\n\t\t\t}")};var kK=class extends PQ{constructor(e,t,i,n,r,a,o,s,l,c,d,u){super("v3"),this.nodeType="CustomTexture",this.texture=e,this.textureSize=t,this.crop=i,this.projection=n,this.axis=r,this.side=a,this.size=o,this.blending=s,this.mat=l,this.isMask=u,this.alpha=c,this.mode=d,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let i,n="g".concat(this.uuid.toString().replace(/-/g,""));switch(this.projection.value){case 3:i=e.include(kK.Nodes.cylindrical);break;case 2:i=e.include(kK.Nodes.spherical);break;case 1:let t=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],r=["zy","xz","xy"][this.axis.value],a=new BQ("\n\t\tvec3 ".concat(n,"_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n\t\t\t\tvec2 projected = (1. + (position.").concat(r,")) / 2.;\n\t\t\t\tvec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n\t\t\t\tvec4 tmp = texture2D( tex, uvs );\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\t").concat(2===this.side.value?"":"lalpha *= step(0.0, ".concat(1===this.side.value?"-1.0 * ":"","dot(vObjectNormal, ").concat(t,"));"),"\n\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}"));i=e.include(a);break;case 4:i=e.include(kK.Nodes.triplanar);break;default:i=e.include(kK.Nodes.uv)}e.addFragmentVariable(this.calpha,"float");let r=[];if(r.push("normal"),r.push(this.texture.generate(e,"t")),r.push(this.textureSize.build(e,"v2")),r.push(this.crop.build(e,"f")),r.push(this.mat.build(e,"mat3")),r.push(this.size.build(e,"v2")),r.push(this.blending.build(e,"f")),r.push(this.isMask.build(e,"b")),r.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),r.push(this.calpha),4===this.projection.value){let t="".concat(n,"_writeUvs"),i=t+"0",a=t+"1",o=t+"2",s="".concat(n,"_triplanarWeights");e.addFragmentVariable(i,"vec2"),e.addFragmentVariable(a,"vec2"),e.addFragmentVariable(o,"vec2"),e.addFragmentVariable(s,"vec3"),r.push(i),r.push(a),r.push(o),r.push(s)}else{let t="".concat(n,"_writeUvs");e.addFragmentVariable(t,"vec2"),r.push(t)}return e.format(i+"("+r.join(",")+")",this.getType(e),t)}},RK=kK;RK.Nodes={cylindrical:new BQ("\nvec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n                vec3 posN = normalize(position);\n                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);\n                float scaledHeight = position.y / (size.y * 0.5);\n                float v =  (scaledHeight / 2.) + .5;\n\n                vec2 calculatedUv = vec2(u,v);\n\t\t\t\tvec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n                vec2 df = fwidth(uvs);\n               \tif(df.x > 0.5) df.x = 0.;\n\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#else\n                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\t\t\t\t\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}\n"),spherical:new BQ("\nvec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n                vec3 posN = normalize(vPosition);\n                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);\n                float v = 0.5 + asin(posN.y) / 3.1415;\n\n                vec2 calculatedUv = vec2(u,v);\n\t\t\t\tvec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n                vec2 df = fwidth(uvs);\n               \tif(df.x > 0.5) df.x = 0.;\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#else\n                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}\n"),uv:new BQ("vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n\t\t\t\tvec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n\t\t\t\tvec4 tmp = texture2D( tex, uvs );\n\n\t\t\t\tvec3 col = tmp.rgb;\n\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}"),triplanar:new BQ("vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {\n\t\t\t\tvec3 p = position;\n\t\t\t\tvec2 uv0 = (1.0 + p.xy) / 2.0;     \n\t\t\t\tvec2 uv1 = (1.0 + p.zy) / 2.0;\t\t\n\t\t\t\tvec2 uv2 = (1.0 + p.xz) / 2.0;\t\t\n\t\n\t\t\t\tuv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\t\t\t\tuv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\t\t\t\tuv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\n\t\t\t\t// Range from 3 to 128 seems to be good\n\t\t\t\tfloat exponent = (1.0 - blending) * 125.0 + 3.0;\n\n\t\t\t\tvec3 n = vObjectNormal;\n\t\t\t\tvec3 weights = abs(normalize(n));\n\t\t\t\tweights = pow(weights, vec3(exponent));\n\t\t\t\tweights /= dot(weights, vec3(1.0));\n\n\t\t\t\t// Write out all sets of UVs that we generated\n\t\t\t\twriteUvs0 = uv0;\n\t\t\t\twriteUvs1 = uv1;\n\t\t\t\twriteUvs2 = uv2;\n\t\t\t\twriteWeights = weights;\n\n\t\t\t\t// Derivatives for LOD\n\t\t\t\tvec2 df0 = fwidth(uv0);\n\t\t\t\tvec2 df1 = fwidth(uv1);\n\t\t\t\tvec2 df2 = fwidth(uv2);\n\t\t\t\tif (df0.x > 0.5) df0.x = 0.0;\n\t\t\t\tif (df1.x > 0.5) df1.x = 0.0;\n\t\t\t\tif (df2.x > 0.5) df2.x = 0.0;\n\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                \tvec4 tmp = \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;\n\t\t\t\t#else\n                \tvec4 tmp = \n\t\t\t\t\t\ttextureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + \n\t\t\t\t\t\ttextureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + \n\t\t\t\t\t\ttextureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\n\t\t\t\t// Apply cropping across all 3 planes\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t\tif ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t\tif ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;//n * 0.5 + 0.5;\n\t\t\t}\t\t\t\n\t\t\t")};var zK=class extends PQ{constructor(e,t,i,n,r,a,o,s,l,c,d,u){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=i,this.far=n,this.isVector=r,this.isWorldSpace=a,this.origin=o,this.direction=s,this.colors=l,this.steps=c,this.isMask=u,this.alpha=d,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){let i="g".concat(this.uuid.toString().replace(/-/g,"")),n=new BQ("vec3 ".concat(i,"_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[").concat(i,"_MAX_COLORS], float steps[").concat(i,"_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {\n               vec4 color = colors[0];\n               #ifdef ").concat(i,"_IS_VECTOR\n                   #ifdef ").concat(i,"_LINEAR\n                       #ifdef ").concat(i,"_WORLDSPACE\n                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);\n                       #else\n                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);\n                       #endif\n                   #else\n                       #ifdef ").concat(i,"_WORLDSPACE\n                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);\n                       #else\n                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);\n                       #endif\n                   #endif\n               #else\n                   float dist = length(vWPosition - cameraPosition);\n\t\t\t       float depth = ( dist - near ) / ( far - near );\n               #endif\n\n\n              float p;\n              #ifdef ").concat(i,"_SMOOTH\n\t\t\t\tfor ( int i = 1; i < ").concat(i,"_MAX_COLORS; i++ ) {\n\t\t\t\t\t\tp = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t\t}\n              #else\n                for ( int i = 1; i < ").concat(i,"_MAX_COLORS; i++ ) {\n                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);\n                   color = mix(color, colors[i], p);\n                 }\n              #endif\n\n               float lalpha = alpha * color.a * mask;\n               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t   \n               return color.rgb;\n\t\t\t}"),[zK.Nodes.vectorLinearWorldSpaceDepth,zK.Nodes.vectorLinearObjectSpaceDepth,zK.Nodes.vectorSphericalObjectSpaceDepth,zK.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define("".concat(i,"_MAX_COLORS"),this.colors.value.length),this.smooth.value&&e.define("".concat(i,"_SMOOTH")),this.isVector.value>.5&&e.define("".concat(i,"_IS_VECTOR")),0===this.gradientType.value&&e.define("".concat(i,"_LINEAR")),this.isWorldSpace.value>.5&&e.define("".concat(i,"_WORLDSPACE")),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let r=e.include(n),a=[];return a.push(this.near.build(e,"f")),a.push(this.far.build(e,"f")),a.push(this.origin.build(e,"v3")),a.push(this.direction.build(e,"v3")),a.push(this.colors.build(e,"v4[]")),a.push(this.steps.build(e,"f[]")),a.push(this.isMask.build(e,"b")),a.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),a.push(this.alpha.build(e,"f")),a.push(this.calpha),e.format(r+"("+a.join(",")+")",this.getType(e),t)}return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},LK=zK;LK.Nodes={vectorLinearWorldSpaceDepth:new BQ("float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {\n               vec3 n = normalize(direction);\n               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));\n               return ( dist - near ) / ( far - near );\n            }"),vectorLinearObjectSpaceDepth:new BQ("float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {\n               vec3 n = normalize(direction);\n               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));\n               return ( dist - near ) / ( far - near );\n            }"),vectorSphericalWorldSpaceDepth:new BQ("float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {\n               float dist = length(vWPosition - origin);\n               return ( dist - near ) / ( far - near );\n            }"),vectorSphericalObjectSpaceDepth:new BQ("float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {\n               float dist = length(position - origin);\n               return ( dist - near ) / ( far - near );\n            }")};var BK=class extends PQ{constructor(e,t,i,n,r,a,o,s){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=i,this.intensity=n,this.factor=r,this.isMask=s,this.alpha=a,this.mode=o,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let i=new BQ("vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {\n\t\t\t\t\tfloat fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );\n\n\t\t\t\t\tfloat lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\t\treturn color;\n\t\t\t\t}"),n=e.include(i),r=[];return r.push(this.color.build(e,"c")),r.push(this.bias.build(e,"f")),r.push(this.scale.build(e,"f")),r.push(this.intensity.build(e,"f")),r.push(this.factor.build(e,"f")),r.push(this.isMask.build(e,"b")),r.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),r.push(this.calpha),e.format(n+"("+r.join(",")+")",this.getType(e),t)}return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},NK=class extends PQ{constructor(e,t,i,n,r,a,o,s,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=i,this.steps=n,this.offset=r,this.morph=a,this.angle=o,this.isMask=l,this.alpha=s,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(NK.Nodes.gradient),n=[];return n.push(this.gradientType.build(e,"i")),n.push(this.smooth.build(e,"b")),n.push(this.colors.build(e,"v4[]")),n.push(this.steps.build(e,"f[]")),n.push(this.offset.build(e,"v2")),n.push(this.morph.build(e,"v2")),n.push(this.angle.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},FK=NK;FK.Nodes={gradient:new BQ("vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\tvec4 color = colors[0];\n\t\t\t\tvec2 m = morph / vUv.xy;\n\t\t\t\tvec2 rot = vec2( 0.5 + m.x, m.y );\n\t\t\t\tvec2 dt = vec2(\n\t\t\t\t\tcos( angle ) * rot.x - sin( angle ) * rot.y,\n\t\t\t\t\tsin( angle ) * rot.x + cos( angle ) * rot.y\n\t\t\t\t);\n\t\t\t\tvec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;\n\t\t\t\tfloat t = dot( pt, dt ) / dot( dt, dt );\n\t\t\t\tif ( gradientType == 1 ) {\n\t\t\t\t\tt = distance (\n\t\t\t\t\t\t( vUv + morph ) * 3.0,\n\t\t\t\t\t\t( vUv + offset ) + 1.0\n\t\t\t\t\t) + angle;\n\t\t\t\t} else if ( gradientType == 2 ) {\n\t\t\t\t\tfloat polar = atan(\n\t\t\t\t\t\tvUv.x + morph.x - 0.5 + offset.x,\n\t\t\t\t\t\tvUv.y + morph.y - 0.5 + offset.y\n\t\t\t\t\t) * -1.0;\n\t\t\t\t\tt = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );\n\t\t\t\t}\n\n\t\t\t\tfloat p;\n\t\t\t\tif (smoothed) {\n\t\t\t\t\tfor ( int i = 1; i < GRAD_MAX; i++ ) {\n\t\t\t\t\t\tp = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tfor ( int i = 1; i < GRAD_MAX; i++ ) {\n\t\t\t\t\t\tp = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], p);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t\t\n\t\t\t\treturn color.xyz;\n\t\t\t}")};var UK=class extends PQ{constructor(e,t,i,n,r){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=n,this.alpha=t,this.mode=i,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha"),this.rotation=r}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let i=e.include(UK.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let n=[];return n.push(this.texture.generate(e,"t")),n.push("normal"),n.push(this.isMask.build(e,"b")),n.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),n.push(this.rotation.build(e,"f")),e.format(i+"("+n.join(",")+")",this.getType(e),t)}return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},VK=UK;VK.Nodes={matcap:new BQ("vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha, float rotation) {\n\t\t\t\t\tvec3 viewDir = normalize( vViewPosition );\n\t\t\t\t\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\t\t\t\t\tvec3 y = cross( viewDir, x );\n\t\t\t\t\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) );\n\t\t\t\t\tuv = mat2( cos(rotation), sin(rotation), -sin(rotation), cos(rotation) ) * uv;\n\t\t\t\t\tuv = uv * 0.495 + 0.5;\n\t\t\t\t\tvec4 matcapColor = texture2D( matcapTex, uv );\n\n\t\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t\t\t\n\t\t\t\t\treturn matcapColor.rgb;\n            \t}")};var jK=function(){let e=new BQ("vec3 random3(vec3 c) {\n\t\t\tfloat j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n\t\t\tvec3 r;\n\t\t\tr.z = fract(512.0*j);\n\t\t\tj *= .125;\n\t\t\tr.x = fract(512.0*j);\n\t\t\tj *= .125;\n\t\t\tr.y = fract(512.0*j);\n\t\t\treturn r-0.5;\n\t\t}"),t=new BQ("float simplexFast(vec3 p) {\n\t\t\t vec3 s = floor(p + dot(p, vec3(F3)));\n\t\t\t mediump vec3 x = p - s + dot(s, vec3(G3));\n\t\t\t mediump vec3 hs = s;\n\t\t\t \n\t\t\t mediump vec3 e = step(vec3(0.0), x - x.yzx);\n\t\t\t mediump vec3 i1 = e*(1.0 - e.zxy);\n\t\t\t mediump vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n\t\t\t\t\n\t\t\t mediump vec3 x1 = x - i1 + G3;\n\t\t\t mediump vec3 x2 = x - i2 + 2.0*G3;\n\t\t\t mediump vec3 x3 = x - 1.0 + 3.0*G3;\n\t\t\t \n\t\t\t mediump vec4 w, d;\n\t\t\t \n\t\t\t w.x = dot(x, x);\n\t\t\t w.y = dot(x1, x1);\n\t\t\t w.z = dot(x2, x2);\n\t\t\t w.w = dot(x3, x3);\n\t\t\t \n\t\t\t w = max(0.6 - w, 0.0);\n\t\t\t \n\t\t\t d.x = dot(random3(hs), x);\n\t\t\t d.y = dot(random3(hs + i1), x1);\n\t\t\t d.z = dot(random3(hs + i2), x2);\n\t\t\t d.w = dot(random3(hs + 1.0), x3);\n\t\t\t \n\t\t\t w *= w;\n\t\t\t w *= w;\n\t\t\t d *= w;\n\t\t\t \n\t\t\t return dot(d, vec4(52.0));\n\t\t}",[e]);t.keywords.F3=new UQ("float F3 0.3333333"),t.keywords.G3=new UQ("float G3 0.1666667");let i=new BQ("float simplexPrecise(vec3 p) {\n\t\t\t vec3 s = floor(p + dot(p, vec3(F3)));\n\t\t\t vec3 x = p - s + dot(s, vec3(G3));\n\t\t\t \n\t\t\t vec3 e = step(vec3(0.0), x - x.yzx);\n\t\t\t vec3 i1 = e*(1.0 - e.zxy);\n\t\t\t vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n\t\t\t\t\n\t\t\t vec3 x1 = x - i1 + G3;\n\t\t\t vec3 x2 = x - i2 + 2.0*G3;\n\t\t\t vec3 x3 = x - 1.0 + 3.0*G3;\n\t\t\t \n\t\t\t vec4 w, d;\n\t\t\t \n\t\t\t w.x = dot(x, x);\n\t\t\t w.y = dot(x1, x1);\n\t\t\t w.z = dot(x2, x2);\n\t\t\t w.w = dot(x3, x3);\n\t\t\t \n\t\t\t w = max(0.6 - w, 0.0);\n\t\t\t \n\t\t\t d.x = dot(random3(s), x);\n\t\t\t d.y = dot(random3(s + i1), x1);\n\t\t\t d.z = dot(random3(s + i2), x2);\n\t\t\t d.w = dot(random3(s + 1.0), x3);\n\t\t\t \n\t\t\t w *= w;\n\t\t\t w *= w;\n\t\t\t d *= w;\n\t\t\t \n\t\t\t return dot(d, vec4(52.0));\n\t\t}",[e]);i.keywords.F3=new UQ("float F3 0.3333333"),i.keywords.G3=new UQ("float G3 0.1666667");let n=new BQ("float simplexFractal(vec3 m) {\n\t\t\tmat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);\n\t\t\tmat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);\n\t\t\tmat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);\n\t\t\treturn 0.5333333 * simplexFast(m * rot1)\n\t\t\t\t + 0.2666667 * simplexFast(2.0 * m * rot2)\n\t\t\t\t + 0.1333333 * simplexFast(4.0 * m * rot3)\n\t\t\t\t + 0.0666667 * simplexFast(8.0 * m);\n\t\t}",[t]),r=new BQ("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),a=new BQ("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),o=new BQ("float simplexAshima(vec3 v) {\n\t\t  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n\t\t  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\t\t  vec3 i  = floor(v + dot(v, C.yyy) );\n\t\t  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\t\t  vec3 g = step(x0.yzx, x0.xyz);\n\t\t  vec3 l = 1.0 - g;\n\t\t  vec3 i1 = min( g.xyz, l.zxy );\n\t\t  vec3 i2 = max( g.xyz, l.zxy );\n\t\t  vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n\t\t  vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n\t\t  vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n\t\t  i = mod(i, 289.0 ); \n\t\t  vec4 p = permute( permute( permute( \n\t\t\t\t\t i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n\t\t\t\t   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \n\t\t\t\t   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\t\t  float n_ = 1.0/7.0; // N=7\n\t\t  vec3  ns = n_ * D.wyz - D.xzx;\n\t\t  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)\n\t\t  vec4 x_ = floor(j * ns.z);\n\t\t  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\t\t  vec4 x = x_ *ns.x + ns.yyyy;\n\t\t  vec4 y = y_ *ns.x + ns.yyyy;\n\t\t  vec4 h = 1.0 - abs(x) - abs(y);\n\t\t  vec4 b0 = vec4( x.xy, y.xy );\n\t\t  vec4 b1 = vec4( x.zw, y.zw );\n\t\t  vec4 s0 = floor(b0)*2.0 + 1.0;\n\t\t  vec4 s1 = floor(b1)*2.0 + 1.0;\n\t\t  vec4 sh = -step(h, vec4(0.0));\n\t\t  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n\t\t  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\t\t  vec3 p0 = vec3(a0.xy,h.x);\n\t\t  vec3 p1 = vec3(a0.zw,h.y);\n\t\t  vec3 p2 = vec3(a1.xy,h.z);\n\t\t  vec3 p3 = vec3(a1.zw,h.w);\n\t\t  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n\t\t  p0 *= norm.x;\n\t\t  p1 *= norm.y;\n\t\t  p2 *= norm.z;\n\t\t  p3 *= norm.w;\n\t\t  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n\t\t  m = m * m;\n\t\t  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), \n\t\t\t\t\t\t\t\t\t\tdot(p2,x2), dot(p3,x3) ) );\n\t\t}",[r,a]),s=new BQ("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),l=new BQ("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[s]),c=new BQ("float noise(vec3 p){\n\t\t\tvec3 a = floor(p);\n\t\t\tvec3 d = p - a;\n\t\t\td = d * d * (3.0 - 2.0 * d);\n\t\t\tvec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n\t\t\tvec4 k1 = perm(b.xyxy);\n\t\t\tvec4 k2 = perm(k1.xyxy + b.zzww);\n\t\t\tvec4 c = k2 + a.zzzz;\n\t\t\tvec4 k3 = perm(c);\n\t\t\tvec4 k4 = perm(c + 1.0);\n\t\t\tvec4 o1 = fract(k3 * (1.0 / 41.0));\n\t\t\tvec4 o2 = fract(k4 * (1.0 / 41.0));\n\t\t\tvec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n\t\t\tvec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\t\t\treturn o4.y * d.y + o4.x * (1.0 - d.y);\n\t\t}",[l]),d=new BQ("float fbm(vec3 x) {\n\t\t\tfloat v = 0.0;\n\t\t\tfloat a = 0.5;\n\t\t\tvec3 shift = vec3(100);\n\t\t\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\t\t\tv += a * noise(x);\n\t\t\t\tx = x * 2.0 + shift;\n\t\t\t\ta *= 0.5;\n\t\t\t}\n\t\t\treturn v;\n\t\t}",[c]);d.keywords.NUM_OCTAVES=new UQ("int NUM_OCTAVES ".concat(5));let u=new BQ("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),h=new BQ("float perlin(vec3 P){\n\t\t  vec3 Pi0 = floor(P);\n\t\t  vec3 Pi1 = Pi0 + vec3(1.0);\n\t\t  Pi0 = mod(Pi0, 289.0);\n\t\t  Pi1 = mod(Pi1, 289.0);\n\t\t  vec3 Pf0 = fract(P);\n\t\t  vec3 Pf1 = Pf0 - vec3(1.0);\n\t\t  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n\t\t  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n\t\t  vec4 iz0 = Pi0.zzzz;\n\t\t  vec4 iz1 = Pi1.zzzz;\n\t\t  vec4 ixy = permute(permute(ix) + iy);\n\t\t  vec4 ixy0 = permute(ixy + iz0);\n\t\t  vec4 ixy1 = permute(ixy + iz1);\n\t\t  vec4 gx0 = ixy0 / 7.0;\n\t\t  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;\n\t\t  gx0 = fract(gx0);\n\t\t  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n\t\t  vec4 sz0 = step(gz0, vec4(0.0));\n\t\t  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n\t\t  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\t\t  vec4 gx1 = ixy1 / 7.0;\n\t\t  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;\n\t\t  gx1 = fract(gx1);\n\t\t  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n\t\t  vec4 sz1 = step(gz1, vec4(0.0));\n\t\t  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n\t\t  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\t\t  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n\t\t  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n\t\t  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n\t\t  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n\t\t  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n\t\t  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n\t\t  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n\t\t  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\t\t  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n\t\t  g000 *= norm0.x;\n\t\t  g010 *= norm0.y;\n\t\t  g100 *= norm0.z;\n\t\t  g110 *= norm0.w;\n\t\t  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n\t\t  g001 *= norm1.x;\n\t\t  g011 *= norm1.y;\n\t\t  g101 *= norm1.z;\n\t\t  g111 *= norm1.w;\n\t\t  float n000 = dot(g000, Pf0);\n\t\t  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n\t\t  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n\t\t  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n\t\t  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n\t\t  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n\t\t  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n\t\t  float n111 = dot(g111, Pf1);\n\t\t  vec3 fade_xyz = fade(Pf0);\n\t\t  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n\t\t  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n\t\t  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); \n\t\t  return 2.2 * n_xyz;\n\t\t}",[r,a,u]),p=new BQ("float hashwithoutsine13(vec3 p3)\n\t\t{\n\t\t\tp3  = fract(p3 * .1031);\n\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t}"),f=new BQ("vec3 hashwithoutsine33(vec3 p3)\n\t\t{\n\t\t\tp3 = fract(p3 * vec3(.1031, .1030, .0973));\n\t\t\tp3 += dot(p3, p3.yxz+33.33);\n\t\t\treturn fract((p3.xxy + p3.yxx)*p3.zyx);\n\t\t}"),m=new BQ("float metric(in vec3 p)\n\t\t{\n\t\t\t// L2 \n\t\t\treturn length(p);\n\n\t\t\t// Chebyshev \n\t\t\t// vec3 a = abs(p);\n\t\t\t// return max(a.x, max(a.y, a.z));\n\t\t}"),g=new BQ("float smin( float a, float b, float k )\n\t\t{\n\t\t\tfloat h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);\n\t\t\tfloat correction = k * h * (1.0 - h);\n\t\t\treturn mix(b, a, h) - correction;\n\t\t}"),v=new BQ("float smax( float a, float b, float k )\n\t\t{\n\t\t\tfloat h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);\n\t\t\tfloat correction = k * h * (1.0 - h);\n\t\t\treturn mix(a, b, h) + correction;\n\t\t}"),y=new BQ("float remap(float value, float input_min, float input_max, float output_min, float output_max) {\n\t\t\t// Compute width of each interval\n\t\t\tfloat input_width = input_max - input_min;\n\t\t\tfloat output_width = output_max - output_min;\n\t\t\n\t\t\t// Convert input range into a 0-1 range \n\t\t\tfloat scaled = (value - input_min) / input_width;\n\t\t\n\t\t\t// Convert the 0-1 range into a value in output range\n\t\t\treturn output_min + (scaled * output_width);\n\t\t}");return{simplexFast:t,simplexPrecise:i,simplexFractal:n,simplexAshima:o,fbm:d,perlin:h,voronoi:new BQ('float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) \n\t\t{\n\t\t\t// Integer and fractional parts of this point\'s coordinates\n\t\t\tivec3 p = ivec3(floor(x));\n\t\t\tvec3 f = fract(x);\n\n\t\t\t// Different variables that we will use to construct noise:\n\t\t\t//\n\t\t\t// f1: distance to the closest feature point\n\t\t\t// f2: distance to the second closest feature point\n\t\t\t// e: distance to the closest edge (cell boundary)\n\t\t\t//\n\t\t\t// We also compute "smooth" versions of all of the above quantites, essentially\n\t\t\t// replacing "hard" minimums with "smooth" minimums (described by IQ)\n\t\t\tfloat f1_smooth = 8.0;\n\t\t\tfloat f1 = 8.0;\n\t\t\tfloat f2_smooth = 8.0;\n\t\t\tfloat f2 = 8.0;\n\t\t\tfloat e_smooth = 8.0;\n\t\t\tfloat e = 8.0;\n\n\t\t\t// Variables stored from closest cell\n\t\t\tivec3 mb;\n\t\t\tvec3 mr; \n\n\t\t\tint steps = quality;\n\t\t\t\n\t\t\tfor (int x = -steps; x <= steps; x++) \n\t\t\tfor (int y = -steps; y <= steps; y++)\n\t\t\tfor (int z = -steps; z <= steps; z++)\n\t\t\t{\n\t\t\t\tivec3 b = ivec3(x, y, z);\n\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\tfloat d = length(r);\n\t\t\t\t\n\t\t\t\tf1_smooth = smin(d, f1_smooth, smoothness);\n\n\t\t\t\t// Store un-smoothed distances too \n\t\t\t\tif (d < f1) \n\t\t\t\t{\n\t\t\t\t\tf2 = f1;\n\t\t\t\t\tf1 = d;\n\n\t\t\t\t\tmb = ivec3(x, y, z);\n\t\t\t\t\tmr = r;\n\t\t\t\t} \n\t\t\t\telse if (d < f2) \n\t\t\t\t{\n\t\t\t\t\tf2 = d;\n\t\t\t\t}\n\t\t\t}\t\n\t\t\t\n\t\t\t// Second pass for edge distance  \n\t\t\t// skip for styles don\'t need\n\t\t\tif (style != 0 &&  style != 5 && style != 7)\n\t\t\tfor (int x = -steps; x <= steps; x++) \n\t\t\tfor (int y = -steps; y <= steps; y++)\n\t\t\tfor (int z = -steps; z <= steps; z++)\n\t\t\t{\n\t\t\t\t// Start search at the cell that contains the closest point to "x" (found in 1st pass)\n\t\t\t\tivec3 b = mb + ivec3(x, y, z);\n\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\tfloat d1 = dot(0.5 * (mr + r), (r - mr)); \t\t\t\t// IQ normalizes "r - mr" but that breaks things for the smooth version?\n\t\t\t\tfloat d2 = dot(0.5 * (mr + r), normalize(r - mr));\n\n\t\t\t\te_smooth = smin(d1, e_smooth, smoothness);\n\n\t\t\t\te = min(e, d2);\n\n\t\t\t\t// Also compute a smooth version of F2 in this pass\n\t\t\t\t{\n\t\t\t\t\tivec3 b = ivec3(x, y, z);\n\t\t\t\t\tif (b != mb) \n\t\t\t\t\t{\n\t\t\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\t\t\tfloat d = length(r);\n\n\t\t\t\t\t\tf2_smooth = smin(d, f2_smooth, smoothness);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Different visualization modes \n\t\t\tif (style == 0) \n\t\t\t{\n\t\t\t\treturn f1_smooth;\n\t\t\t}\n\t\t\tif (style == 1) \n\t\t\t{\n\t\t\t\treturn f2_smooth;\n\t\t\t}\n\t\t\tif (style == 2) \n\t\t\t{\n\t\t\t\treturn f2_smooth - f1_smooth;\n\t\t\t\t\n\t\t\t\t// "Pebbles" also cool\n\t\t\t\t//return step(0.2, f2_smooth - f1_smooth);\n\t\t\t}\n\t\t\tif (style == 3) \n\t\t\t{\n\t\t\t\t// This one is really good for rock / stone effects\n\t\t\t\tfloat a = f1; \n\t\t\t\tfloat b = f2;\n\t\t\t\tfloat k = 3.0;\n\t\t\t\tfloat h = max(k - abs(a - b), 0.0) / k;\n\t\t\t\tfloat final = min(a, b) - h * h * k * (1.0 / 4.0);\n\t\t\t\treturn final;\n\t\t\t}\n\t\t\tif (style == 4) \n\t\t\t{\n\t\t\t\t// Some random adjustments to make this style stand out more \n\t\t\t\treturn exp(5.0 * e_smooth);\n\t\t\t}\n\t\t\tif (style == 5) \n\t\t\t{\n\t\t\t\treturn pow(f1_smooth, 3.0);\n\t\t\t}\n\t\t\tif (style == 6) \n\t\t\t{\t\t\t\t\n\t\t\t\tconst float eps = 0.0125;\n\n\t\t\t\t// Thicker lines as the user increases the smoothness slider\n\t\t\t\tfloat thickness = smoothness * 0.25 + eps;\n\n\t\t\t\t// Blurrier lines as the user increases the smoothness slider\n\t\t\t\tfloat blur = pow(smoothness, 3.0) * 0.25 + eps;\n\n\t\t\t\treturn smoothstep(\n\t\t\t\t\tthickness - thickness * blur, \n\t\t\t\t\tthickness + thickness * blur, \n\t\t\t\t\te\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (style == 7) \n\t\t\t{\n\t\t\t\treturn hashwithoutsine13(vec3(p + mb) + seed);\n\t\t\t}\n\t\t}\n\t',[p,f,m,g,v,y])}}(),WK=class extends PQ{constructor(e,t,i,n,r,a,o,s,l,c,d,u,h,p,f,m,g,v,y){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=i,this.fA=n,this.fB=r,this.distortion=a,this.colorA=o,this.colorB=s,this.colorC=l,this.colorD=c,this.noiseType=u,this.voronoiStyle=p,this.highCut=f,this.lowCut=m,this.smoothness=g,this.seed=v,this.quality=y,this.isMask=h,this.alpha=d,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t,i,n,r){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let a=["simplexFast","simplexFractal","simplexAshima","fbm","perlin","voronoi"][this.noiseType.value],o="voronoi"==a?"\n\t\tfloat v = ".concat(a,'(st + move, voronoiStyle, smoothness, seed, quality);\n\n\t\t// Apply clipping to colors\n\t\tv = remap(v, lowCut, highCut, 0.0, 1.0);\n\t\tv = smax(v, 0.0, smoothness * 0.25);\n\t\tv = smin(v, 1.0, smoothness * 0.25);\n\n\t\t// Note that the voronoi mode only uses colors "A" and "C" from the UI \n\t\tvec4 color = mix(colorA, colorC, v); \n\t\t'):"\n\t\tvec3 q = vec3(".concat(a,"(st),\n\t\t\t\t\t   ").concat(a,"(st + vec3(1.0)),\n\t\t\t\t\t   ").concat(a,"(st + vec3(1.0)));\n\t\tvec3 r = vec3(").concat(a,"(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),\n\t\t\t\t\t  ").concat(a,"(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), \n\t\t\t\t\t  ").concat(a,"(st * q));\n\t\tfloat f = ").concat(a,"(st + r);\n\t\tvec4 color;\n\t\tcolor = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));\n\t\tcolor = mix(color, colorC, clamp(length(q), 0.0, 1.0));\n\t\tcolor = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));\n\t\t"),s=new BQ("vec3 ".concat(a,"customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) \n\t\t\t{\n                // Prevent scale of zero \n\t\t\t\tscale = max(abs(scale), 0.001);\n\n\t\t\t\tvec3 st = position / size;\n\t\t\t\tst /= scale;\n\n\t\t\t\t").concat(o,"\n\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn clamp(color, 0.0, 1.0).rgb;\n\t\t\t}"),[jK.simplexFast,jK.simplexFractal,jK.simplexAshima,jK.fbm,jK.perlin,jK.voronoi]),l=e.include(s),c=[];return c.push(this.scale.build(e,"f")),c.push(this.size.build(e,"v3")),c.push(this.move.build(e,"f")),c.push(this.fA.build(e,"v2")),c.push(this.fB.build(e,"v2")),c.push(this.distortion.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.colorC.build(e,"v4")),c.push(this.colorD.build(e,"v4")),c.push(this.voronoiStyle.build(e,"i")),c.push(this.highCut.build(e,"f")),c.push(this.lowCut.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.seed.build(e,"f")),c.push(this.quality.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}};WK.numOctaves=5;var HK=class extends PQ{constructor(e,t,i,n,r,a,o,s,l,c,d,u,h,p,f,m){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=i,this.contourWidth=n,this.contourThreshold=r,this.outlineThreshold=a,this.contourFrequency=o,this.outlineSmoothing=s,this.contourDirection=l,this.positionalLines=c,this.compensation=d,this.resolution=u,this.normalMap=h,this.depthMap=p,this.pixelRatio=f,this.alpha=m,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){let i="g".concat(this.uuid.toString().replace(/-/g,""));if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION","".concat(i,"_offset")),this.firstTime){let t=this.outlineWidth.build(e,"f"),n=this.resolution.build(e,"v2"),r=this.compensation.build(e,"b"),a=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(t,"uniform float"),e.addVertexParsVariable(n,"uniform vec2"),e.addVertexParsVariable(r,"uniform bool"),e.addVertexParsVariable(a,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode("\n                vID = randomColor.r;\n                vec2 ".concat(i,"_offset = vec2(0.0);\n                if (").concat(r,") {\n                    vec4 ").concat(i,"_clipPosition = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));\n                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the\n                    // normals face the camera directly. So we hackily fix this by offsetting the normal\n                    // by a tiny amount.\n                    vec3 ").concat(i,"_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;\n                    ").concat(i,"_offset = normalize(").concat(i,"_clipNormal.xy) / ").concat(n," * (").concat(t," / 2.0) * ").concat(i,"_clipPosition.w * 2.0 * ").concat(a,";\n                    ").concat(i,"_clipPosition.xy += ").concat(i,"_offset;\n                    // TODO(MAX): To handle multiple outline layers, we only want to extrude\n                    // if this offset is the biggest of all the potential offsets\n                    gl_Position = ").concat(i,"_clipPosition;\n                }\n            "))}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(HK.Nodes.outline),n=[];return n.push(this.outlineColor.build(e,"c")),n.push(this.contourColor.build(e,"c")),n.push(this.outlineWidth.build(e,"f")),n.push(this.contourWidth.build(e,"f")),n.push(this.contourThreshold.build(e,"f")),n.push(this.outlineThreshold.build(e,"f")),n.push(this.contourFrequency.build(e,"f")),n.push(this.outlineSmoothing.build(e,"f")),n.push(this.contourDirection.build(e,"v3")),n.push(this.positionalLines.build(e,"b")),n.push(this.resolution.build(e,"v2")),n.push(this.normalMap.getTexture(e,"t")),n.push(this.depthMap.getTexture(e,"t")),n.push(this.pixelRatio.build(e,"f")),n.push(this.compensation.build(e,"b")),n.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),this.firstTime=!this.firstTime,e.format(i+"("+n.join(",")+")",this.getType(e),t)}return console.warn("OutlineNode is not compatible with "+e.shader+" shader."),""}},GK=HK;GK.Nodes=function(){let e=new BQ("\nfloat sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)\n{\n    vec2 halton = haltonSequence[frameIndex];\n    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n    float temporalAngle  = temporalOffset * PI2;\n\n    vec2 texelSize = (vec2(1.0) / resolution);\n    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;\n\n    vec2 uvSamples[9];\n    vec4 normalSamples[9];\n\n\tuvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);\n\tuvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);\n\tuvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);\n\tuvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);\n\tuvSamples[4] = uv;\n\tuvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);\n\tuvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);\n\tuvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);\n\tuvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);\n\n\n    normalSamples[0] = texture2D(t, uvSamples[0]);\n    normalSamples[1] = texture2D(t, uvSamples[1]);\n    normalSamples[2] = texture2D(t, uvSamples[2]);\n    normalSamples[3] = texture2D(t, uvSamples[3]);\n    normalSamples[4] = texture2D(t, uvSamples[4]);\n    normalSamples[5] = texture2D(t, uvSamples[5]);\n    normalSamples[6] = texture2D(t, uvSamples[6]);\n    normalSamples[7] = texture2D(t, uvSamples[7]);\n    normalSamples[8] = texture2D(t, uvSamples[8]);\n\n    float depthBias = 0.0001;\n    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!\n    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n\n    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);\n  \tvec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);\n\n    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));\n    return edgeNormal;\n}\n");return{outline:new BQ("vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {\n                vec3 result = outlineColor;\n                float resultAlpha = 0.0;\n\n                vec3 N = normalize(vWNormal);\n                vec2 nuv = (gl_FragCoord.xy / resolution);\n                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);\n                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);\n\n                //resultAlpha = 1.0;\n                //result = vec3(sobelSample);\n\n                float t = 1.0 - contourThreshold;\n                if(positionalLines) {\n                    vec3 NDir = position * contourDirection;\n                    float NT = NDir.x + NDir.y + NDir.z;\n                    float f  = fract(NT * contourFrequency * 0.01);\n                    float df = fwidth(NT * contourFrequency);\n\n                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);\n                    if (g < 1.0 && resultAlpha == 0.0) {\n                        result = contourColor;\n                        resultAlpha = 1.0;\n                    }\n                 }\n                 else {\n                    vec3 NDir = N * contourDirection;\n                    float NT = NDir.x + NDir.y + NDir.z;\n                    float df = fwidth(NT * contourThreshold);\n                    float f = sin(NT * 1.0 * contourFrequency);\n                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);\n\n                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {\n                        result = contourColor;\n                        resultAlpha = 1.0 - g;\n                    }\n                 }\n\n                 float lalpha = alpha * resultAlpha * mask;\n                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;\n\t\t\t\t \n                 return result;\n             }",[e])}}();var qK=class extends PQ{constructor(e,t,i,n,r,a,o,s,l,c,d,u,h,p,f,m,g,v){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=i,this.blending=n,this.offset=r,this.colorA=a,this.colorB=o,this.frequency=s,this.size=l,this.variation=c,this.smoothness=d,this.zigzag=u,this.rotation=h,this.vertical=p,this.horizontal=f,this.sides=m,this.isMask=v,this.alpha=g,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.isShader("fragment")){let i;switch(e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float"),this.style.value){case 0:default:i="circle";break;case 1:i="ring";break;case 2:i="polygon";break;case 3:i="xcross";break;case 4:i="diamond";break;case 5:i="checkerboard";break;case 6:i="line";break;case 7:i="wave"}let n="g".concat(this.uuid.toString().replace(/-/g,"")),r=new BQ("float hashwithoutsine12(vec2 p)\n\t\t\t\t{\n\t\t\t\t\tvec3 p3 = fract(vec3(p.xyx) * .1031);\n\t\t\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t\t\t}"),a=new BQ("vec2 rotate_uv(in vec2 uv, float a, bool repeat) \n\t\t\t\t{\n\t\t\t\t\tconst float mid = 0.5;\n\t\t\t\t\tfloat radians = a * (PI / 180.0);\n\t\t\t\t\tvec2 rotated = vec2(\n\t\t\t\t\t\tcos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,\n\t\t\t\t\t\tcos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid\n\t\t\t\t\t);\n\t\t\t\t\treturn repeat ? fract(rotated): rotated;\n\t\t\t\t}"),o="";if(4===this.projection.value){let e=2===this.style.value?"".concat(i,"(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)"):"".concat(i,"(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)"),t=2===this.style.value?"".concat(i,"(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)"):"".concat(i,"(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)"),n=2===this.style.value?"".concat(i,"(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)"):"".concat(i,"(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)");o="\n\t\t\t\tvec3 p = position;\n\t\t\t\tfloat factor = 0.0125;\n\t\t\t\tvec2 uv0 = fract(p.xy * factor);\n\t\t\t\tvec2 uv1 = fract(p.zy * factor);\n\t\t\t\tvec2 uv2 = fract(p.xz * factor);\n\t\t\t\t\n\t\t\t\tuv0 = rotate_uv(uv0 + offset, rotation, true);\n\t\t\t\tuv1 = rotate_uv(uv1 + offset, rotation, true);\n\t\t\t\tuv2 = rotate_uv(uv2 + offset, rotation, true);\n\t\n\t\t\t\tfloat d0 = ".concat(e,";\n\t\t\t\tfloat d1 = ").concat(t,";\n\t\t\t\tfloat d2 = ").concat(n,";\n\t\t\t\t\n\t\t\t\t// Range from 3 to 128 seems to be good\n\t\t\t\tfloat exponent = (1.0 - blending) * 125.0 + 3.0;\n\n\t\t\t\tvec3 n = vObjectNormal;\n\t\t\t\tvec3 weights = abs(normalize(n));\n\t\t\t\tweights = pow(weights, vec3(exponent));\n\t\t\t\tweights /= dot(weights, vec3(1.0));\n\t\t\t\td0 *= weights.z;\n\t\t\t\td1 *= weights.x;\n\t\t\t\td2 *= weights.y;\n\t\t\t\tfloat draw = d0 + d1 + d2;\n\t\n\t\t\t\tvec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;\n\t\t\t\t")}else{let e=2===this.style.value?"".concat(i,"(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)"):"".concat(i,"(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)"),t="";0===this.axis.value?t="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.y, p.z);\n\t\t\t\t\tfloat phi = acos(p.x / radius);":1===this.axis.value?t="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.x, p.z);\n\t\t\t\t\tfloat phi = acos(p.y / radius);":(this.axis.value,t="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.y, p.x);\n\t\t\t\t\tfloat phi = acos(p.z / radius);");let n="";switch(this.projection.value){case 0:n="custom_uv = vUv.st;";break;case 1:case 3:default:break;case 2:n="\n\t\t\t\t\t\t\tvec3 p = position;\n\t\t\t\t\t\t\t".concat(t,"\n\t\t\t\t\t\t\tcustom_uv = vec2(theta, phi);\n\t\t\t\t\t\t\tcustom_uv /= PI;\n\t\t\t\t\t\t\t")}o="\n\t\t\t\tvec2 custom_uv;\n\t\t\t\t".concat(n,"\n\t\n\t\t\t\tcustom_uv += offset;\n\t\t\t\tcustom_uv = fract(custom_uv);\n\t\t\t\tcustom_uv = rotate_uv(custom_uv, rotation, true);\n\t\n\t\t\t\tfloat draw = ").concat(e,";\n\t\t\t\t")}let s=new BQ("vec3 ".concat(n,"_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\t\tconst float TWO_PI = PI * 2.0;\n\t\t\t\t\tfloat smoothness_remapped = pow(smoothness, 5.0);\t\n\n\t\t\t\t\t").concat(o,"\n\n\t\t\t\t\t// Construct final output color\n\t\t\t\t\tvec4 color = mix(colorA, colorB, draw);\n\t\t\t\t\tcolor.a = clamp(color.a, 0.0, 1.0);\n\n\t\t\t\t\t// Apply cuts\n\t\t\t\t\tcolor.a *= \n\t\t\t\t\t\tstep(vertical.x, custom_uv.y) * \n\t\t\t\t\t\tstep(custom_uv.y, vertical.y);\n\t\t\t\t\tcolor.a *= \n\t\t\t\t\t\tstep(horizontal.x, abs(custom_uv.x)) * \n\t\t\t\t\t\tstep(abs(custom_uv.x), horizontal.y);\n\n\t\t\t\t\t// Accumulate alpha \n\t\t\t\t\tfloat lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\t\treturn clamp(color, 0.0, 1.0).rgb;\n\t\t\t\t}"),[a,r,qK.DrawFunctions.circle,qK.DrawFunctions.ring,qK.DrawFunctions.polygon,qK.DrawFunctions.cross,qK.DrawFunctions.diamond,qK.DrawFunctions.checkerboard,qK.DrawFunctions.line,qK.DrawFunctions.wave]),l=e.include(s),c=[];return c.push("normal"),c.push(this.blending.build(e,"f")),c.push(this.style.build(e,"i")),c.push(this.offset.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.frequency.build(e,"v2")),c.push(this.size.build(e,"f")),c.push(this.variation.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.zigzag.build(e,"f")),c.push(this.rotation.build(e,"f")),c.push(this.vertical.build(e,"v2")),c.push(this.horizontal.build(e,"v2")),c.push(this.sides.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}return console.warn("PatterNode is not compatible with "+e.shader+" shader."),e.format("vec3(0.0)",this.getType(e),t)}},XK=qK;XK.DrawFunctions=function(){let e=new BQ("float hashwithoutsine12(vec2 p) {\n\t\t\t\tvec3 p3 = fract(vec3(p.xyx) * 0.1031);\n\t\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t\t}"),t=new BQ("vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {\n                // Create tiles in UV-space\n                uv *= frequency;\n\n                // Integer coords\n                vec2 i = floor(uv);\n\n                // Offset every other row based on zigzag param, then compute fractional coords\n                float row_offset = mod(i.y, 2.0);\n                uv.x += row_offset * zigzag;\n                vec2 f = fract(uv);\n\n\t\t\t\t// Rotate the tile itself:\n\t\t\t\t// const float mid = 0.5;\n\t\t\t\t// f = vec2(\n\t\t\t\t// \tcos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,\n\t\t\t\t// \tcos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid\n\t\t\t\t// );\n\t\t\t\t// f = fract(f);\n\n                f = f * 2.0 - 1.0;\n\n\t\t\t\t// Recompute integer coords after shifting - then, random value per tile \n\t\t\t\ti = floor(uv);\n\t\t\t\tfloat rand = (hashwithoutsine12(i) * 5.0 + 1.0);\n\t\t\t\tfloat jitter = mix(1.0, rand, variation);\n\t\t\t\tf *= jitter;\n\n                return f;\n            }",[e]);return{tileAndCenter:t,circle:new BQ("float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(\n                    -smoothness, \n                     smoothness, \n                     length(f) - size\n                );\n            }",[t]),ring:new BQ("float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n\n\t\t\t\tfloat d = length(f);\n                const float inner_width = 0.5;\n\n                float outer = smoothstep(-smoothness, smoothness, d - size);\n                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);\n\t\t\t\treturn outer + (1.0 - inner);   \n            }",[t]),polygon:new BQ("float sdf_ngon(in vec2 p, in float r, in int n) {\n                float an = (PI * 2.0) / float(n);\n                float he = r * tan(0.5 * an);\n                \n                // Rotate to first sector\n                p = -p.yx; \n                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);\n                vec2  cs = vec2(cos(bn), sin(bn));\n                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;\n            \n                // Side of polygon\n                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);\n            }\n            \n            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));\n            }",[t]),cross:new BQ("float sdf_cross(in vec2 p, in vec2 b, float r ) {\n                p = abs(p); \n\t\t\t\tp = (p.y > p.x) ? p.yx : p.xy;\n                vec2  q = p - b;\n                float k = max(q.y, q.x);\n                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);\n                return sign(k) * length(max(w, 0.0)) + r;\n            }\n            \n            // Avoid namespace conflicts \n            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));\n            }",[t]),diamond:new BQ("float ndot(vec2 a, vec2 b) { \n                return a.x*b.x - a.y*b.y; \n            }\n            \n            float sdf_diamond(in vec2 p, in vec2 b) {\n                p = abs(p);\n                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);\n                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));\n                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);\n            }\n\n            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n\t            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));\n            }",[t]),checkerboard:new BQ("float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                uv *= frequency;\n                vec2 i = floor(uv);\n\n                float offset = mod(i.y, 2.0);\n\n                uv.x += offset + zigzag * offset;\n                float x = floor(uv.x);\n                \n                return mod(x, 2.0);\n            }"),line:new BQ("float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);\n\t\t\t\t\n\t\t\t\t// Different approach for variation param here\n\t\t\t\tfloat row = floor(uv * frequency).y;\n\t\t\t\tfloat rand = hashwithoutsine12(vec2(row));\n\t\t\t\tfloat s = mix(size, size * rand, variation);\n\n\t\t\t\treturn smoothstep(\n\t\t\t\t\ts - smoothness, \n\t\t\t\t\ts + smoothness, \n\t\t\t\t\tabs(f.y)\n\t\t\t\t);\n            }",[t]),wave:new BQ("// Uses bisection \n            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {\n                // Convert all data to a primitive cosine wave\n                p = c * (p - vec2(d, a));\n                \n                const float TWO_PI = PI * 2.0;\n\n                // Reduce to principal half cycle\n                p.x = mod(p.x, TWO_PI); \n                if (p.x > PI) {\n                    p.x = TWO_PI - p.x;\n                }\n            \n                // Find zero of derivative (minimize distance)\n                float xa = 0.0;\n                float xb = TWO_PI;\n\n                // 24 bit precision\n                for (int i = 0; i < 24; i++) {\n                    float x = 0.5 * (xa + xb);\n                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));\n                    if (y < 0.0) xa = x; \n                    else xb = x;\n                }\n                float x = 0.5 * (xa + xb);\n                \n                // Compute distance    \n                vec2 q = vec2(x, b * c * cos(x));\n                return length(p - q) / c;\n            }\n\n            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                float repeat = frequency.x;\n                uv *= repeat;\n                vec2 i = floor(uv);\n                float row_offset = mod(i.y, 2.0);\n                uv.x += row_offset * zigzag;\n                vec2 f = vec2(uv.x, fract(uv.y));\n\n                // Generalized cosine: y(x) = a + b * cos(cx + d)\n                const float amplitude = 0.125;\n                float wave_frequency = frequency.y * 0.1;\n                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);\n\n\t\t\t\t// Different approach for variation param here\n\t\t\t\tfloat rand = hashwithoutsine12(vec2(i.y));\n\t\t\t\tfloat s = mix(size, size * rand, variation);\n\n                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);\n            }")}}();var YK=class extends PQ{constructor(e,t,i,n,r,a,o,s){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=i,this.noiseStrength=n,this.noiseScale=r,this.offset=a,this.isMask=s,this.alpha=o,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(YK.Nodes.rainbow),n=[];return n.push(this.filmThickness.build(e,"f")),n.push(this.movement.build(e,"f")),n.push(this.wavelengths.build(e,"v3")),n.push(this.noiseStrength.build(e,"f")),n.push(this.noiseScale.build(e,"f")),n.push(this.offset.build(e,"v3")),n.push(this.isMask.build(e,"b")),n.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},QK=YK;QK.Nodes=function(){let e=new BQ("vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {\n\t\t\t\tfloat f = 0.0;\n\t\t\t\t\n\t\t\t\tif (noiseStrength != 0.0) {\n\t\t\t\t\tvec3 st = position / noiseScale;\n\t\t\t\t\tfloat noise = simplexFast(1.6 * st + vec3(1.8, 1.5, 1.9) * simplexFast(st) + vec3(1.7, 9.2, 1.0));\n\t\t\t\t\tf = noise * noiseStrength;\n\t\t\t\t}\n\n\t\t\t\tvec3 waves = wavelengths * vec3(1.0, 0.8, 0.6) + 1.0;\n\t\t\t\tfloat angle = dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal));\n\n\t\t\t\tmediump vec3 color = cos((((filmThickness + f) / waves) * angle) + movement);\n\t\t\t\treturn .5 + .5 * color;\n\t\t\t }",[jK.simplexFast]);return{rainbow:new BQ("vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\tmediump vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);\n\n\t\t\t\tfloat rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);\n\n\t\t\t\tfloat lalpha = alpha * rainbowContribution * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn res;\n\t\t\t }",[e])}}();var KK=class extends PQ{constructor(e,t,i,n,r,a,o,s,l,c){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=i,this.source=n,this.isWorldSpace=r,this.noiseStrength=a,this.noiseScale=o,this.shadowColor=s,this.offset=l,this.alpha=c,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let i=e.include(KK.Nodes.toon),n=[];return n.push(this.positioning.build(e,"i")),n.push(this.colors.build(e,"v4[]")),n.push(this.steps.build(e,"f[]")),n.push(this.source.build(e,"v3")),n.push(this.isWorldSpace.build(e,"b")),n.push(this.noiseStrength.build(e,"f")),n.push(this.noiseScale.build(e,"f")),n.push(this.shadowColor.build(e,"v4")),n.push(this.offset.build(e,"v3")),n.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}return console.warn("ToonNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},ZK=KK;ZK.Nodes=function(){let e=new BQ("float rand(float n) {\n\t\t\t\treturn fract(sin(n) * 43758.5453123);\n\t\t\t}"),t=new BQ("float hash1(float p) { \n\t\t\t\tp = fract(p * 0.011); \n\t\t\t\tp *= p + 7.5; \n\t\t\t\tp *= p + p; \n\t\t\t\treturn fract(p); \n\t\t\t}"),i=new BQ("float valueNoise(vec3 x) {\n\t\t\t\tconst vec3 step = vec3(110, 241, 171);\n\t\t\t\n\t\t\t\tvec3 i = floor(x);\n\t\t\t\tvec3 f = fract(x);\n\t\t\t \n\t\t\t\t// For performance, compute the base input to a 1D hash from the integer part of the argument and the \n\t\t\t\t// incremental change to the 1D based on the 3D -> 1D wrapping\n\t\t\t\tfloat n = dot(i, step);\n\t\t\t\n\t\t\t\tvec3 u = f * f * (3.0 - 2.0 * f);\n\t\t\t\treturn mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),\n\t\t\t\t\t\t\t   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),\n\t\t\t\t\t\t   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),\n\t\t\t\t\t\t\t   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);\n\t\t\t}",[t]),n=new BQ("vec3 hash3(vec3 x) {\n\t\t\t\tx = vec3(dot(x,vec3(127.1, 311.7, 74.7)),\n\t\t\t\t\t\t dot(x,vec3(269.5, 183.3, 246.1)),\n\t\t\t\t\t\t dot(x,vec3(113.5, 271.9, 124.6)));\n\t\t\t\n\t\t\t\treturn fract(sin(x)*43758.5453123);\n\t\t\t}"),r=new BQ('vec3 voronoiNoise(in vec3 x)\n\t\t\t{\n\t\t\t\tvec3 p = floor(x);\n\t\t\t\tvec3 f = fract(x);\n\n\t\t\t\tfloat id = 0.0;\n\t\t\t\tvec2 res = vec2(100.0);\n\n\t\t\t\tfor(int k=-1; k<=1; k++)\n\t\t\t\tfor(int j=-1; j<=1; j++)\n\t\t\t\tfor(int i=-1; i<=1; i++)\n\t\t\t\t{\n\t\t\t\t\tvec3 b = vec3(float(i), float(j), float(k));\n\n\t\t\t\t\t// Comment out the "+ hash(p + b);" part below to get "square" cells\n\t\t\t\t\tvec3 r = vec3(b) - f + hash3(p + b);\n\t\t\t\t\tfloat d = dot(r, r);\n\n\t\t\t\t\tif (d < res.x)\n\t\t\t\t\t{\n\t\t\t\t\t\tid = dot(p + b, vec3(1.0, 57.0, 113.0));\n\t\t\t\t\t\tres = vec2(d, res.x);\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\telse if (d < res.y)\n\t\t\t\t\t{\n\t\t\t\t\t\tres.y = d;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn vec3(sqrt(res), abs(id));\n\t\t\t}\n\t\t\t',[n]);return{toon:new BQ('vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {\n\t\t\t\tfloat t = 0.0;\n\t\t\t\tfloat shadow = 1.0;\n\n\t\t\t\tif (positioning == 0) {\n\n\t\t\t\t\t// Can\'t do this mode if lighting is "none"\n\t\t\t\t\t#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))\n\n\t\t\t\t\t\t// Algorithm from Chapter 10 of Graphics Shaders\n\t\t\t\t\t\tconst vec3 weights = vec3(0.2125, 0.7154, 0.0721);\n\t\t\t\t\t\tvec3 lpos;\n\t\t\t\t\t\tvec3 l;\n\t\t\t\t\t\tfloat dproduct;\n\n\t\t\t\t\t\t#if (NUM_POINT_LIGHTS > 0)\n\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tPointLightShadow pointLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_POINT_LIGHTS; i++) {\n\t\t\t\t\t\t\t\t// Light positions are in view-space for some reason?\n\t\t\t\t\t\t\t\tlpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;\n\t\t\t\t\t\t\t\tl = normalize(lpos - worldPosition);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// TODO: we want to use "intensity" but it isn\'t available in the shader code\n\t\t\t\t\t\t\t\t//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);\n\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tpointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getPointShadow( \n\t\t\t\t\t\t\t\t\t\t\tpointShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowRadius,\n\t\t\t\t\t\t\t\t\t\t\tvPointShadowCoord[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowCameraNear, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowCameraFar);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t#if NUM_DIR_LIGHTS > 0 \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tDirectionalLightShadow directionalLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_DIR_LIGHTS; i++) {\n\t\t\t\t\t\t\t\t// Use the direction vector for directional lights instead\n\t\t\t\t\t\t\t\tl = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;\n\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tdirectionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getShadow( \n\t\t\t\t\t\t\t\t\t\tUNROLLED_LOOP_INDEX,\n\t\t\t\t\t\t\t\t\t\tdirectionalShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowRadius, \n\t\t\t\t\t\t\t\t\t\tvDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t#if NUM_SPOT_LIGHTS > 0 \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tSpotLightShadow spotLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_SPOT_LIGHTS; i++) {\n\t\t\t\t\t\t\t\tlpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;\n\t\t\t\t\t\t\t\tl = normalize(lpos - worldPosition);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tspotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getShadow(\n\t\t\t\t\t\t\t\t\t\tUNROLLED_LOOP_INDEX,\n\t\t\t\t\t\t\t\t\t\tspotShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowRadius, \n\t\t\t\t\t\t\t\t\t\tvSpotLightCoord[UNROLLED_LOOP_INDEX]);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\tt = clamp(t, 0.0, 1.0);\n\t\t\t\t\n\t\t\t\t\t#endif\n\n\t\t\t\t} else if (positioning == 1) {\n\t\t\t\t\t\n\t\t\t\t\tvec3 origin = mix(position, worldPosition, float(isWorldSpace));\n\t\t\t\t\tvec3 direction = normalize(source - origin);\n\t\t\t\t\tt = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;\t\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvec3 origin = worldPosition;\n\t\t\t\t\tvec3 source = cameraPosition - offset;\n\t\t\t\t\tvec3 direction = normalize(source - origin);\n\t\t\t\t\tt = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;\t\n\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\tif (noiseStrength > 0.0) {\n\t\t\t\t\t// Distort with noise\n\t\t\t\t\tvec3 st = position / noiseScale;\n\t\t\t\t\t\n\t\t\t\t\t// Voronoi "smooth" noise\n\t\t\t\t\tfloat noise = 1.0 - voronoiNoise(st).x;\n\n\t\t\t\t\t// Voronoi cellular noise\n\t\t\t\t\t//float noise = 1.0 - rand(voronoiNoise(st).z);\n\n\t\t\t\t\t// Position warp noise\n\t\t\t\t\t// vec3 offset = vec3(\n\t\t\t\t\t// \tsimplexFast(st),\n\t\t\t\t\t// \tsimplexFast(st + vec3(111.1, 143.89, 217.19)),\n\t\t\t\t\t// \tsimplexFast(st + vec3(171.1, 247.89, 117.23))\n\t\t\t\t\t// );\n\t\t\t\t\t// st += offset;\n\t\t\t\t\t// float noise = valueNoise(st);\n\n\t\t\t\t\tt += noise * noiseStrength;\n\t\t\t\t}\n\n\t\t\t\tt = clamp(t, 0.0, 1.0);\n\n\t\t\t\t// Compute ramp color\n\t\t\t\tfloat p;\n\t\t\t\tvec4 color = colors[0];\n\t\t\t\tfor (int i = 1; i < COLORS_MAX; i++) {\n\t\t\t\t\tp = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);\n\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t}\n\n\t\t\t\t// Incorporate custom shadow color\n\t\t\t\tif (positioning == 0) {\n\n\t\t\t\t\tvec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);\n\t\t\t\t\tcolor.rgb = mix(blendedShadow, color.rgb, shadow);\n\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\t// Accumulate alpha as usual\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha;\n\n\t\t\t\treturn color.xyz;\n\n            }',[jK.simplexFast,e,i,r])}}();var JK={textureBicubic:new BQ("float w0( float a ) {\n            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n        }\n    \n        float w1( float a ) {\n            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n        }\n    \n        float w2( float a ){\n            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n        }\n    \n        float w3( float a ) {\n            return ( 1.0 / 6.0 ) * ( a * a * a );\n        }\n    \n        // g0 and g1 are the two amplitude functions\n        float g0( float a ) {\n            return w0( a ) + w1( a );\n        }\n    \n        float g1( float a ) {\n            return w2( a ) + w3( a );\n        }\n    \n        // h0 and h1 are the two offset functions\n        float h0( float a ) {\n            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n        }\n    \n        float h1( float a ) {\n            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n        }\n    \n        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n            uv = uv * texelSize.zw + 0.5;\n    \n            vec2 iuv = floor( uv );\n            vec2 fuv = fract( uv );\n    \n            float g0x = g0( fuv.x );\n            float g1x = g1( fuv.x );\n            float h0x = h0( fuv.x );\n            float h1x = h1( fuv.x );\n            float h0y = h0( fuv.y );\n            float h1y = h1( fuv.y );\n    \n            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n    \n            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + \n                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n        }\n\n        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n            vec2 fLodSizeInv = 1.0 / fLodSize;\n            vec2 cLodSizeInv = 1.0 / cLodSize;\n            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n            return mix( fSample, cSample, fract( lod ) );\n        }")};var $K=class extends PQ{constructor(e,t,i,n,r,a,o,s){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=i,this.transmissionSamplerSize=n,this.transmissionSamplerMap=r,this.transmissionDepthMap=a,this.aspectRatio=o,this.alpha=s,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,rZ.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let i=e.include($K.Nodes.transmission),n=[];return n.push(this.thickness.build(e,"f")),n.push(this.ior.build(e,"f")),n.push(this.roughness.build(e,"f")),n.push(this.transmissionSamplerSize.build(e,"v2")),n.push(this.transmissionSamplerMap.getTexture(e,"t")),n.push(this.transmissionDepthMap.getTexture(e,"t")),n.push(this.aspectRatio.build(e,"v2")),n.push("normal"),n.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},eZ=$K;eZ.Nodes=function(){let e=new BQ("vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {\n                // Slightly modified version of this:\n                // https://www.shadertoy.com/view/ltScRG\n\n\t\t\t\t// Special case for blur == 0.0\n\t\t\t\tif (lod == 0.0) {\n\t\t\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\t\treturn texture2DLodEXT( sp, U, 0.0).rgb;\n\t\t\t\t\t#else\n\t\t\t\t\treturn textureLod( sp, U, 0.0).rgb;\n\t\t\t\t\t#endif\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvec2 texelSize = vec2(1.0) / resolution;\n                vec2 halton = haltonSequence[frameIndex];\n                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n                float temporalAngle  = temporalOffset * PI2;\n\t\t\t\tvec3 res = vec3(0.0);\n                vec2 uv = vec2(0.0);\n                vec2 offset = vec2(0.0);\n                vec2 vogelSample = vec2(0.0);\n                for (int i = 0; i < NUM_SAMPLES; i++) {\n                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;\n                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20\n                    uv = U + offset;\n                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));\n                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {\n                        uv = unrefractedU;\n                        lod = lod > 4.0 ? lod : lod / 2.0;\n                    }\n                    res += textureLod(sp, uv, lod).rgb;\n                }\n                return res / float(NUM_SAMPLES);\n            }"),t=new BQ("vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\t        // Direction of refracted light.\n\t\t        vec3 refractionVector = refract( -v,  n, 1.0 / ior );\n\t\t        \n\t\t\t\t// Compute rotation-independant scaling of the model matrix.\n\t\t        vec3 modelScale;\n\t\t        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\t        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\t        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\n\t\t        // The thickness is specified in local space\n\t\t        return normalize( refractionVector ) * thickness * modelScale;\n\t        }"),i=new BQ("float applyIorToRoughness( float roughness, float ior ) {\n\t\t\t\t// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n\t\t\t\t// an IOR of 1.5 results in the default amount of microfacet refraction.\n\t\t\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t\t\t}"),n=new BQ('vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {\n\t\t\t\t// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see\n\t\t\t\t// also the code in convertTransmission.ts, which runs during export\n\t\t\t\t#ifdef IS_THREEJS_EXPORT\n\t\t\t\t\tfloat lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);\n\t\t\t\t\treturn textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;\n\t\t\t\t#else\n\t\t\t\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t\t\t\tfloat lod = applyIorToRoughness(roughness, ior);\n\t\t\t\t\treturn blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);\n\t\t\t\t#endif\n\t\t\t}',[JK.textureBicubic,i,e]),r=new BQ("vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\n\t\t\t\t// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\n\t\t\t\tvec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );\n\t\t\t\tvec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;\n\t\t\t\tunrefractedCoords += 1.0;\n\t\t\t\tunrefractedCoords /= 2.0;\n\n\t\t\t\t// Sample framebuffer to get pixel the refracted ray hits.\n\t\t\t\treturn getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );\n    \t\t}",[n,t]);return{transmission:new BQ("vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {\n                vec3 v = vec3(0.);\n                if (isOrthographic) {\n                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n                } else {\n                    v = normalize(vWPosition - cameraPosition);\n                }\n                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );\n                \n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * alpha;\n\n\t\t\t\treturn transmission;\n            }",[r])}}();var tZ=(e=>(e.NOISE="noise",e.MAP="map",e))(tZ||{}),iZ=class extends PQ{constructor(e,t,i,n,r,a,o,s,l,c,d){super("v3"),this.displacementTypeIndex=new vK(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,"map"===Object.values(tZ)[this.displacementTypeIndex.value]&&(this.mat=new _K(this.movementOrTexture.value.matrix)),this.cropOrOffset=i,this.scale=c,this.noiseFunctionIndex=d,this.voronoiStyle=n,this.smoothness=r,this.seed=a,this.highCut=o,this.lowCut=s,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let i,n=[];switch(n.push("displaced_position"),n.push("displaced_normal"),Object.values(tZ)[this.displacementTypeIndex.value]){case"map":i=e.include(iZ.Nodes.map),n.push(this.movementOrTexture.getTexture(e,"t")),n.push("uv"),n.push(this.cropOrOffset.build(e,"f")),this.mat&&n.push(this.mat.build(e,"mat3"));break;case"noise":{let t=["simplexPrecise","simplexFractal","simplexAshima","fbm","perlin","voronoi"][this.noiseFunctionIndex.value],r=new BQ("vec3 orthogonal(vec3 v) {\n\t\t\t\t\t\t\treturn normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));\n\t\t\t\t\t\t}"),a="voronoi"==t?"\n\t\t\t\t\tfloat v = ".concat(t,"((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);\n\t\t\t\t\tv = remap(v, lowCut, highCut, 0.0, 1.0);\n\t\t\t\t\tv = smax(v, 0.0, smoothness * 0.25);\n\t\t\t\t\tv = smin(v, 1.0, smoothness * 0.25);\n\n\t\t\t\t\treturn p + n * v * intensity;\n\t\t\t\t\t"):"\n\t\t\t\t\treturn p + n * ".concat(t,"((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;\n\t\t\t\t\t"),o=new BQ("vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {\n\t\t\t\t\t\t\t".concat(a,"\n\t\t\t\t\t\t}"),[jK.simplexPrecise,jK.simplexFractal,jK.simplexAshima,jK.fbm,jK.perlin,jK.voronoi]),s=new BQ("vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {\n\t\t\t\t\t\t\tvec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tvec3 tangent1 = orthogonal(normal);\n\t\t\t\t\t\t\tvec3 tangent2 = normalize(cross(normal, tangent1));\n\n                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.\n                            // This caused some small oval/circular visual artifacts in the lighting.\n                            // For now, simply using neighbors further away betters the problem,\n                            // but we should figure out the underlying cause when we have some time.\n                            // Maybe its related to how we calculate the tangent and bitangent?\n\t\t\t\t\t\t\tvec3 nearby1 = position + tangent1;\n\t\t\t\t\t\t\tvec3 nearby2 = position + tangent2;\n\t\t\t\t\t\t\tvec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tvec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tdisplaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));\n\t\t\t\t\t\t\treturn displaced_position;\n\t\t\t\t\t\t}",[o,r]);i=e.include(s),n.push(this.scale.build(e,"f")),n.push(this.cropOrOffset.build(e,"v3")),n.push(this.movementOrTexture.build(e,"f")),n.push(this.voronoiStyle.build(e,"i")),n.push(this.smoothness.build(e,"f")),n.push(this.seed.build(e,"f")),n.push(this.highCut.build(e,"f")),n.push(this.lowCut.build(e,"f")),n.push(this.quality.build(e,"i"));break}}return n.push(this.intensity.build(e,"f")),n.push("displaced_normal"),e.format(i+"("+n.join(",")+")",this.getType(e),t)}return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},nZ=iZ;nZ.Nodes=function(){let e=new BQ("vec3 orthogonal(vec3 v) {\n\t\t\t\treturn normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));\n\t\t\t}"),t=new BQ("float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {\n\t\t\t\tvec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;\n\t\t\t\tvec4 tmp = texture2D(tex, uvs);\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tif (crop > 0.5) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\treturn 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn col.r;\n\t\t\t}");return{map:new BQ("vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {\n\t\t\t\tvec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;\n\t\t\t\tvec3 tangent1 = normalize(orthogonal(normal));\n\t\t\t\tvec3 tangent2 = normalize(cross(normal, tangent1));\n\t\t\t\tvec3 nearby1 = position + tangent1 * 0.1;\n\t\t\t\tvec3 nearby2 = position + tangent2 * 0.1;\n\t\t\t\tvec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;\n\t\t\t\tvec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;\n\t\t\t\tdisplaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));\n\t\t\t\treturn displaced_position;\n\t\t\t}",[e,t])}}();var rZ={normalRenderTarget:new YQ,normalRenderTargetDepth:new YQ,transmissionRenderTarget:new YQ,aspectRatio:new OQ,transmissionSize:new OQ(2048,2048),transmissionRenderTargetDepth:new YQ,aoRenderTarget:new YQ,aoEnabled:new yK,pixelRatioNode:new QQ(1),resolution:new OQ,penumbraSize:new bK(5,.5),frameIndex:new vK(0),transmissionLod:new vK(2)};for(let i of Object.values(rZ))i.isRenderGlobal=!0;var aZ,oZ={skiaWasmUrl:"https://unpkg.com/@splinetool/ui-wasm@1.10.48/build/ui.wasm"},sZ=class extends AQ{constructor(){super("basic"),this.nodeType="Basic",this.color=new gK(kV),this.shadingAlpha=new QQ(1),this.shadingBlend=new vK(0),this.previousModelViewMatrix=new CK,this.previouseProjectionMatrix=new CK}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:rZ.frameIndex}),e.mergeUniform({resolution:rZ.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(BE.merge([iA.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = normal;\n\n\t\t\t\t#if defined( USE_LAYER_DISPLACE )\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif /* !USE_LAYER_DISPLACE */\n\t\t\t\t"];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","\tvNormal = transformedNormal;","#endif"),n.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join("\n")}else{void 0===this.color&&(this.color=new gK(kV)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let i=this.color.flow(e,"c",{slot:"color"}),n=this.alpha?this.alpha.flow(e,"f"):void 0,r=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,a=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=void 0!==n,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join("\n"));let o=["#include <normal_fragment_begin>",i.code];n&&o.push(n.code,"#ifdef ALPHATEST"," if ( "+n.result+" <= ALPHATEST ) discard;","#endif"),a?o.push(a.code,"vec3 outgoingLight = ".concat(i.result,";"),"vec3 finalColor = spe_blend(outgoingLight, ".concat(a.result,", 1.0, SPE_BLENDING_NORMAL);")):o.push("vec3 finalColor = ".concat(i.result,";"));let s="1.0";this.mask&&(this.mask.analyze(e),s="luminance(".concat(this.mask.flow(e,"v3").result,")")),n?o.push("gl_FragColor = vec4( finalColor, accumAlpha * ".concat(n.result," * ").concat(s," );")):o.push("gl_FragColor = vec4("+i.result+", 1.0 );"),r&&o.push("gl_FragColor.a *= ".concat(r.result,";")),o.push("#include <fog_fragment>","#include <dithering_fragment>"),t=o.join("\n")}return t}},lZ=class extends AQ{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new gK(kV),this.emissive=new gK(0),this.emissiveIntensity=new QQ(1),this.previousModelViewMatrix=new CK,this.previouseProjectionMatrix=new CK,this.shadingAlpha=new QQ(1),this.shadingBlend=new vK(0),this.occlusion=new yK(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:rZ.frameIndex}),e.mergeUniform({resolution:rZ.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(BE.merge([iA.fog,iA.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","\tvarying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("\t#include <project_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\n\t\t\t\t\tvec3 diffuse = vec3( 1.0 );\n\t\t\t\t\tGeometricContext geometry;\n\t\t\t\t\tgeometry.position = mvPosition.xyz;\n\t\t\t\t\tgeometry.normal = normalize( transformedNormal );\n\t\t\t\t\tgeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\n\t\t\t\t"),n.push("\n\t\t\t\t\tGeometricContext backGeometry;\n\t\t\t\t\tbackGeometry.position = geometry.position;\n\t\t\t\t\tbackGeometry.normal = -geometry.normal;\n\t\t\t\t\tbackGeometry.viewDir = geometry.viewDir;\n\t\t\t\t\tvLightFront = vec3( 0.0 );\n\t\t\t\t\tvIndirectFront = vec3( 0.0 );\n\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\tvLightBack = vec3( 0.0 );\n\t\t\t\t\t\tvIndirectBack = vec3( 0.0 );\n\t\t\t\t\t#endif\n\t\t\t\t\tIncidentLight directLight;\n\t\t\t\t\tfloat dotNL;\n\t\t\t\t\tvec3 directLightColor_Diffuse;\n\t\t\t\t\tvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\n\t\t\t\t\tvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\t\t\t\t\t\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_POINT_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_SPOT_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_DIR_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_HEMI_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join("\n")}else{e.mergeUniform({penumbraSize:rZ.penumbraSize}),e.mergeUniform({frameIndex:rZ.frameIndex}),e.mergeUniform({aoMap:rZ.aoRenderTarget}),e.mergeUniform({aoEnabled:rZ.aoEnabled}),void 0===this.color&&(this.color=new gK(kV)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),n=this.emissive.flow(e,"c",{slot:"emissive"}),r=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),a=this.occlusion.flow(e,"b",{slot:"occlusion"}),o=this.shadingAlpha.flow(e,"f"),s=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,d=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=void 0!==c,e.addParsCode(["uniform float penumbraSize[".concat(5,"];"),"uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","\tvarying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join("\n"));let u=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx, viewdy));\n\t\t\t\tbool isFrontFacing = (dot(normal, faceNormal) >= 0.0);\n\t\t\t\t","#include <clipping_planes_fragment>"];u.push(i.code,"vec3 diffuseColor = "+i.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&u.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u.push("#ifdef DOUBLE_SIDED","\treflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","\treflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","\treflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","\treflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),n&&u.push(n.code,"reflectedLight.directDiffuse += "+n.result+" * "+r.result+";"),u.push("vec3 ao = aoEnabled && "+a.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let h="1.0";this.mask&&(this.mask.analyze(e),h="luminance(".concat(this.mask.flow(e,"v3").result,")")),u.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(o.result," * ").concat(h," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(o.result," * ").concat(h,", ").concat(s.result," );\n\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t")),l&&u.push(l.code,"outgoingLight = spe_blend(outgoingLight, ".concat(l.result,", 1.0, SPE_BLENDING_NORMAL);")),c?u.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(c.result," );")):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),d&&u.push("gl_FragColor.a *= ".concat(d.result,";")),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join("\n")}return t}},cZ={dHdxy:new BQ("vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {\n\n            // Gradient of UVs w.r.t. X coordinate (in screen-space)\n            vec2 dSTdx = dFdx(bumpMapUv);\n\n            // Gradient of UVs w.r.t. Y coordinate (in screen-space)\n            vec2 dSTdy = dFdy(bumpMapUv);\n            \n            // Forward differencing\n            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);\n            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;\n            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;\n            \n            return vec2( dBx, dBy );\n        }"),perturbNormalArb:new BQ("vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n            vec3 vSigmaX = dFdx( surf_pos.xyz );\n            vec3 vSigmaY = dFdy( surf_pos.xyz );\n            vec3 vN = surf_norm; // normalized\n            \n            vN = normalize(vN);\n\n            vec3 R1 = cross( vSigmaY, vN );\n            vec3 R2 = cross( vN, vSigmaX );\n\n            R1 = normalize(R1);\n            R2 = normalize(R2);\n    \n            float fDet = dot( vSigmaX, R1 ) * faceDirection;\n    \n            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n            return normalize( abs( fDet ) * vN - vGrad );\n        }")},dZ=class extends AQ{constructor(){super("phong"),this.nodeType="Phong",this.color=new gK(kV),this.specular=new gK(1118481),this.shininess=new QQ(30),this.previousModelViewMatrix=new CK,this.previouseProjectionMatrix=new CK,this.shadingAlpha=new QQ(1),this.shadingBlend=new vK(0),this.occlusion=new yK(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:rZ.frameIndex}),e.mergeUniform({resolution:rZ.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(BE.merge([iA.fog,iA.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("\t#include <project_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join("\n")}else{e.mergeUniform({penumbraSize:rZ.penumbraSize}),e.mergeUniform({frameIndex:rZ.frameIndex}),e.mergeUniform({aoMap:rZ.aoRenderTarget}),e.mergeUniform({aoEnabled:rZ.aoEnabled}),void 0===this.color&&(this.color=new gK(kV)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let i=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let n=this.color.flow(e,"c",{slot:"color"}),r=this.specular.flow(e,"c"),a=this.shininess.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),s=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,d=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=void 0!==c,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[".concat(5,"];"),"uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join("\n"));let u=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tBlinnPhongMaterial material;"];if(this.bumpMap){e.include(cZ.dHdxy),e.include(cZ.perturbNormalArb);let t=this.bumpMap.texture.flow(e,"t"),i=this.bumpMap.flow(e,"v3"),n=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",r="";r=4===this.bumpMap.projection.value?"\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(").concat(t.result,", uv0, ").concat(n,");\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(").concat(t.result,", uv1, ").concat(n,");\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(").concat(t.result,", uv2, ").concat(n,");\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t"):"\n\t\t\t\t\tvec2 bumpMapCachedUv = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(").concat(t.result,", bumpMapCachedUv, ").concat(n,");\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t"),u.push("// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t".concat(i.result,";\n\t\t\t\t\t").concat(r,"\n\t\t\t\t\t"))}u.push(n.code,"\tvec3 diffuseColor = "+n.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","\tvec3 totalEmissiveRadiance = emissive;",r.code,"\tvec3 specular = "+r.result+";",a.code,"\tfloat shininess = max( 0.0001, "+a.result+" );","\tfloat specularStrength = 1.0;"),c&&u.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let h="1.0";this.mask&&(this.mask.analyze(e),h="luminance(".concat(this.mask.flow(e,"v3").result,")")),u.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(o.result," * ").concat(h," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(o.result," * ").concat(h,", ").concat(s.result," );\n\t\t\t\t\t\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t")),l&&u.push(l.code,"outgoingLight = spe_blend(outgoingLight, ".concat(l.result,", 1.0, SPE_BLENDING_NORMAL);")),c?u.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(c.result,");")):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),d&&u.push("gl_FragColor.a *= ".concat(d.result,";")),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join("\n")}return t}},uZ=class extends AQ{constructor(){super("standard"),this.nodeType="Standard",this.color=new gK(kV),this.roughness=new QQ(.3),this.metalness=new QQ(0),this.reflectivity=new QQ(.5),this.previousModelViewMatrix=new CK,this.previouseProjectionMatrix=new CK,this.shadingAlpha=new QQ(1),this.shadingBlend=new vK(0),this.occlusion=new yK(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:rZ.frameIndex}),e.mergeUniform({resolution:rZ.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(BE.merge([iA.fog,iA.lights])),iA.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#if defined( USE_LAYER_DISPLACE )\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif /* !USE_LAYER_DISPLACE */\n\t\t\t\t"];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join("\n")}else{e.mergeUniform({penumbraSize:rZ.penumbraSize}),e.mergeUniform({frameIndex:rZ.frameIndex}),e.mergeUniform({aoMap:rZ.aoRenderTarget}),e.mergeUniform({aoEnabled:rZ.aoEnabled});let i={gamma:!0};void 0===this.color&&(this.color=new gK(kV)),this.color.analyze(e,{slot:"color",context:i}),this.roughness.analyze(e),this.metalness.analyze(e);let n=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let r=this.color.flow(e,"c",{slot:"color",context:i}),a=this.roughness.flow(e,"f"),o=this.metalness.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),c=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,d=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,h=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=void 0!==d,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[".concat(5,"];"),"uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join("\n"));let p=["#include <clipping_planes_fragment>","\t#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tPhysicalMaterial material;","\tmaterial.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){e.include(cZ.dHdxy),e.include(cZ.perturbNormalArb);let t=this.bumpMap.texture.flow(e,"t"),i=this.bumpMap.flow(e,"v3"),n=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",r="";r=4===this.bumpMap.projection.value?"\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(").concat(t.result,", uv0, ").concat(n,");\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(").concat(t.result,", uv1, ").concat(n,");\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(").concat(t.result,", uv2, ").concat(n,");\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t"):"\n\t\t\t\t\tvec2 bumpMapCachedUv = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(").concat(t.result,", bumpMapCachedUv, ").concat(n,");\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t"),p.push("// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t".concat(i.result,";\n\t\t\t\t\t").concat(r,"\n\t\t\t\t\t"))}if(p.push(r.code,"\tvec3 diffuseColor = "+r.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",o.code,"\tfloat metalnessFactor = "+o.result+";"),this.roughnessMap){let t=this.roughnessMap.texture.flow(e,"t"),i=this.roughnessMap.flow(e,"v3"),n="";n=4===this.roughnessMap.projection.value?"\n\t\t\t\t\tfloat roughnessChange = 1.0;\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g".concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g").concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g").concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g").concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_triplanarWeights;\n\n\t\t\t\t\t\tfloat r0 = luminance(texture(").concat(t.result,", uv0).rgb) * roughnessScale;\n\t\t\t\t\t\tfloat r1 = luminance(texture(").concat(t.result,", uv1).rgb) * roughnessScale;\n\t\t\t\t\t\tfloat r2 = luminance(texture(").concat(t.result,", uv2).rgb) * roughnessScale;\n\n\t\t\t\t\t\troughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);\n\t\t\t\t\t}\n\t\t\t\t\tfloat roughnessFactor = roughnessChange * ").concat(a.result,";\n\t\t\t\t\t"):"\n\t\t\t\t\tvec2 roughnessMapCachedUv = g".concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_writeUvs;\n\n\t\t\t\t\tvec4 vals = texture(").concat(t.result,",  roughnessMapCachedUv);\n\t\t\t\t\tfloat roughnessFactor = luminance(vals.rgb) * ").concat(a.result,";\n\t\t\t\t\t"),p.push("// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t".concat(i.result,";\n\n\t\t\t\t\tconst float roughnessScale = 1.0;\n\n\t\t\t\t\t").concat(n,"\n\t\t\t\t"))}else p.push(a.code,"\tfloat roughnessFactor = "+a.result+";");d&&p.push(d.code,"#ifdef ALPHATEST","\tif ( "+d.result+" <= ALPHATEST ) discard;","#endif"),p.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),p.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),h?p.push(h.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+h.result+" ) ), diffuseColor, metalnessFactor );"):p.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),p.push("#include <lights_fragment_begin>"),p.push("#include <lights_fragment_end>"),p.push("vec3 ao = aoEnabled && "+n.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let f="1.0";this.mask&&(this.mask.analyze(e),f="luminance(".concat(this.mask.flow(e,"v3").result,")")),p.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(s.result," * ").concat(f," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(s.result," * ").concat(f,", ").concat(l.result," );\n\t\t\t\t\t\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t")),c&&p.push(c.code,"outgoingLight = spe_blend(outgoingLight, ".concat(c.result,", 1.0, SPE_BLENDING_NORMAL);")),d?p.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(d.result," );")):p.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&p.push("gl_FragColor.a *= ".concat(u.result,";")),p.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=p.join("\n")}return t}},hZ=class extends AQ{constructor(){super("toon"),this.nodeType="Toon",this.color=new gK(kV),this.specular=new gK(1118481),this.shininess=new QQ(30),this.previousModelViewMatrix=new CK,this.previouseProjectionMatrix=new CK,this.shadingAlpha=new QQ(1),this.shadingBlend=new vK(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:rZ.frameIndex}),e.mergeUniform({resolution:rZ.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(BE.merge([iA.fog,iA.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("\t#include <project_vertex>","\t#include <fog_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join("\n")}else{e.mergeUniform({penumbraSize:rZ.penumbraSize}),e.mergeUniform({frameIndex:rZ.frameIndex}),e.mergeUniform({aoMap:rZ.aoRenderTarget}),e.mergeUniform({aoEnabled:rZ.aoEnabled}),void 0===this.color&&(this.color=new gK(kV)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),n=this.specular.flow(e,"c"),r=this.shininess.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),s=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=void 0!==l,e.addParsCode(["uniform float penumbraSize[".concat(5,"];"),"uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>","\n\t\t\t\t\tvarying vec3 vViewPosition;\n\t\t\t\t\tstruct ToonMaterial {\n\t\t\t\t\t\tvec3\tdiffuseColor;\n\t\t\t\t\t\tvec3\tspecularColor;\n\t\t\t\t\t\tfloat\tspecularShininess;\n\t\t\t\t\t\tfloat\tspecularStrength;\n\t\t\t\t\t};\n\t\t\t\t\tvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\t\t\t\t\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t\t\t\n\t\t\t\t\t\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\t\t\t\t\t\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n\t\t\t\t\t}\n\t\t\t\t\tvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\t\t\t\t\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\t\t\t\t\t}\n\t\t\t\t\t#define RE_Direct\t\t\t\tRE_Direct_Toon\n\t\t\t\t\t#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n\t\t\t\t\t#define Material_LightProbeLOD( material )\t(0)\n\t\t\t\t\t","#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join("\n"));let d=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tToonMaterial material;"];if(this.bumpMap){e.include(cZ.dHdxy),e.include(cZ.perturbNormalArb);let t=this.bumpMap.texture.flow(e,"t"),i=this.bumpMap.flow(e,"v3"),n=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",r="";r=4===this.bumpMap.projection.value?"\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(").concat(t.result,", uv0, ").concat(n,");\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(").concat(t.result,", uv1, ").concat(n,");\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(").concat(t.result,", uv2, ").concat(n,");\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t"):"\n\t\t\t\t\tvec2 bumpMapCachedUv = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(").concat(t.result,", bumpMapCachedUv, ").concat(n,");\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t"),d.push("// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t".concat(i.result,";\n\t\t\t\t\t").concat(r,"\n\t\t\t\t\t"))}d.push(i.code,"\tvec3 diffuseColor = "+i.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",n.code,"\tvec3 specular = "+n.result+";",r.code,"\tfloat shininess = max( 0.0001, "+r.result+" );","\tfloat specularStrength = 1.0;"),l&&d.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),d.push("material.diffuseColor = diffuseColor;"),d.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),d.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let u="1.0";this.mask&&(this.mask.analyze(e),u="luminance(".concat(this.mask.flow(e,"v3").result,")")),d.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(a.result," * ").concat(u," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(a.result," * ").concat(u,", ").concat(o.result," );\n\t\t\t\t}\n\t\t\t\t")),s&&d.push(s.code,"outgoingLight = spe_blend(outgoingLight, ".concat(s.result,", 1.0, SPE_BLENDING_NORMAL);")),l?d.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(l.result," );")):d.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&d.push("gl_FragColor.a *= ".concat(c.result,";")),d.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=d.join("\n")}return t}},pZ=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4;this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(e){var t;return null===(t=this.cache.get(e))||void 0===t?void 0:t.data}load(e){let t=Date.now(),i=this.cache.get(e);return void 0===i?(i={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,i)):(i.time=t,i.prev.next=i.next,i.next.prev=i.prev),i.prev=this.tail.prev,i.next=this.tail,this.tail.prev.next=i,this.tail.prev=i,this.scheduleCleanup(),i.data}},fZ=class extends pZ{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}};var mZ=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,0===this.refCount&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount,0}},gZ=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data),0}load(e){let t=this.cache.get(e);return void 0===t&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},vZ=class extends mZ{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isBuffer=!1,this._cache={1e3:{},1001:{},1002:{}},this.isVideo="video"===e.type,this.isBuffer=!0===e.isWebGLRenderTarget,this.loadPromise=this.updateSrc(this.isBuffer?e:e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;for(let e of Object.values(this._cache))for(let t of Object.values(e))for(let e of Object.values(t))e&&(e.image=this.img,e.needsUpdate=!0);this.shared.requestRender()};if(this.isBuffer)this.img=e,this.loaded=!0;else if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,"string"!=typeof e){var i=new FileReader;let t;i.readAsDataURL(new Blob([e],{type:"video/mp4"})),await new Promise(e=>{i.onloadend=i=>{var n;t=null===(n=i.target)||void 0===n?void 0:n.result,e(null)}}),this.img.src=t}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=function(e){return"string"==typeof e?e:(aZ||(aZ=new fZ),aZ.load(e))}(e),this.img.onload=t,await new Promise(e=>{this.img.onload=()=>{t(),e(null)}})}getTexture(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1008,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1006,r=null===(t=this._cache[e])||void 0===t||null===(t=t[i])||void 0===t?void 0:t[n];if(r)return r;{let t;return t=this.isBuffer?this.img.texture:this.isVideo?new nP(this.img,void 0,e,e):new L_(this.img,void 0,e,e,n,i),this.loaded&&(t.needsUpdate=!0),void 0===this._cache[e]&&(this._cache[e]={}),void 0===this._cache[e][i]&&(this._cache[e][i]={}),this._cache[e][i][n]=t,t}}setNeedsUpdate(e){for(let t of Object.values(this._cache))for(let i of Object.values(t))for(let t of Object.values(i))t&&(t.needsUpdate=e)}disposeTextures(){for(let[e,t]of Object.entries(this._cache))for(let[i,n]of Object.entries(t))for(let[t,r]of Object.entries(n))null!==r&&void 0!==r&&r.dispose(),void 0!==this._cache[e]&&void 0!==this._cache[e][i]&&(this._cache[e][i][t]=void 0)}dispose(){super.dispose(),this.disposeTextures()}},yZ=class extends vZ{};function bZ(e,t){var i=function(e){if(!wZ[e]){var t=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),i="06/25/2014, 00:00:00"===t||"\u200e06\u200e/\u200e25\u200e/\u200e2014\u200e \u200e00\u200e:\u200e00\u200e:\u200e00"===t;wZ[e]=i?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return wZ[e]}(t);return i.formatToParts?function(e,t){try{for(var i=e.formatToParts(t),n=[],r=0;r<i.length;r++){var a=xZ[i[r].type];a>=0&&(n[a]=parseInt(i[r].value,10))}return n}catch(hV){if(hV instanceof RangeError)return[NaN];throw hV}}(i,e):function(e,t){var i=e.format(t).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(i);return[n[3],n[1],n[2],n[4],n[5],n[6]]}(i,e)}var xZ={year:0,month:1,day:2,hour:3,minute:4,second:5};var wZ={};function SZ(e,t,i,n,r,a,o){var s=new Date(0);return s.setUTCFullYear(e,t,i),s.setUTCHours(n,r,a,o),s}var _Z=36e5,CZ={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function EZ(e,t,i){var n,r,a;if(!e||(n=CZ.timezoneZ.exec(e)))return 0;if(n=CZ.timezoneHH.exec(e))return MZ(a=parseInt(n[1],10))?-a*_Z:NaN;if(n=CZ.timezoneHHMM.exec(e)){a=parseInt(n[1],10);var o=parseInt(n[2],10);return MZ(a,o)?(r=Math.abs(a)*_Z+6e4*o,a>0?-r:r):NaN}if(function(e){if(TZ[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),TZ[e]=!0,!0}catch(t){return!1}}(e)){t=new Date(t||Date.now());var s=i?t:function(e){return SZ(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}(t),l=AZ(s,e),c=i?l:function(e,t,i){var n=e.getTime(),r=n-t,a=AZ(new Date(r),i);if(t===a)return t;r-=a-t;var o=AZ(new Date(r),i);return a===o?a:Math.max(a,o)}(t,l,e);return-c}return NaN}function AZ(e,t){var i=bZ(e,t),n=SZ(i[0],i[1]-1,i[2],i[3]%24,i[4],i[5],0).getTime(),r=e.getTime(),a=r%1e3;return n-(r-=a>=0?a:1e3+a)}function MZ(e,t){return-23<=e&&e<=23&&(null==t||0<=t&&t<=59)}var TZ={};var PZ=Ow(zw(),1),DZ=Ow(Lw(),1),OZ=36e5,IZ=6e4,kZ={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/};function RZ(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(null===e)return new Date(NaN);var i=t||{},n=null==i.additionalDigits?2:(0,PZ.default)(i.additionalDigits);if(2!==n&&1!==n&&0!==n)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e))return new Date(e.getTime());if("number"==typeof e||"[object Number]"===Object.prototype.toString.call(e))return new Date(e);if("string"!=typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var r=function(e){var t,i={},n=kZ.dateTimePattern.exec(e);if(n?(i.date=n[1],t=n[3]):(n=kZ.datePattern.exec(e),n?(i.date=n[1],t=n[2]):(i.date=null,t=e)),t){var r=kZ.timeZone.exec(t);r?(i.time=t.replace(r[1],""),i.timeZone=r[1].trim()):i.time=t}return i}(e),a=function(e,t){var i,n=kZ.YYY[t],r=kZ.YYYYY[t];if(i=kZ.YYYY.exec(e)||r.exec(e),i){var a=i[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(i=kZ.YY.exec(e)||n.exec(e),i){var o=i[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(r.date,n),o=a.year,s=function(e,t){if(null===t)return null;var i,n,r,a;if(0===e.length)return n=new Date(0),n.setUTCFullYear(t),n;if(i=kZ.MM.exec(e),i)return n=new Date(0),r=parseInt(i[1],10)-1,FZ(t,r)?(n.setUTCFullYear(t,r),n):new Date(NaN);if(i=kZ.DDD.exec(e),i){n=new Date(0);var o=parseInt(i[1],10);return function(e,t){if(t<1)return!1;var i=NZ(e);return!(i&&t>366||!i&&t>365)}(t,o)?(n.setUTCFullYear(t,0,o),n):new Date(NaN)}if(i=kZ.MMDD.exec(e),i){n=new Date(0),r=parseInt(i[1],10)-1;var s=parseInt(i[2],10);return FZ(t,r,s)?(n.setUTCFullYear(t,r,s),n):new Date(NaN)}if(i=kZ.Www.exec(e),i)return a=parseInt(i[1],10)-1,UZ(t,a)?zZ(t,a):new Date(NaN);if(i=kZ.WwwD.exec(e),i){a=parseInt(i[1],10)-1;var l=parseInt(i[2],10)-1;return UZ(t,a,l)?zZ(t,a,l):new Date(NaN)}return null}(a.restDateString,o);if(isNaN(s))return new Date(NaN);if(s){var l,c=s.getTime(),d=0;if(r.time&&(d=function(e){var t,i,n;if(t=kZ.HH.exec(e),t)return i=parseFloat(t[1].replace(",",".")),VZ(i)?i%24*OZ:NaN;if(t=kZ.HHMM.exec(e),t)return i=parseInt(t[1],10),n=parseFloat(t[2].replace(",",".")),VZ(i,n)?i%24*OZ+n*IZ:NaN;if(t=kZ.HHMMSS.exec(e),t){i=parseInt(t[1],10),n=parseInt(t[2],10);var r=parseFloat(t[3].replace(",","."));return VZ(i,n,r)?i%24*OZ+n*IZ+1e3*r:NaN}return null}(r.time),isNaN(d)))return new Date(NaN);if(r.timeZone||i.timeZone){if(l=EZ(r.timeZone||i.timeZone,new Date(c+d)),isNaN(l))return new Date(NaN)}else l=(0,DZ.default)(new Date(c+d)),l=(0,DZ.default)(new Date(c+d+l));return new Date(c+d+l)}return new Date(NaN)}function zZ(e,t,i){t=t||0,i=i||0;var n=new Date(0);n.setUTCFullYear(e,0,4);var r=7*t+i+1-(n.getUTCDay()||7);return n.setUTCDate(n.getUTCDate()+r),n}var LZ=[31,28,31,30,31,30,31,31,30,31,30,31],BZ=[31,29,31,30,31,30,31,31,30,31,30,31];function NZ(e){return e%400===0||e%4===0&&e%100!==0}function FZ(e,t,i){if(t<0||t>11)return!1;if(null!=i){if(i<1)return!1;var n=NZ(e);if(n&&i>BZ[t]||!n&&i>LZ[t])return!1}return!0}function UZ(e,t,i){return!(t<0||t>52||null!=i&&(i<0||i>6))}function VZ(e,t,i){return!(null!=e&&(e<0||e>=25)||null!=t&&(t<0||t>=60)||null!=i&&(i<0||i>=60))}function jZ(e,t){return t.color(e)}function WZ(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1?arguments[1]:void 0,i=t.format,n=e.getSeconds(),r=e;t&&null!==t.timeZone&&(r=function(e,t,i){var n=RZ(e,i),r=EZ(t,n,!0),a=new Date(n.getTime()-r),o=new Date(0);return o.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),o.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),o}(new Date,t.timeZone));let a,o=r.getHours(),s=r.getMinutes();"12ampm"===t.format12h24h&&(a=o>=12?"PM":"AM");let l,c,d=o;switch("24"!==t.format12h24h&&(d=o%12,0===d&&(d=12)),i){case"HH:mm:ss":l=[d,s,n];break;case"HH:mm":l=[d,s];break;case"HH":l=[d],a=void 0;break;case"mm":l=[s],a=void 0;break;case"ss":l=[n],a=void 0;break;case"year":c=r.getFullYear();break;case"month":c=r.getMonth()+1;break;case"dayOfYear":c=Math.floor((r.getTime()-new Date(r.getFullYear(),0,0).getTime())/864e5);break;case"dayOfMonth":c=r.getDate();break;case"secondOfDay":c=60*o*60+60*s+n;break;default:console.error("Unknown time format",i),c=0}return void 0!==l?{textValue:l,suffix:a}:c}function HZ(e,t){switch(e.type){case"fresnel":return function(e,t){let{bias:i,scale:n,intensity:r,factor:a,color:o}=e;return c(c({},GZ(e,t)),{},{color:jZ(o,t),bias:i,scale:n,intensity:r,factor:a})}(e,t);case"gradient":return function(e,t){let{gradientType:i,smooth:n,colors:r,steps:a,angle:o,offset:s,morph:l}=e;return c(c({},GZ(e,t)),{},{gradientType:i,smooth:n,colors:r.map(e=>new B_(e[0],e[1],e[2],e[3])),num:r.length,steps:a,offset:new p_(...s),morph:new p_(...l),angle:o})}(e,t);case"depth":return function(e,t){let{gradientType:i,near:n,far:r,isVector:a,isWorldSpace:o,origin:s,direction:l,colors:d,steps:u,smooth:h}=e;return c(c({},GZ(e,t)),{},{gradientType:i,near:n,far:r,isVector:a,isWorldSpace:o,origin:new j_(...s),direction:l?new j_(...l):new j_(1,0,0),colors:d.map(e=>void 0!==e?new B_(e[0],e[1],e[2],e[3]):new B_(0,0,0,0)),steps:u.slice(0,d.length),smooth:h})}(e,t);case"normal":return function(e,t){let{cnormal:i}=e;return c(c({},GZ(e,t)),{},{cnormal:new j_(i[0],i[1],i[2])})}(e,t);case"noise":return function(e,t){return c(c({},GZ(e,t)),{},{scale:e.scale,move:e.move,fA:new p_(...e.fA),fB:new p_(...e.fB),size:new j_(...e.size),distortion:new p_(...e.distortion),colorA:jZ(e.colorA,t),colorB:jZ(e.colorB,t),colorC:jZ(e.colorC,t),colorD:jZ(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality})}(e,t);case"rainbow":return function(e,t){return c(c({},GZ(e,t)),{},{filmThickness:e.filmThickness,movement:e.movement,wavelengths:new j_(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new j_(...e.offset)})}(e,t);case"toon":return function(e,t){return c(c({},GZ(e,t)),{},{positioning:e.positioning,colors:e.colors.map(e=>new B_(e[0],e[1],e[2],e[3])),num:e.colors.length,steps:e.steps,source:new j_(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:jZ(e.shadowColor,t),offset:new j_(...e.offset)})}(e,t);case"outline":return function(e,t){return c(c({},GZ(e,t)),{},{outlineColor:jZ(e.outlineColor,t),contourColor:jZ(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new j_(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation})}(e,t);case"transmission":return function(e,t){return c(c({},GZ(e,t)),{},{thickness:e.thickness,ior:e.ior,roughness:e.roughness})}(e,t);case"color":return function(e,t){return c(c({},GZ(e,t)),{},{color:jZ(e.color,t)})}(e,t);case"pattern":return function(e,t){return c(c({},GZ(e,t)),{},{style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new p_(...e.offset),colorA:jZ(e.colorA,t),colorB:jZ(e.colorB,t),frequency:new p_(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new p_(...e.vertical),horizontal:new p_(...e.horizontal),sides:e.sides})}(e,t)}}function GZ(e,t){var i;let{alpha:n,mode:r,isMask:a}=e,o="string"==typeof n?(null!==(i=Number(t.getVariable(n)))&&void 0!==i?i:100)/100:n;return c(c({},function(e){return{type:e.type}}(e)),{},{alpha:o,mode:r,isMask:a})}var qZ=class extends kQ{},XZ={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},YZ={depth:["colors"]};function QZ(e,t,i){if("isMask"===t)return!0;let n=XZ[e.type],r=YZ[e.type];if(void 0!==r){let n=e.color;if(r.includes(t)){var a;let e=null===(a=n[t])||void 0===a||null===(a=a.value)||void 0===a?void 0:a.length;if(void 0!==e&&e!==i.length)return!0}}return void 0!==n&&n.includes(t)}function KZ(e,t,i){var n;let r=i.uniforms["f".concat(i.id,"_texture")];if(!r)return!1;let a=!1,o=e;if("image"in o){let e=o.image,i=t.image(e),n=r;n.image instanceof yZ||n.image.deref(),n.image=i}if("video"in o){let e=o.video,i=t.video(e),n=r;n.image instanceof yZ||n.image.deref(),n.image=i}if("wrapping"in o){r.wrap=o.wrapping}if("minFilter"in o){r.minFilter=o.minFilter}if("magFilter"in o){r.magFilter=o.magFilter}if("rotation"in o&&i.uniforms["f".concat(i.id,"_rotation")])return i.uniforms["f".concat(i.id,"_rotation")].value=(null!==(n=o.rotation)&&void 0!==n?n:0)*h_.DEG2RAD,a;if("repeat"in o||"offset"in o||"rotation"in o){var s;let e="mat",t=i.uniforms["f".concat(i.id,"_").concat(e)];"repeat"in o&&(t.repeat=o.repeat),"offset"in o&&(t.offset=o.offset),"rotation"in o&&(t.rotation=null!==(s=o.rotation)&&void 0!==s?s:0),t.updateMatrix()}return a}var ZZ=(e,t,i)=>{var n,r;return null!==(n=Math.max(0,Math.min(1,Number(null!==(r=t.getVariable("number"==typeof e?100*e:e,i))&&void 0!==r?r:100)/100)))&&void 0!==n?n:1},JZ=class{constructor(e,t,i,n,r){this.id=e,this.uuid=t,this.data=i,this.uniforms={};for(let a in n)this.uniforms["f".concat(this.id,"_").concat(a)]=n[a];for(let a in i)nJ(a,this,i,r)}get type(){return this.data.type}static create(e,t,i,n){if("light"===i.type)return tJ.createLightLayer(e,t,i,n);if("texture"===i.type||"video"===i.type){var r,a,o,s,l,d,u,h,p,f;let c="texture"===i.type?null!==(r=n.uiBuffer(i.texture.image))&&void 0!==r?r:n.image(i.texture.image):n.video(i.texture.video),m=new SK(c,i.texture.wrapping,null!==(a=i.texture.minFilter)&&void 0!==a?a:1008,null!==(o=i.texture.magFilter)&&void 0!==o?o:1006),g=new wK(c),v=new AK(i.texture.repeat,i.texture.offset,null!==(s=i.texture.rotation)&&void 0!==s?s:0),y=new QQ(i.crop?1:0),b=new vK(null!==(l=i.projection)&&void 0!==l?l:0),x=new vK(null!==(d=["x","y","z"].indexOf(i.axis))&&void 0!==d?d:0),w=new vK(null!==(u=i.side)&&void 0!==u?u:0),S=new OQ(i.size?new p_(i.size[0],i.size[1]):new p_(100,100)),_=new QQ(null!==(h=i.blending)&&void 0!==h?h:0),C=new QQ(ZZ(i.alpha,n)),E=new vK(null!==(p=i.mode)&&void 0!==p?p:0),A=new yK(null!==(f=i.isMask)&&void 0!==f&&f),M=new RK(m,g,y,b,x,w,S,_,v,C,E,A),T=new XQ(M.calpha,"f");return new $Z(e,t,i,{texture:m,textureSize:g,crop:y,projection:b,axis:x,side:w,size:S,blending:_,mat:v,alpha:C,mode:E,isMask:A},M,E,T,A,n)}if("matcap"===i.type){var m,g,v,y,b;let r=n.image(i.texture.image),a=new SK(r,i.texture.wrapping,null!==(m=i.texture.minFilter)&&void 0!==m?m:1008,null!==(g=i.texture.magFilter)&&void 0!==g?g:1006),o=new QQ(ZZ(i.alpha,n)),s=new vK(null!==(v=i.mode)&&void 0!==v?v:0),l=new yK(null!==(y=i.isMask)&&void 0!==y&&y),c=new QQ((null!==(b=i.texture.rotation)&&void 0!==b?b:0)*h_.DEG2RAD),d=new VK(a,o,s,l,c),u=new XQ(d.calpha,"f");return new $Z(e,t,i,{texture:a,alpha:o,mode:s,isMask:l,rotation:c},d,s,u,l,n)}if("displace"===i.type){if("noise"===i.displacementType){var x,w,S,_,C,E,A,M,T,P;let r=new IQ(new j_(...i.offset)),a=new QQ(null!==(x=i.scale)&&void 0!==x?x:10),o=new QQ(null!==(w=i.intensity)&&void 0!==w?w:8),s=new QQ(null!==(S=i.movement)&&void 0!==S?S:1),l=new vK(null!==(_=i.noiseType)&&void 0!==_?_:0),c=new vK(null!==(C=i.voronoiStyle)&&void 0!==C?C:0),d=new QQ(null!==(E=i.smoothness)&&void 0!==E?E:.5),u=new QQ(null!==(A=i.seed)&&void 0!==A?A:0),h=new QQ(null!==(M=i.highCut)&&void 0!==M?M:1),p=new QQ(null!==(T=i.lowCut)&&void 0!==T?T:0),f=new vK(null!==(P=i.quality)&&void 0!==P?P:1),m=new nZ(o,s,r,c,d,u,h,p,f,a,l);return new eJ(e,t,i,{offset:r,scale:a,intensity:o,movement:s,noiseType:l,voronoiStyle:c,smoothness:d,seed:u,highCut:h,lowCut:p,quality:f},m,n)}throw new Error}return function(e,t,i,n){let r=HZ(i,n);return function(e,t,i,n,r){switch(e.type){case"color":{var a;let o=new gK(null!==(a=n.color)&&void 0!==a?a:kV),s=iJ(n),l=new DK(o,s.alpha),d=new XQ(l.calpha,"f");return new $Z(t,i,e,c({color:o},s),l,s.mode,d,s.isMask,r)}case"fresnel":{var o,s,l,d,u;let a=new gK(null!==(o=n.color)&&void 0!==o?o:16777215),h=new QQ(null!==(s=n.bias)&&void 0!==s?s:.1),p=new QQ(null!==(l=n.scale)&&void 0!==l?l:1),f=new QQ(null!==(d=n.intensity)&&void 0!==d?d:2),m=new QQ(null!==(u=n.factor)&&void 0!==u?u:1),g=iJ(n),v=new BK(a,h,p,f,m,g.alpha,g.mode,g.isMask),y=new XQ(v.calpha,"f");return new $Z(t,i,e,c({color:a,bias:h,scale:p,intensity:f,factor:m},g),v,g.mode,y,g.isMask,r)}case"rainbow":{var h,p,f,m,g,v;let a=new QQ(null!==(h=n.filmThickness)&&void 0!==h?h:30),o=new QQ(null!==(p=n.movement)&&void 0!==p?p:0),s=new IQ(null!==(f=n.wavelengths)&&void 0!==f?f:new j_(0,0,0)),l=new QQ(null!==(m=n.noiseStrength)&&void 0!==m?m:0),d=new QQ(null!==(g=n.noiseScale)&&void 0!==g?g:1),u=new IQ(null!==(v=n.offset)&&void 0!==v?v:new j_(0,0,0)),y=iJ(n),b=new QK(a,o,s,l,d,u,y.alpha,y.isMask),x=new XQ(b.calpha,"f");return new $Z(t,i,e,c({filmThickness:a,movement:o,wavelengths:s,noiseStrength:l,noiseScale:d,offset:u},y),b,y.mode,x,y.isMask,r)}case"transmission":{var y,b,x;let a=new QQ(null!==(y=n.thickness)&&void 0!==y?y:10),o=new QQ(null!==(b=n.ior)&&void 0!==b?b:1.5),s=new QQ(null!==(x=n.roughness)&&void 0!==x?x:.5),l=rZ.transmissionSize,d=rZ.transmissionRenderTarget,u=rZ.transmissionRenderTargetDepth,h=window.innerWidth,p=window.innerHeight,f=h>=p?new OQ(p/h,1):new OQ(1,h/p),m=iJ(n),g=new eZ(a,o,s,l,d,u,f,m.alpha),v=new XQ(g.calpha,"f");return new $Z(t,i,e,c({thickness:a,ior:o,roughness:s,aspectRatio:f},m),g,m.mode,v,m.isMask,r)}case"toon":{var w,S,_,C,E,A;let a,o,s=new vK(null!==(w=n.positioning)&&void 0!==w?w:0);n.colors?a=new MK(n.colors.length,n.colors):(a=new MK(10,new B_(0,0,0,1)),a.value[1]=new B_(1,1,1,1)),n.steps?o=new bK(n.steps.length,n.steps):(o=new bK(10,1),o.value[0]=0);let l=new IQ(null!==(S=n.source)&&void 0!==S?S:new j_(0,0,0)),d=new yK(null===(_=n.isWorldSpace)||void 0===_||_),u=new QQ(null!==(C=n.noiseStrength)&&void 0!==C?C:0),h=new QQ(null!==(E=n.noiseScale)&&void 0!==E?E:1),p=new RQ(n.shadowColor),f=new IQ(null!==(A=n.offset)&&void 0!==A?A:new j_(0,0,0)),m=iJ(n),g=new ZK(s,a,o,l,d,u,h,p,f,m.alpha),v=new XQ(g.calpha,"f");return new $Z(t,i,e,c({positioning:s,colors:a,steps:o,source:l,isWorldSpace:d,noiseStrength:u,noiseScale:h,shadowColor:p,offset:f},m),g,m.mode,v,m.isMask,r)}case"outline":{var M,T,P,D,O,I,k,R,z,L,B;let a=new gK(null!==(M=n.outlineColor)&&void 0!==M?M:16777215),o=new gK(null!==(T=n.contourColor)&&void 0!==T?T:16777215),s=new QQ(null!==(P=n.outlineWidth)&&void 0!==P?P:.1),l=new QQ(null!==(D=n.contourWidth)&&void 0!==D?D:.1),d=new QQ(null!==(O=n.outlineThreshold)&&void 0!==O?O:.1),u=new QQ(null!==(I=n.contourThreshold)&&void 0!==I?I:.1),h=new QQ(null!==(k=n.outlineSmoothing)&&void 0!==k?k:.1),p=new QQ(null!==(R=n.contourFrequency)&&void 0!==R?R:.1),f=new IQ(null!==(z=n.contourDirection)&&void 0!==z?z:new j_(0,1,0)),m=new yK(null!==(L=n.positionalLines)&&void 0!==L&&L),g=new yK(null===(B=n.compensation)||void 0===B||B),v=rZ.normalRenderTarget,y=rZ.normalRenderTargetDepth,b=rZ.pixelRatioNode,x=rZ.resolution,w=iJ(n),S=new GK(a,o,s,l,d,u,h,p,f,m,g,x,v,y,b,w.alpha),_=new XQ(S.calpha,"f");return new $Z(t,i,e,c({outlineColor:a,contourColor:o,outlineWidth:s,contourWidth:l,outlineThreshold:d,contourThreshold:u,outlineSmoothing:h,contourFrequency:p,contourDirection:f,positionalLines:m,compensation:g},w),S,w.mode,_,w.isMask,r)}case"depth":{var N,F,U,V,j,W,H,G;let a,o,s=new vK(null!==(N=n.gradientType)&&void 0!==N?N:0),l=new yK(null!==(F=n.smooth)&&void 0!==F&&F),d=new QQ(null!==(U=n.near)&&void 0!==U?U:50),u=new QQ(null!==(V=n.far)&&void 0!==V?V:200),h=new QQ(null!==(j=n.isVector)&&void 0!==j?j:1),p=new QQ(null!==(W=n.isWorldSpace)&&void 0!==W?W:0),f=new IQ(null!==(H=n.origin)&&void 0!==H?H:new j_),m=new IQ(null!==(G=n.direction)&&void 0!==G?G:new j_);n.colors?a=new MK(n.colors.length,n.colors):(a=new MK(2,new B_(0,0,0,1)),a.value[1]=new B_(1,1,1,1)),n.steps?o=new bK(n.steps.length,n.steps):(o=new bK(2,1),o.value[0]=0);let g=iJ(n),v=new LK(s,l,d,u,h,p,f,m,a,o,g.alpha,g.isMask),y=new XQ(v.calpha,"f");return new $Z(t,i,e,c({gradientType:s,smooth:l,near:d,far:u,isVector:h,isWorldSpace:p,origin:f,direction:m,colors:a,steps:o},g),v,g.mode,y,g.isMask,r)}case"noise":{var q,X,Y,Q,K,Z,J,$,ee,te,ie,ne,re;let a=new QQ(null!==(q=n.scale)&&void 0!==q?q:1),o=new IQ(null!==(X=n.size)&&void 0!==X?X:new j_(100,100,100)),s=new QQ(null!==(Y=n.move)&&void 0!==Y?Y:1),l=new OQ(null!==(Q=n.fA)&&void 0!==Q?Q:new p_(1.7,9.2)),d=new OQ(null!==(K=n.fB)&&void 0!==K?K:new p_(8.3,2.8)),u=new OQ(null!==(Z=n.distortion)&&void 0!==Z?Z:new p_(1,1)),h=new RQ(n.colorA),p=new RQ(n.colorB),f=new RQ(n.colorC),m=new RQ(n.colorD),g=new vK(null!==(J=n.noiseType)&&void 0!==J?J:0),v=new vK(null!==($=n.voronoiStyle)&&void 0!==$?$:0),y=new QQ(null!==(ee=n.highCut)&&void 0!==ee?ee:1),b=new QQ(null!==(te=n.lowCut)&&void 0!==te?te:0),x=new QQ(null!==(ie=n.smoothness)&&void 0!==ie?ie:.5),w=new QQ(null!==(ne=n.seed)&&void 0!==ne?ne:.5),S=new vK(null!==(re=n.quality)&&void 0!==re?re:1),_=iJ(n),C=new WK(a,o,s,l,d,u,h,p,f,m,_.alpha,g,_.isMask,v,y,b,x,w,S),E=new XQ(C.calpha,"f");return new $Z(t,i,e,c(c({scale:a,size:o,move:s,fA:l,fB:d,distortion:u,colorA:h,colorB:p,colorC:f,colorD:m,noiseType:g},_),{},{voronoiStyle:v,highCut:y,lowCut:b,smoothness:x,seed:w,quality:S}),C,_.mode,E,_.isMask,r)}case"normal":{var ae;let a=new IQ(null!==(ae=n.cnormal)&&void 0!==ae?ae:new j_(1,1,1)),o=iJ(n),s=new IK(a,o.alpha),l=new XQ(s.calpha,"f");return new $Z(t,i,e,c({cnormal:a},o),s,o.mode,l,o.isMask,r)}case"gradient":{var oe,se,le,ce,de;let a,o,s=new vK(null!==(oe=n.gradientType)&&void 0!==oe?oe:0),l=new yK(null!==(se=n.smooth)&&void 0!==se&&se);n.colors?a=new MK(n.colors.length,n.colors):(a=new MK(10,new B_(0,0,0,1)),a.value[1]=new B_(1,1,1,1)),n.steps?o=new bK(n.steps.length,n.steps):(o=new bK(10,1),o.value[0]=0);let d=new OQ(null!==(le=n.offset)&&void 0!==le?le:new p_(0,0)),u=new OQ(null!==(ce=n.morph)&&void 0!==ce?ce:new p_(0,0)),h=new QQ(null!==(de=n.angle)&&void 0!==de?de:0),p=iJ(n),f=new FK(s,l,a,o,d,u,h,p.alpha,p.isMask),m=new XQ(f.calpha,"f");return new $Z(t,i,e,c({gradientType:s,smooth:l,colors:a,steps:o,offset:d,morph:u,angle:h},p),f,p.mode,m,p.isMask,r)}case"pattern":{var ue,he,pe,fe,me,ge,ve,ye,be,xe,we,Se,_e,Ce;let a=new vK(null!==(ue=n.style)&&void 0!==ue?ue:0),o=new vK(null!==(he=n.projection)&&void 0!==he?he:0),s=new vK(null!==(pe=["x","y","z"].indexOf(n.axis))&&void 0!==pe?pe:0),l=new QQ(null!==(fe=n.blending)&&void 0!==fe?fe:0),d=new OQ(null!==(me=n.offset)&&void 0!==me?me:new p_(0,0)),u=new RQ(n.colorA),h=new RQ(n.colorB),p=new OQ(null!==(ge=n.frequency)&&void 0!==ge?ge:new p_(10,10)),f=new QQ(null!==(ve=n.size)&&void 0!==ve?ve:.5),m=new QQ(null!==(ye=n.variation)&&void 0!==ye?ye:0),g=new QQ(null!==(be=n.smoothness)&&void 0!==be?be:.5),v=new QQ(null!==(xe=n.zigzag)&&void 0!==xe?xe:0),y=new QQ(null!==(we=n.rotation)&&void 0!==we?we:0),b=new OQ(null!==(Se=n.vertical)&&void 0!==Se?Se:new p_(0,1)),x=new OQ(null!==(_e=n.horizontal)&&void 0!==_e?_e:new p_(0,1)),w=new vK(null!==(Ce=n.sides)&&void 0!==Ce?Ce:6),S=iJ(n),_=new XK(a,o,s,l,d,u,h,p,f,m,g,v,y,b,x,w,S.alpha,S.isMask),C=new XQ(_.calpha,"f");return new $Z(t,i,e,c({style:a,projection:o,axis:s,blending:l,offset:d,colorA:u,colorB:h,frequency:p,size:f,variation:m,smoothness:g,zigzag:v,rotation:y,vertical:b,horizontal:x,sides:w},S),_,S.mode,C,S.isMask,r)}default:{let a=new gK(1,0,0,1),o=iJ(n),s=new DK(a,o.alpha),l=new XQ(s.calpha,"f");return new $Z(t,i,e,c({color:a},o),s,o.mode,l,o.isMask,r)}}}(i,e,t,r,n)}(e,t,i,n)}updateByOp(e,t,i){let n=e;if(void 0===n.path[0]){if(0===n.type)return"type"in n.props||"category"in n.props||"visible"in n.props||"noiseType"in n.props?(i.scene.markNeedsUpdateRendererDirty(),!0):function(e,t,i,n){let r=!1;for(let[a,o]of Object.entries(e)){if("bumpMap"===a||"roughnessMap"===a){r=!0;continue}if(!a||void 0===o)continue;if(nJ(a,i,n,t)){"visible"===a&&"light"===i.type&&(r=!0);continue}i.visible=n.visible;let e=i.uniforms["f".concat(i.id,"_").concat(a)];if(e&&!(e instanceof xK))switch(r=r||QZ(i,a,o),e.constructor){case gK:if("string"==typeof o){let i=t.getColor(o);i&&(e.value=i);break}{let t=o;e.value instanceof qZ?e.value=new kQ(t.r,t.g,t.b,t.a):e.setRGBA(t);break}case RQ:if("string"==typeof o){let i=t.getColor(o);i&&(e.value=i);break}{let t=o;e.value instanceof qZ?e.value=new kQ(t.r,t.g,t.b,t.a):e.value.setRGBA(t.r,t.g,t.b,t.a);break}case OQ:{let t=o;e.value.setX(t[0]),e.value.setY(t[1]);break}case IQ:{let t=o;e.value.setX(t[0]),e.value.setY(t[1]),e.value.setZ(t[2]);break}case YQ:KZ(o,t,i);break;case MK:e.value=o.map(e=>new B_(...e));break;default:e.value=o}}return r}(n.props,i.shared,this,t)}else if("texture"===n.path[0])return!("texture"in t)&&!("video"in t)||KZ(n.props,i.shared,this);return!1}dispose(){if(function(e){let t=e instanceof JZ?e.type:e;return"texture"===t||"video"===t||"displace_map"===t||"matcap"===t}(this)){let e=this.uniforms["f".concat(this.id,"_texture")];if(!e)return!1;let t=e;t.image instanceof yZ||t.image.deref()}}hasValueByKey(e){return void 0!==this.uniforms[e]}hasValue(e){return this.hasValueByKey("f".concat(this.id,"_").concat(e))}setValue(e,t){let i="f".concat(this.id,"_").concat(e);this.hasValueByKey(i)&&void 0!==t&&(this.uniforms[i].value=t)}getNode(e){let t="f".concat(this.id,"_").concat(e);if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t="f".concat(this.id,"_").concat(e);if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log("Layer.getName: error ".concat(e))}getNames(){let e=[];for(let t in this.uniforms){let i=this.getName(t);i&&e.push(i)}return e}},$Z=class extends JZ{constructor(e,t,i,n,r,a,o,s,l){super(e,t,i,n,l),this.params=n,this.color=r,this.mode=a,this.alpha=o,this.isMask=s}},eJ=class extends JZ{constructor(e,t,i,n,r,a){super(e,t,i,n,a),this.position=r}},tJ=class extends JZ{constructor(e,t,i,n,r,a){super(e,t,i,r,a),this.node=n}static createLightLayer(e,t,i,n){let r,a,o=new QQ(ZZ(i.alpha,n)),s=new vK(i.mode),l=new QQ(i.bumpMapIntensity),c=new QQ(ZZ(i.alphaOverride,n));if(i.visible)if("lambert"===i.category){var d,u;r=new lZ;let e=new gK(null!==(d=n.color(i.emissive))&&void 0!==d?d:0),t=new yK(null===(u=i.occlusion)||void 0===u||u);a={emissive:e,occlusion:t},r.emissive=e,r.occlusion=t}else if("toon"===i.category){var h,p;r=new hZ;let e=new QQ(null!==(h=i.shininess)&&void 0!==h?h:30),t=new gK(null!==(p=n.color(i.specular))&&void 0!==p?p:1118481);a={shininess:e,specular:t},r.shininess=e,r.specular=t}else if("physical"===i.category){var f,m,g,v;r=new uZ;let e=new QQ(null!==(f=i.roughness)&&void 0!==f?f:.3),t=new QQ(null!==(m=i.metalness)&&void 0!==m?m:0),n=new QQ(null!==(g=i.reflectivity)&&void 0!==g?g:.5),o=new yK(null===(v=i.occlusion)||void 0===v||v);a={roughness:e,metalness:t,reflectivity:n,occlusion:o},r.roughness=e,r.metalness=t,r.reflectivity=n,r.occlusion=o}else{var y,b,x;r=new dZ;let e=new QQ(null!==(y=i.shininess)&&void 0!==y?y:30),t=new gK(void 0!==i.specular&&null!==(b=n.color(i.specular))&&void 0!==b?b:1118481),o=new yK(null===(x=i.occlusion)||void 0===x||x);a={shininess:e,specular:t,occlusion:o},r.shininess=e,r.specular=t,r.occlusion=o}else r=new sZ,a={};return r.alpha=new QQ(1),r.shadingAlpha=o,r.shadingBlend=s,r.bumpMapIntensity=l,r.alphaOverride=c,a.alpha=r.shadingAlpha,a.mode=r.shadingBlend,a.bumpMapIntensity=r.bumpMapIntensity,a.alphaOverride=r.alphaOverride,new tJ(e,t,i,r,a,n)}get category(){return this.node.category}};function iJ(e){var t,i,n;return{alpha:new QQ(null!==(t=e.alpha)&&void 0!==t?t:1),mode:new vK(null!==(i=e.mode)&&void 0!==i?i:0),isMask:new yK(null!==(n=e.isMask)&&void 0!==n&&n)}}function nJ(e,t,i,n){if("displace"===i.type&&("intensity"===e||"visible"===e)){let e=t.uniforms["f".concat(t.id,"_intensity")];return e?(e.value=i.intensity*(i.visible?1:0),e):void 0}if("displace"!==i.type&&("alpha"===e||"visible"===e)){let r=t.uniforms["f".concat(t.id,"_alpha")];if(!r)return;if(r.value=ZZ(i.alpha,n)*(i.visible?1:0),"outline"===i.type&&"visible"===e){let e=t.uniforms["f".concat(t.id,"_compensation")];e&&(e.value=i.compensation&&i.visible)}return r}}function rJ(e,t){let i=0,n=e.layers.find(e=>"light"===e.data.type);if(n){let e=n.data,i=Number(t.getVariable(e.alphaOverride));if(("string"==typeof e.alphaOverride?i/100:e.alphaOverride)<1)return!0}for(let a of e.layers){if("displace"!==a.data.type&&a.data.isMask)return!0;if("displace"!==a.data.type&&"alpha"in a.data&&"light"!==a.data.type&&"fresnel"!==a.data.type&&"texture"!==a.data.type&&"matcap"!==a.data.type&&"rainbow"!==a.data.type&&"outline"!==a.data.type&&"pattern"!==a.data.type){var r;let e=a.data.visible?a.data.alpha:0;if("string"==typeof e&&(e=Math.max(0,Math.min(1,Number(null!==(r=t.getVariable(e))&&void 0!==r?r:100)/100))),1===e&&"depth"===a.data.type||"gradient"===a.data.type){for(let t of a.data.colors)if(t[3]<1){e=t[3];break}}else if(1===e&&"noise"===a.data.type){let i=t.color(a.data.colorA).a,n=t.color(a.data.colorB).a,r=t.color(a.data.colorC).a,o=t.color(a.data.colorD).a,s=Math.min(i,Math.min(n,Math.min(r,o)));s<1&&(e=s)}i+=(1-i)*e}}return i<1}var aJ=class extends NE{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.shadersPatchedForShapeBlend=!1,this.nodeContextUuid=0,this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return""}},oJ=class extends aJ{constructor(e,t,i,n){super(),this.flatShading=e,this.side=t,this.wireframe=i,this.root=n}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,Object.assign(this.defines,e.defines),Object.assign(this.uniforms,e.uniforms),this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,i,n){return this.root.getFlavor(e,t,i,n)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,i){this.root.updateByOp(e,t,i)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},sJ=class extends aJ{constructor(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.data=e,this.allowVariableSaves=i,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.needsJitter=t.shared.needsJitter,AQ.startContext(this),this.reset0(e,t),AQ.endContext(this)}get nodeMaterial(){return this}getFlavor(e,t,i,n){var r;let a=i?6:(e?3:0)+t;if(a+=7*((null!==(r=null===n||void 0===n?void 0:n.resolutionLevel)&&void 0!==r?r:0)-(null!==n&&void 0!==n&&n.useChildrenColors?4:0)),0===a)return this;void 0===this.flavors&&(this.flavors=[]),a-=1;let o=this.flavors[a];return void 0===o&&(o=new oJ(e,t,i,this),o.needsJitter=this.needsJitter,this.flavors[a]=o,o.flatShading=e,o.side=t,o.updateAfterBuild(),n&&(o.defines.SHAPEBLEND=n.resolutionLevel,o.defines.SHAPEBLEND_C=n.useChildrenColors?1:0)),o}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var e,t;return null!==(e=null===(t=this.lightLayer.getNode("occlusion"))||void 0===t?void 0:t.value)&&void 0!==e&&e}reset(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];AQ.startContext(this),(this.data!==e||i)&&this.reset0(e,t),AQ.endContext(this)}reset0(e,t){var i,n;this.data=e;let r=null!==(i=e.layers)&&void 0!==i?i:lj.defaultTwoLayerData("phong").layers;try{this.layers=r.map(e=>JZ.create(this.layerIdGen++,e.id,e.data,t.shared))}catch(a){this.layers=[]}this.layers.reverse(),this.name=null!==(n=e.name)&&void 0!==n?n:"Untitled Material",this.onUpdate(t.shared),this.transparent=rJ(e,t.shared),this.saveVariableLocations(t)}onVariableUpdate(e,t,i){if("alphaOverride"===e[0])this.transparent=rJ(this.data,i.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(t)/100,1)));else if("layer"===e[0]){let n=e[1],r=e[2];if(n&&r){let e=this.layers.find(e=>e.uuid===n);(null===e||void 0===e?void 0:e.hasValue(r))&&("alpha"===r?(this.transparent=rJ(this.data,i.shared),e.setValue(r,Math.max(0,Math.min(Number(t)/100,1)))):e.setValue(r,t))}}}saveVariableLocations(e){if(!this.allowVariableSaves)return;let t=this.data.layers.find(e=>"light"===e.data.type);t&&e.shared.getVariable(t.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach(t=>{"alpha"in t.data&&"string"==typeof t.data.alpha&&e.shared.getVariable(t.data.alpha,["material",this.uuid,"layer",t.id,"alpha"])})}getLayersOfType(e){return this.layers.filter(t=>t.type===e)}getLayerByUuid(e){return this.layers.find(t=>t.uuid===e)}onUpdate(e){this.lightLayer=this.layers.find(e=>e instanceof tJ),void 0===this.lightLayer&&(this.lightLayer=new tJ(0,"",c(c({},sj.defaultData("light","phong")),{},{visible:!1}),new sZ,{},e)),this.dispose();for(let t of this.flavors)t&&t.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),this.build(),this.nodeContextUuid=0}applyTextureMaps(){let e=this.layers.find(e=>e instanceof tJ);if(!e)return;let t=e.data,i=t.bumpMap,n=t.roughnessMap;e.node.bumpMap=void 0,e.node.roughnessMap=void 0;for(let r=0;r<this.layers.length;++r){let t=this.layers[r];t instanceof $Z&&t.color instanceof RK&&(t.uuid===i&&(e.node.bumpMap=t.color),t.uuid===n&&(e.node.roughnessMap=t.color))}}updateByOp(e,t,i){if(AQ.startContext(this),void 0!==t?this.data=t:t=this.data,this.transparent=rJ(t,i.shared),"layers"===e.path[0]){let n=i.shared,r=e.path[1];if(void 0===r)i.scene.markNeedsUpdateRendererDirty(),this.reset0(t,i);else{0===e.type&&void 0!==e.props.occlusion&&i.scene.markNeedsUpdateRendererDirty();let a=this.layers.find(e=>e.uuid===r);if(a){let o,s=t.layers.data(r);0===e.type&&("alpha"in e.props||"alphaOverride"in e.props)&&(o="alpha"in e.props?c(c({},e.props),{},{alpha:ZZ(e.props.alpha,n,["material",this.uuid,"layer",r,"alpha"])}):c(c({},e.props),{},{alphaOverride:ZZ(e.props.alphaOverride,n,["material",this.uuid,"alphaOverride"])})),a.updateByOp(c(c(c({},e),o?{props:o}:{}),{},{path:e.path.slice(2)}),s,i)&&this.reset0(t,i)}}}else this.reset0(t,i);AQ.endContext(this)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof $Z?t.color.mask=void 0:t instanceof tJ&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof $Z&&t.isMask.value&&t.data.visible&&e>0){let i=e-1,n=this.layers[i];n instanceof tJ?n.node.mask=new JQ(t.color,t.alpha,JQ.MUL):n instanceof $Z&&(n.isMask.value||(n.color.mask=new JQ(t.color,t.alpha,JQ.MUL)))}}}blendColors(){let e=this.layers.findIndex(e=>e instanceof $Z),t=this.layers.findIndex(e=>e instanceof tJ);if(-1!==e&&e<t){let i=this.layers[e].color;for(let n=e+1;n<t;++n){let e=this.layers[n];if(e instanceof $Z){if(e.isMask.value)continue;i=new TK(i,e.color,e.alpha,e.mode)}}this.fragment.color=i}else this.fragment.color=void 0}blendAfterColors(){let e=new XQ("outgoingLight","f"),t=this.layers.findIndex(e=>e instanceof tJ);if(this.layers.length>t+1){for(let i=t+1;i<this.layers.length;++i){let t=this.layers[i];if(t instanceof $Z){if(t.isMask.value)continue;e=new TK(e,t.color,t.alpha,t.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter(e=>e instanceof eJ);if(e.length>0){let t=e[0].position;for(let i=1;i<e.length;++i)e[i]&&(t=new JQ(t,e[i].position,JQ.ADD),t=new JQ(t,new QQ(.5).setReadonly(!0),JQ.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){this.shapeBlendhack&&this.shapeBlendhack(this),e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=!0===this.extensions.derivatives,e.extensionFragDepth=!0===this.extensions.fragDepth,e.extensionDrawBuffers=!0===this.extensions.drawBuffers,e.extensionShaderTextureLOD=!0===this.extensions.shaderTextureLOD}clampUniformsForPreview(e,t){let i=(e,t,i)=>Math.min(Math.max(e,t),i);for(let n of this.layers)if("displace"===n.type){let r=i(n.uniforms["f".concat(n.id,"_intensity")].value,e,t);n.uniforms["f".concat(n.id,"_intensity")].value=r}}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new mK;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this.shadersPatchedForShapeBlend=!1,this}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof $Z){let t=e.params.texture;if(t instanceof SK&&!t.image.loaded)return!1}return!0}};Object.defineProperties(aJ.prototype,{properties:{get:function(){return this.fragment.properties}}});var lJ=class extends sJ{constructor(e,t,i){super(e,t,!1),this.uuid=i,this.allowVariableSaves=!0,this.saveVariableLocations(t)}},cJ=new Map;function dJ(e){if("string"==typeof e)return e;let t=cJ.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},cJ.set(e,t)),t.url}var uJ,hJ,pJ,fJ=new Promise(e=>{uJ=e}),mJ=!1;function gJ(){if(!mJ)return hJ||(hJ=async function(){await i.e(519).then(i.bind(i,519)),uJ(void 0!==window?window:global),mJ=!0}())}function vJ(e,t){e.forEach(e=>{"dragDropActions"in e.data?(t.push(...e.data.dragDropActions.drag),t.push(...e.data.dragDropActions.drop)):"inActions"in e.data?(t.push(...e.data.inActions),t.push(...e.data.outActions)):"gameActions"in e.data?(t.push(...e.data.gameActions.idle),t.push(...e.data.gameActions.move),t.push(...e.data.gameActions.jump),t.push(...e.data.gameActions.run)):"breakpoints"in e.data?e.data.breakpoints.forEach(e=>{t.push(...e.data.actions)}):"actions"in e.data&&(t.push(...e.data.actions),e.data.actions.forEach(e=>{"Conditional"===e.data.type&&e.data.ifActions&&(t.push(...e.data.ifActions),t.push(...e.data.elseActions))}))})}function yJ(e){let t=!1,i=[];return e.scene.objects.traverse((e,n)=>{if("Page"===n.type&&void 0!==n.uiScene&&n.uiScene.objects.traverse((e,n)=>{if(void 0===n.events||!1===Array.isArray(n.events))return!0;vJ(n.events,i),t=t||i.some(e=>"Audio"===e.data.type)}),void 0===n.events||!1===Array.isArray(n.events))return!0;vJ(n.events,i),t=t||i.some(e=>"Audio"===e.data.type)}),t}fJ.then(e=>pJ=e);var bJ,xJ,wJ=class{constructor(e){let t,{src:i,volume:n,delay:r,loop:a}=e;this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)},t="string"==typeof i?{src:i}:{src:dJ(i),format:"wav"},this.sound=new pJ.Howl(t),this.sound.on("end",this.onEnd),this.src=i,void 0!==n&&(this.volume=n),void 0!==r&&(this.delay=r),void 0!==a&&(this.loop=a)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,t),this.clearFade()},e)):this.sound.fade(this._volume,0,t)}on(e,t,i){this.sound.on(e,t,i)}off(e,t,i){this.sound.off(e,t,i)}play(){"playing"===this._status||this.sound.playing()||("paused"===this._status?(0===this.sound.seek()?this.replay():this.sound.play(),this._status="playing"):"stopped"===this._status&&(this.replay(),this._status="playing"))}pause(){"playing"===this._status&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},SJ=class{constructor(){this.type="ShapePath",this.color=new D_,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new _P,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){var i;return null!==(i=this.currentPath)&&void 0!==i&&i.lineTo(e,t),this}quadraticCurveTo(e,t,i,n){var r;return null!==(r=this.currentPath)&&void 0!==r&&r.quadraticCurveTo(e,t,i,n),this}bezierCurveTo(e,t,i,n,r,a){var o;return null!==(o=this.currentPath)&&void 0!==o&&o.bezierCurveTo(e,t,i,n,r,a),this}splineThru(e){var t;return null!==(t=this.currentPath)&&void 0!==t&&t.splineThru(e),this}toShapes(){let e=0,t=1,i=2,n=3,r=4,a=5,o=6,s={loc:e,t:0};function l(t,n,r,a){let o=t.x,l=n.x,d=r.x,u=a.x,h=t.y,p=n.y,f=r.y,m=a.y,g=(u-d)*(h-f)-(m-f)*(o-d),v=(m-f)*(l-o)-(u-d)*(p-h),y=g/v,b=((l-o)*(h-f)-(p-h)*(o-d))/v;if(0===v&&0!==g||y<=0||y>=1||b<0||b>1)return null;if(0===g&&0===v){for(let d=0;d<2;d++){if(c(0===d?r:a,t,n),s.loc===e){let e=0===d?r:a;return{x:e.x,y:e.y,t:s.t}}if(s.loc===i){return{x:+(o+s.t*(l-o)).toPrecision(10),y:+(h+s.t*(p-h)).toPrecision(10),t:s.t}}}return null}for(let i=0;i<2;i++)if(c(0===i?r:a,t,n),s.loc===e){let e=0===i?r:a;return{x:e.x,y:e.y,t:s.t}}return{x:+(o+y*(l-o)).toPrecision(10),y:+(h+y*(p-h)).toPrecision(10),t:y}}function c(l,c,d){let u,h=d.x-c.x,p=d.y-c.y,f=l.x-c.x,m=l.y-c.y,g=h*m-f*p;return l.x===c.x&&l.y===c.y?(s.loc=e,void(s.t=0)):l.x===d.x&&l.y===d.y?(s.loc=t,void(s.t=1)):void(g<-Number.EPSILON?s.loc=n:g>Number.EPSILON?s.loc=r:h*f<0||p*m<0?s.loc=a:Math.sqrt(h*h+p*p)<Math.sqrt(f*f+m*m)?s.loc=o:(u=0!==h?f/h:m/p,s.loc=i,s.t=u))}function d(e,t,i){let n=new p_;t.getCenter(n);let r=[];return i.forEach(t=>{t.boundingBox.containsPoint(n)&&function(e,t){let i=[],n=[];for(let r=1;r<e.length;r++){let a=e[r-1],o=e[r];for(let e=1;e<t.length;e++){let r=l(a,o,t[e-1],t[e]);null!==r&&void 0===i.find(e=>e.t<=r.t+Number.EPSILON&&e.t>=r.t-Number.EPSILON)&&(i.push(r),n.push(new p_(r.x,r.y)))}}return n}(e,t.points).forEach(e=>{r.push({identifier:t.identifier,isCW:t.isCW,point:e})})}),r.sort((e,t)=>e.point.x-t.point.x),r}let u=0,h=999999999,p=-999999999,f=[];this.subPaths.forEach(e=>{let t=e.getPoints(),i=-999999999,n=999999999,r=-999999999,a=999999999;for(let o=0;o<t.length;o++){let e=t[o];e.y>i&&(i=e.y),e.y<n&&(n=e.y),e.x>r&&(r=e.x),e.x<a&&(a=e.x)}p<=r&&(p=r+1),h>=a&&(h=a-1),t.length&&f.push({curves:e.curves,points:t,isCW:tD.isClockWise(t),identifier:u++,boundingBox:new CO(new p_(a,n),new p_(r,i))})});let m=f.map(e=>{var t;return function(e,t,i,n,r){(null==r||""===r)&&(r="nonzero");let a=new p_;e.boundingBox.getCenter(a);let o=d([new p_(i,a.y),new p_(n,a.y)],e.boundingBox,t);o.sort((e,t)=>e.point.x-t.point.x);let s=[],l=[];o.forEach(t=>{t.identifier===e.identifier?s.push(t):l.push(t)});let c=s[0].point.x,u=[],h=0;for(;h<l.length&&l[h].point.x<c;)u.length>0&&u[u.length-1]===l[h].identifier?u.pop():u.push(l[h].identifier),h++;if(u.push(e.identifier),"evenodd"===r){let t=u.length%2===0,i=u[u.length-2];return{identifier:e.identifier,isHole:t,for:i}}if("nonzero"===r){let i=!0,n=null,r=null;for(let e=0;e<u.length;e++){let a=u[e];t[a]&&(i?(r=t[a].isCW,i=!1,n=a):r!==t[a].isCW&&(r=t[a].isCW,i=!0))}return{identifier:e.identifier,isHole:i,for:n}}console.warn('fill-rule: "'+r+'" is currently not implemented.')}(e,f,h,p,null===(t=this.userData)||void 0===t?void 0:t.style.fillRule)}),g=[];return f.forEach(e=>{let t=m[e.identifier];if(t&&!t.isHole){let t=new PP;t.curves=e.curves,m.filter(t=>(null===t||void 0===t?void 0:t.isHole)&&t.for===e.identifier).forEach(e=>{if(e){let i=f[e.identifier],n=new _P;n.curves=i.curves,t.holes.push(n)}}),g.push(t)}}),g}},_J=!1,CJ=new Promise(e=>{bJ=e}),EJ=!1;function AJ(){if(_J=!0,!EJ)return xJ||(xJ=async function(){let e=await i.e(946).then(i.bind(i,946));bJ(e),EJ=!0}(),xJ)}var MJ=new class{async load(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},{load:n}=await CJ;n(e,(e,n)=>{e||!n?i(null!==e&&void 0!==e?e:"Something went wrong"):t(n)})}async parse(e){let{parse:t,Bidi:i}=await CJ;try{let n=t(e),r=new i,a=e=>n.charToGlyphIndex(e.char);return r.registerModifier("glyphIndex",null,a),r.applyFeatures(n,n.defaultRenderOptions.features),{font:n,bidi:r}}catch(EV){console.error(EV)}}};async function TJ(e){let t,i,n=!1;if(e.url?(t=await async function(e){return await(await fetch(e)).arrayBuffer()}(e.url),i=e.url,n=e.url.startsWith("/")):e.data&&(t=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength)),t){if(!_J)return{font:void 0,url:i,intercepted:n,arr:t,bidi:null};{let e=await MJ.parse(t);if(e)return{font:e.font,url:i,intercepted:n,arr:t,bidi:e.bidi}}}}function PJ(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var DJ=class{constructor(e){var t;this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=null!==(t=e.isUserFont)&&void 0!==t&&t,this._loadingPromise=TJ(e).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}update(e){var t;this._isLoaded=!1,this._isUserFont=null!==(t=e.isUserFont)&&void 0!==t&&t,this._loadingPromise=TJ(e).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,i){if(!this._bidi)return[];let n=this._bidi;n.getTextGlyphs(t);let r=n.tokenizer.tokens,a=[],o=0,s=i.length===r.length;for(let l=0;l<i.length;l++){let n=i[l].index,c=String.fromCharCode(i[l].unicode),d=r[o];if(PJ(n,d)||s)a.push({char:c,index:n,replacements:[d.state.glyphIndex],replacementChars:[d.char]}),o++;else{let i=d.char,r="",s=[d.state.glyphIndex],l=[],u=!1;for(;!u;)o++,r=t.charAt(o),i+=r,s.push(e.charToGlyphIndex(r)),l=e.stringToGlyphs(i),1===l.length&&l[0].index===n&&(u=!0),o>t.length&&(u=!0);a.push({char:c,index:n,replacements:s,replacementChars:Array.from(i)}),o++}}return a}generateShapes(e,t,i){if(!this._isLoaded)return;let n=this.font,r=t.fontSize/this.unitsPerEm,a=t.fontSize*t.lineHeight,o=e.map(e=>this.getTextWidth(e,t)),s="string"==typeof t.width?Number(i.getVariable(t.width)):t.width,l="string"==typeof t.height?Number(i.getVariable(t.height)):t.height,c=this.getCharWidth("\n",t),d=1===t.horizontalAlign?c:0,u=this.getLineInitialOffsetX(o[0],s,t.horizontalAlign,e[0],c),h=this.getLineInitialOffsetY(a,e.length,l,r,t.verticalAlign),p=[],f=e.map(e=>[]),m=e.map(e=>[]);for(let b=0;b<e.length;b++){var g;let l=e[b],v={features:{liga:!0},letterSpacing:t.letterSpacing},x=[];try{x=n.stringToGlyphs(l,v)}catch(y){console.warn(y)}u=this.getLineInitialOffsetX(o[b],s,t.horizontalAlign,l,c);let w=[];try{w=this.reverseLigaturesTable(n,l,x)}catch(y){console.warn(y)}let S=this.computeSpaceWidthForLine(e,b,t,i),_=0,C=x[0];C&&2===t.horizontalAlign&&void 0!==C.leftSideBearing&&(u-=C.leftSideBearing*r),null!==(g=this.font)&&void 0!==g&&g.forEachGlyph(l,u,h,t.fontSize,v,(e,i,a,o,s)=>{let l=0===e.index?"\n":e.unicode?String.fromCharCode(e.unicode):void 0,c=w[_],u=0;if("\n"===l)u=d;else if(" "===l)u=S;else{let n=this.createPath(e,r,i,a,t);n&&(u=n.offsetX,p.push(n.path))}if(1===c.replacements.length)m[b].push([i,a]),f[b].push(u);else{let e=c.replacements.map(e=>{var t;return(null!==(t=n.glyphs.get(e).advanceWidth)&&void 0!==t?t:0)*r}),t=e.reduce((e,t)=>e+t,0),o=e.map(e=>e/t),s=i;for(let i=0;i<o.length;i++){let e=u*o[i];m[b].push([s,a]),f[b].push(e),s+=e}}_++}),h-=a}let v=[];for(let b=0,x=p.length;b<x;b++)v.push(...p[b].toShapes());return{shapes:v,charWidths:f,lineWidths:o,charCoords:m}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.ascender)&&void 0!==e?e:0}get descender(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.descender)&&void 0!==e?e:0}get familyName(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.names.fontFamily)&&void 0!==e?e:""}get subfamilyName(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.names.fontSubfamily)&&void 0!==e?e:""}get unitsPerEm(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.unitsPerEm)&&void 0!==e?e:1}getLineInitialOffsetX(e,t,i,n,r){return(3===i||2===i)&&n.indexOf("\n")>=0&&(e-=r),3===i?.5*t-.5*e:2===i?t-e:0}getLineInitialOffsetY(e,t,i,n,r){let a=t*e,o=e-Math.abs(this.ascender-this.descender)*n,s=-this.ascender*n-o/2;return 3===r?-(i-a-s):2===r?-(.5*i-.5*a-s):s}createPath(e,t,i,n,r){var a;let o=e.getPath(i,-n,r.fontSize,{kerning:!1,letterSpacing:r.letterSpacing});if(!o)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+this.familyName+".");let s=new SJ,l=(null!==(a=e.advanceWidth)&&void 0!==a?a:1)*t;if(e)for(let d of o.commands){var c;let e=null===(c=s.currentPath)||void 0===c?void 0:c.currentPoint;if(!e||"Z"===d.type||e.x!==d.x||-e.y!==d.y)switch(d.type){case"M":s.moveTo(d.x,-d.y);break;case"L":s.lineTo(d.x,-d.y);break;case"Q":s.quadraticCurveTo(d.x1,-d.y1,d.x,-d.y);break;case"C":s.bezierCurveTo(d.x1,-d.y1,d.x2,-d.y2,d.x,-d.y)}}return s.subPaths.forEach(e=>{let t=function(e){if(e.length){let t=e[0];if(t instanceof vP)return t.v1;if(t instanceof mP||t instanceof bP)return t.v0}}(e.curves);void 0!==t&&e.currentPoint.distanceTo(t)>0&&e.lineTo(t.x,t.y)}),{offsetX:l,path:s}}getCharWidth(e,t){var i,n;return null!==(i=null===(n=this.font)||void 0===n?void 0:n.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))&&void 0!==i?i:0}getTextWidth(e,t){var i,n;return null!==(i=null===(n=this.font)||void 0===n?void 0:n.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))&&void 0!==i?i:0}computeSpaceWidthForLine(e,t,i,n){let r=this.getCharWidth(" ",i),a=e[t];if(a){let o=this.countSpaces(a.trimEnd());if(4===i.horizontalAlign&&t<e.length-1&&o){return(("string"==typeof i.width?Number(n.getVariable(i.width)):i.width)-(this.getTextWidth(a,i)-o*r))/o}}return r}countSpaces(e){return(e.match(/ /g)||[]).length}};var OJ=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t,i){let n=this.objects.get(e);return void 0===n?(n=this.createObject(e,t,i),this.objects.set(e,n)):n.isShared=!0,n}forceDelete(e){let t=this.objects.get(e);t&&(this.disposeObject(t),this.objects.delete(e))}mutateIfUnique(e,t){let i=this.objects.get(e);if(i&&!0!==i.isShared)return this.objects.delete(e),this.objects.set(t,i),i}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){t===this.objects.get(e)&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach(e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)}),this.unreachable.clear()}dispose(){this.objects.forEach(e=>{this.disposeObject(e)}),this.objects.clear()}},IJ=class extends OJ{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t,i){let n=NY(e,t,this.flatShading,i);return n.computeBoundingSphere(),n}},kJ={markNeedsUpdateRendererDirty:()=>{}},RJ=1e3,zJ=512e3;var LJ="https://hooks.spline.design",BJ="".concat(LJ,"/events?hashFile="),NJ=("".concat(LJ,"/"),class{constructor(e,t){this.id=e,this.userWebhook=t,this.result=void 0,this._connected=!1,this.emitter=mY(),this.reconnectWaitFor=RJ,this._onError=e=>{var t,i,n;null!==(t=this.eventSource)&&void 0!==t&&t.removeEventListener("message",this._onMessage),null!==(i=this.eventSource)&&void 0!==i&&i.removeEventListener("error",this._onError),null!==(n=this.eventSource)&&void 0!==n&&n.removeEventListener("open",this._onConnected),this._scheduleReconnect()},this._onConnected=e=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=RJ,this._connected=!0},this._onDisconnected=()=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=RJ,this._connected=!1},this._onMessage=e=>{let t,i=e.data;try{t=JSON.parse(i)}catch(EV){console.error("Error parsing webhook message",EV)}if(t){let e=!1;this.userWebhook.parametersSchemas.forEach(i=>{let{data:n}=i;void 0!==t[n.name]&&function(e,t){let i=typeof e;return!!(("string"===t||"number"===t)&&i===t||"boolean"===t&&("true"===e||"false"===e||!0===e||!1===e)||"image"===t&&"string"===i&&e.startsWith("http"))}(t[n.name],n.type)&&(void 0===this.result&&(this.result={}),this.result[n.name]=t[n.name],e=!0)}),e&&this.emitter.emit("message",{userWebhookId:this.id})}}}connect(){clearTimeout(this.scheduledReconnectHandle),this.userWebhook.url&&(this.eventSource=new EventSource(BJ+this.userWebhook.url),this.eventSource.addEventListener("message",this._onMessage),this.eventSource.addEventListener("error",this._onError),this.eventSource.addEventListener("open",this._onConnected))}disconnect(){var e,t,i,n;null!==(e=this.eventSource)&&void 0!==e&&e.removeEventListener("message",this._onMessage),null!==(t=this.eventSource)&&void 0!==t&&t.removeEventListener("error",this._onError),null!==(i=this.eventSource)&&void 0!==i&&i.removeEventListener("open",this._onConnected),null!==(n=this.eventSource)&&void 0!==n&&n.close(),this._onDisconnected(),clearTimeout(this.scheduledReconnectHandle)}_scheduleReconnect(){this.reconnectWaitFor*=2,this.reconnectWaitFor>zJ&&(this.reconnectWaitFor=zJ),clearTimeout(this.scheduledReconnectHandle),this.scheduledReconnectHandle=setTimeout(()=>{this.scheduledReconnectHandle=void 0,this.connect()},this.reconnectWaitFor)}update(e){this.userWebhook=e}dispose(){this._connected&&this.disconnect()}get connected(){return this._connected}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}getParametersKeys(){return this.userWebhook.parametersSchemas.map(e=>e.data.name)}getParameterValue(e){if(this.getParametersKeys().includes(e)){var t;if(this.result)return null===(t=this.result)||void 0===t?void 0:t[e];for(let t of this.userWebhook.parametersSchemas)if(t.data.name===e)return Jj.defaultParameterValueByType(t.data.type)}}}),FJ=[4186.01,4434.92,4698.63,4978.03,5274.04,5587.65,5919.91,6271.93,6644.88,7040,7458.62,7902.13],UJ=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],VJ=[],jJ=[];for(let i=1;i<=8;i++)for(let e=0;e<FJ.length;e++){let t=FJ[e];VJ.push(t/Math.pow(2,8-i)),jJ.push(UJ[e]+i)}var WJ=[32,2e3],HJ=VJ.filter((e,t)=>VJ[t]>WJ[0]&&VJ[t]<WJ[1]),GJ=jJ.filter((e,t)=>VJ[t]>WJ[0]&&VJ[t]<WJ[1]),qJ=class{static getFrequencies(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"frequency",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-100,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-30;i||(i=new Float32Array(e.frequencyBinCount),e.getFloatFrequencyData(i));let o,s,l,c=t/2,d=1/i.length*c;if("music"===n||"voice"===n){let e="voice"===n?HJ:VJ,t=Array(e.length).fill(r);for(let n=0;n<i.length;n++){let r=n*d,a=i[n];for(let i=e.length-1;i>=0;i--)if(r>e[i]){t[i]=Math.max(t[i],a);break}}o=t,s="voice"===n?HJ:VJ,l="voice"===n?GJ:jJ}else o=Array.from(i),s=o.map((e,t)=>d*t),l=s.map(e=>"".concat(e.toFixed(2)," Hz"));let u=o.map(e=>Math.max(0,Math.min((e-r)/(a-r),1)));return{values:new Float32Array(u),frequencies:s,labels:l}}};var XJ=class{constructor(e){this.value=0,this.frequencies=new Float32Array(0);let t=new AudioContext;this.source=t.createMediaStreamSource(e),this.analyser=t.createAnalyser(),this.source.connect(this.analyser),this.analyser.fftSize=8192,this.analyser.smoothingTimeConstant=.1}getFrequencies(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-30;if(!this.analyser)throw new Error("Not connected, please call .connect() first");return qJ.getFrequencies(this.analyser,44100,void 0,"voice",e,t)}update(){let e=this.getFrequencies(),t=e.values.reduce((e,t)=>e+t,0)/e.values.length;this.value=t,this.frequencies=e.values}disconnect(){this.source.disconnect(),this.analyser.disconnect()}},YJ=class{constructor(e,t,i){this.data=e,this.id=t,this.shared=i,this.emitter=mY(),this.rafId=0,this.voice=0,this.frequencies=new Float32Array([0]),this.events=[],this.isConnected=!1,this.isToolsAdded=!1,this.tools=[],this.onMessage=e=>{var t;let i=JSON.parse(e.data);if(this.appendEvent(i),"session.created"===i.type&&this.onSessionCreated(),"response.done"===i.type&&null!==(t=i.response)&&void 0!==t&&t.output)for(let n of i.response.output)if("function_call"===n.type)for(let[e,t]of this.tools)n.name===e.name&&(t(JSON.parse(n.arguments)),setTimeout(()=>{this.sendClientEvent({type:"response.create",response:{instructions:"notice the user about what you just did"}})}))},this.onSessionCreated=()=>{this.isToolsAdded||this.registerTools()},this.onOpen=()=>{this.events=[],this.isConnected=!0,this.sendClientEvent({type:"response.create",response:{instructions:"Say hi"}})},this.animate=()=>{if(this.rafId=requestAnimationFrame(this.animate),this.isConnected&&this.analyser){this.analyser.update();let e=this.analyser.value,t=this.analyser.frequencies;this.voice=e,this.frequencies=t,this.emitter.emit("voice",{value:e,frequencies:t})}}}update(e){this.data=e}setColorByName(e,t){let i=this.shared.getColorByName(e);if(i){var n;let{id:e}=i,{r:r,g:a,b:o}=null!==(n=dY.hexStringToRgb(t))&&void 0!==n?n:{r:0,g:0,b:0};this.shared.updateColor(e,{r:r/255,g:a/255,b:o/255})}}async connect(){if(this.isConnected)return;let e=await async function(t){try{return(await(await fetch("https://relayserver.spline.design/session?uuidfile="+t)).json()).token}catch(e){console.error("Token generation error:",e)}}(this.data.integration.hash);this.pc=new RTCPeerConnection,this.audioElement=document.createElement("audio"),this.audioElement.autoplay=!0,this.pc.ontrack=e=>{let t=e.streams[0];this.audioElement.srcObject=t,this.analyser=new XJ(t)};let t=await navigator.mediaDevices.getUserMedia({audio:!0});this.pc.addTrack(t.getTracks()[0]),this.dc=this.pc.createDataChannel("oai-events"),this.dc.addEventListener("message",this.onMessage),this.dc.addEventListener("open",this.onOpen);let i=await this.pc.createOffer();await this.pc.setLocalDescription(i);let n={type:"answer",sdp:await(await fetch("https://api.openai.com/v1/realtime?model=".concat("gpt-4o-realtime-preview-2024-12-17"),{method:"POST",body:i.sdp,headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/sdp"}})).text()};await this.pc.setRemoteDescription(n),this.animate()}appendEvent(e){this.events=[e,...this.events]}sendClientEvent(e){this.dc?(e.event_id=e.event_id||crypto.randomUUID(),this.dc.send(JSON.stringify(e)),this.appendEvent(e)):console.error("Failed to send message - no data channel available",e)}registerTools(){this.isToolsAdded=!0,this.registerTool({type:"function",name:"set_personality_color",description:"returns a color based on the voice personality of the ai assistant. This should be called by the voice assistant each time it is asks to speak differently. If a color cannot be associated to the personality, the color should be a neutral color.",parameters:{type:"object",properties:{color:{type:"string",description:"css hex color string, reflecting the personality"},personality:{type:"string",description:"the personality of the voice assistant"}},required:["color","personality"]}},e=>{let{color:t}=e;this.setColorByName("Voice Assistant Color",t)});let e=this.shared.getVariablesNames().join(", ");this.registerTool({type:"function",name:"set_variable",description:"Sets a Spline variable value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:"The name of the variable that needs to be set. Here's a list of available variables: ".concat(e,". It the variable does not exist, don't call the function and warn the user about it.")},value:{type:"string",description:"The new value for this variable, should always be a string even for number and boolean variables, assume that the value will be cast to the proper type afterwards."}},required:["name","value","type"]}},e=>{let{name:t,value:i}=e,n=this.shared.getVariableByName(t);if(n){let e,t=this.shared.getVariable(n.id);e="number"==typeof t?parseFloat(i):"boolean"==typeof t?"true"===i.toLowerCase():{textValue:i},this.shared.updateVariable(n.id,e)}});let t=this.shared.getColorNames().join(", ");this.registerTool({type:"function",name:"set_color",description:"Sets a Spline color asset value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:"The name of the color asset that needs to be set. Here's a list of available color assets: ".concat(t,". It the color asset does not exist, don't call the function and warn the user about it.")},value:{type:"string",description:"css hex color string"}},required:["name","value"]}},e=>{let{name:t,value:i}=e;this.setColorByName(t,i)});let i=this.shared.scene,n=[];i.traverseEntity(e=>{e.data.events.forEach(e=>{if("AIAssistantTrigger"===e.data.type){let{description:t}=e.data;n.push(t)}})}),this.registerTool({type:"function",name:"trigger_event",description:"Trigger an event by name, here are the available events, please match what the user is asking for to one of these if it applies, otherwise don't call the function and warn the user.",parameters:{type:"object",properties:{description:{type:"string",description:"The name of the event that needs to be triggered. Here's a list of available events: ".concat(JSON.stringify(n),".")},direction:{type:"string",description:"default is forward, but can be forward or backward. Always set to forward unless the user ask to reverse or cancel the event, then set to backward."}},required:["description","direction"]}},e=>{let{description:t,direction:i}=e;this.emitter.emit("trigger_event",{description:t,direction:i})}),this.sendClientEvent({type:"session.update",session:{tools:this.tools.map(e=>{let[t]=e;return t})}})}registerTool(e,t){this.tools.push([e,t])}disconnect(){var e,t,i,n,r,a;cancelAnimationFrame(this.rafId),null!==(e=this.analyser)&&void 0!==e&&e.disconnect(),this.voice=0,this.isConnected=!1,this.isToolsAdded=!1,null!==(t=this.dc)&&void 0!==t&&t.removeEventListener("message",this.onMessage),null!==(i=this.dc)&&void 0!==i&&i.removeEventListener("open",this.onOpen),null!==(n=this.dc)&&void 0!==n&&n.close(),null!==(r=this.pc)&&void 0!==r&&r.getSenders().forEach(e=>{e.track&&e.track.stop()}),null!==(a=this.pc)&&void 0!==a&&a.close(),this.pc=void 0}computeAnalysisForListenerEvent(e){if("range"===e.analysis){let t=this.frequencies.slice(...e.analysisRange);return t.reduce((e,t)=>e+t,0)/t.length}return"single"===e.analysis?this.frequencies[e.analysisSingle]:this.voice}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}};function QJ(e){return"variable_"+e}var KJ=class extends gZ{constructor(e){super(),this.shared=e}create(e){return new vZ(e,this.shared)}},ZJ=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.data=e,this.needsJitter=i,this.enableLocalStorageForPersistentVariables=n,this.geometryCache=new IJ(!0),this.geometryCache2=new IJ(!1),this.imageHolderCache=new KJ(this),this.thisContext={scene:kJ,shared:this},this.deletedMaterial=new lJ(lj.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new yZ(MW.emptyImage,this),this.deletedVideo=new yZ(JV.defaultVideo,this),this.materials={},this.images={},this.uiBuffers={},this.videos={},this.colors={},this.audios={},this.particles={},this.fonts={},this.variables={},this.userAPIs={},this.userWebhooks={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[r,a]of Object.entries(t.images))this.addImage(r,a);if(t.videos)for(let[r,a]of Object.entries(t.videos))this.addVideo(r,a);if(t.audios)for(let[r,a]of Object.entries(t.audios))this.addAudio(r,a);if(t.particles)for(let[r,a]of Object.entries(t.particles))this.addParticle(r,a);this.reset(e)}setRequestRender(e){this._requestRender=e}getImageLoadPromises(){return Object.values(this.images).map(e=>e.loadPromise)}setEntityOpContext(e){this.entityOpContext=e}reset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.data=e,this.resetLib(e.lib);for(let{id:n,data:r}of e.variables)this.addVariableHolder(n,r),t&&this.updateVariableHolder(n,r);for(let[n,r]of Object.entries(e.userAPIs))this.addUserAPI(n,r);for(let[n,r]of Object.entries(e.userWebhooks))this.addUserWebhook(n,r);if(!i){for(let[t,i]of Object.entries(e.images))this.addImage(t,i);for(let[t,i]of Object.entries(e.videos))this.addVideo(t,i)}for(let[n,r]of Object.entries(e.colors))this.addColor(n,r);for(let[n,r]of Object.entries(e.materials))this.addMaterial(n,r);for(let[n,r]of Object.entries(e.audios))this.addAudio(n,r);for(let[n,r]of Object.entries(e.particles))this.addParticle(n,r);for(let[n,r]of Object.entries(e.fonts))this.addFont(n,r)}addMaterial(e,t){if(this.materials[e]){let i=this.materials[e];i.reset(t,this.thisContext),i.dispose()}else{let i=new lJ(t,this.thisContext,e);this.materials[e]=i}}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){var t;return null!==(t=this.materials[e])&&void 0!==t?t:this.deletedMaterial}material(e){return"string"==typeof e?this.getMaterialOrDeletedPlaceholder(e):null==e?(console.error("material is undefined or null"),this.deletedMaterial):new sJ(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new yZ(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){var t;return null!==(t=this.images[e])&&void 0!==t?t:this.deletedImage}image(e){return"string"==typeof e?this.getImage(e):this.imageHolderCache.load(e)}addUIBuffer(e,t){return this.uiBuffers[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.uiBuffers[e].updateSrc(t),!0):(this.uiBuffers[e]=new yZ(t,this),!1)}uiBuffer(e){return this.uiBuffers[e]}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new yZ(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){var t;return null!==(t=this.videos[e])&&void 0!==t?t:this.deletedVideo}video(e){return"string"==typeof e?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):(this.colors[e]=new qZ(t.r,t.g,t.b,"a"in t?t.a:1),!1)}updateColor(e,t){if(this.colors[e]){var i,n,r,a;this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let o=this.colors[e];return this.colors[e].r=null!==(i=t.r)&&void 0!==i?i:o.r,this.colors[e].g=null!==(n=t.g)&&void 0!==n?n:o.g,this.colors[e].b=null!==(r=t.b)&&void 0!==r?r:o.b,this.colors[e].a=null!==(a=t.a)&&void 0!==a?a:o.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}getColorNames(){return Object.values(this.data.colors).map(e=>e.name)}getColorByName(e){for(let t in this.data.colors)if(this.data.colors[t].name===e)return{color:this.colors[t],id:t}}color(e){let t;if("string"!=typeof e)return new kQ(e.r,e.g,e.b,"a"in e?e.a:1);{let i=this.getColor(e);i?t=i:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),t=new kQ(0,0,0,0))}return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof wJ)return t;{let i=new wJ({src:t.data});return this.audios[e]=i,i}}addParticle(e,t){this.particles[e]=t}getParticle(e){return this.particles[e]}deleteParticle(e){this.particles[e]&&delete this.particles[e]}deleteAudio(e){let t=this.audios[e];t&&(t instanceof wJ&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new DJ(t),this.fonts[e].loadingPromise.then(()=>this.requestRender())}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach(e=>this.deleteMaterial(e)),this._requestRender=void 0,Object.values(this.audios).forEach(e=>{e instanceof wJ&&e.dispose()}),this.audios={},this.particles={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(e,t){if(void 0===this.variables[e]){let i=t.value;if(this.enableLocalStorageForPersistentVariables&&t.persistent){let n=localStorage.getItem(QJ(e));i=null!==n?JSON.parse(n):t.value}return this.variables[e]={value:i,locations:[],persistent:t.persistent},"dynamicVariableType"in t&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0),!0}return this.variables[e].value=t.value,!1}resetDynamicVariablePlayState(){for(let e in this.variables)void 0!==this.variables[e].dynamicVariablePlayState&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(e,t){this.updateVariable(e,t.value)}updateVariable(e,t){if(void 0===this.variables[e])return!1;this.variables[e].value=t,this.enableLocalStorageForPersistentVariables&&this.variables[e].persistent&&localStorage.setItem(QJ(e),JSON.stringify(t));let i=t;for(;"string"==typeof i;)i=this.variables[i].value;let n=this.entityOpContext.scene;for(let r=this.variables[e].locations.length-1;r>=0;r--){let t=this.variables[e].locations[r];if("material"===t[0]){let e=t[1],r=i,a={scene:n,shared:this},o=t.slice(2);n.traverseMaterial(t=>{var i;let n=null!==(i=t.root)&&void 0!==i?i:t;n.uuid===e&&n.onVariableUpdate(o,r,a)});let s=this.materials[e];s&&s.onVariableUpdate(o,r,a)}else{let a=n.find(t[0]);if(void 0===a){this.variables[e].locations.splice(r,1);continue}if("geometry"!==t[1]&&"particles"!==t[1]){for(let e=1;e<t.length-1;e++)a=a[t[e]];"rotation"===t[1]?a[t[t.length-1]]=i*h_.DEG2RAD:a[t[t.length-1]]=i}if(a=n.find(t[0]),"ParticleEmitter"===a.type&&a.updateVariableState(i,t),PG.is(a))if("position"===t[1]||"rotation"===t[1]||"scale"===t[1])a.onVariableUpdate();else if("geometry"===t[1]){let e=a;a.component&&(e=a.component);let t=e.dataPatched;e.chooseGeoemtryCache(this).forceDelete(t.geometry),e.createGeometryDelayed(this.entityOpContext),e.onVariableUpdate(!0),e.invalidateDownstreamBooleanData(),e.instances.forEach(e=>{let t=e.dataPatched;e.chooseGeoemtryCache(this).forceDelete(t.geometry),e.createGeometryDelayed(this.entityOpContext),e.onVariableUpdate(!0),e.invalidateDownstreamBooleanData()})}else"morphTargetInfluences"===t[1]&&a.updateMorphInfluences(t[2],i)}}return this.requestRender(),!0}deleteVariable(e){this.variables[e]&&delete this.variables[e]}getVariable(e,t){if(Array.isArray(e)){var i,n,r,a;if("mouse"===e[0])return null!==(i=null===(n=this.mouseProperty)||void 0===n?void 0:n[e[1]])&&void 0!==i?i:0;if("raycast"===e[0])return null!==(r=null===(a=this.raycastProperty)||void 0===a?void 0:a[e[1]])&&void 0!==r?r:0;let t=this.entityOpContext.scene.find(e[0]);if("width"===e[1]||"height"===e[1]||"depth"===e[1])return t.geometry.userData.parameters[e[1]];for(let i=1;i<e.length;i++)t=t[e[i]];return"rotation"===e[1]&&(t*=h_.RAD2DEG),t}for(let s in this.variables){var o;if(void 0===t)break;let e=this.variables[s],i=null===(o=e.locations)||void 0===o?void 0:o.findIndex(e=>fF.equal(e,t));void 0!==i&&-1!==i&&e.locations.splice(i,1)}if("string"==typeof e){let i=e,n=e;do{if(n=i,void 0===this.variables[i])break;let e=this.variables[i].value;t&&void 0!==this.variables[n]&&this.variables[n].locations.push(t),i=e}while("string"==typeof i);return i}return e}getVariables(){return this.variables}getVariablesNames(){return this.data.variables.map(e=>e.data.name)}getVariableByName(e){for(let t of this.data.variables)if(t.data.name===e)return{variable:t.data,id:t.id}}getDynamicVariablePlayState(e){var t;return null===(t=this.variables[e])||void 0===t?void 0:t.dynamicVariablePlayState}setDynamicVariablePlayState(e,t){void 0!==this.variables[e]&&(this.variables[e].dynamicVariablePlayState=t)}getDynamicVariableToggleIsForward(e){var t;return null===(t=this.variables[e])||void 0===t?void 0:t.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(e,t){void 0!==this.variables[e]&&(this.variables[e].dynamicVariableToggleIsForward=t)}resetLib(e){for(let[t,i]of Object.entries(e.images))this.addImage(t,i.asset);for(let[t,i]of Object.entries(e.audios))this.addAudio(t,i.asset);for(let[t,i]of Object.entries(e.particles))this.addParticle(t,i.asset);for(let[t,i]of Object.entries(e.colors))this.addColor(t,i.asset);for(let[t,i]of Object.entries(e.fonts))this.addFont(t,i.asset);for(let[t,i]of Object.entries(e.materials))this.addMaterial(t,i.asset);for(let[t,i]of Object.entries(e.videos))this.addVideo(t,i.asset);for(let[t,i]of Object.entries(e.variables))this.addVariableHolder(t,i.asset)}updateLibByOp(e,t){"images"===e.path[0]?1===e.path.length&&1===e.type?this.addImage(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteImage(e.id):"videos"===e.path[0]?1===e.path.length&&1===e.type?this.addVideo(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteVideo(e.id):"audios"===e.path[0]?1===e.path.length&&1===e.type?this.addAudio(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteAudio(e.id):"particles"===e.path[0]?1===e.path.length&&1===e.type?this.addParticle(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteParticle(e.id):"colors"===e.path[0]?1===e.path.length&&1===e.type?this.addColor(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteColor(e.id):"materials"===e.path[0]?1===e.path.length&&1===e.type?this.addMaterial(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteMaterial(e.id):"fonts"===e.path[0]?1===e.path.length&&1===e.type?this.addFont(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteFont(e.id):"variables"===e.path[0]?1===e.path.length&&1===e.type?this.addVariableHolder(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteVariable(e.id):"components"===e.path[0]&&t.updateByLibOp(e,this)}updateByOp(e,t,i){if(this.data=t,"images"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.getImage(e.path[1]).updateSrc(e.props.data):1===e.path.length&&1===e.type?this.addImage(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteImage(e.id);else if("videos"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.getVideo(e.path[1]).updateSrc(e.props.data):1===e.path.length&&1===e.type?this.addVideo(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteVideo(e.id);else if("audios"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.addAudio(e.path[1],t.audios[e.path[1]]):1===e.path.length&&1===e.type?this.addAudio(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteAudio(e.id);else if("particles"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.addParticle(e.path[1],t.particles[e.path[1]]):1===e.path.length&&1===e.type?this.addParticle(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteParticle(e.id);else if("colors"===e.path[0])2===e.path.length&&0===e.type?this.updateColor(e.path[1],e.props):1===e.path.length&&1===e.type?this.addColor(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteColor(e.id);else if("materials"===e.path[0])1===e.path.length&&1===e.type?this.addMaterial(e.id,e.data):1===e.path.length&&2===e.type?this.deleteMaterial(e.id):e.path.length>1&&this.getMaterial(e.path[1]).updateByOp(GN.drop(e,2),t.materials[e.path[1]],{shared:this,scene:i});else if("fonts"===e.path[0])2===e.path.length&&0===e.type?this.updateFont(e.path[1],e,i):1===e.path.length&&1===e.type?this.addFont(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteFont(e.id);else if("variables"===e.path[0])2===e.path.length&&0===e.type?"value"in e.props?this.updateVariable(e.path[1],e.props.value):"persistent"in e.props&&(this.variables[e.path[1]].persistent=e.props.persistent):1===e.path.length&&4===e.type?this.addVariableHolder(e.id,e.data):1===e.path.length&&5===e.type&&this.deleteVariable(e.id);else if("userAPIs"===e.path[0]){if(1===e.path.length&&1===e.type)this.addUserAPI(e.id,e.data);else if(1===e.path.length&&2===e.type)this.deleteUserAPI(e.id);else if("string"==typeof e.path[1]){let i=t.userAPIs[e.path[1]];if(i){let t=0===e.type&&void 0===e.props.debounce,n=this.getUserAPI(e.path[1]);n instanceof YJ?n.update(i):null===n||void 0===n||n.update(i,this,t)}}}else if("userWebhooks"===e.path[0]){if(1===e.path.length&&1===e.type)this.addUserWebhook(e.id,e.data);else if(1===e.path.length&&2===e.type)this.deleteUserWebhook(e.id);else if("string"==typeof e.path[1]){var n;let i=t.userWebhooks[e.path[1]];i&&(null===(n=this.getUserWebhook(e.path[1]))||void 0===n||n.update(i))}}else"lib"===e.path[0]&&this.updateLibByOp(GN.drop(e,1),i)}updateFont(e,t,i){if(t.props.url){let n=this.getFont(e),r=c(c({},this.data.fonts[e]),{},{url:t.props.url});n.update(r),n.loadingPromise.then(()=>this.requestRender()),i.updateFont(e,this)}}addUserAPI(e,t){var i,n;return this.userAPIs[e]?(this.userAPIs[e].update(t,this),!0):(null===(i=this.openAIRealtime)||void 0===i?void 0:i.id)===e?(this.openAIRealtime.update(t),!0):"VoiceAssistant"===(null===(n=t.integration)||void 0===n?void 0:n.type)?(this.openAIRealtime=new YJ(t,e,this),!1):(this.userAPIs[e]=new gY(e,t,this),!1)}getUserAPI(e){var t;return(null===(t=this.openAIRealtime)||void 0===t?void 0:t.id)===e?this.openAIRealtime:this.userAPIs[e]}getUserAPIs(){return this.userAPIs}deleteUserAPI(e){let t=this.userAPIs[e];t&&(t.dispose(),delete this.userAPIs[e])}addUserWebhook(e,t){return this.userWebhooks[e]?(this.userWebhooks[e].update(t),!0):(this.userWebhooks[e]=new NJ(e,t),!1)}getUserWebhook(e){return this.userWebhooks[e]}getUserWebhooks(){return this.userWebhooks}deleteUserWebhook(e){let t=this.userWebhooks[e];t&&(t.dispose(),delete this.userWebhooks[e])}get scene(){return this.entityOpContext.scene}},JJ=(new ZJ(aW.emptyData()),class extends CQ{updateByPatchedOp(e,t,i){if(super.updateByPatchedOp(e,t,i),null!==function(e,t){let i=[];if(t.length!==e.length)return null;for(var n=0;n<e.length;){if("*"===t[n])i.push(e[n]);else if(e[n]!==t[n])return null;n+=1}return i}(e.path,["materials"])&&0===e.type&&Array.isArray(this.material))for(let[n,r]of Object.entries(e.props)){let e=i.shared.material(r);this.material[Number(n)]=e}else if(xF(e.path,["material"])&&this.material instanceof aJ)"material"in t&&"string"!=typeof t.material&&this.material.updateByOp(GN.drop(e,1),t.material,i);else if(xF(e.path,["materials","*"])&&Array.isArray(this.material)){let n=e.path[1];if("materials"in t&&n<this.material.length){let r=t.materials[n];"string"!=typeof r&&this.material[n].updateByOp(GN.drop(e,2),r,i)}}}get needsAO(){return void 0!==this.material&&(Array.isArray(this.material)?this.material[0]:this.material).hasAO}updateState(e,t){var i,n;super.updateState(e,t),void 0!==e.castShadow&&(this.castShadow=e.castShadow),void 0!==e.receiveShadow&&(this.receiveShadow=e.receiveShadow);let r,a=this.dataPatched;if("Mesh"===this.dataPatched.type&&this.dataPatched.geometry.shapeBlendNode&&this.layers.set(9),"Mesh"===this.dataPatched.type&&"ShapeBlendGeometry"===this.dataPatched.geometry.type&&(r={resolutionLevel:this.dataPatched.geometry.resolutionLevel,useChildrenColors:this.dataPatched.geometry.useChildrenColors}),"NonParametricGeometry"!==(null===(i=e.geometry)||void 0===i?void 0:i.type)&&"material"in e&&void 0!==e.material&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(a.flatShading,a.side,a.wireframe,r),t.scene.markNeedsUpdateRendererDirty()),("NonParametricGeometry"===(null===(n=e.geometry)||void 0===n?void 0:n.type)||"materials"in e)&&("materials"in e&&void 0!==e.materials?(this.disposeMaterial(),this.material=e.materials.map(e=>t.shared.material(e).getFlavor(a.flatShading,a.side,a.wireframe)),t.scene.markNeedsUpdateRendererDirty()):"material"in e&&void 0!==e.material&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(a.flatShading,a.side,a.wireframe)],t.scene.markNeedsUpdateRendererDirty())),void 0!==e.flatShading||void 0!==e.wireframe||void 0!==e.side)if(Array.isArray(this.material))for(let o=0;o<this.material.length;o++)this.material[o]=this.material[o].getFlavor(a.flatShading,a.side,a.wireframe);else this.material=this.material.getFlavor(a.flatShading,a.side,a.wireframe,r)}disposeMaterial(){this.material&&cN(this.material).forEach(e=>{e instanceof aJ&&(e instanceof lJ||e.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}}),$J=new j_,e$=new B_,t$=new B_,i$=new j_,n$=new yC,r$=class extends JJ{constructor(e,t,i){super(e,t),this.data=t,this.isSkinnedMesh=!1,this.localGeometry=void 0,t.bindMode&&t.bindMatrix&&(this.bindMode=t.bindMode,this.bindMatrix=(new yC).fromArray(t.bindMatrix),this.bindMatrixInverse=new yC)}chooseGeoemtryCache(e){return e.geometryCache}markGeometryAsReachable(e){this.geometryCreateDeleyed instanceof vE&&this.chooseGeoemtryCache(e).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(void 0!==this.localGeometry)return this.localGeometry;if(this.geometryCreateDeleyed instanceof ZJ){let e=this.geometryCreateDeleyed,t=this.chooseGeoemtryCache(e);this.geometryCreateDeleyed=t.get(this.dataPatched.geometry,e,this)}return this.geometryCreateDeleyed}set geometry(e){this.localGeometry=e}get is2DAndNoDepth(){let e=this.dataPatched.geometry;return mj.is2DParametricMesh(e.type)&&0===e.depth}get is2DType(){return mj.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return"NonParametricGeometry"===this.geometry.userData.type}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),xF(e.path,["geometry"])&&this.updateByPatchedOpGeometry(GN.drop(e,1),t.geometry,i)}removeInteractionGeometry(e){var t;null!==(t=this.localGeometry)&&void 0!==t&&t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(e,t){this.invalidateDownstreamBooleanData();let i=this.data.geometry.type;if("NonParametricGeometry"===i||"SubdivGeometry"===i){let i,n,r,a=e;if(void 0===this.localGeometry){let e=c(c({},this.data.geometry),a);this.localGeometry=NY(e,t,this.data.flatShading,this)}a.scaleBaked?[i,n,r]=a.scaleBaked:({width:i,height:n,depth:r}=a);let o=this.localGeometry.userData;void 0!==o.sxPrev&&UY(this.localGeometry.attributes,i/o.sxPrev,n/o.syPrev,r/o.szPrev),o.sxPrev=i,o.syPrev=n,o.szPrev=r}else{var n;let i=c(c({},this.data.geometry),e);null!==(n=this.localGeometry)&&void 0!==n&&n.dispose(),this.localGeometry=NY(i,t,this.data.flatShading,this)}}refreshAttachedClonersInteractions(){for(let e of this.attachedSurfaceCloners)e.update()}refreshAttachedCloners(e){for(let t of this.attachedSurfaceCloners)e.scene.addPendingUpdateCloner(t.object)}refreshAttachedPaths(e){for(let t of this.attachedPaths)e.scene.addPendingCommand(()=>t.updateShape())}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.refreshAttachedCloners(e),this.refreshAttachedPaths(e)}updateByPatchedOpGeometry(e,t,i){var n;let r=!1;0===e.type&&0===e.path.length&&Object.keys(e.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof XY&&this.chooseGeoemtryCache(i.shared).mutateIfUnique(this.geometryCreateDeleyed.data,t)===this.geometryCreateDeleyed&&(r=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(t,e.props.scaleBaked),this.refreshAttachedCloners(i),this.refreshAttachedPaths(i)),r||(null!==(n=i.scene)&&void 0!==n&&n.markGeometryCacheDirty(),this.createGeometryDelayed(i)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(e,t){this.createGeometryDelayed(t)}updateState(e,t){void 0!==e.geometry&&this.updateGeometryOnStateUpdate(e.geometry,t);let i=e.morphTargetInfluences;if(i){this.updateMorphTargets(),this.geometry.morphTargetsRelative=!0;for(let{data:{name:e,value:n}}of i)this.updateMorphInfluences(e,t.shared.getVariable(n,[this.uuid,"morphTargetInfluences",e]))}super.updateState(e,t)}updateMorphInfluences(e,t){if(void 0===this.morphTargetDictionary)return;let i=this.morphTargetDictionary[e];void 0!==i&&(this.morphTargetInfluences[i]=t)}updateGeometryGroupsIfNeeded(){var e,t;Array.isArray(this.material)&&0===this.geometry.groups.length&&this.geometry.addGroup(0,Math.max(null!==(e=null===(t=this.geometry.getIndex())||void 0===t?void 0:t.count)&&void 0!==e?e:0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(e,t){var i,n;let r=this.geometry.userData.parameters;this.is2DType?e.set(0,0,.5*r.depth):this.isNonParametric?(e.setScalar(0),this.geometry.boundingSphere&&e.copy(this.geometry.boundingSphere.center),t.set(r.width,r.height,null!==(i=r.depth)&&void 0!==i?i:0).multiplyScalar(.5)):r.centerOffset?e.fromArray(r.centerOffset):e.setScalar(0),t.set(r.width,r.height,null!==(n=r.depth)&&void 0!==n?n:0).multiplyScalar(.5)}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(e,t){this.skeleton=e,this.isSkinnedMesh=!0,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(e){let t=new B_,i=this.geometry.attributes.skinWeight;for(let n=0,r=i.count;n<r;n++){t.fromBufferAttribute(i,n);let e=1/t.manhattanLength();e!==1/0?t.multiplyScalar(e):t.set(1,0,0,0),i.setXYZW(n,t.x,t.y,t.z,t.w)}}boneTransform(e,t){let i=this.skeleton;if(void 0===i)return;let n=this.geometry;e$.fromBufferAttribute(n.attributes.skinIndex,e),t$.fromBufferAttribute(n.attributes.skinWeight,e),$J.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){let e=t$.getComponent(r);if(0!==e){let n=e$.getComponent(r);n$.multiplyMatrices(i.bones[n].matrixWorld,i.boneInverses[n]),t.addScaledVector(i$.copy($J).applyMatrix4(n$),e)}}return t.applyMatrix4(this.bindMatrixInverse)}};function a$(e){if(Array.isArray(e.material)){for(let t of e.material)if(0===t.getLayersOfType("outline").length)return}else if(!(e.material instanceof aJ)||0===e.material.getLayersOfType("outline").length)return;e instanceof r$&&e.is2DAndNoDepth?function(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,i=new Float32Array(t.length),n=new j_;for(let r=0;r<t.length;r+=3)n.set(t[r],t[r+1],t[r+2]).normalize(),i[r]=n.x,i[r+1]=n.y,i[r+2]=n.z;e.geometry.setAttribute("extrudeNormal",new cE(i,3))}(e):function(e){if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,i=e.geometry.attributes,n=i.position.array,r=i.normal.array,a=new Float32Array(n.length);for(let l=0;l<n.length;l+=3){var o;let e="".concat(n[l],"_").concat(n[l+1],"_").concat(n[l+2]),i=new j_(r[l],r[l+1],r[l+2]);t.has(e)?null===(o=t.get(e))||void 0===o||o.normals.push(i):t.set(e,{normals:[i],result:new j_})}t.forEach((e,t)=>{for(let i of e.normals)e.result.add(i);e.result.divideScalar(e.normals.length)});for(let l=0;l<n.length;l+=3){var s;let e="".concat(n[l],"_").concat(n[l+1],"_").concat(n[l+2]),i=null===(s=t.get(e))||void 0===s?void 0:s.result;i&&(a[l]=i.x,a[l+1]=i.y,a[l+2]=i.z)}e.geometry.setAttribute("extrudeNormal",new cE(a,3))}(e)}function o$(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,i=new Float32Array(t.length),n=parseInt(e.uuid.replace(/\D/g,"")),r=[h_.seededRandom(n),h_.seededRandom(n+1e4),h_.seededRandom(n+2e4)];for(let a=0;a<t.length;a++)i[a]=r[a%3];e.geometry.setAttribute("randomColor",new oE(i,3))}var s$=new G_,l$=new j_;function c$(e){let t=!1;return e.scene.objects.traverse((e,i)=>{"Mesh"===i.type&&"SubdivGeometry"===i.geometry.type&&(t=!0)}),t}var d$=class extends r${constructor(e,t,i){super(e,t,i),this.data=t,this.hiddenMatrixOld=new yC,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return void 0!==this.localGeometry?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return void 0!==this.localGeometry?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){var e;return null!==(e=this.data.geometry.phongAngle)&&void 0!==e?e:45}updateEntityBoxSize(e,t){var i;let n=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(n.width,n.height,null!==(i=n.depth)&&void 0!==i?i:0).multiplyScalar(.5)}createGeometryByControls(e){var t,i,n,r;if(!0===this.skipReactionUpdate)return;let a=null===(t=this.localGeometry)||void 0===t?void 0:t.uuid,{originalGeometry:o,subdividedGeometry:s,subdivPointer:l}=XY.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=l,void 0!==o&&(null!==(i=this.originalGeometry)&&void 0!==i&&i.dispose(),this.originalGeometry=o),void 0!==s&&(null!==(n=this.subdividedGeometry)&&void 0!==n&&n.dispose(),this.subdividedGeometry=null!==s&&void 0!==s?s:void 0),this.localGeometry=null!==(r=this.subdividedGeometry)&&void 0!==r?r:this.originalGeometry,a$(this),o$(this),this.calcBoundingBox(),a&&(this.localGeometry.uuid=a)}updateState(e,t){if(super.updateState(e,t),void 0!==e.flatShading){let i=this.material;this.material=Array.isArray(i)?i.map(e=>e.getFlavor(!1,e.side,e.wireframe)):i.getFlavor(!1,i.side,i.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];XY.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&XY.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){var e;this.originalGeometry.dispose(),this.originalGeometry=XY.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=XY.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=null!==(e=this.subdividedGeometry)&&void 0!==e?e:this.originalGeometry}raycast(e,t){let i=this.localGeometry;this.localGeometry=this.originalGeometryNew,CQ.prototype.raycast.call(this,e,t),this.localGeometry=i}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;null===e.boundingSphere&&(e.boundingSphere=new cC,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,i=e.boundingSphere.center;s$.setFromBufferAttribute(t),s$.getCenter(i),e.boundingSphere.radius=i.distanceTo(s$.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),s$.getSize(l$),this.hasNonUniformScale&&l$.divide(this.scale);let n={width:l$.x,height:l$.y,depth:l$.z};return this.geometry.userData.parameters=n,n}updateBoundingSphere(e){let t=this.originalGeometry;s$.min.set(e[0],e[2],e[4]),s$.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&(s$.min.applyMatrix4(this.shearScaleInv),s$.max.applyMatrix4(this.shearScaleInv)),null===t.boundingSphere&&(t.boundingSphere=new cC);let i=t.boundingSphere.center;s$.getCenter(i),t.boundingSphere.radius=i.distanceTo(s$.max)}freeSubdivPointer(){var e,t;this.subdivPointer&&(XY.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,null!==(e=this.originalGeometry)&&void 0!==e&&e.dispose(),null===(t=this.subdividedGeometry)||void 0===t||t.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,i){super.updateByPatchedOpGeometry(e,t,i),this.localGeometry&&this.createGeometryByControls(t)}},u$={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},h$={polygon_center:0,edge:1,vertex:2},p$=(e,t)=>(i,n)=>t&&0!==i&&0!==e?e*n/100:0,f$=(e,t)=>{let i=Math.abs(t),n=-1*i;return(e- -1)*(i-n)/2+n},m$=new j_,g$=new j_,v$=new j_,y$=new j_;function b$(e,t){let i=v$.fromArray(e),n=y$.fromArray(t);g$.copy(n).sub(i);let r=g$.length();return g$.normalize().multiplyScalar(.5*r),m$.copy(i).add(g$).toArray()}var x$=new eE,w$=new j_,S$=new j_,_$=new j_;var C$=e=>.5*(1-Math.cos(e*Math.PI)),E$=class{constructor(){this.perlin=new Array(4096)}noise(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null==this.perlin){this.perlin=new Array(4096);for(let e=0;e<4096;e++)this.perlin[e]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),i<0&&(i=-i);let n,r,a,o,s,l=Math.floor(e),c=Math.floor(t),d=Math.floor(i),u=e-l,h=t-c,p=i-d,f=0,m=.5;for(let g=0;g<4;g++){let e=l+(c<<4)+(d<<8);n=C$(u),r=C$(h),a=this.perlin[4095&e],a+=n*(this.perlin[e+1&4095]-a),o=this.perlin[e+16&4095],o+=n*(this.perlin[e+16+1&4095]-o),a+=r*(o-a),e+=256,o=this.perlin[4095&e],o+=n*(this.perlin[e+1&4095]-o),s=this.perlin[e+16&4095],s+=n*(this.perlin[e+16+1&4095]-s),o+=r*(s-o),a+=C$(p)*(o-a),f+=a*m,m*=.5,l<<=1,u*=2,c<<=1,h*=2,d<<=1,p*=2,u>=1&&(l++,u--),h>=1&&(c++,h--),p>=1&&(d++,p--)}return f}noiseSeed(e){let t=(()=>{let e,t;return{setSeed(i){t=e=(null!==i&&void 0!==i?i:4294967296*Math.random())>>>0},getSeed:()=>e,rand:()=>(t=(1664525*t+1013904223)%4294967296,t/4294967296)}})();t.setSeed(e),this.perlin=new Array(4096);for(let i=0;i<4096;i++)this.perlin[i]=t.rand()}},A$=new j_,M$=new yC,T$=new vC;function P$(e){let t=!1;return e.scene.objects.traverse((e,i)=>{"Mesh"===i.type&&("TextGeometry"===i.geometry.type||"InputGeometry"===i.geometry.type)&&(t=!0)}),t}var D$,O$,I$,k$,R$=class extends r${constructor(e,t,i){super(e,t,i),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var e,t;let i=this.dataPatched;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,i.geometry.height,this.fontScale,i.geometry.verticalAlign))&&void 0!==e?e:0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var e,t;return(null!==(e=null===(t=this.font)||void 0===t?void 0:t.ascender)&&void 0!==e?e:1)*this.fontScale}get descender(){var e,t;return(null!==(e=null===(t=this.font)||void 0===t?void 0:t.descender)&&void 0!==e?e:1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:i}=this;if(!isNaN(e.ray.origin.x)&&0!==this.scale.x&&0!==this.scale.y&&0!==this.scale.z&&(M$.copy(i).invert(),T$.copy(e.ray).applyMatrix4(M$),T$.intersectBox(this.singleBBox,A$))){let n=A$.applyMatrix4(i),r=e.ray.origin.distanceTo(n);t.push({distance:r,point:n.clone(),object:this})}}},z$=1e-4,L$=new j_,B$=new j_;RY.then(e=>{O$=[(D$=e).get_face_center,D$.get_edge_midpoint,D$.get_vertex_position],I$=[D$.get_face_normal,D$.get_edge_normal,D$.get_vertex_normal],k$=[D$.face_count,D$.edge_count,D$.vertex_count]});var N$=new yC,F$=new yC,U$=new j_,V$=new j_,j$=new j_,W$=new j_,H$=new j_,G$=new j_,q$=class{constructor(e,t){this.data=e,this.is3D=t,this.perlin=new E$,"perlin"===e.noiseType?(this.perlin.noiseSeed(e.seed),this.noise=t?(e,t,i)=>this.perlin.noise(e,t,i):e=>this.perlin.noise(e)):this.noise=t?function(){let e=wG(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random),t=new Float64Array(e).map(e=>xG[e%12*3]),i=new Float64Array(e).map(e=>xG[e%12*3+1]),n=new Float64Array(e).map(e=>xG[e%12*3+2]);return function(r,a,o){let s,l,c,d,u,h,p,f,m,g,v=(r+a+o)*gG,y=yG(r+v),b=yG(a+v),x=yG(o+v),w=(y+b+x)*vG,S=r-(y-w),_=a-(b-w),C=o-(x-w);S>=_?_>=C?(u=1,h=0,p=0,f=1,m=1,g=0):S>=C?(u=1,h=0,p=0,f=1,m=0,g=1):(u=0,h=0,p=1,f=1,m=0,g=1):_<C?(u=0,h=0,p=1,f=0,m=1,g=1):S<C?(u=0,h=1,p=0,f=0,m=1,g=1):(u=0,h=1,p=0,f=1,m=1,g=0);let E=S-u+vG,A=_-h+vG,M=C-p+vG,T=S-f+2*vG,P=_-m+2*vG,D=C-g+2*vG,O=S-1+.5,I=_-1+.5,k=C-1+.5,R=255&y,z=255&b,L=255&x,B=.6-S*S-_*_-C*C;if(B<0)s=0;else{let r=R+e[z+e[L]];B*=B,s=B*B*(t[r]*S+i[r]*_+n[r]*C)}let N=.6-E*E-A*A-M*M;if(N<0)l=0;else{let r=R+u+e[z+h+e[L+p]];N*=N,l=N*N*(t[r]*E+i[r]*A+n[r]*M)}let F=.6-T*T-P*P-D*D;if(F<0)c=0;else{let r=R+f+e[z+m+e[L+g]];F*=F,c=F*F*(t[r]*T+i[r]*P+n[r]*D)}let U=.6-O*O-I*I-k*k;if(U<0)d=0;else{let r=R+1+e[z+1+e[L+1]];U*=U,d=U*U*(t[r]*O+i[r]*I+n[r]*k)}return 32*(s+l+c+d)}}((0,pG.default)(e.seed)):function(){let e=wG(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random),t=new Float64Array(e).map(e=>bG[e%12*2]),i=new Float64Array(e).map(e=>bG[e%12*2+1]);return function(n,r){let a,o,s=0,l=0,c=0,d=(n+r)*fG,u=yG(n+d),h=yG(r+d),p=(u+h)*mG,f=n-(u-p),m=r-(h-p);f>m?(a=1,o=0):(a=0,o=1);let g=f-a+mG,v=m-o+mG,y=f-1+2*mG,b=m-1+2*mG,x=255&u,w=255&h,S=.5-f*f-m*m;if(S>=0){let n=x+e[w];S*=S,s=S*S*(t[n]*f+i[n]*m)}let _=.5-g*g-v*v;if(_>=0){let n=x+a+e[w+o];_*=_,l=_*_*(t[n]*g+i[n]*v)}let C=.5-y*y-b*b;if(C>=0){let n=x+1+e[w+1];C*=C,c=C*C*(t[n]*y+i[n]*b)}return 70*(s+l+c)}}((0,pG.default)(e.seed))}},X$=class extends(DG(WC)){constructor(e,t){super(),this.parameters=t,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.random=null,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(null===this.parent)this.updateState(this.parameters,e);else for(let t of this.children)t instanceof IG&&t.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse(t=>{t instanceof IG&&t.object===e&&(t.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){"toObject"!==this.parameters.type&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let t;if(t=void 0!==e?e:"grid"===this.parameters.type?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,"toObject"===this.parameters.type)if(this.parameters.toObject.object){if(void 0===e&&"random"!==this.parameters.toObject.spreadType)return}else t=0;if("toObject"===this.parameters.type&&this.objectForSample){let e=this.children;if(e.length===t)return;if(e.length<t)for(let i=0,n=t-e.length;i<n;++i){let e=new IG(this.object);e.expand(),this.add(e)}else for(let i=0,n=e.length-t;i<n;++i)this.remove(e[i])}else{if(this.children.length===t)return;if(this.children.length<t)for(let e=0,i=t-this.children.length;e<i;++e){let e=new IG(this.object);e.expand(),this.add(e)}else for(let e=0,i=this.children.length-t;e<i;++e)this.remove(this.children[e])}}getRandom(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(null===this.random||this.random.data.seed!==e.seed||this.random.is3D!==t)&&(this.random=new q$(e,t)),this.random}_updateRadial(e){var t;let i,n=e.radial,r=n.start*h_.DEG2RAD,a=r-n.end*h_.DEG2RAD,o=new TC(n.rotation[0],n.rotation[1],n.rotation[2]);switch(n.axis){case"z":i=new j_(0,0,1);break;case"y":i=new j_(0,1,0);break;default:i=new j_(1,0,0)}let s=null!==(t=e.randomnessObject)&&void 0!==t?t:UV.defaultData([1,1,1]).randomnessObject,l=this.getRandom(s),c=p$(s.strength,this.parameters.randomness);for(let[d,u]of this.children.entries()){let t=d*(s.freqScale/10)+s.movement,h=l.noise(t,t,t),p=d+1;u.scale.x=n.scale[0]+c(p,f$(h,s.scale[0]))||z$,u.scale.y=n.scale[1]+c(p,f$(h,s.scale[1]))||z$,u.scale.z=n.scale[2]+c(p,f$(h,s.scale[2]))||z$,u.position.setScalar(0);let f=a/e.count*d-r;switch(n.axis){case"x":u.rotation.set(0,f,0);break;case"y":u.rotation.set(0,0,f);break;case"z":u.rotation.set(f,0,0)}u.translateOnAxis(i,n.radius),u.position.x+=n.position[0]+c(p,f$(h,s.position[0])),u.position.y+=n.position[1]+c(p,f$(h,s.position[1])),u.position.z+=n.position[2]+c(p,f$(h,s.position[2]));let m=c(p,f$(h,s.rotation[0])),g=c(p,f$(h,s.rotation[1])),v=c(p,f$(h,s.rotation[2]));!0===n.alignment?(u.rotation.x+=o.x+m,u.rotation.y+=o.y+g,u.rotation.z+=o.z+v):u.rotation.set(o.x+m,o.y+g,o.z+v)}}_updateLinear(e){var t;if("linear"!==e.type)throw new Error;let i=e.linear,n=new TC(i.rotation[0],i.rotation[1],i.rotation[2]),r=null!==(t=e.randomnessObject)&&void 0!==t?t:UV.defaultData([1,1,1]).randomnessObject,a=this.getRandom(r),o=p$(r.strength,this.parameters.randomness);for(let[s,l]of this.children.entries()){let e=s*(r.freqScale/10)+r.movement,t=a.noise(e,e,e),c=s+1,d=o(c,f$(t,r.rotation[0])),u=o(c,f$(t,r.rotation[1])),h=o(c,f$(t,r.rotation[2]));l.scale.x=1+(i.scale[0]-1)*s+o(c,f$(t,r.scale[0]))||z$,l.scale.y=1+(i.scale[1]-1)*s+o(c,f$(t,r.scale[1]))||z$,l.scale.z=1+(i.scale[2]-1)*s+o(c,f$(t,r.scale[2]))||z$,l.rotation.x=n.x*s+d,l.rotation.y=n.y*s+u,l.rotation.z=n.z*s+h,l.position.x=i.position[0]*s+o(c,f$(t,r.position[0])),l.position.y=i.position[1]*s+o(c,f$(t,r.position[1])),l.position.z=i.position[2]*s+o(c,f$(t,r.position[2]))}}_updateGrid(e){var t;let i=0,n=e.grid,r=null!==(t=e.randomnessObject)&&void 0!==t?t:UV.defaultData([1,1,1]).randomnessObject,a=this.getRandom(r,!0),o=p$(r.strength,this.parameters.randomness);if(!0===n.useCenter){let e={x:n.count[0]%2===0?2:1,y:n.count[1]%2===0?2:1,z:n.count[2]%2===0?2:1},t=new j_(n.size[0]*(n.count[0]-e.x)*.5,n.size[1]*(n.count[1]-e.y)*.5,n.size[2]*(n.count[2]-e.z)*.5);for(let s=0;s<n.count[0];s++)for(let e=0;e<n.count[1];e++)for(let l=0;l<n.count[2];l++){let c=a.noise((s+1)*(r.freqScale/10)+r.movement,(e+1)*(r.freqScale/10)+r.movement,(l+1)*(r.freqScale/10)+r.movement),d=this.children[i++];d.scale.x=1+o(i,f$(c,r.scale[0]))||z$,d.scale.y=1+o(i,f$(c,r.scale[1]))||z$,d.scale.z=1+o(i,f$(c,r.scale[2]))||z$;let u=o(i,f$(c,r.rotation[0])),h=o(i,f$(c,r.rotation[1])),p=o(i,f$(c,r.rotation[2]));d.rotation.set(u,h,p),d.position.x=n.size[0]*s-t.x+o(i,f$(c,r.position[0])),d.position.y=n.size[1]*e-t.y+o(i,f$(c,r.position[1])),d.position.z=n.size[2]*l-t.z+o(i,f$(c,r.position[2]))}}else for(let s=0;s<n.count[0];s++)for(let e=0;e<n.count[1];e++)for(let t=0;t<n.count[2];t++){let l=a.noise((s+1)*(r.freqScale/10)+r.movement,(e+1)*(r.freqScale/10)+r.movement,(t+1)*(r.freqScale/10)+r.movement),c=this.children[i++];c.scale.x=1+o(i,f$(l,r.scale[0]))||z$,c.scale.y=1+o(i,f$(l,r.scale[1]))||z$,c.scale.z=1+o(i,f$(l,r.scale[2]))||z$;let d=o(i,f$(l,r.rotation[0])),u=o(i,f$(l,r.rotation[1])),h=o(i,f$(l,r.rotation[2]));c.rotation.set(d,u,h),c.position.x=n.size[0]*s+o(i,f$(l,r.position[0])),c.position.y=-n.size[1]*e+o(i,f$(l,r.position[1])),c.position.z=-n.size[2]*t+o(i,f$(l,r.position[2]))}}_updateToObject(e){var t,i;if("toObject"!==e.type)throw new Error;let{toObject:n}=e,r=new TC(n.rotation[0],n.rotation[1],n.rotation[2]),a=null!==(t=e.randomnessObject)&&void 0!==t?t:UV.defaultData([1,1,1]).randomnessObject,o=this.getRandom(a),s=p$(a.strength,this.parameters.randomness);if(!n.object){for(let[,e]of this.children.entries())e.position.set(0,0,0),e.scale.setScalar(1),e.rotation.set(0,0,0);return void(this.objectForSample=void 0)}if(!this.objectForSample)return;if(this.objectForSample instanceof R$){if(null===(i=this.objectForSample.font)||void 0===i||!i.isLoaded||void 0===this.objectForSample.geometry.attributes.position)return void(this._pendingMediaLoad=!0);this._pendingMediaLoad=!1}if(void 0===this.objectForSample.geometry&&this.objectForSample.isAncestorOf(this.object.uuid))return void console.warn('Oh no! The object "'.concat(this.object.name,'" (').concat(this.object.uuid,") seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead."));let l=this.getSubdivData();if(l.length>0){let e=Math.round(l.length*n.count/100);this._updateCount(e)}else{let e=this.objectForSample.geometry.getAttribute("position");if(!e||isNaN(e.count)||0===e.count)return void console.warn('Oh no! The object "'.concat(this.object.name,'" (').concat(this.object.uuid,') cannot be cloned on the surface of "').concat(this.objectForSample.name,'" (').concat(this.objectForSample.uuid,") because the latter does not have a valid geometry."))}this.objectForSample.updateMatrixWorld();let c=new CG(this.objectForSample).build(),d=u$[n.axis],u=this.children;c.setRandomGenerator((0,pG.default)(this.object.uuid+n.seed));for(let[h,p]of u.entries()){let e=h*(a.freqScale/10)+a.movement,t=o.noise(e,e,e),i=h+1,u=s(i,f$(t,a.rotation[0])),f=s(i,f$(t,a.rotation[1])),m=s(i,f$(t,a.rotation[2]));"random"===n.spreadType?c.sample(j$,W$):(l.length&&(j$.fromArray(l[h].pos),W$.fromArray(l[h].norm)),this.objectForSample instanceof d$&&j$.applyMatrix4(N$.copy(this.objectForSample.matrixWorld).invert())),j$.applyMatrix4(this.object.hiddenMatrix.clone().invert()),p.position.copy(j$),U$.fromArray(d);let g="normal"===n.align?W$:this.object.getWorldDirection(G$),v=V$.fromArray(n.position);V$.x+=s(i,f$(t,a.position[0])),V$.y+=s(i,f$(t,a.position[1])),V$.z+=s(i,f$(t,a.position[2]));let y=Math.acos(g.dot(U$)),b=H$.crossVectors(U$,g).normalize(),x=F$.makeRotationAxis(b,y),w=g.clone().cross(this.object.up).normalize(),S=w.clone().cross(g).normalize(),_=(new yC).makeBasis(w,g,S),C=new j_(U$.y,U$.z,U$.x).normalize(),E=C.clone().cross(U$).normalize(),A=(new yC).makeBasis(C,U$,E).invert(),M=(new yC).multiplyMatrices(_,A);p.rotation.setFromRotationMatrix(M),v.applyMatrix4(x),p.position.add(v),p.rotation.x=p.rotation.x+r.x+u,p.rotation.y=p.rotation.y+r.y+f,p.rotation.z=p.rotation.z+r.z+m,p.scale.setScalar(1),p.scale.x=p.scale.x+n.scale[0]+s(i,f$(t,a.scale[0]))||z$,p.scale.y=p.scale.y+n.scale[1]+s(i,f$(t,a.scale[1]))||z$,p.scale.z=p.scale.z+n.scale[2]+s(i,f$(t,a.scale[2]))||z$,p.scale.multiply(this.object.scale),p.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType,t=new Map,i=(e,i)=>{let n=Math.round(1e4*e[0])+"_"+Math.round(1e4*e[1])+"_"+Math.round(1e4*e[2]),r=t.get(n);r?(r.pos[0]+=e[0],r.pos[1]+=e[1],r.pos[2]+=e[2],r.norm[0]+=i[0],r.norm[1]+=i[1],r.norm[2]+=i[2],r.count+=1):t.set(n,{pos:[...e],norm:[...i],count:1})};if("random"===e)return[];if(this.objectForSample instanceof d$){let t=this.objectForSample,n=h$[e],r=k$[n],a=O$[n],o=I$[n],s=r(t.subdivPointerNew);for(let e=0;e<=s-1;e++){let n=a(t.subdivPointerNew,e),r=o(t.subdivPointerNew,e);L$.fromArray(n).applyMatrix4(t.matrixWorld),B$.fromArray(r),i(L$.toArray(),B$.toArray())}}else(this.objectForSample.geometry.index?function(e){let t=[];for(let i=0;i<=e.index.count;i++)if(w$.fromArray(e.index.array,3*i),x$.setFromAttributeAndIndices(e.attributes.position,w$.x,w$.y,w$.z),x$.getNormal(S$),x$.getMidpoint(_$),!(isNaN(_$.x)||isNaN(_$.y)||isNaN(_$.z))){let{a:e,b:i,c:n}=x$,r=e.toArray(),a=i.toArray(),o=n.toArray(),s=e.distanceTo(i),l=i.distanceTo(n),c=n.distanceTo(e),d=b$(r,a),u=b$(a,o),h=b$(o,r),p=[s,l,c],f=Math.max(...p),m=p.filter(e=>Math.round(e)===Math.round(f)).length>1,g=[],v=x$.getMidpoint(_$).toArray();f===s&&!m&&(g=[u,h,h],v=d),f===l&&!m&&(g=[d,h,h],v=u),f===c&&!m&&(g=[d,u,u],v=h),m&&(g=[d,u,h]),t.push({vertices:[r,a,o],faceCenters:g,midpoint:v,norm:x$.getNormal(S$).toArray()})}return t}(this.objectForSample.geometry):function(e){let t=[],{position:i}=e.attributes;for(let n=0;n<i.count;n++){x$.setFromAttributeAndIndices(i,3*n,3*n+1,3*n+2),x$.getNormal(S$),x$.getMidpoint(_$);let e=x$.a.toArray(),r=x$.b.toArray(),a=x$.c.toArray();t.push({vertices:[e,r,a],faceCenters:[b$(e,r),b$(r,a),b$(a,e)],midpoint:_$.toArray(),norm:S$.toArray()})}return t}(this.objectForSample.geometry)).forEach((t,n)=>{"polygon_center"===e&&i(t.midpoint,t.norm),"vertex"===e&&(i(t.vertices[0],t.norm),i(t.vertices[1],t.norm),i(t.vertices[2],t.norm)),"edge"===e&&(i(t.faceCenters[0],t.norm),i(t.faceCenters[1],t.norm),i(t.faceCenters[2],t.norm))});let n=Array.from(t.values());for(let r of n)r.pos[0]/=r.count,r.pos[1]/=r.count,r.pos[2]/=r.count,r.norm[0]/=r.count,r.norm[1]/=r.count,r.norm[2]/=r.count;return n}updateState(e,t){var i;if(this.parameters=lB(e),"toObject"!==this.parameters.type)(null===this.parent||this.parent!==this.object)&&(this.removeFromParent(),null!==(i=this.object.parent)&&void 0!==i&&i.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(null===this.parent||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let e=t.find(this.parameters.toObject.object);this.objectForSample=e instanceof CQ?e:void 0,this.matrix=new yC,this.hiddenMatrix=new yC,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,e&&e.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},Y$=e=>{var t;return(t=class extends e{}).geometryHelper=new kE(30,30,30),t},Q$=new vC,K$=new cC,Z$=new yC,J$=function(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,o=t,s=a.matrixWorld;if(null===o.boundingSphere&&o.computeBoundingSphere(),K$.copy(o.boundingSphere),K$.applyMatrix4(s),!1===i.ray.intersectsSphere(K$)||(Z$.copy(s).invert(),Q$.copy(i.ray).applyMatrix4(Z$),null!==o.boundingBox&&!1===Q$.intersectsBox(o.boundingBox)))return;let l,c,d,u,h,p,f=o.index,m=o.attributes.position,g=o.drawRange;if(!1===r){for(h=Math.max(0,g.start),p=Math.min(f.count,g.start+g.count);h<p;h+=3)if(c=f.getX(h),d=f.getX(h+1),u=f.getX(h+2),l=v(e,i,Q$,m,c,d,u),l)return l.faceIndex=Math.floor(h/3),void n.push(l)}else{let t=o.attributes.position,r=new j_,s=new j_,l=new j_,c=new j_,d=2,u=1/((a.scale.x+a.scale.y+a.scale.z)/3),h=u*u;for(let o=Math.max(0,g.start),p=Math.min(t.count,g.start+g.count)-1;o<p;o+=d){if(r.fromBufferAttribute(t,o),s.fromBufferAttribute(t,o+1),Q$.distanceSqToSegment(r,s,c,l)>h)continue;c.applyMatrix4(a.matrixWorld);let d=i.ray.origin.distanceTo(c);d<i.near||d>i.far||n.push({distance:d,point:l.clone().applyMatrix4(a.matrixWorld),object:e})}}function v(e,t,i,n,r,a,o){let s=new j_,l=new j_,c=new j_,d=new j_,u=new j_;if(s.fromBufferAttribute(n,r),l.fromBufferAttribute(n,a),c.fromBufferAttribute(n,o),null===i.intersectTriangle(s,l,c,!1,d))return null;u.copy(d),u.applyMatrix4(e.matrixWorld);let h=t.ray.origin.distanceTo(u);return h<t.near||h>t.far?null:{faceIndex:1,distance:h,point:u.clone(),object:e}}},$$=new j_,e0=new FE,t0=class extends iP{constructor(e){let t=new vE,i=new XT({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],r=[],a={},o=new D_(15711266),s=new D_(15711266),l=new D_(2857471);function c(e,t,i){d(e,i),d(t,i)}function d(e,t){n.push(0,0,0),r.push(t.r,t.g,t.b),void 0===a[e]&&(a[e]=[]),a[e].push(n.length/3-1)}c("n1","n2",o),c("n2","n4",o),c("n4","n3",o),c("n3","n1",o),c("f1","f2",o),c("f2","f4",o),c("f4","f3",o),c("f3","f1",o),c("n1","f1",o),c("n2","f2",o),c("n3","f3",o),c("n4","f4",o),c("p","n1",s),c("p","n2",s),c("p","n3",s),c("p","n4",s),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l),t.setAttribute("position",new cE(n,3)),t.setAttribute("color",new cE(r,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}update(){let e=this.geometry,t=this.pointMap;e0.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let i=.8;i0("n1",t,e,e0,-1,-1,i),i0("n2",t,e,e0,1,-1,i),i0("n3",t,e,e0,-1,1,i),i0("n4",t,e,e0,1,1,i);let n=i;i0("f1",t,e,e0,-1,-1,n),i0("f2",t,e,e0,1,-1,n),i0("f3",t,e,e0,-1,1,n),i0("f4",t,e,e0,1,1,n);let r=n;i0("u1",t,e,e0,.35,1.1,r),i0("u2",t,e,e0,-.35,1.1,r),i0("u3",t,e,e0,0,1.55,r),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function i0(e,t,i,n,r,a,o){$$.set(r,a,o).unproject(n);let s=t[e];if(void 0!==s){let e=i.getAttribute("position");for(let t=0,i=s.length;t<i;t++)e.setXYZ(s[t],$$.x,$$.y,$$.z)}}var n0,r0=class extends(Y$(t0)){constructor(e){super(e),this.object=e,this.object=e,this.name="CombinedCameraHelper: ".concat(e.uuid)}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){J$(this.object,this.geometry,e,t,!0)}};(e=>{e.is=e=>"objectHelper"in e})(n0||(n0={}));var a0=(e,t)=>class extends(JG(e)){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(e,t){this.objectHelper.raycast(e,t)}showGizmos(){for(let e in this.gizmos){let t=this.gizmos[e];t instanceof FO&&(t.visible=!0)}}updateEntityBoxSize(e,t){this.objectHelper.visible&&this.geometryHelper instanceof kE?(e.setScalar(0),t.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(e,t)}hideGizmos(){for(let e in this.gizmos){let t=this.gizmos[e];t instanceof FO&&(t.visible=!1)}}},o0=new j_,s0=new j_,l0=new V_,c0=new j_,d0=new j_,u0=new j_,h0=class extends(a0(FE,r0)){constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c(c({},Bj.defaultData),{},{name:""});super(),this._cameraType="OrthographicCamera",this.targetOffset=FV.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,t),this.previousProjectionMatrix=new yC,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let i=this.width,n=this.height;this.orthoCamera=new uA(-.5*i,.5*i,.5*n,-.5*n,-5e4,1e4),this.perspCamera=new UE(45,i/n,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return"PerspectiveCamera"===this.cameraType}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,t){"PerspectiveCamera"===e?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&("PerspectiveCamera"===e?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){"PerspectiveCamera"===e?this.toPerspective():"OrthographicCamera"===e&&this.toOrthographic()}get near(){return"PerspectiveCamera"===this._cameraType?this.perspCamera.near:this.orthoCamera.near}set near(e){"PerspectiveCamera"===this._cameraType?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return"PerspectiveCamera"===this._cameraType?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&("PerspectiveCamera"===this._cameraType?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,t,i){"number"==typeof e&&(e=new j_(e,t,i)),super.lookAt(e),this.getWorldPosition(o0),this.targetOffset=o0.distanceTo(e)}getTarget(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new j_;return this.getWorldDirection(s0),this.getWorldPosition(o0),s0.multiplyScalar(this.targetOffset),e.copy(o0).add(s0),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(o0),o0.distanceTo(e)}updateUp(){this.getWorldQuaternion(l0),c0.set(0,0,1).applyQuaternion(l0),d0.copy(WC.DEFAULT_UP),this.isUpVectorFlipped&&d0.negate(),d0.applyQuaternion(l0),u0.copy(WC.DEFAULT_UP).projectOnPlane(c0),this.angleOffsetFromUp=u0.angleTo(d0),this.angleOffsetFromUp*=u0.cross(d0).dot(c0)>=0?1:-1}updateTransformState(e,t){let i=super.updateTransformState(e,t);return void 0!==e.isUpVectorFlipped&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),i}getViewFrontToObject(e){let t=e.getWorldPosition(new j_),i=e.getWorldDirection(new j_).multiplyScalar(this.targetOffset);return{position:t.clone().add(i),target:t}}getViewToTarget(e){let t=this.getWorldDirection(new j_).multiplyScalar(this.targetOffset);return{position:e.clone().sub(t),target:e}}getViewToObject(e){let t=new j_;e.getWorldPosition(t);return this.getViewToTarget(t)}setViewplaneSize(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.aspect=e/t,i){let i=e>t?this.aspect:1,n=e>t?1:this.aspect;this.left=-395*i,this.right=395*i,this.top=1/n*395,this.bottom=1/n*-395}else this.left=.5*-e,this.right=.5*e,this.top=.5*t,this.bottom=.5*-t;this.updateProjectionMatrix()}copyViewPlaneSize(e){this.aspect=e.aspect,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,i,n,r,a){"PerspectiveCamera"===this._cameraType?this.perspCamera.setViewOffset(e,t,i,n,r,a):this.orthoCamera.setViewOffset(e,t,i,n,r,a)}clearViewOffset(){"PerspectiveCamera"===this._cameraType?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){"PerspectiveCamera"===this._cameraType?this.toPerspective():"OrthographicCamera"===this._cameraType&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=null===e.view?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return GB(t,e)}updateCameraSubtype(e,t){let i="perspective"===e?"PerspectiveCamera":"OrthographicCamera";void 0!==t.zoom&&this.setZoom(i,t.zoom),void 0!==t.near&&this.setNear(i,t.near),void 0!==t.fov&&"PerspectiveCamera"===i&&(this.fov=t.fov)}updateState(e,t){this.updateCameraState(e,t)}updateCameraState(e,t){this.updateState_Entity(e,t),void 0!==e.far&&(this.far=e.far),void 0!==e.orthographic&&this.updateCameraSubtype("orthographic",e.orthographic),void 0!==e.perspective&&this.updateCameraSubtype("perspective",e.perspective),void 0!==e.type&&(this.cameraType=e.type),void 0!==e.up&&this.up.fromArray(e.up),void 0!==e.targetOffset&&(this.targetOffset=e.targetOffset),void 0!==e.isUpVectorFlipped&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),1===e.path.length&&0===e.type&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return c(c(c({},super.toState(e)),this.toCameraState(e)),{},{type:this.cameraType})}},p0=new yC,f0=new yC;function m0(e){let t=!1;return e.scene.objects.traverse((e,i)=>{var n;"BooleanGeometry"===(null===(n=i.geometry)||void 0===n?void 0:n.type)&&(t=!0)}),t}var g0,v0=class extends JJ{constructor(e,t,i){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new vE,this.onAfterRender=(e,t,i,n,r,a)=>{super.onAfterRender(e,t,i,n,r,a),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){var e;return null!==(e=this.data.geometry.phongAngle)&&void 0!==e?e:45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),1===e.path.length&&"geometry"===e.path[0]&&0===e.type&&void 0!==e.props.operation&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(-1!==this.booleanMeshSetAddress&&!e)return;for(let a=0;a<this.children.length;a++){let i=this.children[a];i instanceof v0&&!0===i.dataPatched.visible&&i.recomputeBoolean(!0===e,t)}this.meshSetAddresses=[];for(let a=0;a<this.children.length;a++){var i;let r=this.children[a];if(r instanceof CQ&&!0===r.dataPatched.visible&&(null===(i=r.geometry.attributes.position)||void 0===i?void 0:i.count)>0&&r.geometry.drawRange.count>0&&0!==r.booleanMeshSetAddress){p0.multiplyMatrices(r.hiddenMatrix,r.matrix);try{if(-1===r.booleanMeshSetAddress){var n;if((null!==(n=r.geometry.index)&&void 0!==n?n:r.geometry.getAttribute("position")).count/3<15e5&&(r.booleanMeshSetAddress=tQ.getMeshSet(r.geometry,!0===e,t)),-1===r.booleanMeshSetAddress)return;tQ.transformMeshSet(r.booleanMeshSetAddress,p0),r.booleanMatrixInvOld.copy(p0).invert(),r.booleanWasTransformed=!1}else r instanceof v0&&!0===r.needsTransformForDownstream?(tQ.transformMeshSet(r.booleanMeshSetAddress,p0),r.needsTransformForDownstream=!1):!0===r.booleanWasTransformed&&(tQ.transformMeshSet(r.booleanMeshSetAddress,f0.multiplyMatrices(p0,r.booleanMatrixInvOld)),r.booleanMatrixInvOld.copy(p0).invert(),r.booleanWasTransformed=!1)}catch(wV){console.error(wV),r.booleanMeshSetAddress=0,r.geometry.userData.booleanOperationDidFail=!0;continue}!1===tQ.hasOpenEdges(r.booleanMeshSetAddress)||a===this.children.length-1&&2===this.booleanOp?(this.meshSetAddresses.push(r.booleanMeshSetAddress),r.geometry.userData.booleanOperationDidFail=!1):r.geometry.userData.booleanOperationDidFail="openEdges"}}if(0===this.meshSetAddresses.length)return this.geometry.setAttribute("position",new cE([],0)),void this.geometry.setDrawRange(0,0);if(!0===e)return tQ.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let r=this.geometry;r.dispose(),this.geometry=new vE,this.geometry.userData=r.userData,this.geometry.boundingSphere=r.boundingSphere;try{this.booleanMeshSetAddress=tQ.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(BV){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0,console.error(BV)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,a$(this),o$(this)}dispose(){super.dispose(),this.geometry.dispose()}};(e=>{e.is=function(e){return PG.is(e)&&e instanceof ND}})(g0||(g0={}));var y0=(e,t)=>class extends(a0(e,t)){updateState_Light(e,t){this.updateState_Entity(e,t),void 0!==e.color&&(this.color=t.shared.color(e.color)),void 0!==e.intensity&&(this.intensity=e.intensity),void 0!==e.depth&&(this.shadow.camera.far=e.depth,this.shadow.needsUpdate=!0),void 0!==e.shadows&&(this.castShadow=e.shadows)}},b0=e=>e instanceof CQ,x0=e=>null!==e&&e instanceof v0,w0=e=>n0.is(e),S0=new j_(1,1,1),_0=new j_,C0=new j_,E0=new V_,A0=class extends(Y$(UO)){constructor(e){super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:15),this.object=e,this.dummy=new ST,this.object.updateMatrixWorld(),this.name="EmptyObjectHelper: ".concat(e.uuid),this.matrix=this.dummy.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(e,t){J$(this.object,A0.geometryHelper,e,t,!1,this.dummy)}update(){}updateMatrix(){}updateMatrixWorld(e){this.object.matrixWorld.decompose(_0,E0,C0),this.matrix.compose(_0,E0,S0),super.updateMatrixWorld(e)}updateWorldMatrix(e,t){}},M0=class extends(a0(ST,A0)){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t),"buffer"in e&&1===Object.keys(e).length&&t.scene.reloadSplats()}},T0=class extends(a0(ST,A0)){constructor(e,t,i){super(),this.super_Entity(e,t),this.context=i,this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},P0=0,D0=1,O0="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",I0=class extends NE{constructor(){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super({name:"BokehMaterial",defines:{PASS:arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"2":"1"},uniforms:{kernel64:new yO(null),kernel16:new yO(null),inputBuffer:new yO(null),cocBuffer:new yO(null),texelSize:new yO(new p_),scale:new yO(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;uniform vec4 kernel64[32];varying vec2 vUv;void main(){\n#ifdef FOREGROUND\nvec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;\n#else\nfloat CoC=texture2D(cocBuffer,vUv).g*scale;\n#endif\nif(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{\n#ifdef FOREGROUND\nvec2 step=texelSize*max(CoC,CoCNearFar.g*scale);\n#else\nvec2 step=texelSize*CoC;\n#endif\nvec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;}}",vertexShader:O0}),this.toneMapped=!1,e&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=new Float32Array(128),t=new Float32Array(32),i=0,n=0;for(let o=0;o<80;++o){let r=2.39996323*o,a=Math.sqrt(o)/Math.sqrt(80),s=a*Math.cos(r),l=a*Math.sin(r);o%5===0?(t[n++]=s,t[n++]=l):(e[i++]=s,e[i++]=l)}let r=[],a=[];for(let o=0;o<128;)r.push(new B_(e[o++],e[o++],e[o++],e[o++]));for(let o=0;o<32;)a.push(new B_(t[o++],t[o++],t[o++],t[o++]));this.uniforms.kernel64.value=r,this.uniforms.kernel16.value=a}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function k0(e,t,i){return e*(t-i)-t}function R0(e,t,i){return Math.min(Math.max((e+t)/(t-i),0),1)}var z0=class extends NE{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new yO(null),focusDistance:new yO(0),focusRange:new yO(0),cameraNear:new yO(.3),cameraFar:new yO(1e3)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#include <packing>\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}void main(){float depth=readDepth(vUv);\n#ifdef PERSPECTIVE_CAMERA\nfloat viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\n#else\nfloat linearDepth=depth;\n#endif\nfloat signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}",vertexShader:O0}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GS;this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-k0(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=R0(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-k0(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=R0(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof UE?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},L0=class extends NE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new p_;super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new yO(null),texelSize:new yO(new p_),halfTexelSize:new yO(new p_),kernel:new yO(0),scale:new yO(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#include <dithering_pars_fragment>\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nvarying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;\n#include <encodings_fragment>\n#include <dithering_fragment>\n}",vertexShader:"uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let i=this.uniforms;i.texelSize.value.set(1/e,1/t),i.halfTexelSize.value.copy(i.texelSize.value).multiplyScalar(.5)}},B0=class extends NE{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new yO(null),opacity:new yO(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;\n#include <encodings_fragment>\n}",vertexShader:O0}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},N0={DEPTH:0,LUMA:1,COLOR:2},F0={DISABLED:0,DEPTH:1,CUSTOM:2},U0=class extends NE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new p_,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N0.COLOR;super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:Uw.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new yO(null),depthBuffer:new yO(null),predicationBuffer:new yO(null),texelSize:new yO(e)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#if EDGE_DETECTION_MODE != 0\nvarying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;\n#endif\n#if EDGE_DETECTION_MODE == 1\n#include <common>\n#endif\n#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nfloat readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}\n#elif PREDICATION_MODE == 2\nuniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}\n#endif\n#if PREDICATION_MODE != 0\nvec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}\n#endif\n#if EDGE_DETECTION_MODE != 0\nuniform sampler2D inputBuffer;\n#endif\nvoid main(){\n#if EDGE_DETECTION_MODE == 0\nconst vec2 threshold=vec2(DEPTH_THRESHOLD);\n#elif PREDICATION_MODE != 0\nvec2 threshold=calculatePredicatedThreshold();\n#else\nconst vec2 threshold=vec2(EDGE_THRESHOLD);\n#endif\n#if EDGE_DETECTION_MODE == 0\nvec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);\n#elif EDGE_DETECTION_MODE == 1\nfloat l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);\n#elif EDGE_DETECTION_MODE == 2\nvec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);\n#endif\n}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;\n#if EDGE_DETECTION_MODE != 0\nvarying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;\n#endif\nvoid main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);\n#if EDGE_DETECTION_MODE != 0\nvUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);\n#endif\ngl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GS;this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(.1*e).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},V0={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},j0=class extends NE{constructor(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super({name:"EffectMaterial",defines:{THREE_REVISION:Uw.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new yO(null),depthBuffer:new yO(null),resolution:new yO(new p_),texelSize:new yO(new p_),cameraNear:new yO(.3),cameraFar:new yO(1e3),aspect:new yO(1),time:new yO(0)},blending:0,depthWrite:!1,depthTest:!1,dithering:r}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),i&&this.setUniforms(i),this.adoptCameraSettings(n)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GS;this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader="#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#define packFloatToRGBA(v) packDepthToRGBA(v)\n#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#if THREE_REVISION >= 137\nvec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}\n#endif\nfloat readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}float getViewZ(const in float depth){\n#ifdef PERSPECTIVE_CAMERA\nreturn perspectiveDepthToViewZ(depth,cameraNear,cameraFar);\n#else\nreturn orthographicDepthToViewZ(depth,cameraNear,cameraFar);\n#endif\n}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;\n#ifdef ENCODE_OUTPUT\n#include <encodings_fragment>\n#endif\n#include <dithering_fragment>\n}".replace(V0.FRAGMENT_HEAD,e.get(V0.FRAGMENT_HEAD)).replace(V0.FRAGMENT_MAIN_UV,e.get(V0.FRAGMENT_MAIN_UV)).replace(V0.FRAGMENT_MAIN_IMAGE,e.get(V0.FRAGMENT_MAIN_IMAGE)),this.vertexShader="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}".replace(V0.VERTEX_HEAD,e.get(V0.VERTEX_HEAD)).replace(V0.VERTEX_MAIN_SUPPORT,e.get(V0.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return void 0!==this.defines.ENCODE_OUTPUT}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof UE?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let i=this.uniforms;i.resolution.value.set(e,t),i.texelSize.value.set(1/e,1/t),i.aspect.value=e/t}static get Section(){return V0}},W0=class extends NE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super({name:"LuminanceMaterial",defines:{THREE_REVISION:Uw.replace(/\D+/g,"")},uniforms:{inputBuffer:new yO(null),threshold:new yO(0),smoothing:new yO(1),range:new yO(null)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef RANGE\nuniform vec2 range;\n#elif defined(THRESHOLD)\nuniform float threshold;uniform float smoothing;\n#endif\nvarying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);\n#ifdef RANGE\nfloat low=step(range.x,l);float high=step(l,range.y);l*=low*high;\n#elif defined(THRESHOLD)\nl=smoothstep(threshold,threshold+smoothing,l);\n#endif\n#ifdef COLOR\ngl_FragColor=vec4(texel.rgb*l,l);\n#else\ngl_FragColor=vec4(l);\n#endif\n}",vertexShader:O0}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return void 0!==this.defines.COLOR}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return null!==this.luminanceRange}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){null!==e?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},H0=0,G0=1,q0=class extends NE{constructor(){super({name:"MaskMaterial",uniforms:{maskTexture:new yO(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),inputBuffer:new yO(null),strength:new yO(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef MASK_PRECISION_HIGH\nuniform mediump sampler2D maskTexture;\n#else\nuniform lowp sampler2D maskTexture;\n#endif\n#if MASK_FUNCTION != 0\nuniform float strength;\n#endif\nvarying vec2 vUv;void main(){\n#if COLOR_CHANNEL == 0\nfloat mask=texture2D(maskTexture,vUv).r;\n#elif COLOR_CHANNEL == 1\nfloat mask=texture2D(maskTexture,vUv).g;\n#elif COLOR_CHANNEL == 2\nfloat mask=texture2D(maskTexture,vUv).b;\n#else\nfloat mask=texture2D(maskTexture,vUv).a;\n#endif\n#if MASK_FUNCTION == 0\n#ifdef INVERTED\nmask=step(mask,0.0);\n#else\nmask=1.0-step(mask,0.0);\n#endif\n#else\nmask=clamp(mask*strength,0.0,1.0);\n#ifdef INVERTED\nmask=1.0-mask;\n#endif\n#endif\n#if MASK_FUNCTION == 2\ngl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);\n#else\ngl_FragColor=mask*texture2D(inputBuffer,vUv);\n#endif\n}",vertexShader:O0}),this.toneMapped=!1,this.setColorChannel(P0),this.setMaskFunction(H0)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==xS&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return void 0!==this.defines.INVERTED}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},X0=class extends NE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new p_,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new p_;super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new yO(null),searchTexture:new yO(null),areaTexture:new yO(null),resolution:new yO(t),texelSize:new yO(e)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)\n#if __VERSION__ < 300\n#define round(v) floor(v + 0.5)\n#endif\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){\n#if !defined(DISABLE_CORNER_DETECTION)\nvec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);\n#endif\n}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){\n#if !defined(DISABLE_CORNER_DETECTION)\nvec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);\n#endif\n}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){\n#if !defined(DISABLE_DIAG_DETECTION)\nweights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){\n#endif\nvec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);\n#if !defined(DISABLE_DIAG_DETECTION)\n}else{e.r=0.0;}\n#endif\n}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}",vertexShader:"uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return void 0===this.defines.DISABLE_DIAG_DETECTION}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return void 0===this.defines.DISABLE_CORNER_DETECTION}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let i=this.uniforms;i.texelSize.value.set(1/e,1/t),i.resolution.value.set(e,t)}},Y0=new FE,Q0=null;var K0=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Pass",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new OT,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Y0;this.name=e,this.renderer=null,this.scene=t,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();null!==t&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return null!==this.screen?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;null!==t?t.material=e:(t=new OE(function(){if(null===Q0){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);void 0!==(Q0=new vE).setAttribute?(Q0.setAttribute("position",new oE(e,3)),Q0.setAttribute("uv",new oE(t,2))):(Q0.addAttribute("position",new oE(e,3)),Q0.addAttribute("uv",new oE(t,2)))}return Q0}(),e),t.frustumCulled=!1,null===this.scene&&(this.scene=new OT),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e){}render(e,t,i,n,r){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,i){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(null!==t&&"object"==typeof t&&"function"==typeof t.dispose){if(t instanceof OT||t===this.renderer)continue;this[e].dispose()}}}},Z0=class extends K0{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super("CopyPass"),this.fullscreenMaterial=new B0,this.needsSwap=!1,this.renderTarget=e,void 0===e&&(this.renderTarget=new N_(1,1,{minFilter:vS,magFilter:vS,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,i,n,r){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,i){void 0!==i&&(this.renderTarget.texture.type=i,i!==xS?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===HS&&(this.renderTarget.texture.encoding=HS))}},J0=class extends K0{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,i,n,r){let a=e.state.buffers.stencil;a.setLocked(!1),a.setTest(!1)}},$0=new D_,e1=class extends K0{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=i,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,i){this.color=e,this.depth=t,this.stencil=i}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,i,n,r){let a=this.overrideClearColor,o=this.overrideClearAlpha,s=e.getClearAlpha(),l=null!==a,c=o>=0;l?($0.copy(e.getClearColor($0)),e.setClearColor(a,c?o:s)):c&&e.setClearAlpha(o),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor($0,s):c&&e.setClearAlpha(s)}},t1=-1,i1=class extends JS{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.resizable=e,this.base=new p_(1,1),this.preferred=new p_(t,i),this.target=this.preferred,this.s=n}get width(){let e,{base:t,preferred:i,scale:n}=this;return e=i.width!==t1?i.width:i.height!==t1?Math.round(i.height*(t.width/Math.max(t.height,1))):Math.round(t.width*n),e}set width(e){this.preferredWidth=e}get height(){let e,{base:t,preferred:i,scale:n}=this;return e=i.height!==t1?i.height:i.width!==t1?Math.round(i.width/Math.max(t.width/Math.max(t.height,1),1)):Math.round(t.height*n),e}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(t1),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return t1}},n1=!1,r1=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case 2:t=this.materialsFlatShadedDoubleSide;break;case 1:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded}else switch(e.material.side){case 2:t=this.materialsDoubleSide;break;case 1:t=this.materialsBackSide;break;default:t=this.materials}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,null!==e){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let i of t)i.uniforms=Object.assign({},e.uniforms),i.side=0;t[2].skinning=!0,this.materialsBackSide=t.map(t=>{let i=t.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=1,i}),this.materialsDoubleSide=t.map(t=>{let i=t.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=2,i}),this.materialsFlatShaded=t.map(t=>{let i=t.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=t.map(t=>{let i=t.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=1,i}),this.materialsFlatShadedDoubleSide=t.map(t=>{let i=t.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=2,i})}}render(e,t,i){let n=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,n1){let n=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,i);for(let e of n)e[0].material=e[1];this.meshCount!==n.size&&n.clear()}else{let n=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,i),t.overrideMaterial=n}e.shadowMap.enabled=n}disposeMaterials(){if(null!==this.material){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return n1}static set workaroundEnabled(e){n1=e}},a1=class extends K0{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new e1,this.overrideMaterialManager=null===i?null:new r1(i),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return null!==e?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;null!==e?null!==t?t.setMaterial(e):this.overrideMaterialManager=new r1(e):null!==t&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,i,n,r){let a=this.scene,o=this.camera,s=this.selection,l=o.layers.mask,c=a.background,d=e.shadowMap.autoUpdate,u=this.renderToScreen?null:t;null!==s&&o.layers.set(s.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||null!==this.clearPass.overrideClearColor)&&(a.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(u),null!==this.overrideMaterialManager?this.overrideMaterialManager.render(e,a,o):e.render(a,o),o.layers.mask=l,a.background=c,e.shadowMap.autoUpdate=d}},o1=class extends K0{constructor(e,t){let{resolutionScale:i=1,width:n=i1.AUTO_SIZE,height:r=i1.AUTO_SIZE,renderTarget:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super("DepthPass"),this.needsSwap=!1,this.renderPass=new a1(e,t,new mT({depthPacking:3201}));let o=this.renderPass;o.skipShadowMapUpdate=!0,o.ignoreBackground=!0;let s=o.getClearPass();s.overrideClearColor=new D_(16777215),s.overrideClearAlpha=1,this.renderTarget=a,void 0===this.renderTarget&&(this.renderTarget=new N_(1,1,{minFilter:fS,magFilter:fS,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new i1(this,n,r,i);l.addEventListener("change",e=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,i,n,r){let a=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,a)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height)}},s1=(new Float32Array([255/256/256**3,255/256/65536,255/256/256,255/256]),{SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18}),l1=new Map([[s1.SKIP,null],[s1.ADD,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}"],[s1.ALPHA,"vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}"],[s1.AVERAGE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}"],[s1.COLOR_BURN,"float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[s1.COLOR_DODGE,"float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[s1.DARKEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}"],[s1.DIFFERENCE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}"],[s1.EXCLUSION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}"],[s1.LIGHTEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}"],[s1.MULTIPLY,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}"],[s1.DIVIDE,"float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[s1.NEGATION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}"],[s1.NORMAL,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}"],[s1.OVERLAY,"float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[s1.REFLECT,"float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[s1.SCREEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}"],[s1.SOFT_LIGHT,"float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[s1.SUBTRACT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}"]]),c1=class extends JS{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.f=e,this.opacity=new yO(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return l1.get(this.blendFunction)}},d1={NONE:0,DEPTH:1,CONVOLUTION:2},u1=class extends JS{constructor(e,t){let{attributes:i=d1.NONE,blendFunction:n=s1.SCREEN,defines:r=new Map,uniforms:a=new Map,extensions:o=null,vertexShader:s=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.name=e,this.renderer=null,this.attributes=i,this.fragmentShader=t,this.vertexShader=s,this.defines=r,this.uniforms=a,this.extensions=o,this.blendMode=new c1(n),this.blendMode.addEventListener("change",e=>this.setChanged())}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e){}update(e,t,i){}setSize(e,t){}initialize(e,t,i){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(null!==t&&"object"==typeof t&&"function"==typeof t.dispose){if(t instanceof OT||t===this.renderer)continue;this[e].dispose()}}}};function h1(e,t,i){for(let n of t){let t="$1"+e+n.charAt(0).toUpperCase()+n.slice(1),r=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(let e of i.entries())null!==e[1]&&i.set(e[0],e[1].replace(r,t))}}function p1(e,t,i,n,r,a,o){let s=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=void 0!==s.get("fragment")&&/mainImage/.test(s.get("fragment")),c=void 0!==s.get("fragment")&&/mainUv/.test(s.get("fragment")),d=[],u=[],h=!1,p=!1;if(void 0===s.get("fragment"))console.error("Missing fragment shader",t);else if(c&&0!==(o&d1.CONVOLUTION))console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(l||c){let f=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,m=j0.Section;if(c){let t="\t".concat(e,"MainUv(UV);\n");i.set(m.FRAGMENT_MAIN_UV,i.get(m.FRAGMENT_MAIN_UV)+t),h=!0}if(null!==s.get("vertex")&&/mainSupport/.test(s.get("vertex"))){let t="\t".concat(e,"MainSupport(");t+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(s.get("vertex"))?"vUv);\n":");\n",i.set(m.VERTEX_MAIN_SUPPORT,i.get(m.VERTEX_MAIN_SUPPORT)+t),d=d.concat([...s.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(e=>e[1])),u=u.concat(d).concat([...s.get("vertex").matchAll(f)].map(e=>e[1]))}u=u.concat([...s.get("fragment").matchAll(f)].map(e=>e[1])),u=u.concat([...t.defines.keys()].map(e=>e.replace(/\([\w\s,]*\)/g,""))),u=u.concat([...t.uniforms.keys()]),t.uniforms.forEach((t,i)=>a.set(e+i.charAt(0).toUpperCase()+i.slice(1),t)),t.defines.forEach((t,i)=>r.set(e+i.charAt(0).toUpperCase()+i.slice(1),t)),h1(e,u,r),h1(e,u,s);let g=t.blendMode;if(n.set(g.blendFunction,g),l){let t=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,n="".concat(e,"MainImage(color0, UV, ");0!==(o&d1.DEPTH)&&t.test(s.get("fragment"))&&(n+="depth, ",p=!0),n+="color1);\n\t";let r=e+"BlendOpacity";a.set(r,g.opacity),n+="color0 = blend".concat(g.blendFunction,"(color0, color1, ").concat(r,");\n\n\t"),i.set(m.FRAGMENT_MAIN_IMAGE,i.get(m.FRAGMENT_MAIN_IMAGE)+n),n="uniform float ".concat(r,";\n\n"),i.set(m.FRAGMENT_HEAD,i.get(m.FRAGMENT_HEAD)+n)}i.set(m.FRAGMENT_HEAD,i.get(m.FRAGMENT_HEAD)+s.get("fragment")+"\n"),null!==s.get("vertex")&&i.set(m.VERTEX_HEAD,i.get(m.VERTEX_HEAD)+s.get("vertex")+"\n")}else console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);return{varyings:d,transformedUv:h,readDepth:p}}var f1=class extends K0{constructor(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];super("EffectPass"),this.fullscreenMaterial=new j0(null,null,null,e),this.effects=i.sort((e,t)=>t.attributes-e.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=j0.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),i=new Map,n=new Map,r=new Map,a=new Set,o=0,s=0,l=0,c=!1,d=!1;for(let h of this.effects)if(h.blendMode.blendFunction===s1.SKIP)l|=h.getAttributes()&d1.DEPTH;else if(0!==(l&h.getAttributes()&d1.CONVOLUTION))console.error("Convolution effects cannot be merged",h);else{l|=h.getAttributes();let e=p1("e"+o++,h,t,i,n,r,l);if(s+=e.varyings.length,c=c||e.transformedUv,d=d||e.readDepth,null!==h.extensions)for(let t of h.extensions)a.add(t)}let u=/\bblend\b/g;for(let h of i.values()){let i=h.getShaderCode().replace(u,"blend".concat(h.blendFunction));t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+i+"\n")}if(0!==(l&d1.DEPTH)){if(d){let i="float depth = readDepth(UV);\n\n\t";t.set(e.FRAGMENT_MAIN_IMAGE,i+t.get(e.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=null===this.getDepthTexture()}else this.needsDepthTexture=!1;if(c){let i="vec2 transformedUv = vUv;\n";t.set(e.FRAGMENT_MAIN_UV,i+t.get(e.FRAGMENT_MAIN_UV)),n.set("UV","transformedUv")}else n.set("UV","vUv");t.forEach((e,t,i)=>i.set(t,e.trim().replace(/^#/,"\n#"))),this.uniformCount=r.size,this.varyingCount=s,this.skipRendering=0===o,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(a).setUniforms(r).setDefines(n)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GS;this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let i of this.effects)i.setDepthTexture(e,t)}render(e,t,i,n,r){for(let a of this.effects)a.update(e,t,n);if(!this.skipRendering||this.renderToScreen){let r=this.fullscreenMaterial;r.inputBuffer=t.texture,r.time+=n,e.setRenderTarget(this.renderToScreen?null:i),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let i of this.effects)i.setSize(e,t)}initialize(e,t,i){this.renderer=e;for(let n of this.effects)n.initialize(e,t,i),n.addEventListener("change",e=>this.handleEvent(e));this.updateMaterial(),this.verifyResources(),void 0!==i&&i!==xS&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){if("change"===e.type)this.recompile()}},m1=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],g1=class extends K0{constructor(){let{resolutionScale:e=.5,width:t=i1.AUTO_SIZE,height:i=i1.AUTO_SIZE,kernelSize:n=S1.LARGE}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("KawaseBlurPass"),this.renderTargetA=new N_(1,1,{minFilter:vS,magFilter:vS,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let r=this.resolution=new i1(this,t,i,e);r.addEventListener("change",e=>this.setSize(r.baseWidth,r.baseHeight)),this.blurMaterial=new L0,this.ditheredBlurMaterial=new L0,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=n}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,i,n,r){let a,o,s=this.scene,l=this.camera,c=this.renderTargetA,d=this.renderTargetB,u=m1[this.kernelSize],h=this.blurMaterial,p=t;for(this.fullscreenMaterial=h,a=0,o=u.length-1;a<o;++a){let t=0===(1&a)?c:d;h.kernel=u[a],h.inputBuffer=p.texture,e.setRenderTarget(t),e.render(s,l),p=t}this.dithering&&(h=this.ditheredBlurMaterial,this.fullscreenMaterial=h),h.kernel=u[a],h.inputBuffer=p.texture,e.setRenderTarget(this.renderToScreen?null:i),e.render(s,l)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t);let n=i.width,r=i.height;this.renderTargetA.setSize(n,r),this.renderTargetB.setSize(n,r),this.blurMaterial.setSize(n,r),this.ditheredBlurMaterial.setSize(n,r)}initialize(e,t,i){void 0!==i&&(this.renderTargetA.texture.type=i,this.renderTargetB.texture.type=i,i!==xS?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===HS&&(this.renderTargetA.texture.encoding=HS,this.renderTargetB.texture.encoding=HS))}static get AUTO_SIZE(){return i1.AUTO_SIZE}},v1=class extends K0{constructor(){let{width:e=i1.AUTO_SIZE,height:t=i1.AUTO_SIZE,renderTarget:i,luminanceRange:n,colorOutput:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("LuminancePass"),this.fullscreenMaterial=new W0(r,n),this.needsSwap=!1,this.renderTarget=i,void 0===this.renderTarget&&(this.renderTarget=new N_(1,1,{minFilter:vS,magFilter:vS,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let a=this.resolution=new i1(this,e,t);a.addEventListener("change",e=>this.setSize(a.baseWidth,a.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,i,n,r){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height)}initialize(e,t,i){void 0!==i&&i!==xS&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},y1=class extends K0{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new e1(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,i,n,r){let a=e.getContext(),o=e.state.buffers,s=this.scene,l=this.camera,c=this.clearPass,d=this.inverted?0:1,u=1-d;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),o.stencil.setFunc(a.ALWAYS,d,4294967295),o.stencil.setClear(u),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,i))),this.renderToScreen?(e.setRenderTarget(null),e.render(s,l)):(e.setRenderTarget(t),e.render(s,l),e.setRenderTarget(i),e.render(s,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(a.EQUAL,1,4294967295),o.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),o.stencil.setLocked(!0)}},b1=class extends K0{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inputBuffer";super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,null!==this.fullscreenMaterial){let t=this.fullscreenMaterial.uniforms;void 0!==t&&void 0!==t[e]&&(this.inputBufferUniform=t[e])}}render(e,t,i,n,r){null!==this.inputBufferUniform&&null!==t&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:i),e.render(this.scene,this.camera)}initialize(e,t,i){void 0!==i&&i!==xS&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},x1=.001,w1=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&void 0!==document.hidden&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*x1}getFixedDelta(){return this.fixedDelta*x1}setFixedDelta(e){return this.fixedDelta=1e3*e,this}getElapsed(){return this.elapsed*x1}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=void 0!==e?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},S1={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},_1=class extends u1{constructor(){let{blendFunction:e=s1.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:i=.025,resolutionScale:n=.5,intensity:r=1,width:a=i1.AUTO_SIZE,height:o=i1.AUTO_SIZE,kernelSize:s=S1.LARGE}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("BloomEffect","#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D map;\n#else\nuniform lowp sampler2D map;\n#endif\nuniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}",{blendFunction:e,uniforms:new Map([["map",new yO(null)],["intensity",new yO(r)]])}),this.renderTarget=new N_(1,1,{minFilter:vS,magFilter:vS,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new v1({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=i,this.blurPass=new g1({resolutionScale:n,width:a,height:o,kernelSize:s});let l=this.blurPass.getResolution();l.addEventListener("change",e=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,i){let n=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,n),this.blurPass.render(e,n,n)):this.blurPass.render(e,t,n)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height),this.luminancePass.resolution.copy(i)}initialize(e,t,i){this.blurPass.initialize(e,t,i),void 0!==i&&(this.renderTarget.texture.type=i,e.outputEncoding===HS&&(this.renderTarget.texture.encoding=HS))}},C1=class extends u1{constructor(){let{blendFunction:e=s1.NORMAL,brightness:t=0,contrast:i=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("BrightnessContrastEffect","uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",{blendFunction:e,uniforms:new Map([["brightness",new yO(t)],["contrast",new yO(i)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},E1=class extends u1{constructor(){super("ColorAverageEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",{blendFunction:arguments.length>0&&void 0!==arguments[0]?arguments[0]:s1.NORMAL})}},A1=class extends u1{constructor(){let{blendFunction:e=s1.NORMAL,offset:t=new p_(.001,5e-4)}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("ChromaticAberrationEffect","varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",{vertexShader:"uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",blendFunction:e,attributes:d1.CONVOLUTION,uniforms:new Map([["offset",new yO(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},M1=class extends u1{constructor(e){let{blendFunction:t=s1.NORMAL,worldFocusDistance:i,worldFocusRange:n,focusDistance:r=0,focalLength:a=.1,focusRange:o=a,bokehScale:s=1,width:l=i1.AUTO_SIZE,height:c=i1.AUTO_SIZE}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super("DepthOfFieldEffect","#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;\n#else\nuniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;\n#endif\nuniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}",{blendFunction:t,attributes:d1.DEPTH,uniforms:new Map([["nearColorBuffer",new yO(null)],["farColorBuffer",new yO(null)],["nearCoCBuffer",new yO(null)],["scale",new yO(1)]])}),this.camera=e,this.renderTarget=new N_(1,1,{minFilter:vS,magFilter:vS,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new b1(new z0(e));let d=this.cocMaterial;d.focusDistance=r,d.focusRange=o,void 0!==i&&(d.worldFocusDistance=i),void 0!==n&&(d.worldFocusRange=n),this.blurPass=new g1({kernelSize:S1.MEDIUM,width:l,height:c});let u=this.blurPass.getResolution();u.addEventListener("change",e=>this.setSize(u.getBaseWidth(),u.getBaseHeight())),this.maskPass=new b1(new q0(this.renderTargetCoC.texture));let h=this.maskPass.fullscreenMaterial;h.maskFunction=G0,h.colorChannel=D0,this.bokehNearBasePass=new b1(new I0(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new b1(new I0(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new b1(new I0(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new b1(new I0(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=s}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let i of t)i.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera;return R0(-t.position.distanceTo(e),t.near,t.far)}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GS;this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,i){let n=this.renderTarget,r=this.renderTargetCoC,a=this.renderTargetCoCBlurred,o=this.renderTargetMasked;if(null!==this.target){let e=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=e}this.cocPass.render(e,null,r),this.blurPass.render(e,r,a),this.maskPass.render(e,t,o),this.bokehFarBasePass.render(e,o,n),this.bokehFarFillPass.render(e,n,this.renderTargetFar),this.bokehNearBasePass.render(e,t,n),this.bokehNearFillPass.render(e,n,this.renderTargetNear)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t);let n=i.width,r=i.height,a=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];a.push(this.renderTargetCoC,this.renderTargetMasked),a.forEach(i=>i.setSize(e,t)),a=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],a.forEach(e=>e.setSize(n,r)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(e=>e.fullscreenMaterial.setSize(n,r))}initialize(e,t,i){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(n=>n.initialize(e,t,i)),this.blurPass.initialize(e,t,xS),void 0!==i&&(this.renderTarget.texture.type=i,this.renderTargetNear.texture.type=i,this.renderTargetFar.texture.type=i,this.renderTargetMasked.texture.type=i,e.outputEncoding===HS&&(this.renderTarget.texture.encoding=HS,this.renderTargetNear.texture.encoding=HS,this.renderTargetFar.texture.encoding=HS,this.renderTargetMasked.texture.encoding=HS))}},T1=(new j_,new yC,class extends u1{constructor(){let{blendFunction:e=s1.NORMAL,hue:t=0,saturation:i=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("HueSaturationEffect","uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",{blendFunction:e,uniforms:new Map([["hue",new yO(new j_)],["saturation",new yO(i)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((3*e.x-1)/2)}set hue(e){let t=Math.sin(e),i=Math.cos(e);this.uniforms.get("hue").value.set((2*i+1)/3,(-Math.sqrt(3)*t-i+1)/3,(Math.sqrt(3)*t-i+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}}),P1=(new D_,class extends u1{constructor(){let{blendFunction:e=s1.SCREEN,premultiply:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("NoiseEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));\n#ifdef PREMULTIPLY\noutputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);\n#else\noutputColor=vec4(noise,inputColor.a);\n#endif\n}",{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}}),D1=class extends u1{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;super("PixelationEffect","uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",{uniforms:new Map([["active",new yO(!1)],["d",new yO(new p_)]])}),this.resolution=new p_,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}},O1=(Math.PI,new j_,new j_,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC"),I1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",k1={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},R1=class extends u1{constructor(){let e,t,{preset:i=k1.MEDIUM,edgeDetectionMode:n=N0.COLOR,predicationMode:r=F0.DISABLED}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("SMAAEffect","uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",{vertexShader:"varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",blendFunction:s1.NORMAL,attributes:d1.CONVOLUTION|d1.DEPTH,uniforms:new Map([["weightMap",new yO(null)]])}),arguments.length>1&&(e=arguments[0],t=arguments[1],arguments.length>2&&(i=arguments[2]),arguments.length>3&&(n=arguments[3])),this.renderTargetEdges=new N_(1,1,{minFilter:vS,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new e1(!0,!1,!1),this.clearPass.overrideClearColor=new D_(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new b1(new U0),this.edgeDetectionMaterial.edgeDetectionMode=n,this.edgeDetectionMaterial.predicationMode=r,this.weightsPass=new b1(new X0);let a=new DD;a.onLoad=()=>{let i=new L_(e);i.name="SMAA.Search",i.magFilter=fS,i.minFilter=fS,i.generateMipmaps=!1,i.needsUpdate=!0,i.flipY=!0,this.weightsMaterial.searchTexture=i;let n=new L_(t);n.name="SMAA.Area",n.magFilter=vS,n.minFilter=vS,n.generateMipmaps=!1,n.needsUpdate=!0,n.flipY=!1,this.weightsMaterial.areaTexture=n,this.dispatchEvent({type:"load"})},a.itemStart("search"),a.itemStart("area"),void 0!==e&&void 0!==t?(a.itemEnd("search"),a.itemEnd("area")):typeof Image<"u"&&(e=new Image,t=new Image,e.addEventListener("load",()=>a.itemEnd("search")),t.addEventListener("load",()=>a.itemEnd("area")),e.src=O1,t.src=I1),this.applyPreset(i)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,i=this.weightsMaterial;switch(e){case k1.LOW:t.edgeDetectionThreshold=.15,i.orthogonalSearchSteps=4,i.diagonalDetection=!1,i.cornerDetection=!1;break;case k1.MEDIUM:t.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=8,i.diagonalDetection=!1,i.cornerDetection=!1;break;case k1.HIGH:t.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=16,i.diagonalSearchSteps=8,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break;case k1.ULTRA:t.edgeDetectionThreshold=.05,i.orthogonalSearchSteps=32,i.diagonalSearchSteps=16,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0}}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GS;this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,i){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;null!==e&&null!==t&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return O1}static get areaImageDataURL(){return I1}},z1={DEFAULT:0,ESKIL:1},L1=class extends u1{constructor(){let{blendFunction:e=s1.NORMAL,technique:t=z1.DEFAULT,eskil:i=!1,offset:n=.5,darkness:r=.5}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("VignetteEffect","uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;\n#if VIGNETTE_TECHNIQUE == 0\nfloat d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));\n#else\nvec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));\n#endif\noutputColor=vec4(color,inputColor.a);}",{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new yO(n)],["darkness",new yO(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===z1.ESKIL}set eskil(e){this.technique=e?z1.ESKIL:z1.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}};new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array([0,0,0]),new Float32Array([1,0,0]),new Float32Array([1,1,0]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([1,0,0]),new Float32Array([1,0,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,0,1]),new Float32Array([1,0,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,1,0]),new Float32Array([1,1,0]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,1,0]),new Float32Array([0,1,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,0,1]),new Float32Array([0,1,1]),new Float32Array([1,1,1]),new Float32Array(2),new Float32Array(2),new Float32Array([0,-.25,.25,-.125,.125,-.375,.375]),new Float32Array([0,0]),new Float32Array([.25,-.25]),new Float32Array([-.25,.25]),new Float32Array([.125,-.125]),new Float32Array([-.125,.125]),new Uint8Array([0,0]),new Uint8Array([3,0]),new Uint8Array([0,3]),new Uint8Array([3,3]),new Uint8Array([1,0]),new Uint8Array([4,0]),new Uint8Array([1,3]),new Uint8Array([4,3]),new Uint8Array([0,1]),new Uint8Array([3,1]),new Uint8Array([0,4]),new Uint8Array([3,4]),new Uint8Array([1,1]),new Uint8Array([4,1]),new Uint8Array([1,4]),new Uint8Array([4,4]),new Uint8Array([0,0]),new Uint8Array([1,0]),new Uint8Array([0,2]),new Uint8Array([1,2]),new Uint8Array([2,0]),new Uint8Array([3,0]),new Uint8Array([2,2]),new Uint8Array([3,2]),new Uint8Array([0,1]),new Uint8Array([1,1]),new Uint8Array([0,3]),new Uint8Array([1,3]),new Uint8Array([2,1]),new Uint8Array([3,1]),new Uint8Array([2,3]),new Uint8Array([3,3]),new Map([[N1(0,0,0,0),new Float32Array([0,0,0,0])],[N1(0,0,0,1),new Float32Array([0,0,0,1])],[N1(0,0,1,0),new Float32Array([0,0,1,0])],[N1(0,0,1,1),new Float32Array([0,0,1,1])],[N1(0,1,0,0),new Float32Array([0,1,0,0])],[N1(0,1,0,1),new Float32Array([0,1,0,1])],[N1(0,1,1,0),new Float32Array([0,1,1,0])],[N1(0,1,1,1),new Float32Array([0,1,1,1])],[N1(1,0,0,0),new Float32Array([1,0,0,0])],[N1(1,0,0,1),new Float32Array([1,0,0,1])],[N1(1,0,1,0),new Float32Array([1,0,1,0])],[N1(1,0,1,1),new Float32Array([1,0,1,1])],[N1(1,1,0,0),new Float32Array([1,1,0,0])],[N1(1,1,0,1),new Float32Array([1,1,0,1])],[N1(1,1,1,0),new Float32Array([1,1,1,0])],[N1(1,1,1,1),new Float32Array([1,1,1,1])]]);function B1(e,t,i){return e+(t-e)*i}function N1(e,t,i,n){let r=B1(e,t,.75),a=B1(i,n,.75);return B1(r,a,.875)}var F1=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(e){this.effect.blendMode.opacity.value=e},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(e){this.effect.blendMode.setBlendFunction(Number(e))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=s1.NORMAL}},U1=class extends F1{constructor(){super(_1),this.blendFunction=s1.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},V1=class extends F1{constructor(){super(C1)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},j1=class extends F1{constructor(){super(A1),this.effect.offset=new p_(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[1e3*this.effect.offset.x,1e3*this.effect.offset.y]}},W1=class extends F1{constructor(){super(E1)}},H1=class extends F1{constructor(){super(T1),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},G1=class extends F1{constructor(){super(P1),this.blendFunction=s1.OVERLAY}},q1=class extends F1{constructor(){super(L1)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},X1=class extends F1{constructor(e){super(M1)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e/2e3}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=this.isPerspectiveCamera?e/2e3:(e+992)/2e3}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}setCamera(e){let t=!1;(e.isPerspectiveCamera&&!1===this.isPerspectiveCamera||!e.isPerspectiveCamera&&!0===this.isPerspectiveCamera)&&(t=!0),e.isPerspectiveCamera?(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e.perspCamera),this.isPerspectiveCamera=!0):(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e),this.isPerspectiveCamera=!1),t&&this.effect.setChanged()}},Y1=class extends F1{constructor(){super(D1)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},Q1=class extends NE{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new yO(null)},blending:0,depthWrite:!1,depthTest:!1,vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}",fragmentShader:"#define GLSLIFY 1\nlayout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}"})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},K1=class extends K0{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new Q1,this.resolutionVector=new p_,this.resolveMaterial=new NE({name:"TAAResolveMaterial",uniforms:{inputBuffer:new yO(null),historyBuffer:new yO(null),velocityBuffer:new yO(null),depthBuffer:new yO(null),resolution:new yO(new p_)},blending:0,depthWrite:!1,depthTest:!1,vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}",fragmentShader:"#define GLSLIFY 1\n#include <common>\nvarying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;\n#define USE_YCOCG\n#define USE_CATMULL_ROM\nconst float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){\n#ifdef USE_YCOCG\nvec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);\n#else\nreturn texture(tex,uv);\n#endif\n}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){\n#ifdef CHOOSE_LONGEST_MOTION_VECTOR\nfloat longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;\n#else\nfloat closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;\n#endif\n}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);\n#ifdef USE_CATMULL_ROM\nvec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);\n#else\nvec4 previousColor=sample_color(historyBuffer,previousPixelPos);\n#endif\n#ifdef USE_YCOCG\npreviousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);\n#endif\nvec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);\n#ifdef USE_YCOCG\nvec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;\n#endif\nvec4 previousColorClipped=clamp(previousColor,cmin,cmax);\n#ifdef LUMINANCE_DIFFERENCES\n#ifdef USE_YCOCG\nfloat lum0=currentColor.r;float lum1=previousColorClipped.r;\n#else\nfloat lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);\n#endif\nfloat unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));\n#else\nconst float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);\n#endif\n#ifdef USE_YCOCG\ngl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);\n#else\ngl_FragColor=result;\n#endif\n}"}),this.historyRenderTarget=new N_(1024,1024,{minFilter:vS,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new N_(1024,1024,{minFilter:vS,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let i=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(i),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},Z1=class extends K0{constructor(e,t,i){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new o1(e,t,{renderTarget:i.transmissionDepthTarget}),this.passThroughMaterial=new Q1,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new Q1,this.depthPass=new o1(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,i){let n=this.camera.layers.mask,r=e;r.setRenderTarget(r.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],r.clear(),r.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,i),r.shadowMap.needsUpdate=!1,r.shadowMap.autoUpdate=!1;let a=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(a),e.render(this.splineScene,this.camera),this.camera.layers.mask=n}},J1=new OT,$1=new NE({transparent:!0,vertexShader:"\n        void main() {\n            gl_Position = vec4(0.0);\n        }\n    ",fragmentShader:"\n        layout(location = 1) out vec4 gVelocity;\n\n        void main() {\n            gl_FragColor = vec4(0.0);\n\t\t\tgVelocity = vec4(0.0);\n        }\n    "}),e2=class extends K0{constructor(e,t,i){super("OpaquePass",null!==t&&void 0!==t?t:J1,i),this.MRTCompatible=!0,this.originalMaterials=[],this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.MRTCompatible=e}setCamera(e){this.camera=e}setScene(e){this.scene=null!==e&&void 0!==e?e:J1}getScene(){return this.scene}render(e,t){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.length=0,this.scene.traverse(e=>{e.layers.isEnabled(3)&&e instanceof CQ&&(this.originalMaterials.push([e,e.material]),e.material=$1)}),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let i=this.renderToScreen?null:t;e.setRenderTarget(i),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),e.render(this.scene,this.camera),this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach(e=>{e[0].material=e[1]})}},t2=class{constructor(e){let{depthBuffer:t=!0,stencilBuffer:i=!1,multisampling:n=0,frameBufferType:r=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.renderer=e,this.helperStartIndex=0,this.copyPass=new Z0,this.depthTexture=null,this.timer=new w1,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,i,r,n,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,i,r,n,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,i,r,n,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,i=this.multisampling;i>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):i!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,null!==e){var t,i;let n=e.getSize(new p_),r=null!==(t=null===(i=e.getContext().getContextAttributes())||void 0===i?void 0:i.alpha)&&void 0!==t&&t,a=this.inputBuffer.texture[0].type;a===xS&&e.outputEncoding===HS&&(this.inputBuffer.texture[0].encoding=HS,this.outputBuffer.texture[0].encoding=HS,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),e.autoClear=!1,this.setSize(n.width,n.height,!1);for(let t of this.passes)t.initialize(e,r,a)}}replaceRenderer(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.renderer,n=i.domElement.parentNode;return this.setRenderer(e),t&&null!==n&&(n.removeChild(i.domElement),n.appendChild(e.domElement)),i}createDepthTexture(){let e=this.depthTexture=new ET(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.stencilBuffer?(e.format=MS,e.type=CS):e.type=wS,e}deleteDepthTexture(){if(null!==this.depthTexture){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,i,n,r,a){let o,s=this.renderer,l=null===s?new p_:s.getDrawingBufferSize(new p_),c={minFilter:vS,magFilter:vS,wrapS:hS,wrapT:hS,stencilBuffer:t,depthBuffer:e};return n>0?(o=new N_(l.width,l.height,c),o.samples=n):(r?(o=new U_(l.width,l.height,2,c),o.texture[1].type=_S):o=new N_(l.width,l.height,c),o.depthTexture=new ET(2048,2048),o.depthTexture.type=SS),i===xS&&null!==s&&s.outputEncoding===HS&&(Array.isArray(o.texture)?o.texture.forEach(e=>e.encoding=HS):o.texture.encoding=HS),Array.isArray(o.texture)?o.texture.forEach((e,t)=>{e.name="EffectComposer.Buffer ".concat(r," ").concat(t),e.generateMipmaps=!1}):(o.texture.name="EffectComposer.Buffer ".concat(r),o.texture.generateMipmaps=!1),o.name=a,o}addPass(e,t){var i,n;let r,a=this.passes,o=this.renderer,s=o.getDrawingBufferSize(new p_),l=null!==(i=null===(n=o.getContext().getContextAttributes())||void 0===n?void 0:n.alpha)&&void 0!==i&&i;if(e.MRTCompatible&&(r=this.inputBuffer.texture[0].type),e.MRTCompatible||(r=this.inputBuffer.texture.type),e.setRenderer(o),e.setSize(s.width,s.height),e.initialize(o,l,r),this.autoRenderToScreen&&(a.length>0&&(a[a.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),void 0!==t?a.splice(t,0,e):a.push(e),this.autoRenderToScreen&&(a[a.length-1].renderToScreen=!0),e.needsDepthTexture||null!==this.depthTexture)if(null===this.depthTexture){let t=this.createDepthTexture();for(e of a)e.setDepthTexture(t)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,i=t.indexOf(e);if(-1!==i&&t.splice(i,1).length>0){if(null!==this.depthTexture){let i=(e,t)=>e||t.needsDepthTexture;t.reduce(i,!1)||e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null)}this.autoRenderToScreen&&i===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t,i,n,r,a=this.renderer,o=this.copyPass,s=this.inputBuffer,l=this.outputBuffer,c=this.inputBufferSingle,d=this.outputBufferSingle,u=!1;void 0===e&&(e=this.timer.update().getDelta());for(let h of this.passes)h.enabled&&(h.MRTCompatible?h.render(a,s,l,e,u):h.render(a,c,d,e,u),h.needsSwap&&(u&&(o.renderToScreen=h.renderToScreen,t=a.getContext(),i=a.state.buffers.stencil,i.setFunc(t.NOTEQUAL,1,4294967295),o.render(a,s,l,e,u),i.setFunc(t.EQUAL,1,4294967295)),n=s,r=c,s=l,c=d,l=n,d=r),h instanceof y1?u=!0:h instanceof J0&&(u=!1))}setSize(e,t,i){let n=this.renderer;if(this._width=e,this._height=t,void 0===e||void 0===t){let i=n.getSize(new p_);e=i.width,t=i.height}n.setSize(e,t,i);let r=n.getDrawingBufferSize(new p_);this.inputBuffer.setSize(r.width,r.height),this.outputBuffer.setSize(r.width,r.height),this.inputBufferSingle.setSize(r.width,r.height),this.outputBufferSingle.setSize(r.width,r.height);for(let a of this.passes)a.setSize(r.width,r.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],null!==this.inputBuffer&&this.inputBuffer.dispose(),null!==this.outputBuffer&&this.outputBuffer.dispose(),null!==this.inputBufferSingle&&this.inputBufferSingle.dispose(),null!==this.outputBufferSingle&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},i2=new NE({name:"CombineMaterial",uniforms:{inputBufferA:new yO(null),inputBufferB:new yO(null)},blending:0,depthWrite:!1,depthTest:!1,vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n    gl_Position = vec4(position.xy, 1.0, 1.0);\n    vUv = position.xy * 0.5 + 0.5;\n}\n",fragmentShader:"\n    varying vec2 vUv;\n    uniform sampler2D inputBufferA;\n    uniform sampler2D inputBufferB;\n\n    // TODO: Why do we need these when postpro of framemode is enabled???\n    layout(location = 1) out vec4 gVelocity;\n\n    void main() {\n\tvec4 resA = texture2D(inputBufferA, vUv);\n\tvec4 resB = texture2D(inputBufferB, vUv);\n    float a = resA.a + resB.a * ( 1.0 - resA.a );\n\n\tvec4 res;\n\tres.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));\n\tres.a = resA.a + resB.a * (1.0 - resA.a);\n\tgl_FragColor = res;\n    gVelocity = vec4(0.0);\n    }\n"}),n2=class extends K0{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=i2,this.helperPass=new e2(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new e2(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new R1({preset:k1.LOW,edgeDetectionMode:N0.COLOR});this.effectPass=new f1(this.camera,t),this.rt=new N_(10,10,{minFilter:vS,magFilter:vS,wrapS:hS,wrapT:hS,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,i){super.initialize(e,t,i),this.effectPass.initialize(e,t,i)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,i){this.rt.depthTexture=t.depthTexture;let n=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,i),this.fullscreenMaterial.uniforms.inputBufferA.value=i.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(n),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},r2=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],a2=new NE({vertexShader:"#define GLSLIFY 1\n#include <skinning_pars_vertex>\n#include <morphtarget_pars_vertex>\nout vec3 n;void main(){\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\nvec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}",fragmentShader:"#define GLSLIFY 1\nin vec3 n;void main(){gl_FragColor=vec4(n,1.0);}"}),o2=new NE({vertexShader:"#define GLSLIFY 1\nout vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}",fragmentShader:"#define GLSLIFY 1\nin vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){\n#ifdef DEBUG\nfloat d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);\n#else\nvec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;\n#endif\n}",uniforms:{texture_ao_lrez:new yO(null),texture_depth_lrez:new yO(null),texture_depth_hrez:new yO(null),near:new yO(null),far:new yO(null)}}),s2=class extends K0{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let i=1024,n=1024;this.gBuffer=new N_(i,n,{type:rN?_S:SS,depthTexture:new ET(i,n),minFilter:vS,magFilter:vS}),this.depthBufferHighRes=new N_(i,n,{depthTexture:new ET(i,n)}),this.aoBuffer=new N_(i,n,{minFilter:vS,magFilter:vS}),this.splineScene=e,this.splineCamera=t;let r=new Float32Array(2*r2.length);for(let o=0;o<r2.length;o++){let e=2*o;r[e+0]=r2[o][0],r[e+1]=r2[o][1]}this.blueNoiseInDiskTexture=new LT(r,r2.length,1,PS,SS),this.blueNoiseInDiskTexture.wrapS=uS,this.blueNoiseInDiskTexture.wrapT=uS,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new NE({vertexShader:"#define GLSLIFY 1\nout vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}",fragmentShader:"#define GLSLIFY 1\nin vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}\n#define USE_GBUFFER_NORMALS\nvoid main(){vec3 view_space_p=get_view_position(v_uv);\n#ifdef USE_GBUFFER_NORMALS\nvec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;\n#else\nvec3 view_space_n=-rebuild_normal(v_uv,view_space_p);\n#endif\nfloat radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}",uniforms:{near:new yO(null),far:new yO(null),fov:new yO(null),proj_info:new yO(new B_),is_ortho:new yO(!1),resolution:new yO(new p_),radius_of_influence:new yO(8),radius_in_screen_space:new yO(1),exponent:new yO(1),ao_color:new yO(new j_),bias:new yO(.5),texture_depth:new yO(null),texture_normals:new yO(null),texture_blue_noise:new yO(null),texture_blue_noise_in_disk:new yO(this.blueNoiseInDiskTexture),frame_index:new yO(0),fog_enabled:new yO(!1),fog_near:new yO(1),fog_far:new yO(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new N_(i,n,{minFilter:vS,magFilter:vS,wrapS:hS,wrapT:hS,depthBuffer:!1,type:SS});let a=new R1({preset:k1.ULTRA,edgeDetectionMode:N0.COLOR});this.effectPass=new f1(this.camera,a)}initialize(e,t,i){super.initialize(e,t,i),this.effectPass.initialize(e,t,i)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let i=this._runHalfRes?.5:1,n=e*i,r=t*i;this.gBuffer.setSize(n,r),this.aoBuffer.setSize(n,r),this.hbaoMaterial.uniforms.resolution.value.set(n,r),this.aaBuffer.setSize(n,r),this.effectPass.setSize(n,r)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}setDepthTexture(e){this.depthBufferHighRes.depthTexture=e,o2.uniforms.texture_depth_hrez.value=e,o2.needsUpdate=!0}render(e,t,i){this.splineScene.overrideMaterial=a2;let n=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=n,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let e=this.splineCamera.perspCamera.projectionMatrix.elements,t=2/e[0],i=2/e[5],n=-(1-e[8])/e[0],r=-(1+e[9])/e[5];this.hbaoMaterial.uniforms.proj_info.value.set(t,i,n,r);let a=this.splineCamera.perspCamera.fov*(Math.PI/180),o=this.hbaoMaterial.uniforms.resolution.value.y/(2*Math.tan(.5*a)),s=.5*this.hbaoMaterial.uniforms.radius_of_influence.value*o;this.hbaoMaterial.uniforms.radius_in_screen_space.value=s,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let e=this.splineCamera.orthoCamera.projectionMatrix.elements,t=2/e[0],i=2/e[5],n=-(1+e[12])/e[0],r=-(1-e[13])/e[5];this.hbaoMaterial.uniforms.proj_info.value.set(t,i,n,r);let a=this.hbaoMaterial.uniforms.resolution.value.y/i*.5,o=this.hbaoMaterial.uniforms.radius_of_influence.value*a;this.hbaoMaterial.uniforms.radius_in_screen_space.value=o,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=o2,o2.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,o2.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,o2.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},l2=class extends b1{constructor(){super(new NE({vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D tInput;\nuniform sampler2D tMap;\nuniform vec2 resolution;\nvarying vec2 vUv;\n\nuniform vec2 uResolution;\nuniform vec2 uCoords;\n\n// Draws a rectangle at center <st> with size <size>\nfloat rectangle(vec2 st, vec2 size) {\n    size = vec2(0.5) - size * 0.5;\n    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));\n    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));\n\n    return uv.x * uv.y;\n}\n\nuniform vec2 uSize;\nuniform float uScale;\nuniform float uDPR;\nuniform float uCurrent;\nuniform vec3 uSceneColor;\n\nvoid main() {\n    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;\n    screenUv *= 1.0 / uDPR;\n\n    vec2 center = vec2(0.5, -0.5);\n    vec2 outsideUv = screenUv;\n    outsideUv += center;\n    outsideUv -= uCoords.xy / uResolution.xy;\n    outsideUv = (outsideUv - 0.5) + 0.5;\n    outsideUv -= center;\n    vec2 s = (uSize / uResolution) * uScale;\n    float isOutside = 1.0 - rectangle(outsideUv, s);\n    \n    vec2 mid = vec2(0.5);\n    vec2 insideUv = (screenUv - mid + s * mid) / s;\n    vec4 background = texture2D(tInput, screenUv);\n    vec4 image = texture2D(tMap, insideUv);\n    gl_FragColor = mix(image, background, isOutside);\n}\n",uniforms:{tInput:new yO(null),tMap:new yO(null),uResolution:new yO(new p_),uSize:new yO(new p_),uCoords:new yO(new p_),uScale:new yO(1),uSceneColor:new yO(new D_(16711680)),uDPR:new yO(1),uCurrent:new yO(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}},c2=[],d2=class extends b1{constructor(){super(new NE({vertexShader:"\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D toScene;\nuniform sampler2D fromScene;\nuniform vec2 resolution;\n\nuniform vec2 uResolution;\nuniform float uDPR;\n\nuniform float mixRatio;\nuniform sampler2D tMixTexture;\nuniform int useTexture;\nuniform float threshold;\n\nvoid main() {\n\tvec2 screenUv = gl_FragCoord.xy / uResolution.xy;\n\tscreenUv *= 1.0 / uDPR;\n\n\tvec4 texel1 = texture2D( fromScene, screenUv );\n\tvec4 texel2 = texture2D( toScene, screenUv );\n\n\tif (useTexture==1) {\n\t\t\n\t\tvec4 transitionTexel = texture2D( tMixTexture, screenUv );\n\t\tfloat r = mixRatio * (1.0 + threshold * 2.0) - threshold;\n\t\tfloat mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);\n\t\t\n\t\tgl_FragColor = mix( texel1, texel2, mixf );\n\t} else {\n\t\t\n\t\tgl_FragColor = mix( texel1, texel2, mixRatio );\n\t\t\n\t}\n}\n",uniforms:{toScene:new yO(null),fromScene:new yO(null),uResolution:new yO(new p_),uDPR:new yO(1),mixRatio:new yO(0),threshold:new yO(.1),useTexture:new yO(0),tMixTexture:{value:c2[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(e){this.uniforms.fromScene.value=e}},u2=class extends b1{constructor(){super(new NE({vertexShader:"\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D inputBuffer;\nuniform sampler2D blurredInputBuffer;\nuniform sampler2D overlay;\nuniform float blurIntensity;\n\nuniform vec2 uResolution;\nuniform float uDPR;\n\nvoid main() {\n\tvec2 screenUv = gl_FragCoord.xy / uResolution.xy;\n\tscreenUv *= 1.0 / uDPR;\n\n\tvec4 texel1 = texture2D( overlay, screenUv );\n\tvec4 texel2 = texture2D( inputBuffer, screenUv );\n\tvec4 texel3 = texture2D( blurredInputBuffer, screenUv );\n\n\tfloat blurMask2 = max(sign(texel1.a), 0.0) * blurIntensity;\n    gl_FragColor = mix( mix(texel2, texel3, blurMask2), texel1, texel1.a );\n}\n",uniforms:{inputBuffer:new yO(null),blurredInputBuffer:new yO(null),overlay:new yO(null),uResolution:new yO(new p_),uDPR:new yO(1),blurIntensity:new yO(0)}})),this._blurEnabled=!1,this.blurTarget=new N_(1,1,{minFilter:vS,magFilter:vS,wrapS:hS,wrapT:hS}),this.blurPass=new g1({width:window.innerWidth,height:window.innerHeight,kernelSize:S1.HUGE,resolutionScale:.25}),this.blurPass.renderToScreen=!1,this.uniforms.blurredInputBuffer.value=this.blurTarget.texture}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.overlay.value}set texture(e){this.uniforms.overlay.value=e}setResolution(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.uniforms.uResolution.value.set(e,t),this.uniforms.uDPR.value=i,this.blurPass.setSize(e,t),this.blurTarget.setSize(e,t),this.blurPass.setSize(e,t)}get uiCanvas(){return this._uiCanvas}set uiCanvas(e){this._uiCanvas=e,e.texture&&(this.uniforms.overlay.value=e.texture);let t=e.frame;if(t){let e=t.data.backgroundBlur,i=e.radius;this._blurEnabled=e.enabled,this.uniforms.blurIntensity.value=this._blurEnabled?1:0,this.blurPass.scale=i/3}}render(e,t,i,n,r){this._blurEnabled&&(this.blurPass.setDepthTexture(this.getDepthTexture()),this.blurPass.render(e,t,this.blurTarget,n,r)),super.render(e,t,i,n,r)}},h2=class extends b1{constructor(){super(new NE({vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D tInput;\nuniform sampler2D tOverlayImage;\nvarying vec2 vUv;\nuniform vec2 uResolution;\nuniform vec2 uRightBottom;\nuniform vec2 uImageSize;\nuniform float uScale;\nuniform float uDPR;\n\nvec3 blendNormal(vec3 base, vec3 blend) {\n\treturn blend;\n}\n\nvec3 blendNormal(vec3 base, vec3 blend, float opacity) {\n\treturn (blendNormal(base, blend) * opacity + base * (1.0 - opacity));\n}\n\nvec4 drawFixedSizeImage(sampler2D image, vec2 screenUV, vec2 imageSize, vec2 imageCoords, vec2 screenSize, float dpr) {\n\tvec2 uv = (screenUV * screenSize * dpr - imageCoords) / (imageSize * dpr);\n\tif (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {\n\t\treturn vec4(0.0);\n\t}\n\treturn texture2D(image, uv);\n}\n\nvoid main() {\n    vec2 screenUV = gl_FragCoord.xy / (uResolution.xy * uDPR);\n\tvec2 imageCoords = vec2(uResolution.x * uDPR - uImageSize.x * uScale * uDPR - uRightBottom.x * uDPR, uRightBottom.y * uDPR);\n    vec4 background = texture2D(tInput, screenUV);\n    vec4 image = drawFixedSizeImage(tOverlayImage, screenUV, uImageSize * uScale, imageCoords, uResolution, uDPR);\n    gl_FragColor = vec4(blendNormal(background.rgb, image.rgb, image.a), max(background.a, image.a));\n}\n",uniforms:{tInput:new yO(null),tOverlayImage:new yO(null),uResolution:new yO(new p_),uImageSize:new yO(new p_),uRightBottom:new yO(new p_(20,20)),uScale:new yO(.25),uDPR:new yO(1)}}),"tInput")}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tOverlayImage.value}set texture(e){this.uniforms.tOverlayImage.value=e,this.uniforms.uImageSize.value.set(e.image.width,e.image.height)}};function p2(e,t){return t&&t.enabled&&e.push(t.effect),e}var f2=e=>Object.values(s1).includes(e)?e:s1.NORMAL,m2=class extends JS{constructor(e,t){super(),this._needsDOFResize=t,this.postprocessingState=wj.defaultData,this._scene=new OT,this._camera=new h0,this.effects=new Map,this.blueNoiseTexture=new LT,this._renderToScreen=!0,this._isUIOverlayEnabled=!1,this.clock=new tO,this.renderer=e,this.debug=!1,this.effects.set("bloom",new U1),this.effects.set("chromaticAberration",new j1),this.effects.set("vignette",new q1),this.effects.set("noise",new G1),this.effects.set("colorAverage",new W1),this.effects.set("hueSaturation",new H1),this.effects.set("brightnessContrast",new V1),this.effects.set("depthOfField",new X1),this.effects.set("pixelation",new Y1),this.effectComposer=new t2(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new e2(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new Z1(this.scene,this.camera,this.renderer),this.aoPass=new s2(this.scene,this.camera),this.taaPass=new K1,this.taaPass.renderToScreen=!1,this.helperPass=new n2(this.camera),this.helperPass.renderToScreen=!1,this.stylesOverlayPass=new l2,this.stylesOverlayPass.enabled=!1,this.uiOverlayPass=new u2,this.uiOverlayPass.enabled=!1,this.logoOverlayPass=new h2,this.logoOverlayPass.enabled=!1,this.sceneTransitionPass=new d2,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){void 0!==e?(this.stylesOverlayPass.texture=e,this.stylesOverlayPass.enabled=!0):this.stylesOverlayPass.enabled=!1}get overlayTexture(){return this.stylesOverlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){let t=this._camera!==e;this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),t&&this.transmissionPass.updatePasses(this.renderer),this.aoPass.setCamera(e),this.helperPass.setCamera(e),this.effects.get("depthOfField").setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let i=this.effectComposer.passes[t];!0!==i.enabled||e||!this._renderToScreen?i.renderToScreen=!1:(i.renderToScreen=!0,e=!0)}}get isUIOverlayEnabled(){return this._isUIOverlayEnabled}disableUIOverlay(){this._isUIOverlayEnabled=!1}enableUIOverlay(){this._isUIOverlayEnabled=!0}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new LT(e,128,128),this.blueNoiseTexture.wrapS=uS,this.blueNoiseTexture.wrapT=uS,this.blueNoiseTexture.minFilter=fS,this.blueNoiseTexture.magFilter=fS,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,i,n,r,a,o,s){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=i,this.aoPass.aoColor=n,this.aoPass.fogEnabled=r,this.aoPass.fogNear=a,this.aoPass.fogFar=o,this.aoPass.runHalfRes!==!s&&(this.aoPass.runHalfRes=!s)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){var e,t;if(null!==(e=this.uvEffectPass)&&void 0!==e&&e.dispose(),null!==(t=this.effectPass)&&void 0!==t&&t.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){var i;let e=[this.effects.get("pixelation")].reduce(p2,[]);e.length>0&&(this.uvEffectPass=new f1(this.camera,...e),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let t=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("depthOfField"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(p2,[]);if(t.length>0&&(this.effectPass=new f1(this.camera,...t),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass),this._needsDOFResize&&null!==(i=this.effects.get("depthOfField"))&&void 0!==i&&i.enabled&&void 0!==window)){let e=this.renderer.viewportWidth,t=this.renderer.viewportHeight;this.renderer.setSize(e-1,t-1),this.renderer.setSize(e,t)}}this.effectComposer.addPass(this.stylesOverlayPass),this.effectComposer.addPass(this.uiOverlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass),this.effectComposer.addPass(this.logoOverlayPass)}_initCopyPass(){if(this._savePass)return;let e=new p_;this.renderer.getDrawingBufferSize(e),this._rt=new N_(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:uS,wrapT:uS}),this._rt.samples=0,this._savePass=new Z0(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new Z0(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(!0===e?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}set sceneTransitionFromTexture(e){e!==this.sceneTransitionPass.texture&&(null!==e?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=e)}setWatermark(e){this.logoOverlayPass.enabled=null!==e,e&&(this.logoOverlayPass.texture=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t}=e,i=r(e,ww),n=!1;t!==this.postprocessingState.enabled&&(n=!0);for(let r of Object.entries(i)){let e=r[1],t=this.effects.get(r[0]);if(t){t.enabled!==e.enabled&&(n=!0),t.enabled=e.enabled;for(let[i,n]of Object.entries(e))"blendFunction"===i?t.blendFunction=f2(n):t[i]=n}}this.postprocessingState=e,n&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,i,n){e instanceof B_?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,i,n),this.effectComposer.outputBuffer.scissor.set(e,t,i,n));let r=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(r),this.effectComposer.outputBuffer.scissor.multiplyScalar(r),this.renderer.setScissor(e,t,i,n)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,i,n){e instanceof B_?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,i,n),this.effectComposer.outputBuffer.viewport.set(e,t,i,n))}resize(e,t,i){if(this.effectComposer.setSize(e,t,i),this._rt){let i=this.renderer.getPixelRatio();this._rt.setSize(e*i,t*i)}}dispose(){var e,t;null!==(e=this.uvEffectPass)&&void 0!==e&&e.dispose(),null!==(t=this.effectPass)&&void 0!==t&&t.dispose(),this.effectComposer.dispose()}},g2=tA.lights_fragment_begin,v2=tA.shadowmask_pars_fragment,y2=null,b2=new NE({vertexShader:"\nattribute vec3 randomColor;\nvarying vec3 vNormal;\nflat out vec3 vColor;\n#include <skinning_pars_vertex>\n#include <morphtarget_pars_vertex>\n\t\nvoid main()\n{\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\nvec3 transformed = vec3(position);\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n\nvNormal = normal;\nvColor = randomColor;\ngl_Position = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));\n}\n",fragmentShader:"\nuniform float depthContrast;\nvarying vec3 vNormal;\nflat in vec3 vColor;\nvoid main()\n{\nvec3 normal = (normalize(vNormal)).rgb;\n\nfloat contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;\n\nvec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);\ngl_FragColor = vec4(resultColor, vColor.r);\ngl_FragColor = vec4(resultColor, vColor.r);\n}\n",uniforms:{depthContrast:{value:1}}}),x2=new L_,w2=new p_,S2=class extends PT{constructor(e){var t,i;super(e),t=this,this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new p_,this.dummyCamera=new h0,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.getContext(),a=0;e&&(a|=r.COLOR_BUFFER_BIT),i&&(a|=r.DEPTH_BUFFER_BIT),n&&(a|=r.STENCIL_BUFFER_BIT),r.clear(a),r.clearBufferfv(r.COLOR,1,[0,0,0,1])},this.pipeline=new m2(this,null!==(i=null===e||void 0===e?void 0:e.needsDOFResize)&&void 0!==i&&i),this.autoClear=!1;let n=this.setPixelRatio.bind(this),r=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=1,this.dummyCamera.matrixAutoUpdate=!1,this.domElement.removeAttribute("data-engine");let a=this.getContext();if(a&&"drawingBufferColorSpace"in a)try{a.drawingBufferColorSpace="display-p3"}catch(hV){console.warn(hV)}this.setPixelRatio=e=>{this._pixelRatio!==e&&(this._pixelRatio=e,n(e))},this.setSize=function(e,i){var n,a;let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(t.viewportWidth!==e||t.viewportHeight!==i)&&(t.viewportWidth=e,t.viewportHeight=i,r(e,i,o),null!==(n=t.normalRenderTarget)&&void 0!==n&&n.setSize(e*t._pixelRatio,i*t._pixelRatio),t._resizeTransmission(e,i),null!==(a=t.transmissionDepthTarget)&&void 0!==a&&a.setSize(e*t._pixelRatio/2,i*t._pixelRatio/2),t.pipeline.resize(e,i,o))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){void 0===this.aoRenderTarget&&(this.aoRenderTarget=new N_(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:vS,magFilter:vS,wrapS:hS,wrapT:hS,depthBuffer:!1}))}_resizeTransmission(e,t){var i,n;null!==(i=this.transmissionRenderTarget)&&void 0!==i&&i.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),null===(n=this.aoRenderTarget)||void 0===n||n.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return 1===rZ.transmissionLod.value}set hdTransmission(e){rZ.transmissionLod.value=!0===e?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){void 0===this.transmissionRenderTarget&&(this.transmissionRenderTarget=new N_(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:bS,magFilter:vS,wrapS:hS,wrapT:hS,depthBuffer:!1}),this.transmissionDepthTarget=new N_(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:fS,magFilter:fS,depthBuffer:!1}))}createNormalRenderTarget(){void 0===this.normalRenderTarget&&(this.normalRenderTarget=new N_(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:fS,magFilter:fS,type:SS,depthTexture:new ET(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t,i){this.normalRenderTarget&&(this.setClearColor(0),i.layers.enable(8),i.layers.disable(0),i.layers.disable(3),t.traverseEntity(e=>{e.layers.isEnabled(8)&&(e.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),b2.uniforms.depthContrast.value=i instanceof h0?(i.far-i.near)/1e4:1,t.overrideMaterial=b2,this.render(t,i),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=e.wireframeState?Y4:null,i.layers.enable(0),i.layers.enable(3),t.traverseEntity(e=>{e.layers.isEnabled(8)&&(e.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.dummyCamera.updateCameraState(t.dataPatched),this.dummyCamera.matrix.copy(t.matrixWorld);let n=t.height,r=t.width,a=this.viewportWidth/this.viewportHeight;r<n?r=n*a:n=r/a,this.dummyCamera.setViewplaneSize(r,n);for(let o=0;o<i;o++)this.renderSplineScene(e,this.dummyCamera)}renderSplineScene(e,t){var i;let{sceneHelpers:n=this.sceneHelpers,sceneHelpersOnTop:r=this.sceneHelpersOnTop,overrideTransmission:a,overrideNormal:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=e instanceof K4?e.activePage:e,l=s.visible;s.visible=!0;let c=s.scene;this.xr.enabled&&(!1===this.isXRCopyPassSet&&null!==this.getRenderTarget()&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(s.bgColor,s.bgColor.a),s.penumbraSizeArray.forEach((e,t)=>{rZ.penumbraSize.value[t]=e}),rZ.pixelRatioNode.value=this.getPixelRatio(),0!==this.resolution.x&&0!==this.resolution.y?rZ.resolution.value.set(this.resolution.x,this.resolution.y):rZ.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),void 0!==o?(rZ.normalRenderTarget.value=o,rZ.normalRenderTargetDepth.value=x2):c.needsNormal()&&(this.createNormalRenderTarget(),rZ.normalRenderTarget.value=this.normalRenderTarget.texture,rZ.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(c,s,t));let d=s.data.ao,u=d.occlusion;if(u&&(this.createAORenderTarget(),rZ.aoRenderTarget.value=this.aoRenderTarget.texture),rZ.aoEnabled.value=u,this.pipeline.setAmbientOcclusionParams(d.occlusion,d.radius,d.bias,s.aoColor,null!==s.fog,s.backupFog.near,s.backupFog.far,d.aoFullRes&&!rN),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture),this.pipeline.isUIOverlayEnabled&&null!==(i=s.uiCanvas)&&void 0!==i&&i.enabled&&s.uiCanvas.texture&&s.uiCanvas.texture.image.width>0){let e=this.getSize(w2),t=this.getPixelRatio();(s.uiCanvas.width!==this.viewportWidth||s.uiCanvas.height!==this.viewportHeight||s.uiCanvas.dpr!==t)&&s.uiCanvas.applySize({width:this.viewportWidth,height:this.viewportHeight},t),s.uiCanvas.render(this),this.pipeline.uiOverlayPass.uiCanvas=s.uiCanvas,this.pipeline.uiOverlayPass.enabled=!0,this.pipeline.uiOverlayPass.setResolution(e.x,e.y,t),this.pipeline.updateRenderToScreen()}else this.pipeline.uiOverlayPass.enabled=!1,this.pipeline.updateRenderToScreen();if(this.pipeline.logoOverlayPass.enabled){let e=this.getSize(w2),t=this.getPixelRatio();this.pipeline.logoOverlayPass.uniforms.uResolution.value.set(e.x,e.y),this.pipeline.logoOverlayPass.uniforms.uDPR.value=t}let h=!1;if(void 0!==a)rZ.transmissionRenderTarget.value=a,rZ.transmissionRenderTargetDepth.value=x2,this.pipeline.setTransmissionPassEnabled(!1);else{let e=c.needsTransmission();e&&(void 0===this.transmissionRenderTarget&&(h=!0),this.createTransmissionRenderTarget(),rZ.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,rZ.aspectRatio.value=function(e,t){return e>=t?new p_(t/e,1):new p_(1,e/t)}(this.viewportWidth,this.viewportHeight),rZ.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(e)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=n,this.pipeline.sceneHelpersOnTop=r,this.pipeline.scene=s,this.pipeline.camera=t,h&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==s.postprocessing&&(this.pipeline.updatePostprocessing(s.postprocessing),!n&&!r&&this.pipeline.disableHelpers()),void 0!==this.clearAlphaOverride&&this.setClearAlpha(this.clearAlphaOverride),c.shapeBlendIntances.forEach(e=>{e.onBeforeShadowPass(this)}),s.overrideMaterial=c.wireframeState?Y4:null,this.pipeline.render(),rZ.frameIndex.value=(rZ.frameIndex.value+1)%16,t instanceof h0&&t.copyHistory(),s.visible=l}renderFromSceneForSceneTransitionPass(e,t,i){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(e,t),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=i,this.sceneTransitionTimeRemaining=i,this.pipeline.renderToScreen=!0;let n=this.pipeline.sceneTransitionPass.uniforms;n.uDPR.value=window.devicePixelRatio,n.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var e,t,i,n,r;this._superDispose(),this.pipeline.dispose(),null!==(e=this.aoRenderTarget)&&void 0!==e&&e.dispose(),null!==(t=this.transmissionRenderTarget)&&void 0!==t&&t.dispose(),null!==(i=this.transmissionDepthTarget)&&void 0!==i&&i.dispose(),null!==(n=this.normalRenderTarget)&&void 0!==n&&n.dispose(),null===(r=this.normalRenderTarget)||void 0===r||null===(r=r.depthTexture)||void 0===r||r.dispose()}},_2=class extends(Y$(RO)){constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,arguments.length>2&&void 0!==arguments[2]?arguments[2]:10066329),this.object=e,this.added=!1,this.name="DirectionalLightHelper: ".concat(e.uuid)}raycast(e,t){J$(this.object,_2.geometryHelper,e,t)}},C2=class extends(Y$(DO)){constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,arguments.length>2&&void 0!==arguments[2]?arguments[2]:6710886),this.object=e,this.name="PointLightHelper: ".concat(e.uuid)}raycast(e,t){J$(this.object,C2.geometryHelper,e,t)}},E2=class extends(Y$(PO)){constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:6710886),this.object=e,this.name="SpotLightHelper: ".concat(e.uuid)}raycast(e,t){J$(this.object,E2.geometryHelper,e,t)}update(){if(void 0!==this.object){let e=E2._vector,t=this.object.distance?this.object.distance:1e3,i=t*Math.tan(this.object.angle);this.cone.scale.set(i,i,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let n=void 0!==this.color?this.color:this.light.color;if(this.cone.material instanceof Array)for(let r=0,a=this.cone.material.length;r<a;r++)this.cone.material[r].color.set(n);else this.cone.material.color.set(n)}}},A2=E2;A2._vector=new j_;var M2=class extends ST{constructor(){super(),this.caretIndex=0,this._caretVisibleAlpha=1,this._selectionVisibleAlpha=.3,this.current={start:0,end:void 0},this.matrixAutoUpdate=!1,this.caretMesh=new OE(new eA(1,1),new nE({transparent:!0,opacity:0,side:2})),this.add(this.caretMesh),this.selectionMesh=new OE(new eA(1,1),new nE({color:2857471,transparent:!0,depthTest:!1,depthWrite:!1,opacity:0,side:2})),this.add(this.selectionMesh),this.hide()}get caretHeight(){var e,t;return null!==(e=null===(t=this.object)||void 0===t?void 0:t.AD)&&void 0!==e?e:0}show(e){this.visible=!0,this.object=e,this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.y=.5*-this.caretHeight,this.setCaretPosition(this.caretIndex),this.update()}hide(){this.visible=!1}update(){if(void 0===this.object)return;this.updateHelperMatrix();let{depth:e}=this.object.geometry.userData.parameters;this.caretMesh.position.z=e,this.selectionMesh.position.z=e}updateHelperMatrix(){if(void 0===this.object)return;let e=this.object,t=e.parent;null!==t&&t.updateWorldMatrix(!0,!1),e.matrixAutoUpdate&&e.updateMatrix(),null!==t?(this.matrixWorld.multiplyMatrices(t.matrixWorld,e.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,e.matrix)):this.matrixWorld.multiplyMatrices(e.hiddenMatrix,e.matrix),this.matrix.copy(this.matrixWorld);for(let i of this.children)i.matrixWorld.copy(this.matrixWorld);e.updateWorldMatrix(!0,!0)}setCaretColor(e){let t=this.caretMesh.material;t.color.setRGB(e.r,e.g,e.b);let i=this._caretVisibleAlpha===t.opacity;this._caretVisibleAlpha=e.a,i&&(t.opacity=this._caretVisibleAlpha)}setSelectionColor(e){this.selectionMesh.material.color.setRGB(e.r,e.g,e.b)}setCaretPosition(e){if(void 0===this.object)return;this.caretIndex=e;let t=this.object.wrappedText,[i,n]=P2(t,e),[r,a]=e>0?P2(t,e-1):[null,null];"\n"===(e>0&&t.length?t[r].charAt(a):null)&&(i++,n=0),this.current.start=e,this.current.end=void 0;let[o,s]=T2(this.object,i,n),{AD:l,descender:c}=this.object,d=c+.5*l,{width:u,height:h,depth:p}=this.object.geometry.userData.parameters,f="string"==typeof u?0:u,m="string"==typeof h?0:h;this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.set(o-.5*f,s+d+.5*m,p),this.hideSelectionMesh(),this.showCaretMesh()}setSelection(e,t){if(void 0===this.object)return;let i=this.object.wrappedText;this.current.start=e,this.current.end=t;let n=[],r=[],a=function(e,t,i){let[n,r]=P2(e,t),[a,o]=P2(e,i),s=[];r>=e[n].length&&(n++,r=0);for(let l=n;l<=a;l++){let t=e[l],i=l===n?r:0,c=l===a?o:t.length;s.push([l,i,c])}return s}(i,e,t),{lineHeight:o,AD:s,descender:l}=this.object,c=l+.5*s-.5*o;for(let[g,v,y]of a)if(v!==y){let[e,t]=T2(this.object,g,v),[i,a]=T2(this.object,g,y);t+=c,a+=c,a+=o;let s=n.length/3;n.push(e,t,0),n.push(i,t,0),n.push(i,a,0),n.push(e,a,0),r.push(s+0,s+1,s+2),r.push(s+2,s+3,s+0)}let d=new vE;d.setIndex(r),d.setAttribute("position",new cE(n,3));let{width:u,height:h,depth:p}=this.object.geometry.userData.parameters,f="string"==typeof u?0:u,m="string"==typeof h?0:h;this.selectionMesh.geometry.dispose(),this.selectionMesh.geometry=d,this.selectionMesh.position.x=.5*-f,this.selectionMesh.position.y=.5*m,this.selectionMesh.position.z=p,this.showSelectionMesh(),this.hideCaretMesh()}getSelectionFromPosition(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"previous";if(void 0===this.object||void 0===this.object.font)return;let n=this.object.wrappedText,r=n.length,a=this.object.lineHeight,o=r*a,{height:s,verticalAlign:l}=this.object.geometry.userData.parameters,c="string"==typeof s?0:s,d=0;3===l?d=c-o:2===l&&(d=.5*c-.5*o);let u=Math.min(Math.floor(Math.max(Math.min(-t-d,o),0)/a),r-1),h=this.object.charCoords[u],p=this.object.charWidths[u],f=0,m=!1;if("previous"===i){for(let g=0;g<h.length;g++)if(h[g][0]+.5*p[g]-e>0){f=g,m=!0;break}}else if("closest"===i){let t=1/0;for(let i=0;i<h.length;i++){let n=h[i][0]+.5*p[i],r=Math.abs(n-e);r<t&&(t=r,f=i,m=!0)}}else for(let g=0;g<h.length;g++){let t=h[g][0],i=h[g][0]+p[g];if(e>=t&&e<i){f=g,m=!0;break}}return m||(f=h.length),{index:this.getGlobalIndexFromLineAndCharIndexes(n,u,f),lineIndex:u,characterIndex:f}}getGlobalIndexFromLineAndCharIndexes(e,t,i){return e.slice(0,t).reduce((e,t)=>e+t.length,0)+i}showSelectionMesh(){this.selectionMesh.material.opacity=this._selectionVisibleAlpha}hideSelectionMesh(){this.selectionMesh.material.opacity=0}showCaretMesh(){this.caretMesh.material.opacity=this._caretVisibleAlpha}hideCaretMesh(){this.caretMesh.material.opacity=0}};function T2(e,t,i){let{charCoords:n,charWidths:r,initialOffsetY:a,lineHeight:o}=e;if(n[t]&&0===n[t].length||0===n.length){let i=0,{horizontalAlign:n}=e.data.geometry,r=e.wrappedText,{width:s}=e.geometry.userData.parameters;return 1===r.length&&0===r[0].length&&(3===n?i=.5*s:2===n&&(i=s)),[i,a-o*t]}let s=n[t];if(void 0===s||0===s.length)return[0,0];let[l,c]=s[Math.min(i,s.length-1)];return i>=s.length&&(l+=r[t][i-1]),[l,c]}function P2(e,t){var i,n;let r=0;for(let a=0;a<e.length;a++){let i=e[a],n=t-r;if(n<=i.length)return[a,n];r+=i.length}return[Math.max(0,e.length-1),null!==(i=null===(n=e[e.length-1])||void 0===n?void 0:n.length)&&void 0!==i?i:0]}function D2(e,t){return"string"==typeof e?t.data.colors[e]:e}function O2(e){return e.colors[0]}var I2,k2=class extends(y0(JD,_2)){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.top=1250,n.bottom=-1250,n.right=1250,n.left=-1250,n.near=-1e4,n.far=2500;let r=new BO(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof BO&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let i=void 0!==e.depth&&e.depth!==this.shadow.camera.far||void 0!==e.size&&e.size/2!==this.shadow.camera.right;void 0!==e.size&&function(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}(this,e.size),void 0!==e.shadowRadius&&(this.shadow.radius=e.shadowRadius),void 0!==e.shadowResolution&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),void 0!==e.penumbraSize&&t.scene.markPenumbraSizeDirty(),i&&this.update()}},R2=new j_,z2=new j_,L2=new V_,B2=class extends(y0(GD,A2)){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=2*h_.RAD2DEG*this.angle,n.aspect=1,n.near=100,n.far=2500;let r=new BO(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof BO&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),z2.setFromMatrixPosition(this.matrixWorld),L2.setFromRotationMatrix(this.matrixWorld),R2.copy(this.up).applyQuaternion(L2).negate().multiplyScalar(this.distance),this.target.position.copy(z2).add(R2),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),void 0!==e.distance&&(this.distance=e.distance),void 0!==e.decay&&(this.decay=e.decay),void 0!==e.angle&&(this.angle=e.angle),void 0!==e.penumbra&&(this.penumbra=e.penumbra),void 0!==e.shadowRadius&&(this.shadow.radius=e.shadowRadius),void 0!==e.penumbraSize&&t.scene.markPenumbraSizeDirty(),void 0!==e.shadowResolution&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}};function N2(e,t){return[[e[0][0]*t[0][0]+e[0][1]*t[1][0],e[0][0]*t[0][1]+e[0][1]*t[1][1]],[e[1][0]*t[0][0]+e[1][1]*t[1][0],e[1][0]*t[0][1]+e[1][1]*t[1][1]]]}function F2(e){return[[e[0][0],e[1][0]],[e[0][1],e[1][1]]]}function U2(e){let[t,i,n]=function(e){let t=(e[0][0]+e[1][1])/2,i=(e[0][0]-e[1][1])/2,n=(e[1][0]+e[0][1])/2,r=(e[1][0]-e[0][1])/2,a=Math.sqrt(t*t+r*r),o=Math.sqrt(i*i+n*n),s=a+o,l=a-o,c=Math.atan2(n,i),d=Math.atan2(r,t),u=(d-c)/2,h=(d+c)/2,p=[[Math.cos(h),Math.sin(h)],[-Math.sin(h),Math.cos(h)]],f=[[s,0],[0,l]],m=[[Math.cos(u),Math.sin(u)],[-Math.sin(u),Math.cos(u)]];return p[0][0]*=-1,p[0][1]*=-1,m[0][0]*=-1,m[1][0]*=-1,[p,f,m]}(e),r=N2(t,F2(n)),a=N2(N2(n,i),F2(n));return{rotation:Math.atan2(r[1][0],r[0][0]),scale:[a[0][0],a[1][1]],shear:[a[0][1]/a[1][1],a[1][0]/a[0][0]]}}(e=>{function t(e){return[e[0],e[3],e[1],e[4],e[2],e[5]]}e.identity=function(){return[1,0,0,0,1,0,0,0,1]},e.copy=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.identity();for(let e=0,n=t.length;e<n;e++)i[e]=t[e];return i},e.create=function(t,i,n,r,a,o){return e.setAbcdef(e.identity(),t,i,n,r,a,o)},e.setAbcdef=function(e,t,i,n,r,a,o){return e[0]=t,e[1]=n,e[2]=a,e[3]=i,e[4]=r,e[5]=o,e},e.append=function(i,n){let[r,a,o,s,l,c]=t(i),[d,u,h,p,f,m]=t(n),g=d*r+u*o,v=d*a+u*s,y=h*r+p*o,b=h*a+p*s,x=f*r+m*o+l,w=f*a+m*s+c;return e.create(g,v,y,b,x,w)},e.prepend=function(i,n){let[r,a,o,s,l,c]=t(i),[d,u,h,p,f,m]=t(n),g=r,v=a,y=o,b=s;(1!==d||0!==u||0!==h||1!==p)&&(g=r*d+a*h,v=r*u+a*p,y=o*d+s*h,b=o*u+s*p);let x=l*d+c*h+f,w=l*u+c*p+m;return e.create(g,v,y,b,x,w)},e.getAbcdef=t,e.invert=function(t){let[i,n,r,a,o,s]=e.getAbcdef(t),l=i*a-n*r,c=a/l,d=-n/l,u=-r/l,h=i/l,p=(r*s-a*o)/l,f=-(i*s-n*o)/l;return e.create(c,d,u,h,p,f)},e.apply=function(t,i){let[n,r]=t,[a,o,s,l,c,d]=e.getAbcdef(i);return[a*n+s*r+c,o*n+l*r+d]},e.applyInverse=function(t,i){let[n,r,a,o,s,l]=e.getAbcdef(i),c=1/(n*o+a*-r),[d,u]=t;return[o*c*d+-a*c*u+(l*a-s*o)*c,n*c*u+-r*c*d+(-l*n+s*r)*c]},e.scale=function(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i,[r,a,o,s,l,c]=e.getAbcdef(t);return e.setAbcdef(t,r*i,a*n,o*i,s*n,l*i,c*n),t},e.rotate=function(t,i){let n=Math.cos(i),r=Math.sin(i),[a,o,s,l,c,d]=e.getAbcdef(t);return e.setAbcdef(t,a*n-o*r,a*r+o*n,s*n-l*r,s*r+l*n,c*n-d*r,c*r+d*n),t},e.rotateAround=function(t,i,n){let[r,a]=n,o=e.translate(t,-r,-a);return o=e.rotate(o,i),o=e.translate(o,r,a),o},e.translate=function(t,i,n){let[r,a,o,s,l,c]=e.getAbcdef(t);return e.setAbcdef(t,r,a,o,s,l+i,c+n),t},e.setTranslate=function(t,i,n){let[r,a,o,s]=e.getAbcdef(t);return e.setAbcdef(t,r,a,o,s,i,n),t},e.setPosition=function(t,i,n){let[r,a,o,s]=e.getAbcdef(t);return e.setAbcdef(t,r,a,o,s,i,n),t},e.getScale=function(t){let[i,n,r,a]=e.getAbcdef(t);return[Math.sqrt(i*i+n*n),Math.sqrt(r*r+a*a)]},e.getPosition=function(t){let[,,,,i,n]=e.getAbcdef(t);return[i,n]},e.getRotation=function(t,i){return e.decompose(t,i).rotation},e.decompose=function(t,i){let[n,r,a,o,s,l]=e.getAbcdef(t),{rotation:c,scale:d,shear:u}=U2([[n,a],[r,o]]);return{position:[s+(i[0]*n+i[1]*a)-i[0],l+(i[0]*r+i[1]*o)-i[1]],scale:d,rotation:c,shear:u,pivot:i}},e.compose=function(t,i,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[0,0],[o,s]=t,[l,c]=r,[d,u,h,p]=function(e){let{rotation:t,scale:i,shear:n}=e,r=Math.cos(t),a=Math.sin(t),o=N2([[r,-a],[a,r]],[[i[0],n[0]*i[1]],[n[1]*i[0],i[1]]]);return[o[0][0],o[1][0],o[0][1],o[1][1]]}({rotation:n,scale:i,shear:a}),f=o-(l*d+c*h)+l,m=s-(l*u+c*p)+c;return e.create(d,u,h,p,f,m)}})(I2||(I2={}));var V2=Math.PI/180;Math.PI;var j2=class{constructor(e,t,i){var n;this.uuid=e,this.data=t,this.localMatrix=I2.identity(),this.worldMatrix=I2.identity(),this.ignoreCameraZoom=!1,this.visible=!0,this._singleBBox=new J2,this._recursiveBBox=new J2,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.stateSelection=null,this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this.name="",this.position=[0,0],this.scale=[1,1],this.rotation=0,this.shear=[0,0],this.emitter=mY(),this.dpr=null!==(n=i.dpr)&&void 0!==n?n:1,this.dataPatched=t}project(e,t){let i=this.worldMatrix;return t&&(i=I2.append(t.worldMatrix,i)),I2.applyInverse(e,i)}intersects(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.visible&&!this.data.raycastLock&&this.intersectsInLocalSpace(...this.project([e,t],i),n)}intersectsInLocalSpace(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{min:n,max:r}=i?this.recursiveBBox:this.singleBBox;return e>=n[0]&&e<=r[0]&&t>=n[1]&&t<=r[1]}applyTransforms(e){e.setTransform(this.worldMatrix,this.ignoreCameraZoom)}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges()),this._recursiveBBox}updateLocalMatrix(){this.localMatrix=I2.compose(this.position,this.scale,function(e){return e*V2}(this.rotation),HW.getPivot(this.dataPatched),this.shear)}updateWorldMatrix(e,t,i){let n=this.parent;t&&null!==n&&void 0!==n&&n.updateWorldMatrix(e,!0,!1),e&&this.updateLocalMatrix(),this.parent?this.worldMatrix=I2.append(this.parent.worldMatrix,this.localMatrix):this.worldMatrix=I2.copy(this.localMatrix),this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}get pivot(){return HW.getPivot(this.data)}getCenter(){return[0,0]}getHalfSize(){return[0,0]}get id(){return this.uuid}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{e.resetBBoxNeedsUpdateSelf()})}updateTransformState(e){let t=!1;void 0!==e.position&&(t=!0,this.position=e.position),void 0!==e.rotation&&(t=!0,this.rotation=e.rotation),void 0!==e.scale&&(t=!0,this.scale=e.scale),void 0!==e.shear&&(t=!0,this.shear=e.shear),t&&(this.updateWorldMatrix(!0,!1,!0),this.resetBBoxNeedsUpdate())}updateByOp(e,t,i){0===e.type&&void 0!==e.props.visible&&(this.visible=e.props.visible),this.data=t,this.data=t;let n=e,a=xF(e.path,["states","*"]);if(null!==a){if(0===e.type){let[t]=a;if((null===this||void 0===this?void 0:this.stateSelection)===t){let t=c({},e.props);if(delete t.name,Object.values(e.props).some(e=>void 0===e)){let i=this.data;if(void 0!==i){let n=fF.zoom(i,e.path.slice(2));if(n)for(let i in e.props)void 0===e.props[i]&&i in n&&(t[i]=n[i])}}n=c(c({},e),{},{props:t,path:e.path.slice(2)})}}}else if(0===e.type){let t=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(void 0!==t){if(void 0!==e.props.name&&t.name){let{name:e}=t;t=r(t,Sw)}let i=fF.removeOverridden(e.path,e.props,t);n=c(c({},e),{},{props:i})}}this.updateByPatchedOpBase(n,kW.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i)}changeSelectedState(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==this.data.states.length||i){for(let e of this.data.states)kW.toOps(this.data,e.data).forEach(e=>{let i=HN.replaceProps(e,this.data);this.dataPatched=this.data,this.updateByPatchedOp(i,this.data,t)});if(null!==e){let i=this.data.states.data(e);i&&(this.dataPatched=kW.patch(this.data,i),kW.toOps(this.data,i).forEach(e=>{this.updateByPatchedOp(e,this.dataPatched,t)}))}i&&this.updateTransformState(this.dataPatched),this.stateSelection=e}}updateState(e,t){void 0!==e.name&&(this.name=e.name),void 0!==e.visible&&(this.visible=e.visible),this.updateTransformState(e)}updateByPatchedOpBase(e,t,i){this.dataPatched=t,this.updateByPatchedOp(e,t,i)}updateByPatchedOp(e,t,i){0===e.path.length&&0===e.type&&this.updateState(e.props,i),this.requestRender()}traverseFrameAncestors(e){this.traverseAncestors(t=>{"frame2d"===t.data.type&&e(t)})}traverseAncestors(e){let t=this.parent;for(;t;)e(t),t=t.parent}requestRender(){this.traverseFrameAncestors(e=>{e.requestRender()})}clone(e){let t=new j2(this.uuid,this.data,e);return t.parent=void 0,t}addEventListener(e,t){this.emitter.on(e,t)}removeEventListener(e,t){this.emitter.off(e,t)}dispatchEvent(e){var t;this.emitter.emit(e.type,c(c({},e),{},{target:null!==(t=e.target)&&void 0!==t?t:this}))}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children;if(t){let i=t.indexOf(this)+1;return t[i]?t[i]:e.traverseSortNextHelper()}}}sortNext(){let e=this.children;return e&&e.length>0&&e[0]?e[0]:this.traverseSortNextHelper()}isDescendantOf(e){e instanceof j2&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}},W2=class extends j2{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.context=i,this.children=[]}add(e){e.parent&&e.parent instanceof W2&&e.parent.remove(e),this.children.push(e),e.parent=this}remove(e){let t=this.children.indexOf(e);t>=0&&(this.children.splice(t,1),e.parent=void 0)}traverse(e){let t=e(this);if(!0!==t)for(let i of this.children)i instanceof W2?i.traverse(e):t=e(i)}intersectsChildrenHelper(e,t,i,n,r){for(let a of this.children)if(a.intersects(e,t,i,!1)&&(r.push(a),n)||a instanceof W2&&a.intersectsChildrenHelper(e,t,i,n,r))return!0;return!1}intersectsChildren(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.intersectsChildrenHelper(e,t,i,n,r),r}intersectsChildrenHelperReverse(e,t,i,n,r){for(let a of this.children)if(a instanceof W2&&a.intersectsChildrenHelperReverse(e,t,i,n,r)||a.intersects(e,t,i,!1)&&(r.push(a),n))return!0;return!1}intersectsChildrenReverse(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.intersectsChildrenHelperReverse(e,t,i,n,r),r}updateWorldMatrix(e,t,i){if(super.updateWorldMatrix(e,t,i),i&&this.children)for(let n of this.children)n.updateWorldMatrix(e,!1,!0)}find(e){let t;return this.traverse(i=>{i.uuid===e&&(t=i)}),t}innerDrawChildren(e){for(let t=this.children.length-1;t>=0;t--)this.children[t].draw(e)}resetBBoxNeedsUpdate(){super.resetBBoxNeedsUpdate(),this.traverse(e=>{e.resetBBoxNeedsUpdateSelf()})}clone(e){let t=new W2(this.uuid,this.data,e);t.parent=void 0;for(let i of this.children)t.add(i.clone(e));return t}},H2=class extends W2{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.updateState(t,i)}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.innerDrawChildren(e),e.restore())}clone(e){let t=new H2(this.uuid,this.data,e);t.parent=void 0;for(let i of this.children)t.add(i.clone(e));return t}};function G2(e,t){let[[i,n],[r,a]]=e,[[o,s],[l,c]]=t,d=(i-r)*(s-c)-(n-a)*(o-l);if(0===d)return!1;let u=((i-o)*(s-c)-(n-s)*(o-l))/d,h=-((i-r)*(n-s)-(n-a)*(i-o))/d;return u>=0&&u<=1&&h>=0&&h<=1}var q2,X2,Y2,Q2,K2=[[-1,1],[-1,-1],[1,-1],[1,1]],Z2=(e,t,i)=>{let n=e.getCenter(),r=e.getHalfSize(),a=I2.append(t,e.worldMatrix);0===r[0]&&0===r[1]?i.push(I2.apply(n,a)):K2.forEach(e=>{let t=[e[0]*r[0]+n[0],e[1]*r[1]+n[1]];i.push(I2.apply(t,a))})},J2=class{constructor(){this.matrix=I2.identity(),this.min=[1/0,1/0],this.max=[-1/0,-1/0],this.vertices=[],this.edges=[]}setFromObjectSize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(),this.makeEmpty(),I2.copy(e.worldMatrix,this.matrix);let i=I2.invert(e.worldMatrix);this.expandByObjectSize(e,i,t)}expandByObjectSize(e,t){let i=[];!0===(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&e instanceof W2?e.traverse(e=>{e.visible&&Z2(e,t,i)}):Z2(e,t,i),this.setFromPoints(i)}setFromSize(e,t,i){this.makeEmpty(),I2.copy(i,this.matrix),this.expandBySize(e,t,i)}expandBySize(e,t,i){[I2.apply([0,0],i),I2.apply([0,t],i),I2.apply([e,t],i),I2.apply([e,0],i)].forEach(e=>this.expandByPoint(e))}getCenter(){let[e,t]=this.min,[i,n]=this.getHalfSize();return I2.apply([e+i,t+n],this.matrix)}getSize(){return[this.max[0]-this.min[0],this.max[1]-this.min[1]]}getHalfSize(){return[.5*(this.max[0]-this.min[0]),.5*(this.max[1]-this.min[1])]}makeEmpty(){this.min=[1/0,1/0],this.max=[-1/0,-1/0]}setFromPoints(e){this.makeEmpty();for(let t of e)this.expandByPoint(t)}expandByPoint(e){this.min=[Math.min(this.min[0],e[0]),Math.min(this.min[1],e[1])],this.max=[Math.max(this.max[0],e[0]),Math.max(this.max[1],e[1])]}computeVertices(){let[e,t]=this.getHalfSize(),i=this.getCenter(),[n,r,a,o]=I2.getAbcdef(this.matrix),s=I2.create(n,r,a,o,i[0],i[1]);this.vertices=K2.map(i=>{let[n,r]=i;return I2.apply([n*e,r*t],s)})}computeEdges(){this.edges=[];for(let e=0,t=this.vertices.length;e<t;++e)this.edges.push([this.vertices[e],this.vertices[(e+1)%t]])}project(e,t){let i=this.matrix;return t&&(i=I2.append(t.worldMatrix,i)),I2.applyInverse(e,i)}intersects(e,t,i){return this.intersectsInLocalSpace(...this.project([e,t],i))}intersectsInLocalSpace(e,t){let{min:i,max:n}=this;return e>=i[0]&&e<=n[0]&&t>=i[1]&&t<=n[1]}containsPoint(e){let[t,i]=e,[n,r]=this.min,[a,o]=this.max;return t>=n&&t<=a&&i>=r&&i<=o}intersectsBBox2D(e){for(let t=0,i=this.edges.length;t<i;t++){let i=this.edges[t];for(let t=0,n=e.edges.length;t<n;t++){if(G2(i,e.edges[t]))return!0}}for(let t=0,i=e.vertices.length;t<i;t++){let i=e.vertices[t];if(this.containsPoint(i))return!0}return!1}ensureMinMax(){let e=this.min,t=this.max;this.min=[Math.min(e[0],t[0]),Math.min(e[1],t[1])],this.max=[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}copy(e){this.min=[...e.min],this.max=[...e.max],I2.copy(e.matrix,this.matrix),this.computeVertices(),this.computeEdges()}clone(){let e=new J2;return e.copy(this),e}},$2=new Promise(e=>{q2=e}),e3=!1;function t3(){if(!e3)return X2||(X2=async function(){var e;let t=await i.e(160).then(i.bind(i,160));q2(null!==(e=t.default)&&void 0!==e?e:t),e3=!0}(),X2)}function i3(e){let t=!1;return e.scene.objects.traverse((e,i)=>{("Mesh"===i.type&&"UIGeometry"===i.geometry.type||"Page"===i.type&&void 0!==i.uiFrame)&&(t=!0)}),t}var n3=I2.identity(),r3=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.canvas=e,this._dpr=t,this._width=0,this._height=0,this._strokeMode="inside",this._layerBlur=0,this._backgroundBlur=0,this._dropShadowBlur=0,this._dropShadowOffsetX=0,this._dropShadowOffsetY=0,this._dropShadowColor=TV.transparent,this._innerShadowBlur=0,this._innerShadowOffsetX=0,this._innerShadowOffsetY=0,this._innerShadowSpread=0,this._innerShadowColor=TV.transparent,this._fonts=new Map,this._isSizeDirty=!1;try{let i=e.getBoundingClientRect();e.width=i.width*t,e.height=i.height*t}catch(i){console.log(e.width,t)}this._currentM3Transform=n3,this._currentTransform=new Float32Array(n3)}get dpr(){return this._dpr}set dpr(e){this._dpr=e,this._isSizeDirty=!0}async init(){var e,t;if(!this.wasmURL)throw Error("Your must set the wasm binary url with renderer.wasmURL = ... before you can call renderer.init");await async function(e){let t=await $2;Y2||(Q2||(Q2=t({locateFile:()=>e})),Y2=await Q2)}(this.wasmURL),this._surface=Y2.MakeWebGLCanvasSurface(this.canvas),this.ctx=null===(e=this._surface)||void 0===e?void 0:e.getCanvas(),this._paint=new Y2.Paint,this._paint.setAntiAlias(!0),this._paintFill=this._paint.copy(),this._paintFill.setStyle(Y2.PaintStyle.Fill),this._paintStroke=this._paint.copy(),this._paintStroke.setStyle(Y2.PaintStyle.Stroke),null===(t=this.ctx)||void 0===t||t.scale(this.dpr,this.dpr)}get currentTransform(){return this._currentM3Transform}get currentTransformBuffer(){return this._currentTransform}set currentTransform(e){this._currentM3Transform=e,this._currentTransform.set(e)}async loadFont(e,t){let i=await(await fetch(e)).arrayBuffer();this.registerFont(i,t)}registerFont(e,t){if(this._fonts.has(t))return;let i=Y2.FontMgr.FromData(e);if(!i)throw new Error("Invalid font data for "+t);this._fonts.set(t,i)}get width(){return this._width}get height(){return this._height}set strokeColor(e){this._paintStroke&&this._paintStroke.setColor(o3(e),Y2.ColorSpace.DISPLAY_P3)}set fillColor(e){this._paintFill&&this._paintFill.setColor(o3(e),Y2.ColorSpace.DISPLAY_P3)}set lineWidth(e){this._paintStroke&&this._paintStroke.setStrokeWidth("center"===this._strokeMode?e:2*e)}set strokeMode(e){this._strokeMode=e}set dropShadowBlur(e){this._dropShadowBlur=e}set dropShadowColor(e){this._dropShadowColor=e}set dropShadowOffsetX(e){this._dropShadowOffsetX=e}set dropShadowOffsetY(e){this._dropShadowOffsetY=e}set innerShadowBlur(e){this._innerShadowBlur=e}set innerShadowColor(e){this._innerShadowColor=e}set innerShadowOffsetX(e){this._innerShadowOffsetX=e}set innerShadowOffsetY(e){this._innerShadowOffsetY=e}set innerShadowSpread(e){this._innerShadowSpread=e}set layerBlur(e){this._layerBlur=e}set backgroundBlur(e){this._backgroundBlur=e}clear(){var e;null===(e=this.ctx)||void 0===e||e.clear(Y2.TRANSPARENT)}save(){var e;null===(e=this.ctx)||void 0===e||e.save()}restore(){var e;null===(e=this.ctx)||void 0===e||e.restore()}beginPath(){var e;null!==(e=this._currentPath)&&void 0!==e&&e.delete(),this._currentPath=new Y2.Path}closePath(){let e=this._currentPath;if(e){if(e.isEmpty())return;let t=e.getBounds();(t[3]-t[1]||t[2]-t[0])&&e.close()}}fill(){this._paintInner(this._paintFill,!0)}stroke(){this._paintInner(this._paintStroke,!1)}clipRect(e,t,i,n){var r;let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=Y2.XYWHRect(e,t,i,n);if(0===a&&0===o&&0===l&&0===s)null===(r=this.ctx)||void 0===r||r.clipRect(c,Y2.ClipOp.Intersect,!0);else{var d;let e=Y2.RRectXY(c,a,a);e[4]=e[5]=a,e[6]=e[7]=o,e[8]=e[9]=s,e[10]=e[11]=l,null===(d=this.ctx)||void 0===d||d.clipRRect(e,Y2.ClipOp.Intersect,!0)}}_applyShadowOffsetMatrix(){if(this.ctx){let e=I2.invert(this.currentTransform);this.ctx.concat(e);let t=I2.translate(I2.identity(),this._dropShadowOffsetX,this._dropShadowOffsetY);this.ctx.concat(t),this.ctx.concat(this._currentTransform)}}_applyEffectsToPaint(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.ctx&&this._currentPath){let h,p=!1;if(i&&this._hasDropShadow()){var n,r,a;let i,o=e.copy();o.setColor(o3(this._dropShadowColor)),this._dropShadowBlur>0&&(i=Y2.MaskFilter.MakeBlur(Y2.BlurStyle.Normal,this._dropShadowBlur*this.dpr*(null!==(n=null===(r=this.camera)||void 0===r?void 0:r.scale)&&void 0!==n?n:1),!1),o.setMaskFilter(i)),this.ctx.save(),this.ctx.clipPath(this._currentPath,Y2.ClipOp.Difference,!0),this._applyShadowOffsetMatrix(),t(o),this.ctx.restore(),o.delete(),null===(a=i)||void 0===a||a.delete()}if(this._backgroundBlur>0&&i){this.ctx.save(),this.ctx.clipPath(this._currentPath,Y2.ClipOp.Intersect,!0);let t=Y2.ImageFilter.MakeBlur(this._backgroundBlur,this._backgroundBlur,Y2.TileMode.Clamp,null),i=e.copy();i.setImageFilter(t),i.setAlphaf(1);let n=this._currentPath.computeTightBounds();this.ctx.saveLayer(i,n,null,Y2.SaveLayerInitWithPrevious),this.ctx.drawColor(e.getColor()),this.ctx.restore(),this.ctx.restore(),i.delete(),t.delete(),p=!0}if(this._layerBlur>0){var o,s;let i=e.copy();h=Y2.MaskFilter.MakeBlur(Y2.BlurStyle.Normal,this._layerBlur*this.dpr*(null!==(o=null===(s=this.camera)||void 0===s?void 0:s.scale)&&void 0!==o?o:1),!1),i.setMaskFilter(h),t(i),i.delete(),h.delete(),p=!0}if(p||t(e),i&&this._hasInnerShadow()){var l,c,d,u;let e,t=new Y2.Paint;t.setAntiAlias(!0),t.setStyle(Y2.PaintStyle.Fill),t.setColor(o3(this._innerShadowColor)),this._innerShadowBlur>0&&(e=Y2.MaskFilter.MakeBlur(Y2.BlurStyle.Normal,this._innerShadowBlur*this.dpr*(null!==(l=null===(c=this.camera)||void 0===c?void 0:c.scale)&&void 0!==l?l:1),!1),t.setMaskFilter(e));let i=this._currentPath.computeTightBounds(),[n,r,a,o]=i,s=a-n,h=o-r;this.ctx.save(),this.ctx.clipPath(this._currentPath,Y2.ClipOp.Intersect,!0),this.ctx.saveLayer(t,i,null,Y2.SaveLayerInitWithPrevious),null!==(d=this.ctx)&&void 0!==d&&d.translate(this._innerShadowOffsetX,this._innerShadowOffsetY),this.ctx.drawRect(Y2.XYWHRect(-1e3-this._innerShadowOffsetX,-1e3-this._innerShadowOffsetY,2e3+s+Math.abs(2*this._innerShadowOffsetX),2e3+h+Math.abs(2*this._innerShadowOffsetY)),t),t.setBlendMode(Y2.BlendMode.Clear),this.ctx.drawPath(this._currentPath,t),this.ctx.restore(),this.ctx.restore(),t.delete(),null===(u=e)||void 0===u||u.delete()}}}_paintInner(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.ctx&&this._currentPath&&e){let i=this.ctx,n=this._currentPath;this._applyEffectsToPaint(e,e=>{let r=!1;!t&&"center"!==this._strokeMode&&(i.save(),i.clipPath(n,"outside"===this._strokeMode?Y2.ClipOp.Difference:Y2.ClipOp.Intersect,!0),r=!0),i.drawPath(n,e),r&&i.restore()},t)}}_hasDropShadow(){var e;return(null===(e=this._dropShadowColor)||void 0===e?void 0:e.a)>0}_hasInnerShadow(){var e;return(null===(e=this._innerShadowColor)||void 0===e?void 0:e.a)>0}path(e){var t;null===(t=this._currentPath)||void 0===t||t.addPath(Y2.Path.MakeFromSVGString(e))}ellipse(e,t,i,n,r,a,o,s){var l;if(!a3([e,t,i,n])||!this._currentPath)return;if(i<0||n<0)throw Error("radii cannot be negative");let c=Y2.XYWHRect(e-i,t-n,2*i,2*n);null===(l=this._currentPath)||void 0===l||l.addOval(c)}rect(e,t,i,n){var r;let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=Y2.XYWHRect(e,t,i,n);if(a3(c))if(0===a&&0===o&&0===l&&0===s)null===(r=this._currentPath)||void 0===r||r.addRect(c);else{var d;let e=Y2.RRectXY(c,a,a);e[4]=e[5]=a,e[6]=e[7]=o,e[8]=e[9]=s,e[10]=e[11]=l,null===(d=this._currentPath)||void 0===d||d.addRRect(e)}}getHorizontalAlign(e){switch(e){case 2:return Y2.TextAlign.Right;case 3:return Y2.TextAlign.Center;case 4:return Y2.TextAlign.Justify;default:return Y2.TextAlign.Left}}drawTextInner(e,t,i,n,r,a){let[o,s,l,c]=n,d=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],u=0,{ctx:h}=this;if(!h)return u;let p=a.copy(),f=a.copy();return f.setAlphaf(0),this._applyEffectsToPaint(p,n=>{t.pushPaintStyle(i,n,f),t.addText(e);let a=t.build();a.layout(l);let d=s;2===r?d+=(c-a.getHeight())/2:3===r&&(d+=c-a.getHeight()),h.drawParagraph(a,o,d),u=a.getHeight(),t.reset(),a.delete()},d),p.delete(),f.delete(),u}drawText(e,t){let i=0,n=this._fonts.get(t.font),{ctx:r,_paintFill:a,_paintStroke:o}=this;if(n&&r){let r=new Y2.TextStyle({fontFamilies:[t.font],fontSize:t.fontSize,heightMultiplier:t.lineHeight,letterSpacing:t.letterSpacing}),s=new Y2.ParagraphStyle({textStyle:r,textAlign:this.getHorizontalAlign(t.horizontalAlign)}),l=Y2.XYWHRect(t.x,t.y,t.width,t.height),c=Y2.ParagraphBuilder.Make(s,n);a&&(i=this.drawTextInner(e,c,r,l,t.verticalAlign,a,!0)),o&&(i=this.drawTextInner(e,c,r,l,t.verticalAlign,o,!1)),c.delete()}return{height:i}}render(){var e;null===(e=this._surface)||void 0===e||e.flush()}moveTo(e,t){var i;null===(i=this._currentPath)||void 0===i||i.moveTo(e,t)}lineTo(e,t){var i;null===(i=this._currentPath)||void 0===i||i.lineTo(e,t)}bezierCurveTo(e,t,i,n,r,a){var o;null===(o=this._currentPath)||void 0===o||o.cubicTo(e,t,i,n,r,a)}quadraticCurveTo(e,t,i,n){var r;null===(r=this._currentPath)||void 0===r||r.quadTo(e,t,i,n)}setTransform(e){var t,i,n,r;let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.ctx)return;let o=this.ctx.getTotalMatrix(),s=I2.invert(o);if(s&&this.ctx.concat(s),null!==(t=this.ctx)&&void 0!==t&&t.scale(this.dpr,this.dpr),null!==(i=this.camera)&&void 0!==i&&i.enabled&&(null!==(n=this.ctx)&&void 0!==n&&n.concat(this.camera.worldMatrix),a)){var l;let e=I2.getScale(this.camera.worldMatrix);null===(l=this.ctx)||void 0===l||l.scale(1/e[0],1/e[1])}null!==(r=this.ctx)&&void 0!==r&&r.concat(e),this.currentTransform=e}transform(e){var t;null===(t=this.ctx)||void 0===t||t.concat(e)}setSize(e,t){var i;!this._isSizeDirty&&e===this._width&&t===this._height||(this._isSizeDirty=!1,this._width=e,this._height=t,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.canvas.width=e*this.dpr,this.canvas.height=t*this.dpr,this._surface&&(this._surface=Y2.MakeWebGLCanvasSurface(this.canvas),this.ctx=null===(i=this._surface)||void 0===i?void 0:i.getCanvas()))}};function a3(e){for(let t=0;t<e.length;t++)if(void 0!==e[t]&&!Number.isFinite(e[t]))return!1;return!0}function o3(e){let{r:t,g:i,b:n,a:r}=e;return Y2.Color4f(t,i,n,r)}var s3,l3,c3,d3=class{constructor(e,t,i){this.uuid=e,this.data=t,this.enabled=!1,this.color=TV.transparent,this.blurRadius=0,this.offset=[0,0],this.spread=0,this.update(t)}update(e){void 0!==e.color&&(this.color=e.color),void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.blurRadius&&(this.blurRadius=e.blurRadius),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.spread&&(this.spread=e.spread)}},u3=class{constructor(e,t,i){this.uuid=e,this.data=t,this.enabled=!1,this.radius=0,this.update(t)}update(e){void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.radius&&(this.radius=e.radius)}},h3=class{constructor(e,t,i){this.uuid=e,this.data=t,this.enabled=!1,this.color=TV.transparent,this.update(t)}update(e){void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.color&&(this.color=e.color)}},p3=class{constructor(e,t,i){this.uuid=e,this.data=t,this.enabled=!1,this.color=TV.transparent,this.thickness=0,this.mode="inside",this.update(t)}update(e){void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.color&&(this.color=e.color),void 0!==e.thickness&&(this.thickness=e.thickness),void 0!==e.mode&&(this.mode=e.mode)}},f3=class extends j2{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.autoClose=!0,this.fill=new h3(e+"-fill",t.fill,i),this.stroke=new p3(e+"-stroke",t.stroke,i),this.dropShadow=new d3(e+"-dropShadow",t.dropShadow,i),this.innerShadow=new d3(e+"-innerShadow",t.innerShadow,i),this.backgroundBlur=new u3(e+"-backgroundBlur",t.backgroundBlur,i),this.layerBlur=new u3(e+"-layerBlur",t.layerBlur,i)}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:TV.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:TV.transparent,e.strokeMode=this.stroke.mode,e.lineWidth=this.stroke.thickness}applyFilters(e){this.layerBlur.enabled?e.layerBlur=5*this.layerBlur.radius:e.layerBlur=0,this.backgroundBlur.enabled?e.backgroundBlur=5*this.backgroundBlur.radius:e.backgroundBlur=0,this.dropShadow.enabled?(e.dropShadowBlur=5*this.dropShadow.blurRadius,e.dropShadowColor=this.dropShadow.color,e.dropShadowOffsetX=this.dropShadow.offset[0],e.dropShadowOffsetY=this.dropShadow.offset[1]):e.dropShadowColor=TV.transparent,this.innerShadow.enabled?(e.innerShadowSpread=this.innerShadow.spread,e.innerShadowBlur=5*this.innerShadow.blurRadius,e.innerShadowColor=this.innerShadow.color,e.innerShadowOffsetX=this.innerShadow.offset[0],e.innerShadowOffsetY=this.innerShadow.offset[1]):e.innerShadowColor=TV.transparent}innerDraw(e){}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.applyFilters(e),this.applyFillStroke(e),e.beginPath(),this.innerDraw(e),this.autoClose&&e.closePath(),this.fill.enabled&&e.fill(),this.stroke.enabled&&e.stroke(),e.restore())}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),0===e.type&&(xF(e.path,["fill"])?this.fill.update(e.props):xF(e.path,["stroke"])?this.stroke.update(e.props):xF(e.path,["dropShadow"])?this.dropShadow.update(e.props):xF(e.path,["innerShadow"])?this.innerShadow.update(e.props):xF(e.path,["layerBlur"])?this.layerBlur.update(e.props):xF(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}updateState(e,t){super.updateState(e,t),void 0!==e.fill&&this.fill.update(e.fill),void 0!==e.stroke&&this.stroke.update(e.stroke),void 0!==e.dropShadow&&this.dropShadow.update(e.dropShadow),void 0!==e.innerShadow&&this.innerShadow.update(e.innerShadow),void 0!==e.layerBlur&&this.layerBlur.update(e.layerBlur),void 0!==e.backgroundBlur&&this.backgroundBlur.update(e.backgroundBlur)}clone(e){let t=new f3(this.uuid,this.data,e);return t.parent=void 0,t}},m3=class extends f3{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.width=0,this.height=0,this.updateState(t,i)}innerDraw(e){e.ellipse(.5*this.width,.5*this.height,.5*this.width,.5*this.height,0,0,2*Math.PI)}intersectsInLocalSpace(e,t){return function(e,t,i,n,r,a){let o=e-i,s=t-n;return o*o/(r*r)+s*s/(a*a)<=1}(e,t,.5*this.width,.5*this.height,.5*this.width,.5*this.height)}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e)}clone(e){let t=new m3(this.uuid,this.data,e);return t.parent=void 0,t}},g3=class extends f3{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.width=0,this.height=0,this.cornerRadius=[0,0,0,0],this.updateState(t,i)}innerDraw(e){e.rect(0,0,this.width,this.height,...this.cornerRadius)}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateCornerState(e){void 0!==e.cornerRadius&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e)}clone(e){let t=new g3(this.uuid,this.data,e);return t.parent=void 0,t}},v3=class extends f3{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this._textHeight=0,this._textHeightDirty=!0,this.width=0,this.height=0,this.updateState(t,i)}get textHeight(){return this._textHeight}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:TV.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:TV.transparent,e.strokeMode="center",e.lineWidth=this.stroke.thickness}innerDraw(e){var t,i,n;(null===(t=this._fontHolder)||void 0===t?void 0:t.arrayBuffer)&&this._fontHolder.arrayBuffer.byteLength>1&&this.data.font&&e.registerFont(this._fontHolder.arrayBuffer,this.data.font);let r=this.data.textTransform,a=this.data.text.textValue.toString(),o=2===r?a.toUpperCase():3===r?a.toLowerCase():a,{height:s}=e.drawText(o,{x:0,y:0,width:this.width,height:this.height,fontSize:this.data.fontSize,lineHeight:null!==(i=this.data.lineHeight)&&void 0!==i?i:1,letterSpacing:null!==(n=this.data.letterSpacing)&&void 0!==n?n:0,horizontalAlign:this.data.horizontalAlign,verticalAlign:this.data.verticalAlign,font:this.data.font});this._textHeight=s}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateFontState(e,t){let{shared:i}=t;void 0!==e.font&&(this._fontHolder=i.getFont(e.font),this._fontHolder&&!this._fontHolder.isLoaded&&this._fontHolder.loadingPromise.then(()=>{this.requestRender()}))}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateFontState(e,t)}clone(e){let t=new v3(this.uuid,this.data,e);return t.parent=void 0,t}},y3=class extends f3{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.curves=[],this.extremasBBox={min:[0,0],max:[0,0]},this.updateState(t,i)}computeExtremas(){0===this.curves.length&&this.computeCurves();let e=this.curves.map(e=>s3.extremas(e)),t=[1/0,1/0],i=[-1/0,-1/0];for(let n=0,r=e.length;n<r;n++){let r=e[n];r[0][0]<t[0]&&(t[0]=r[0][0]),r[0][1]<t[1]&&(t[1]=r[0][1]),r[1][0]>i[0]&&(i[0]=r[1][0]),r[1][1]>i[1]&&(i[1]=r[1][1])}return this.extremasBBox.min=[t[0],t[1]],this.extremasBBox.max=[i[0],i[1]],this.extremasBBox}computeCurves(){this.curves=[];for(let i=1,n=this.data.points.length;i<n;i++){let e=this.data.points[i].data,t=this.data.points[i-1].data,n={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(n)}let e=this.data.points[0].data,t=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let i={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(i)}}getCenter(){let[e,t]=this.extremasBBox.min,[i,n]=this.getHalfSize();return[e+i,t+n]}getHalfSize(){let{min:e,max:t}=this.extremasBBox;return[.5*(t[0]-e[0]),.5*(t[1]-e[1])]}innerDraw(e){for(let n=0,r=this.data.points.length;n<r;n++){let t=this.data.points[n].data;if(0===n){let[i,n]=t.position;e.moveTo(i,n)}else{let i=this.data.points[n-1].data,[r,a]=i.controlNext.position,[o,s]=t.controlPrevious.position,[l,c]=t.position,d={start:i.position,cp1:i.controlNext.position,cp2:t.controlPrevious.position,end:t.position};s3.derive(d),e.bezierCurveTo(r,a,o,s,l,c)}}let t=this.data.points[0].data,i=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let[n,r]=i.controlNext.position,[a,o]=t.controlPrevious.position,[s,l]=t.position;e.bezierCurveTo(n,r,a,o,s,l)}}updateState(e,t){super.updateState(e,t),this.computeExtremas()}clone(e){let t=new y3(this.uuid,this.data,e);return t.parent=void 0,t}};(e=>{function t(e,t,i){let n=e-2*t+i;if(0!==n){let r=-Math.sqrt(Math.abs(t*t-e*i)),a=-e+t;return[-(r+a)/n,-(-r+a)/n]}return t!==i&&0===n?[(2*t-i)/(2*(t-i))]:[]}e.derive=function(e){let t=e.start,i=e.cp1,n=e.cp2,r=e.end,a={start:[3*(i[0]-t[0]),3*(i[1]-t[1])],cp:[3*(n[0]-i[0]),3*(n[1]-i[1])],end:[3*(r[0]-n[0]),3*(r[1]-n[1])]};return e.derivative=a,a.derivative=l3.derive(a),a},e.droot=function(i){var n;let r=null!==(n=i.derivative)&&void 0!==n?n:e.derive(i),a=r.start,o=r.cp,s=r.end;return[t(a[0],o[0],s[0]),t(a[1],o[1],s[1])]},e.extremas=function(t){let[i,n]=e.droot(t),r=[t.start[0],t.end[0]],a=[t.start[1],t.end[1]];for(let o of i)r.push(e.compute(t,Math.min(1,Math.max(0,o)))[0]);for(let o of n)a.push(e.compute(t,Math.min(1,Math.max(0,o)))[1]);return r.sort((e,t)=>e-t),a.sort((e,t)=>e-t),[[r[0],a[0]],[r[r.length-1],a[a.length-1]]]},e.compute=function(e,t){if(0===t)return[...e.start];if(1===t)return[...e.end];let i=1-t,n=i*i,r=t*t,a=n*i,o=n*t*3,s=i*r*3,l=t*r;return[a*e.start[0]+o*e.cp1[0]+s*e.cp2[0]+l*e.end[0],a*e.start[1]+o*e.cp1[1]+s*e.cp2[1]+l*e.end[1]]}})(s3||(s3={})),(e=>{e.derive=function(e){let t=e.start,i=e.cp,n=e.end,r={start:[2*(i[0]-t[0]),2*(i[1]-t[1])],end:[2*(n[0]-i[0]),2*(n[1]-i[1])]};return r.derivative=c3.derive(r),e.derivative=r,r},e.droot=function(t){var i;let n=null!==(i=t.derivative)&&void 0!==i?i:e.derive(t),r=n.start,a=n.end;return[r[0]!==a[0]?r[0]/(r[0]-a[0]):0,r[1]!==a[1]?r[1]/(r[1]-a[1]):0]},e.compute=function(e,t){if(0===t)return[...e.start];if(1===t)return[...e.end];let i=1-t,n=i*i,r=i*t*2,a=t*t;return[n*e.start[0]+r*e.cp[0]+a*e.end[0],n*e.start[1]+r*e.cp[1]+a*e.end[1]]}})(l3||(l3={})),(e=>{e.derive=function(e){let t=e.start,i=e.end,n=[i[0]-t[0],i[1]-t[1]];return e.derivative=n,e.derivative},e.compute=function(e,t){if(0===t)return[...e.start];if(1===t)return[...e.end];let i=e.start,n=e.end;return[i[0]+(n[0]-i[0])*t,i[1]+(n[1]-i[1])*t]}})(c3||(c3={}));var b3=class extends W2{constructor(e,t,i){super(e,t,i),this.uuid=e,this.width=0,this.height=0,this.clipped=!0,this.background=new g3(e+"-background",NW.defaultData,i),this.background.parent=this,this.updateState(t,i)}get fill(){return this.background.fill}get stroke(){return this.background.stroke}get backgroundBlur(){return this.background.backgroundBlur}get layerBlur(){return this.background.layerBlur}get dropShadow(){return this.background.dropShadow}get innerShadow(){return this.background.innerShadow}get cornerRadius(){return this.background.cornerRadius}set cornerRadius(e){this.background.cornerRadius=e}updateLocalMatrix(){var e;super.updateLocalMatrix(),null===(e=this.background)||void 0===e||e.updateLocalMatrix()}updateWorldMatrix(e,t,i){var n;super.updateWorldMatrix(e,t,i),null===(n=this.background)||void 0===n||n.updateWorldMatrix(e,t,i)}draw(e){if(!this.visible)return;e.save();let t=this.width,i=this.height;this.applyTransforms(e),this.background.width=t,this.background.height=i,this.background.draw(e),this.clipped&&e.clipRect(0,0,t,i,...this.cornerRadius),this.innerDrawChildren(e),e.restore()}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateCornerState(e){void 0!==e.cornerRadius&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e),void 0!==e.fill&&this.fill.update(e.fill),void 0!==e.stroke&&this.stroke.update(e.stroke),void 0!==e.dropShadow&&this.dropShadow.update(e.dropShadow),void 0!==e.innerShadow&&this.innerShadow.update(e.innerShadow),void 0!==e.layerBlur&&this.layerBlur.update(e.layerBlur),void 0!==e.backgroundBlur&&this.backgroundBlur.update(e.backgroundBlur),void 0!==e.clipped&&(this.clipped=e.clipped)}requestRender(){super.requestRender(),this.dispatchEvent({type:"render"})}dispose(){this.removeEventListener("render")}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),0===e.type&&(xF(e.path,["fill"])?this.fill.update(e.props):xF(e.path,["stroke"])?this.stroke.update(e.props):xF(e.path,["dropShadow"])?this.dropShadow.update(e.props):xF(e.path,["innerShadow"])?this.innerShadow.update(e.props):xF(e.path,["layerBlur"])?this.layerBlur.update(e.props):xF(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}clone(e){let t=new b3(this.uuid,this.data,e);t.parent=void 0;for(let i of this.children)t.add(i.clone(e));return t}},x3=Ow(Nw(),1),w3=class extends f3{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this._pathBBox=new DOMRect,this.path="",this.updateState(t,i),this.autoClose=!1,this.computeSVGBBox()}computeSVGBBox(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","path");document.body.appendChild(e),t.setAttribute("d",this.path),e.appendChild(t),this._pathBBox=t.getBBox(),e.remove()}innerDraw(e){e.path(this.path)}intersectsInLocalSpace(e,t){return e>=this._pathBBox.x&&e<=this._pathBBox.x+this._pathBBox.width&&t>=this._pathBBox.y&&t<=this._pathBBox.y+this._pathBBox.height}getCenter(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}getHalfSize(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}updateState(e,t){super.updateState(e,t),void 0!==e.path&&(this.path=e.path,this.computeSVGBBox())}clone(e){let t=new w3(this.uuid,this.data,e);return t.parent=void 0,t}};var S3=class{constructor(e,t,i){this.uuid=e,this.data=t,this.group=new H2(S3.GROUP_ID,c({},jW.defaultData),i),this.createChildrenObjects(t.objects,this.group,i)}createObject(e,t,i,n,r,a){let o=function(e,t,i){switch(t.type){case"ellipse2d":return new m3(e,t,i);case"rectangle2d":return new g3(e,t,i);case"text2d":return new v3(e,t,i);case"vector2d":return new y3(e,t,i);case"path2d":return new w3(e,t,i);case"frame2d":return new b3(e,t,i);default:return new H2(e,t,i)}}(e,t,a);o&&(n.add(o),n.children.splice(r,0,n.children.pop()),o.updateWorldMatrix(),i.length>0&&(o instanceof H2||o instanceof b3)&&this.createChildrenObjects(i,o,a))}createChildrenObjects(e,t,i){let n=0;for(let r of e)this.createObject(r.id,r.data,r.children,t,n,i),n+=1}draw(e){this.group.draw(e)}updateEntityByOp(e,t,i,n){let r=this.find(e);if(r)try{r.updateByOp(t,i,{shared:n})}catch(hV){console.error(hV)}}updateTreeByOp(e,t){if(0===e.path.length&&7===e.type){let i=null===e.parent?this.group:this.find(e.parent);void 0!==i&&i instanceof W2&&(this.createObject(e.id,e.data,e.children,i,e.localIndex,t),i.requestRender())}else if(0===e.path.length&&8===e.type){let t=this.find(e.id);if(void 0!==t&&void 0!==t.parent&&t.parent instanceof W2){let e=t.parent;t.resetBBoxNeedsUpdate(),null!==e&&void 0!==e&&e.remove(t),null===e||void 0===e||e.requestRender()}}else if(0===e.path.length&&9===e.type){let t=this.find(e.id);if(void 0!==t){let i=t.parent,n=null===e.parent?this:this.find(e.parent);if(n instanceof W2||n===this){n.add(t);let r=e.localIndex;n.children.splice(r,0,n.children.pop()),t.updateWorldMatrix(!0,!1,!0),null!==i&&void 0!==i&&i.requestRender(),t.requestRender()}t.resetBBoxNeedsUpdate()}}}add(e){this.group.add(e)}remove(e){this.group.remove(e)}traverse(e){this.group.traverse(t=>{t!==this.group&&e(t)})}intersectsChildren(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.group.intersectsChildren(e,t,i,n,r,!0)}intersectsChildrenReverse(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.group.intersectsChildrenReverse(e,t,i,n,r,!0)}find(e){return this.group.find(e)}get children(){return this.group.children}project(e,t){return this.group.project(e,t)}getWithSortKey(e){let t=this.find(e);if(void 0===t)return;let i=[],n=t;for(;n!==this.group;){let e=n;n=n.parent;let t=n.children.indexOf(e);i.splice(0,0,t)}return{entity:t,sortKey:i}}getAllSorted(e){let t=[];for(let i of e){let e=this.getWithSortKey(i.id);void 0!==e&&t.push(e)}return t.sort((e,t)=>dN(e.sortKey,t.sortKey)),t.map(e=>e.entity)}},_3=S3;function C3(e){let{constraints:t,newParentWidth:i,newParentHeight:n,initialParentWidth:r,initialParentHeight:a,objectInitialWidth:o,objectInitialHeight:s,objectInitialPosition:l}=e,{horizontalConstraint:c,verticalConstraint:d}=t,u=i-r,h=n-a,p=o,f=s,m=l[0],g=l[1];if(0!==c)if(1===c)m+=u;else if(3===c)m+=u/2;else if(2===c)p=Math.max(1,p+u);else if(4===c){let e=i/r;p*=e,m*=e}if(0!==d)if(1===d)g+=h;else if(3===d)g+=h/2;else if(2===d)f=Math.max(1,f+h);else if(4===d){let e=n/a;f*=e,g*=e}return{width:p,height:f,position:[m,g]}}_3.GROUP_ID="scene2d";Ow(Nw(),1);var E3=new uA(-1,1,1,-1,0,1),A3=new class extends vE{constructor(){super(),this.setAttribute("position",new cE([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new cE([0,2,0,0,2,0],2))}},M3=new NE({defines:{},uniforms:{tDiffuse:new yO(null)},vertexShader:"\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tvUv = uv;\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t}",fragmentShader:"\n\tuniform sampler2D tDiffuse;\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\tgl_FragColor = texel;\n\t}"}),T3=new class{constructor(e){this._mesh=new OE(A3,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,E3)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}(M3),P3=null,D3=null,O3=I2.identity(),I3=class{constructor(e,t,i,n){this.uuid=e,this.width=t,this.height=i,this.context=n,this.enabled=!0,this.isScreenSpace=!1,this.dpr=window.devicePixelRatio,this.isFrameDirty=!1,this.onRenderRequestedDownstream=()=>{this.isFrameDirty=!0,this.context.shared.requestRender()},this._innerApplySize=()=>{let e=this.width,t=this.height,i=this.dpr;this.renderer.dpr=this.isScreenSpace?i:Math.floor(2048/Math.max(e,t)),this.renderer.setSize(e,t)},this.onFrameOverrideObjectEvent=e=>{var t;if(void 0!==(null===(t=e.target)||void 0===t?void 0:t.uuid)){var i;let t=null===(i=this.frameRoot)||void 0===i?void 0:i.find(e.target.uuid);t&&t.dispatchEvent(c(c({},e),{},{target:t}))}},this.scene2d=new _3(h_.generateUUID(),GW.defaultData,{dpr:window.devicePixelRatio,shared:n.shared}),this.canvas=(null===P3&&(P3=document.createElement("canvas")),P3),this.renderer=(e=>(null===D3&&(D3=new r3(e)),D3))(this.canvas),this.promise=this.init(),this.renderTarget=new N_(1,1,{type:_S,stencilBuffer:!1,depthBuffer:!1}),n.shared.addUIBuffer(this.uuid,this.renderTarget),this.textureHolder=n.shared.uiBuffer(this.uuid)}get canvasTexture(){return this._canvasTexture||(this._canvasTexture=new rP(this.canvas)),this._canvasTexture}async init(){this.renderer instanceof r3&&(this.renderer.wasmURL=oZ.skiaWasmUrl),await this.renderer.init()}render(e){if(this.isFrameDirty){var t,i;this.isFrameDirty=!1,this._innerApplySize(),this.renderer.clear(),null!==(t=this.frameOverride)&&void 0!==t&&t.draw(this.renderer),this.renderer.render(),M3.uniforms.tDiffuse.value=this.canvasTexture,this.canvasTexture.needsUpdate=!0;let n=e.getRenderTarget();e.setRenderTarget(this.renderTarget),e.clear(),T3.render(e),e.setRenderTarget(n),null===(i=this.textureHolder)||void 0===i||i.setNeedsUpdate(!0)}}updateEntity2DByOp(e,t,i,n){this.scene2d.updateEntityByOp(e,t,i,n),this.applySize()}updateTreeByOp(e,t){this.scene2d.updateTreeByOp(e,t),this.applySize()}applyOverrides(e){if(this.frameOverride&&this.frameRoot){var t,i;this.frameOverride.position=[0,0],this.frameOverride.rotation=0;let n=null!==(t=null===e||void 0===e?void 0:e.width)&&void 0!==t?t:this.width,r=null!==(i=null===e||void 0===e?void 0:e.height)&&void 0!==i?i:this.height;this.frameOverride.width=n,this.frameOverride.height=r,this.frameOverride.localMatrix=O3,this.isScreenSpace&&(this.frameOverride.fill.color=TV.from0to1([0,0,0,0])),this.frameOverride.data=c(c({},this.frameOverride.data),{},{width:n,height:r}),k3({objectOverride:this.frameOverride,objectRoot:this.frameRoot,newParentWidth:this.frameOverride.width,newParentHeight:this.frameOverride.height,initialParentWidth:this.frameRoot.width,initialParentHeight:this.frameRoot.height}),this.frameOverride.updateWorldMatrix(!0,!1,!0)}}applySize(e){var t,i,n,r;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.devicePixelRatio,o=Math.max(1,null!==(t=null===e||void 0===e?void 0:e.width)&&void 0!==t?t:this.width),s=Math.max(1,null!==(i=null===e||void 0===e?void 0:e.height)&&void 0!==i?i:this.height);this.dpr=a,this.width=o,this.height=s,this._innerApplySize();let l=1;(o*a<512||s*a<512)&&(l=Math.max(512/(o*a),512/(s*a))),this.renderTarget.setSize(o*a*l,s*a*l),null!==(n=this._canvasTexture)&&void 0!==n&&n.dispose(),this._canvasTexture=void 0,this.applyOverrides(e),null===(r=this.frameOverride)||void 0===r||r.requestRender()}applyFrame(e){var t,i;let n=this.context.scene.find2D(e);if(n&&n instanceof b3)return this.disposeFrameOverride(),this.frameRoot=n,this.frameOverride=n.clone({dpr:this.renderer.dpr,shared:this.context.shared}),this.scene2d.add(this.frameOverride),this.applySize(),null!==(t=this.frame)&&void 0!==t&&t.addEventListener("render",this.onRenderRequestedDownstream),this.frameOverride.traverse(e=>{e.addEventListener("beginState",this.onFrameOverrideObjectEvent)}),this.frameOverride.traverse(e=>{e.addEventListener("completeState",this.onFrameOverrideObjectEvent)}),null!==(i=this.frame)&&void 0!==i&&i.requestRender(),n}get frame(){return this.frameOverride}get frameId(){var e;return null===(e=this.frame)||void 0===e?void 0:e.uuid}find(e){return this.scene2d.find(e)}get texture(){var e;return null===(e=this.textureHolder)||void 0===e?void 0:e.getTexture(1001)}disposeFrameOverride(){var e,t,i;null!==(e=this.frameOverride)&&void 0!==e&&e.removeEventListener("render",this.onRenderRequestedDownstream),null!==(t=this.frameOverride)&&void 0!==t&&t.traverse(e=>{e.removeEventListener("beginStateChange",this.onFrameOverrideObjectEvent)}),null!==(i=this.frameOverride)&&void 0!==i&&i.traverse(e=>{e.removeEventListener("completeState",this.onFrameOverrideObjectEvent)}),this.frameOverride&&this.scene2d.remove(this.frameOverride)}};function k3(e){let{objectOverride:t,objectRoot:i,newParentWidth:n,newParentHeight:r,initialParentWidth:a,initialParentHeight:o}=e;if(t instanceof b3&&i instanceof b3||t instanceof H2&&i instanceof H2)for(let s=0,l=t.children.length;s<l;s++){let e=t.children[s],l=i.children[s];e&&l&&e.uuid===l.uuid&&R3({objectOverride:e,objectRoot:l,newParentWidth:n,newParentHeight:r,initialParentWidth:a,initialParentHeight:o})}}function R3(e){let{objectOverride:t,objectRoot:i,newParentWidth:n,newParentHeight:r,initialParentWidth:a,initialParentHeight:o}=e,[s,l]=function(e){if(L3(e))return[e.width,e.height];if(e instanceof w3){let[t,i]=e.getHalfSize();return[2*t,2*i]}if(e instanceof H2){let[t,i]=e.recursiveBBox.getHalfSize();return[2*t,2*i]}return[0,0]}(i),{width:d,height:u,position:h}=C3({constraints:t.data,newParentWidth:n,newParentHeight:r,initialParentWidth:a,initialParentHeight:o,objectInitialWidth:s,objectInitialHeight:l,objectInitialPosition:i.position});if(t.position=h,t.data=c(c({},t.data),{},{position:h}),t.states)for(let c in t.states)z3({stateId:c,objectOverride:t,objectRoot:i,newParentWidth:n,newParentHeight:r,initialParentWidth:a,initialParentHeight:o});if(L3(t)||t instanceof H2)L3(t)&&(t.width=d,t.height=u,t.data=c(c({},t.data),{},{width:d,height:u})),k3({objectOverride:t,objectRoot:i,newParentWidth:d,newParentHeight:u,initialParentWidth:s,initialParentHeight:l});else if(t instanceof w3){let e=i,n=0!==s?d/s:1,r=0!==l?u/l:1;t.path=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t<=0||i<=0)return e;let n=(0,x3.parseSVG)(e).map(e=>{let n=c({},e);return"x"in n&&(n.x=n.x*t),"y"in n&&(n.y=n.y*i),"x1"in n&&(n.x1=n.x1*t),"x2"in n&&(n.x2=n.x2*t),"y1"in n&&(n.y1=n.y1*i),"y2"in n&&(n.y2=n.y2*i),"rx"in n&&(n.rx=n.rx*t),"ry"in n&&(n.ry=n.ry*i),n});return function(e){let t,i=["rx","ry","xAxisRotation","largeArc","sweep","x1","y1","x2","y2","x","y"];return e.map(e=>{let n=[];i.forEach(t=>{if(t in e){let i=1*e[t];n.length&&i>=0&&n.push(","),n.push(i)}});let r=(t===e.code?n[0]<0?"":",":e.code)+n.join("");return t=e.code,r}).join("")}(n)}(e.path,n,r),t.data=c(c({},t.data),{},{path:t.path})}}function z3(e){var t,i;let{stateId:n,objectOverride:r,objectRoot:a,newParentWidth:o,newParentHeight:s,initialParentWidth:l,initialParentHeight:c}=e,d=null===(t=r.states)||void 0===t?void 0:t[n],u=null===(i=a.states)||void 0===i?void 0:i[n];if(d&&u){let{width:e,height:t,position:i}=C3({constraints:r.data,newParentWidth:o,newParentHeight:s,initialParentWidth:l,initialParentHeight:c,objectInitialWidth:HW.isResizeable(u)?u.width:0,objectInitialHeight:HW.isResizeable(u)?u.height:0,objectInitialPosition:u.position});Object.assign(r.states[n],{position:i}),HW.isResizeable(d)&&Object.assign(r.states[n],{width:e,height:t})}}function L3(e){return e instanceof g3||e instanceof b3||e instanceof m3||e instanceof v3}var B3=class extends(JG(OT)){constructor(e,t,i){super(),this.data=t,this.bgColor=new kQ(1,1,1,1),this.fog=null,this.backupFog=new DT(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new D_,this.penumbraSizeArrayCache=null,this.super_Entity(e,t),this.personalCamera=new h0(OV,c(c(c({},Bj.defaultData),t.camera),{},{name:"Personal Camera"})),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new FD(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight),t.uiScene?this.uiScene=new _3((Array.isArray(e)?e[0]:e)+"-ui",t.uiScene,{dpr:window.devicePixelRatio,shared:i.shared}):t.uiFrame&&this.createUICanvas(t.uiFrame,i)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}get frameId(){return this.data.uiFrame}get frame(){var e;return null===(e=this.uiCanvas)||void 0===e?void 0:e.frame}createUICanvas(e,t){this.uiCanvas=new I3(this.uuid+"-uiscreen",window.innerWidth,window.innerHeight,t),this.uiCanvas.isScreenSpace=!0,this.uiCanvas.promise.then(()=>{var t,i;null!==(t=this.uiCanvas)&&void 0!==t&&t.applyFrame(e),null===(i=this.uiCanvas)||void 0===i||i.applySize()})}updateVisible(){}setBackgroundColor(e){this.bgColor=e,!0===this.fogUseBGColor&&(this.backupFog.color=e)}entityChildrenCount(){return this.uiScene?this.uiScene.children.length:super.entityChildrenCount()}updateAmbientLight(e,t){void 0!==e.color&&(this.ambientLight.color=jZ(e.color,t)),void 0!==e.intensity&&(this.ambientLight.intensity=e.intensity),void 0!==e.enabled&&(e.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(e){this.isActive=!0,e.fog=this.fog,this.traverseEntity(e=>{e instanceof v0&&e.recomputeBoolean()}),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(e=>{if(e instanceof JJ)if(Array.isArray(e.material))for(let t of e.material)t.needsUpdate=!0;else e.material.needsUpdate=!0,e.material.dispose()})}updateShadow(e){void 0!==e.softShadowQuality&&this.isActive&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"medium";if(y2===e)return!1;y2=e;let t=(e=>{switch(e){case"low":return 8;case"medium":default:return 16;case"high":return 32}})(e);tA.shadowmap_pars_fragment=(e=>"\n\n// PCSS implementation based on:\n// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/\n// NOTE: This number affects how big the shadow blur can\n// possibly get. Bigger number == bigger blur, but less precise results\n\nconst float  gPenumbraFilterSize = 80.0;\nconst int   gPenumbraSamples = ".concat(e,";\nconst int gShadowSamples = ").concat(e,";\nconst float gShadowSamplesRpc = 1.0f / float(gShadowSamples);\n\n#ifdef USE_SHADOWMAP\n    #if NUM_DIR_LIGHT_SHADOWS > 0\n\n        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n        struct DirectionalLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n        };\n\n        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\n    #endif\n\n    #if NUM_SPOT_LIGHT_SHADOWS > 0\n\n        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n        struct SpotLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n        };\n\n        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\n    #endif\n\n    #if NUM_POINT_LIGHT_SHADOWS > 0\n\n        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n        struct PointLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n            float shadowCameraNear;\n            float shadowCameraFar;\n        };\n\n        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\n    #endif\n\n    /*\n    #if NUM_RECT_AREA_LIGHTS > 0\n\n        // TODO (abelnation): create uniforms for area light shadows\n\n    #endif\n    */\n\nfloat computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)\n{\n    float penumbra = 1.0;\n    float blockerDepthAvg = 0.0;\n    float blockerCount = 0.0;\n\n    #pragma unroll_loop_start\n    for(int i = 0; i < gPenumbraSamples; i ++)\n    {\n        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;\n        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );\n\n        if(depth < compare + 0.0001)\n        {\n            blockerDepthAvg += depth;\n            blockerCount++;\n        }\n    }\n    #pragma unroll_loop_end\n\n    if (blockerCount > 0.0)\n    {\n        blockerDepthAvg /= blockerCount;\n\n        // Compute penumbra\n        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);\n        penumbra *= penumbra;\n        penumbra *= 200.0 * penumbraSize[min(index, ",5," - 1)]; // Magic number that affects how quickly the penumbra grows\n\n        return clamp(penumbra, 0.00, 1.0);\n    }\n    return 0.0;\n}\n\nfloat vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)\n{\n    float shadow         = 0.0f;\n\n    // NOTE: When using TAA, we should use screen space interleaved gradient noise\n    vec2 halton = haltonSequence[frameIndex];\n    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n    float temporalAngle  = temporalOffset * PI2;\n\n    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);\n    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);\n    if (penumbra == -1.0) {\n        return 1.0;\n    }\n\n    #pragma unroll_loop_start\n    for (int i = 0; i < gShadowSamples; i++)\n    {\n        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n        // Overall blurring offset\n        vec2 offset = vogelSample * (shadowRadius * 2.);\n\n        // Penumbra offset\n        offset += vogelSample * (penumbra * texelScalar);\n\n        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );\n    }\n    #pragma unroll_loop_end\n\n    return shadow * gShadowSamplesRpc;\n}\n\n\n    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\n        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\n    }\n\n    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\n        return unpackRGBATo2Half( texture2D( shadow, uv ) );\n\n    }\n\n    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\n        float occlusion = 1.0;\n\n        vec2 distribution = texture2DDistribution( shadow, uv );\n\n        float hard_shadow = step( compare , distribution.x ); // Hard Shadow\n\n        if (hard_shadow != 1.0 ) {\n\n            float distance = compare - distribution.x ;\n            float variance = max( 0.00000, distribution.y * distribution.y );\n            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality\n            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed\n            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\n        }\n        return occlusion;\n\n    }\n\n    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n        float shadow = 1.0;\n\n        shadowCoord.xyz /= shadowCoord.w;\n        shadowCoord.z += shadowBias;\n\n        // if ( something && something ) breaks ATI OpenGL shader compiler\n        // if ( all( something, something ) ) using this instead\n\n        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n        bool inFrustum = all( inFrustumVec );\n\n        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n        bool frustumTest = all( frustumTestVec );\n\n        if ( frustumTest ) {\n\n        #if defined( SHADOWMAP_TYPE_PCF )\n\n            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );\n\n        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n            float dx = texelSize.x;\n            float dy = texelSize.y;\n\n            vec2 uv = shadowCoord.xy;\n            vec2 f = fract( uv * shadowMapSize + 0.5 );\n            uv -= f * texelSize;\n\n            shadow = (\n                texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n                     f.x ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n                     f.x ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n                     f.y ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n                     f.y ) +\n                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n                          f.x ),\n                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n                          f.x ),\n                     f.y )\n            ) * ( 1.0 / 9.0 );\n\n        #elif defined( SHADOWMAP_TYPE_VSM )\n\n            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n        #else // no percentage-closer filtering:\n\n            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n        #endif\n\n        }\n\n        return shadow;\n\n    }\n\n    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\n    // vector suitable for 2D texture mapping. This code uses the following layout for the\n    // 2D texture:\n    //\n    // xzXZ\n    //  y Y\n    //\n    // Y - Positive y direction\n    // y - Negative y direction\n    // X - Positive x direction\n    // x - Negative x direction\n    // Z - Positive z direction\n    // z - Negative z direction\n    //\n    // Source and test bed:\n    // https://gist.github.com/tschw/da10c43c467ce8afd0c4\n\n    vec2 cubeToUV( vec3 v, float texelSizeY ) {\n\n        // Number of texels to avoid at the edge of each square\n\n        vec3 absV = abs( v );\n\n        // Intersect unit cube\n\n        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n        absV *= scaleToCube;\n\n        // Apply scale to avoid seams\n\n        // two texels less per square (one texel will do for NEAREST)\n        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\n        // Unwrap\n\n        // space: -1 ... 1 range for each square\n        //\n        // #X##         dim    := ( 4 , 2 )\n        //  # #         center := ( 1 , 1 )\n\n        vec2 planar = v.xy;\n\n        float almostATexel = 1.5 * texelSizeY;\n        float almostOne = 1.0 - almostATexel;\n\n        if ( absV.z >= almostOne ) {\n\n            if ( v.z > 0.0 )\n                planar.x = 4.0 - v.x;\n\n        } else if ( absV.x >= almostOne ) {\n\n            float signX = sign( v.x );\n            planar.x = v.z * signX + 2.0 * signX;\n\n        } else if ( absV.y >= almostOne ) {\n\n            float signY = sign( v.y );\n            planar.x = v.x + 2.0 * signY + 2.0;\n            planar.y = v.z * signY - 2.0;\n\n        }\n\n        // Transform to UV space\n\n        // scale := 0.5 / dim\n        // translate := ( center + 0.5 ) / dim\n        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n    }\n\n    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\n        float shadow = 1.0;\n        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\n        // for point lights, the uniform @vShadowCoord is re-purposed to hold\n        // the vector from the light to the world-space position of the fragment.\n        vec3 lightToPosition = shadowCoord.xyz;\n\n        // dp = normalized distance from light to fragment position\n        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?\n        compare += shadowBias;\n\n        // bd3D = base direction 3D\n        vec3 bd3D = normalize( lightToPosition );\n\n        vec2 halton = haltonSequence[frameIndex];\n        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n        float temporalAngle  = temporalOffset * PI2;\n\n        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )\n            for (int i = 0; i < gShadowSamples; i++) {\n                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n\n                // Overall blurring offset\n                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);\n\n                // NOTE: Removed for now\n                // Penumbra offset\n                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);\n\n                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );\n\n            }\n            return shadow * gShadowSamplesRpc;\n\n        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n            for (int i = 0; i < 16; i++) {\n                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n\n                // Overall blurring offset\n                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);\n\n                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );\n\n            }\n            return shadow * (1.0 / 16.0);\n        #else // no percentage-closer filtering\n\n            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );\n\n        #endif\n\n    }\n\n#endif\n"))(t);let i=g2.slice();i=i.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + ".concat(3,", spotShadowMap[ i ]")),i=i.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),tA.lights_fragment_begin=i;let n=v2.slice();return n=n.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),tA.shadowmask_pars_fragment=n,!0}(e.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(e,t){if(e.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){this.scene.fog=this.fog}this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=jZ(e.color,t),this.backupFog.near=e.near,this.backupFog.far=e.far}updateAo(e,t){void 0!==e.aoColor&&(this.aoColor=jZ(e.aoColor,t))}updateByOp(e,t,i,n){let r=this.data.uiFrame;super.updateByOp(e,t,i,n);let a=t;xF(e.path,["fog"])?this.updateFog(a.fog,i.shared):xF(e.path,["ao"])?this.updateAo(a.ao,i.shared):xF(e.path,["ambient"])?this.updateAmbientLight(a.ambient,i.shared):xF(e.path,["shadow"])?this.updateShadow(a.shadow):0===e.type&&0===e.path.length&&(void 0!==e.props.uiFrame||r!==a.uiFrame)&&this.updateUIFrame(e.props.uiFrame,i)}updateUIFrame(e,t){e?(this.uiCanvas||this.createUICanvas(e,t),this.uiCanvas.enabled=!0,this.uiCanvas.applyFrame(e)):this.uiCanvas&&(this.uiCanvas.enabled=!1)}updateState(e,t){this.updateState_Entity(e,t),void 0!==e.backgroundColor&&this.setBackgroundColor(jZ(e.backgroundColor,t.shared)),void 0!==e.fog&&this.updateFog(e.fog,t.shared),void 0!==e.ambient&&this.updateAmbientLight(e.ambient,t.shared),void 0!==e.ao&&this.updateAo(e.ao,t.shared),void 0!==e.shadow&&this.updateShadow(e.shadow)}createFrame(e,t){}raycast(e,t){super.raycast(e,t)}switchActiveCamera(e){e&&e.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=e,e.objectHelper.visible=!1)}get playCamera(){var e,t;return null!==(e=null===(t=this.scene)||void 0===t?void 0:t.find(this.data.publish.playCamera))&&void 0!==e?e:this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return null===this.penumbraSizeArrayCache&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let e=0,t=0;this.traverseEntity(i=>{var n,r;if(!i.visible)return!0;i instanceof k2&&i.visible&&e<3&&(this.penumbraSizeArrayCache[e]=null!==(n=i.data.penumbraSize)&&void 0!==n?n:.5,e+=1),i instanceof B2&&i.visible&&e<2&&(this.penumbraSizeArrayCache[3+t]=null!==(r=i.data.penumbraSize)&&void 0!==r?r:.5,t+=1)})}raycastWithClones(e){let t=[],i=n=>{for(let r of n.children){let n=r.cloner;PG.is(r)&&(r.visible||(null===n||void 0===n?void 0:n.object.data.visible))&&((b0(r)||w0(r)&&this.scene.enableHelpers&&r.objectHelper.visible)&&(e.intersectObject(r,!1,t),I4(r,e,t,!0)),i(r))}};return i(this),t}updateEntity2DByOp(e,t,i,n){var r;null===(r=this.uiCanvas)||void 0===r||r.updateEntity2DByOp(e,t,i,n)}},N3=class extends(y0(KD,C2)){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=90,n.aspect=1,n.near=100,n.far=2500;let r=new j_(-n.far+this.position.x,-n.far+this.position.y,-n.far+this.position.z),a=new j_(n.far+this.position.x,n.far+this.position.y,n.far+this.position.z),o=new G_(r,a),s=new FO(o,new D_(16755200));s.visible=!1,this.gizmos.shadowmap=s,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let e in this.gizmos){let t=this.gizmos[e];if(t instanceof FO){let e=this.shadow.camera,i=new j_(-e.far+this.position.x,-e.far+this.position.y,-e.far+this.position.z),n=new j_(e.far+this.position.x,e.far+this.position.y,e.far+this.position.z);t.box.set(i,n),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),void 0!==e.distance&&(this.distance=e.distance),void 0!==e.decay&&(this.decay=e.decay),void 0!==e.shadowRadius&&(this.shadow.radius=e.shadowRadius),void 0!==e.shadowResolution&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},F3=class extends r${get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let i=this.geometry.getAttribute("position");void 0!==i?wQ(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,e,t):super.updateEntityBoxSize(e,t)}},U3=class extends r${constructor(e,t,i){super(e,t,i),this._shapeId=null,this._context=i}updateState(e,t){super.updateState(e,t),this.updateShape(),this.refreshAttachedCloners(t)}updateShape(){let e,t=c({},this.data.geometry.extrusion.shape);for(let r in t)"string"==typeof t[r]&&(t[r]=this._context.shared.getVariable(t[r],[this.uuid,"geometry","extrusion","shape",r]));if("Custom"===t.type){let n=t.shapeId;if(n!==this._shapeId&&this.detachShape(),n){var i;this._shapeId=n;let t=this._context.scene.find(n);null!==t&&void 0!==t&&t.data&&(t.attachedPaths.add(this),e=null===(i=t.geometry.userData)||void 0===i?void 0:i.shape),e||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let i;switch(t.type){case"Rectangle":i=sY;break;case"Ellipse":i=AX;break;case"Polygon":i=iY;break;case"Star":i=cY;break;default:throw new Error("Unknown shape type: ".concat(t.type))}e=i.create({parameters:t}).userData.shape}let n=this.geometry;e&&n.inputs&&(n.inputs.shapeData=e,n.build())}detachShape(){var e;null!==this._shapeId&&(null===(e=this._context.scene.find(this._shapeId))||void 0===e||e.attachedPaths.delete(this))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e,t){return super.updateTransformState(e,t)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let i=this.geometry.getAttribute("position");void 0!==i?wQ(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,e,t):super.updateEntityBoxSize(e,t)}},V3=class extends R${constructor(e,t,i){super(e,t,i),this.data=t}},j3=class extends(a0(ST,A0)){constructor(e,t,i){super(),"Instance"===t.type&&"string"==typeof e&&(t=this.transformAssignData(t,i)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return"Component"===this.data.type&&"string"==typeof this.identity}get isInstanceRoot(){return"Instance"===this.data.type&&"string"==typeof this.identity}transformAssignData(e,t){let i=AW.getComponentData({scene:t.scene.data,shared:t.shared.data},e.component);if(i){let t,n;for(let r of Uj.rootOverrideProps)void 0===e[r]?(void 0===t&&(t=c({},e)),t[r]=i.data[r]):(void 0===n&&(n={}),n[r]=e[r],void 0===t&&(t=c({},e)),t[r]=jN.apply(i.data[r],e[r]));return this.overrideData=n,t}return c(c(c({},Oj.defaultData),e),KB(Oj.defaultData,Uj.rootOverrideProps))}updateByOp(e,t,i,n){let r;if(this.isInstanceRoot&&!n)if(t=this.transformAssignData(t,i),0===e.type&&0===e.path.length&&this.component)for(let a of Uj.rootOverrideProps)a in e.props&&void 0===e.props[a]&&(void 0===r&&(r=c(c({},e),{},{props:c({},e.props)})),r.props[a]=this.component.data[a]);else if(0===e.type&&e.path.length>0&&Uj.rootOverrideProps.includes(e.path[0])){let i=e.path[0];void 0===r&&(r=c(c({},e),{},{path:[],props:{[i]:t[i]}}))}super.updateByOp(null!==r&&void 0!==r?r:e,t,i,n)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(void 0===this.component){var i;let n=null!==(i=e.scene.find(t.component))&&void 0!==i?i:null,r=!1;if(n!==this.oldComponent){if(this.oldComponent){let t=0;for(let i of this.children){if(!PG.is(i))break;e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),W3(i),t+=1}this.children.splice(0,t)}r=!0}if(n){let i={};G3(e,[this.uuid],t.overrides,this,n,n,0,r,i);for(let t of this.children)if(PG.is(t)){let n=t.data;"Empty"===n.type&&n.animations&&t.traverseEntity(t=>{let n=t.dataPatched;if(t instanceof r$&&n.bones&&n.boneInverses){let n=t.dataPatched;if(n.bones&&n.boneInverses){let r=n.bones.map(t=>e.scene.find(i[t])),a=n.boneInverses.map(e=>(new yC).fromArray(e)),o=new FT(r,a);t.bind(o,t.bindMatrix)}}else t.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function W3(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let i of e.children)PG.is(i)&&W3(i)}}function H3(e,t,i,n){return e.component===t&&FB(e.identity,n)?e.overrideData===i?2:1:0}function G3(e,t,i,n,r,a,o,s,l){if(o>50)return!1;if(n.component!==r){if(n.component){let e=n.component.instances.indexOf(n);e>=0&&n.component.instances.splice(e,1)}r.instances.find(e=>e===n)||r.instances.push(n),n.component=r}r instanceof j3&&r.isInstanceRoot&&r.expandInstanceChildren(e);let d=0;for(let h of r.children)if(PG.is(h)){let r=[...t,..."string"==typeof h.identity?[h.identity]:h.identity],p=Fj.resolve(i,r,1);null==p||p instanceof XN||(Object.setPrototypeOf(p,XN.prototype),console.error("wrong prototype"));let f,m=null;if(!s){var u;let t=n.children[d];if(m=PG.is(t)?t:null,null!==m){let e=H3(m,h,p,r);f=e>=1?m.stateSelection:void 0,2!==e&&(m=null)}if(null===m&&(m=null!==(u=e.scene.findInstance(r))&&void 0!==u?u:null,null!==m)){let t=H3(m,h,p,r);if(f=t>=1?m.stateSelection:void 0,2!==t)m=null;else{let t=m.parent.children.indexOf(m);m.parent.children.splice(t,1),n.children.splice(d,0,m),m.parent===n?t<=d&&console.error("not possible"):(m.parent=n,m.matrixWorldNeedsUpdate=!0,m.resetBBoxNeedsUpdate(),m.updateVisible(),e.pendingDeletes.delete(m))}}}if(null===m){let t=p?jN.apply(h.data,p):h.data;NV.is(t.type)&&(t=c(c({},t),{},{type:"Empty"})),m=VG.createEntity(r,t,e),m.overrideData=p,n.add(m),n.children.splice(n.children.length-1,1),n.children.splice(d,0,m),m.updateState(m.data,e),f&&m.changeSelectedState(f,e),e.scene.registerInstanceAndSetUuid(m)}if(m.isBone){l[m.identity[m.identity.length-1]]=m.uuid}d+=1,G3(e,t,i,m,h,a,o+1,s,l)}if(!s){let t=d;for(;;){let t=n.children[d];if(!PG.is(t))break;e.pendingDeletes.add(t),d+=1}n.children.splice(t,d-t)}return!0}var q3=class extends(a0(zT,A0)){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(e,t){this.updateState_Entity(e,t)}},X3=class extends r${constructor(e,t,i){super(e,t,i),this.onBeforeRender=e=>{this.uiCanvas.render(e)},this.uiCanvas=new I3(e+"-canvas",t.geometry.width,t.geometry.height,i),this.uiCanvas.promise.then(()=>{this.applyFrame(this.dataPatched.geometry.frame,i.shared)})}updateByPatchedOpGeometry(e,t,i){super.updateByPatchedOpGeometry(e,t,i),0===e.type&&(void 0!==e.props.frame&&this.applyFrame(e.props.frame,i.shared),(void 0!==e.props.width||void 0!==e.props.height)&&this.applySize(e.props,i.shared))}applySize(e,t){var i,n;let r=null!==(i=null===e||void 0===e?void 0:e.width)&&void 0!==i?i:this.dataPatched.geometry.width,a=null!==(n=null===e||void 0===e?void 0:e.height)&&void 0!==n?n:this.dataPatched.geometry.height;this.uiCanvas.applySize({width:r,height:a}),this.applyGeometryParametersFromFrame(t)}applyFrame(e,t){this.uiCanvas.applyFrame(e),this.applyGeometryParametersFromFrame(t),this.applyMaterialParametersFromFrame({shared:t})}applyGeometryParametersFromFrame(e){var t;let i=this.frame;i&&(Object.assign(this.data,{geometry:Object.assign(this.data.geometry,{cornerRadius:i.cornerRadius,cornerType:0})}),Object.assign(this.dataPatched,{geometry:Object.assign(this.dataPatched.geometry,{cornerRadius:i.cornerRadius,cornerType:0})}),null!==(t=this.localGeometry)&&void 0!==t&&t.dispose(),this.localGeometry=NY(this.dataPatched.geometry,e,this.data.flatShading,this))}applyMaterialParametersFromFrame(e){let t=this.frame;if(t){let i=t.data.backgroundBlur;Object.assign(this.data.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.data.material.layers[1].data,{roughness:i.radius,alpha:i.enabled?1:0}),Object.assign(this.dataPatched.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.dataPatched.material.layers[1].data,{roughness:i.radius,alpha:i.enabled?1:0}),this.material.reset(this.dataPatched.material,e,!0)}}updateEntity2DByOp(e,t,i,n){this.uiCanvas.updateEntity2DByOp(e,t,i,n),e===this.frameId&&0===t.type&&(void 0!==t.props.cornerRadius?this.applyGeometryParametersFromFrame(n):xF(t.path,["backgroundBlur"])&&this.applyMaterialParametersFromFrame({shared:n}))}get frame(){return this.uiCanvas.frame}get frameId(){var e;return null===(e=this.frame)||void 0===e?void 0:e.uuid}removeInteractionGeometry(e){super.removeInteractionGeometry(e),this.applySize({},e)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.applySize({width:e.width,height:e.height},t)}},Y3=class{constructor(e,t,i){this.variables=[],this.currentTextureIndex=0;let n=SS,r=new OT,a=new FE;a.position.z=1;let o={passThruTexture:{value:null}},s=d("uniform sampler2D passThruTexture;\n\nvoid main() {\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\n\tgl_FragColor = texture2D( passThruTexture, uv );\n\n}\n",o),l=new OE(new eA(2,2),s);function c(i){i.defines.resolution="vec2( "+e.toFixed(1)+", "+t.toFixed(1)+" )"}function d(e,t){let i=new NE({uniforms:t=t||{},vertexShader:"void main()\t{\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n",fragmentShader:e});return c(i),i}r.add(l),this.setDataType=function(e){return n=e,this},this.addVariable=function(e,t,i){let n={name:e,initialValueTexture:i,material:this.createShaderMaterial(t),dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:fS,magFilter:fS};return this.variables.push(n),n},this.setVariableDependencies=function(e,t){e.dependencies=t},this.init=function(){if(!1===i.capabilities.isWebGL2&&!1===i.extensions.has("OES_texture_float"))return"No OES_texture_float support for float textures.";if(0===i.capabilities.maxVertexTextures)return"No support for vertex shader textures.";for(let i=0;i<this.variables.length;i++){let n=this.variables[i];n.renderTargets[0]=this.createRenderTarget(e,t,n.wrapS,n.wrapT,n.minFilter,n.magFilter),n.renderTargets[1]=this.createRenderTarget(e,t,n.wrapS,n.wrapT,n.minFilter,n.magFilter),this.renderTexture(n.initialValueTexture,n.renderTargets[0]),this.renderTexture(n.initialValueTexture,n.renderTargets[1]);let r=n.material,a=r.uniforms;if(null!==n.dependencies)for(let e=0;e<n.dependencies.length;e++){let t=n.dependencies[e];if(t.name!==n.name){let e=!1;for(let i=0;i<this.variables.length;i++)if(t.name===this.variables[i].name){e=!0;break}if(!e)return"Variable dependency not found. Variable="+n.name+", dependency="+t.name}a[t.name]={value:null},r.fragmentShader="\nuniform sampler2D "+t.name+";\n"+r.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){let e=this.currentTextureIndex,t=0===this.currentTextureIndex?1:0;for(let i=0,n=this.variables.length;i<n;i++){let n=this.variables[i];if(null!==n.dependencies){let t=n.material.uniforms;for(let i=0,r=n.dependencies.length;i<r;i++){let r=n.dependencies[i];t[r.name].value=r.renderTargets[e].texture}}this.doRenderTarget(n.material,n.renderTargets[t])}this.currentTextureIndex=t},this.getCurrentRenderTarget=function(e){return e.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(e){return e.renderTargets[0===this.currentTextureIndex?1:0]},this.dispose=function(){l.geometry.dispose(),l.material.dispose();let e=this.variables;for(let t=0;t<e.length;t++){let i=e[t];i.initialValueTexture&&i.initialValueTexture.dispose();let n=i.renderTargets;for(let e=0;e<n.length;e++)n[e].dispose()}},this.addResolutionDefine=c,this.createShaderMaterial=d,this.createRenderTarget=function(i,r,a,o,s,l){return new N_(i=i||e,r=r||t,{wrapS:a=a||hS,wrapT:o=o||hS,minFilter:s=s||fS,magFilter:l=l||fS,format:ES,type:n,depthBuffer:!1})},this.createTexture=function(){let i=new Float32Array(e*t*4),n=new LT(i,e,t,ES,SS);return n.needsUpdate=!0,n},this.renderTexture=function(e,t){o.passThruTexture.value=e,this.doRenderTarget(s,t),o.passThruTexture.value=null},this.doRenderTarget=function(e,t){let n=i.getRenderTarget(),o=i.xr.enabled,c=i.shadowMap.autoUpdate,d=i.outputEncoding,u=i.toneMapping;i.xr.enabled=!1,i.shadowMap.autoUpdate=!1,i.outputEncoding=WS,i.toneMapping=0,l.material=e,i.setRenderTarget(t),i.render(r,a),l.material=s,i.xr.enabled=o,i.shadowMap.autoUpdate=c,i.outputEncoding=d,i.toneMapping=u,i.setRenderTarget(n)}}},Q3=new eE,K3=new j_,Z3=class{constructor(e){let t=e.geometry;if(!t.isBufferGeometry||3!==t.attributes.position.itemSize)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,i=new Float32Array(e.count/3);for(let r=0;r<e.count;r+=3){let n=1;t&&(n=t.getX(r)+t.getX(r+1)+t.getX(r+2)),Q3.a.fromBufferAttribute(e,r),Q3.b.fromBufferAttribute(e,r+1),Q3.c.fromBufferAttribute(e,r+2),n*=Q3.getArea(),i[r/3]=n}this.distribution=new Float32Array(e.count/3);let n=0;for(let r=0;r<i.length;r++)n+=i[r],this.distribution[r]=n;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,i){let n=this.distribution[this.distribution.length-1],r=this.binarySearch(this.randomFunction()*n);return this.sampleFace(r,e,t,i)}binarySearch(e){let t=this.distribution,i=0,n=t.length-1,r=-1;for(;i<=n;){let a=Math.ceil((i+n)/2);if(0===a||t[a-1]<=e&&t[a]>e){r=a;break}e<t[a]?n=a-1:i=a+1}return r}sampleFace(e,t,i,n){let r=this.randomFunction(),a=this.randomFunction();return r+a>1&&(r=1-r,a=1-a),Q3.a.fromBufferAttribute(this.positionAttribute,3*e),Q3.b.fromBufferAttribute(this.positionAttribute,3*e+1),Q3.c.fromBufferAttribute(this.positionAttribute,3*e+2),t.set(0,0,0).addScaledVector(Q3.a,r).addScaledVector(Q3.b,a).addScaledVector(Q3.c,1-(r+a)),void 0!==i&&Q3.getNormal(i),void 0!==n&&void 0!==this.colorAttribute&&(Q3.a.fromBufferAttribute(this.colorAttribute,3*e),Q3.b.fromBufferAttribute(this.colorAttribute,3*e+1),Q3.c.fromBufferAttribute(this.colorAttribute,3*e+2),K3.set(0,0,0).addScaledVector(Q3.a,r).addScaledVector(Q3.b,a).addScaledVector(Q3.c,1-(r+a)),n.r=K3.x,n.g=K3.y,n.b=K3.z),this}};function J3(e,t){let i=e,n=new Float32Array(4*t*t);for(let a=0;a<t*t;a++)n[4*a]=i[3*a],n[4*a+1]=i[3*a+1],n[4*a+2]=i[3*a+2],n[4*a+3]=0;let r=new LT(n,t,t,ES,SS);return r.needsUpdate=!0,r}var $3="\n// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU\nuniform sampler2D uOriginalPosition;\nuniform sampler2D uDirections;     \nuniform vec3 uDirectionsAxis;\nuniform vec4 uWorldQuaternion;\nuniform vec3 uGravity;        \nuniform float uNoiseStrength;     // Variation of the noise\nuniform float uNoiseScale;        // Scale of the noise\nuniform float uNoiseSeed;         // Seed of the noise\nuniform float particleSize;\nuniform float uSpeed;     // update speed of the particles\nuniform float uRandomMassFactor;\n\n// COLLIDER\nuniform vec3 uColliderPos;                // Collider Position\nuniform vec3 uColliderSize;               // Collider Dimension\nuniform vec4 uColliderQuaternion;         // Collider Rotation\nuniform vec4 uColliderQuaternionInvert;   // Collider Rotation\nuniform float uBounce;                    // Bounce factor\nuniform float uForceDamping;\nuniform float uForceIntensity;\n\n\n\n\n    vec3 mod289(vec3 x) {\n      return x - floor(x * (1.0 / 289.0)) * 289.0;\n    }\n    \n    vec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n    }\n    \n    vec4 permute(vec4 x) {\n        return mod289(((x*34.0)+1.0)*x);\n    }\n    \n    vec4 taylorInvSqrt(vec4 r)\n    {\n    return 1.79284291400159 - 0.85373472095314 * r;\n    }\n    \n    vec3 fade(vec3 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n    float snoise(vec3 v)\n    {\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 =   v - i + dot(i, C.xxx) ;\n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n    vec3 x1 = x0 - i1 + C.xxx;\n    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n    \n    // Permutations\n    i = mod289(i);\n    vec4 p = permute( permute( permute(\n                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n    \n    // Gradients: 7x7 points over a square, mapped onto an octahedron.\n    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n    float n_ = 0.142857142857; // 1.0/7.0\n    vec3  ns = n_ * D.wyz - D.xzx;\n    \n    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n    \n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n    \n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n    \n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n    \n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n    \n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n    \n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n    \n    //Normalise gradients\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    \n    // Mix final noise value\n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                  dot(p2,x2), dot(p3,x3) ) );\n    }\n    \n    vec3 snoiseVec3( vec3 x ){\n    \n      float s  = snoise(vec3( x ));\n      float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));\n      float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));\n      vec3 c = vec3( s , s1 , s2 );\n      return c;\n    \n    }\n    \n      \n    vec3 curlNoise( vec3 p, float seed){\n      p += seed;\n      const float e = .1;\n      vec3 dx = vec3( e   , 0.0 , 0.0 );\n      vec3 dy = vec3( 0.0 , e   , 0.0 );\n      vec3 dz = vec3( 0.0 , 0.0 , e   );\n    \n      vec3 p_x0 = snoiseVec3( p - dx );\n      vec3 p_x1 = snoiseVec3( p + dx );\n      vec3 p_y0 = snoiseVec3( p - dy );\n      vec3 p_y1 = snoiseVec3( p + dy );\n      vec3 p_z0 = snoiseVec3( p - dz );\n      vec3 p_z1 = snoiseVec3( p + dz );\n    \n      float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;\n      float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;\n      float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;\n    \n      const float divisor = 1.0 / ( 2.0 * e );\n      return normalize( vec3( x , y , z ) * divisor );\n    \n    }\n\n\n// Classic Perlin noise\nfloat cnoise(vec3 P)\n{\n  vec3 Pi0 = floor(P); // Integer part for indexing\n  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n  Pi0 = mod289(Pi0);\n  Pi1 = mod289(Pi1);\n  vec3 Pf0 = fract(P); // Fractional part for interpolation\n  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n\n  vec4 gx0 = ixy0 * (1.0 / 7.0);\n  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 * (1.0 / 7.0);\n  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = fade(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); \n  return 2.2 * n_xyz;\n}\n\n\nvec3 fbm_vec3(vec3 p, float frequency, float offset)\n{\n  return vec3(\n    cnoise((p+vec3(offset))*frequency),\n    cnoise((p+vec3(offset+20.0))*frequency),\n    cnoise((p+vec3(offset-30.0))*frequency)\n  );\n}\n\n"+"\nfloat rand(vec2 co){\n    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec3 applyQuaternionToVector( vec4 q, vec3 v ){\n    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\n } \nvec3 applyForce(vec3 force, float mass) {\n  vec3 acceleration = force / mass;\n  \n  return acceleration;\n}\n\nvec4 conjugate(vec4 q) {\n  return vec4(q.w, -q.x, -q.y, -q.z);\n}\n\n// Function to compute the normal of the ellipsoid at a given point\nvec3 ellipsoidNormal(vec3 p, vec3 radii) {\n  return normalize(p / (radii * radii));\n}\n\nfloat friction = .3;\n\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;\n    vec3 originalPosition = texture2D( uOriginalPosition, vUv ).xyz;\n    float timeLeft = texture2D( uCurrentPosition, vUv ).w;\n    vec3 directions = texture2D( uDirections, vUv ).xyz;    \n    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;\n    float mass = rand(originalPosition.xy) * 0.5 + 0.5;\n    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).x;        // 1. = spawning, 0. = not spawning\n    float isActive = texture2D( uCurrentEmissionRate, vUv ).y;          // 1. = active, 0. = not active\n    float collisionFlag =texture2D( uCurrentVelocity, vUv ).w;          // Indicate collision\n\n    // Randomness Mass\n    mass = (1.0 - (uRandomMassFactor * mass));\n    \n    if (isActive == 1.0) {\n      // **************************************************************\n      // FORCES NOISES\n      // **************************************************************\n      #ifdef USE_CURL_NOISE\n        if (uNoiseScale > 0.0 ) {\n          velocity = curlNoise(position * uNoiseScale * .002, uNoiseSeed) * ( uNoiseStrength + 1.0) * .05 * uSpeed;\n        }\n        // Variation of the noise Over Time\n        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {\n          velocity += curlNoise( position, uNoiseSeed)  * uNoiseStrength * 0.05 * uSpeed;\n        }\n      #endif\n      // **************************************************************\n      #ifdef USE_SIMPLEX_NOISE\n        if (uNoiseScale > 0.0 ) {\n          velocity = vec3(snoise(position * uNoiseScale * .001) * ( uNoiseStrength + 1.0) * .1);\n          velocity *= uSpeed;\n        }\n        // Variation of the noise Over Time\n        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0) {\n          velocity += vec3(snoise(position * uNoiseStrength * .001) * .05 * uSpeed);\n        }\n      #endif\n      // ************************************************************** \n      #ifdef USE_FBM_NOISE\n        if (uNoiseScale > 0.0 ) {\n          velocity = fbm_vec3(position * uNoiseScale * .001, ( uNoiseStrength + 1.0), uNoiseSeed);\n          velocity *= uSpeed;\n        }\n        // Variation of the noise Over Time\n        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {      \n          velocity += fbm_vec3(position * uNoiseStrength * .001, ( uNoiseStrength + 1.0), uNoiseSeed) * .1 * uSpeed;\n        }\n      #endif\n\n      // COLLIDER\n      ".concat("\n  #ifdef USE_COLLIDER\n    float restitution = max(uBounce * 2., .01); // Energy Loss\n    // SPHERE COLLIDER\n    // **************************************************************\n    #ifdef USE_SPHERE_COLLIDER       \n      // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)\n      vec3 radii = uColliderSize;\n      // Adjust position relative to collider\n      vec3 relPos = position - uColliderPos;\n      // Apply rotation of the collider to the relative position\n      relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            \n      // Scale relative position by radii (for ellipsoid collision detection)\n      vec3 scaledPos = relPos / radii;\n      // Calculate ellipsoidal distance\n      float dist = length(scaledPos); // Distance in terms of ellipsoid\n      \n      // Check for collision\n      if (dist <= 1. + particleSize / length(radii) && collisionFlag == 0.0) {\n          // Compute the normal at the collision point, accounting for particle size\n        vec3 adjustedPos = scaledPos * (1.0 + particleSize / length(radii));          \n        // Compute the normal at the collision point\n        vec3 normal = ellipsoidNormal(adjustedPos, radii);\n        // Rotate the normal back to world space\n        normal = applyQuaternionToVector(uColliderQuaternion, normal);\n        // Reflect the velocity vector off the normal\n        velocity = reflect(velocity, normal) * restitution;\n\n        collisionFlag = 1.0;\n      } else {\n        collisionFlag = 0.0;\n      }\n    #endif\n\n    // BOX COLLIDER or PLANE COLLIDER \n    // **************************************************************\n    #ifdef USE_BOX_COLLIDER\n      // Box dimensions and repulsion variables\n      vec3 boxHalfSize = uColliderSize / 2.0;\n      // Convert world position to box's local space\n      vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      \n      // Collision detection\n      vec3 localDistance = abs(localPos) - boxHalfSize;\n      float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));    \n\n      // Collision Detected\n      if (distToSurface <= particleSize * 0.5 && collisionFlag == 0.0) {      \n        // Find the nearest face normal for bounce direction\n        vec3 normal;\n        if (localDistance.x > localDistance.y && localDistance.x > localDistance.z) {\n            normal = vec3(sign(localPos.x), 0.0, 0.0);\n        } else if (localDistance.y > localDistance.z) {\n            normal = vec3(0.0, sign(localPos.y), 0.0);\n        } else {\n            normal = vec3(0.0, 0.0, sign(localPos.z));\n        }            \n        // Rotate normal back to world space\n        normal = applyQuaternionToVector(uColliderQuaternion, normal);      \n        // Reflect velocity and apply repulsion force\n        velocity = reflect(velocity, normal) * restitution;\n        \n        collisionFlag = 1.0;\n      } else {\n        collisionFlag = 0.0;\n      }\n    #endif      \n  #endif      \n  // END COLLIDER    \n","\n      // ATTRACTION\n      ").concat("\n  #ifdef USE_ATTRACTOR\n\n      #ifdef USE_SPHERE_COLLIDER      \n        // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)\n        vec3 radii = uColliderSize;\n        // Adjust position relative to collider\n        vec3 relPos = position - uColliderPos;\n        // Apply rotation of the collider to the relative position\n        relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            \n        // Scale relative position by radii (for ellipsoid collision detection)\n        vec3 scaledPos = relPos / radii;\n        // Calculate ellipsoidal distance\n        float distToSurface = length(scaledPos); // Distance in terms of ellipsoid\n        float insideCheck = 1.0;\n\n      #endif\n\n\n      #ifdef USE_BOX_COLLIDER\n        // Box dimensions\n        vec3 boxHalfSize = uColliderSize / 2.0;\n        // Convert world position to box's local space\n        vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      \n        vec3 localDistance = abs(localPos) - boxHalfSize;\n        float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));\n        float insideCheck = particleSize;\n      #endif      \n  \n      // Apply vortex force inside the Helper\n      #ifdef USE_FORCE_LOCAL_SPACE\n        if (distToSurface <= insideCheck ) {    \n            // Define parameters for the attractor field\n            #ifdef USE_SPHERE_COLLIDER      \n              float attractorStrength = (1.0 - distToSurface ) * uForceIntensity; // Adjust as needed\n            #endif\n\n            #ifdef USE_BOX_COLLIDER\n              float attractorStrength = max((1.0 - insideCheck / distToSurface), 0.) * uForceIntensity; // Adjust as needed\n              #endif\n\n            float attractorDamping = uForceDamping;  // Adjust as needed (higher values will attenuate velocity more)\n          \n            // Use the same radii calculation code as for the collider\n            vec3 attractorRadii = uColliderSize;\n            // Adjust position relative to attractor center\n            vec3 relPos = position - uColliderPos;\n            // Apply rotation of the collider to the relative position\n            relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            \n            // Scale relative position by radii (for ellipsoid attraction)\n            vec3 scaledPos = relPos / attractorRadii;\n\n            // Calculate ellipsoidal distance as attractor radius\n            float attractorRadius = length(scaledPos);\n            // Calculate the distance from the attractor center\n            vec3 relativePosition = position - uColliderPos;\n            // Calculate the force vector towards the attractor center\n            vec3 attractorForce = normalize(relativePosition) * attractorStrength;\n            // Apply the attractor force to the particle\n            velocity -= attractorForce;\n            // Attenuate the particle's velocity\n            velocity *= attractorDamping;\n        }\n      #else \n            // Calculate the distance from the attractor center\n            vec3 relativePosition = position - uColliderPos;\n            // Calculate the force vector towards the attractor center\n            vec3 attractorForce = normalize(relativePosition) * uForceIntensity;\n            // Apply the attractor force to the particle\n            velocity -= attractorForce;\n            // Attenuate the particle's velocity\n            velocity *= uForceDamping;\n      #endif    \n  #endif      \n","  \n      // VORTEX\n      ").concat("\n  #ifdef USE_VORTEX\n    // Box dimensions\n    vec3 boxHalfSize = uColliderSize / 2.0;\n    // Convert world position to box's local space\n    vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      \n    vec3 localDistance = abs(localPos) - boxHalfSize;\n    float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));\n\n    // Apply vortex force inside the box\n    if (distToSurface <= particleSize) {\n      float vortexStrength = uForceIntensity;\n      vec3 localTopCenter = vec3(0.0, 0., 0.0);\n\n      // Transform the local top center to the world space\n      vec3 vortexCenter = uColliderPos + applyQuaternionToVector(uColliderQuaternion, localTopCenter);\n      // Calculate the vector from particle to vortex center\n      vec3 vortexVector = vortexCenter - position;\n\n      // Calculate the rotation axis from the inverse of the collider's quaternion and the fixed up vector\n      // Note: important to add a tiny z component to the up vector to avoid instability\n      vec3 upVector = vec3(0.0, 1.0, 0.01);\n      vec3 rotationAxis = cross(upVector, applyQuaternionToVector(uColliderQuaternion, vortexVector));\n      rotationAxis = normalize(rotationAxis);\n\n      // Add rotational component to velocity\n      float rotationSpeed = length(vortexVector * vortexStrength * 3.0) ; \n\n      vec3 rotationVelocity = rotationAxis * rotationSpeed;\n      // velocity += rotationVelocity * 0.005 ;\n      velocity = rotationVelocity * 0.005 ;\n\n      // Calculate vortex force\n      // vec3 vortexForce = normalize(vortexVector) * uSpeed * .1 ;\n      // Apply the vortex force to the particle\n      vec3 originDirection = applyQuaternionToVector(uWorldQuaternion, directions);\n      velocity += applyForce( originDirection * uSpeed * (1. - uForceDamping) , mass * .5);\n    }\n  #endif      \n","\n    } \n    // End isActive\n\n    // SPAWN BIRTH \n    // **************************************************************\n    // if (isSpawning == 1.)\n    #ifdef USE_NORMALS\n      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, directions) * uSpeed, isSpawning);\n    #else\n      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, uDirectionsAxis) * uSpeed, isSpawning);    \n    #endif\n    \n    // if (collisionFlag == 0.0)\n    velocity += applyForce(uGravity, mass * .5) * (1.0 - collisionFlag);\n\n    gl_FragColor = vec4(velocity, collisionFlag);\n}\n"),e4="\n\n  // Linear Fade In\n  float linearFadeIn(float t) {\n    return t;\n  }\n\n\n  // linear fade out\n  float linearFadeOut(float t) {\n    return 1.0 - t;\n  }\n  \n  float linearInOut(float t) {\n    return t < 0.5 ? t :  (1.0 - t);  \n  }\n\n    // lerp\n    float lerp(float a, float b, float t) {\n      return a + (b - a) * t;\n    }\n\n  // Ease In Out Quart\n  float exponentialInOut(float t) {\n    return t < 0.4 ? lerp(0.0, 1.0, t / 0.4) :\n    t > 0.6 ? lerp(1.0, 0.0, (t - 0.6) / 0.4) :\n    1.0;\n   }\n\n  // constant\n  float constant(float t) {\n    return 1.0;\n  } \n",t4="\n  uniform sampler2D uPosition;\n  uniform float uSize;\n  uniform float uSizeEnd;\n  uniform vec3 uWorldOffset;\n  uniform vec4 uWorldQuaternion;\n  // Billboard Behavior - Currently at Zero, but we can change that\n  uniform float uRotation;\n  uniform float uRotationEnd;\n  uniform vec2 center;\n\n  // Randomness\n  uniform float uRandScaleFactor;\n  uniform float uRandRotationFactor;\n\n  attribute vec2 ref;\n\n  varying float v_LifeLeft;    // normalized lifetime 1 to 0\n  varying vec2 vUv;\n  varying vec2 vRef;\n\n  ".concat("\n\nfloat rand(vec3 co){\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvec3 applyQuaternionToVector( vec4 q, vec3 v ){\n  return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\n}\n\nvec3 applyForce(vec3 force, float mass) {\n  vec3 acceleration = force / mass;\n    \n  return acceleration;\n}\n","\n  ").concat(e4,"\n"),i4="\n  uniform vec4 uColor;                // start color\n  uniform vec4 uColor2;               // end color\n  uniform sampler2D uTexture;         // texture\n  varying float v_LifeLeft;   // normalized lifetime 1 to 0\n  varying vec2 vUv;\n  varying vec2 vRef;\n\n  float random(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n  }\n  "+e4+"  \n  ".concat("\nvec3 rgb2xyz (in vec3 rgb) {\n    float r = rgb.r;\n\tfloat g = rgb.g;\n\tfloat b = rgb.b;\n\n\tr = r > 0.04045 ? pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);\n\tg = g > 0.04045 ? pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);\n\tb = b > 0.04045 ? pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);\n\n\tfloat x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);\n\tfloat y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);\n\tfloat z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);\n    \n    vec3 xyz = vec3(\n        (r * 0.4124) + (g * 0.3576) + (b * 0.1805) * 100.0,\n        (r * 0.2126) + (g * 0.7152) + (b * 0.0722) * 100.0,\n        (r * 0.0193) + (g * 0.1192) + (b * 0.9505) * 100.0\n    );\n    return(xyz);\n}\n\nvec3 xyz2lab (in vec3 xyz) {\n\tfloat x = xyz.x / 95.047;\n\tfloat y = xyz.y / 100.0;\n\tfloat z = xyz.z / 108.883;\n\n\tx = x > 0.008856 ? pow(x, 1.0 / 3.0) : (7.787 * x) + (16.0 / 116.0);\n\ty = y > 0.008856 ? pow(y, 1.0 / 3.0) : (7.787 * y) + (16.0 / 116.0);\n\tz = z > 0.008856 ? pow(z, 1.0 / 3.0) : (7.787 * z) + (16.0 / 116.0);\n\n    vec3 lab = vec3((116.0 * y) - 16.0, 500.0 * (x - y), 200.0 * (y - z));\n    return(lab);\n}\n\nvec3 rgb2lab(in vec3 rgb) {\n    vec3 xyz = rgb2xyz(rgb);\n    vec3 lab = xyz2lab(xyz);\n    return(lab);\n}\n\nvec3 xyz2rgb (in vec3 xyz) {\n\tfloat x = xyz.x / 100.0;\n\tfloat y = xyz.y / 100.0;\n\tfloat z = xyz.z / 100.0;\n\t\n    \n\tfloat r = (x *  3.2406) + (y * -1.5372) + (z * -0.4986);\n\tfloat g = (x * -0.9689) + (y *  1.8758) + (z *  0.0415);\n\tfloat b = (x *  0.0557) + (y * -0.2040) + (z *  1.0570);\n\n\tr = r > 0.0031308 ? ((1.055 * pow(r, 1.0 / 2.4)) - 0.055) : r * 12.92;\n\tg = g > 0.0031308 ? ((1.055 * pow(g, 1.0 / 2.4)) - 0.055) : g * 12.92;\n\tb = b > 0.0031308 ? ((1.055 * pow(b, 1.0 / 2.4)) - 0.055) : b * 12.92;\n\n\tr = min(max(0.0, r), 1.0);\n\tg = min(max(0.0, g), 1.0);\n\tb = min(max(0.0, b), 1.0);\n\n\treturn(vec3(r, g, b));\n}\n\nvec3 lab2xyz (in vec3 lab) {\n    float l = lab.x;\n\tfloat a = lab.y;\n\tfloat b = lab.z;\n\n  \tfloat y = (l + 16.0) / 116.0;\n\tfloat x = a / 500.0 + y;\n\tfloat z = y - b / 200.0;\n\n\tfloat y2 = pow(y, 3.0);\n\tfloat x2 = pow(x, 3.0);\n\tfloat z2 = pow(z, 3.0);\n\n  \ty = y2 > 0.008856 ? y2 : (y - 16.0 / 116.0) / 7.787;\n\tx = x2 > 0.008856 ? x2 : (x - 16.0 / 116.0) / 7.787;\n\tz = z2 > 0.008856 ? z2 : (z - 16.0 / 116.0) / 7.787;\n\n\tx *= 95.047;\n\ty *= 100.0;\n\tz *= 108.883;\n\n\treturn(vec3(x, y, z));\n}\nvec3 lab2rgb (in vec3 lab) {\n    vec3 xyz = lab2xyz(lab);\n    vec3 rgb = xyz2rgb(xyz);\n    return(rgb);\n}\n\n","\n\n"),n4=class extends NE{constructor(e,t){super(),this.needsJitter=!0,this.type="ParticleMaterial",this.easeOpacity="linearFadeIn",this.easeSize="linearFadeIn",this.useSizeEnd=!1,this.isColoringRandom=!1,this.init(e,t),this.context=t}reset(){}init(e,t){this.transparent=!0,this.depthTest=!0,this.depthWrite=!1,this.easeOpacity=e.ease,this.easeSize=e.easeSize,this.layers=[],AQ.startContext(AQ.globalContext),this.lightLayer=new tJ(0,"",c(c({},sj.defaultData("light","phong")),{},{visible:!1}),new sZ,{},t.shared),AQ.endContext(AQ.globalContext),this.build()}updateState(e){void 0!==e.coloring&&(this.isColoringRandom="random"===e.coloring),void 0!==e.color&&(e.color instanceof Array?this.uniforms.uColor.value=e.color:this.uniforms.uColor.value=this.context.shared.color(e.color)),void 0!==e.color2&&(e.color2 instanceof Array?this.uniforms.uColor2.value=e.color2:this.uniforms.uColor2.value=this.context.shared.color(e.color2)),void 0!==e.size&&(this.uniforms.uSize.value=e.size[0],this.uniforms.uSizeEnd.value=e.size[1],e.size[0]!==e.size[1]?this.useSizeEnd=!0:this.useSizeEnd=!1),void 0!==e.ease&&(this.easeOpacity=e.ease,this.build()),void 0!==e.easeSize&&(this.easeSize=e.easeSize,this.build()),this.needsUpdate=!0}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader}build(){let e=new mK;return e.needsJitter=this.needsJitter,e.addFragmentParsCode("\nlayout(location = 1) out vec4 gVelocity;\n"),e.buildShader("vertex",this.fragment),e.buildShader("fragment",this.fragment),e.addFragmentFinalCode("\n    // Discard fully transparent pixels \n    if (gl_FragColor.a <= 0.0) discard;\n\n    gVelocity = vec4(0.0, 0.0, 0.0, 1.0);\n"),this.isColoringRandom&&e.define("USE_RANDOM_COLORING"),this.useSizeEnd&&e.define("USE_SIZE_END"),e.addVertexParsCode(t4),e.addFragmentParsCode(i4),e.addVertexFinalCode((e=>{let{easeSize:t="linearFadeOut"}=e;return"\n  vUv = uv;  \n  vRef = ref;\n  // Normalized LifeTime 1 to 0\n  float lifeLeft = texture2D(uPosition, ref).w;\n  v_LifeLeft = lifeLeft;\n  // Position From DataTexture Simulation\n  vec3 pos = texture2D(uPosition, ref).rgb - uWorldOffset;\n  // Apply World Quaternion\n  pos = applyQuaternionToVector(uWorldQuaternion, pos);  \n            \n  #ifdef  USE_SIZE_END\n    // Scaled Over Time\n    float t = 1. - lifeLeft;\n    float currentSize = mix(uSize, uSizeEnd, t); // Linearly interpolate between uSize and uSizeEnd\n    vec3 scaledPosition = position * vec3(currentSize);\n  #else\n    // Change Size Behavior over LifeTime\n    float easeSize = ".concat(t,"(1. - lifeLeft);\n    // Scaled Over Time\n    vec3 scaledPosition = position * vec3(uSize * easeSize);\n  #endif\n\n  // Billboard Behavior\n  vec2 scale;\n  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );    \n  // Randomness \n  float randRef = rand(ref);\n  scale *= (1.0 - (uRandScaleFactor * randRef));\n  // Rotation\n  float randRotation =  2.0 * PI * ( uRandRotationFactor * randRef);\n  float originalRotation = (1.0 - uRotation) * 2.0 * PI;\n  float originalRotationEnd = (1.0 - uRotationEnd) * 2.0 * PI;\n  // OverTime\n  float finalRotation = mix(originalRotation + randRotation, originalRotationEnd + randRotation, lifeLeft);\n\n  vec2 alignedPosition = ( scaledPosition.xy - ( center - vec2( 0.5 ) ) ) * scale;\n  vec2 rotatedPosition;\n  rotatedPosition.x = cos( finalRotation ) * alignedPosition.x - sin( finalRotation ) * alignedPosition.y;\n  rotatedPosition.y = sin( finalRotation ) * alignedPosition.x + cos( finalRotation ) * alignedPosition.y;\n  \n  mat4 instanceMatrix = mat4(\n    vec4(1.0, 0.0, 0.0, 0.0),\n    vec4(0.0, 1.0, 0.0, 0.0),\n    vec4(0.0, 0.0, 1.0, 0.0),\n    vec4(pos.x, pos.y, pos.z, 1.0)\n  );  \n\n  mvPosition = modelViewMatrix * instanceMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n  mvPosition.xy += rotatedPosition;\n  gl_Position = projectionMatrix  * mvPosition;   \n")})({easeSize:this.easeSize})),e.addFragmentFinalCode((e=>{let{easeOpacity:t="linearFadeOut"}=e;return"  \n  // if Particle is dead, hide it\n  if (v_LifeLeft <= 0.005 ) {\n    discard;\n  }\n\n  #ifdef USE_RANDOM_COLORING\n    float randVal = random(vRef); // Generate a random value based on the reference\n    vec4 color = mix(uColor, uColor2, randVal); // Interpolate between the two colors\n  #else\n    vec4 color = mix(uColor, uColor2, 1. - v_LifeLeft);\n  #endif\n\n  // Opacity over Life Time\n  float finalAlpha = ".concat(t,"(1. - v_LifeLeft);  \n  vec4 textureColor = texture2D(uTexture, vUv).rgba; \n  finalColor = textureColor.rgb * color.rgb;\n  finalAlpha = color.a * textureColor.a * finalAlpha;\n  \n  gl_FragColor = vec4(finalColor, finalAlpha);     \n\n")})({easeOpacity:this.easeOpacity})),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=c(c({},e.uniforms),this.uniforms),this.extensions=e.extensions,this}get nodeMaterial(){return this}get fragment(){return this.lightLayer.node}getDefines(){return this.defines}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose()}},r4=class{constructor(e,t,i,n){var r;this.type="SphereEmitterShape",this.targetMesh=void 0,this.size=e,this.type=i,this.textureSize=function(e){let t=Math.ceil(Math.sqrt(e));return Math.max(t,1)}(t);this.targetMesh="BufferGeometry"===(null===n||void 0===n?void 0:n.geometry.type)||"Mesh"===(null===n||void 0===n?void 0:n.type)&&n&&n.geometry.hasAttribute("position")&&n.geometry.hasAttribute("normal")?n:this.getMesh(i,1);let{positions:a,dataTexture:o,dataTextureNormals:s}=this.createPositions(this.textureSize,null!==(r=this.targetMesh)&&void 0!==r?r:this.getMesh(i,1));this.positionsTexture=o,this.positionsAttribute=a,this.directionsTexture=s}createPositions(e,t){let{positions:i,normals:n}=function(e,t){let i=new OE(e.geometry,e.material),n=[],r=[],a=new j_,o=new j_;null!==i.geometry.index&&(i.geometry=i.geometry.toNonIndexed());let s=new Z3(i).build();for(let l=0;l<t;l++)s.sample(a,o),n.push(a.x,a.y,a.z),r.push(o.x,o.y,o.z);return{positions:new Float32Array(n),normals:new Float32Array(r)}}(t,e*e);return{dataTexture:J3(i,e),positions:i,dataTextureNormals:J3(n,e)}}getMesh(e,t){let i=null;switch(e){case"SphereEmitterShape":i=new aD(.5*t,32,32);break;case"TorusEmitterShape":i=new oD(.5*t,.3,15,40);break;case"ConeEmitterShape":i=new AP(t,t,15);break;case"BoxEmitterShape":i=new kE(t,t,t);break;case"PlaneEmitterShape":i=new eA(t,t),i.rotateX(-Math.PI/2);break;default:i=new aD(t,32,32)}return new OE(i,new nE({color:16711680}))}applyToShader(e,t){this.size=(new j_).fromArray(t.size),e.uEmitterSize.value=this.size}dispose(){this.positionsTexture.dispose(),this.directionsTexture.dispose(),this.positionsAttribute=new Float32Array}};function a4(e){let t=c({},e),i=qV.defaultData;t.forceFieldObjectId&&(t.colliderEntityId=t.forceFieldObjectId);let n=c(c({},i.shape),t.shape),r=c(c({},i.renderMaterial),t.renderMaterial);return c(c(c({},i),t),{},{shape:n,renderMaterial:r})}var o4=class extends WC{constructor(e,t){var i,n,r,a;super(),this.type="ParticleEmitter",this.debugMode=!1,this.worldSpace=!0,this.rootObject=null,this.gpuCompute=null,this.positionSimRT=null,this.velocitySimRT=null,this.emissionRateSimRT=null,this.emitterShape=void 0,this.isEmitting=!1,this.hasBeenReset=!1,this.emittedParticlesAmount=0,this.lastEmitTime=0,this.globalTime=0,this.targetFPS=60,this.previousRatio=1,this.lerpFactor=.4,this.particlesAmount=0,this.noiseStrength=0,this.noiseScale=0,this.isBillboardBased=!0,this.simFeaturesDefinition={USE_COLLIDER:!1,USE_ATTRACTOR:!1,USE_VORTEX:!1,USE_SPHERE_COLLIDER:!1,USE_BOX_COLLIDER:!1,USE_FORCE_LOCAL_SPACE:!1,USE_NORMALS:!1,USE_CURL_NOISE:!0,USE_SIMPLEX_NOISE:!1,USE_FBM_NOISE:!1},this.textureLoader=new BD,this.currentWorldPosition=new j_,this.systemQuaternion=new V_,this.worldGravity=new j_(0,0,0),this.directionAxis=new j_(0,0,0),this.colliderV3=new j_(0,0,0),this.colliderQuaternion=new V_(0,0,0,1),this.matrixAutoUpdate=!0,this.renderer=e,this.system=t,this.shared=t.context.shared;let o=t.data;this.material=new n4(o.renderMaterial,t.context),this.material.uniforms={uSize:{value:0},uSizeEnd:{value:0},uColor:{value:o.renderMaterial.color},uColor2:{value:o.renderMaterial.color2},uPosition:{value:new j_(0,0,0)},uEmissionData:{value:new j_(0,0,0)},uTexture:{value:this.defaultTexture},uWorldOffset:{value:new j_(0,0,0)},uWorldQuaternion:{value:new B_(0,0,0,1)},uRandScaleFactor:{value:null!==(i=o.randomScale)&&void 0!==i?i:0},uRandRotationFactor:{value:null!==(n=o.randomRotation)&&void 0!==n?n:0},uRotation:{value:null!==(r=o.renderMaterial.spriteRotation[0])&&void 0!==r?r:0},uRotationEnd:{value:null!==(a=o.renderMaterial.spriteRotation[1])&&void 0!==a?a:0}},this.setTexture(this.material.uniforms,o.renderMaterial.texture),this.init(o)}setTexture(e,t){let i=t.data;if("string"==typeof t){let i=this.shared.image(t),n=new L_(i.img);return n.needsUpdate=!0,void(e.uTexture.value=n)}if("string"!=typeof i){let t=new Image;t.onload=()=>{let i=new L_(t);i.needsUpdate=!0,e.uTexture.value=i};let n=new Blob([i],{type:"image/*"}),r=URL.createObjectURL(n);t.src=r}}updateGeometryAttributes(e,t){var i;let n=function(e){let t=new Float32Array(e*e*2);for(let i=0;i<e;i++)for(let n=0;n<e;n++){let r=i*e+n;t[2*r+0]=i/(e-1),t[2*r+1]=n/(e-1)}return t}(t);null===(i=this.emitterShape)||void 0===i||!i.positionsAttribute||e.geometry.setAttribute("ref",new UT(n,2))}applyWorldSpace(){if(!this.system.started||!this.worldSpace||!this.positionSimRT||!this.velocitySimRT)return;let e=this.system;e.getWorldQuaternion(this.systemQuaternion),this.systemQuaternion.invert(),e.getWorldPosition(this.currentWorldPosition),this.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.positionSimRT.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.systemQuaternion.invert(),this.positionSimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.velocitySimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize())}update(e,t){var i;if(!this.gpuCompute||!this.positionSimRT||!this.velocitySimRT||!this.emissionRateSimRT||this.hasBeenReset)return;if(this.checkIfAllParticlesAreDead()&&!this.hasBeenReset)return void this.reset();this.applyWorldSpace(),this.globalTime=e,this.positionSimRT.material.uniforms.uTime.value=e,this.emissionRateSimRT.material.uniforms.uTime.value=e;let n=1e3/t,r=this.targetFPS/n,a=this.previousRatio+(r-this.previousRatio)*this.lerpFactor;this.positionSimRT.material.uniforms.uFPSRatio.value=a,this.previousRatio=a;let o=this.isEmitting?this.GoEmitSomeParticles(e,this.system.data.birthRatePerSec):0;this.emissionRateSimRT.material.uniforms.uLastIndexEmitted.value=this.emittedParticlesAmount,this.emissionRateSimRT.material.uniforms.uParticlesToEmit.value=o,this.material.uniforms.uPosition.value=null===(i=this.gpuCompute.getCurrentRenderTarget(this.positionSimRT))||void 0===i?void 0:i.texture,this.system.colliderEntities.length>0&&this.renderColliders(),this.gpuCompute.compute()}renderColliders(){if(!this.velocitySimRT)return;let e=this.system.colliderEntities[0],t=this.simFeaturesDefinition.USE_COLLIDER||this.simFeaturesDefinition.USE_ATTRACTOR||this.simFeaturesDefinition.USE_VORTEX;if(e.destroyedInAction&&t&&this.init(a4(c(c({},this.system.data),{},{colliderEntityId:null}))),!e||e.destroyedInAction)return;e.getWorldPosition(this.colliderV3),0===this.colliderV3.y&&(this.colliderV3.y=1e-4),this.velocitySimRT.material.uniforms.uColliderPos.value.copy(this.colliderV3);let i=e.data.size;this.colliderV3.fromArray(i),this.velocitySimRT.material.uniforms.uColliderSize.value.copy(this.simFeaturesDefinition.USE_SPHERE_COLLIDER?this.colliderV3.multiplyScalar(.5):this.colliderV3),e.getWorldQuaternion(this.colliderQuaternion),this.velocitySimRT.material.uniforms.uColliderQuaternion.value.copy(this.colliderQuaternion.normalize()),this.velocitySimRT.material.uniforms.uColliderQuaternionInvert.value.copy(this.colliderQuaternion.normalize().invert())}updateState(e){!this.velocitySimRT||!this.positionSimRT||(e.renderMaterial&&this.updateMaterialState(e.renderMaterial),this.updateParticleState(e))}updateVariableState(e,t){if(!this.velocitySimRT||!this.positionSimRT)return;"size"===t[2]&&this.material.updateState({size:[e,this.material.uniforms.uSizeEnd.value]}),"sizeEnd"===t[2]&&this.material.updateState({size:[this.material.uniforms.uSize.value,e]});let i=(e,t)=>{let i=[...this.system.data.shape.size];i[e]=t,this.updateParticleState({shape:c(c({},this.system.data.shape),{},{size:i})})};"shape_size_0"===t[2]&&i(0,e),"shape_size_1"===t[2]&&i(1,e),"shape_size_2"===t[2]&&i(2,e),"speed"===t[2]&&(this.velocitySimRT.material.uniforms.uSpeed.value=e/10),"gravity"===t[2]&&this.worldGravity.set(0,e/100,0),"noiseStrength"===t[2]&&(this.noiseStrength=e,this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),"noiseScale"===t[2]&&(this.noiseScale=e,this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),"direction_x"===t[2]&&(this.directionAxis=this.getDirectionAxis([Number(e),this.system.data.direction[1],this.system.data.direction[2]])),"direction_y"===t[2]&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],Number(e),this.system.data.direction[2]])),"direction_z"===t[2]&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],this.system.data.direction[1],Number(e)]))}updateMaterialState(e){this.material.updateState(c(c({},e),{},{size:e.size?[Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","size"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","sizeEnd"]))]:[0,0]})),e.texture&&(this.setTexture(this.material.uniforms,e.texture),this.material.needsUpdate=!0)}updateParticleState(e){if(this.positionSimRT&&this.velocitySimRT){var t,i;if(this.shouldReInitGPUCompute(e)&&this.init(a4(this.system.data)),void 0!==e.life&&(this.positionSimRT.material.uniforms.uMaxLifeTime.value=e.life),void 0!==e.speed&&(this.velocitySimRT.material.uniforms.uSpeed.value=Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/10),void 0!==e.collisionBounce&&(this.velocitySimRT.material.uniforms.uBounce.value=e.collisionBounce),void 0!==e.noiseStrength&&(this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),void 0!==e.noiseScale&&(this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"])),this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),void 0!==e.noiseSeed&&(this.velocitySimRT.material.uniforms.uNoiseSeed.value=e.noiseSeed),void 0!==e.randomMass&&(this.velocitySimRT.material.uniforms.uRandomMassFactor.value=e.randomMass),void 0!==(null===(t=e.renderMaterial)||void 0===t?void 0:t.size)){let t=this.shared.getVariable(e.renderMaterial.size[0],[this.uuid,"particles","size"]);this.velocitySimRT.material.uniforms.particleSize.value=Number(t)}if(void 0!==(null===(i=e.renderMaterial)||void 0===i?void 0:i.spriteRotation)&&(this.material.uniforms.uRotation.value=e.renderMaterial.spriteRotation[0],this.material.uniforms.uRotationEnd.value=e.renderMaterial.spriteRotation[1]),void 0!==e.shape){var n,r;let t=null!==(n=e.shape.size)&&void 0!==n?n:this.system.data.shape.size,i=[Number(this.shared.getVariable(t[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(t[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(t[2],[this.uuid,"particles","shape_size_2"]))],a=c(c({},a4(this.system.data).shape),{},{size:i});null===(r=this.emitterShape)||void 0===r||r.applyToShader(this.positionSimRT.material.uniforms,a)}if(void 0!==e.gravity&&(this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.velocitySimRT.material.uniforms.uGravity={value:this.worldGravity}),void 0!==e.direction){let t=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(t),this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis}void 0!==e.randomRotation&&(this.material.uniforms.uRandRotationFactor.value=e.randomRotation),void 0!==e.randomScale&&(this.material.uniforms.uRandScaleFactor.value=e.randomScale)}}updateForceFieldParameters(e){!this.velocitySimRT||(void 0!==e.forceIntensity&&(this.velocitySimRT.material.uniforms.uForceIntensity.value=e.forceIntensity),void 0!==e.forceDambing&&(this.velocitySimRT.material.uniforms.uForceDamping.value=e.forceDambing))}getDirectionAxis(e){let t=[Number(e[0])*h_.DEG2RAD,Number(e[1])*h_.DEG2RAD,Number(e[2])*h_.DEG2RAD],i=new TC(t[0],t[1],t[2],"XYZ");return this.directionAxis.set(0,1,0).applyEuler(i).normalize(),this.velocitySimRT&&(this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis),this.directionAxis}shouldReInitGPUCompute(e){let{birthRatePerSec:t,rootObjectType:i,colliderEntityId:n,shape:r,emitTimeDuration:a,emitTimeCycle:o,life:s,directionMode:l,noiseType:c}=e;return void 0!==t||void 0!==i||n||null===n||void 0!==o||void 0!==r||void 0!==s||void 0!==a||void 0!==l||void 0!==c}init(e){this.dispose(),this.particlesAmount=this.getMaxParticlesAmount({birthRatePerSecond:e.birthRatePerSec,particleMaxLifeTime:e.life,loopDuration:"infinity"===e.emitTimeCycle?0:e.emitTimeDuration}),this.particlesAmount>1e5&&(console.warn("The maximum number of particles is limited to ".concat(1e5,".")),this.particlesAmount=1e5),this.emitterShape=this.createShape(e.shape,this.particlesAmount);let t=setInterval(()=>{if(this.emitterShape){if(isNaN(this.emitterShape.positionsTexture.source.data.data[0]))return void this.init(e);clearInterval(t)}},100);if(!this.emitterShape)return;let i=new Y3(this.emitterShape.textureSize,this.emitterShape.textureSize,this.renderer),n=this.updateSimulationDefinition(e),r=i.addVariable("uCurrentPosition",n+"\n// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU\nuniform sampler2D uOriginalPosition;\nuniform float uTime;\nuniform float uSpeed;     // update speed of the particles\nuniform vec3 uWorldOffset;    \nuniform vec4 uWorldQuaternion;\nuniform float uMaxLifeTime;\nuniform vec3 uEmitterSize;\nuniform float uFPSRatio;     // 1  for 60 FPS\n\nfloat random (vec2 st) {\n    return fract(sin(dot(st.xy,\n        vec2(12.9898,78.233)))*\n        43758.5453123);\n}\nvec3 applyQuaternionToVector( vec4 q, vec3 v ){\n    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\n}\n\nvec3 applyForce(vec3 force, float mass) {\n    vec3 acceleration = force / mass;\n    \n    return acceleration;\n  }\n  \n\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;\n    float currentLife = texture2D( uCurrentPosition, vUv ).w;   // from 1 to 0\n    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).r;        // 1. = spawning, 0. = not spawning\n    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;          // 1. = active, 0. = not active\n    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;         // timeStart in seconds when the particle was emitted\n    vec3 originalPosition = ((texture2D( uOriginalPosition, vUv ).xyz) * uEmitterSize);\n    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;\n    float collisionFlag = texture2D( uCurrentVelocity, vUv ).w;             // 1. = collided, 0. = not collided\n    float lifeTime = uMaxLifeTime;\n\n    // Calculate the position adjustment based on collision\n    //     if (collisionFlag > .5) {  \n    float isColliding = step(0.5, collisionFlag); // 1.0 if collisionFlag > 0.5, otherwise 0.0\n    float bounceOffset = 3.0 * isColliding; // Becomes 3.0 if colliding, 0.0 otherwise\n    vec3 collisionAdjustedVelocity = velocity * (1.0 + bounceOffset);\n\n    // Update position based on collision or normal movement\n    vec3 fpsVelocity = velocity * min(uFPSRatio, 5.0);\n    position += mix(fpsVelocity, collisionAdjustedVelocity, isColliding);\n\n    // EMISSION RATE - BIRTH\n    // if (isSpawning == 1.0) {\n    // Better Approach to avoid If statement\n    vec3 newPosition = applyQuaternionToVector(uWorldQuaternion, originalPosition) + uWorldOffset;\n    originalPosition = mix(originalPosition, newPosition, isSpawning);\n    position = mix(position, originalPosition, isSpawning);;\n    timeStart = mix(timeStart, uTime, isSpawning);\n\n    // Calculate timeLeft for life normalization\n    float timeLeft = max(lifeTime - (uTime - timeStart), 0.0);\n    float life_Normalize = timeLeft / lifeTime;\n\n    // Use isActive to blend between the calculated color and black\n    vec4 activeColor = vec4(position, life_Normalize);\n    // if (isActive == 1.0) {\n    gl_FragColor = mix(vec4(0.0), activeColor, isActive);\n\n}\n",this.emitterShape.positionsTexture),a=i.addVariable("uCurrentVelocity",n+$3,this.emitterShape.directionsTexture),o=i.addVariable("uCurrentEmissionRate","\n// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU\n\nuniform sampler2D uIndex; // Texture with corresponding index\nuniform float uLastIndexEmitted; // Last emitted index\nuniform float uParticlesToEmit; // Number of particles to emit on that frame\nuniform float uTime;\n\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    float particleIndex = texture(uIndex, vUv).x;\n    float timeLeft = texture2D( uCurrentPosition, vUv ).w;\n    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;    // 1. = active, 0. = not active\n    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;\n\n\n    // ********** Detect Colision to Create a flag and use it in position **********\n    // We are doing this here, so\n\n    // ********** Emit Particles **********\n    // X = isSpawning 0.0 or 1.0\n    // Y = isActive 0.0 or 1.0\n    // Check if the vertex index is between the first value and the last value\n    // if (particleIndex >= uLastIndexEmitted && particleIndex < uLastIndexEmitted + uParticlesToEmit) {\n    //     // Emit a particle by writing 1 to the red channel of the color output\n    //     // r: 1. == emit the particle\n    //     // g: 1. == particle is now active\n    //     timeStart = uTime;\n    //     gl_FragColor = vec4(1.0, 1.0, timeStart, 1.0);\n    // } else {\n    //     // The Particle is either already emitted or not in the range of the particles to emit\n    //     // Do not emit a particle by writing 0 to the red channel of the color output        \n    //     gl_FragColor = vec4(0.0, isActive, timeStart, 1.0);\n    // }\n    // Determine if the particle is within the emission range\n    float emitLowerBound = step(uLastIndexEmitted, particleIndex);\n    float emitUpperBound = step(particleIndex, uLastIndexEmitted + uParticlesToEmit - 1.0);\n    float emitParticle = emitLowerBound * emitUpperBound; // 1.0 if in range, 0.0 otherwise\n\n    // Set timeStart and color\n    timeStart = mix(timeStart, uTime, emitParticle);\n    gl_FragColor = vec4(emitParticle, mix(isActive, 1.0, emitParticle), timeStart, 1.0);\n\n\n}\n",function(e){let t=new Float32Array(4*e*e);for(let n=0;n<e*e;n++)t[4*n]=0,t[4*n+1]=0,t[4*n+2]=0,t[4*n+3]=0;let i=new LT(t,e,e,ES,SS);return i.needsUpdate=!0,i}(this.emitterShape.textureSize));i.setVariableDependencies(r,[r,a,o]),i.setVariableDependencies(a,[r,a,o]),i.setVariableDependencies(o,[r,a,o]);let s=function(e){let{size:t}=e,i=new Float32Array(4*t*t);for(let r=0;r<t*t;r++)i[4*r]=r,i[4*r+1]=0,i[4*r+2]=0,i[4*r+3]=0;let n=new LT(i,t,t,ES,SS);return n.needsUpdate=!0,n}({size:this.emitterShape.textureSize}),l={uOriginalPosition:{value:this.emitterShape.positionsTexture},uWorldOffset:{value:new j_(0,0,0)},uWorldQuaternion:{value:new B_(0,0,0,1)},uTime:{value:0},uFPSRatio:{value:1},uMaxLifeTime:{value:e.life},uEmitterSize:{value:new j_(Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"])))},particleSize:{value:0}};r.material.uniforms=l;let d=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(d),this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"]));let u=e.colliderEntityId&&this.system.getColliderData(e.colliderEntityId),h={uOriginalPosition:{value:this.emitterShape.positionsTexture},uDirections:{value:this.emitterShape.directionsTexture},uDirectionsAxis:{value:this.directionAxis},uWorldQuaternion:{value:new B_(0,0,0,1)},uColliderPos:{value:new j_(0,0,0)},uColliderSize:{value:new j_(0,0,0)},uForceIntensity:{value:u?u.forceIntensity:0},uForceDamping:{value:u?u.forceDambing:0},uColliderQuaternion:{value:new B_(0,0,0,1)},uColliderQuaternionInvert:{value:new B_(0,0,0,1)},particleSize:{value:0},uGravity:{value:this.worldGravity},uNoiseStrength:{value:this.noiseStrength},uNoiseScale:{value:this.noiseScale},uNoiseSeed:{value:e.noiseSeed},uRandomMassFactor:{value:e.randomMass},uBounce:{value:e.collisionBounce},uSpeed:{value:Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/10}};a.material.uniforms=h;let p={uIndex:{value:s},uTime:{value:0},uLastIndexEmitted:{value:0},uParticlesToEmit:{value:0}};o.material.uniforms=p;let f=[Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"]))],m=c(c({},a4(this.system.data).shape),{},{size:f});this.emitterShape.applyToShader(r.material.uniforms,m),i.init(),this.gpuCompute=i,this.positionSimRT=r,this.velocitySimRT=a,this.emissionRateSimRT=o,this.rootObject=this.createPrimaryEmitter(this.emitterShape.textureSize),this.add(this.rootObject),this.material.needsUpdate=!0}getDirectionFromVariable(e){return[Number(this.shared.getVariable(e[0],[this.uuid,"particles","direction_x"])),Number(this.shared.getVariable(e[1],[this.uuid,"particles","direction_y"])),Number(this.shared.getVariable(e[2],[this.uuid,"particles","direction_z"]))]}updateSimulationDefinition(e){if(this.simFeaturesDefinition.USE_COLLIDER=!1,this.simFeaturesDefinition.USE_ATTRACTOR=!1,this.simFeaturesDefinition.USE_VORTEX=!1,this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!1,this.simFeaturesDefinition.USE_BOX_COLLIDER=!1,this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!1,this.simFeaturesDefinition.USE_NORMALS=!1,this.simFeaturesDefinition.USE_CURL_NOISE=!1,this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!1,this.simFeaturesDefinition.USE_FBM_NOISE=!1,e.colliderEntityId&&this.system.colliderEntities.length>0){let t=this.system.getColliderData(e.colliderEntityId);switch(null===t||void 0===t?void 0:t.forceType){case"attractor":this.simFeaturesDefinition.USE_ATTRACTOR=!0;break;case"collider":this.simFeaturesDefinition.USE_COLLIDER=!0;break;case"vortex":this.simFeaturesDefinition.USE_VORTEX=!0}let i=null===t||void 0===t?void 0:t.colliderType;"sphere"===i&&(this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!0),"box"===i&&(this.simFeaturesDefinition.USE_BOX_COLLIDER=!0),"helper"===(null===t||void 0===t?void 0:t.forceRange)&&(this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!0)}"normals"===e.directionMode&&(this.simFeaturesDefinition.USE_NORMALS=!0),"curl"===e.noiseType&&(this.simFeaturesDefinition.USE_CURL_NOISE=!0),"simplex"===e.noiseType&&(this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!0),"fbm"===e.noiseType&&(this.simFeaturesDefinition.USE_FBM_NOISE=!0);let t="";for(let[i,n]of Object.entries(this.simFeaturesDefinition))n&&(t+="#define ".concat(i,"\n"));return t}createShape(e,t){this.emitterShape&&this.emitterShape.dispose();let i=new j_(Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.size[2],[this.uuid,"particles","shape_size_2"])));if("MeshEmitterShape"===e.type){let n=null;return this.system.context.scene.traverseEntity(t=>{t.uuid===e.fromMeshId&&(n=t)}),n?new r4(i,t,e.type,n):new r4(i,t,"SphereEmitterShape")}return new r4(i,t,e.type)}createPrimaryEmitter(e){let t,i=e*e;return t=new qT(new eA(1,1,1),this.material,i),this.updateGeometryAttributes(t,e),this.material.needsUpdate=!0,t.onBeforeRender=()=>{this.applyWorldSpace()},t}getMaxParticlesAmount(e){let{birthRatePerSecond:t,particleMaxLifeTime:i,loopDuration:n=0}=e;return Math.ceil(t*(i+n))}dispose(){var e,t;!this.gpuCompute||(null!==(e=this.rootObject)&&void 0!==e&&null!==(e=e.parent)&&void 0!==e&&e.remove(this.rootObject),this.gpuCompute.dispose(),this.material.nodeMaterialDispose(),null===(t=this.emitterShape)||void 0===t||t.dispose())}GoEmitSomeParticles(e,t){let i=e-this.lastEmitTime,n=1/t;if(i>=n){let t=Math.max(1,Math.floor(i/n));return this.lastEmitTime=e,this.emittedParticlesAmount+t>this.particlesAmount&&(this.emittedParticlesAmount=0),this.emittedParticlesAmount+=t,t}return 0}checkIfAllParticlesAreDead(){return this.lastEmitTime+this.system.data.life+1<this.globalTime}reset(){this.hasBeenReset=!0,this.lastEmitTime=0,this.emittedParticlesAmount=0,this.gpuCompute&&this.init(a4(this.system.data))}startEmitting(e){this.isEmitting=!0,this.hasBeenReset=!1,this.lastEmitTime=e}stopEmitting(){this.isEmitting=!1}},s4=class extends CQ{constructor(e,t,i){super(e,t),this.type="ParticleSystem",this.geometry=new vE,this.actualTime=0,this.currentLoopTime=0,this.started=!1,this.stopped=!1,this.timeoutId=void 0,this.isFrozen=!1,this.isIdle=!0,this.emitter=null,this.colliderEntities=[],this.renderer=null,this.isPreWarm=!1,this._hasOnAfterRenderBeenCalled=!1,this.onAfterRender=e=>{this._hasOnAfterRenderBeenCalled||(this._hasOnAfterRenderBeenCalled=!0,this.init(e))},this.context=i,this.data=c(c({},t),a4(t)),this.geometry.setAttribute("position",new cE([],3)),this.material=new nE({colorWrite:!1}),this.frustumCulled=!1}init(e){this.renderer=e,this.emitter=new o4(e,this),this.add(this.emitter),this.updateParticleState(this.data)}update(e){if(!this.isReady||!this.started||this.isFrozen||this.isIdle)return;this.actualTime+=e,this.stopped||(this.currentLoopTime+=e);let t="one_time"===this.data.emitTimeCycle;if(("loop"===this.data.emitTimeCycle||t)&&this.currentLoopTime>1e3*this.data.emitTimeDuration&&(this.stopped||(this.stop(),t||this.start(1e3*this.data.emitTimeDelay))),this.emitter&&this.started){let t=this.actualTime/1e3;this.emitter.update(t,e)}this.scale.set(1,1,1),this.updateMatrix()}isReady(){return!!this.emitter}hasCollider(e){return this.colliderEntities.some(t=>t.identity===e)}getColliderData(e){let t=this.colliderEntities.find(t=>t.identity===e);return t?t.data:null}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),xF(e.path,["renderMaterial"])&&this.updateParticleState({renderMaterial:c(c({},this.data.renderMaterial),GN.drop(e,1).props)}),xF(e.path,["shape"])&&this.updateParticleState({shape:c(c({},this.data.shape),GN.drop(e,1).props)})}updateState(e,t){super.updateState(e,t),this.updateParticleState(e)}updateParticleState(e){if(this.emitter){if(void 0!==e.colliderEntityId&&null!==e.colliderEntityId){let t=this.context.scene.find(e.colliderEntityId);this.colliderEntities=t?[t]:[]}null===e.colliderEntityId&&(this.colliderEntities=[]),this.emitter.updateState(e),e.emitTimeCycle&&this.started&&this.start()}}updateFromColliderEntity(e){!this.emitter||(this.emitter.updateForceFieldParameters(e),this.stop(),this.start())}start(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.currentLoopTime=0,t?this.timeoutId=window.setTimeout(()=>{this.start(0)},t):(this.started=!0,this.stopped=!1,this.isFrozen=!1,null===(e=this.emitter)||void 0===e||e.startEmitting(this.actualTime/1e3))}froze(){this.isFrozen=!0}unFroze(){this.isFrozen=!1}stop(){var e;this.stopped=!0,this.currentLoopTime=0,null!==(e=this.emitter)&&void 0!==e&&e.stopEmitting(),clearTimeout(this.timeoutId)}reset(){var e;this.started=!1,this.stopped=!1,null===(e=this.emitter)||void 0===e||e.reset()}wakeUp(){this.isIdle=!1}sleep(){this.isIdle=!0,this.reset()}};var l4=function(){try{let e=window.location.href;if(e.includes("reducesubdiv=")){let t=e.indexOf("reducesubdiv=")+13;return parseInt(e.slice(t,t+1))}}catch(e){}}();function c4(e,t,i){return console.assert(void 0!==t.type),"Mesh"===t.type?function(e,t,i){var n,r;let a;return void 0!==l4&&(null!==(n=null===t||void 0===t||null===(r=t.geometry)||void 0===r?void 0:r.subdivisions)&&void 0!==n?n:0)>l4&&(console.log("reducing subdivisions",t.name,t.geometry.subdivisions),t.geometry.subdivisions=l4),"TextGeometry"===t.geometry.type?new R$(e,t,i):"InputGeometry"===t.geometry.type?new V3(e,t,i):(a="SubdivGeometry"===t.geometry.type?new d$(e,t,i):"PathGeometry"===t.geometry.type?new U3(e,t,i):"VectorGeometry"===t.geometry.type?new F3(e,t,i):"BooleanGeometry"===t.geometry.type?new v0(e,t,i):"ShapeBlendGeometry"===t.geometry.type?new v4(e,t,i):"UIGeometry"===t.geometry.type?new X3(e,t,i):new r$(e,t,i),a)}(e,t,i):"Empty"===t.type?new M0(e,t):"Particle"===t.type?new s4(e,t,i):"ParticleCollider"===t.type?new T0(e,t,i):"Splat"===t.type?new M0(e,t):"Bone"===t.type?new q3(e,t):"Page"===t.type?new B3(e,t,i):"PointLight"===t.type?new N3(e,t,i):"SpotLight"===t.type?new B2(e,t,i):"DirectionalLight"===t.type?new k2(e,t,i):"Component"===t.type||"Instance"===t.type?new j3(e,t,i):NV.is(t.type)?new h0(e,t):(console.error(t),new M0(e,t))}VG.createEntity=c4,VG.changeEntityProptotype=function(e,t,i){let n=c4(e.identity,t,i),r=e.children,a=e.attachedPaths,o=e.parent,s=e.component,l=e.instances,c=e.overrideData,d=e.uuid,u=e.stateSelection;e.dispose();for(let h of Object.keys(e))delete e[h];Object.setPrototypeOf(e,Object.getPrototypeOf(n));for(let h of Object.keys(n))e[h]=n[h];e.children=[...e.children,...r],e.attachedPaths=a,e.parent=o,e.component=s,e.instances=l,e.uuid=d,e.overrideData=c,e.updateState(e.data,i),u&&e.changeSelectedState(u,i),e.resetBBoxNeedsUpdate()},VG.Cloner=X$;var d4=new vE;d4.setAttribute("position",new oE(new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),3));var u4=class extends lD{constructor(e){super(c(c({},e),{},{depthTest:!1,depthWrite:!1,glslVersion:KS,vertexShader:"\n\t\t\t\tprecision highp float;\n\t\t\t\tin vec3 position;\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_Position = vec4(position, 1);\n\t\t\t\t}\n\t\t\t"}))}customProgramCacheKey(){return""}};var h4=new FE,p4=24,f4=96,m4={shapeInput:()=>"\n\t\t\tconst float posRowCoord = ".concat(.1,";  // vec4: px py pz opType\n\t\t\tconst float quatRowCoord = ").concat(.3,";  // vec4: qx qy qz qw\n\t\t\tconst float param1RowCoord = ").concat(.5,";// vec4: type param1 param2 param3\n\t\t\tconst float param2RowCoord = ").concat(.7,";// vec4: blendRange roundness scale param4\n\t\t\tconst float colorRowCoord = ").concat(.9,"; // vec4: r g b a\n\t\t\tuniform sampler2D shapesDataTexture;\n\t\t\tvec4 shapePos(float iin) { \n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, posRowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeQuat(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, quatRowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeParams1(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, param1RowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeParams2(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, param2RowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeColor(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, colorRowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t"),getxyzi:"\n\t\t\t// this code must complement lookup\n\t\t\tfloat xi = mod(gl_FragCoord.x - 0.5, VOXEL_RESOLUTION);\n\t\t\tfloat yi = mod(gl_FragCoord.y - 0.5, VOXEL_RESOLUTION);\n\t\t\tfloat zi = floor((gl_FragCoord.x - 0.5) * INV_VOXEL_RESOLUTION) + floor((gl_FragCoord.y - 0.5) * INV_VOXEL_RESOLUTION) * Z_LAYERS_PER_ROW;\n\t\t",lookup:"\n\t\t\tuniform sampler2D potentialPassTexture;\n\t\t\tuniform sampler2D voxelPassTexture; // includes normal (in xyz) and key (in w)\n\t\t\t\n\t\t\t// box or marching cube lookup value in value texture, integer box coord inputs\n\t\t\t// this code must complement codebits.getxyzi\n\t\t\tvec4 look(float xi, float yi, float zi, sampler2D rt) {// range 0 .. numv etc\n\t\t\t\tvec2 uv = vec2(\n\t\t\t\t\tmod(zi, Z_LAYERS_PER_ROW) + (xi + 0.5) / VOXEL_RESOLUTION,\n\t\t\t\t\tfloor(zi / Z_LAYERS_PER_ROW) + (yi + 0.5) / VOXEL_RESOLUTION\n\t\t\t\t); \n\t\t\t\tuv /= Z_LAYERS_PER_ROW;\n\t\t\t\treturn texture(rt, uv);\n\t\t\t}\n\t\t",getpart:"\n\t\t\tfloat getpart(inout float a, float b) {\n\t\t\t\tfloat t = floor(a/b);\n\t\t\t\tfloat r = a - t*b;\n\t\t\t\ta = t;\n\t\t\t\treturn r;\n\t\t\t}\n\t\t",triTable:new Float32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,1,1,8,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,10,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,9,9,2,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,2,8,10,2,8,9,10,-1,-1,-1,-1,-1,-1,-1,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,0,0,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,11,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,1,11,9,1,11,8,9,-1,-1,-1,-1,-1,-1,-1,1,10,3,3,10,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,10,0,10,8,0,10,11,8,-1,-1,-1,-1,-1,-1,-1,0,9,3,9,11,3,9,10,11,-1,-1,-1,-1,-1,-1,-1,10,8,9,11,8,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,4,4,3,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,7,4,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,4,1,7,4,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,2,1,7,4,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,4,3,4,0,3,10,2,1,-1,-1,-1,-1,-1,-1,-1,10,2,9,2,0,9,7,4,8,-1,-1,-1,-1,-1,-1,-1,9,10,2,7,9,2,3,7,2,4,9,7,-1,-1,-1,-1,7,4,8,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,4,11,4,2,11,4,0,2,-1,-1,-1,-1,-1,-1,-1,1,0,9,7,4,8,11,3,2,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,9,2,11,9,1,2,9,-1,-1,-1,-1,1,10,3,10,11,3,4,8,7,-1,-1,-1,-1,-1,-1,-1,10,11,1,11,4,1,4,0,1,4,11,7,-1,-1,-1,-1,8,7,4,11,0,9,10,11,9,3,0,11,-1,-1,-1,-1,11,7,4,9,11,4,10,11,9,-1,-1,-1,-1,-1,-1,-1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,9,3,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,0,0,5,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,8,5,3,8,5,1,3,-1,-1,-1,-1,-1,-1,-1,10,2,1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,3,10,2,1,5,9,4,-1,-1,-1,-1,-1,-1,-1,10,2,5,2,4,5,2,0,4,-1,-1,-1,-1,-1,-1,-1,5,10,2,5,2,3,4,5,3,8,4,3,-1,-1,-1,-1,4,5,9,11,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,0,11,8,0,5,9,4,-1,-1,-1,-1,-1,-1,-1,4,5,0,5,1,0,11,3,2,-1,-1,-1,-1,-1,-1,-1,5,1,2,8,5,2,11,8,2,5,8,4,-1,-1,-1,-1,11,3,10,3,1,10,4,5,9,-1,-1,-1,-1,-1,-1,-1,5,9,4,1,8,0,1,10,8,10,11,8,-1,-1,-1,-1,0,4,5,11,0,5,10,11,5,3,0,11,-1,-1,-1,-1,8,4,5,10,8,5,11,8,10,-1,-1,-1,-1,-1,-1,-1,8,7,9,9,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,9,3,5,9,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,7,0,7,1,0,7,5,1,-1,-1,-1,-1,-1,-1,-1,3,5,1,7,5,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,7,9,7,5,9,2,1,10,-1,-1,-1,-1,-1,-1,-1,2,1,10,0,5,9,0,3,5,3,7,5,-1,-1,-1,-1,2,0,8,5,2,8,7,5,8,2,5,10,-1,-1,-1,-1,5,10,2,3,5,2,7,5,3,-1,-1,-1,-1,-1,-1,-1,5,9,7,9,8,7,2,11,3,-1,-1,-1,-1,-1,-1,-1,7,5,9,2,7,9,0,2,9,11,7,2,-1,-1,-1,-1,11,3,2,8,1,0,8,7,1,7,5,1,-1,-1,-1,-1,1,2,11,7,1,11,5,1,7,-1,-1,-1,-1,-1,-1,-1,8,5,9,7,5,8,3,1,10,11,3,10,-1,-1,-1,-1,0,7,5,9,0,5,0,11,7,10,0,1,0,10,11,-1,0,10,11,3,0,11,0,5,10,7,0,8,0,7,5,-1,5,10,11,5,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,6,10,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,0,9,6,10,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,1,8,9,1,6,10,5,-1,-1,-1,-1,-1,-1,-1,5,6,1,1,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,6,1,6,2,1,8,0,3,-1,-1,-1,-1,-1,-1,-1,5,6,9,6,0,9,6,2,0,-1,-1,-1,-1,-1,-1,-1,8,9,5,2,8,5,6,2,5,8,2,3,-1,-1,-1,-1,11,3,2,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,11,0,2,11,5,6,10,-1,-1,-1,-1,-1,-1,-1,9,1,0,11,3,2,6,10,5,-1,-1,-1,-1,-1,-1,-1,6,10,5,2,9,1,2,11,9,11,8,9,-1,-1,-1,-1,11,3,6,3,5,6,3,1,5,-1,-1,-1,-1,-1,-1,-1,11,8,0,5,11,0,1,5,0,6,11,5,-1,-1,-1,-1,6,11,3,6,3,0,5,6,0,9,5,0,-1,-1,-1,-1,9,5,6,11,9,6,8,9,11,-1,-1,-1,-1,-1,-1,-1,6,10,5,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,4,3,7,4,10,5,6,-1,-1,-1,-1,-1,-1,-1,0,9,1,6,10,5,7,4,8,-1,-1,-1,-1,-1,-1,-1,5,6,10,7,9,1,3,7,1,4,9,7,-1,-1,-1,-1,2,1,6,1,5,6,8,7,4,-1,-1,-1,-1,-1,-1,-1,5,2,1,6,2,5,4,0,3,7,4,3,-1,-1,-1,-1,7,4,8,5,0,9,5,6,0,6,2,0,-1,-1,-1,-1,9,3,7,4,9,7,9,2,3,6,9,5,9,6,2,-1,2,11,3,4,8,7,5,6,10,-1,-1,-1,-1,-1,-1,-1,6,10,5,2,7,4,0,2,4,11,7,2,-1,-1,-1,-1,9,1,0,8,7,4,11,3,2,6,10,5,-1,-1,-1,-1,1,2,9,2,11,9,11,4,9,4,11,7,6,10,5,-1,7,4,8,5,11,3,1,5,3,6,11,5,-1,-1,-1,-1,11,1,5,6,11,5,11,0,1,4,11,7,11,4,0,-1,9,5,0,5,6,0,6,3,0,3,6,11,7,4,8,-1,9,5,6,11,9,6,9,7,4,9,11,7,-1,-1,-1,-1,9,4,10,10,4,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,10,4,10,9,4,3,8,0,-1,-1,-1,-1,-1,-1,-1,1,0,10,0,6,10,0,4,6,-1,-1,-1,-1,-1,-1,-1,1,3,8,6,1,8,4,6,8,10,1,6,-1,-1,-1,-1,9,4,1,4,2,1,4,6,2,-1,-1,-1,-1,-1,-1,-1,8,0,3,9,2,1,9,4,2,4,6,2,-1,-1,-1,-1,4,2,0,6,2,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,4,2,8,6,2,4,-1,-1,-1,-1,-1,-1,-1,9,4,10,4,6,10,3,2,11,-1,-1,-1,-1,-1,-1,-1,2,8,0,11,8,2,10,9,4,6,10,4,-1,-1,-1,-1,2,11,3,6,1,0,4,6,0,10,1,6,-1,-1,-1,-1,1,4,6,10,1,6,1,8,4,11,1,2,1,11,8,-1,4,6,9,6,3,9,3,1,9,3,6,11,-1,-1,-1,-1,1,11,8,0,1,8,1,6,11,4,1,9,1,4,6,-1,6,11,3,0,6,3,4,6,0,-1,-1,-1,-1,-1,-1,-1,8,4,6,8,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,10,7,10,8,7,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,7,0,7,10,0,10,9,0,10,7,6,-1,-1,-1,-1,7,6,10,7,10,1,8,7,1,0,8,1,-1,-1,-1,-1,7,6,10,1,7,10,3,7,1,-1,-1,-1,-1,-1,-1,-1,6,2,1,8,6,1,9,8,1,7,6,8,-1,-1,-1,-1,9,6,2,1,9,2,9,7,6,3,9,0,9,3,7,-1,0,8,7,6,0,7,2,0,6,-1,-1,-1,-1,-1,-1,-1,2,3,7,2,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,3,2,8,6,10,9,8,10,7,6,8,-1,-1,-1,-1,7,0,2,11,7,2,7,9,0,10,7,6,7,10,9,-1,0,8,1,8,7,1,7,10,1,10,7,6,11,3,2,-1,1,2,11,7,1,11,1,6,10,1,7,6,-1,-1,-1,-1,6,9,8,7,6,8,6,1,9,3,6,11,6,3,1,-1,1,9,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,6,0,7,0,11,3,0,6,11,-1,-1,-1,-1,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,3,6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,8,1,3,8,6,7,11,-1,-1,-1,-1,-1,-1,-1,2,1,10,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,1,8,0,3,7,11,6,-1,-1,-1,-1,-1,-1,-1,0,9,2,9,10,2,7,11,6,-1,-1,-1,-1,-1,-1,-1,7,11,6,3,10,2,3,8,10,8,9,10,-1,-1,-1,-1,3,2,7,7,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,7,0,6,7,0,2,6,-1,-1,-1,-1,-1,-1,-1,6,7,2,7,3,2,9,1,0,-1,-1,-1,-1,-1,-1,-1,2,6,1,6,8,1,8,9,1,6,7,8,-1,-1,-1,-1,6,7,10,7,1,10,7,3,1,-1,-1,-1,-1,-1,-1,-1,6,7,10,10,7,1,7,8,1,8,0,1,-1,-1,-1,-1,7,3,0,10,7,0,9,10,0,7,10,6,-1,-1,-1,-1,10,6,7,8,10,7,9,10,8,-1,-1,-1,-1,-1,-1,-1,4,8,6,6,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,6,3,6,0,3,6,4,0,-1,-1,-1,-1,-1,-1,-1,11,6,8,6,4,8,1,0,9,-1,-1,-1,-1,-1,-1,-1,6,4,9,3,6,9,1,3,9,6,3,11,-1,-1,-1,-1,4,8,6,8,11,6,1,10,2,-1,-1,-1,-1,-1,-1,-1,10,2,1,11,0,3,11,6,0,6,4,0,-1,-1,-1,-1,8,11,4,11,6,4,9,2,0,9,10,2,-1,-1,-1,-1,3,9,10,2,3,10,3,4,9,6,3,11,3,6,4,-1,3,2,8,2,4,8,2,6,4,-1,-1,-1,-1,-1,-1,-1,2,4,0,2,6,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,4,3,2,6,4,2,8,3,4,-1,-1,-1,-1,4,9,1,2,4,1,6,4,2,-1,-1,-1,-1,-1,-1,-1,3,1,8,1,6,8,6,4,8,1,10,6,-1,-1,-1,-1,0,1,10,6,0,10,4,0,6,-1,-1,-1,-1,-1,-1,-1,3,6,4,8,3,4,3,10,6,9,3,0,3,9,10,-1,4,9,10,4,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,9,4,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,5,9,4,6,7,11,-1,-1,-1,-1,-1,-1,-1,1,0,5,0,4,5,11,6,7,-1,-1,-1,-1,-1,-1,-1,6,7,11,4,3,8,4,5,3,5,1,3,-1,-1,-1,-1,4,5,9,2,1,10,11,6,7,-1,-1,-1,-1,-1,-1,-1,7,11,6,10,2,1,3,8,0,5,9,4,-1,-1,-1,-1,11,6,7,10,4,5,10,2,4,2,0,4,-1,-1,-1,-1,8,4,3,4,5,3,5,2,3,2,5,10,6,7,11,-1,3,2,7,2,6,7,9,4,5,-1,-1,-1,-1,-1,-1,-1,4,5,9,6,8,0,2,6,0,7,8,6,-1,-1,-1,-1,2,6,3,6,7,3,0,5,1,0,4,5,-1,-1,-1,-1,8,2,6,7,8,6,8,1,2,5,8,4,8,5,1,-1,4,5,9,6,1,10,6,7,1,7,3,1,-1,-1,-1,-1,10,6,1,6,7,1,7,0,1,0,7,8,4,5,9,-1,10,0,4,5,10,4,10,3,0,7,10,6,10,7,3,-1,10,6,7,8,10,7,10,4,5,10,8,4,-1,-1,-1,-1,5,9,6,9,11,6,9,8,11,-1,-1,-1,-1,-1,-1,-1,11,6,3,3,6,0,6,5,0,5,9,0,-1,-1,-1,-1,8,11,0,11,5,0,5,1,0,11,6,5,-1,-1,-1,-1,3,11,6,5,3,6,1,3,5,-1,-1,-1,-1,-1,-1,-1,10,2,1,11,5,9,8,11,9,6,5,11,-1,-1,-1,-1,3,11,0,11,6,0,6,9,0,9,6,5,10,2,1,-1,5,8,11,6,5,11,5,0,8,2,5,10,5,2,0,-1,3,11,6,5,3,6,3,10,2,3,5,10,-1,-1,-1,-1,9,8,5,8,2,5,2,6,5,2,8,3,-1,-1,-1,-1,6,5,9,0,6,9,2,6,0,-1,-1,-1,-1,-1,-1,-1,8,5,1,0,8,1,8,6,5,2,8,3,8,2,6,-1,6,5,1,6,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,3,1,10,6,1,6,8,3,9,6,5,6,9,8,-1,0,1,10,6,0,10,0,5,9,0,6,5,-1,-1,-1,-1,8,3,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,5,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,11,11,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,11,5,7,11,0,3,8,-1,-1,-1,-1,-1,-1,-1,7,11,5,11,10,5,0,9,1,-1,-1,-1,-1,-1,-1,-1,5,7,10,7,11,10,1,8,9,1,3,8,-1,-1,-1,-1,2,1,11,1,7,11,1,5,7,-1,-1,-1,-1,-1,-1,-1,3,8,0,7,2,1,5,7,1,11,2,7,-1,-1,-1,-1,5,7,9,7,2,9,2,0,9,7,11,2,-1,-1,-1,-1,2,5,7,11,2,7,2,9,5,8,2,3,2,8,9,-1,10,5,2,5,3,2,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,2,8,2,5,8,5,7,8,5,2,10,-1,-1,-1,-1,1,0,9,3,10,5,7,3,5,2,10,3,-1,-1,-1,-1,2,8,9,1,2,9,2,7,8,5,2,10,2,5,7,-1,5,3,1,5,7,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,1,7,0,5,7,1,-1,-1,-1,-1,-1,-1,-1,3,0,9,5,3,9,7,3,5,-1,-1,-1,-1,-1,-1,-1,7,8,9,7,9,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,5,8,10,5,8,11,10,-1,-1,-1,-1,-1,-1,-1,4,0,5,0,11,5,11,10,5,0,3,11,-1,-1,-1,-1,9,1,0,10,4,8,11,10,8,5,4,10,-1,-1,-1,-1,4,11,10,5,4,10,4,3,11,1,4,9,4,1,3,-1,1,5,2,5,8,2,8,11,2,8,5,4,-1,-1,-1,-1,11,4,0,3,11,0,11,5,4,1,11,2,11,1,5,-1,5,2,0,9,5,0,5,11,2,8,5,4,5,8,11,-1,5,4,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,2,2,5,3,5,4,3,4,8,3,-1,-1,-1,-1,2,10,5,4,2,5,0,2,4,-1,-1,-1,-1,-1,-1,-1,2,10,3,10,5,3,5,8,3,8,5,4,9,1,0,-1,2,10,5,4,2,5,2,9,1,2,4,9,-1,-1,-1,-1,5,4,8,3,5,8,1,5,3,-1,-1,-1,-1,-1,-1,-1,5,4,0,5,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,4,8,3,5,8,5,0,9,5,3,0,-1,-1,-1,-1,5,4,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,11,4,11,9,4,11,10,9,-1,-1,-1,-1,-1,-1,-1,3,8,0,7,9,4,7,11,9,11,10,9,-1,-1,-1,-1,11,10,1,4,11,1,0,4,1,11,4,7,-1,-1,-1,-1,4,1,3,8,4,3,4,10,1,11,4,7,4,11,10,-1,7,11,4,4,11,9,11,2,9,2,1,9,-1,-1,-1,-1,4,7,9,7,11,9,11,1,9,1,11,2,3,8,0,-1,4,7,11,2,4,11,0,4,2,-1,-1,-1,-1,-1,-1,-1,4,7,11,2,4,11,4,3,8,4,2,3,-1,-1,-1,-1,10,9,2,9,7,2,7,3,2,9,4,7,-1,-1,-1,-1,7,10,9,4,7,9,7,2,10,0,7,8,7,0,2,-1,10,7,3,2,10,3,10,4,7,0,10,1,10,0,4,-1,2,10,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,4,7,1,4,3,1,7,-1,-1,-1,-1,-1,-1,-1,1,9,4,7,1,4,1,8,0,1,7,8,-1,-1,-1,-1,3,0,4,3,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,10,9,8,11,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,3,11,9,3,10,9,11,-1,-1,-1,-1,-1,-1,-1,10,1,0,8,10,0,11,10,8,-1,-1,-1,-1,-1,-1,-1,10,1,3,10,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,2,1,9,11,1,8,11,9,-1,-1,-1,-1,-1,-1,-1,9,0,3,11,9,3,9,2,1,9,11,2,-1,-1,-1,-1,11,2,0,11,0,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,2,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,10,8,2,9,8,10,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,10,8,2,8,1,0,8,10,1,-1,-1,-1,-1,2,10,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),numTrisTable:new Float32Array([0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,2,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,2,3,4,4,3,3,4,4,3,4,5,5,2,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,4,2,3,3,4,3,4,2,3,3,4,4,5,4,5,3,2,3,4,4,3,4,5,3,2,4,5,5,4,5,2,4,1,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,4,3,4,4,5,3,2,4,3,4,3,5,2,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,4,3,4,4,3,4,5,5,4,4,3,5,2,5,4,2,1,2,3,3,4,3,4,4,5,3,4,4,5,2,3,3,2,3,4,4,5,4,5,5,2,4,3,5,4,3,2,4,1,3,4,4,5,4,5,3,4,4,5,5,2,3,4,2,1,2,3,3,2,3,4,2,1,3,2,4,1,2,1,1,0])},g4=class extends r${constructor(e,t,i){super(e,t,i),this.data=t,this.needsRebuild=!0,this.customDepthMaterialNeedsUpdate=!1,this._npart=-1,this.spatialn=1,this.drawRangeNeedsForceUpdate=!0,this._resolutionLevel=-1,this.resolution=64,this.spatialDivisions=25,this.zLayersPerRow=8,this.basePyramidSize=512,this.pyramidTexture1Width=341,this.pyramidTexture1Height=256,this.pyramidTexture2Width=170,this.pyramidTexture2Height=128,this.numLevels=9,this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512],this.bboxSize=0,this.bboxOffset=0,this.shapesDataTexture={value:void 0},this.spatialscene=new OT,this.potentialPassScene=new OT,this.voxelPassScene=new OT,this._spatialPassRenderTargets=[],this._potentialPassRenderTargets=[],this._voxelPassRenderTargets=[],this._pyramidRenderTargets=[],this.geometry=new vE,this.geometry.drawRange.count=0,this.spatialPassUniforms={span:{value:-1},shapesDataTexture:this.shapesDataTexture,npart:{value:this.npart},spatialn:{value:this.spatialn}},this.spatialMesh=new OE(d4,this.spatialPassMaterial()),this.spatialMesh.frustumCulled=!1,this.spatialscene.add(this.spatialMesh);let n=new LT(m4.triTable,16,256,TS,SS);n.needsUpdate=!0;let r=new LT(m4.numTrisTable,256,1,TS,SS);r.needsUpdate=!0,this.voxelPassUniforms={potentialPassTexture:{value:void 0},numTrisTable:{value:r}},this.voxelMesh=new OE(d4,this.voxelPassMaterial()),this.voxelMesh.frustumCulled=!1,this.voxelPassScene.add(this.voxelMesh),this.potentialPassUniforms={shapesDataTexture:this.shapesDataTexture,spatialPassTexture:{value:void 0},npart:{value:this.npart},spatialn:{value:this.spatialn}},this.potentialMesh=new OE(d4,this.potentialPassMaterial()),this.potentialMesh.frustumCulled=!1,this.potentialPassScene.add(this.potentialMesh),this.marchPassUniforms={triTable:{value:n},potentialPassTexture:{value:void 0},voxelPassTexture:{value:void 0},pyramidTexture1:{value:void 0},pyramidTexture1Size:{value:void 0},pyramidTexture2:{value:void 0},pyramidTexture2Size:{value:void 0}},this.frustumCulled=!1,this.onBeforeShadowPass=e=>{if(A4.call(this),0===this.npart)return void(this.geometry.drawRange.count=0);let t=this.material.root;if(t.shadersPatchedForShapeBlend){if(this.customDepthMaterialNeedsUpdate){this.customDepthMaterialNeedsUpdate=!1,this.customDepthMaterial=new NE({vertexShader:t.vertexShader,fragmentShader:"\n\t\t\t\t\t\t#include <packing>\n\t\t\t\t\t\tvoid main()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgl_FragColor = packDepthToRGBA(gl_FragCoord.z);\n\t\t\t\t\t\t}\n\t\t\t\t\t",uniforms:t.uniforms,defines:this.material.defines}),this.isMeshDepthMaterial=!0,this.customDistanceMaterial=new NE({vertexShader:t.vertexShader,fragmentShader:"\n\t\t\t\t\t#include <common>\n\t\t\t\t\t#include <packing>\n\t\t\t\t\tuniform vec3 referencePosition;\n\t\t\t\t\tuniform float nearDistance;\n\t\t\t\t\tuniform float farDistance;\n\t\t\t\t\t// World-space position\n\t\t\t\t\tvarying vec3 vWPosition;\n\t\t\t\t\tvoid main()\n\t\t\t\t\t{\n\t\t\t\t\t\tfloat dist = length(vWPosition - referencePosition);\n\t\t\t\t\t\tdist = (dist - nearDistance) / (farDistance - nearDistance);\n\t\t\t\t\t\tdist = saturate(dist);\n\t\t\t\t\t\t// Required by Three.js for this to work\n\t\t\t\t\t\tgl_FragColor = packDepthToRGBA( dist );\n\t\t\t\t\t}",uniforms:c({nearDistance:{value:0},farDistance:{value:0},referencePosition:{value:new j_},opacity:{value:0}},t.uniforms),defines:this.material.defines});let e=this.customDistanceMaterial;e.referencePosition=new j_,e.nearDistance=0,e.farDistance=0,e.opacity=1,e.isMeshDistanceMaterial=!0}}else this.patchVertexShaderForShapeBlend(t),t.shadersPatchedForShapeBlend=!0,this.customDepthMaterialNeedsUpdate=!0;if(this.spatialPassUniforms.npart.value=this.npart,this.spatialPassUniforms.spatialn.value=this.spatialn,this.potentialPassUniforms.npart.value=this.npart,this.potentialPassUniforms.spatialn.value=this.spatialn,this.needsRebuild){this.needsRebuild=!1,this.spatialMesh.material.defines.RES=this.resolutionLevel,this.spatialMesh.material.needsUpdate=!0,this.potentialMesh.material.defines.RES=this.resolutionLevel,this.potentialPassUniforms.spatialPassTexture.value=this.spatialPassRenderTarget.texture,this.potentialMesh.material.needsUpdate=!0,this.voxelMesh.material.defines.RES=this.resolutionLevel,this.voxelMesh.material.needsUpdate=!0,this.voxelPassUniforms.potentialPassTexture.value=this.potentialPassRenderTarget.texture,this.marchPassUniforms.potentialPassTexture.value=this.potentialPassRenderTarget.texture,this.marchPassUniforms.voxelPassTexture.value=this.voxelPassRenderTarget.texture[0],this.material.defines.RES=this.resolutionLevel,this.material.defines.LEVELS=this.pyramidLevelSizes.length,this.material.defines.LOOP=this.pyramidLevelSizes.length%2===0?this.pyramidLevelSizes.length-3:this.pyramidLevelSizes.length-2,this.material.defines.HALF=this.pyramidLevelSizes.length%2===0?1:0,this.material.needsUpdate=!0;let e=this.pyramidLevelSizes.length%2===0?0:1,t=this.pyramidLevelSizes.length%2===0?1:0;this.marchPassUniforms.pyramidTexture2.value=this.pyramidRenderTarget[e].texture,this.marchPassUniforms.pyramidTexture2Size.value=new p_(this.pyramidRenderTarget[e].width,this.pyramidRenderTarget[e].height),this.marchPassUniforms.pyramidTexture1.value=this.pyramidRenderTarget[t].texture,this.marchPassUniforms.pyramidTexture1Size.value=new p_(this.pyramidRenderTarget[t].width,this.pyramidRenderTarget[t].height),Object.assign(this.material.uniforms,this.marchPassUniforms)}let i=e.shadowMap.enabled;e.shadowMap.enabled=!1;let n=e.getRenderTarget();e.setRenderTarget(this.spatialPassRenderTarget),e.render(this.spatialscene,h4),e.setRenderTarget(this.potentialPassRenderTarget),e.render(this.potentialPassScene,h4),e.setRenderTarget(this.voxelPassRenderTarget),e.render(this.voxelPassScene,h4),g4.streamCompaction.renderPyramid(this.resolutionLevel,this.pyramidLevelSizes,e,this.voxelPassRenderTarget,this.pyramidRenderTarget).then(e=>{this.material.wireframe&&(3*e>this.geometry.attributes.position.count||this.drawRangeNeedsForceUpdate)&&(this.geometry.dispose(),this.geometry=new vE,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]},this.geometry.attributes.position=new oE(new Float32Array(3*e*2),3)),(3*e>this.geometry.drawRange.count||this.drawRangeNeedsForceUpdate)&&(this.geometry.drawRange.count=3*Math.floor(1.2*e)),this.drawRangeNeedsForceUpdate=!1}),e.shadowMap.enabled=i,e.setRenderTarget(n)}}set npart(e){e!==this._npart&&(this.drawRangeNeedsForceUpdate=!0,this._npart=e,this.spatialn=Math.ceil(e/96))}get npart(){return this._npart}set resolutionLevel(e){let t=Math.min(8,Math.max(5,e));if(t!==this._resolutionLevel){switch(this._resolutionLevel=t,this.resolution=Math.pow(2,t),this.resolutionLevel){case 5:this.pyramidLevelSizes=[1,2,4,6,12,24,48,96,192],this.bboxSize=496,this.bboxOffset=-8;break;case 6:this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512],this.bboxSize=504,this.bboxOffset=-4;break;case 7:this.pyramidLevelSizes=[1,2,4,6,12,24,48,96,192,384,768,1536],this.bboxSize=508,this.bboxOffset=-2;break;case 8:this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096],this.bboxSize=510,this.bboxOffset=-1}this.pyramidTexture1Width=0,this.pyramidTexture2Width=0,this.pyramidTexture1Height=this.pyramidLevelSizes[this.pyramidLevelSizes.length-2],this.pyramidTexture2Height=this.pyramidLevelSizes[this.pyramidLevelSizes.length-3];for(let e=this.pyramidLevelSizes.length-2;e>=0;e--)(this.pyramidLevelSizes.length-2)%2===e%2?this.pyramidTexture1Width+=this.pyramidLevelSizes[e]:this.pyramidTexture2Width+=this.pyramidLevelSizes[e];this.basePyramidSize=this.pyramidLevelSizes[this.pyramidLevelSizes.length-1],this.zLayersPerRow=this.basePyramidSize/this.resolution,this.numLevels=this.pyramidLevelSizes.length-1,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]},this.needsRebuild=!0,this.customDepthMaterialNeedsUpdate=!0}}get resolutionLevel(){return this._resolutionLevel}get spatialPassRenderTarget(){let e=this._spatialPassRenderTargets[this.resolutionLevel];return e||(e=new N_(this.spatialDivisions*this.spatialn,this.spatialDivisions**2,{format:ES,type:SS,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:fS,magFilter:fS}),this._spatialPassRenderTargets[this.resolutionLevel]=e),e}get potentialPassRenderTarget(){let e=this._potentialPassRenderTargets[this.resolutionLevel];return e||(e=new N_(this.basePyramidSize,this.basePyramidSize,{format:ES,type:SS,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:fS,magFilter:fS}),this._potentialPassRenderTargets[this.resolutionLevel]=e),e}get voxelPassRenderTarget(){let e=this._voxelPassRenderTargets[this.resolutionLevel];return e||(e=new U_(this.basePyramidSize,this.basePyramidSize,2,{stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:fS,magFilter:fS}),e.texture[0].format=ES,e.texture[0].type=SS,e.texture[1].format=TS,e.texture[1].type=SS,this._voxelPassRenderTargets[this.resolutionLevel]=e),e}get pyramidRenderTarget(){let e=this._pyramidRenderTargets[this.resolutionLevel];if(!e){e=[new N_(this.pyramidTexture1Width,this.pyramidTexture1Height,{format:ES,type:SS,stencilBuffer:!1,depthBuffer:!1,magFilter:fS,minFilter:fS}),new N_(this.pyramidTexture2Width,this.pyramidTexture2Height,{format:ES,type:SS,stencilBuffer:!1,depthBuffer:!1,magFilter:fS,minFilter:fS})],this._pyramidRenderTargets[this.resolutionLevel]=e}return e}updateState(e,t){let i=this.material;super.updateState(e,t),i!==this.material&&(this.needsRebuild=!0),e.geometry&&(this.resolutionLevel=e.geometry.resolutionLevel,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]}),e.wireframe&&!this.geometry.getAttribute("position")?this.geometry.setAttribute("position",new oE(new Float32Array(3*this.geometry.drawRange.count),3)):!e.wireframe&&this.geometry.getAttribute("position")&&this.geometry.deleteAttribute("position")}spatialPassMaterial(){let e="\n\t\t\tprecision highp float;\n\t\t\tout vec4 pc_FragColor;\n\t\t\tconst float spatialDivisions = ".concat(this.spatialDivisions,".;\n\t\t\tuniform float span;\n\t\t\tuniform float npart;\n\t\t\tuniform float spatialn;\n\t\t\t").concat(m4.shapeInput(),"\n\n\t\t\tvec3 low, high;     // range of current div; subset of -1 .. 1 with span border\n\n\t\t\t// lookup one element/channel's worth of spheres for current division\n\t\t\t// stating with low sphere number lowi\n\t\t\t// gives a key to which spheres from lowi..lowi+23 are active within given div (low..high)\n\t\t\tfloat spatialKey(float lowi) {\n\t\t\t\tfloat t = 0.;\n\t\t\t\tfor (float ii = ").concat(23,".; ii >= 0.; ii--) {\n\t\t\t\t\tfloat i = ii + lowi;\n\t\t\t\t\tfloat iin = (i + 0.5) / ").concat(f4,".;\n\t\t\t\t\tvec4 shape = shapePos(iin);\n\t\t\t\t\tvec3 d = shape.xyz;\n\t\t\t\t\tfloat op = shape.w;\n\t\n\t\t\t\t\tt *= 2.;\n\t\t\t\t\tt += (\n\t\t\t\t\t\tlow.x < d.x && d.x < high.x &&\n\t\t\t\t\t\tlow.y < d.y && d.y < high.y &&\n\t\t\t\t\t\tlow.z < d.z && d.z < high.z &&\n\t\t\t\t\t\ti < npart || op == -2. // always include if op is -2, which is the intersection operation\n\t\t\t\t\t) ? 1. : 0.;\n\t\t\t\t}\n\t\t\t\treturn t;\n\t\t\t}\n\n\t\t\t").concat(m4.getpart,"\n\n\t\t\tvoid main() {               // spatialial fragment shader\n\t\t\t\t// find active div\n\t\t\t\tvec3 div;                               // which div is current\n\t\t\t\t// out holds x=> x, lowi faster moving and y=> z, y faster moving\n\t\t\t\tfloat yz = float(gl_FragCoord.y - 0.5);     // contains  z, y faster moving\n\t\t\t\tdiv.y = getpart(yz, spatialDivisions);\n\t\t\t\tdiv.z = yz; // getpart(yz, spatialDivisions.z); // what's left, should be the same as getpart\n\n\t\t\t\tfloat lx = float(gl_FragCoord.x - 0.5);     // contains x, lowi faster moving\n\t\t\t\tfloat lowi = getpart(lx, spatialn) * ").concat(96,".;\n\t\t\t\tdiv.x = lx;\n\n\t\t\t\tlow = div / spatialDivisions * 2. - 1. - span;\n\t\t\t\thigh = (div+1.) / spatialDivisions * 2. - 1. + span;\n\n\t\t\t\t// find active range of spheres\n\t\t\t\tpc_FragColor.x = spatialKey(lowi);\n\t\t\t\tpc_FragColor.y = spatialKey(lowi+").concat(p4,".);\n\t\t\t\tpc_FragColor.z = spatialKey(lowi+").concat(48,".);\n\t\t\t\tpc_FragColor.w = spatialKey(lowi+").concat(72,".);\n\t\t\t}\n\t\t");return new u4({name:"Spatial Pass",fragmentShader:e,uniforms:this.spatialPassUniforms})}potentialPassMaterial(){let e="\n\t\t\tprecision highp float;\n\t\t\tout vec4 pc_FragColor;\n\n\t\t\t".concat(m4.shapeInput(),"\n\t\t\tuniform sampler2D spatialPassTexture;\n\n\t\t\tconst float res = float(RES);\n\t\t\tconst float VOXEL_RESOLUTION = pow(2., res);\n\t\t\tconst float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));\n\t\t\tconst float VOXEL_RESOLUTION_SUB1 = VOXEL_RESOLUTION - 1.;\n\t\t\tconst float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;\n\n\t\t\tuniform float npart;\n\t\t\tuniform float spatialn;\n\t\t\tconst float spatialDivisions = ").concat(this.spatialDivisions,".;\n\t\t\tconst float spatialDivisions2 = spatialDivisions * spatialDivisions;\n\t\t\tconst float spatialDivisionsSub1 = spatialDivisions - 1.;\n\n\t\t\t").concat(m4.getpart,"\n\n\t\t\tvec3 packRGBAToVec3(vec4 color) {\n\t\t\t\tuint r = uint(color.r * 255.);\n\t\t\t\tuint g = uint(color.g * 255.);\n\t\t\t\tuint combined = (r << 8) | g; \n\t\t\t\treturn vec3(float(combined) * 0.00001525902, color.b, color.a); // 1/65535\n\t\t\t}\n\n\t\t\tvoid applyQuaternionToVector(in vec4 q, inout vec3 v) {\n\t\t\t\tv += 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * SDF functions (reference: https://iquilezles.org/articles/distfunctions/)\n\t\t\t */\n\n\t\t\t// branchless version of \"Smooth Union, Subtraction and Intersection - bound, bound, bound\" in above reference\n\t\t\tfloat smoothOperation(float op, float sdf, float d, float k) {\n\t\t\t  //        union: op =  1 => signSubtract =  1, signIntersection =  1\n\t\t\t  //     subtract: op = -1 => signSubtract = -1, signIntersection =  1\n\t\t\t\t// intersection: op = -2 => signSubtract = -1, signIntersection = -1\n\n\t\t\t\tfloat signSubtract = clamp(op, -1., 1.);\n\t\t\t\tfloat signIntersection = 2. * (op - signSubtract) + 1.;\n\t\t\t\tfloat h = clamp(\n\t\t\t\t\t0.5 + signSubtract * 0.5 * (sdf - signSubtract * signIntersection * d) / k,\n\t\t\t\t\t0.0,\n\t\t\t\t\t1.0\n\t\t\t\t);\n\t\t\t\treturn mix(sdf, signSubtract * signIntersection * d, h) - \n\t\t\t\t\t\t\t signSubtract * k * h * (1.0 - h);\n\t\t\t}\n\n\t\t\tfloat sdSphere( vec3 p, float s )\n\t\t\t{\n\t\t\t\treturn length(p)-s;\n\t\t\t}\n\n\t\t\tfloat sdEllipsoid( vec3 p, vec3 r )\n\t\t\t{\n\t\t\t\tfloat k0 = length(p/r);\n\t\t\t\tfloat k1 = length(p/(r*r));\n\t\t\t\treturn k0*(k0-1.0)/k1;\n\t\t\t}\n\n\t\t\tfloat sdBox( vec3 p, vec3 b )\n\t\t\t{\n\t\t\t\tvec3 q = abs(p) - b;\n\t\t\t\treturn length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0);\n\t\t\t}\n\n\t\t\tfloat sdTorus( vec3 p, vec2 t )\n\t\t\t{\n\t\t\t\tvec2 q = vec2(length(p.xy)-t.x,p.z);\n\t\t\t\treturn length(q)-t.y;\n\t\t\t}\n\n\t\t\tfloat sdCappedTorus( vec3 p, vec2 sc, float ra, float rb)\n\t\t\t{\n\t\t\t\tp.x = abs(p.x);\n\t\t\t\tfloat k = (sc.y*p.x>sc.x*p.y) ? dot(p.xy,sc) : length(p.xy);\n\t\t\t\treturn sqrt( dot(p,p) + ra*ra - 2.0*ra*k ) - rb;\n\t\t\t}\n\n\t\t\tfloat dot2( in vec2 v ) { return dot(v,v); }\n\t\t\tfloat sdCappedCone( vec3 p, float h, float r1, float r2 )\n\t\t\t{\n\t\t\t\tvec2 q = vec2( length(p.xz), p.y );\n\t\t\t\tvec2 k1 = vec2(r2,h);\n\t\t\t\tvec2 k2 = vec2(r2-r1,2.0*h);\n\t\t\t\tvec2 ca = vec2(q.x-min(q.x,(q.y<0.0)?r1:r2), abs(q.y)-h);\n\t\t\t\tvec2 cb = q - k1 + k2*clamp( dot(k1-q,k2)/dot2(k2), 0.0, 1.0 );\n\t\t\t\tfloat s = (cb.x<0.0 && ca.y<0.0) ? -1.0 : 1.0;\n\t\t\t\treturn s*sqrt( min(dot2(ca),dot2(cb)) );\n\t\t\t}\n\n\t\t\tfloat sdCappedCylinder( vec3 p, float h, float r )\n\t\t\t{\n\t\t\t\tvec2 d = abs(vec2(length(p.xz),p.y)) - vec2(r,h);\n\t\t\t\treturn min(max(d.x,d.y),0.0) + length(max(d,0.0));\n\t\t\t}\n\n\t\t\tfloat maxBlend = 0.0;\n\t\t\t// compute potential from A (=24) spheres, using the bit flags in 'activeKey'\n\t\t\t// to avoid lookup/compute for inactive spheres\n\t\t\t// return field potential, side effect updates track,\n\t\t\t// compute and return +ve and -ve values separately\n\t\t\tvoid fillSpatialInner(\n\t\t\t\tfloat ii,\n\t\t\t\tfloat activeKey,\n\t\t\t\tvec3 corner,\n\t\t\t\tinout float sdf,\n\t\t\t\tinout float colorDivisor,\n\t\t\t\tinout vec4 trackColor\n\t\t\t) {\n\t\t\t\tfor (float i = 0.; i < ").concat(p4,".; i++) {\n\t\t\t\t\tif (activeKey < 1.) break; // activeKey exhausted, no more active spheres\n\t\t\t\t\tactiveKey *= 0.5;\n\t\t\t\t\tif (fract(activeKey) < 0.5) continue;\n\n\t\t\t\t\tfloat iin = (i + ii + 0.5) * ").concat(1/f4,";\n\t\t\t\t\tvec4 shape = shapePos(iin);\n\t\t\t\t\tvec4 quat = shapeQuat(iin);\n\t\t\t\t\tvec4 params1 = shapeParams1(iin);\n\t\t\t\t\tvec4 params2 = shapeParams2(iin);\n\n\t\t\t\t\tvec3 p = corner - shape.xyz;\n\t\t\t\t\tapplyQuaternionToVector(quat, p);\n\t\t\t\t\tp /= params2.z; // scale\n\t\t\t\t\tfloat d; // d in -1..1 coordinates\n\t\t\t\t\tswitch (int(params1.x)) {\n\t\t\t\t\t\tcase 0: d = sdSphere(p, params1.y); break;\n\t\t\t\t\t\tcase 1: d = sdEllipsoid(p, params1.yzw); break;\n\t\t\t\t\t\tcase 2: d = sdBox(p, params1.yzw); break;\n\t\t\t\t\t\tcase 3: d = sdCappedCylinder(p, params1.y, params1.z); break;\n\t\t\t\t\t\tcase 4: d = sdCappedCone(p, params1.y, params1.z, params1.w); break;\n\t\t\t\t\t\tcase 5: d = sdTorus(p, params1.yz); break;\n\t\t\t\t\t\tcase 6: d = sdCappedTorus(p, params1.yz, params1.w, params2.w); break;\n\t\t\t\t\t}\n\t\t\t\t\td -= params2.y; // rounded edge\n\t\t\t\t\td *= params2.z; // scale\n\n\t\t\t\t\tfloat k = params2.x;\n\t\t\t\t\tfloat op = shape.w;\n\n\t\t\t\t\tsdf = smoothOperation(shape.w, sdf, d, k);\n\n\t\t\t\t\tfloat isNegativeOne = step(-1.5, op) * step(op, -0.5); // 1 when op == -1, 0 otherwise\n\t\t\t\t\tfloat colorCull = smoothstep(maxBlend, 0., -d);\n\t\t\t\t\tfloat cullFactor = mix(1.0, colorCull, isNegativeOne);\n\t\t\t\t\ttrackColor *= cullFactor;\n\t\t\t\t\tcolorDivisor *= cullFactor;\n\n\t\t\t\t\tmaxBlend = max(maxBlend, k);\n\n\t\t\t\t\tk += 2. * INV_VOXEL_RESOLUTION; // avoid division by zero, and other color artifacts with very small k\n\t\t\t\t\tfloat nearness = smoothstep(k, 0., d);\n\n\t\t\t\t\tvec4 color = shapeColor(iin);\n\t\t\t\t\tnearness *= float(color.a >= 0.);\n\n\t\t\t\t\tcolorDivisor += nearness;\n\t\t\t\t\ttrackColor += color * nearness;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvec3 div;\n\t\t\t// compute potential from all spheres; collect +ve and =ve values separately\n\t\t\t// work in blocks of A*4 (=96) spheres, using the bit flags in 4 float channel 'activeKey' values\n\t\t\t// TODO check if extra vec3 output useful, not really used at present\n\t\t\tfloat fillSpatial(vec3 corner, inout vec4 trackColor) {\n\t\t\t\tfloat sdf = 1e3; // hack: initialize to large value\n\t\t\t\tfloat colorDivisor = 0.;\n\t\t\t\t// spatialPassTexture holds x=> lowi, x faster moving and y=> z, y faster moving\n\t\t\t\tfloat divyz = (div.y + div.z * spatialDivisions + 0.5) / (spatialDivisions2);\n\t\t\t\tfor (float ii = 0.; ii < spatialn; ii++) {\n\t\t\t\t\tfloat i = ii * ").concat(96,".;\n\n\t\t\t\t\tvec4 activeKey = texture(spatialPassTexture, vec2((div.x * spatialn + ii + 0.5)/(spatialn * spatialDivisions), divyz));\n\t\t\t\t\tfillSpatialInner(i, activeKey.x, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t\tfillSpatialInner(i+").concat(p4,"., activeKey.y, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t\tfillSpatialInner(i+").concat(48,"., activeKey.z, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t\tfillSpatialInner(i+").concat(72,"., activeKey.w, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t}\n\n\t\t\t\ttrackColor /= colorDivisor;\n\t\t\t\treturn mix(sdf, 0.0, step(1e20 - 0.1, sdf));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\t").concat(m4.getxyzi,"    // get xi yi zi from 2d position\n\n\t\t\t\tvec3 xyzi = vec3(xi,yi,zi);\n\t\t\t\tvec3 corner = xyzi / VOXEL_RESOLUTION_SUB1 * 2. - 1.;  // -1..1 coords\n\n\t\t\t\tdiv = floor(xyzi / VOXEL_RESOLUTION_SUB1 * spatialDivisionsSub1);\n\n\t\t\t\tvec4 c = vec4(0.);\n\t\t\t\tfloat t = fillSpatial(corner, c);\n\n\t\t\t\tpc_FragColor = vec4(t, packRGBAToVec3(c)); // RGB texture\n\t\t\t}\n\t\t");return new u4({name:"PotentialPass",fragmentShader:e,uniforms:this.potentialPassUniforms})}voxelPassMaterial(){let e="\n\t\t\tprecision highp float;\n\t\t\tlayout(location = 0) out vec4 pc_FragColor;\n\t\t\tlayout(location = 1) out vec4 numTris;\n\n\t\t\tconst float res = float(RES);\n\t\t\tconst float VOXEL_RESOLUTION = pow(2., res);\n\t\t\tconst float VOXEL_RESOLUTION_SUB1 = VOXEL_RESOLUTION - 1.; \n\t\t\tconst float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));\n\t\t\tconst float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;\n\t\t\tuniform sampler2D numTrisTable; // 256 x 1\n\n\t\t\tfloat keyi(float f000, float f100, float f010, float f110, float f001, float f101, float f011, float f111) {\n\t\t\t\treturn (float(f000 < 0.) * 1.) +\n\t\t\t\t\t\t\t (float(f100 < 0.) * 2.) +\n\t\t\t\t\t\t\t (float(f010 < 0.) * 8.) +\n\t\t\t\t\t\t\t (float(f110 < 0.) * 4.) +\n\t\t\t\t\t\t\t (float(f001 < 0.) * 16.) +\n\t\t\t\t\t\t\t (float(f101 < 0.) * 32.) +\n\t\t\t\t\t\t\t (float(f011 < 0.) * 128.) +\n\t\t\t\t\t\t\t (float(f111 < 0.) * 64.);\n\t\t\t}\n\n\t\t\t".concat(m4.lookup,"\n\n\t\t\tvec3 compNormi(float xi, float yi, float zi) {\n\t\t\t\tfloat dx = look(xi + 1., yi, zi, potentialPassTexture).r - look(xi - 1., yi, zi, potentialPassTexture).r;\n\t\t\t\tfloat dy = look(xi, yi + 1., zi, potentialPassTexture).r - look(xi, yi - 1., zi, potentialPassTexture).r;\n\t\t\t\tfloat dz = look(xi, yi, zi + 1., potentialPassTexture).r - look(xi, yi, zi - 1., potentialPassTexture).r;\n\t\t\t\t// if we allow (common) 0,0,0 case through then NaN can spread\n\t\t\t\t// eg r = vec4(compNorm i(???), 1.) will pollute r.w\n\t\t\t\tif (dx == 0.0 && dy == 0.0 && dz == 0.0) {\n\t\t\t\t\treturn vec3(0.199, 0.299, 0.399);\n\t\t\t\t}\n\t\t\t\treturn normalize(vec3(dx, dy, dz));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\t").concat(m4.getxyzi,"    // get xi yi zi from 2d\n\n\t\t\t\tvec3 normal = compNormi(xi, yi, zi);  // even if our key is -1 this may be needed by a neighbouring voxel\n\n\t\t\t\tif (xi >= VOXEL_RESOLUTION_SUB1 || yi >= VOXEL_RESOLUTION_SUB1 || zi >= VOXEL_RESOLUTION_SUB1) {\n\t\t\t\t\tpc_FragColor = vec4(normal, 0.);\n\t\t\t\t\tnumTris = vec4(0.);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfloat\n\t\t\t\t\tf000 = look(xi, yi, zi, potentialPassTexture).r,\n\t\t\t\t\tf100 = look(xi+1., yi, zi, potentialPassTexture).r,\n\t\t\t\t\tf010 = look(xi, yi+1., zi, potentialPassTexture).r,\n\t\t\t\t\tf110 = look(xi+1., yi+1., zi, potentialPassTexture).r,\n\t\t\t\t\tf001 = look(xi, yi, zi+1., potentialPassTexture).r,\n\t\t\t\t\tf101 = look(xi+1., yi, zi+1., potentialPassTexture).r,\n\t\t\t\t\tf011 = look(xi, yi+1., zi+1., potentialPassTexture).r,\n\t\t\t\t\tf111 = look(xi+1., yi+1., zi+1., potentialPassTexture).r;\n\t\t\t\tfloat key = keyi(f000, f100, f010, f110, f001, f101, f011, f111);\n\n\t\t\t\tpc_FragColor = vec4(normal, key);\n\n\t\t\t\tnumTris = texture(numTrisTable, vec2((key + 0.5) / 256., 0.5));\n\t\t\t}\n\t\t");return new u4({name:"VoxelPass",fragmentShader:e,uniforms:this.voxelPassUniforms})}patchVertexShaderForShapeBlend(e){let t="\n\t\t#ifdef SHAPEBLEND \n\t\t\tprecision highp sampler2D;\n\n\t\t\tuniform float isol;\n\n\t\t\tuniform sampler2D triTable;     // 256 x 16\n\t\t\tuniform sampler2D pyramidTexture1;\n\t\t\tuniform vec2 pyramidTexture1Size;\n\t\t\tuniform sampler2D pyramidTexture2;\n\t\t\tuniform vec2 pyramidTexture2Size;\n\n\t\t\tconst vec2 halfPixelOffset = vec2(0.5, 0.5);\n\n\t\t\tconst vec2 rShift = vec2(0., 1.);\n\t\t\tconst vec2 gShift = vec2(1., 1.);\n\t\t\tconst vec2 bShift = vec2(1., 0.);\n\n\t\t\tconst float res = float(RES);\n\t\t\tconst float VOXEL_RESOLUTION = pow(2., res);\n\t\t\tconst float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));\n\t\t\tconst float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;\n\n\t\t\tconst float scale_factor = ".concat(2,".;\n\n\t\t\t#if SHAPEBLEND == 5\n\t\t\t\tconst float levelShiftX[7] = float[7](4., 6., 12., 24., 48., 96., 192.);\n\t\t\t\tconst float scale = 8. * scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(16.);\n\t\t\t#elif SHAPEBLEND == 7\n\t\t\t\tconst float levelShiftX[10] = float[10](4., 6., 12., 24., 48., 96., 192., 384., 768., 1536.); \n\t\t\t\tconst float scale = 2. * scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(64.);\n\t\t\t#elif SHAPEBLEND == 8\n\t\t\t\tconst float levelShiftX[11] = float[11](4., 8., 16., 32., 64., 128., 256., 512., 1024., 2048., 4096.);\n\t\t\t\tconst float scale = scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(128.);\n\t\t\t#else\n\t\t\t\tconst float levelShiftX[8] = float[8](4., 8., 16., 32., 64., 128., 256., 512.);\n\t\t\t\tconst float scale = 4. * scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(32.);\n\t\t\t#endif\n\n\t\t\t").concat(m4.lookup,"\n\n\t\t\tconst vec3 offsets[24] = vec3[](\n\t\t\t\tvec3(0., 0., 0.), vec3(1., 0., 0.),\n\t\t\t\tvec3(1., 0., 0.), vec3(1., 1., 0.),\n\t\t\t\tvec3(0., 1., 0.), vec3(1., 1., 0.),\n\t\t\t\tvec3(0., 0., 0.), vec3(0., 1., 0.),\n\t\t\t\tvec3(0., 0., 1.), vec3(1., 0., 1.),\n\t\t\t\tvec3(1., 0., 1.), vec3(1., 1., 1.),\n\t\t\t\tvec3(0., 1., 1.), vec3(1., 1., 1.),\n\t\t\t\tvec3(0., 0., 1.), vec3(0., 1., 1.),\n\t\t\t\tvec3(0., 0., 0.), vec3(0., 0., 1.),\n\t\t\t\tvec3(1., 0., 0.), vec3(1., 0., 1.),\n\t\t\t\tvec3(1., 1., 0.), vec3(1., 1., 1.),\n\t\t\t\tvec3(0., 1., 0.), vec3(0., 1., 1.)\n\t\t\t);\n\n\t\t\tvec2 computeShiftedPosition1(vec2 xy, float levelOriginX) {\n\t\t\t\tvec2 xyShifted = xy;\n\t\t\t\txyShifted.x += levelOriginX;\n\t\t\t\treturn (xyShifted + halfPixelOffset) / pyramidTexture1Size;\n\t\t\t}\n\n\t\t\tvec2 computeShiftedPosition2(vec2 xy, float levelOriginX) {\n\t\t\t\tvec2 xyShifted = xy;\n\t\t\t\txyShifted.x += levelOriginX;\n\t\t\t\treturn (xyShifted + halfPixelOffset) / pyramidTexture2Size;\n\t\t\t}\n\n\t\t\tvec4 unpackVec3ToRGBA(vec3 vec) {\n\t\t\t\tuint combined = uint(vec.x * 65535.0 + 0.5); // Add 0.5 for rounding\n\t\t\t\tfloat g = float(combined & uint(0xFF)) * 0.00392156862; // 1/255\n\t\t\t\tfloat r = float((combined >> 8) & uint(0xFF)) * 0.00392156862; \n\t\t\n\t\t\t\treturn vec4(r, g, vec.y, vec.z);\n\t\t\t}\n\n\t\t\tout vec4 marchColor;\n\t\t\t// end of marchvertPre\n\t\t#endif\n\t\t");e.vertexShader=t+e.vertexShader.replace("#include <project_vertex>","\n\t\t#ifdef SHAPEBLEND\n\t\t\tfloat triIndex = floor(float(gl_VertexID/3));\n\t\t\tfloat vertexIndex = float(gl_VertexID);\n\t\t\t\n\t\t\t// Initial pyramid lookup\n\t\t\tfloat levelOriginX1 = pyramidTexture1Size.x - 2.;\n\t\t\tfloat levelOriginX2 = pyramidTexture2Size.x - 1.;\n\t\t\tvec2 xy = vec2(0.);\n\t\t\tvec4 lookUp = texture(pyramidTexture2, computeShiftedPosition2(xy, levelOriginX2));\n\t\t\t\n\t\t\t// Early exit check\n\t\t\tif (triIndex >= lookUp.r) return;\n\t\t\t\n\t\t\t// Optimize loop variables\n\t\t\tfloat start = 0.;\n\t\t\tvec4 triIndexVec = vec4(triIndex);\n\t\t\t\n\t\t\t// Main position computation loop\n\t\t\tfor (int i = 0; i < LOOP;) {\n\t\t\t\t// Compute boundaries\n\t\t\t\tvec4 ends = lookUp + vec4(start);\n\t\t\t\tvec4 starts = vec4(ends.gba, start);\n\t\t\t\tvec4 check = vec4(greaterThanEqual(triIndexVec, starts)) * \n\t\t\t\t\t\t\t\t\t\t\tvec4(lessThan(triIndexVec, ends));\n\t\t\t\t\n\t\t\t\t// Update position\n\t\t\t\txy *= 2.;\n\t\t\t\txy += check.r * rShift + check.g * gShift + check.b * bShift;\n\t\t\t\t\n\t\t\t\t// Update loop variables\n\t\t\t\tstart = dot(check, starts);\n\t\t\t\tlevelOriginX2 -= levelShiftX[i];\n\t\t\t\t\n\t\t\t\t// Update lookup\n\t\t\t\tlookUp = texture(pyramidTexture1, computeShiftedPosition1(xy, levelOriginX1));\n\t\t\t\ti++;\n\n\t\t\t\tends = lookUp + vec4(start);\n\t\t\t\tstarts = vec4(ends.gba, start);\n\t\t\t\tcheck = vec4(greaterThanEqual(triIndexVec, starts)) * \n\t\t\t\t\t\t\t\t\t\t\tvec4(lessThan(triIndexVec, ends));\n\t\t\t\t\n\t\t\t\t// Update position\n\t\t\t\txy *= 2.;\n\t\t\t\txy += check.r * rShift + check.g * gShift + check.b * bShift;\n\t\t\t\t\n\t\t\t\t// Update loop variables\n\t\t\t\tstart = dot(check, starts);\n\t\t\t\tlevelOriginX1 -= levelShiftX[i];\n\t\t\t\t\n\t\t\t\t// Update lookup\n\t\t\t\tlookUp = texture(pyramidTexture2, computeShiftedPosition2(xy, levelOriginX2));\n\n\t\t\t\ti++;\n\t\t\t}\n\n\t\t\t#if HALF == 1\n\t\t\t\tvec4 ends = lookUp + vec4(start);\n\t\t\t\tvec4 starts = vec4(ends.gba, start);\n\t\t\t\tvec4 check = vec4(greaterThanEqual(triIndexVec, starts)) * vec4(lessThan(triIndexVec, ends));\n\t\t\t\n\t\t\t\t// Update position\n\t\t\t\txy *= 2.;\n\t\t\t\txy += check.r * rShift + check.g * gShift + check.b * bShift;\n\t\t\t\n\t\t\t\t// Update loop variables\n\t\t\t\tstart = dot(check, starts);\n\t\t\t#endif\n\t\t\t\n\t\t\t// Compute final coordinates\n\t\t\tvec3 gridPos;\n\t\t\tgridPos.x = mod(xy.x, VOXEL_RESOLUTION);\n\t\t\tgridPos.y = mod(xy.y, VOXEL_RESOLUTION);\n\t\t\tgridPos.z = floor(xy.x * INV_VOXEL_RESOLUTION) + \n\t\t\t\t\t\t\t\t\tfloor(xy.y * INV_VOXEL_RESOLUTION) * Z_LAYERS_PER_ROW;\n\t\t\t\n\t\t\t// Vertex key computation\n\t\t\tvertexIndex -= start * 3.;\n\t\t\tfloat vk = vertexIndex * 0.0625 + 0.03125; // Optimized division by 16 and addition of 1/32\n\t\t\t\n\t\t\t// Voxel lookup and edge computation\n\t\t\tvec4 voxel = look(gridPos.x, gridPos.y, gridPos.z, voxelPassTexture);\n\t\t\tfloat key = (voxel.w + 0.5) * 0.00390625; // Optimized division by 256\n\t\t\t\n\t\t\t// Edge lookup and offset computation\n\t\t\tfloat edgeNum = texture(triTable, vec2(vk, key)).x;\n\t\t\tint edgeIndex = int(edgeNum) * 2;\n\t\t\t\n\t\t\t// Compute edge positions\n\t\t\tvec3 p1 = gridPos + offsets[edgeIndex];\n\t\t\tvec3 p2 = gridPos + offsets[edgeIndex + 1];\n\t\t\t\n\t\t\t// Compute potentials and normals\n\t\t\tvec4 potential1 = look(p1.x, p1.y, p1.z, potentialPassTexture);\n\t\t\tvec4 potential2 = look(p2.x, p2.y, p2.z, potentialPassTexture);\n\t\t\t\n\t\t\t// Final position and normal computation\n\t\t\tfloat mu = potential1.r / (potential1.r - potential2.r);\n\n\t\t\tmarchColor = mix(\n\t\t\t\tunpackVec3ToRGBA(potential1.gba),\n\t\t\t\tunpackVec3ToRGBA(potential2.gba),\n\t\t\t\tmu\n\t\t\t);\n\n\t\t\ttransformed = p1 + (p2 - p1) * mu;\n\t\t\ttransformed -= originOffset;\n\t\t\ttransformed *= scale;\n\t\t\tvec4 data1 = look(p1.x, p1.y, p1.z, voxelPassTexture);\n\t\t\tvec4 data2 = look(p2.x, p2.y, p2.z, voxelPassTexture);\n\t\t\tobjectNormal = normalize(mix(data1.xyz, data2.xyz, mu));\n\t\t\ttransformedNormal = normalMatrix * objectNormal;\n\t\t\t#ifndef FLAT_SHADED\n\t\t\t\tvNormal = transformedNormal;\n\t\t\t#endif\n\t\t#endif\n\t\t\n#include <project_vertex>");let i=e.fragmentShader.match(/vec3 diffuseColor[^\n]*\n/);if(!i)return;let n="\n\t\t#ifdef SHAPEBLEND_C\n\t\t\t#if SHAPEBLEND_C == 1\n\t\t\t\t".concat(i[0].replace(/nodeU0,/g,"marchColor.rgb,").replace(/nodeU\d+(?=,g_uid\d+_calpha\))/g,"marchColor.a"),"\n\t\t\t#else\n\t\t\t\t").concat(i[0],"\n\t\t\t#endif\n\t\t#else\n\t\t\t").concat(i[0],"\n\t\t#endif\n\t\t");e.fragmentShader="in vec4 marchColor;\n"+e.fragmentShader.replace(i[0],n),Object.assign(e.uniforms,this.marchPassUniforms)}initDebugPass(e){console.log("fboToDebug.width",e.width,e.height),this.geometry=new eA(e.width,e.height),this.geometry.userData={parameters:{width:4,height:4}};let t={inputTexture:{value:Array.isArray(e.texture)?e.texture[1]:e.texture},pyramidTextureSize:{value:void 0}},i=e=>{e.vertexShader="\n\t\t\t\tprecision highp float;\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\t\tvUv = uv;\n\t\t\t\t}\n\t\t\t",e.fragmentShader="\n\t\t\t\tlayout(location = 1) out vec4 gVelocity;\n\n\t\t\t\tprecision highp float;\n\t\t\t\t\n\t\t\t\tuniform sampler2D inputTexture;\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\tuniform vec2 pyramidTextureSize;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\t\t// Sample the input texture using UV coordinates\n\t\t\t\t\t\tgl_FragColor = texture(inputTexture, vUv);\n\t\t\t\t\t\tgVelocity = vec4(0.0);\n\t\t\t\t}\n\t\t\t",t.pyramidTextureSize.value=new p_(this.pyramidRenderTarget.width,this.pyramidRenderTarget.height),Object.assign(e.uniforms,t)};this.material.shapeBlendhack=i,this.material.root.shapeBlendhack=i}},v4=g4;v4.streamCompaction=new class{constructor(){this.pyramidPassScene=new OT,this.pyramidPassMaterial=new u4({name:"PyramidPass"}),this.pyramidPassUniforms={inputTexture:{value:void 0},inputWidth:{value:0},inputHeight:{value:0},inputShiftX:{value:0},outputShiftX:{value:0}},this.pyramidTopLevelReadPixelBuffer=new Float32Array(4);this.pyramidPassMaterial.fragmentShader="\n\t\t\tprecision highp float;\n\t\t\tprecision highp sampler2D;\n\t\t\tlayout(location = 0) out vec4 pc_FragColor;\n\t\t\tuniform sampler2D inputTexture;\n\t\t\tuniform float inputWidth;\n\t\t\tuniform float inputHeight;\n\t\t\tuniform float inputShiftX;\n\t\t\tuniform float outputShiftX;\n\t\t\tconst vec2 half_unit_coord = vec2(0.5);\n\t\t\tconst vec4 one = vec4(1.0);\n\t\t\tvoid main() {\n\t\t\t\tvec2 inputSize = vec2(inputWidth, inputHeight);\n\t\t\t\tvec2 input_pixel_uv = 1. / inputSize;\n\t\t\t\tvec2 coord = gl_FragCoord.xy - half_unit_coord;\n\t\t\t\tcoord.x -= outputShiftX;\n\t\t\t\tcoord = coord * 2. + half_unit_coord;\n\t\t\t\tcoord.x += inputShiftX;\n\n\t\t\t\t// sample bottom left corner\n\t\t\t\tvec2 input_uv = coord / inputSize;\n\t\t\t\tfloat bl = texture(inputTexture, input_uv).r;\n\n\t\t\t\t// sample bottom right corner\n\t\t\t\tinput_uv.x += input_pixel_uv.x;\n\t\t\t\tfloat br = texture(inputTexture, input_uv).r;\n\n\t\t\t\t// sample top right corner\n\t\t\t\tinput_uv.y += input_pixel_uv.y;\n\t\t\t\tfloat tr = texture(inputTexture, input_uv).r;\n\n\t\t\t\t// sample top left corner\n\t\t\t\tinput_uv.x -= input_pixel_uv.x;\n\t\t\t\tfloat tl = texture(inputTexture, input_uv).r;\n\n\t\t\t\tpc_FragColor.a = bl;\n\t\t\t\tpc_FragColor.b = pc_FragColor.a + br;\n\t\t\t\tpc_FragColor.g = pc_FragColor.b + tr;\n\t\t\t\tpc_FragColor.r = pc_FragColor.g + tl; \n\t\t\t}\n\t\t",this.pyramidPassMaterial.uniforms=this.pyramidPassUniforms,this.pyramidPassMaterial.depthTest=!1,this.pyramidPassMaterial.depthWrite=!1;let e=new OE(d4,this.pyramidPassMaterial);e.frustumCulled=!1,this.pyramidPassScene.add(e)}renderPyramid(e,t,i,n,r){(new CO).min.setScalar(0);let a=t.length-1,o=new B_;i.getViewport(o),this.pyramidPassUniforms.inputShiftX.value=0,this.pyramidPassUniforms.outputShiftX.value=0;let s=a-1;for(let c=s;c>=0;c--){let a=c%2===s%2?r[0]:r[1],o=c===s?n:c%2===s%2?r[1]:r[0];this.pyramidPassUniforms.inputTexture.value=Array.isArray(o.texture)?o.texture[1]:o.texture,this.pyramidPassUniforms.inputWidth.value=o.width,this.pyramidPassUniforms.inputHeight.value=o.height,i.setRenderTarget(a);let l=t[c],d=i.getPixelRatio();i.setViewport(this.pyramidPassUniforms.outputShiftX.value/d,0,l/d,l/d),2===c&&e%2!==0&&i.setViewport(this.pyramidPassUniforms.outputShiftX.value/d,0,3/d,3/d),i.render(this.pyramidPassScene,h4);let u=this.pyramidPassUniforms.inputShiftX.value;this.pyramidPassUniforms.inputShiftX.value=this.pyramidPassUniforms.outputShiftX.value,this.pyramidPassUniforms.outputShiftX.value=u,c<s&&(this.pyramidPassUniforms.outputShiftX.value+=t[c+1])}i.setViewport(o);let l=t.length%2===0?0:1;return i.readRenderTargetPixelsAsync(r[l],r[l].width-1,0,1,1,this.pyramidTopLevelReadPixelBuffer).then(()=>this.pyramidTopLevelReadPixelBuffer[0])}};var y4=new yC,b4=new yC,x4=new V_,w4=new j_,S4=new j_,_4=new V_;function C4(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.children.length;for(;i--;){let n=this.children[i];SG.is(n)&&E4.call(n,e,t+1)}}function E4(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t)){let i=this.children.length;for(;i--;){let n=this.children[i];SG.is(n)&&E4.call(n,e,t+1)}}}function A4(){if(void 0===this.shapesDataTexture.value){let e=new LT(new Float32Array(1920),f4,5,ES,SS);this.shapesDataTexture.value=e}let e=this.shapesDataTexture.value,t=e.image.data;e.needsUpdate=!0;let i=0,n=this.data.geometry.blendRange,r=y4.copy(this.matrixWorld).invert(),a=0;C4.call(this,e=>{var o;if(!1===e.visible)return!0;let s;if(e instanceof X$)return;if(e instanceof T0||e instanceof s4)return;s=e instanceof IG?e.object:e;let l=null===(o=e.data)||void 0===o?void 0:o.cloner;if(PG.is(e)&&l&&!l.hideBase&&"radial"!==l.type&&!0!==l.disabled||!(s instanceof r$))return;let c=s.geometry.userData.parameters,d=c.shapeBlendNode;if(void 0===d)return;if(b4.multiplyMatrices(r,e.matrixWorld).decompose(S4,x4,w4),"TorusGeometry"===c.type&&360!==c.arc){let e=c.arc*Math.PI/180;e/=4,x4.multiply(_4.set(0,0,Math.sin(e),Math.cos(e)))}let u=d.overrideGlobalBlend?d.blendRange:n;u=u/this.bboxSize*2,t[4*a]=(S4.x-this.bboxOffset)/this.bboxSize*2,t[4*a+1]=(S4.y-this.bboxOffset)/this.bboxSize*2,t[4*a+2]=(S4.z-this.bboxOffset)/this.bboxSize*2,t[4*a+3]=0===d.operation?1:2===d.operation?-1:-2,t[384+4*a]=-x4.x,t[384+4*a+1]=-x4.y,t[384+4*a+2]=-x4.z,t[384+4*a+3]=x4.w;let h=new Float32Array(4),p=0;if("SphereGeometry"===c.type)c.width===c.height&&c.width===c.depth?h[0]=0:h[0]=1,h[1]=c.width/this.bboxSize,h[2]=c.height/this.bboxSize,h[3]=c.depth/this.bboxSize,i=Math.max(i,h[1]*w4.x+u,h[2]*w4.x+u,h[3]*w4.x+u);else if("CubeGeometry"===c.type){p=c.cornerRadius;let e=c.width,t=c.height,n=c.depth;h[0]=2,h[1]=(e-2*p)/this.bboxSize,h[2]=(t-2*p)/this.bboxSize,h[3]=(n-2*p)/this.bboxSize,i=Math.max(i,Math.sqrt(e**2+t**2+n**2)/this.bboxSize*w4.x+u)}else if("CylinderGeometry"===c.type){p=c.cornerRadius;let e=c.height,t=c.radiusBottom,n=c.radiusTop;if(n>=t){let i=Math.atan2(n-t,e),r=(Math.PI/2-i)/2;n-=p/Math.tan(r),t-=p*Math.tan(r)}else if(t>n){let i=Math.atan2(t-n,e),r=(Math.PI/2-i)/2;n-=p*Math.tan(r),t-=p/Math.tan(r)}h[1]=(c.height-2*p)/this.bboxSize,t===n?(h[0]=3,h[2]=t/this.bboxSize*2):(h[0]=4,h[2]=t/this.bboxSize*2,h[3]=n/this.bboxSize*2),i=Math.max(i,4*h[1]*w4.x+u)}else if("TorusGeometry"===c.type){if(h[0]=5,h[1]=(c.width-c.depth)/this.bboxSize,h[2]=c.depth/this.bboxSize,360!==c.arc){h[0]=6,h[3]=h[1],t[1152+4*a+3]=h[2];let e=2*Math.atan2(h[2]/2,h[1]),i=c.arc*Math.PI/180/2-e;h[1]=Math.sin(i),h[2]=Math.cos(i)}i=Math.max(i,c.width*w4.x/this.bboxSize+u)}t.set(h,768+4*a),t[1152+4*a]=u,t[1152+4*a+1]=p/this.bboxSize*2,t[1152+4*a+2]=w4.x;let f=s.material,m=f.uniforms.nodeU0.node.value,g=f.uniforms.nodeU1.value;0!==d.operation&&!d.useColor&&(g=-1),t[1536+4*a]=m.r,t[1536+4*a+1]=m.g,t[1536+4*a+2]=m.b,t[1536+4*a+3]=g,g<1&&1===this.material.defines.SHAPEBLEND_C&&(this.material.transparent=!0),a++}),this.npart=a,this.spatialPassUniforms.span.value=1.4*i}function M4(e,t){let i=!1,n=512&e.layers.mask,r=t.getLayersOfType("transmission"),a=t.getLayersOfType("outline");return a.length>0&&(e.layers.set(8),r.length>0&&e.layers.enable(3),i=!0,o$(e),a$(e)),0===r.length&&0===a.length&&e.layers.set(0),n&&e.layers.set(9),e instanceof JJ&&e.needsAO&&e.layers.enable(5),i}function T4(e,t){if(!t.layers)return!1;let i=512&e.layers.mask,n=!1,r=t.getLayersOfType("transmission").filter(e=>e.data.visible),a=t.getLayersOfType("outline").filter(e=>e.data.visible);return r.length>0&&(e.layers.set(3),a.length>0&&e.layers.enable(8),n=!0),0===r.length&&0===a.length&&e.layers.set(0),i&&e.layers.set(9),e.needsAO&&e.layers.enable(5),n}var P4=new bO,D4=new yC,O4=new vC;function I4(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=e.cloner;if(r)for(let a of r.children){let r=D4.copy(a.matrixWorld).invert(),o=O4.copy(t.ray).applyMatrix4(r),s=e.matrixWorld;o.applyMatrix4(s);let l=P4;l.set(o.origin,o.direction),l.near=t.near,l.far=t.far;let d=l.intersectObject(e,!1);d.length>0&&i.push(c(c({},d[0]),{},{object:n?a:e}))}}var k4=class{constructor(){this._constraints=new Map}setConstraint(e,t){null===t?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach((i,n)=>{let r=[n,i],a=i;for(;this._constraints.has(a);){if(a=this._constraints.get(a),r.includes(a)){console.warn("circular dependency detected: ".concat(r.join(" -> ")));break}t.has(a)||r.push(a)}for(let o=r.length-2;o>=0;o--)if(!t.has(r[o])){let i=e.find(r[o]);i?i.applyPathSnapping(e):console.warn("missing entity ".concat(r[o])),t.add(r[o])}})}findDependency(e,t){let i=e;for(;this._constraints.has(i);)if(i=this._constraints.get(i),i===t)return!0;return!1}},R4=class{};function z4(e){let t,i,n,r,a,o,s,l,c,d,u,h,p,f,m,g;function v(e,t,o){let s=new Float32Array(d,a,3*i);n=0;let l=new Uint32Array(d,r,i);for(let i=0;i<o.length-1;i++){let r=t[i],a=e[i].elements,c=r.filter(e=>e.enabled&&"Include"===e.mode).map(e=>"Box"===e.type?b(e):w(e)),d=r.filter(e=>e.enabled&&"Exclude"===e.mode).map(e=>"Box"===e.type?b(e):w(e));for(let e=o[i];e<o[i+1];e++){let t=p[3*e],i=p[3*e+1],r=p[3*e+2];if((0===c.length||y(t,i,r,c))&&(0===d.length||!y(t,i,r,d))){let o=1/(a[3]*t+a[7]*i+a[11]*r+a[15]);s[3*n]=(a[0]*t+a[4]*i+a[8]*r+a[12])*o,s[3*n+1]=(a[1]*t+a[5]*i+a[9]*r+a[13])*o,s[3*n+2]=(a[2]*t+a[6]*i+a[10]*r+a[14])*o,l[n]=e,n++}}}}function y(e,t,i,n,r){return n["Intersect"===r?"every":"some"](n=>{let r=function(e,t,i,n,r){let a=e-r[0],o=t-r[1],s=i-r[2],l=1/(n[3]*a+n[7]*o+n[11]*s+n[15]);return{x:(n[0]*a+n[4]*o+n[8]*s+n[12])*l+r[0],y:(n[1]*a+n[5]*o+n[9]*s+n[13])*l+r[1],z:(n[2]*a+n[6]*o+n[10]*s+n[14])*l+r[2]}}(e,t,i,n.invRotationMatrix,n.cropCenter);return Array.isArray(n)?function(e,t,i,n){return e>=n[0]&&e<=n[3]&&t>=n[1]&&t<=n[4]&&i>=n[2]&&i<=n[5]}(r.x,r.y,r.z,n):function(e,t,i,n){let r=(e-n.cropCenter[0])*n.invRadiusX,a=(t-n.cropCenter[1])*n.invRadiusY,o=(i-n.cropCenter[2])*n.invRadiusZ;return r*r+a*a+o*o<=1}(r.x,r.y,r.z,n)})}function b(e){let t=e.cropSize[0]/2,i=e.cropSize[1]/2,n=e.cropSize[2]/2,r=[e.cropCenter[0]-t,e.cropCenter[1]-i,e.cropCenter[2]-n,e.cropCenter[0]+t,e.cropCenter[1]+i,e.cropCenter[2]+n],a=x(e.cropRotation);return Object.assign(r,{invRotationMatrix:a,cropCenter:e.cropCenter})}function x(e){let t=[],i=e[0]*Math.PI/180,n=e[1]*Math.PI/180,r=e[2]*Math.PI/180,a=Math.cos(i),o=Math.sin(i),s=Math.cos(n),l=Math.sin(n),c=Math.cos(r),d=Math.sin(r),u=a*c,h=a*d,p=o*c,f=o*d;return t[0]=s*c,t[1]=-s*d,t[2]=l,t[4]=h+p*l,t[5]=u-f*l,t[6]=-o*s,t[8]=f-u*l,t[9]=p+h*l,t[10]=a*s,t[12]=0,t[13]=0,t[14]=0,t[3]=0,t[7]=0,t[11]=0,t[15]=1,t}function w(e){let t=2/e.cropSize[0],i=2/e.cropSize[1],n=2/e.cropSize[2],r=x(e.cropRotation);return{invRadiusX:t,invRadiusY:i,invRadiusZ:n,cropCenter:e.cropCenter,invRotationMatrix:r}}e.onmessage=x=>{if(x.data.getCroppedIndexes){let t=new Uint32Array(function(e,t){let i=[],n=t.filter(e=>e.enabled&&"Include"===e.mode).map(e=>"Box"===e.type?b(e):w(e)),r=t.filter(e=>e.enabled&&"Exclude"===e.mode).map(e=>"Box"===e.type?b(e):w(e)),a=e.length;for(let o=0;o<a;o+=3){let t=e[o],a=e[o+1],s=e[o+2];(0===n.length||y(t,a,s,n))&&(0===r.length||!y(t,a,s,r))||i.push(o/3)}return i}(new Float32Array(x.data.positions),x.data.crops)).buffer;e.postMessage({outOfBoundsIndexes:t},[t])}else if(x.data.positions)u=x.data.positions,p=new Float32Array(u),m=x.data.meshMatrixWorlds,g=x.data.cropsArray,f=x.data.meshIndexIntervals,v(m,g,f),e.postMessage({sortSetupComplete:!0});else if(x.data.sort||x.data.newMatrixWorlds||x.data.newCropsArray)(x.data.newMatrixWorlds||x.data.newCropsArray)&&(g=x.data.newCropsArray||g,m=x.data.newMatrixWorlds||m,v(m,g,f)),function(u){let p,f=new Float64Array(d,o,16);for(let e=0;e<16;e++)f[e]=u[e];if(n>1){t.exports.sortIndexes(r,a,c,o,s,l,h.DepthMapRange,n);let e=new Uint32Array(n);p=e.buffer,e.set(new Uint32Array(d,l,n))}else if(1===n){let e=new Uint32Array(n);e[0]=new Uint32Array(d,r,i)[0],p=e.buffer}else p=new ArrayBuffer(0);e.postMessage({sortDone:!0,indexesBuffer:p},[p])}(x.data.sort.view,x.data.sort.cameraPosition);else if(x.data.init){h=x.data.init.Constants,i=x.data.init.splatCount;let n=h.BytesPerInt,u=3*h.BytesPerFloat,p=new Uint8Array(x.data.init.sorterWasmBytes),f=i*(n+u)+(i*h.BytesPerInt*2+h.DepthMapRange*h.BytesPerInt*2)+32*h.MemoryPageSize,m=Math.floor(f/h.MemoryPageSize)+1,g={module:{},env:{memory:new WebAssembly.Memory({initial:2*m,maximum:3*m,shared:!0})}};WebAssembly.compile(p).then(e=>WebAssembly.instantiate(e,g)).then(p=>{t=p,r=0,a=i*n,o=a+i*u,c=o+16*h.BytesPerFloat*2,s=c+i*h.BytesPerInt,l=s+h.DepthMapRange*h.BytesPerInt,d=g.env.memory.buffer,e.postMessage({sortSetupPhase1Complete:!0})})}}}Iw(R4,"DepthMapRange",65536),Iw(R4,"MemoryPageSize",65536),Iw(R4,"BytesPerFloat",4),Iw(R4,"BytesPerInt",4);var L4=function(){let e=new Float32Array(1),t=new Int32Array(e.buffer);return function(i){return e[0]=i,t[0]}}(),B4=function(e,t,i,n){return e+(t<<8)+(i<<16)+(n<<24)},N4=new p_;function F4(e){let t=!1;return e.scene.objects.traverse((e,i)=>{if(!1===i.visible)return!0;"Splat"===i.type&&(t=!0)}),t}var U4,V4,j4,W4=class extends OE{constructor(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0;super(i,n),this.splatCount=t,this.meshIndexIntervals=o,this.meshMatrixWorlds=s,this.splatBuffers=e,this.geometry=i,this.material=n,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=r,this.devicePixelRatio=a,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,o=W4.buildGeomtery(t),s=W4.buildMaterial(r);return new W4(e,t,o,s,i,n,r,a)}static buildMaterial(e){let t={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:e},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new p_},viewport:{type:"v2",value:new p_},basisViewport:{type:"v2",value:new p_},debugColor:{type:"v3",value:new D_},covariancesTextureSize:{type:"v2",value:new p_(1024,1024)},centersColorsTextureSize:{type:"v2",value:new p_(1024,1024)},orthoZoom:{type:"f",value:-1}};return new NE({uniforms:t,vertexShader:"\n            precision highp float;\n            #include <common>\n\n            attribute uint splatIndex;\n\n            uniform highp sampler2D covariancesTexture;\n            uniform highp usampler2D centersColorsTexture;\n            uniform vec2 focal;\n            uniform vec2 viewport;\n            uniform vec2 basisViewport;\n            uniform vec2 covariancesTextureSize;\n            uniform vec2 centersColorsTextureSize;\n\t\t\t\t\t\tuniform highp sampler2D meshMatrixWorldsTexture;\n\t\t\t\t\t\tuniform uint meshIndexIntervals[257];\n\t\t\t\t\t\tuniform float orthoZoom;\n\n            varying vec4 vColor;\n            varying vec2 vUv;\n\n            varying vec2 vPosition;\n\n            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);\n            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));\n            const uvec4 shift4 = uvec4(0, 8, 16, 24);\n            vec4 uintToRGBAVec (uint u) {\n               uvec4 urgba = mask4 & u;\n               urgba = urgba >> shift4;\n               vec4 rgba = vec4(urgba) * encodeNorm4;\n               return rgba;\n            }\n\n            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {\n                vec2 samplerUV = vec2(0.0, 0.0);\n                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;\n                samplerUV.y = float(floor(d)) / dimensions.y;\n                samplerUV.x = fract(d);\n                return samplerUV;\n            }\n\n            void main () {\n                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));\n                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));\n                vColor = uintToRGBAVec(sampledCenterColor.r);\n\n                vPosition = position.xy * 2.0;\n\n\t\t\t\t\t\t\t\tuint meshIndex;\n\t\t\t\t\t\t\t\tfor (int i = 1; i < 257; i++) {\n\t\t\t\t\t\t\t\t\tif (splatIndex < meshIndexIntervals[i]) {\n\t\t\t\t\t\t\t\t\t\tmeshIndex = uint(i - 1);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tfloat strideMulmeshIndex = float(4u*meshIndex);\n\t\t\t\t\t\t\t\tfloat meshMatrixWorldsTextureLength = float(256*4);\n\n\t\t\t\t\t\t\t\tmat4 modelMat = mat4(\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tmat4 modelViewMat = viewMatrix * modelMat;\n\t\t\t\t\t\t\t\tvec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); \n                vec4 clipCenter = projectionMatrix * viewCenter;\n\n                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;\n                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;\n                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;\n\n                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);\n                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);\n\n                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix\n                mat3 Vrk = mat3(\n                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,\n                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,\n                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z\n                );\n                float s = 1.0 / (viewCenter.z * viewCenter.z);\n\n                mat3 W = transpose(mat3(modelViewMat));\n                mat3 T = orthoZoom > 0.0 ? W : W * mat3(\n\t\t\t\t\t\t\t\t\tfocal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,\n\t\t\t\t\t\t\t\t\t0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,\n\t\t\t\t\t\t\t\t\t0., 0., 0.\n\t\t\t\t\t\t\t\t);\n                mat3 cov2Dm = transpose(T) * Vrk * T;\n                cov2Dm[0][0] += 0.3;\n                cov2Dm[1][1] += 0.3;\n\n                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because\n                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],\n                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't\n                // need cov2Dm[1][0] because it is a symetric matrix.\n                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);\n\n                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;\n\n                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix\n                // so that we can determine the 2D basis for the splat. This is done using the method described\n                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html\n                //\n                // This is a different approach than in the original work at INRIA. In that work they compute the\n                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle\n                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance\n                // matrix (called 'conic') to determine fragment opacity.\n                float a = cov2Dv.x;\n                float d = cov2Dv.z;\n                float b = cov2Dv.y;\n                float D = a * d - b * b;\n                float trace = a + d;\n                float traceOver2 = 0.5 * trace;\n                float term2 = sqrt(trace * trace / 4.0 - D);\n                float eigenValue1 = traceOver2 + term2;\n\t\t\t\t\t\t\t\tfloat eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value\n\n                const float maxSplatSize = 1024.0;\n                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));\n                // since the eigen vectors are orthogonal, we derive the second one from the first\n                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);\n                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);\n                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);\n\n                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;\n\n\t\t\t\t\t\t\t\tif (orthoZoom > 0.0) {\n\t\t\t\t\t\t\t\t\tndcOffset *= orthoZoom;\n\t\t\t\t\t\t\t\t}\n\n                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);\n            }",fragmentShader:"\n            precision highp float;\n            #include <common>\n\n            uniform vec3 debugColor;\n\n            varying vec4 vColor;\n            varying vec2 vUv;\n\n            varying vec2 vPosition;\n\t\t\t\t\t\tlayout(location = 1) out vec4 gVelocity; \n\n            void main () {\n                // compute the negative squared distance from the center of the splat to the\n                // current fragment in the splat's local space.\n                float A = -dot(vPosition, vPosition);\n                if (A < -4.0) discard;\n                vec3 color = vColor.rgb;\n                A = exp(A) * vColor.a;\n                gl_FragColor = vec4(color.rgb, A);\n\t\t\t\t\t\t\t\tgVelocity = vec4(0.0); // so it is ignored by TAA\n            }",transparent:!0,alphaTest:1,blending:1,depthTest:!0,depthWrite:!1,side:2})}static buildGeomtery(e){let t=new vE;t.setIndex([0,1,2,0,2,3]);let i=new Float32Array(12),n=new oE(i,3);t.setAttribute("position",n),n.setXYZ(0,-1,-1,0),n.setXYZ(1,-1,1,0),n.setXYZ(2,1,1,0),n.setXYZ(3,1,-1,0),n.needsUpdate=!0;let r=(new $D).copy(t),a=new Uint32Array(e),o=new UT(a,1,!1);return o.setUsage(35048),r.setAttribute("splatIndex",o),r.instanceCount=e,r}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach(e=>e.buildPreComputedBuffers()),this.covariances=new Float32Array(6*this.splatCount),this.colors=new Uint8Array(4*this.splatCount),this.centers=new Float32Array(3*this.splatCount);let e=0,t=0,i=0;for(let n of this.splatBuffers){let r=n.nsplats;this.colors.subarray(e,e+4*r).set(n.colorsA),e+=4*r,this.centers.subarray(t,t+3*r).set(n.decoded.xyz.denormDequant().data),t+=3*r,this.covariances.subarray(i,i+6*r).set(new Float32Array(n.precomputedCovarianceBufferData)),i+=6*r}}allocateAndStoreLocalSplatDataInTextures(){let e=this.splatCount,t=new p_(4096,1024);for(;t.x*t.y*2<6*e;)t.y*=2;let i,n,r=new p_(4096,1024);for(;r.x*r.y*4<4*e;)r.y*=2;if(this.halfPrecisionCovariancesOnGPU){n=new Uint16Array(t.x*t.y*2);for(let e=0;e<this.covariances.length;e++)n[e]=jO.toHalfFloat(this.covariances[e]);i=new LT(n,t.x,t.y,PS,_S)}else n=new Float32Array(t.x*t.y*2),n.set(this.covariances),i=new LT(n,t.x,t.y,PS,SS);i.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=i,this.material.uniforms.covariancesTextureSize.value.copy(t);let a=new Uint32Array(r.x*r.y*4);for(let c=0;c<e;c++){let e=4*c,t=3*c,i=4*c;a[i]=B4(this.colors[e],this.colors[e+1],this.colors[e+2],this.colors[e+3]),a[i+1]=L4(this.centers[t]),a[i+2]=L4(this.centers[t+1]),a[i+3]=L4(this.centers[t+2])}let o=new LT(a,r.x,r.y,1033,wS);o.internalFormat="RGBA32UI",o.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=o,this.material.uniforms.centersColorsTextureSize.value.copy(r);let s=new Float32Array(4096);for(let c=0;c<this.meshMatrixWorlds.length;c++)s.set(this.meshMatrixWorlds[c].elements,16*c);let l=new LT(s,1024,1,ES,SS);l.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=l,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:n,texture:i,size:t},centerColors:{data:a,texture:o,size:r},meshMatrixWorlds:{data:s,texture:l}}}updateIndexes(e){let t=this.geometry;t.attributes.splatIndex.set(e),t.attributes.splatIndex.needsUpdate=!0,t.instanceCount=e.length}updateUniforms(e,t,i,n){this.splatCount>0&&(N4.set(e.x*this.devicePixelRatio,e.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(N4),this.material.uniforms.basisViewport.value.set(2/N4.x,2/N4.y),this.material.uniforms.focal.value.set(t,i),this.material.uniforms.orthoZoom.value=n,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose()),this.removeFromParent()}},H4=new Promise(e=>{U4=e}),G4=!1;function q4(){if(!G4)return V4||(V4=async function(){let e=await i.e(23).then(i.bind(i,23));U4(e),G4=!0}(),V4)}H4.then(e=>j4=e);var X4=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Iw(this,"updateView",function(){let e=new yC,t=[],i=new j_(0,0,-1),n=new j_(0,0,-1),r=new j_,a=new j_;return function(){let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1?arguments[1]:void 0,l=this.updateMatrixWorldsInWorkerIfNeeded(),d=this.cropsChanged();if(!o){n.set(0,0,-1).applyQuaternion(s.quaternion);let e=!1,t=!1;if(n.dot(i)<=.95&&(e=!0),a.copy(s.position).sub(r).length()>=1&&(t=!0),!e&&!t&&!l&&!d&&!this.needsInitialRender)return}this.needsInitialRender=!1,r.copy(s.position),i.copy(n),e.copy(s.matrixWorld).invert(),e.premultiply(this.dummyPerspectiveMatrix),t[0]=s.position.x,t[1]=s.position.y,t[2]=s.position.z;let u=c(c({sort:{view:e.elements,cameraPosition:t,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount}},l?{newMatrixWorlds:this.meshMatrixWorlds}:{}),d?{newCropsArray:this.cropsArray}:{});this.sortRunning?this.queuedMessage=u:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(u))}}()),this.scene=e.scene,this.currentPage=null,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null,this.needsInitialRender=!0,this.dummyPerspectiveMatrix=(new yC).makePerspective(-1,1,-1,1,.1,1e3)}updateSplatMeshUniforms(e,t){let i=new p_;null!==this.splatMesh&&this.splatMesh.getSplatCount()>0&&(e.getSize(i),this.cameraFocalLengthX=t.projectionMatrix.elements[0]*this.devicePixelRatio*i.x*.45,this.cameraFocalLengthY=t.projectionMatrix.elements[5]*this.devicePixelRatio*i.y*.45,this.splatMesh.updateUniforms(i,this.cameraFocalLengthX,this.cameraFocalLengthY,t.isPerspectiveCamera?-1:t.zoom*this.devicePixelRatio))}loadSplat(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.activePage=this.scene.activePage,e.position&&(e.position=(new j_).fromArray(e.position)),e.orientation&&(e.orientation=(new V_).fromArray(e.orientation)),e.halfPrecisionCovariances=!!e.halfPrecisionCovariances;let t=[];if(this.splatEntries=t,this.activePage.traverseVisibleEntity(e=>{"Splat"===e.data.type&&t.push(e)}),this.splatMesh&&this.splatMesh.dispose(),0===t.length)return this.splatMesh=null,!1;this.meshMatrixWorlds=t.map(e=>e.matrixWorld),this.meshMatrixWorldsOld=t.map(e=>e.matrixWorld.clone()),this.cropsArray=t.map(e=>e.data.crops.map(e=>e.data));let i=t.map(e=>new j4.GSplineBuffer(new Uint8Array(e.data.buffer).buffer)),n=0,r=[0];for(let a of i)n+=a.getSplatCount(),r.push(n);return this.setupSplatMesh(i,n,e.position,e.orientation,e.halfPrecisionCovariances,this.devicePixelRatio,r,this.meshMatrixWorlds),this.setupSortWorker(n),!0}updateMatrixWorldsInWorkerIfNeeded(){let e=this.splatDataTextures.meshMatrixWorlds.data;for(let t=0;t<this.meshMatrixWorlds.length;t++)e.set(this.meshMatrixWorlds[t].elements,16*t);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,!this.meshMatrixWorlds.every((e,t)=>e.equals(this.meshMatrixWorldsOld[t]))&&(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map(e=>e.clone()),!0)}cropsChanged(){let e=!1;return this.splatEntries.forEach((t,i)=>{var n;t.data.crops.forEach((t,n)=>{void 0===this.cropsArray[i][n]?(e=!0,this.cropsArray[i][n]=t.data):Object.entries(t.data).forEach(t=>{var r;let[a,o]=t;(Array.isArray(o)&&o.some((e,t)=>e!==this.cropsArray[i][n][a][t])||o!==(null===(r=this.cropsArray[i][n])||void 0===r?void 0:r[a]))&&(e=!0,this.cropsArray[i][n][a]=o)})}),t.data.crops.length!==(null===(n=this.cropsArray[i])||void 0===n?void 0:n.length)&&(this.cropsArray[i].length=t.data.crops.length,e=!0)}),e}setupSplatMesh(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new j_,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new V_,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0;this.splatMesh=W4.buildMesh(e,t,r,a,o,s),this.splatMesh.position.copy(i),this.splatMesh.quaternion.copy(n),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=99999,this.splatRenderCount=t,this.splatMesh.onBeforeRender=(e,t,i)=>this.update(e,i)}setupSortWorker(e){this.sortWorker=function(e){let t=new Worker(URL.createObjectURL(new Blob(["(",z4.toString(),")(self)"],{type:"application/javascript"}))),i=atob("AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL"),n=new Uint8Array(i.length);for(let r=0;r<i.length;r++)n[r]=i.charCodeAt(r);return t.postMessage({init:{sorterWasmBytes:n.buffer,splatCount:e,Constants:{BytesPerFloat:R4.BytesPerFloat,BytesPerInt:R4.BytesPerInt,DepthMapRange:R4.DepthMapRange,MemoryPageSize:R4.MemoryPageSize}}}),t}(e),this.sortWorker.onmessage=e=>{var t;e.data.sortDone?(this.sortRunning=!1,null!==(t=this.splatMesh)&&void 0!==t&&t.updateIndexes(new Uint32Array(e.data.indexesBuffer)),this.lastSortTime=e.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):e.data.sortCanceled?this.sortRunning=!1:e.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):e.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.scene.activePage.add(this.splatMesh),this.needsInitialRender=!0)}}update(e,t){null!==this.splatMesh&&(this.updateSplatMeshUniforms(e,t),this.updateView(!1,t))}getSplatMesh(){return this.splatMesh}},Y4=new nE;Y4.wireframe=!0;var Q4=new j_,K4=class extends OT{constructor(e,t){super(),this.data=e,this.sharedAssets=t,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.shapeBlendIntances=[],this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new k4,this.invisibleObjects=new M0("jflkdsafjasdifjaslk",c(c({},Ij.defaultData),{},{visible:!1,name:"buildin invisible"})),this.needsRecomputeInstances=!1,this.init(e,t),this.matrixAutoUpdate=!1,this.errorPage=new B3("fdasfa",c(c({},Vj.defaultData),{},{name:""}),{shared:t,scene:this})}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=function(e){let t=!1;return e.traverseEntity(e=>{if(e instanceof JJ)if(Array.isArray(e.material))for(let i=0;i<e.material.length;i++)T4(e,e.material[i])&&(t=!0);else T4(e,e.material)&&(t=!0)}),t}(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=function(e){let t=!1;return e.traverseEntity(e=>{if(e instanceof JJ)if(Array.isArray(e.material))for(let i=0;i<e.material.length;i++)M4(e,e.material[i])&&(t=!0);else M4(e,e.material)&&(t=!0)}),t}(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),i=this.entityIdentityToEntity[t];i&&(e.uuid=i.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}markPenumbraSizeDirty(){for(let e of this.children)e instanceof B3&&(e.penumbraSizeArrayCache=null)}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(e){let t=this.find(e);if(void 0===t)return;let i=[],n=t;for(;n!==this;){let e=n;n=n.parent;let t=n.children.indexOf(e);i.splice(0,0,t)}return{entity:t,sortKey:i}}getAllSorted(e){let t=[];for(let i of e){let e=this.getWithSortKey(i.id);void 0!==e&&t.push(e)}return t.sort((e,t)=>dN(e.sortKey,t.sortKey)),t.map(e=>e.entity)}nonExistOrDescendantOf(e,t){let i=this.find(e);if(void 0===i)return!0;for(;i;){if(i.uuid===t)return!0;i=i.parent}return!1}find(e){if(this.activePage&&this.activePage.personalCamera.parent){if("f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera"===e)return this.activePage.personalCamera;if(e===OV)return this.activePage.personalCamera}if(""===e||void 0===e)return;let t=this.entityByUuid[e];return void 0===t?this.getObjectByProperty("uuid",e):t}find2D(e){for(let t of this.children)if(t instanceof B3&&t.uiScene){let i=t.uiScene.find(e);if(i)return i}}findScene2DfromObject2D(e){for(let t of this.children)if(t instanceof B3&&t.uiScene&&t.uiScene.find(e))return t.uiScene}find2DInUIObjects(e){let t;return this.traverseEntity(i=>{void 0===t&&i instanceof X3&&(t=i.uiCanvas.find(e))}),t}traverse2D(e){for(let t of this.children)t instanceof B3&&t.uiScene&&t.uiScene.traverse(e)}debugEnsureEntity(e){let t=this.find(e);t?Array.isArray(t.identity)&&void 0===this.findInstance(t.identity)&&console.error("not found instance"):console.error("not found")}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors(e=>{this.toExpandCloner.add(e)})}doPendingExpandCloner(){this.toExpandCloner.forEach(e=>{e.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(e=>{var t;null===(t=e.cloner)||void 0===t||t.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach(e=>e()),this.pendingCommands.length=0}updateByLibOp(e,t){1===e.path.length&&"components"===e.path[0]&&1===e.type&&this.createChildrenObjects([c(c({},e.data.asset),{},{id:e.id})],this.invisibleObjects,t)}updateTreeByOp(e,t){if(0===e.path.length&&7===e.type){let i=null===e.parent?this:this.find(e.parent);if(void 0===i)throw new Error("unexpected");let n=this.createObject(e.id,e.data,e.children,i,e.localIndex,t);n.updateVisible(this),n.resetBBoxNeedsUpdate(),b0(n)&&x0(n.parent)&&(n.invalidateUpstreamBooleanData(),n.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(i),this.markNeedsRecomputeInstancesForChildren(n),this.markToExpandCloner(n),this.markPenumbraSizeDirty(),n.updatePathSnapping()}else if(0===e.path.length&&8===e.type){let t=this.find(e.id);if(void 0===t)throw new Error("unexpected");t.traverseEntity(e=>{e instanceof v4&&(this.shapeBlendIntances=this.shapeBlendIntances.filter(t=>t!==e))}),this.markToExpandCloner(t),t.resetBBoxNeedsUpdate(),this.unregisterObject(t);let i=t.parent;this.markNeedsRecomputeInstancesForAncessors(i),this.markNeedsRecomputeInstancesForChildren(t),this.markPenumbraSizeDirty(),t.parent.remove(t),x0(t.parent)&&(t.parent.invalidateUpstreamBooleanData(),t.parent.invalidateDownstreamBooleanData().recomputeBoolean()),b0(t)&&(t.freeBooleanPointer(),i instanceof v0&&i.invalidateDownstreamBooleanData().recomputeBoolean()),t instanceof U3&&t.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(t),this.pathConstraints.removeDependencies(t.uuid),t.updatePathSnapping()}else if(0===e.path.length&&9===e.type){var i;let t=this.find(e.id);if(void 0===t)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(t);let n=t.parent;this.markNeedsRecomputeInstancesForAncessors(n),null!==(i=t.cloner)&&void 0!==i&&i.resetOnMove(),this.markToExpandCloner(t);let r=null===e.parent?this:this.find(e.parent);if(void 0===r)throw new Error("unexpected");r.add(t),this.markNeedsRecomputeInstancesForAncessors(r),this.markToExpandCloner(t),t.invalidateClonerTransform(t),t.updateVisible(this),t.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let a=e.localIndex;r.children.splice(a,0,r.children.pop()),b0(t)&&(t.invalidateUpstreamBooleanData(),x0(t.parent)?t.parent.invalidateDownstreamBooleanData().recomputeBoolean():n instanceof v0&&n.invalidateDownstreamBooleanData().recomputeBoolean()),t.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){var e;return null!==(e=this.find(this.data.publish.playPage))&&void 0!==e?e:this.errorPage}updatePage(e){var t;this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let i of this.children)i instanceof B3&&(i.visible=i.uuid===e,i.visible&&(this.activePage=i,this.activePage.onActive(this)));this.activePage!==(null===(t=this.splatViewer)||void 0===t?void 0:t.activePage)&&this.reloadSplats()}updateEntityByOp(e,t,i,n){if(0===t.type){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),"visible"in t.props&&this.markPenumbraSizeDirty(),t.path.includes("overrides")&&"states"in t.props){let{rest:e}=t.props;t=c(c({},t),{},{props:e}),this.markNeedsRecomputeInstances()}"pathSnapping"===t.path[0]&&void 0!==t.props.pathId&&this.pathConstraints.setConstraint(e,t.props.pathId)}let r=this.find(e);if(r)try{(function(e,t,i,n){e.updateByOp(t,i,n,!1)})(r,t,i,{scene:this,shared:n}),r instanceof r$&&r.updateGeometryGroupsIfNeeded()}catch(wV){console.error(wV)}}updateEntity2DByOp(e,t,i,n,r){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];e.updateEntityByOp(t,i,n,r),this.traverseEntity(e=>{var o;(e instanceof X3||e instanceof B3)&&(a.includes(null!==(o=e.frameId)&&void 0!==o?o:"")||e.frameId===t)&&e.updateEntity2DByOp(t,i,n,r)})}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(e){this.activePage.switchActiveCamera(e)}isInvisibleObjects(e){return e===this.invisibleObjects||e.hasAnccestor(this.invisibleObjects)}init(e,t){let i=Object.entries(t.data.lib.components).map((e,t)=>({data:e[1].asset.data,children:e[1].asset.children,id:e[0],fi:t}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:t}),this.add(this.invisibleObjects),this.createChildrenObjects(i,this.invisibleObjects,t),this.createChildrenObjects(e.objects,this,t),this.updatePage(e.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(t,!0),this.traverseEntity(e=>{e instanceof h0&&e.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity(e=>{("Component"===e.data.type||"Instance"===e.data.type)&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(e){PG.is(e)&&("Component"===e.data.type&&this.markNeedsRecomputeInstances(),e.traverseAncestors(e=>{PG.is(e)&&"Component"===e.data.type&&this.markNeedsRecomputeInstances()}))}relativeizeInner(e,t,i,n,r,a,o){if(e){let s=n.find(e);s&&s!==n&&r.forInstancesRec(n=>{n.data=yF(n.data,r=>{let s=r.events.data(o.id),l=n.goUp(a);if(l){let n=[...cN(l.identity),e].join("-"),r=this.entityIdentityToEntity[n];if(r){let e=r.uuid;fF.zoom(s,t)[i]=e}else console.warn("cannot find instance")}}).data})}}rewriteActions(e,t,i,n,r,a){e.forEach(e=>{"Transition"===e.data.type||"Animation"===e.data.type?this.relativeizeInner(e.data.object,[...t,e.id],"object",i,n,r,a):"Conditional"===e.data.type&&(this.rewriteActions(e.data.ifActions,[...t,e.id,"ifActions"],i,n,r,a),this.rewriteActions(e.data.elseActions,[...t,e.id,"elseActions"],i,n,r,a))})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(e=>{if(e instanceof j3&&"string"==typeof e.identity&&"Component"===e.data.type)return e.traverseEntity((t,i)=>{t.data.events.forEach(n=>{if("GameControl"===n.data.type){let r=!1;if(t.forInstancesRec(e=>{e.data=yF(e.data,t=>{e.isInstanceRoot||(t.events.delete(n.id),r=!0)}).data}),!1===r)for(let a of oW.list)this.rewriteActions(n.data.gameActions[a],["gameActions",a],e,t,i,n)}else"Conditional"===n.data.type?("Distance"===n.data.condition.type?(this.relativeizeInner(n.data.condition.fromObject,["condition"],"fromObject",e,t,i,n),this.relativeizeInner(n.data.condition.toObject,["condition"],"toObject",e,t,i,n)):"State"===n.data.condition.type?this.relativeizeInner(n.data.condition.object,["condition"],"object",e,t,i,n):"Comparison"===n.data.condition.type&&("Property"===n.data.condition.lOperand.type&&this.relativeizeInner(n.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,i,n),"Property"===n.data.condition.rOperand.type&&this.relativeizeInner(n.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,i,n)),this.rewriteActions(n.data.inActions,["inActions"],e,t,i,n),this.rewriteActions(n.data.outActions,["outActions"],e,t,i,n)):"actions"in n.data&&this.rewriteActions(n.data.actions,["actions"],e,t,i,n)})}),!0})}expandInstances(e,t,i){let n=new Set;this.traverseEntity(r=>{if(r instanceof j3&&r.isInstanceRoot)return r.expandInstanceChildren({scene:this,shared:e,pendingDeletes:n}),t||r.resetBBoxNeedsUpdate(),i&&r.traverseEntity(e=>{i.addClip(e)}),!0});for(let r of n)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),W3(r)}recomputeInstances(e,t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(e=>{e instanceof j3&&e.isInstanceRoot&&(e.component=void 0)}),this.expandInstances(e,!1,t))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity(e=>{let t="string"==typeof e.identity?e.identity:e.identity.join("-");this.entityIdentityToEntity[t]===e&&(delete this.entityByUuid[e.uuid],delete this.entityIdentityToEntity[t]),e.dispose()})}clearScene(){for(let e of this.children)PG.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}raycast(e){return this.raycast1(e,!1)}raycast1(e,t){let i=[],n=r=>{for(let a of r.children){let r=a.cloner;if(PG.is(a)&&!a.raycastLock&&(a.visible||null!==r&&void 0!==r&&r.object.data.visible))if(!0===t&&a.isInstanceRoot){let t=[];if(e.intersectObject(a,!0,t),t.length){let e=t[0];e.object=a,e.point.applyMatrix4(e.object.matrixWorld);let n=a.matrixWorld.clone().invert();e.point.applyMatrix4(n),i.push(e)}}else(b0(a)||w0(a)&&this.enableHelpers&&a.objectHelper.visible)&&(e.intersectObject(a,!1,i),I4(a,e,i)),n(a)}};return n(this.activePage),i}raycastWithClones(e){let t=[],i=n=>{for(let r of n.children){let n=r.cloner;PG.is(r)&&(r.visible||(null===n||void 0===n?void 0:n.object.data.visible))&&((b0(r)||w0(r)&&this.enableHelpers&&r.objectHelper.visible)&&(e.intersectObject(r,!1,t),I4(r,e,t,!0)),i(r))}};return i(this),t}forEachEntity(e){for(let t of this.children)PG.is(t)&&e(t)}traverseConcreteEntity(e){for(let t of this.children)PG.is(t)&&t.isConcreteEntity&&t.traverseEntity(e)}traverseEntity(e){for(let t of this.children)PG.is(t)&&t.traverseEntity(e)}updateFont(e,t){this.traverseEntity(i=>{if(i instanceof r$&&"Mesh"===i.data.type&&("TextGeometry"===i.data.geometry.type||"InputGeometry"===i.data.geometry.type)&&i.data.geometry.font===e){let n=i.geometry,r=i.data.geometry;n.updateFont(e,t).then(()=>{n.update(r,t);let e=i.invalidateDownstreamBooleanData();x0(e)&&e.recomputeBoolean()})}})}traverseObject(e){for(let t of this.children)SG.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)PG.is(t)&&t.visible&&t.traverseVisibleEntity(e)}dispose(){this.clearScene()}createChildrenObjects(e,t,i){let n=0;for(let r of e)this.createObject(r.id,r.data,r.children,t,n,i),n+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,i,n,r,a){var o;let s={scene:this,shared:a},l=c4(e,t,s);return l instanceof v4&&this.shapeBlendIntances.push(l),l&&(this.entityByUuid[e]=l,n.add(l),n.children.splice(r,0,n.children.pop()),i.length>0&&(l.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(i,l,a)),l.updateState(t,s),l instanceof r$&&l.updateGeometryGroupsIfNeeded(),l.updateVisible(this),l.cloner&&this.toExpandCloner.add(l),null!==(o=t.pathSnapping)&&void 0!==o&&o.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),"Empty"===t.type&&t.animations&&l.traverseEntity(e=>{let t=e.dataPatched;if(e instanceof r$&&t.bones&&t.boneInverses){let i=t.bones.map(e=>this.find(e)),n=t.boneInverses.map(e=>(new yC).fromArray(e)),r=new FT(i,n);e.bind(r,e.bindMatrix)}else e.matrixAutoUpdate=!0}),l}getCenter(e){let t=[];for(let n=0,r=e.length;n<r;++n){let{id:i,recursive:r}=e[n],a=this.find(i),o=r?a.recursiveBBox:a.singleBBox;t.push(...o.vertices)}let i=new G_;return i.setFromPoints(t),i.getCenter(Q4),Q4}copyMatrixWorld(e,t){if(null===e)return void t.identity();let i=this.find(e);i?t.copy(i.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){var i;if(null===e)return void t.identity();let n=null===(i=this.find(e))||void 0===i?void 0:i.parent;n?t.copy(n.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity(t=>{if(t instanceof CQ)if(Array.isArray(t.material))for(let i=0;i<t.material.length;i++)t.material[i]instanceof aJ&&e(t.material[i]);else t.material instanceof aJ&&e(t.material)})}updateViewPlaneSize(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.traverseConcreteEntity(n=>{n instanceof h0&&n.setViewplaneSize(e,t,i)})}initializeSplatViewer(){this.splatViewer=new X4({scene:this}),this.reloadSplats()}reloadSplats(){var e;null===(e=this.splatViewer)||void 0===e||e.loadSplat()}},Z4=(e,t)=>{let i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},J4=e=>e*(Math.PI/180),$4=e=>e*(180/Math.PI),e5=new Map,t5=e=>{e5.has(e)&&clearTimeout(e5.get(e)),e5.set(e,setTimeout(e,100))},i5=(e,t,i)=>{let n,r=t.split(/[ ,]+/g);for(let a=0;a<r.length;a+=1)n=r[a],e.addEventListener?e.addEventListener(n,i,!1):e.attachEvent&&e.attachEvent(n,i)},n5=(e,t,i)=>{let n,r=t.split(/[ ,]+/g);for(let a=0;a<r.length;a+=1)n=r[a],e.removeEventListener?e.removeEventListener(n,i):e.detachEvent&&e.detachEvent(n,i)},r5=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),a5=()=>{if(typeof window>"u")return;return{x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},o5=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},s5=(e,t,i)=>{let n=l5(e);for(let r in n)if(n.hasOwnProperty(r))if("string"==typeof t)n[r]=t+" "+i;else{let e="";for(let n=0,r=t.length;n<r;n+=1)e+=t[n]+" "+i+", ";n[r]=e.slice(0,-2)}return n},l5=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach(function(i){t[i+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},c5=(e,t)=>{for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},d5=(e,t)=>{if(e.length)for(let i=0,n=e.length;i<n;i+=1)t(e[i]);else t(e)};typeof window<"u"&&(u5="ontouchstart"in window,h5=!!window.PointerEvent,p5=!!window.MSPointerEvent);var u5,h5,p5,f5,m5={start:"mousedown",move:"mousemove",end:"mouseup"},g5={};function v5(){}h5?f5={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:p5?f5={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:u5?(f5={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},g5=m5):f5=m5,v5.prototype.on=function(e,t){var i,n=this,r=e.split(/[ ,]+/g);n._handlers_=n._handlers_||{};for(var a=0;a<r.length;a+=1)i=r[a],n._handlers_[i]=n._handlers_[i]||[],n._handlers_[i].push(t);return n},v5.prototype.off=function(e,t){var i=this;return i._handlers_=i._handlers_||{},void 0===e?i._handlers_={}:void 0===t?i._handlers_[e]=null:i._handlers_[e]&&i._handlers_[e].indexOf(t)>=0&&i._handlers_[e].splice(i._handlers_[e].indexOf(t),1),i},v5.prototype.trigger=function(e,t){var i,n=this,r=e.split(/[ ,]+/g);n._handlers_=n._handlers_||{};for(var a=0;a<r.length;a+=1)i=r[a],n._handlers_[i]&&n._handlers_[i].length&&n._handlers_[i].forEach(function(e){e.call(n,{type:i,target:n},t)})},v5.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=((e,t)=>{let i={};for(let n in e)e.hasOwnProperty(n)&&t.hasOwnProperty(n)?i[n]=t[n]:e.hasOwnProperty(n)&&(i[n]=e[n]);return i})(t.options,e))},v5.prototype.bindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[t]=function(){"function"==typeof i["on"+t]?i["on"+t].apply(i,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},i5(e,f5[t],i._domHandlers_[t]),g5[t]&&i5(e,g5[t],i._domHandlers_[t]),i},v5.prototype.unbindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},n5(e,f5[t],i._domHandlers_[t]),g5[t]&&n5(e,g5[t],i._domHandlers_[t]),delete i._domHandlers_[t],this};var y5=v5;function b5(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),"dynamic"===this.options.mode&&(this.options.restOpacity=0),this.id=b5.id,b5.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}b5.prototype=new y5,b5.constructor=b5,b5.id=0,b5.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},b5.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=((e,t)=>{let i=l5(e);for(let n in i)i.hasOwnProperty(n)&&(i[n]=t);return i})("borderRadius","50%"),i=s5("transition","opacity",e),n={};return n.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},n.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},n.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},c5(n.el,i),"circle"===this.options.shape&&c5(n.back,t),c5(n.front,t),this.applyStyles(n),this},b5.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var i in e[t])this.ui[t].style[i]=e[t][i];return this},b5.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},b5.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},b5.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},b5.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),"function"==typeof e&&e.call(this)},t.options.fadeTime)),t},b5.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var i="dynamic"===t.options.mode?"none":"block";t.ui.el.style.display=i,"function"==typeof e&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){let i=t.options.restJoystick,n={};n.x=!0===i||!1!==i.x?0:t.instance.frontPosition.x,n.y=!0===i||!1!==i.y?0:t.instance.frontPosition.y,t.setPosition(e,n)}return t},b5.prototype.setPosition=function(e,t){var i=this;i.frontPosition={x:t.x,y:t.y};var n=i.options.fadeTime+"ms",r={};r.front=s5("transition",["top","left"],n);var a={front:{}};a.front={left:i.frontPosition.x+"px",top:i.frontPosition.y+"px"},i.applyStyles(r),i.applyStyles(a),i.restTimeout=setTimeout(function(){"function"==typeof e&&e.call(i),i.restCallback()},i.options.fadeTime)},b5.prototype.restCallback=function(){var e=this,t={};t.front=s5("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)},b5.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},b5.prototype.computeDirection=function(e){var t,i,n,r=e.angle.radian,a=Math.PI/4,o=Math.PI/2;if(r>a&&r<3*a&&!e.lockX?t="up":r>-a&&r<=a&&!e.lockY?t="left":r>3*-a&&r<=-a&&!e.lockX?t="down":e.lockY||(t="right"),e.lockY||(i=r>-o&&r<o?"left":"right"),e.lockX||(n=r>0?"up":"down"),e.force>this.options.threshold){var s,l={};for(s in this.direction)this.direction.hasOwnProperty(s)&&(l[s]=this.direction[s]);var c={};for(s in this.direction={x:i,y:n,angle:t},e.direction=this.direction,l)l[s]===this.direction[s]&&(c[s]=!0);if(c.x&&c.y&&c.angle)return e;(!c.x||!c.y)&&this.trigger("plain",e),c.x||this.trigger("plain:"+i,e),c.y||this.trigger("plain:"+n,e),c.angle||this.trigger("dir dir:"+t,e)}else this.resetDirection();return e};var x5=b5;function w5(e,t){var i=this;i.nipples=[],i.idles=[],i.actives=[],i.ids=[],i.pressureIntervals={},i.manager=e,i.id=w5.id,w5.id+=1,i.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},i.config(t),("static"===i.options.mode||"semi"===i.options.mode)&&(i.options.multitouch=!1),i.options.multitouch||(i.options.maxNumberOfNipples=1);let n=getComputedStyle(i.options.zone.parentElement);return n&&"flex"===n.display&&(i.parentIsFlex=!0),i.updateBox(),i.prepareNipples(),i.bindings(),i.begin(),i.nipples}w5.prototype=new y5,w5.constructor=w5,w5.id=0,w5.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(e){if(void 0===e)return t[0];for(var i=0,n=t.length;i<n;i+=1)if(t[i].identifier===e)return t[i];return!1}},w5.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"},w5.prototype.begin=function(){var e=this,t=e.options;if("static"===t.mode){var i=e.createNipple(t.position,e.manager.getIdentifier());i.add(),e.idles.push(i)}},w5.prototype.createNipple=function(e,t){var i=this,n=i.manager.scroll,r={},a=i.options,o=i.parentIsFlex?n.x:n.x+i.box.left,s=i.parentIsFlex?n.y:n.y+i.box.top;if(e.x&&e.y)r={x:e.x-o,y:e.y-s};else if(e.top||e.right||e.bottom||e.left){var l=document.createElement("DIV");l.style.display="hidden",l.style.top=e.top,l.style.right=e.right,l.style.bottom=e.bottom,l.style.left=e.left,l.style.position="absolute",a.zone.appendChild(l);var c=l.getBoundingClientRect();a.zone.removeChild(l),r=e,e={x:c.left+n.x,y:c.top+n.y}}var d=new x5(i,{color:a.color,size:a.size,threshold:a.threshold,fadeTime:a.fadeTime,dataOnly:a.dataOnly,restJoystick:a.restJoystick,restOpacity:a.restOpacity,mode:a.mode,identifier:t,position:e,zone:a.zone,frontPosition:{x:0,y:0},shape:a.shape});return a.dataOnly||(o5(d.ui.el,r),o5(d.ui.front,d.frontPosition)),i.nipples.push(d),i.trigger("added "+d.identifier+":added",d),i.manager.trigger("added "+d.identifier+":added",d),i.bindNipple(d),d},w5.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},w5.prototype.bindNipple=function(e){var t,i=this,n=function(e,n){t=e.type+" "+n.id+":"+e.type,i.trigger(t,n)};e.on("destroyed",i.onDestroyed.bind(i)),e.on("shown hidden rested dir plain",n),e.on("dir:up dir:right dir:down dir:left",n),e.on("plain:up plain:right plain:down plain:left",n)},w5.prototype.pressureFn=function(e,t,i){var n=this,r=0;clearInterval(n.pressureIntervals[i]),n.pressureIntervals[i]=setInterval(function(){var i=e.force||e.pressure||e.webkitForce||0;i!==r&&(t.trigger("pressure",i),n.trigger("pressure "+t.identifier+":pressure",i),r=i)}.bind(n),100)},w5.prototype.onstart=function(e){var t=this,i=t.options,n=e;e=r5(e),t.updateBox();return d5(e,function(r){t.actives.length<i.maxNumberOfNipples?t.processOnStart(r):n.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(i){if(Object.values(n.touches).findIndex(function(e){return e.identifier===i})<0){var r=[e[0]];r.identifier=i,t.processOnEnd(r)}}),t.actives.length<i.maxNumberOfNipples&&t.processOnStart(r))}),t.manager.bindDocument(),!1},w5.prototype.processOnStart=function(e){var t,i=this,n=i.options,r=i.manager.getIdentifier(e),a=e.force||e.pressure||e.webkitForce||0,o={x:e.pageX,y:e.pageY},s=i.getOrCreate(r,o);s.identifier!==r&&i.manager.removeIdentifier(s.identifier),s.identifier=r;var l=function(t){t.trigger("start",t),i.trigger("start "+t.id+":start",t),t.show(),a>0&&i.pressureFn(e,t,t.identifier),i.processOnMove(e)};if((t=i.idles.indexOf(s))>=0&&i.idles.splice(t,1),i.actives.push(s),i.ids.push(s.identifier),"semi"!==n.mode)l(s);else{if(!(Z4(o,s.position)<=n.catchDistance))return s.destroy(),void i.processOnStart(e);l(s)}return s},w5.prototype.getOrCreate=function(e,t){var i,n=this,r=n.options;return/(semi|static)/.test(r.mode)?(i=n.idles[0])?(n.idles.splice(0,1),i):"semi"===r.mode?n.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1):i=n.createNipple(t,e)},w5.prototype.processOnMove=function(e){var t=this,i=t.options,n=t.manager.getIdentifier(e),r=t.nipples.get(n),a=t.manager.scroll;if((e=>isNaN(e.buttons)?0!==e.pressure:0!==e.buttons)(e)){if(!r)return console.error("Found zombie joystick with ID "+n),void t.manager.removeIdentifier(n);if(i.dynamicPage){var o=r.el.getBoundingClientRect();r.position={x:a.x+o.left,y:a.y+o.top}}r.identifier=n;var s=r.options.size/2,l={x:e.pageX,y:e.pageY};i.lockX&&(l.y=r.position.y),i.lockY&&(l.x=r.position.x);var c,d,u=Z4(l,r.position),h=((e,t)=>{let i=t.x-e.x,n=t.y-e.y;return $4(Math.atan2(n,i))})(l,r.position),p=J4(h),f=u/s,m={distance:u,position:l};if("circle"===r.options.shape?(c=Math.min(u,s),d=((e,t,i)=>{let n={x:0,y:0};return i=J4(i),n.x=e.x-t*Math.cos(i),n.y=e.y-t*Math.sin(i),n})(r.position,c,h)):(d=((e,t,i)=>({x:Math.min(Math.max(e.x,t.x-i),t.x+i),y:Math.min(Math.max(e.y,t.y-i),t.y+i)}))(l,r.position,s),c=Z4(d,r.position)),i.follow){if(u>s){let e=l.x-d.x,i=l.y-d.y;r.position.x+=e,r.position.y+=i,r.el.style.top=r.position.y-(t.box.top+a.y)+"px",r.el.style.left=r.position.x-(t.box.left+a.x)+"px",u=Z4(l,r.position)}}else l=d,u=c;var g=l.x-r.position.x,v=l.y-r.position.y;r.frontPosition={x:g,y:v},i.dataOnly||o5(r.ui.front,r.frontPosition);var y={identifier:r.identifier,position:l,force:f,pressure:e.force||e.pressure||e.webkitForce||0,distance:u,angle:{radian:p,degree:h},vector:{x:g/s,y:-v/s},raw:m,instance:r,lockX:i.lockX,lockY:i.lockY};(y=r.computeDirection(y)).angle={radian:J4(180-h),degree:180-h},r.trigger("move",y),t.trigger("move "+r.id+":move",y)}else this.processOnEnd(e)},w5.prototype.processOnEnd=function(e){var t=this,i=t.options,n=t.manager.getIdentifier(e),r=t.nipples.get(n),a=t.manager.removeIdentifier(r.identifier);!r||(i.dataOnly||r.hide(function(){"dynamic"===i.mode&&(r.trigger("removed",r),t.trigger("removed "+r.id+":removed",r),t.manager.trigger("removed "+r.id+":removed",r),r.destroy())}),clearInterval(t.pressureIntervals[r.identifier]),r.resetDirection(),r.trigger("end",r),t.trigger("end "+r.id+":end",r),t.ids.indexOf(r.identifier)>=0&&t.ids.splice(t.ids.indexOf(r.identifier),1),t.actives.indexOf(r)>=0&&t.actives.splice(t.actives.indexOf(r),1),/(semi|static)/.test(i.mode)?t.idles.push(r):t.nipples.indexOf(r)>=0&&t.nipples.splice(t.nipples.indexOf(r),1),t.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(t.manager.ids[a.id]=a.identifier))},w5.prototype.onDestroyed=function(e,t){var i=this;i.nipples.indexOf(t)>=0&&i.nipples.splice(i.nipples.indexOf(t),1),i.actives.indexOf(t)>=0&&i.actives.splice(i.actives.indexOf(t),1),i.idles.indexOf(t)>=0&&i.idles.splice(i.idles.indexOf(t),1),i.ids.indexOf(t.identifier)>=0&&i.ids.splice(i.ids.indexOf(t.identifier),1),i.manager.removeIdentifier(t.identifier),i.manager.unbindDocument()},w5.prototype.destroy=function(){var e=this;for(var t in e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(e){e.destroy()}),e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var S5=w5;function _5(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=a5(),t.config(e),t.prepareCollections();var i=function(){var e;t.collections.forEach(function(i){i.forEach(function(i){e=i.el.getBoundingClientRect(),i.position={x:t.scroll.x+e.left,y:t.scroll.y+e.top}})})};if(typeof window>"u")return t.collections;i5(window,"resize",function(){t5(i)});var n=function(){t.scroll=a5()};return i5(window,"scroll",function(){t5(n)}),t.collections}_5.prototype=new y5,_5.constructor=_5,_5.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var i;return e.collections.every(function(e){return!(i=e.get(t))}),i}},_5.prototype.create=function(e){return this.createCollection(e)},_5.prototype.createCollection=function(e){var t=this,i=new S5(t,e);return t.bindCollection(i),t.collections.push(i),i},_5.prototype.bindCollection=function(e){var t,i=this,n=function(e,n){t=e.type+" "+n.id+":"+e.type,i.trigger(t,n)};e.on("destroyed",i.onDestroyed.bind(i)),e.on("shown hidden rested dir plain",n),e.on("dir:up dir:right dir:down dir:left",n),e.on("plain:up plain:right plain:down plain:left",n)},_5.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)},_5.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||!0===e)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)},_5.prototype.getIdentifier=function(e){var t;return e?void 0===(t=void 0===e.identifier?e.pointerId:e.identifier)&&(t=this.latest||0):t=this.index,void 0===this.ids[t]&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]},_5.prototype.removeIdentifier=function(e){var t={};for(var i in this.ids)if(this.ids[i]===e){t.id=i,t.identifier=this.ids[i],delete this.ids[i];break}return t},_5.prototype.onmove=function(e){return this.onAny("move",e),!1},_5.prototype.onend=function(e){return this.onAny("end",e),!1},_5.prototype.oncancel=function(e){return this.onAny("end",e),!1},_5.prototype.onAny=function(e,t){var i,n=this,r="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=r5(t);var a=function(e,t,i){i.ids.indexOf(t)>=0&&(i[r](e),e._found_=!0)};return d5(t,function(e){i=n.getIdentifier(e),d5(n.collections,a.bind(null,e,i)),e._found_||n.removeIdentifier(i)}),!1},_5.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(e){e.destroy()}),e.off()},_5.prototype.onDestroyed=function(e,t){var i=this;if(i.collections.indexOf(t)<0)return!1;i.collections.splice(i.collections.indexOf(t),1)};var C5=new _5,E5=function(e){return C5.create(e)},A5=new Map,M5=new Map,T5=class{constructor(e,t,i,n){this.data=t;let{audio:r,volume:a,delay:o,loop:s}=t;if(!r)throw new Error("Missing property");let l="string"==typeof r?n.getAudio(r).src:r.data;this.audioPlayer=new wJ({src:l,volume:a,delay:o,loop:s}),M5.has(i.uuid)?M5.get(i.uuid).push(this):M5.set(i.uuid,[this]),A5.set(e,this)}playByToggle(){"stop"===this.data.toggle?"playing"===this.audioPlayer.status?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):"pause"===this.data.toggle?"playing"===this.audioPlayer.status?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},P5=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=A5.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=M5.get(e);null===t||void 0===t||!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(e=>e.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(e=>e.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let e=[...M5.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(e=>{e.forEach(e=>{e.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(e=>{e.forEach(e=>{e.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},D5=class{constructor(e,t,i,n,r){if(this.data=t,this.shared=n,this.condition=r,"play"===t.interaction)this.interaction=new T5(e,t,i,n);else{if("pause"!==t.interaction&&"stop"!==t.interaction)throw new Error("Missing property");this.interaction=new P5(t)}}dispatchBasic(){if(!1===L8(this.shared,this.condition))return!1;this.interaction instanceof T5?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(!1===L8(this.shared,this.condition))return!1;this.interaction instanceof T5?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){if(!1===L8(this.shared,this.condition))return!1;this.interaction instanceof T5&&("start"===e?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},O5=class{constructor(e,t,i,n){this.data=e,this.page=t,this.shared=i,this.condition=n,this.delay=0,this.emission=e.emission,void 0!==e.delay&&(this.delay=e.delay),this.particleSystem=this.page.scene.find(this.data.emitterObjectId)}toggleEmitting(){this.particleSystem.started&&!this.particleSystem.stopped?this.stop(this.delay):this.start(this.delay)}toggleFroze(){this.particleSystem.started&&!this.particleSystem.isFrozen?this.freeze(this.delay):this.unFreeze(this.delay)}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout(()=>{this.start(0),this.clearDelay()},e):this.particleSystem.start()}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout(()=>{this.stop(0),this.clearDelay()},e):this.particleSystem.stop()}freeze(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout(()=>{this.freeze(0),this.clearDelay()},e):this.particleSystem.froze()}unFreeze(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout(()=>{this.unFreeze(0),this.clearDelay()},e):this.particleSystem.unFroze()}reset(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout(()=>{this.reset(0),this.clearDelay()},e):this.particleSystem.reset()}reverseFromCurrent(){switch(this.emission){case"emitToggle":this.toggleEmitting();break;case"pauseToggle":this.toggleFroze()}}dispatchBasic(){if(!1===L8(this.shared,this.condition)||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"emitToggle":this.toggleEmitting();break;case"pause":this.freeze(this.delay);break;case"pauseToggle":this.toggleFroze();break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay)}}dispatchConditional(){if(!1===L8(this.shared,this.condition)||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay)}}dispatchGameControl(e){if(!1===L8(this.shared,this.condition)||!this.particleSystem)return!1;"start"===e?this.start(this.delay):this.stop(this.delay)}dispose(){!this.particleSystem||(this.particleSystem.reset(),this.clearDelay())}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}},I5=(e,t)=>t.some(t=>t instanceof RegExp?t.test(e):t===e);function k5(e,t){if(t=c({defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0},t),e=e.trim(),/^data:/i.test(e))return((e,t)=>{let{stripHash:i}=t,n=gw(/^data:([^,]*?),([^#]*?)(?:#(.*))?$/,{type:1,data:2,hash:3}).exec(e);if(!n)throw new Error("Invalid URL: ".concat(e));let{type:r,data:a,hash:o}=n.groups,s=r.split(";");o=i?"":o;let l=!1;"base64"===s[s.length-1]&&(s.pop(),l=!0);let c=(s.shift()||"").toLowerCase(),d=[...s.map(e=>{let[t,i=""]=e.split("=").map(e=>e.trim());return"charset"===t&&(i=i.toLowerCase(),"us-ascii"===i)?"":"".concat(t).concat(i?"=".concat(i):"")}).filter(Boolean)];return l&&d.push("base64"),(d.length>0||c&&"text/plain"!==c)&&d.unshift(c),"data:".concat(d.join(";"),",").concat(l?a.trim():a).concat(o?"#".concat(o):"")})(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let i=e.startsWith("//");!i&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let n=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&"https:"===n.protocol&&(n.protocol="http:"),t.forceHttps&&"http:"===n.protocol&&(n.protocol="https:"),t.stripAuthentication&&(n.username="",n.password=""),t.stripHash?n.hash="":t.stripTextFragment&&(n.hash=n.hash.replace(/#?:~:text.*?$/i,"")),n.pathname){let e=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,t=0,i="";for(;;){let r=e.exec(n.pathname);if(!r)break;let a=r[0],o=r.index;i+=n.pathname.slice(t,o).replace(/\/{2,}/g,"/"),i+=a,t=o+a.length}i+=n.pathname.slice(t,n.pathname.length).replace(/\/{2,}/g,"/"),n.pathname=i}if(n.pathname)try{n.pathname=decodeURI(n.pathname)}catch(a){}if(!0===t.removeDirectoryIndex&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let e=n.pathname.split("/"),i=e[e.length-1];I5(i,t.removeDirectoryIndex)&&(e=e.slice(0,-1),n.pathname=e.slice(1).join("/")+"/")}if(n.hostname&&(n.hostname=n.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(n.hostname)&&(n.hostname=n.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let s of[...n.searchParams.keys()])I5(s,t.removeQueryParameters)&&n.searchParams.delete(s);if(!0===t.removeQueryParameters&&(n.search=""),t.sortQueryParameters){n.searchParams.sort();try{n.search=decodeURIComponent(n.search)}catch(o){}}t.removeTrailingSlash&&(n.pathname=n.pathname.replace(/\/$/,""));let r=e;return e=n.toString(),!t.removeSingleSlash&&"/"===n.pathname&&!r.endsWith("/")&&""===n.hash&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||"/"===n.pathname)&&""===n.hash&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),i&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var R5=class{constructor(e,t,i,n){let{url:r,context:a}=e;if(this.controlsManager=t,this.shared=i,this.condition=n,!r)throw new Error("Missing property");this.url=r.startsWith("mailto:")?r:k5(r,{removeTrailingSlash:!1,removeSingleSlash:!1,stripWWW:!1}),this.context=null!==a&&void 0!==a?a:"tab"}dispatch(){var e;if(!1===L8(this.shared,this.condition))return!1;rN?window.location.assign(this.url):("tab"===this.context||iN&&"none"===this.context?window.open(this.url,"_blank"):"window"===this.context?window.open(this.url,"_blank","width=".concat(window.innerWidth,", height=").concat(window.innerHeight)):window.open(this.url,"_parent"),null!==(e=this.controlsManager.orbitControls)&&void 0!==e&&e.onPointerUp(hN[0]),hN.splice(0,hN.length))}},z5=class{constructor(e,t,i,n,r){this.data=e,this.page=t,this.controlsManager=i,this.shared=n,this.condition=r,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=e=>{var t;this.timeoutIdQueue.shift();let i=this.page.scene.find(e);if(void 0===i)return;let n=this.controlsManager.sharedGameControlGlobals.rapierWorld,r=!n||(null===(t=i.dataPatched.physics)||void 0===t?void 0:t.fusedBody);if(i.cloner){for(let e of i.cloner.children){var a;r?(e.playModeVisible=!1,e.rigidBody&&"positioned"===(null===(a=i.dataPatched.physics)||void 0===a?void 0:a.rigidBody)&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(e.rigidBody.collider(0).handle),n.removeRigidBody(e.rigidBody),e.rigidBody=void 0),e.bvhGeometry&&(e.bvhGeometry=void 0)):void 0===this.clone||this.clone===e?(e.playModeVisible=!1,e.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(e.rigidBody.collider(0).handle),n.removeRigidBody(e.rigidBody),e.rigidBody=void 0)):void 0===e.playModeVisible&&(e.playModeVisible=!0)}(r||void 0===this.clone||!1===this.clone)&&(i.visible=!1,i.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(i.rigidBody.collider(0).handle),n.removeRigidBody(i.rigidBody),i.rigidBody=void 0),i.bvhGeometry&&(i.bvhGeometry=void 0))}else i.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(i.rigidBody.collider(0).handle),n.removeRigidBody(i.rigidBody),i.rigidBody=void 0),i.bvhGeometry&&(i.bvhGeometry=void 0),i.visible=!1;this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=void 0===n?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(e=>void 0!==e.bvhGeometry):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(e=>void 0!==e.rigidBody),i.destroyedInAction=!0,this.controlsManager.requestRender()},this.objects=[...e.objects]}dispatch(e){if(!1===L8(this.shared,this.condition))return!1;this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay)):this.dispatchInner()}dispatchFromStart(){if(!1===L8(this.shared,this.condition))return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay))}dispose(){this.timeoutIdQueue.forEach(e=>window.clearTimeout(e))}},L5=class{constructor(e,t,i,n,r){this.data=e,this.page=t,this.shared=i,this.eventManager=n,this.condition=r,this.shared=i}dispatch(){var e;if(!1===L8(this.shared,this.condition))return!1;clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout(()=>{var e;this.shared.reset(this.shared.data,!0),m8(this.page,this.shared,!0),this.eventManager.reset(),null!==(e=this.eventManager.controlsManager.gameControl)&&void 0!==e&&e.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId},1e3*(null!==(e=this.data.delay)&&void 0!==e?e:0))}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},B5={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},N5={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},F5=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],U5={CSS:{},springs:{}};function V5(e,t,i){return Math.min(Math.max(e,t),i)}function j5(e,t){return e.indexOf(t)>-1}function W5(e,t){return e.apply(null,t)}var H5={arr:function(e){return Array.isArray(e)},obj:function(e){return j5(Object.prototype.toString.call(e),"Object")},pth:function(e){return H5.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||H5.svg(e))},str:function(e){return"string"==typeof e},fnc:function(e){return"function"==typeof e},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return H5.hex(e)||H5.rgb(e)||H5.hsl(e)},key:function(e){return!B5.hasOwnProperty(e)&&!N5.hasOwnProperty(e)&&"targets"!==e&&"keyframes"!==e}};function G5(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(e){return parseFloat(e)}):[]}function q5(e,t){var i=G5(e),n=V5(H5.und(i[0])?1:i[0],.1,100),r=V5(H5.und(i[1])?100:i[1],.1,100),a=V5(H5.und(i[2])?10:i[2],.1,100),o=V5(H5.und(i[3])?0:i[3],.1,100),s=Math.sqrt(r/n),l=a/(2*Math.sqrt(r*n)),c=l<1?s*Math.sqrt(1-l*l):0,d=l<1?(l*s-o)/c:-o+s;function u(e){var i=t?t*e/1e3:e;return i=l<1?Math.exp(-i*l*s)*(1*Math.cos(c*i)+d*Math.sin(c*i)):(1+d*i)*Math.exp(-i*s),0===e||1===e?e:1-i}return t?u:function(){var t=U5.springs[e];if(t)return t;for(var i=1/6,n=0,r=0;;)if(1===u(n+=i)){if(++r>=16)break}else r=0;var a=n*i*1e3;return U5.springs[e]=a,a}}function X5(e){return void 0===e&&(e=10),function(t){return Math.ceil(V5(t,1e-6,1)*e)*(1/e)}}var Y5=function(){var e=.1;function t(e,t){return 1-3*t+3*e}function i(e,t){return 3*t-6*e}function n(e){return 3*e}function r(e,r,a){return((t(r,a)*e+i(r,a))*e+n(r))*e}function a(e,r,a){return 3*t(r,a)*e*e+2*i(r,a)*e+n(r)}return function(t,i,n,o){if(0<=t&&t<=1&&0<=n&&n<=1){var s=new Float32Array(11);if(t!==i||n!==o)for(var l=0;l<11;++l)s[l]=r(l*e,t,n);return function(e){return t===i&&n===o||0===e||1===e?e:r(c(e),i,o)}}function c(i){for(var o=0,l=1;10!==l&&s[l]<=i;++l)o+=e;--l;var c=o+(i-s[l])/(s[l+1]-s[l])*e,d=a(c,t,n);return d>=.001?function(e,t,i,n){for(var o=0;o<4;++o){var s=a(t,i,n);if(0===s)return t;t-=(r(t,i,n)-e)/s}return t}(i,c,t,n):0===d?c:function(e,t,i,n,a){var o,s,l=0;do{(o=r(s=t+(i-t)/2,n,a)-e)>0?i=s:t=s}while(Math.abs(o)>1e-7&&++l<10);return s}(i,o,o+e,t,n)}}}(),Q5=function(){var e={linear:function(){return function(e){return e}}},t={Sine:function(){return function(e){return 1-Math.cos(e*Math.PI/2)}},Circ:function(){return function(e){return 1-Math.sqrt(1-e*e)}},Back:function(){return function(e){return e*e*(3*e-2)}},Bounce:function(){return function(e){for(var t,i=4;e<((t=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}},Elastic:function(e,t){void 0===e&&(e=1),void 0===t&&(t=.5);var i=V5(e,1,10),n=V5(t,.1,2);return function(e){return 0===e||1===e?e:-i*Math.pow(2,10*(e-1))*Math.sin((e-1-n/(2*Math.PI)*Math.asin(1/i))*(2*Math.PI)/n)}}};return["Quad","Cubic","Quart","Quint","Expo"].forEach(function(e,i){t[e]=function(){return function(e){return Math.pow(e,i+2)}}}),Object.keys(t).forEach(function(i){var n=t[i];e["easeIn"+i]=n,e["easeOut"+i]=function(e,t){return function(i){return 1-n(e,t)(1-i)}},e["easeInOut"+i]=function(e,t){return function(i){return i<.5?n(e,t)(2*i)/2:1-n(e,t)(-2*i+2)/2}}}),e}();function K5(e,t){if(H5.fnc(e))return e;var i=e.split("(")[0],n=Q5[i],r=G5(e);switch(i){case"spring":return q5(e,t);case"cubicBezier":return W5(Y5,r);case"steps":return W5(X5,r);default:return W5(n,r)}}function Z5(e){try{return document.querySelectorAll(e)}catch(t){return}}function J5(e,t){for(var i=e.length,n=arguments.length>=2?arguments[1]:void 0,r=[],a=0;a<i;a++)if(a in e){var o=e[a];t.call(n,o,a,e)&&r.push(o)}return r}function $5(e){return e.reduce(function(e,t){return e.concat(H5.arr(t)?$5(t):t)},[])}function e6(e){return H5.arr(e)?e:(H5.str(e)&&(e=Z5(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function t6(e,t){return e.some(function(e){return e===t})}function i6(e){var t={};for(var i in e)t[i]=e[i];return t}function n6(e,t){var i=i6(e);for(var n in e)i[n]=t.hasOwnProperty(n)?t[n]:e[n];return i}function r6(e,t){var i=i6(e);for(var n in t)i[n]=H5.und(e[n])?t[n]:e[n];return i}function a6(e){return H5.rgb(e)?function(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}(e):H5.hex(e)?function(e){var t=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,i,n){return t+t+i+i+n+n}),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return"rgba("+parseInt(i[1],16)+","+parseInt(i[2],16)+","+parseInt(i[3],16)+",1)"}(e):H5.hsl(e)?function(e){var t,i,n,r=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),a=parseInt(r[1],10)/360,o=parseInt(r[2],10)/100,s=parseInt(r[3],10)/100,l=r[4]||1;function c(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}if(0==o)t=i=n=s;else{var d=s<.5?s*(1+o):s+o-s*o,u=2*s-d;t=c(u,d,a+1/3),i=c(u,d,a),n=c(u,d,a-1/3)}return"rgba("+255*t+","+255*i+","+255*n+","+l+")"}(e):void 0}function o6(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function s6(e,t){return H5.fnc(e)?e(t.target,t.id,t.total):e}function l6(e,t){return e.getAttribute(t)}function c6(e,t,i){if(t6([i,"deg","rad","turn"],o6(t)))return t;var n=U5.CSS[t+i];if(!H5.und(n))return n;var r=document.createElement(e.tagName),a=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;a.appendChild(r),r.style.position="absolute",r.style.width=100+i;var o=100/r.offsetWidth;a.removeChild(r);var s=o*parseFloat(t);return U5.CSS[t+i]=s,s}function d6(e,t,i){if(t in e.style){var n=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=e.style[t]||getComputedStyle(e).getPropertyValue(n)||"0";return i?c6(e,r,i):r}}function u6(e,t){return H5.dom(e)&&!H5.inp(e)&&(l6(e,t)||H5.svg(e)&&e[t])?"attribute":H5.dom(e)&&t6(F5,t)?"transform":H5.dom(e)&&"transform"!==t&&d6(e,t)?"css":null!=e[t]?"object":void 0}function h6(e){if(H5.dom(e)){for(var t,i=e.style.transform||"",n=/(\w+)\(([^)]*)\)/g,r=new Map;t=n.exec(i);)r.set(t[1],t[2]);return r}}function p6(e,t,i,n){var r=j5(t,"scale")?1:0+function(e){return j5(e,"translate")||"perspective"===e?"px":j5(e,"rotate")||j5(e,"skew")?"deg":void 0}(t),a=h6(e).get(t)||r;return i&&(i.transforms.list.set(t,a),i.transforms.last=t),n?c6(e,a,n):a}function f6(e,t,i,n){switch(u6(e,t)){case"transform":return p6(e,t,n,i);case"css":return d6(e,t,i);case"attribute":return l6(e,t);default:return e[t]||0}}function m6(e,t){var i=/^(\*=|\+=|-=)/.exec(e);if(!i)return e;var n=o6(e)||0,r=parseFloat(t),a=parseFloat(e.replace(i[0],""));switch(i[0][0]){case"+":return r+a+n;case"-":return r-a+n;case"*":return r*a+n}}function g6(e,t){if(H5.col(e))return a6(e);if(/\s/g.test(e))return e;var i=o6(e),n=i?e.substr(0,e.length-i.length):e;return t?n+t:n}function v6(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function y6(e){for(var t,i=e.points,n=0,r=0;r<i.numberOfItems;r++){var a=i.getItem(r);r>0&&(n+=v6(t,a)),t=a}return n}function b6(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return function(e){return 2*Math.PI*l6(e,"r")}(e);case"rect":return function(e){return 2*l6(e,"width")+2*l6(e,"height")}(e);case"line":return function(e){return v6({x:l6(e,"x1"),y:l6(e,"y1")},{x:l6(e,"x2"),y:l6(e,"y2")})}(e);case"polyline":return y6(e);case"polygon":return function(e){var t=e.points;return y6(e)+v6(t.getItem(t.numberOfItems-1),t.getItem(0))}(e)}}function x6(e,t){var i=t||{},n=i.el||function(e){for(var t=e.parentNode;H5.svg(t)&&H5.svg(t.parentNode);)t=t.parentNode;return t}(e),r=n.getBoundingClientRect(),a=l6(n,"viewBox"),o=r.width,s=r.height,l=i.viewBox||(a?a.split(" "):[0,0,o,s]);return{el:n,viewBox:l,x:l[0]/1,y:l[1]/1,w:o/l[2],h:s/l[3]}}function w6(e,t){function i(i){void 0===i&&(i=0);var n=t+i>=1?t+i:0;return e.el.getPointAtLength(n)}var n=x6(e.el,e.svg),r=i(),a=i(-1),o=i(1);switch(e.property){case"x":return(r.x-n.x)*n.w;case"y":return(r.y-n.y)*n.h;case"angle":return 180*Math.atan2(o.y-a.y,o.x-a.x)/Math.PI}}function S6(e,t){var i=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,n=g6(H5.pth(e)?e.totalLength:e,t)+"";return{original:n,numbers:n.match(i)?n.match(i).map(Number):[0],strings:H5.str(e)||t?n.split(i):[]}}function _6(e){return J5(e?$5(H5.arr(e)?e.map(e6):e6(e)):[],function(e,t,i){return i.indexOf(e)===t})}function C6(e){var t=_6(e);return t.map(function(e,i){return{target:e,id:i,total:t.length,transforms:{list:h6(e)}}})}function E6(e,t){var i=i6(t);if(/^spring/.test(i.easing)&&(i.duration=q5(i.easing)),H5.arr(e)){var n=e.length;2===n&&!H5.obj(e[0])?e={value:e}:H5.fnc(t.duration)||(i.duration=t.duration/n)}var r=H5.arr(e)?e:[e];return r.map(function(e,i){var n=H5.obj(e)&&!H5.pth(e)?e:{value:e};return H5.und(n.delay)&&(n.delay=i?0:t.delay),H5.und(n.endDelay)&&(n.endDelay=i===r.length-1?t.endDelay:0),n}).map(function(e){return r6(e,i)})}function A6(e,t){var i=[],n=t.keyframes;for(var r in n&&(t=r6(function(e){for(var t=J5($5(e.map(function(e){return Object.keys(e)})),function(e){return H5.key(e)}).reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[]),i={},n=function(n){var r=t[n];i[r]=e.map(function(e){var t={};for(var i in e)H5.key(i)?i==r&&(t.value=e[i]):t[i]=e[i];return t})},r=0;r<t.length;r++)n(r);return i}(n),t)),t)H5.key(r)&&i.push({name:r,tweens:E6(t[r],e)});return i}function M6(e,t){var i;return e.tweens.map(function(n){var r=function(e,t){var i={};for(var n in e){var r=s6(e[n],t);H5.arr(r)&&(r=r.map(function(e){return s6(e,t)}),1===r.length&&(r=r[0])),i[n]=r}return i.duration=parseFloat(i.duration),i.delay=parseFloat(i.delay),i}(n,t),a=r.value,o=H5.arr(a)?a[1]:a,s=o6(o),l=f6(t.target,e.name,s,t),c=i?i.to.original:l,d=H5.arr(a)?a[0]:c,u=o6(d)||o6(l),h=s||u;return H5.und(o)&&(o=c),r.from=S6(d,h),r.to=S6(m6(o,d),h),r.start=i?i.end:0,r.end=r.start+r.delay+r.duration+r.endDelay,r.easing=K5(r.easing,r.duration),r.isPath=H5.pth(a),r.isColor=H5.col(r.from.original),r.isColor&&(r.round=1),i=r,r})}var T6={css:function(e,t,i){return e.style[t]=i},attribute:function(e,t,i){return e.setAttribute(t,i)},object:function(e,t,i){return e[t]=i},transform:function(e,t,i,n,r){if(n.list.set(t,i),t===n.last||r){var a="";n.list.forEach(function(e,t){a+=t+"("+e+") "}),e.style.transform=a}}};function P6(e,t){C6(e).forEach(function(e){for(var i in t){var n=s6(t[i],e),r=e.target,a=o6(n),o=f6(r,i,a,e),s=m6(g6(n,a||o6(o)),o),l=u6(r,i);T6[l](r,i,s,e.transforms,!0)}})}function D6(e,t){return J5($5(e.map(function(e){return t.map(function(t){return function(e,t){var i=u6(e.target,t.name);if(i){var n=M6(t,e),r=n[n.length-1];return{type:i,property:t.name,animatable:e,tweens:n,duration:r.end,delay:n[0].delay,endDelay:r.endDelay}}}(e,t)})})),function(e){return!H5.und(e)})}function O6(e,t){var i=e.length,n=function(e){return e.timelineOffset?e.timelineOffset:0},r={};return r.duration=i?Math.max.apply(Math,e.map(function(e){var t,i,r,a;let o=null!==(t=e.startOnceDelay)&&void 0!==t?t:0,s=null!==(i=e.pingPongDelayCorrection)&&void 0!==i?i:0,l=null!==(r=e.pingPongEndDelayCorrection)&&void 0!==r?r:0;return n(e)+o+s+l+e.duration*(null!==(a=e.loop)&&void 0!==a?a:1)})):t.duration,r.delay=i?Math.min.apply(Math,e.map(function(e){var t,i;let r=null!==(t=e.startOnceDelay)&&void 0!==t?t:0,a=null!==(i=e.pingPongDelayCorrection)&&void 0!==i?i:0;return n(e)+r+a+e.delay})):t.delay,r.endDelay=i?r.duration-Math.max.apply(Math,e.map(function(e){var t,i,r,a;let o=null!==(t=e.startOnceDelay)&&void 0!==t?t:0,s=null!==(i=e.pingPongDelayCorrection)&&void 0!==i?i:0,l=null!==(r=e.pingPongEndDelayCorrection)&&void 0!==r?r:0;return n(e)+o+s+e.duration*(null!==(a=e.loop)&&void 0!==a?a:1)-e.endDelay-l})):t.endDelay,r}var I6=0;var k6,R6=[],z6=[],L6=function(){let e=0,t=!0;function i(e){let t=R6.length;if(t){let n=0;for(;n<t;){let i=R6[n];i.paused?(R6.splice(n,1),t--):(i.tick(e),n++)}k6=requestAnimationFrame(i)}else k6&&(cancelAnimationFrame(k6),k6=null)}return{isUsingInternalRaf:t,play:function(){e=performance.now(),k6=requestAnimationFrame(i)},update:function(t){e+=t,i(e)}}}();function B6(e){void 0===e&&(e={});var t,i,n=0,r=0,a=0,o=0,s=null;function l(e){var t=window.Promise&&new Promise(function(e){return s=e});return e.finished=t,t}var c=function(e){var t=n6(B5,e),i=n6(N5,e),n=A6(i,e),r=C6(e.targets),a=D6(r,n),o=O6(a,i),s=I6;return I6++,r6(t,{id:s,children:[],animatables:r,animations:a,duration:o.duration,delay:o.delay,endDelay:o.endDelay,startOnceDelay:i.startOnceDelay,pingPongDelayCorrection:i.pingPongDelayCorrection,pingPongEndDelayCorrection:i.pingPongEndDelayCorrection})}(e);l(c);function d(){var e=c.direction;"alternate"!==e&&(c.direction="normal"!==e?"normal":"reverse"),c.reversed=!c.reversed,i.forEach(function(e){(1===e.loop||e.loop%2===0)&&(e.reversed=c.reversed)})}function u(e){return c.reversed?c.duration-e:e}function h(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&(c.reversed?t.seek(t.duration*t.loop-(e-t.timelineOffset-t.pingPongDelayCorrection),i):t.seek(e-t.timelineOffset-t.startOnceDelay-t.pingPongDelayCorrection,i))}function p(e){var t=0,i=c.animations,n=i.length;for("alternate"!==c.direction&&"alternate"===(null===(r=c.parent)||void 0===r?void 0:r.direction)?!1===(null===(a=c.parent)||void 0===a?void 0:a.rewind)&&!0===c.reversePlayback&&!1===c.rewind&&(e=null!==(o=c.parent)&&void 0!==o&&o.reversed&&"alternate"===c.direction?c.duration-c.delay+c.endDelay-e:c.duration+c.delay-c.endDelay-e):g(!1,null===(s=c.parent)||void 0===s?void 0:s.rewind,c.rewind,null===(l=c.parent)||void 0===l?void 0:l.reversePlayback,c.reversePlayback)&&(e=null!==(d=c.parent)&&void 0!==d&&d.reversed&&"alternate"===c.direction?c.duration-c.delay+c.endDelay-e:c.duration+c.delay-c.endDelay-e);t<n;){var r,a,o,s,l,d,u,h=i[t],p=h.animatable,f=h.tweens,m=f.length-1,v=f[m];let n;m&&(v=J5(f,function(t){return e<t.end})[0]||v),n=null!==(u=c.parent)&&void 0!==u&&u.reversed&&"alternate"===c.direction?V5(e-v.start-v.endDelay,0,v.duration)/v.duration:V5(e-v.start-v.delay,0,v.duration)/v.duration;for(var y=isNaN(n)?1:v.easing(n),b=v.to.strings,x=v.round,w=[],S=v.to.numbers.length,_=void 0,C=0;C<S;C++){var E,A,M,T=void 0;let e,t;"alternate"!==c.direction?!1===(null===(E=c.parent)||void 0===E?void 0:E.rewind)&&!0===c.reversePlayback&&!1===c.rewind?(e=v.to.numbers[C],t=v.from.numbers[C]||0):(t=v.to.numbers[C],e=v.from.numbers[C]||0):g(!0,null===(A=c.parent)||void 0===A?void 0:A.rewind,c.rewind,null===(M=c.parent)||void 0===M?void 0:M.reversePlayback,c.reversePlayback)?(e=v.to.numbers[C],t=v.from.numbers[C]||0):(t=v.to.numbers[C],e=v.from.numbers[C]||0),T=v.isPath?w6(v.value,y*t):e+y*(t-e),x&&(v.isColor&&C>2||(T=Math.round(T*x)/x)),w.push(T)}var P=b.length;if(P){_=b[0];for(var D=0;D<P;D++){b[D];var O=b[D+1],I=w[D];isNaN(I)||(_+=O?I+O:I+" ")}}else _=w[0];T6[h.type](p.target,h.property,_,p.transforms),h.currentValue=_,t++}}function f(e){c[e]&&!c.passThrough&&c[e](c)}let m={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function g(e,t,i,n,r){return m[e<<4|t<<3|i<<2|n<<1|r]}function v(e){var t;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var a=c.duration;let m=c.delay,g=a-c.endDelay;(null===(t=c.parent)||void 0===t?void 0:t.reversed)&&"alternate"===c.direction&&(m=c.endDelay,g=a-c.delay);var v=u(e);if(c.progress=V5(v/a*100,0,100),r||(c.reversePlayback=v<c.currentTime),o&&function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(c.reversed)for(var n=o;n--;)h(e,i[n],t);else for(var r=0;r<o;r++)h(e,i[r],t)}(v,r),!c.began&&c.currentTime>=0&&(c.began=!0,f("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,f("loopBegin")),(c.reversed||v>=0)&&v<=m&&0!==c.currentTime&&(p(0),f("change")),(v>=g&&c.currentTime!==a+c.pingPongDelayCorrection||!a)&&(p(a),f("change")),v>m&&v<g?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,f("changeBegin")),p(v),f("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,f("change"),o&&f("timelineChangeComplete")):c.began&&v>g&&f("changeComplete"),c.currentTime=V5(v,0,a+c.pingPongDelayCorrection),c.began&&f("update"),e>=a)if(c.remaining&&!0!==c.remaining&&c.remaining--,c.remaining){n+=o?c.duration/B6.speed:c.duration;for(let e of i)e.setStartTime(0),e.remaining=e.loop;f("loopComplete"),c.loopBegan=!1,"alternate"===c.direction?d():o&&(c.direction="normal",c.reversed=!1,i.forEach(function(e){return e.reversed=!1}))}else c.paused=!0,c.completed||(c.completed=!0,f("loopComplete"),f("complete"),!c.passThrough&&"Promise"in window&&(s(),l(c)))}return c.reset=function(){var e=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed="reverse"===e,c.remaining=c.loop,i=c.children;for(var t=o=i.length;t--;)c.children[t].reset();p(c.reversed?c.duration:0)},c.setStartTime=function(e){n=e},c.set=function(e,t){return P6(e,t),c},c.tick=function(e){a=e,n||(n=a),v((a+(r-n))*B6.speed)},c.seek=function(e){v(e-n,arguments.length>1&&void 0!==arguments[1]&&arguments[1])},c.pause=function(e){c.paused=!0,o&&(t=null!==e&&void 0!==e?e:performance.now())},c.play=function(e){!c.paused||(c.completed&&c.reset(),c.paused=!1,R6.push(c),o&&void 0!==t&&(n+=(null!==e&&void 0!==e?e:performance.now())-t),!k6&&L6.isUsingInternalRaf&&L6.play())},c.reverse=function(){d(),c.completed=!c.reversed,n=0,r=u(c.currentTime)*(1/B6.speed)},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function N6(e,t){for(var i=t.length;i--;)t6(e,t[i].animatable.target)&&t.splice(i,1)}typeof document<"u"&&document.addEventListener("visibilitychange",function(e){document.hidden?(R6.forEach(function(t){return t.pause(e.timeStamp)}),z6=R6.slice(0),B6.running=R6=[]):z6.forEach(function(t){return t.play(e.timeStamp)})}),B6.version="3.2.0",B6.speed=1,B6.running=R6,B6.remove=function(e){for(var t=_6(e),i=R6.length;i--;){var n=R6[i],r=n.animations,a=n.children;N6(t,r);for(var o=a.length;o--;){var s=a[o],l=s.animations;N6(t,l),!l.length&&!s.children.length&&a.splice(o,1)}!r.length&&!a.length&&n.pause()}},B6.get=f6,B6.set=P6,B6.convertPx=c6,B6.path=function(e,t){var i=H5.str(e)?Z5(e)[0]:e,n=t||100;return function(e){return{property:e,el:i,svg:x6(i),totalLength:b6(i)*(n/100)}}},B6.setDashoffset=function(e){var t=b6(e);return e.setAttribute("stroke-dasharray",t),t},B6.stagger=function(e,t){void 0===t&&(t={});var i=t.direction||"normal",n=t.easing?K5(t.easing):null,r=t.grid,a=t.axis,o=t.from||0,s="first"===o,l="center"===o,c="last"===o,d=H5.arr(e),u=parseFloat(d?e[0]:e),h=d?parseFloat(e[1]):0,p=o6(d?e[1]:e)||0,f=t.start||0+(d?u:0),m=[],g=0;return function(e,t,v){if(s&&(o=0),l&&(o=(v-1)/2),c&&(o=v-1),!m.length){for(var y=0;y<v;y++){if(r){var b=l?(r[0]-1)/2:o%r[0],x=l?(r[1]-1)/2:Math.floor(o/r[0]),w=b-y%r[0],S=x-Math.floor(y/r[0]),_=Math.sqrt(w*w+S*S);"x"===a&&(_=-w),"y"===a&&(_=-S),m.push(_)}else m.push(Math.abs(o-y));g=Math.max.apply(Math,m)}n&&(m=m.map(function(e){return n(e/g)*g})),"reverse"===i&&(m=m.map(function(e){return a?e<0?-1*e:-e:Math.abs(g-e)}))}return f+(d?(h-u)/g:u)*(Math.round(100*m[t])/100)+p}},B6.timeline=function(e){void 0===e&&(e={});var t=B6(e);return t.duration=0,t.add=function(i,n){var r=R6.indexOf(t),a=t.children;function o(e){e.passThrough=!0}r>-1&&R6.splice(r,1);for(var s=0;s<a.length;s++)o(a[s]);var l=r6(i,n6(N5,e));l.targets=l.targets||e.targets;var c=t.duration;l.autoplay=!1,l.timelineOffset=H5.und(n)?c:m6(n,c),o(t);var d=B6(l);o(d),a.push(d),d.parent=t;var u=O6(a,e);return t.delay=u.delay,t.endDelay=u.endDelay,t.duration=u.duration,!0===d.loop&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t},B6.easing=K5,B6.penner=Q5,B6.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var F6=B6,U6=new j_,V6=new j_,j6=new V_;function W6(e,t,i,n,r,a){var o,s;let l=void 0!==i[e]?i[e]:void 0,c=n[e];if(null==c)return;let d=null!=l?"string"==typeof l?Number(null!==(o=r.getVariable(l))&&void 0!==o?o:0):l:t[e],u="string"==typeof c?Number(null!==(s=r.getVariable(c))&&void 0!==s?s:0):c;return d!==u?{update:i=>{let n=h_.lerp(d,u,i);t[e]=a?Math.trunc(n):n},start:()=>{t[e]=d},end:()=>{t[e]=u}}:void 0}function H6(e,t,i,n,r,a){let o=i[e]?i[e]:void 0,s=n[e];if(!s)return;let l=t[e],c=[...null!==o&&void 0!==o?o:l].map(e=>{var t;return"string"==typeof e?Number(null!==(t=r.getVariable(e))&&void 0!==t?t:0):e}),d=[...s].map(e=>{var t;return"string"==typeof e?Number(null!==(t=r.getVariable(e))&&void 0!==t?t:0):e});return c.length!==d.length||FB(c,d)?void 0:{update:i=>{c.forEach((n,r)=>{let o=h_.lerp(n,d[r],i);t[e][r]=a?Math.trunc(o):o})},start:()=>{Object.assign(t[e],c)},end:()=>{Object.assign(t[e],d)}}}function G6(e,t,i){return t.forEach((t,n)=>{var r;e.setComponent(n,"string"==typeof t?Number(null!==(r=i.getVariable(t))&&void 0!==r?r:0):t)}),e}function q6(e,t,i,n,r){let a=i[e]?i[e]:void 0,o=n[e];if(!o)return;let s=t[e],l=a?G6(new j_,a,r):s.clone(),c=G6(new j_,o,r);return l.equals(c)?void 0:{update:e=>{s.lerpVectors(l,c,e)},start:()=>{s.copy(l)},end:()=>{s.copy(c)}}}function X6(e,t,i){return t.forEach((t,n)=>{var r;e.setComponent(n,"string"==typeof t?Number(null!==(r=i.getVariable(t))&&void 0!==r?r:0):t)}),e}function Y6(e,t,i,n,r){let a=i[e]?i[e]:void 0,o=n[e];if(!o)return;let s=t[e],l=!(s instanceof p_),c=s instanceof p_?s:(new p_).fromArray(s),d=a?X6(new p_,a,r):c.clone(),u=X6(new p_,o,r);return d.equals(u)?void 0:{update:i=>{c.lerpVectors(d,u,i),l&&(t[e]=c.toArray())},start:()=>{c.copy(d),l&&(t[e]=c.toArray())},end:()=>{c.copy(u),l&&(t[e]=c.toArray())}}}function Q6(e,t,i,n,r){let a=i[e]?i[e]:void 0,o=n[e];if(!o)return;let s=t[e],l=new kQ(s.r,s.g,s.b,s.a),c=a?"string"==typeof a?r.getColor(a).clone():new kQ(a.r,a.g,a.b,a.a):l.clone(),d="string"==typeof o?r.getColor(o).clone():new kQ(o.r,o.g,o.b,o.a);return c.equals(d)?void 0:{update:i=>{l.lerpColors(c,d,i);let n=h_.lerp(c.a,d.a,i);l.a=n,t[e]={r:l.r,g:l.g,b:l.b,a:l.a}},start:()=>{l.copy(c)},end:()=>{l.copy(d)}}}function K6(e,t,i,n,r){return"number"==typeof t[e]?W6(e,t,null!==i&&void 0!==i?i:{},n,r):Array.isArray(t[e])?H6(e,t,null!==i&&void 0!==i?i:{},n,r):void 0}function Z6(e,t,i,n){let r=[];if(!("geometry"in i))return r;let a=e.geometry.userData.parameters,o="geometry"in t?t.geometry:{},s=i.geometry;if(e instanceof d$){let t=function(e,t,i,n){var r;if(void 0===i.scaleBaked)return;let a=(null!==(r=t.scaleBaked)&&void 0!==r?r:e.data.geometry.scaleBaked).map(e=>{var t;return"string"==typeof e?Number(null!==(t=n.getVariable(e))&&void 0!==t?t:0):e}),o=i.scaleBaked.map(e=>{var t;return"string"==typeof e?Number(null!==(t=n.getVariable(e))&&void 0!==t?t:0):e});if(xV.isEqual(a,o))return;let s=[];return s.push({update:t=>{e.updateGeometryInteractions({scaleBaked:[h_.lerp(a[0],o[0],t),h_.lerp(a[1],o[1],t),h_.lerp(a[2],o[2],t)]},n),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},start:()=>{e.updateGeometryInteractions({scaleBaked:a},n),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},end:()=>{e.updateGeometryInteractions({scaleBaked:o},n),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()}}),s}(e,o,s,n);t&&r.push(...t)}else{let t={};if(Object.assign(t,KB(a,lW),KB(o,lW)),lW.forEach(e=>{let i=K6(e,t,o,s,n);i&&r.push(i)}),e instanceof U3){Object.assign(t,{extrusion:c({},a.extrusion)});let e=function(e,t,i,n){var r;if(!i.extrusion)return;let a=e.extrusion,o=null!==(r=t.extrusion)&&void 0!==r?r:{},s=i.extrusion,l=[];return bj.forEach(e=>{let t=K6(e,a,o,s,n);t&&l.push(t)}),l}(t,o,s,n);e&&r.push(...e)}r.length&&r.push({update:i=>{e.updateGeometryInteractions(t,n),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},start:i=>{e.updateGeometryInteractions(t,n),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},end:i=>{e.updateGeometryInteractions(t,n),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()}})}return r}function J6(e,t,i,n){let r=[];if(void 0!==i.intensity){let a=W6("intensity",e,t,i,n);a&&r.push(a)}if(void 0!==i.color){let a=function(e,t,i,n,r){let a=i[e]?i[e]:void 0,o=n[e];if(!o)return;let s=t[e],l=a?"string"==typeof a?r.getColor(a).clone():(new D_).setRGB(a.r,a.g,a.b):s.clone(),c="string"==typeof o?r.getColor(o).clone():(new D_).setRGB(o.r,o.g,o.b);if(l.equals(c))return;let d=s.clone();return{update:i=>{var n,r;d.lerpColors(l,c,i),null===(n=t[e])||void 0===n||null===(r=n.copy)||void 0===r||r.call(n,d)},start:()=>{d.copy(l)},end:()=>{d.copy(c)}}}("color",e,t,i,n);a&&r.push(a)}return r}function $6(e,t,i,n){let r=[],a=rJ(i,n)||!!t.layers&&rJ(t,n);r.push(function(e,t){return{update:()=>{e.transparent=t}}}(e,a));for(let c of e.layers){var o,s,l;let e=null===(o=t.layers)||void 0===o?void 0:o.data(c.uuid),a=i.layers.data(c.uuid);if(!a||"light"!==c.type&&(null!==(s=c.visible)&&void 0!==s&&!s||null!==(l=a.visible)&&void 0!==l&&!l))continue;let d=c.getNames().filter(e=>!uj.some(t=>e.includes(t)));for(let t of d)try{let i,o=c.getValue(t);if("colors"===t)i=o8(c,e,a,t);else if(Array.isArray(o))"steps"===t&&(i=a8(c,e,a,t));else if("number"==typeof o)i=e8(c,e,a,t,n);else{if("boolean"==typeof o)continue;o instanceof p_?i=t8(c,e,a,t):o instanceof j_?i=i8(c,e,a,t,n):o instanceof kQ?i=r8(c,e,a,t,n):o instanceof D_?i=n8(c,e,a,t,n):"isTexture"in o&&(i=s8(c,e,a,t))}i&&(Array.isArray(i)?r.push(...i):r.push(i))}catch(MV){console.error("lerpMaterial: unexpected material layer for ".concat(t),MV)}}return r}function e8(e,t,i,n,r){var a,o;if(!e.hasValue(n)||!(n in i))return;let s=t?t[n]:e.getValue(n),l=i[n],c="string"==typeof s?Number(null!==(a=r.getVariable(s))&&void 0!==a?a:0):s,d="string"==typeof l?Number(null!==(o=r.getVariable(l))&&void 0!==o?o:0):l;return c!==d?{update:t=>{e.setValue(n,h_.lerp(c,d,t))},start:()=>{e.setValue(n,c)},end:()=>{e.setValue(n,d)}}:void 0}function t8(e,t,i,n){if(!e.hasValue(n)||!(n in i))return;let r=e.getValue(n),a=t?(new p_).fromArray(t[n]):r.clone(),o=(new p_).fromArray(i[n]);return a.equals(o)?void 0:{update:e=>{r.lerpVectors(a,o,e)},start:()=>{r.copy(a)},end:()=>{r.copy(o)}}}function i8(e,t,i,n,r){if(!e.hasValue(n)||!(n in i))return;let a=e.getValue(n),o=t?t[n]:void 0,s=i[n],l=o?G6(new j_,o,r):a.clone(),c=G6(new j_,s,r);return l.equals(c)?void 0:{update:e=>{a.lerpVectors(l,c,e)},start:()=>{a.copy(l)},end:()=>{a.copy(c)}}}function n8(e,t,i,n,r){if(!e.hasValue(n)||!(n in i))return;let a=t?t[n]:void 0,o=i[n],s=e.getValue(n),l=a?"string"==typeof a?r.getColor(a).clone():(new D_).setRGB(a.r,a.g,a.b):s.clone(),c="string"==typeof o?r.getColor(o).clone():(new D_).setRGB(o.r,o.g,o.b);if(l.equals(c))return;let d=s.clone();return{update:t=>{e.getValue(n)!==d&&e.setValue(n,d),d.lerpColors(l,c,t)},start:()=>{d.copy(l)},end:()=>{d.copy(c)}}}function r8(e,t,i,n,r){if(!e.hasValue(n)||!(n in i))return;let a=t?t[n]:void 0,o=i[n],s=e.getValue(n),l=a?"string"==typeof a?r.getColor(a).clone():(new D_).setRGB(a.r,a.g,a.b):s.clone(),c="string"==typeof o?r.getColor(o).clone():new kQ(o.r,o.g,o.b,o.a);if(l.equals(c))return;let d=s.clone();return{update:t=>{e.getValue(n)!==d&&e.setValue(n,d),d.lerpColors(l,c,t)},start:()=>{d.copy(l)},end:()=>{d.copy(c)}}}function a8(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(!e.hasValue(n)||!(n in i))return;let r=[],a=e.getValue(n),o=t?t[n]:a,s=i[n];return FB(o,s)||r.push({update:t=>{let i=[...a];for(let e=0;e<a.length;++e){let n=o[e],r=s[e];i[e]=h_.lerp(n,r,t)}e.setValue(n,i)},start:()=>{e.setValue(n,o)},end:()=>{e.setValue(n,s)}}),r.length?r:void 0}function o8(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"colors";if(!e.hasValue(n)||!(n in i))return;let r=[],a=e.getValue(n),o=t?t[n]:a.map(e=>e.toArray()),s=i[n];for(let l=0;l<a.length;++l){let e=[...o[l]],t=[...s[l]];SV.isEqual(e,t)||r.push({update:i=>{a[l].fromArray(SV.lerp(e,t,i))},start:()=>{a[l].fromArray(e)},end:()=>{a[l].fromArray(t)}})}return r.length?r:void 0}function s8(e,t,i){var n,r,a,o,s,l;let c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"texture";if(!e.hasValue(c)||!(c in i))return;let d=e.getNode("rotation"),u=null!==(n=null===t||void 0===t||null===(r=t[c])||void 0===r?void 0:r.rotation)&&void 0!==n?n:0,h=null!==(a=null===(o=i[c])||void 0===o?void 0:o.rotation)&&void 0!==a?a:0;if(d&&u!==h)return{update:e=>{d.value=h_.lerp(u,h,e)*h_.DEG2RAD},start:()=>{d.value=u*h_.DEG2RAD},end:()=>{d.value=h*h_.DEG2RAD}};let p=e.getNode("mat");if(!p)return;let f=t?t[c]:p,m=i[c],g=[...f.repeat],v=[...f.offset],y=[...m.repeat],b=[...m.offset],x=null!==(s=f.rotation)&&void 0!==s?s:0,w=null!==(l=m.rotation)&&void 0!==l?l:0;return bV.isEqual(g,y)&&bV.isEqual(v,b)&&x===w?void 0:{update:e=>{p.repeat=bV.lerp(g,y,e),p.offset=bV.lerp(v,b,e),p.rotation=h_.lerp(x,w,e),p.updateMatrix()},start:()=>{p.repeat=[...g],p.offset=[...v],p.rotation=x,p.updateMatrix()},end:()=>{p.repeat=[...y],p.offset=[...b],p.rotation=w,p.updateMatrix()}}}var l8=new j_,c8=new TC;function d8(e,t,i,n,r){var a,o,s,l,c,d,u,h,p,f,m,g,v,y,b,x,w,S;let _,C,E,A,M,T,P,D,O=[];if(e instanceof j2?(_=Y6("position",e,t,i,r),_&&O.push(_),E=W6("rotation",e,t,i,r),E&&O.push(E),A=Y6("shear",e,t,i,r),A&&O.push(A)):(D={slide:null!==(a=null!==(o=null!==(s=null===(l=t.pathSnapping)||void 0===l?void 0:l.slide)&&void 0!==s?s:null===(c=e.updatedPathSnapping)||void 0===c?void 0:c.slide)&&void 0!==o?o:null===(d=e.dataPatched.pathSnapping)||void 0===d?void 0:d.slide)&&void 0!==a?a:0,offset:null!==(u=null!==(h=null!==(p=null===(f=t.pathSnapping)||void 0===f?void 0:f.offset)&&void 0!==p?p:null===(m=e.updatedPathSnapping)||void 0===m?void 0:m.offset)&&void 0!==h?h:null===(g=e.dataPatched.pathSnapping)||void 0===g?void 0:g.offset)&&void 0!==u?u:0},T=W6("slide",D,null!==(v=null!==(y=t.pathSnapping)&&void 0!==y?y:e.updatedPathSnapping)&&void 0!==v?v:e.dataPatched.pathSnapping,null!==(b=i.pathSnapping)&&void 0!==b?b:e.dataPatched.pathSnapping,r),T&&O.push(T),P=W6("offset",D,null!==(x=null!==(w=t.pathSnapping)&&void 0!==w?w:e.updatedPathSnapping)&&void 0!==x?x:e.dataPatched.pathSnapping,null!==(S=i.pathSnapping)&&void 0!==S?S:e.dataPatched.pathSnapping,r),P&&O.push(P),!T&&!P&&(_=q6("position",e,t,i,r),_&&O.push(_),C=q6("scale",e,t,i,r),C&&O.push(C),E=function(e,t,i,n,r){var a;let o=null!==t&&void 0!==t&&t.rotation?t.rotation.map(e=>{var t;return("string"==typeof e?Number(null!==(t=r.getVariable(e))&&void 0!==t?t:0):e)*h_.DEG2RAD}):void 0,s=null===(a=i.rotation)||void 0===a?void 0:a.map(e=>{var t;return("string"==typeof e?Number(null!==(t=r.getVariable(e))&&void 0!==t?t:0):e)*h_.DEG2RAD});if(!s)return;let l=o?(new j_).fromArray(o):(new j_).setFromEuler(e.rotation),c=(new j_).fromArray(s);if(l.equals(c))return;let d=l8.subVectors(c,l);if(n&&d.toArray().every(e=>Math.abs(e)<2*Math.PI)){let t=(new V_).setFromEuler(c8.setFromVector3(l)),i=(new V_).setFromEuler(c8.setFromVector3(c));return{update:n=>{!function(e,t,i,n){if(0===n)return i.copy(e);if(1===n)return i.copy(t);let r=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(r>=1)return i.copy(e);let a=1-r*r;if(a<=Number.EPSILON){let r=1-n;return i.w=r*e.w+n*t.w,i.x=r*e.x+n*t.x,i.y=r*e.y+n*t.y,i.z=r*e.z+n*t.z,i.normalize(),i}let o=Math.sqrt(a),s=Math.atan2(o,r),l=Math.sin((1-n)*s)/o,c=Math.sin(n*s)/o;i.w=e.w*l+t.w*c,i.x=e.x*l+t.x*c,i.y=e.y*l+t.y*c,i.z=e.z*l+t.z*c}(t,i,e.quaternion,n)},start:()=>{e.rotation.setFromVector3(l)},end:()=>{e.rotation.setFromVector3(c)}}}return{update:t=>{l8.lerpVectors(l,c,t),e.rotation.setFromVector3(l8)},start:()=>{e.rotation.setFromVector3(l)},end:()=>{e.rotation.setFromVector3(c)}}}(e,t,i,n,r),E&&O.push(E),M=function(e,t,i,n){let r=i[e]?i[e]:void 0,a=n[e];if(!a)return;let o=t[e],s=r?(new yC).fromArray(r):o.clone(),l=new j_,c=new V_,d=new j_;s.decompose(l,c,d);let u=(new yC).fromArray(a),h=new j_,p=new V_,f=new j_;return u.decompose(h,p,f),s.equals(u)?void 0:{update:e=>{j6.slerpQuaternions(c,p,e),U6.lerpVectors(l,h,e),V6.lerpVectors(d,f,e),o.compose(U6,j6,V6)},start:()=>{o.compose(l,c,d)},end:()=>{o.compose(h,p,f)}}}("hiddenMatrix",e,t,i),M&&O.push(M))),_||C||E||M||T||P){let i=e instanceof j2?()=>{e.updateWorldMatrix(!0,!1,!0),e.resetBBoxNeedsUpdate()}:()=>{var i;e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),null!==(i=e.parent)&&void 0!==i&&i.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),b0(e)&&x0(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,D))};O.push({update:i,start:i,end:i})}return O}function u8(e,t,i,n){let r=[];if(!("cloner"in i)||!e.cloner)return r;let a=e.cloner,o="cloner"in t?t.cloner:{},s=i.cloner;tj.forEach(e=>{let t;t="count"===e?W6("count",a.parameters,o,s,n,!0):K6(e,a.parameters,null!==o&&void 0!==o?o:{},s,n),t&&r.push(t)});let l=function(e,t,i,n){if("radial"!==e.parameters.type)return;let r=t.radial,a=i.radial;if(!a)return;let o=e.parameters.radial,s=[];return ij.forEach(e=>{let t=K6(e,o,null!==r&&void 0!==r?r:{},a,n);t&&s.push(t)}),s}(a,o,s,n);(null===l||void 0===l?void 0:l.length)&&r.push(...l);let c=function(e,t,i,n){if("linear"!==e.parameters.type)return;let r=t.linear,a=i.linear;if(!a)return;let o=[],s=e.parameters.linear;return nj.forEach(e=>{let t=K6(e,s,null!==r&&void 0!==r?r:{},a,n);t&&o.push(t)}),o}(a,o,s,n);(null===c||void 0===c?void 0:c.length)&&r.push(...c);let d=function(e,t,i,n){if("grid"!==e.parameters.type)return;let r=t.grid,a=i.grid;if(!a)return;let o=[],s=e.parameters.grid;return rj.forEach(e=>{let t;t="count"===e?H6(e,s,null!==r&&void 0!==r?r:{},a,n,!0):K6(e,s,null!==r&&void 0!==r?r:{},a,n),t&&o.push(t)}),o}(a,o,s,n);(null===d||void 0===d?void 0:d.length)&&r.push(...d);let u=function(e,t,i,n){if("toObject"!==e.parameters.type)return;let r=t.toObject,a=i.toObject;if(!a)return;let o=[],s=e.parameters.toObject;return aj.forEach(e=>{let t;t="count"===e?W6(e,s,null!==r&&void 0!==r?r:{},a,n,!0):K6(e,s,null!==r&&void 0!==r?r:{},a,n),t&&o.push(t)}),o}(a,o,s,n);(null===u||void 0===u?void 0:u.length)&&r.push(...u);let h=function(e,t,i,n){if(!e.parameters.randomness)return;let r=t.randomnessObject,a=i.randomnessObject;if(!a)return;let o=[],s=e.parameters.randomnessObject;return oj.forEach(e=>{let t=K6(e,s,null!==r&&void 0!==r?r:{},a,n);t&&o.push(t)}),o}(a,o,s,n);return null!==h&&void 0!==h&&h.length&&r.push(...h),r.length&&r.push({update:()=>{a.update()}}),r}function h8(e,t,i,n,r){let a,o,s,l,d,u,h,p,f,m,g,v,y,b,x,w=[];if("width"in e&&(a=W6("width",e,t,i,r),a&&w.push(a)),"height"in e&&(o=W6("height",e,t,i,r),o&&w.push(o)),e instanceof f3||e instanceof b3){let n=c({},t.fill),a=c({},i.fill);void 0!==n.enabled&&n.enabled!==a.enabled&&(w.push(function(e,t){return{update:()=>{e instanceof f3&&(e.fill.enabled=t)}}}(e,!0)),n.enabled||Object.assign(n,{enabled:!0,color:c(c({},n.color),{},{a:0})}),a.enabled||Object.assign(a,{enabled:!0,color:c(c({},a.color),{},{a:0})})),s=Q6("color",e.fill,n,a,r),s&&w.push(s)}if(e instanceof f3){let n=c({},t.stroke),a=c({},i.stroke);(n.enabled||a.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof f3&&(e.stroke.enabled=t)}}}(e,!0)),n.enabled||Object.assign(n,{enabled:!0,color:c(c({},n.color),{},{a:0})}),a.enabled||Object.assign(a,{enabled:!0,color:c(c({},a.color),{},{a:0})})),l=Q6("color",e.stroke,n,a,r),l&&w.push(l),d=W6("thickness",e.stroke,n,a,r),d&&w.push(d)}if(e instanceof f3){let n=c({},t.dropShadow),a=c({},i.dropShadow);(n.enabled||a.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof f3&&(e.dropShadow.enabled=t)}}}(e,!0)),n.enabled||Object.assign(n,{enabled:!0,color:c(c({},n.color),{},{a:0})}),a.enabled||Object.assign(a,{enabled:!0,color:c(c({},a.color),{},{a:0})})),u=Q6("color",e.dropShadow,n,a,r),u&&w.push(u),h=W6("blurRadius",e.dropShadow,n,a,r),h&&w.push(h),f=W6("spread",e.dropShadow,n,a,r),f&&w.push(f),p=Y6("offset",e.dropShadow,n,a,r),p&&w.push(p)}if(e instanceof f3){let n=c({},t.innerShadow),a=c({},i.innerShadow);(n.enabled||a.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof f3&&(e.innerShadow.enabled=t)}}}(e,!0)),n.enabled||Object.assign(n,{enabled:!0,color:c(c({},n.color),{},{a:0})}),a.enabled||Object.assign(a,{enabled:!0,color:c(c({},a.color),{},{a:0})})),m=Q6("color",e.innerShadow,n,a,r),m&&w.push(m),g=W6("blurRadius",e.innerShadow,n,a,r),g&&w.push(g),y=W6("spread",e.innerShadow,n,a,r),y&&w.push(y),v=Y6("offset",e.innerShadow,n,a,r),v&&w.push(v)}if(e instanceof f3||e instanceof b3){let n=c({},t.backgroundBlur),a=c({},i.backgroundBlur);(n.enabled||a.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof f3&&(e.backgroundBlur.enabled=t)}}}(e,!0)),n.enabled||Object.assign(n,{enabled:!0,radius:0}),a.enabled||Object.assign(a,{enabled:!0,radius:0})),b=W6("radius",e.backgroundBlur,n,a,r),b&&w.push(b)}if(e instanceof f3){let n=c({},t.layerBlur),a=c({},i.layerBlur);(n.enabled||a.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof f3&&(e.layerBlur.enabled=t)}}}(e,!0)),n.enabled||Object.assign(n,{enabled:!0,radius:0}),a.enabled||Object.assign(a,{enabled:!0,radius:0})),x=W6("radius",e.layerBlur,n,a,r),x&&w.push(x)}if(e instanceof b3||e instanceof g3){let n=H6("cornerRadius",e,t,i,r);n&&w.push(n)}return w}function p8(e,t,i,n,r){let a=[];return e.data.visible&&a.push(...d8(e,t,i,r,n)),e instanceof j2?a.push(...h8(e,t,i,0,n)):(e.data.visible&&a.push(...u8(e,t,i,n)),b0(e)?(e instanceof r$&&e.data.visible&&a.push(...Z6(e,t,i,n)),e.data.visible&&a.push(...function(e,t,i,n){let r=[];if(Array.isArray(e.material)){if(!("materials"in i)||!i.materials)return r;let a="materials"in t&&t.materials?t.materials:[],o=i.materials;e.material.forEach((e,t)=>{var i;if(!o[t])return;let s=null!==(i=a[t])&&void 0!==i?i:{},l=o[t];"string"==typeof s||"string"==typeof l||r.push(...$6(e,s,l,n))})}else{if(!("material"in i)||!i.material)return r;let a="material"in t&&t.material?t.material:{},o=i.material;if("string"==typeof a||"string"==typeof o)return r;r.push(...$6(e.material,a,o,n))}return r}(e,t,i,n))):(e=>g0.is(e))(e)?e.data.visible&&a.push(...J6(e,t,i,n)):(e=>e instanceof h0)(e)&&a.push(...function(e,t,i,n){var r,a,o,s;let l=[],c="OrthographicCamera"===e.cameraType?null===(r=t.orthographic)||void 0===r?void 0:r.zoom:null===(a=t.perspective)||void 0===a?void 0:a.zoom,d="OrthographicCamera"===e.cameraType?null===(o=i.orthographic)||void 0===o?void 0:o.zoom:null===(s=i.perspective)||void 0===s?void 0:s.zoom;if(void 0!==d){let t=null!==c&&void 0!==c?c:e.zoom,i=d;t!==i&&l.push({update:n=>{e.zoom=h_.lerp(t,i,n),e.updateProjectionMatrix()},start:()=>{e.zoom=t,e.updateProjectionMatrix()},end:()=>{e.zoom=i,e.updateProjectionMatrix()}})}if(void 0!==i.targetOffset){let r=W6("targetOffset",e,t,i,n);r&&l.push(r)}return l}(e,t,i,n))),a.length?{update:e=>{a.forEach(t=>t.update(e))},start:e=>{a.forEach(t=>{var i;return null===(i=t.start)||void 0===i?void 0:i.call(t,e)})},end:e=>{a.forEach(t=>{var i;return null===(i=t.end)||void 0===i?void 0:i.call(t,e)})}}:void 0}var f8=new j_;function m8(e,t){var i;let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[],a=i=>{let n=i.data;delete i.states,i.currentState=null,i.reversibleToState=null,i.currentTransitionEvent=null;for(let e of n.states){let t=c({},e.data);i.states||(i.states={}),i.states[e.id]=kW.patch(n,t)}v8(e.scene,i,null,t,void 0!==n.events.find(e=>"Follow"===e.data.type||"LookAt"===e.data.type)),g8(e)};e.scene.traverse2D(a),e.traverseChildren(i=>{var o,s,l,d,u,h;if(n&&(null!==(o=i.rigidBody)&&void 0!==o&&o.setTranslation(i.position0,!0),null!==(s=i.rigidBody)&&void 0!==s&&s.setRotation(i.rotation0,!0),null!==(l=i.rigidBody)&&void 0!==l&&l.setLinvel(f8,!0),null!==(d=i.rigidBody)&&void 0!==d&&d.setAngvel(f8,!0)),!PG.is(i))return;let p=i.uuid,f=i.data;if(delete i.states,i.uuid===OV)return;let m=!1;r.some(t=>{var i;return null===(i=e.scene.find(p))||void 0===i?void 0:i.isDescendantOf(t)})?m=!0:!0===(null===(u=f.physics)||void 0===u?void 0:u.fusedBody)&&"dynamic"===f.physics.rigidBody&&r.push(p),i.data=f,i.currentState=null,i.reversibleToState=null,i.currentTransitionEvent=null;for(let t of f.states){let n=c({},t.data);!0===e.data.globalPhysics.usePhysics&&f.physics&&("dynamic"===f.physics.rigidBody||m)&&(void 0!==t.data.position&&delete n.position,void 0!==t.data.rotation&&delete n.rotation,void 0!==t.data.hiddenMatrix&&delete n.hiddenMatrix),i.states||(i.states={}),i.states[t.id]=Wj.patch(f,n)}v8(e.scene,i,null,t,void 0!==f.events.find(e=>"Follow"===e.data.type||"LookAt"===e.data.type)),i instanceof X3&&i.frame&&(i.frame.traverse(e=>a(e)),null===(h=i.uiCanvas)||void 0===h||h.applySize())}),g8(e),e.frame&&(e.frame.traverse(e=>a(e)),null===(i=e.uiCanvas)||void 0===i||i.applySize())}function g8(e){e.traverseEntity(t=>{for(let i of t.data.events){let t=[];switch(i.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":t.push(...i.data.actions);break;case"GameControl":for(let e of Object.values(i.data.gameActions))t.push(...e);break;case"DragDrop":t.push(...i.data.dragDropActions.drag,...i.data.dragDropActions.drop);break;case"Conditional":t.push(...i.data.inActions,...i.data.outActions)}for(let i of t)if("Create"===i.data.type&&"Yes"===i.data.hideBase){let t=e.scene.find(i.data.object);t&&(t.visible=!1)}}})}function v8(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(t instanceof r$&&!(t instanceof v4)&&t.removeInteractionGeometry(n),t instanceof j2?t.changeSelectedState(i,{shared:n},r):t.changeSelectedState(i,{scene:e,shared:n},r),t instanceof r$&&t.updateGeometryGroupsIfNeeded(),t instanceof h0&&t.updateCameraState(t.dataPatched,{scene:e,shared:n}),!(t instanceof j2)){if(t.cloner)for(let e of t.cloner.children)e.playModeVisible=void 0;t.updateVisible()}}function y8(e){let t;if(5===e.easing){let{control1:i,control2:n}=e;t="cubicBezier(\n\t\t\t".concat(i[0],", ").concat(i[1],", ").concat(n[0],", ").concat(n[1],"\n\t\t)")}else if(6===e.easing){let{mass:i,stiffness:n,damping:r,velocity:a}=e;t="spring( ".concat(i,", ").concat(n,", ").concat(r,", ").concat(a," )")}else{let i;switch(e.easing){case 0:default:i=LV.linear;break;case 1:i=LV.ease;break;case 2:i=LV.easeIn;break;case 3:i=LV.easeOut;break;case 4:i=LV.easeInOut}let[n,r,a,o]=i;t="cubicBezier( ".concat(n,", ").concat(r,", ").concat(a,", ").concat(o," )")}return{duration:Math.max(e.duration,1e-4),easing:t}}function b8(e){let t={delay:0,loop:-1===e.repeat||e.repeat+1};if(0===e.repeat)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay}return"alternate"===t.direction&&(t.delay/=2,t.endDelay/=2,"start"===e.delayDirection?(t.pingPongDelayCorrection=t.delay,"number"==typeof t.loop&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):"end"===e.delayDirection?"number"==typeof t.loop&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):"start-end"===e.delayDirection&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var x8={type:"beginState"},w8={type:"completeState",isfromEntity:!1},S8=class{constructor(e,t,i,n,r,a){if(this.object=e,this.data=n,this.sharedAssets=r,this.allowSlerp=a,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.requestRender()),0===this.targets.t||1===this.targets.t?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let e=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=e,this.object.dispatchEvent({type:"beginState",state:e}),this.object instanceof j2||this.object.traverseEntity(e=>{e!==this.object&&e instanceof h0&&e.dispatchEvent(x8)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let e=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=e,this.object.dispatchEvent({type:"completeState",state:e}),this.object instanceof j2||this.object.traverseEntity(e=>{e!==this.object&&e instanceof h0&&e.dispatchEvent(w8)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=p8(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},void 0===t){let e=C8(this.object,this.object.currentState===i?this.object.prevState:this.object.currentState);if(!e)throw new Error("Missing property");this.from=e}else{let e=C8(this.object,t);if(!e)throw new Error("Missing property");this.from=e}if(void 0===i)throw new Error("Missing property");{let e=C8(this.object,i);if(!e)throw new Error("Missing property");this.to=e}this.useCurrentState=void 0===t||void 0===i,this.params=c(c(c({targets:this.targets,t:1,autoplay:!1},b8(n)),y8(n)),{},{change:this.onChange}),this.callback=p8(this.object,void 0===t?{}:this.from.data,void 0===i?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},_8=class extends JS{constructor(e,t,i,n,r){var a,o,s;if(super(),this.eventType=e,this.data=t,this.page=i,this.shared=n,this.condition=r,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.hasPlayedOnce=!1,this.onTimelineChangeComplete=()=>{var e;"normal"!==this.data.tweens[0].data.direction&&(this.toggleIsForward=!this.toggleIsForward),!1!==this.timelineNeedsRebuild&&(null!==(e=this.timeline)&&void 0!==e&&e.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!1,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let l=null!==(a=null!==(o=this.page.scene.find(t.object))&&void 0!==o?o:null===(s=this.page.uiCanvas)||void 0===s?void 0:s.find(t.object))&&void 0!==a?a:this.page.scene.find2DInUIObjects(t.object);if(!l)throw new Error("Missing property");if(!l.states)throw new Error("Missing property");if(this.object=l,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay="start-once"===t.tweens[0].data.delayDirection?t.tweens[0].data.delay:0,this.init()}get playing(){var e;return!1===(null===(e=this.timeline)||void 0===e?void 0:e.paused)}get changeBegan(){var e;return null!==(e=this.tweens.some(e=>e.changeBegan))&&void 0!==e&&e}init(){this.initialCurrentState=C8(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return"Toggle"===this.data.runMode&&ZU(this.eventType)?this.initialCurrentState:this.object.currentState}buildTimeline(){var e;let{isForward:t=!0,needsRebuild:i=!1,isRebuild:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var r;let e=b8(this.data.tweens[0].data);n&&"number"==typeof e.loop&&e.loop--,null!==(r=this.timeline)&&void 0!==r&&r.pause(),this.timeline=F6.timeline(c(c({autoplay:!1},e),!0===e.loop||e.loop>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}));let d=this.tweens.findIndex(e=>null===e||void 0===e?void 0:e.changeBegan);if(!0===i&&(this.timelineNeedsRebuild=!0),t){let t=-1===d?0:d;for(let i=t;i<this.data.tweens.length-1;i++){var a,o;let n,r=this.data.tweens[i],s=this.data.tweens[i+1];i!==t||!0!==this.object.wasMovedByUser&&!0!==(null===(a=this.object.previousAction)||void 0===a?void 0:a.changeBegan)?n=void 0===r.data.state?this.currentState:r.data.state:(n=void 0,this.object instanceof h0&&(this.object.wasMovedByUser=!1));let l=new S8(this.object,n,void 0===s.data.state?this.currentState:s.data.state,s.data,this.shared,null!==(o=this.data.allowSlerp)&&void 0!==o&&o);-1!==d&&i===t&&Object.assign(l.params,{startOnceDelay:0}),this.tweens[i]=l,this.timeline.add(l.params,this.timeline.duration+(i===t?e.delay:0))}this.timeline.duration+=e.endDelay}else{let t=-1===d?this.data.tweens.length-1:d+1;for(let i=t;i>0;i--){var s,l;let n,r=this.data.tweens[i],a=this.data.tweens[i-1];i!==t||!0!==this.object.wasMovedByUser&&!0!==(null===(s=this.object.previousAction)||void 0===s?void 0:s.changeBegan)?n=void 0===r.data.state?this.currentState:r.data.state:(n=void 0,this.object instanceof h0&&(this.object.wasMovedByUser=!1));let o=new S8(this.object,n,void 0===a.data.state?this.currentState:a.data.state,r.data,this.shared,null!==(l=this.data.allowSlerp)&&void 0!==l&&l);-1!==d&&i===t&&Object.assign(o.params,{startOnceDelay:0}),this.tweens[i-1]=o,this.timeline.add(o.params,this.timeline.duration+(i===t?e.endDelay:0))}this.timeline.duration+=e.delay}}catch(BV){BV instanceof Error&&console.error(BV.message)}!0===(null===(e=this.object.previousAction)||void 0===e?void 0:e.playing)&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(!1===L8(this.shared,this.condition)||ZU(this.eventType)&&"Once"===this.data.runMode&&this.hasPlayedOnce||(this.hasPlayedOnce=!0,this.playing))return!1;clearTimeout(this.timeoutId);let e=b8(this.data.tweens[0].data).pingPongDelayCorrection;F6({targets:{},duration:this.startOnceDelay+e,easing:"linear",complete:()=>{try{this.buildTimeline(),this.timeline.play()}catch(WN){WN instanceof Error&&console.error(WN.message)}}})}pause(){var e;null!==(e=this.timeline)&&void 0!==e&&e.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=void 0===this.data.tweens[0].data.state?this.initialCurrentState:this.data.tweens[0].data.state;this.object instanceof j2?this.object.changeSelectedState(e,{shared:this.shared}):this.object.changeSelectedState(e,{scene:this.page.scene,shared:this.shared}),this.object.currentState=e}seek(e){var t;if(!1===L8(this.shared,this.condition))return!1;void 0===this.timeline&&this.buildTimeline(),null===(t=this.timeline)||void 0===t||t.seek(e*this.timeline.duration,!0)}toggle(e){var t;if(!1===L8(this.shared,this.condition))return!1;clearTimeout(this.timeoutId),this.toggleIsForward=null!==e&&void 0!==e?e:!this.toggleIsForward,this.playing?(null!==(t=this.timeline)&&void 0!==t&&t.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!0}),this.timeline.play()):F6({targets:{},duration:this.startOnceDelay,easing:"linear",complete:()=>{var e;null!==(e=this.timeline)&&void 0!==e&&e.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()}})}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function C8(e,t){var i;let n,r;if("string"==typeof t?(n=t,r=null===(i=e.states)||void 0===i?void 0:i[n]):null===t&&(n=null,r=e.data),void 0!==n&&void 0!==r)return{id:n,data:r}}var E8={type:"beginState"},A8={type:"completeState",isfromEntity:!1},M8={type:"requestRender"},T8=class extends JS{constructor(e,t,i,n){super(),this.data=e,this.page=t,this.shared=i,this.condition=n,this.toggleIsForward=!1,this.posStart=new j_,this.posEnd=new j_,this.qStart=new V_,this.qEnd=new V_,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(){if(!this.data.animate)return;let e=this.page.scene.find(this.data.targetCamera);if(!e||!e.visible)throw new ReferenceError("Target camera not founded or not visible");let t={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=F6(c(c({targets:t,t:1},y8(this.data)),{},{update:()=>{0===t.t&&("Toggle"!==this.data.runMode||this.toggleIsForward?(this.posEnd.copy(e.position),this.qEnd.copy(e.quaternion),this.zoomEnd=e.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(e.uuid)):this.fromCamera&&(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)),this.page.activeCamera.dispatchEvent(E8));let i=this.page.activeCamera;i.position.lerpVectors(this.posStart,this.posEnd,t.t),i.quaternion.slerpQuaternions(this.qStart,this.qEnd,t.t),i.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*t.t,i.wasMovedBySwitchCameraAction=!0,i.updateMatrix(),i.updateMatrixWorld(),i.updateProjectionMatrix(),i.dispatchEvent(M8),1===t.t&&i.dispatchEvent(A8)}}))}switchCamera(e){let t=this.page.activeCamera,i=this.page.scene.find(e);if(!i||!i.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(i),t.dispatchEvent({type:"cameraChange",camera:i})}play(){if(!1===L8(this.shared,this.condition))return!1;if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var e;delete this.timeoutId,this.data.animate?(this.buildAnimation(),null===(e=this.animation)||void 0===e||e.play()):this.switchCamera(this.data.targetCamera)},1e3*this.data.delay)}catch(e){}}pause(){var e;null!==(e=this.animation)&&void 0!==e&&e.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){if(!1===L8(this.shared,this.condition))return!1;if(window.clearTimeout(this.timeoutId),delete this.timeoutId,e!==this.toggleIsForward)try{var t,i;this.playing?(null!==(t=this.animation)&&void 0!==t&&t.pause(),this.toggleIsForward=null!==e&&void 0!==e?e:!this.toggleIsForward,this.buildAnimation(!0),null===(i=this.animation)||void 0===i||i.play()):this.timeoutId=window.setTimeout(()=>{var t,i;this.toggleIsForward=null!==e&&void 0!==e?e:!this.toggleIsForward,this.data.animate?(null!==(t=this.animation)&&void 0!==t&&t.pause(),this.buildAnimation(),null===(i=this.animation)||void 0===i||i.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.fromCamera&&this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(A8),this.page.activeCamera.dispatchEvent(M8))},1e3*this.data.delay)}catch(n){}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}};function P8(e){let t=null===e||void 0===e?void 0:e.tracks.filter(e=>"vector"===e.ValueTypeName||"quaternion"===e.ValueTypeName).map(e=>e.times.length);if(null!==t&&void 0!==t&&t.length){let e=VB(t);return e&&e>2?e:2}return 2}var D8=class extends JS{constructor(e,t,i,n,r){var a,o;super(),this.data=e,this.page=t,this.animationControls=i,this.shared=n,this.condition=r,this.startOnceDelay=0,this.toggleIsForward=!1;let s=e.object,l=t.scene.find(e.object);l&&Array.isArray(l.identity)&&(s=l.identity[0]),this.data=c(c({},e),{},{object:s});let d=this.animationControls.clipIdToAction[e.clipId+"/"+s];if(this.duration=null!==(a=null===d||void 0===d||null===(o=d.getClip())||void 0===o?void 0:o.duration)&&void 0!==a?a:1,this.data.crop2){let e=P8(null===d||void 0===d?void 0:d.getClip());this.leftFrameTime=this.data.crop2[0]/(e-1)*this.duration,this.rightFrameTime=this.data.crop2[1]/(e-1)*this.duration}else{var u;let e=null===d||void 0===d||null===(u=d.getClip())||void 0===u||null===(u=u.tracks[0])||void 0===u?void 0:u.times.length;e&&e>1?(this.leftFrameTime=this.data.crop[0]/e*this.duration,this.rightFrameTime=this.data.crop[1]/e*this.duration):(this.leftFrameTime=0,this.rightFrameTime=this.duration)}this.startOnceDelay=e.delay}get playing(){var e,t;return null!==(e=null===(t=this.threeAnimAction)||void 0===t?void 0:t.isRunning())&&void 0!==e&&e}play(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!1===L8(this.shared,this.condition))return!1;window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var t;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let i=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(t=>{let[n,r]=t,a=n.split("/")[1];this.threeAnimAction!==r&&a===i&&r.isRunning()&&(e?r.fadeOut(.2):r.stop())}),e&&(null===(t=this.threeAnimAction)||void 0===t||t.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var e;null===(e=this.threeAnimAction)||void 0===e||e.fadeOut(.2)}seek(e){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=h_.clamp(this.threeAnimAction.time+1/60*e,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!1===L8(this.shared,this.condition))return!1;this.toggleIsForward=null!==e&&void 0!==e?e:!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){var e;this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let i=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(e=>{let[n,r]=e,a=n.split("/")[1];this.threeAnimAction!==r&&a===i&&r.isRunning()&&(t?r.fadeOut(.2):r.stop())}),t&&(null===(e=this.threeAnimAction)||void 0===e||e.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var e;let t=null===(e=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])||void 0===e?void 0:e.getClip();t&&(t.duration=this.duration),this.pause()}},O8=class{constructor(e,t,i,n,r){this.data=e,this.page=t,this.eventManager=i,this.shared=n,this.condition=r,this.timeOutId=-1,this.scene=t.scene}dispatch(){if(!1===L8(this.shared,this.condition))return!1;this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},1e3*this.data.delay))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(e=>e.uuid!==this.data.target||e.data.uiScene))return;"fade"===this.data.transition&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,1e3*this.data.duration),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let e=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.traverseVisibleEntity(e=>{"ParticleSystem"===e.type&&(e.sleep(),e.wakeUp(),e.data.autoPlay?e.start():e.stop())}),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(e),m8(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}},I8=class{constructor(e,t,i,n){this.data=e,this.page=t,this.shared=i,this.condition=n,this.evaluatedCondition=!1}checkConditions(){this.evaluatedCondition=L8(this.shared,this.condition)}dispatch(){if(!1===this.evaluatedCondition)return!1;let e=this.shared.getVariable(this.data.variableId),t=CY(this.data.expression,this.shared,eW.typeOfVariable(e));void 0!==t&&this.shared.updateVariable(this.data.variableId,"string"==typeof t?{textValue:t}:t)}dispose(){}},k8=class{constructor(e,t,i,n){this.data=e,this.page=t,this.shared=i,this.condition=n,this.timeoutId=null}dispatchInner(){if(!1===L8(this.shared,this.condition))return!1;let e=this.shared.getDynamicVariablePlayState(this.data.variableId);if("PlayPause"===this.data.mode)void 0===this.shared.getDynamicVariableToggleIsForward(this.data.variableId)&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"===e?"Paused":"Playing");else if("Play"===this.data.mode&&"Playing"!==e)void 0===this.shared.getDynamicVariableToggleIsForward(this.data.variableId)&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing");else if("Stop"===this.data.mode&&"Stopped"!==e)this.shared.setDynamicVariablePlayState(this.data.variableId,"Stopped");else if("Pause"===this.data.mode&&"Paused"!==e)this.shared.setDynamicVariablePlayState(this.data.variableId,"Paused");else if("Restart"===this.data.mode)this.shared.setDynamicVariablePlayState(this.data.variableId,"Restarted");else if("Toggle"===this.data.mode){let t=this.shared.getDynamicVariableToggleIsForward(this.data.variableId);"Playing"===e?this.shared.setDynamicVariableToggleIsForward(this.data.variableId,void 0!==t&&!t):(this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!t),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"))}}dispatch(){let e=this.data.delay,t=this.shared.getDynamicVariablePlayState(this.data.variableId);"PlayPause"===this.data.mode&&"Playing"===t&&(e=this.data.pauseDelay),0!==e?(this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.timeoutId=null,this.dispatchInner()},e)):this.dispatchInner()}dispose(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},R8=class{constructor(e,t,i,n){this.data=e,this.page=t,this.shared=i,this.condition=n}dispatch(){if(!1===L8(this.shared,this.condition))return!1;("single"===this.data.target?this.data.variableId?[this.data.variableId]:[]:Object.keys(this.shared.getVariables())).forEach(e=>{var t;this.shared.getVariable(e);let i=null===(t=this.shared.data.variables.data(e))||void 0===t?void 0:t.value;void 0!==i&&this.shared.updateVariable(e,i),this.shared.enableLocalStorageForPersistentVariables&&localStorage.removeItem(QJ(e))})}dispose(){}},z8=class{constructor(e,t,i,n){this.data=e,this.page=t,this.shared=i,this.condition=n}dispatch(){var e;if(!1===L8(this.shared,this.condition))return!1;this.data.userAPIId&&(null===(e=this.shared.getUserAPI(this.data.userAPIId))||void 0===e||e.callUserAPI(this.shared))}dispose(){}};function L8(e,t){if(void 0===t)return!0;if(0===t.expression.length)return!1;let i=CY(t.expression,e,"boolean");return t.negate?!i:!!i}function B8(e,t,i,n,r,a){let o={Audio:[],Video:[],Particles:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[],SetVariable:[],DynamicVariablePlay:[],ClearLocalStorage:[],UserAPI:[]},s=t=>l=>{let{id:c,data:d}=l;try{"Audio"===d.type?yV[e.type].includes("Audio")&&o.Audio.push(new D5(c,d,a,n,t)):"Video"!==d.type||a instanceof j2?"Particles"===d.type?yV[e.type].includes("Particles")&&o.Particles.push(new O5(d,i,n,t)):"Link"===d.type?yV[e.type].includes("Link")&&o.Link.push(new R5(d,r.controlsManager,n,t)):"Create"===d.type?yV[e.type].includes("Create")&&o.Create.push(new Q8(d,i,r.controlsManager,n,t)):"Destroy"===d.type?yV[e.type].includes("Destroy")&&o.Destroy.push(new z5(d,i,r.controlsManager,n,t)):"Reset"===d.type?yV[e.type].includes("Reset")&&o.Reset.push(new L5(d,i,n,r,t)):"Transition"===d.type?yV[e.type].includes("Transition")&&o.Transition.push(new _8(e.type,d,i,n,t)):"SwitchCamera"===d.type?yV[e.type].includes("SwitchCamera")&&o.SwitchCamera.push(new T8(d,i,n,t)):"SceneTransition"===d.type?yV[e.type].includes("SceneTransition")&&o.SceneTransition.push(new O8(d,i,r,n,t)):"Animation"===d.type?yV[e.type].includes("Animation")&&o.Animation.push(new D8(d,i,r.animationControls,n,t)):"SetVariable"===d.type?yV[e.type].includes("SetVariable")&&o.SetVariable.push(new I8(d,i,n,t)):"DynamicVariablePlay"===d.type?yV[e.type].includes("DynamicVariablePlay")&&o.DynamicVariablePlay.push(new k8(d,i,n,t)):"Conditional"===d.type?yV[e.type].includes("Conditional")&&(d.ifActions.forEach(s({expression:d.condition,negate:!1})),d.elseActions.forEach(s({expression:d.condition,negate:!0}))):"ClearLocalStorage"===d.type?yV[e.type].includes("ClearLocalStorage")&&o.ClearLocalStorage.push(new R8(d,i,n,t)):"UserAPI"===d.type&&yV[e.type].includes("UserAPI")&&o.UserAPI.push(new z8(d,i,n,t)):yV[e.type].includes("Video")&&o.Video.push(new W8(c,d,a,n,t))}catch(MV){}};return t.forEach(s()),o}function N8(e){Object.values(e).forEach(e=>{e.forEach(e=>{(e instanceof D5||e instanceof W8||e instanceof O5||e instanceof D8||e instanceof _8||e instanceof Q8||e instanceof z5||e instanceof T8||e instanceof O8||e instanceof L5||e instanceof I8||e instanceof k8)&&e.dispose()})})}var F8=new Map,U8=new Map,V8=class{constructor(e,t,i){this.data=t,this.delay=0,this.status="stopped";let{layerId:n,loop:r,volume:a,delay:o}=t;if(this.object=i,void 0===n)throw new Error("Missing property");let s=function(e,t){let i;if("material"in e){let n=e.material;i=Array.isArray(n)?e.material[0].layers.find(e=>e.uuid===t):e.material.layers.find(e=>e.uuid===t)}if(i)return i.color.texture.image.img instanceof HTMLVideoElement?i.color.texture.image.img:void 0}(i,n);s&&(this.videoElement=s,this.videoElement.loop=r===1/0,rN&&(this.videoElement.autoplay=!0),void 0!==a&&(this.videoElement.volume=a)),void 0!==o&&(this.delay=o),U8.has(i.uuid)?U8.get(i.uuid).push(this):U8.set(i.uuid,[this]),F8.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let e=this.videoElement.play();void 0!==e&&e.then(e=>{}).catch(e=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}seek(e){return new Promise((t,i)=>{if(!this.videoElement)return i();let n=this.videoElement.duration;if(n>0){let t=e%n;this.videoElement.currentTime=t}this.videoElement.addEventListener("seeked",()=>t(),{once:!0})})}playByToggle(){"stop"===this.data.toggle?"playing"===this.status?this.stop():(this.stop(),this.play()):"pause"===this.data.toggle?"playing"===this.status?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},j8=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=F8.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t[this.data.interaction](),this.disposeDelay()},this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=U8.get(e);null===t||void 0===t||!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(e=>e[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(e=>e[this.data.interaction]()))}pauseAllVideos(){let e=[...U8.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(e=>{e.forEach(e=>{e[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(e=>{e.forEach(e=>{e[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},W8=class{constructor(e,t,i,n,r){if(this.data=t,this.shared=n,this.condition=r,"play"===t.interaction)this.interaction=new V8(e,t,i);else{if("pause"!==t.interaction&&"stop"!==t.interaction)throw new Error("Missing property");this.interaction=new j8(t)}}dispatchBasic(){if(!1===L8(this.shared,this.condition))return!1;this.interaction instanceof V8?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(!1===L8(this.shared,this.condition))return!1;this.interaction instanceof V8?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},H8=(()=>{let e,t,i,n;function r(i){var r;!e&&!G8()&&(null===(r=t)||void 0===r?void 0:r.sharedGameControlGlobals.createdObjects.length)>0&&(e=requestAnimationFrame(a)),i&&(t=i,n=i.requestRender)}function a(r){let o=i?r-i:0,s=t.sharedGameControlGlobals.createdObjects,l=t.sharedGameControlGlobals.nCreatedPerAction,c=s.length,d=0;for(;d<c;){let e=s[d];void 0===e.userData.createdTime&&(e.userData.createdTime=r),void 0===e.userData.lifetime&&void 0===e.userData.quantity||e.userData.lifetime&&r-e.userData.createdTime<e.userData.lifetime||e.userData.quantity&&l[e.userData.actionId]<=e.userData.quantity?(e.userData.velocity&&(e.position.addScaledVector(e.userData.velocity,o/1e3),e.updateMatrix(),n()),d++):(l[e.userData.actionId]>e.userData.quantity&&l[e.userData.actionId]--,s.splice(d,1),e.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&e.rigidBody?(t.sharedGameControlGlobals.colliderToEntity.delete(e.rigidBody.collider(0).handle),t.sharedGameControlGlobals.rapierWorld.removeRigidBody(e.rigidBody)):(e.bvhGeometry=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter(e=>void 0!==e.bvhGeometry)),c--,n())}e=d>0?requestAnimationFrame(a):void 0,i=d>0?r:void 0}return typeof document<"u"&&document.addEventListener("visibilitychange",function(){G8()?e&&(cancelAnimationFrame(e),e=void 0,i=void 0):r()}),r})();function G8(){return!!document&&document.hidden}var q8=new V_,X8=new j_,Y8=new j_,Q8=class{constructor(e,t,i,n,r){this.data=e,this.page=t,this.controlsManager=i,this.shared=n,this.condition=r,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=h_.generateUUID(),this.dispatch=()=>{if(!1===L8(this.shared,this.condition))return!1;this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay)):this.dispatchInner()},this.dispatchFromStart=()=>{if(!1===L8(this.shared,this.condition))return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay))},this.dispatchThrottled=ZB(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{null===this.intervalId&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{null!==this.intervalId&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let e=new IG(this.object);if(e.playModeVisible=!0,e.expand(),"world"!==this.data.coordinateSystem){let t=this.data.coordinateSystem,i=this.page.scene.find(t);i&&(i.updateMatrixWorldSVD(),e.hiddenMatrix.copy(i.matrixWorldRigid))}e.scale.copy(this.object.scale),e.position.fromArray(this.data.position),e.rotation.fromArray(this.data.rotation),e.updateMatrix(),this.page.add(e);let t=this.controlsManager.sharedGameControlGlobals;t.createdObjects.push(e),void 0===t.nCreatedPerAction[this.uniqueId]?t.nCreatedPerAction[this.uniqueId]=1:t.nCreatedPerAction[this.uniqueId]++,e.updateWorldMatrix(!0,!0),e.traverseObject(this.traverseObjectCB),H8(),this.controlsManager.requestRender()},this.traverseObjectCB=e=>{var t,i,n;let r;if(e.hasNonUniformScale&&e.updateMatrixWorldSVD(),this.controlsManager.sharedGameControlGlobals.rapierWorld){var a;if(e instanceof X$){if(!e.objectForSample)return!0===e.object.dataPatched.physics.fusedBody&&"dynamic"===e.object.dataPatched.physics.rigidBody||void 0;if(e.objectForSample.dataPatched.physics.fusedBody)return;r=e.object}else if(e instanceof IG)r=e.object;else if(r=e,null!==(a=r.dataPatched.cloner)&&void 0!==a&&a.hideBase)return!0}else{if(e instanceof X$)return;r=e instanceof IG?e.object:e}"Time"===this.data.destroy?e.userData.lifetime=1e3*this.data.lifetime:"Quantity"===this.data.destroy&&(e.userData.quantity=this.data.destroyAfterQuantity,e.userData.actionId=this.uniqueId);let o=(new j_).fromArray(this.data.velocity),s=r.dataPatched;if(!("visibility"===s.physics.enabled?!s.visible:!s.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(e,r,{fromCreate:!0,dynamic:this.data.dynamic}),"Collision"===this.data.destroy&&(null!==(t=e.rigidBody)&&void 0!==t&&t.collider(0).setActiveEvents(1),e.userData.hasCollisionDestroy=!0),e.matrixWorld.decompose(X8,q8,Y8),o.applyQuaternion(q8),this.data.velocity.some(e=>0!==e)&&this.data.dynamic&&(null===(i=e.rigidBody)||void 0===i||i.setLinvel(o.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in e.object&&this.controlsManager.addBoundsTree(e),this.data.velocity.some(e=>0!==e)&&this.data.dynamic&&(e.userData.velocity=o)),!0===(null===(n=r.dataPatched.physics)||void 0===n?void 0:n.fusedBody)))return!0};let a=this.page.scene.find(this.data.object);if(!a)throw new Error("Missing Property");if(this.object=a,"world"!==this.data.coordinateSystem&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");H8(i)}dispose(){null!==this.intervalId&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(e=>window.clearTimeout(e)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},K8=.02,Z8=(new j_,new j_),J8=new j_,$8=new j_,e9=new j_,t9=new j_,i9=new j_,n9=new yC,r9=new yC,a9=new yC,o9=(new yC,new V_),s9=new V_,l9=new TC(0,0,0,"YXZ"),c9=new j_(1,0,0),d9=new j_(0,1,0),u9=new j_(0,0,1),h9=new j_(1,1,1),p9=(new cC,new MO),f9=new G_,m9={type:"requestRender"},g9={type:"updateMatrix"},v9=Math.PI/6,y9=class extends JS{constructor(e,t,i,n,r,a,o,s,l){var d,u,h,p,f,m,g,v,y,b,x,w,S,_,C,E,A,M,T;super(),this.object=e,this.domElement=t,this.data=i,this.gloabalPhysics=n,this.controlsManager=r,this.cameraFollow=a,this.camera=o,this.page=s,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new yC,this.target0=new j_,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=200,this.euler0=new TC(0,0,0,"YXZ"),this.position0Cam=new j_,this.quat0Cam=new V_,this.scale0Cam=new j_,this.hiddenMatrix0Cam=new yC,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new MO(new j_(0,-40,0),new j_(0,40,0)),matrix:new yC,position:new j_,rotation:new V_},this.euler=new TC(0,0,0,"YXZ"),this.eulerDelta=new j_,this.lastPosition=new j_,this.lastCameraQuaternion=new V_,this.lastCameraPosition=new j_,this.PI_2=Math.PI/2,this.prevMouse=new p_,this.velocityTarget=new j_,this.velocity=new j_,this.directionXZ=new j_,this.rotVelocityStick=new j_,this.rotVelocityTarget=new j_,this.rotVelocity=new j_,this.rotDirection=new j_,this.nonColliderRotOffset=new yC,this.nonColliderPosOffset=new yC,this.firstPointerId=-1,this.rot=new j_,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new yC,this.objectToTarget=new j_,this.objectToTarget0=new j_,this.objectToCamXZ=new j_,this.objectToCamXZ0=new j_,this.targetToCamera=new j_,this.targetToCamera0=new j_,this.cameraPolarAxis0=new j_,this.targetPos=new j_,this.targetQuat=new V_,this.lerpFactorPos=(new j_).setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new V_,this.objXZQuatInv=new V_,this.objXZRotMat=new yC,this.isFirstPerson=!1,this.didHit=!1,this.groundVelocity=new j_,this.pushedVelocity=new j_,this.groundYRotation=0,this.objectRealQuat=new V_,this.colliderWorldQuat=new V_,this.groundNormal=new j_,this.groundTilt=new V_,this.groundTiltInv=new V_,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new j_,this.quaternion=new V_,this.scale=new j_,this.initialAction=!0,this.onPointerDown=e=>{var t;!(e.target===this.domElement||e.target instanceof HTMLElement&&"SPLINE-VIEWER"===e.target.tagName&&null!==(t=e.target.shadowRoot)&&void 0!==t&&t.contains(this.domElement))||-1!==this.firstPointerId||(this.firstPointerId=e.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),"keys"!==this.rotBy&&!oN&&!sN&&this.domElement.requestPointerLock(),this.prevMouse.set(e.clientX,e.clientY))},this.onPointerUp=e=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),"mouse"===e.pointerType&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=e=>{if(e.pointerId!==this.firstPointerId)return;let t=e.clientX-this.prevMouse.x,i=e.clientY-this.prevMouse.y;this.prevMouse.set(e.clientX,e.clientY),"mouse"===e.pointerType&&"keys"!==this.rotBy&&(sN&&lN<15.5&&!oN?(this.eulerDelta.y=-t*this.mouseOrbitSensitivity,this.eulerDelta.x=-i*this.mouseOrbitSensitivity):(this.eulerDelta.y=-e.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-e.movementY*this.mouseOrbitSensitivity)),"mouse"!==e.pointerType&&"drag"===this.rotByTouch&&(this.eulerDelta.y=-t*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-i*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=e=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?y9.isLocked=!0:y9.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{var e;if(null!==(e=document)&&void 0!==e&&e.hidden)for(let t in this.movementState)this.movementState[t]=0},this.onKeyDown=e=>{!(e.target instanceof HTMLInputElement)&&("ArrowLeft"===e.code||"ArrowUp"===e.code||"ArrowRight"===e.code||"ArrowDown"===e.code||"Space"===e.code)&&e.preventDefault();for(let t of this.keyAssignments)if(e.key.toUpperCase()===t[1]||e.key===t[1]){this.movementState[t[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=e=>{for(let t of this.keyAssignments)if(e.key.toUpperCase()===t[1]||e.key===t[1]||e.code.slice(3,e.code.length).toUpperCase()===t[1]){this.movementState[t[0]]=0;break}},this.copyVRGamePadValues=(e,t)=>{for(let i=2;i<4;i++){let n=e.axes[i];0===t?2===i?this.movementState.movePosX=n:this.movementState.movePosZ=n:(e.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,2===i?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(n)>=.3&&(this.vrEulerYOffset+=n<0?1:-1),this.movementState.rotPosY=n):"fly"===this.moveMode&&(this.movementState.moveNegY=n))}},this.sharedGameControlGlobals=r.sharedGameControlGlobals,e===o&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let P=this.euler0.clone(),D=P.y;if(this.objectRealQuat.copy(this.quaternion),P.y=0,this.quaternion.setFromEuler(P),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),P.set(0,D,0),this.quaternion.setFromEuler(P),this.rot.setFromEuler(P),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||!0===this.cameraFollow)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),!0===this.cameraFollow){var O;this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy(null===(O=this.camera)||void 0===O?void 0:O.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let e,t,i=new j_(0,0,-1).applyQuaternion(this.camera.quaternion),n=(new j_).subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(n),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ),Math.abs(i.y)<1e-6?(n.y=0,i.y=0,t=n.projectOnVector(i)):t=n.y/i.y>0?i.multiplyScalar(n.y/i.y):i.multiplyScalar(n.length()),this.targetToCamera0.copy(t).negate(),e=this.camera.position.clone().add(t),this.objectToTarget0.subVectors(e,this.position);let r=(new TC).setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-r.x,r.x=0,r.z=0,r.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(r)}if(this.object instanceof h0&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=null!==(d=i.rotByTouch)&&void 0!==d?d:"joystick",this.rotBy=null!==(u=i.rotBy)&&void 0!==u?u:"keys",this.rotationMode=null!==(h=i.rotationMode)&&void 0!==h?h:"normal",this.moveMode=null!==(p=i.moveMode)&&void 0!==p?p:"walk",this.collisionEnabled=i.collisionEnabled,this.speedTranslate=1*(null!==(f=i.speedTranslate)&&void 0!==f?f:250),this.speedOrbit=.025*(null!==(m=i.speedRotate)&&void 0!==m?m:100),this.mouseOrbitSensitivity=16e-6*(null!==(g=i.speedRotate)&&void 0!==g?g:100),this.keyAssignments=i.keyAssignments.map(e=>{let t=[e[0],e[1]];return"\u25b2"===t[1]?t[1]="ArrowUp":"\u25c0"===t[1]?t[1]="ArrowLeft":"\u25bc"===t[1]?t[1]="ArrowDown":"\u25b6"===t[1]?t[1]="ArrowRight":"\u21e7"===t[1]?t[1]="Shift":"\u21b5"===t[1]?t[1]="Enter":"Space"===t[1]?t[1]=" ":"\u2318"===t[1]?t[1]="Meta":"Ctrl"===t[1]?t[1]="Control":"Esc"===t[1]&&(t[1]="Escape"),t}),"mouse"===i.rotBy){let e;e=this.keyAssignments.findIndex(e=>"rotNegX"===e[0]),-1!==e&&(this.keyAssignments[e][1]=""),e=this.keyAssignments.findIndex(e=>"rotPosX"===e[0]),-1!==e&&(this.keyAssignments[e][1]=""),e=this.keyAssignments.findIndex(e=>"rotPosY"===e[0]),-1!==e&&(this.keyAssignments[e][1]=""),e=this.keyAssignments.findIndex(e=>"rotNegY"===e[0]),-1!==e&&(this.keyAssignments[e][1]="")}this.lerpFactorPosStart=1-.02**(1/(60*(null!==(v=i.delayPos[0])&&void 0!==v?v:.3))),this.lerpFactorPosEnd=1-.02**(1/(60*(null!==(y=i.delayPos[1])&&void 0!==y?y:.3))),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/(60*(null!==(b=i.delayRot[0])&&void 0!==b?b:.3))),this.lerpFactorRotEnd=1-.02**(1/(60*(null!==(x=i.delayRot[1])&&void 0!==x?x:.3))),this.lerpFactorPosCamera=1-.02**(1/(60*(null!==(w=i.delayPosCamera)&&void 0!==w?w:.3))),this.lerpFactorRotCamera=1-.02**(1/(60*(null!==(S=i.delayRotCamera)&&void 0!==S?S:.3))),this.gravity=12*(null!==(_=this.gloabalPhysics.gravity)&&void 0!==_?_:Ej.defaultData.gravity),this.usePhysics=null!==(C=this.gloabalPhysics.usePhysics)&&void 0!==C?C:Ej.defaultData.usePhysics,this.jumpPower=20*i.jumpPower,this.resetYPosition=this.position.y+Math.abs(i.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=null!==(E=i.alignToGround)&&void 0!==E&&E,this.orientMode=i.autoOrientMove?i.orientMode:"none",this.orientWith=null!==(A=i.orientWith)&&void 0!==A?A:sW.defaultDataThirdPerson.orientWith,this.slopeThresh=65*Math.PI/180,"capsule"===i.collider.type?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=i.collider.height/2-i.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=i.collider.height*K8/this.pixelsPerMeter,this.stepThresh=.3*i.collider.height/this.pixelsPerMeter,this.colliderHeight=i.collider.height):"sphere"===i.collider.type?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*i.collider.radius*K8/this.pixelsPerMeter,this.stepThresh=2*i.collider.radius*.3/this.pixelsPerMeter,this.colliderHeight=2*i.collider.radius):(this.offset=i.collider.height*K8/this.pixelsPerMeter,this.stepThresh=.3*i.collider.height/this.pixelsPerMeter,this.colliderHeight=i.collider.height),this.collider.type=i.collider.type;let I=(new j_).fromArray(i.collider.position),k=(new V_).setFromEuler((new TC).fromArray([...i.collider.rotation,"XYZ"]));this.collider.position.copy(I).multiply(this.scale),this.collider.rotation.copy(k),this.collider.matrix.compose(I,k,h9),void 0!==i.cameraXAxis&&(this.cameraXAxis=i.cameraXAxis,this.cameraYAxis=i.cameraYAxis,this.minPolarAngle=i.cameraRotXLimits[0],this.maxPolarAngle=i.cameraRotXLimits[1],this.minAzimuthAngleRel=i.cameraRotYLimits[0],this.maxAzimuthAngleRel=i.cameraRotYLimits[1]),this.forwardDir=null!==(M=i.forwardDirection)&&void 0!==M?M:"-z",this.isFirstPerson&&(this.forwardDir="-z"),this.runMultiplier=null!==(T=i.runMultiplier)&&void 0!==T?T:2;let R=2*i.navmesh.destinationHelperRadius;if(R>0){let e=new UN;e.push({fi:0,data:c(c({},sj.defaultData("light","phong")),{},{alpha:0}),id:"layer1"}),e.push({fi:0,data:c(c({},sj.defaultData("color")),{},{color:i.navmesh.destinationHelperColor,alpha:i.navmesh.destinationHelperColor.a}),id:"layer2"});let t=new sJ({layers:e},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new OE($G.create({parameters:{width:R,height:R/10,hollow:.7}}),t),this.navMeshPathDest.material.userData.opacity0=i.navmesh.destinationHelperColor.a}this.activate()}reset(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),e){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let e=(new TC).setFromQuaternion(this.quaternion,"YXZ"),t=e.y;this.objectRealQuat.copy(this.quaternion),e.y=0,this.quaternion.setFromEuler(e),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),e.set(0,t,0),this.quaternion.setFromEuler(e),this.rot.setFromEuler(e),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof h0?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();!0===this.cameraFollow&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var e;this.deactivate(),(null===(e=this.navMeshPathDest)||void 0===e?void 0:e.parent)&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let e=this.data,t=this.sharedAssets;void 0!==e.gameActions&&(this.actions={},oW.list.forEach(i=>{this.actions[i]=B8(c(c({},e),{},{disabled:!1,type:"GameControl"}),e.gameActions[i],this.page,t,this.controlsManager.eventManager,this.object)})),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),N8(this.actions.idle),N8(this.actions.move),N8(this.actions.run),N8(this.actions.jump)}dispatchStartEvent(e){void 0!==this.actions[e]&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].Transition.forEach(e=>{e.play()}),this.actions[e].Animation.forEach(e=>{e.play(!1===this.initialAction)}),this.actions[e].Create.forEach(e=>{e.dispatchStart()}),this.actions[e].Audio.forEach(e=>{e.dispatchGameControl("start")}),this.actions[e].Particles.forEach(e=>{e.dispatchGameControl("start")})))}dispatchStopEvent(e){void 0!==this.actions[e]&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].Transition.forEach(e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})}),this.actions[e].Create.forEach(e=>{e.dispatchStop()}),this.actions[e].Audio.forEach(e=>{e.dispatchGameControl("stop")}),this.actions[e].Particles.forEach(e=>{e.dispatchGameControl("stop")})))}get colliderWorldPosition(){return e9.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(e,t,i){var n;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let r=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let a=60*r,o=!1;if(this.usePhysics&&this.collisionEnabled){var s;let e=t9.set(0,(0===this.velocity.y?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/120,1)*(this.gravity>0?1:-1):this.velocity.y)*r,0).divideScalar(this.pixelsPerMeter),t=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,e,null===(s=this.object.rigidBody)||void 0===s?void 0:s.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(t){var l;this.onObject=!0,this.groundNormal.set(t.normal2.x,t.normal2.y,t.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(o=!0),0===(null===(l=t.collider.parent())||void 0===l?void 0:l.bodyType())&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let e=t.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(t.rigidBody===e&&t.userData.isFollowingObj!==this.object.uuid){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(e9,s9,t9),this.groundVelocity.subVectors(e9,t.prevT),this.object.getWorldPosition(t9).add(this.collider.position).sub(e9),this.groundYRotation=l9.setFromQuaternion(s9).y-t.prevR.y,i9.copy(t9).applyAxisAngle(d9,this.groundYRotation),this.groundVelocity.add(i9.sub(t9)).divideScalar(r);break}}else this.onObject=!1}if("walk"===this.moveMode&&this.collisionEnabled&&(1===this.movementState.jump&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*a),"fly"===this.moveMode&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,"+z"===this.forwardDir&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let e=this.navMeshPathDest.material;if("walk"===this.moveMode&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let t=e9.subVectors(this.path[1],this.position),i=t9.subVectors(this.path[1],this.path[0]);t.dot(i)<0?this.path.shift():(this.directionXZ.x=i.x,this.directionXZ.z=i.z),e.opacity=e.userData.opacity0}else e.opacity-=.05*e.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,("walk"===this.moveMode?this.velocityTarget.x+this.velocityTarget.z===0:0===this.velocityTarget.manhattanLength())?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),"walk"===this.moveMode&&(this.lerpFactorPos.y=1),!1===this.didHit&&0===this.pushedVelocity.manhattanLength()||!1===this.usePhysics?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**a),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**a),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**a)):this.velocity.copy(this.velocityTarget),("walk"===this.moveMode?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let c=$8.copy(this.velocity);if("none"!==this.orientMode&&!1===this.isFirstPerson){let e=t9.copy(c);e.y=0,c.set(0,c.y,e.length()*("+z"===this.forwardDir?1:-1))}if(this.directionXZ.manhattanLength()>0&&"none"!==this.orientMode&&!1===this.isFirstPerson)if("camera"===this.orientWith&&this.path.length<=1){let e=e9;this.camera.getWorldDirection(e);let t=i9.copy(d9).multiplyScalar(e.dot(d9));e.sub(t);let i=t9.copy(this.directionXZ);i.x*=-1,this.rot.y=e.angleTo(i)*(e.cross(i).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*("+z"===this.forwardDir?1:-1);if(l9.setFromVector3(this.rot),"walk"===this.moveMode&&(l9.x=0),c.applyEuler(l9),o&&(s9.setFromUnitVectors(d9,this.groundNormal),c.applyQuaternion(s9)),i){let e=l9.set(0,this.vrEulerYOffset*v9,0);i.applyEuler(e),c.x+=i.x,c.z+=i.z,this.nonColliderPosOffset.elements[13]+=i.y*r}if(!0===this.usePhysics){let e=t9;this.pushedVelocity.set(0,0,0);for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){let i=i9.setFromMatrixPosition(t.matrixWorld).sub(t.prevT).divideScalar(r).divideScalar(this.pixelsPerMeter),n=t.rigidBody.collider(0).castCollider(i,this.object.rigidBody.collider(0),e9.copy(c).divideScalar(this.pixelsPerMeter),r,!1);i.multiplyScalar(this.pixelsPerMeter);let a=PG.is(t)?t:t.object;if(null!==n&&this.lastHitObj!==a){let e;t instanceof IG&&(e=t);let i=this.sharedGameControlGlobals.entityToCollisionEvents[a.uuid];if(i)for(let t of i)"character"===t.data.target&&(t.dispatch(e),a.dispatchEvent(Wee));this.lastHitObj=a}if(null!==n){this.pushedVelocity.copy(i),e.copy(n.normal1).applyQuaternion(t.quaternion);break}}if(0!==this.pushedVelocity.manhattanLength()){let t=e.dot(c);t<0&&c.addScaledVector(e,-t),c.add(this.pushedVelocity)}else c.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),"normal"===this.rotationMode&&(this.movementState.rotPosX||this.movementState.rotNegX)||"steer"===this.rotationMode&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||"walk"===this.moveMode)?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,"normal"===this.rotationMode&&(this.movementState.rotPosY||this.movementState.rotNegY)||"steer"===this.rotationMode&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(r),this.rotVelocityStick),0===this.rotVelocityTarget.manhattanLength()?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**a):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**a),this.euler.x+=this.rotVelocity.x*r,this.euler.y+=this.rotVelocity.y*r+this.groundYRotation,0===this.rotVelocityTarget.y&&0===this.directionXZ.manhattanLength()?this.rotationAccumWhenOrientWithCamera=0:(!1===this.cameraFollow||"Locked"===this.cameraYAxis)&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*r),!1===this.isFirstPerson&&"none"!==this.orientMode&&this.directionXZ.manhattanLength()>0){if("radial"===this.orientMode){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(d9,this.euler.y-this.euler0.y);let e=t9.copy(this.objectToCamXZ).normalize(),t=i9.copy(c).multiplyScalar(r);t.y=0;let i=t.sub(e9.copy(e).multiplyScalar(t.dot(e))).cross(e).y;this.euler.y-=Math.atan2(i,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*r+this.groundYRotation,0!==this.rotVelocityTarget.y&&(!1===this.cameraFollow||"Locked"===this.cameraYAxis)&&(this.euler.y=this.rot.y);if(!0===this.cameraFollow&&("walk"===this.moveMode?"Limit"===this.cameraXAxis?this.euler.x=h_.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=h_.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):"Limit"===this.cameraXAxis&&(this.euler.x=h_.clamp(this.euler.x,-this.PI_2,this.PI_2))),"fly"===this.moveMode?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(l9.copy(t),l9.y=0):(l9.copy(this.euler),l9.y=0),this.nonColliderRotOffset.makeRotationFromEuler(l9)),t&&("walk"===this.moveMode?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*v9),o9.setFromAxisAngle(c9,this.rot.x),s9.setFromAxisAngle(d9,this.rot.y),s9.multiply(o9),o9.setFromAxisAngle(u9,this.rot.z),s9.multiply(o9),this.quaternion.copy(s9),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){var d,u;let e=t9.copy(c).multiplyScalar(r/this.pixelsPerMeter),t=null;this.didHit=!1;let i=new j_;for(let n=0;n<5;n++){var h;let r=e.length(),a=i9.copy(e).normalize();if(t=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(i),this.colliderWorldQuat,a,null===(h=this.object.rigidBody)||void 0===h?void 0:h.collider(0).shape,r,!1,24,void 0,void 0,this.object.rigidBody),null===t){0===n&&0!==this.directionXZ.manhattanLength()&&(this.lastHitObj=null),i.add(e);break}{this.didHit=!0;let o=this.sharedGameControlGlobals.colliderToEntity.get(t.collider.handle);if(o!==this.lastHitObj&&0===n){this.lastHitObj=o;let e=this.sharedGameControlGlobals.entityToCollisionEvents[null===o||void 0===o?void 0:o.uuid];if(e)for(let i of e)if("character"===i.data.target){var p;let e,n=(null===(p=this.sharedGameControlGlobals.rapierWorld)||void 0===p?void 0:p.getCollider(t.collider.handle))._parent;if(o.cloner)for(let t of o.cloner.children)if(t.rigidBody===n){e=t;break}i.dispatch(e),o.dispatchEvent(Wee)}}let s=Z8.set(t.normal2.x,t.normal2.y,t.normal2.z).applyQuaternion(this.colliderWorldQuat),l=J8.copy(a).multiplyScalar(t.toi).dot(s),c=t.toi;if(0===c&&(this.position.y+=this.offset*this.pixelsPerMeter),l>this.offset&&(c=t.toi*(l-this.offset)/l,i.addScaledVector(a,c)),e.copy(a).multiplyScalar(r-c),Math.acos(-s.y)>this.slopeThresh){var f;let n=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(i),r=i9.copy(t.witness2).applyQuaternion(this.colliderWorldQuat);r.y=0;let a=n.add(r);a.y+=this.stepThresh;let o=this.sharedGameControlGlobals.rapierWorld.castShape(a,this.colliderWorldQuat,e,null===(f=this.object.rigidBody)||void 0===f?void 0:f.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);null!==o&&0===o.toi&&(s.y=0,s.normalize())}e.addScaledVector(s,-e.dot(s))}}this.position.addScaledVector(i,this.pixelsPerMeter),null!==(d=this.object.rigidBody)&&void 0!==d&&d.setTranslation(e9.copy(this.position).divideScalar(this.pixelsPerMeter),!0),null===(u=this.object.rigidBody)||void 0===u||u.setRotation(o9.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let e=this.onObject?1:5,t=c.multiplyScalar(r/e);for(let i=0;i<e;i++)this.position.add(t),this.collisionAdjustment(r/e)}else this.position.addScaledVector(c,r);if("walk"===this.moveMode&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),!0===this.cameraFollow){this.updateFollowArms();let e=this.objectToTarget.add(this.position),t=this.targetToCamera.add(e);n9.lookAt(t,e,d9).setPosition(t),n9.decompose(this.targetPos,this.targetQuat,e9),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**a),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**a),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),"Limit"===this.cameraYAxis&&"cartesian"===this.orientMode&&(this.euler.y=h_.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=h_.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(g9),(!(this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(void 0===this.camera||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate))||"fly"!==this.moveMode&&!0!==this.onObject&&!1!==this.collisionEnabled||!(null===this.navMeshPathDest||this.navMeshPathDest.material.opacity<-.04*(null===(n=this.navMeshPathDest)||void 0===n||null===(n=n.material)||void 0===n?void 0:n.userData.opacity0)))&&(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(m9),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e,t=o9.setFromAxisAngle(d9,"Limit"===this.cameraYAxis&&"radial"!==this.orientMode?h_.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);("Locked"!==this.cameraYAxis||"radial"===this.orientMode)&&this.objectToTarget.applyQuaternion(t),e="Limit"===this.cameraXAxis?h_.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):h_.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let i=e9.copy(this.cameraPolarAxis0);("Locked"!==this.cameraYAxis||"radial"===this.orientMode)&&i.applyQuaternion(t);let n=s9.setFromAxisAngle(i,e);"Locked"!==this.cameraYAxis&&this.targetToCamera.applyQuaternion(t),"Locked"!==this.cameraXAxis&&this.targetToCamera.applyQuaternion(n)}groundTiltAdjustment(e){180*d9.angleTo(e)/Math.PI<15||180*d9.angleTo(e)/Math.PI>85?o9.identity():o9.setFromUnitVectors(d9,e),this.groundTilt.slerp(o9,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(e){var t;let i=J8.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let n=n9.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(e9,o9,t9).compose(e9,o9,h9);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(e=>{if(e===this.object||e.isDescendantOf(this.object))return;f9.makeEmpty(),e.updateMatrixWorldSVD();let t=e.matrixWorldRigid,r=r9.copy(t).invert(),a=a9.copy(r9).multiply(n);p9.copy(this.collider.segment),p9.start.applyMatrix4(a),p9.end.applyMatrix4(a);let o=Z8.copy(this.position).applyMatrix4(r);f9.expandByPoint(p9.start),f9.expandByPoint(p9.end),f9.min.addScalar(-this.collider.radius),f9.max.addScalar(this.collider.radius),e.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder:e=>e.distanceToPoint(p9.end),intersectsBounds:e=>e.intersectsBox(f9),intersectsTriangle:e=>{let n=e9,r=t9,a=e.closestPointToSegment(p9,n,r);if(a<this.collider.radius){let e=this.collider.radius-a,s=r.sub(n).normalize(),l=i9.copy(o);l.addScaledVector(s,e);let c=l.applyMatrix4(t).sub(this.position);i.add(c),p9.start.addScaledVector(s,e),p9.end.addScaledVector(s,e)}}})}),f9.makeEmpty(),p9.copy(this.collider.segment),p9.start.applyMatrix4(n),p9.end.applyMatrix4(n),f9.expandByPoint(p9.start),f9.expandByPoint(p9.end),f9.min.addScalar(-this.collider.radius),f9.max.addScalar(this.collider.radius),null!==(t=this.sharedGameControlGlobals.staticMeshBVH)&&void 0!==t&&t.shapecast({traverseBoundsOrder:e=>e.distanceToPoint(p9.end),intersectsBounds:e=>e.intersectsBox(f9),intersectsTriangle:e=>{let t=e9,n=t9,r=e.closestPointToSegment(p9,t,n);if(r<this.collider.radius){let e=this.collider.radius-r,a=n.sub(t).normalize();this.alignToGround&&this.groundTiltAdjustment(a),i.addScaledVector(a,e),p9.start.addScaledVector(a,e),p9.end.addScaledVector(a,e)}}}),this.onObject=Math.abs(i.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let r=Math.max(0,i.length()-1e-5);i.normalize().multiplyScalar(r),this.position.add(i)}pause(){this.firstPointerId=-1,this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.deactivate()}resume(){this.activate()}},b9=y9;b9.isLocked=!1;var x9=Ow(Rw());function w9(e){let t=e.elements,i=t[0]**2+t[1]**2+t[2]**2,n=t[4]**2+t[5]**2+t[6]**2,r=t[8]**2+t[9]**2+t[10]**2,a=t[0]**2+t[4]**2+t[8]**2,o=t[1]**2+t[5]**2+t[9]**2,s=t[2]**2+t[6]**2+t[10]**2,l=1e-8;return i<l||n<l||r<l||a<l||o<l||s<l}function S9(e,t){let i=new vE;if(t&&w9(t))return i.setAttribute("position",new cE([],3)),i.setIndex([]),i;if(!e.getAttribute("position"))return i.setAttribute("position",new cE([],3)),i.setIndex([]),i;let{positions:n,triIndices:r}=QY(e.getAttribute("position"),e.getIndex());return i.setAttribute("position",new cE(n,3)),i.setIndex(r),t&&i.applyMatrix4(t),i}var _9=new yC,C9=new yC,E9=[[0,0,0],[0,0,0],[0,0,0]];function A9(e){let t=e.elements;E9[0][0]=t[0],E9[0][1]=t[4],E9[0][2]=t[8],E9[1][0]=t[1],E9[1][1]=t[5],E9[1][2]=t[9],E9[2][0]=t[2],E9[2][1]=t[6],E9[2][2]=t[10];let{u:i,v:n}=(0,x9.SVD)(E9),r=_9.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),a=C9.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1);return r.multiply(a.transpose())}var M9=class extends bO{constructor(){super(),this.layers.enable(3),this.layers.enable(8),this.layers.enable(9)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.forEach(e=>{e.visible&&this.intersectObject(e,t,i)}),i}createRaycastLineHelper(){let e=new XT({color:65280,linewidth:10}),t=new j_(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),i=new j_(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),n=this.camera.far-this.camera.near,r=(new j_).addVectors(t,i.multiplyScalar(n)),a=new vE;return a.setFromPoints([t,r]),new $T(a,e)}},T9=e=>e instanceof M0||e instanceof j3;function P9(e,t){return e.distance-t.distance}function D9(e,t,i){if(XG(t)&&t.visible){b0(t)&&t.raycast(e,i);for(let n of t.children)D9(e,n,i)}}function O9(e,t,i){if(!(arguments.length>3&&void 0!==arguments[3]&&arguments[3])&&!i.some(t=>void 0!==R9(e,t)))return[];let n=[];return t.children.forEach(t=>D9(e,t,n)),n.sort(P9),n}function I9(e){let t=[];if(e.length){let i=e[0].object;XG(i)&&t.push(i);let n=i.parent;for(;n;)T9(n)&&t.push(n),n=n.parent}return t}function k9(e,t,i,n){let r=e.frame;if(r){let e=t[0]*r.width,a=(1-t[1])*r.height;for(let t of i){let i=t===r.uuid?r:r.find(t);if(null!==i&&void 0!==i&&i.intersects(e,a))return n(i),!0}}return!1}function R9(e,t){if(b0(t)){if(t.visible){let i=[];return t.raycast(e,i),i.length?i[0]:void 0}}else if(T9(t))return z9(e,t)}function z9(e,t){if(XG(t)&&t.visible){if(b0(t)){let i=[];if(t.raycast(e,i),i.length)return i[0]}for(let i of t.children){let t=z9(e,i);if(t)return t}}}var L9=class{constructor(e,t,i,n,r,a,o,s){this.renderer=e,this.publish=t,this.scene=i,this.getCamera=n,this.sharedAssets=r,this.requestRender=a,this.isExport=o,this.frame=s,this.raycaster=new M9,this._useWindowEvents=!1,this.pointerWorld={x:0,y:0},this.pointerScreen={x:0,y:0},this._useWindowEvents="window"===t.mouseEventTarget,this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement,this._domRect=this.domElement.getBoundingClientRect()}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}set domRect(e){this._domRect=e}get domRect(){return this._domRect}updateRaycaster(e){var t;let{pageX:i,pageY:n}=(null===(t=e.touches)||void 0===t?void 0:t.length)>0?e.touches[0]:e;this.pointerWorld=function(e,t,i){return{x:(e-(i.left+window.scrollX))/i.width*2-1,y:-(t-(i.top+window.scrollY))/i.height*2+1}}(i,n,this._domRect),this.pointerScreen=function(e,t,i){return{x:(e-(i.left+window.scrollX))/i.width,y:1-(t-(i.top+window.scrollY))/i.height}}(i,n,this._domRect),this.raycaster.setFromCamera(this.pointerWorld,this.getCamera())}},B9=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},N9=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],F9=e=>{var t;return null===(t=N9.find(t=>{let[i,n]=t;return n===e}))||void 0===t?void 0:t[0]},U9=e=>{var t;return null===(t=N9.find(t=>{let[i]=t;return i===e}))||void 0===t?void 0:t[1]},V9=(e,t)=>{let i=F9(e);if(i){let e=new CustomEvent(i,{bubbles:!0});return Object.defineProperty(e,"target",{writable:!1,value:t}),e}},j9=class extends B9{constructor(){super(...arguments),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=e=>{var t;if(!e.eventName||!e.target||"Scroll"===e.eventName)return;let i=null===(t=this.splineEvents[F9(e.eventName)])||void 0===t?void 0:t[e.target.uuid];if(!i)return;"Scroll"===e.eventName&&void 0!==e.deltaY&&Object.assign(i,{deltaY:e.deltaY});let{domElement:n}=this.eventContext;n.dispatchEvent(i)}}connect(){let{page:e}=this.eventContext;e.traverseEntity(e=>{var t;if(null!==(t=e.data)&&void 0!==t&&t.events.length)for(let[n,r]of N9)if(e.data.events.some(e=>e.data.type===r&&!e.data.disabled)){var i;this.objectsPerEvents.has(n)?null===(i=this.objectsPerEvents.get(n))||void 0===i||i.push(e):this.objectsPerEvents.set(n,[e]);let t={id:e.uuid,name:e.name},a=V9(r,t),o=this.splineEvents[n];o?o[e.uuid]=a:this.splineEvents[n]={[e.uuid]:a}}}),this.objectsPerEvents.forEach(e=>{e.forEach(e=>{e.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(e=>{e.forEach(e=>{e.removeEventListener("beginEvent",this.onBeginEvent)})})}},W9=class{constructor(e,t,i,n,r,a){if(this.id=e,this.data=t,this.object=i,this.entered=!1,("KeyDown"===t.type||"KeyUp"===t.type||"KeyPress"===t.type)&&!t.key)throw new Error("Missing property");this.actions=B8(t,t.actions,n,r,a,i)}disconnect(){N8(this.actions)}dispatchHeld(e){this.actions.Create.forEach(t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()})}dispatch(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),"MousePress"===this.data.type||"KeyPress"===this.data.type?this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStart())):(this.actions.Transition.some(e=>e.playing&&"Toggle"!==e.data.runMode)||this.actions.Transition.forEach(e=>{"Toggle"===e.data.runMode?e.toggle():e.play()}),this.actions.SwitchCamera.some(e=>e.playing&&"Toggle"!==e.data.runMode)||this.actions.SwitchCamera.forEach(e=>{"Toggle"===e.data.runMode?e.toggle():e.play()}),this.actions.Animation.forEach(e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),!1===e&&this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()}),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch())}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStop()))}dispatchUserEvent(e){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),e?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()}),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch())}},H9=class extends B9{constructor(e,t,i){super(e),this.eventManager=t,this.useForRaycastProperty=i,this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.sceneInterects=null,this.onCanvasRaycast=e=>{if(!0===this.useForRaycastProperty&&null===this.sceneInterects){this.eventContext.updateRaycaster(e);let{raycaster:t,page:i}=this.eventContext,n=O9(t,i,[],!0);this.sceneInterects=n,n.length&&(this.eventContext.sharedAssets.raycastProperty={x:n[0].point.x,y:n[0].point.y,z:n[0].point.z,objX:n[0].object.matrixWorld.elements[12],objY:n[0].object.matrixWorld.elements[13],objZ:n[0].object.matrixWorld.elements[14]})}},this.onCanvasMouseDown=e=>{(e.target===this.eventContext.domElement||"SPLINE-VIEWER"===e.target.tagName)&&this.canvasMouseEvents.forEach(t=>{("MouseDown"===t.data.type||"MousePress"===t.data.type)&&(this.onCanvasRaycast(e),t.dispatch())})},this.onCanvasMouseUp=e=>{(e.target===this.eventContext.domElement||"SPLINE-VIEWER"===e.target.tagName)&&this.canvasMouseEvents.forEach(t=>{"MouseUp"===t.data.type?(this.onCanvasRaycast(e),t.dispatch()):"MousePress"===t.data.type&&t.dispatchRelease()})},this.onMouseDown=e=>{hN.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseEvent("MouseDown"))},this.onMouseUp=e=>{hN.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=e=>{hN.length>1||(this.eventContext.updateRaycaster(e),this.handleMousePressEvent())},this.onMousePressRelease=e=>{hN.length>1||(this.eventContext.updateRaycaster(e),this.handleMousePressEvent(!0))},this.onKeyDown=e=>{this.heldKeys[e.key]||(this.handleKeyEvent(e,"KeyDown"),this.handleKeyEventHeld(e,"KeyDown",!0)),this.heldKeys[e.key]=!0},this.onKeyUp=e=>{this.handleKeyEvent(e,"KeyUp"),this.handleKeyEventHeld(e,"KeyUp",!0)},this.onKeyPressDown=e=>{this.heldKeysPress[e.key]?this.handleKeyEventHeld(e,"KeyPress"):(this.handleKeyEvent(e,"KeyPress"),this.handleKeyEventHeld(e,"KeyPress",!0)),this.heldKeysPress[e.key]=!0},this.onKeyPressUp=e=>{this.handleKeyEvent(e,"KeyPress",!0)},this.releaseHeldKey=e=>{delete this.heldKeys[e.key]},this.releaseHeldKeyPress=e=>{delete this.heldKeysPress[e.key]},this._onUserEvent=e=>{var t,i;let{eventName:n,target:r,reverse:a}=e;if(!n||!r)return;let o=U9(n);o&&("MouseDown"===o||"MouseUp"===o||"MousePress"===o?(r.dispatchEvent({type:"beginEvent",eventName:o}),null===(t=this.eventsPerObjects[o])||void 0===t||null===(t=t[r.uuid])||void 0===t||t.forEach(e=>{e.dispatchUserEvent(a)})):("KeyDown"===o||"KeyUp"===o||"KeyPress"===o)&&(r.dispatchEvent({type:"beginEvent",eventName:o}),null===(i=this.eventsPerObjects[o])||void 0===i||null===(i=i[r.uuid])||void 0===i||i.forEach(e=>{e.dispatchUserEvent()})))}}connect(){var e,t,i,n,r,a;let{page:o,sharedAssets:s,domElement:l}=this.eventContext,c=(e,t)=>{var i;if(null===(i=e.data)||void 0===i||!i.events.length)return;let n=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let a of n){var r;let i=this.eventsPerObjects[a];if(e.data.events.filter(e=>{let{data:t}=e;return t.type===a&&!0!==t.disabled}).forEach(t=>{let{id:n,data:r}=t;try{let t=new W9(n,r,e,o,s,this.eventManager);t.actions.Video.length&&(this.hasVideoAction=!0),"MouseDown"!==r.type&&"MouseUp"!==r.type&&"MousePress"!==r.type||"Canvas"!==r.mode&&"Window"!==r.mode?(i[e.uuid]?i[e.uuid].some(e=>e.id===t.id)||i[e.uuid].push(t):i[e.uuid]=[t],e instanceof v4&&e.traverseChildren(e=>{var n;if(!e.visible)return!0;e instanceof r$&&2!==(null===(n=e.data.geometry.shapeBlendNode)||void 0===n?void 0:n.operation)&&(i[e.uuid]?i[e.uuid].push(t):i[e.uuid]=[t])})):this.canvasMouseEvents.push(t)}catch(a){}}),null!==(r=i[e.uuid])&&void 0!==r&&r.length&&(this.objectsPerTypes[a].push(e instanceof j2&&("MouseDown"===a||"MouseUp"===a||"MousePress"===a)?t:e),e instanceof v4)){let t=this.objectsPerTypes[a];e.traverseChildren(e=>{if(!e.visible)return!0;e instanceof r$&&-1===t.indexOf(e)&&t.push(e)})}}};o.traverseEntity(e=>{var t;(e instanceof X3||e instanceof B3)&&null!==(t=e.frame)&&void 0!==t&&t.traverse(t=>{c(t,e)}),c(e)}),this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),l.addEventListener("pointerdown",this.onCanvasMouseDown),l.addEventListener("pointerup",this.onCanvasMouseUp),(null!==(e=this.objectsPerTypes.MouseDown)&&void 0!==e&&e.length||this.useForRaycastProperty)&&(this.domEventsNeeded.add("pointerdown"),l.addEventListener("pointerdown",this.onMouseDown)),null!==(t=this.objectsPerTypes.MouseUp)&&void 0!==t&&t.length&&(this.domEventsNeeded.add("pointerup"),l.addEventListener("pointerup",this.onMouseUp)),null!==(i=this.objectsPerTypes.MousePress)&&void 0!==i&&i.length&&(this.domEventsNeeded.add("pointerdown"),l.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),l.addEventListener("pointerup",this.onMousePressRelease)),null!==(n=this.objectsPerTypes.KeyDown)&&void 0!==n&&n.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),null!==(r=this.objectsPerTypes.KeyUp)&&void 0!==r&&r.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),null!==(a=this.objectsPerTypes.KeyPress)&&void 0!==a&&a.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(e=>{let[t,i]=e;i.forEach(e=>{e.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},e.removeEventListener("pointerdown",this.onCanvasMouseDown),e.removeEventListener("pointerup",this.onCanvasMouseUp),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(e=>{Object.values(e).forEach(e=>{e.forEach(e=>{e.disconnect()})})}),this.canvasMouseEvents.forEach(e=>{e.disconnect()}),Object.entries(this.objectsPerTypes).forEach(e=>{let[t,i]=e;i.forEach(e=>{e.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(e){let{stopRaycast:t,raycaster:i,page:n,pointerScreen:r}=this.eventContext,a=this.objectsPerTypes[e],o=a.filter(e=>!(e instanceof j2));if((a.length||this.useForRaycastProperty)&&(!n.uiCanvas||!k9(n,[r.x,r.y],Object.keys(this.eventsPerObjects[e]),t=>{this.handleObjectMouseEventDispatch(t,e)}))){if(t||this.useForRaycastProperty){let r;if(null===this.sceneInterects?r=O9(i,n,o,this.useForRaycastProperty):(r=this.sceneInterects,this.sceneInterects=null),this.useForRaycastProperty&&r.length&&(this.eventContext.sharedAssets.raycastProperty={x:r[0].point.x,y:r[0].point.y,z:r[0].point.z,objX:r[0].object.matrixWorld.elements[12],objY:r[0].object.matrixWorld.elements[13],objZ:r[0].object.matrixWorld.elements[14]}),t){var s,l,c,d;let t=[null!==(s=null===(l=r[0])||void 0===l||null===(l=l.uv)||void 0===l?void 0:l.x)&&void 0!==s?s:0,null!==(c=null===(d=r[0])||void 0===d||null===(d=d.uv)||void 0===d?void 0:d.y)&&void 0!==c?c:0];I9(r).forEach(i=>{i instanceof X3&&k9(i,t,Object.keys(this.eventsPerObjects[e]),t=>{this.handleObjectMouseEventDispatch(t,e)}),this.eventsPerObjects[e][i.uuid]&&this.handleObjectMouseEventDispatch(i,e)})}}t||o.forEach(t=>{var n,r,a,o;let s=R9(i,t);s&&(this.handleObjectMouseEventDispatch(t,e),t instanceof X3&&k9(t,[null!==(n=null===s||void 0===s||null===(r=s.uv)||void 0===r?void 0:r.x)&&void 0!==n?n:0,null!==(a=null===s||void 0===s||null===(o=s.uv)||void 0===o?void 0:o.y)&&void 0!==a?a:0],Object.keys(this.eventsPerObjects[e]),t=>{this.handleObjectMouseEventDispatch(t,e)}))})}}handleMousePressEvent(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="MousePress",i=this.objectsPerTypes[t],n=i.filter(e=>!(e instanceof j2)),r=[];if(i.length){if(!e){let{stopRaycast:e,raycaster:i,page:a,pointerScreen:o}=this.eventContext,s=!1;if(a.uiCanvas&&(s=k9(a,[o.x,o.y],Object.keys(this.eventsPerObjects[t]),e=>{r.push(e)})),e&&!s){let e=O9(i,a,n);r=I9(e),e.forEach(e=>{var i,n,a,o;e.object instanceof X3&&k9(e.object,[null!==(i=null===e||void 0===e||null===(n=e.uv)||void 0===n?void 0:n.x)&&void 0!==i?i:0,null!==(a=null===e||void 0===e||null===(o=e.uv)||void 0===o?void 0:o.y)&&void 0!==a?a:0],Object.keys(this.eventsPerObjects[t]),e=>{r.push(e)})})}else n.forEach(e=>{var n,a,o,s;let l=R9(i,e);l&&(r.push(e),e instanceof X3&&k9(e,[null!==(n=null===l||void 0===l||null===(a=l.uv)||void 0===a?void 0:a.x)&&void 0!==n?n:0,null!==(o=null===l||void 0===l||null===(s=l.uv)||void 0===s?void 0:s.y)&&void 0!==o?o:0],Object.keys(this.eventsPerObjects[t]),e=>{r.push(e)}))})}this._prevObjects.length&&this._prevObjects.forEach(e=>{r.includes(e)||this.handleObjectMouseEventDispatchRelease(e,t)}),r.length&&r.forEach(e=>{this.handleObjectMouseEventDispatch(e,t)}),this._prevObjects=r}}handleObjectMouseEventDispatch(e,t){var i;e.dispatchEvent({type:"beginEvent",eventName:t}),null===(i=this.eventsPerObjects[t])||void 0===i||null===(i=i[e.uuid])||void 0===i||i.forEach(e=>{e.dispatch()})}handleObjectMouseEventDispatchRelease(e,t){var i;e.dispatchEvent({type:"beginEvent",eventName:t}),null===(i=this.eventsPerObjects[t])||void 0===i||null===(i=i[e.uuid])||void 0===i||i.forEach(e=>{e.dispatchRelease()})}handleKeyEvent(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.objectsPerTypes[t].forEach(n=>{let r=this.eventsPerObjects[t][n.uuid];r.some(t=>{let{data:i}=t;return"key"in i&&i.key===e.key})&&n.dispatchEvent({type:"beginEvent",eventName:t}),r.forEach(t=>{"key"in t.data&&t.data.key===e.key&&(i?t.dispatchRelease():t.dispatch(!0))})})}handleKeyEventHeld(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.objectsPerTypes[t].forEach(n=>{this.eventsPerObjects[t][n.uuid].forEach(t=>{"key"in t.data&&t.data.key===e.key&&t.dispatchHeld(i)})})}},G9=new j_,q9=new j_,X9=class{constructor(e,t,i,n,r){this.actionsIn=B8(e,e.inActions,i,n,r,t),this.actionsOut=B8(e,e.outActions,i,n,r,t)}disconnect(){N8(this.actionsIn),N8(this.actionsOut)}},Y9=class extends X9{constructor(e,t,i,n,r,a){super(t,i,n,r,a),this.id=e,this.data=t,this.object=i,this.stage="out",this.objects=[],this.onUpdateMatrixWorld=()=>{for(let n of this.objects)if(!n.visible)return;let e=G9.setFromMatrixPosition(this.objects[0].matrixWorld),t=q9.setFromMatrixPosition(this.objects[1].matrixWorld),i=e.distanceTo(t)<=this.distance?"in":"out";if(this.stage!==i){this.stage=i;let e="in"===i?this.actionsIn:this.actionsOut;e.Audio.forEach(e=>e.dispatchConditional()),e.Particles.forEach(e=>e.dispatchConditional()),e.Video.forEach(e=>e.dispatchConditional()),e.Link.forEach(e=>e.dispatch()),e.Create.forEach(e=>e.dispatch()),e.Destroy.forEach(e=>e.dispatch()),e.Reset.forEach(e=>e.dispatch()),e.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()}),e.Transition.forEach(e=>e.play()),e.Animation.forEach(e=>e.play()),e.SwitchCamera.forEach(e=>e.play()),e.SceneTransition.forEach(e=>e.dispatch()),e.SetVariable.forEach(e=>e.checkConditions()),e.SetVariable.forEach(e=>e.dispatch()),e.DynamicVariablePlay.forEach(e=>e.dispatch()),e.ClearLocalStorage.forEach(e=>e.dispatch()),e.UserAPI.forEach(e=>e.dispatch())}};let{distance:o,fromObject:s,toObject:l}=t.condition;this.distance=o;for(let c of[s,l]){if(!c)throw new Error("Missing property");let e=n.find(c);if(!e)throw new Error("Missing property");this.objects.push(e)}}connect(){window.setTimeout(()=>{this.objects.forEach(e=>{e.addEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)}),this.onUpdateMatrixWorld()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(e=>{e.removeEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)})}},Q9=class extends X9{constructor(e,t,i,n,r,a){var o,s;super(t,i,n,r,a),this.id=e,this.data=t,this.object=i,this.onBegin=e=>{let{target:t,state:i}=e;this.toState!==i&&(this.actionsOut.Audio.forEach(e=>e.dispatchConditional()),this.actionsOut.Particles.forEach(e=>e.dispatchConditional()),this.actionsOut.Video.forEach(e=>e.dispatchConditional()),this.actionsOut.Link.forEach(e=>e.dispatch()),this.actionsOut.Create.forEach(e=>e.dispatch()),this.actionsOut.Destroy.forEach(e=>e.dispatch()),this.actionsOut.Reset.forEach(e=>e.dispatch()),this.actionsIn.Transition.forEach(e=>e.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(e=>e.play()),this.actionsOut.Animation.forEach(e=>e.play()),this.actionsIn.SwitchCamera.forEach(e=>e.pause()),this.actionsOut.SwitchCamera.forEach(e=>e.play()),this.actionsOut.SceneTransition.forEach(e=>e.dispatch()),this.actionsOut.SetVariable.forEach(e=>e.checkConditions()),this.actionsOut.SetVariable.forEach(e=>e.dispatch()),this.actionsOut.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actionsOut.ClearLocalStorage.forEach(e=>e.dispatch()),this.actionsOut.UserAPI.forEach(e=>e.dispatch()))},this.onComplete=e=>{let{target:t,state:i}=e;this.toState===i&&(this.actionsIn.Audio.forEach(e=>e.dispatchConditional()),this.actionsIn.Particles.forEach(e=>e.dispatchConditional()),this.actionsIn.Video.forEach(e=>e.dispatchConditional()),this.actionsIn.Link.forEach(e=>e.dispatch()),this.actionsIn.Create.forEach(e=>e.dispatch()),this.actionsIn.Destroy.forEach(e=>e.dispatch()),this.actionsIn.Reset.forEach(e=>e.dispatch()),this.actionsOut.Transition.forEach(e=>e.pause()),this.actionsOut.Transition.forEach(e=>e.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(e=>e.play()),this.actionsIn.Animation.forEach(e=>e.play()),this.actionsOut.SwitchCamera.forEach(e=>e.pause()),this.actionsIn.SwitchCamera.forEach(e=>e.play()),this.actionsIn.SceneTransition.forEach(e=>e.dispatch()),this.actionsIn.SetVariable.forEach(e=>e.checkConditions()),this.actionsIn.SetVariable.forEach(e=>e.dispatch()),this.actionsIn.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actionsOut.ClearLocalStorage.forEach(e=>e.dispatch()),this.actionsOut.UserAPI.forEach(e=>e.dispatch()))};let{condition:l}=t;if(!l.object)throw new Error("Missing property");let c=null!==(o=n.find(l.object))&&void 0!==o?o:n.scene.find2D(l.object);if(!c)throw new Error("Missing property");if(this.toObject=c,l.state&&(null===(s=this.toObject.states)||void 0===s||!s[l.state]))throw new Error("Missing property");this.toState=l.state}connect(){MR(this.actionsOut).forEach(e=>{var t;(null===(t=this.actionsOut[e])||void 0===t?void 0:t.length)&&this.toObject.addEventListener("beginState",this.onBegin)}),MR(this.actionsIn).forEach(e=>{var t;(null===(t=this.actionsIn[e])||void 0===t?void 0:t.length)&&this.toObject.addEventListener("completeState",this.onComplete)})}disconnect(){super.disconnect(),MR(this.actionsOut).forEach(e=>{var t;(null===(t=this.actionsIn[e])||void 0===t?void 0:t.length)&&this.toObject.removeEventListener("beginState",this.onBegin)}),MR(this.actionsIn).forEach(e=>{var t;(null===(t=this.actionsIn[e])||void 0===t?void 0:t.length)&&this.toObject.removeEventListener("completeState",this.onComplete)})}},K9=class extends B9{constructor(e,t){super(e),this.eventManager=t,this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1}connect(){super.connect();let{page:e,sharedAssets:t}=this.eventContext;e.traverseEntity(i=>{var n;if(null!==(n=i.data)&&void 0!==n&&n.events.length)for(let{id:r,data:a}of i.data.events)if(!a.disabled&&"Conditional"===a.type)try{let n;"Comparison"===a.condition.type||("Distance"===a.condition.type?n=new Y9(r,a,i,e,t,this.eventManager):"State"===a.condition.type&&(n=new Q9(r,a,i,e,t,this.eventManager))),n&&(this.eventsPerConditions[a.condition.type].push(n),(n.actionsIn.Video.length||n.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch(wV){}}),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(e=>e.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(e=>e.disconnect()))}},Z9=new j_,J9=new j_,$9=new j_,e7=new YE,t7=new j_,i7=new j_,n7=new j_,r7=new V_,a7=new TC,o7=new yC,s7=new f_,l7=new j_,c7=new j_,d7=.2;function u7(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var h7=function(){let e=new yC;return(t,i,n)=>{let r=t.obj;e.copy(r.hiddenMatrix),null!==r.parent&&e.premultiply(r.parent.matrixWorld),e.invert(),r.position.copy(i),"global"===t.reference&&u7(r.position,t.limits),r.position.applyMatrix4(e),"parent"===t.reference?u7(r.position,t.limits):"local"===t.reference&&(r7.copy(t.quat0).invert(),r.position.sub(t.position0),r.position.applyQuaternion(r7),u7(r.position,t.limits),r7.invert(),r.position.applyQuaternion(r7),r.position.add(t.position0)),e.multiply(null!==n&&void 0!==n?n:r.matrixWorld).decompose(t7,r.quaternion,i7),r.updateMatrix(),r.hasNonUniformScale&&(r.updateMatrixWorld(),r.updateMatrixWorldSVD()),r instanceof CQ&&x0(r.parent)&&r.invalidateDownstreamBooleanData(!0)}}(),p7=class{constructor(e,t,i,n,r,a,o){this.object=e,this.id=t,this.data=i,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=0===this.data.resetSpeed?1:8/this.data.resetSpeed+1,this.snapDampingFactor=0===this.data.snapSpeed?1:8/this.data.snapSpeed+1,this.actionsDrag=B8(i,i.dragDropActions.drag,n,r,a,this.object),this.actionsDrop=B8(i,i.dragDropActions.drop,n,r,a,this.object);let s=[];this.data.objects.forEach(e=>{let t=n.find(e);!t||!1!==t.data.visible&&(s.push(t),o[t.uuid]&&o[t.uuid].forEach(e=>{let t=n.find(e);!t||!1!==t.data.visible&&s.push(t)}))}),this.data.dropDestinations.forEach(e=>{let t=n.find(e);!t||!1!==t.data.visible&&(this.dropDestIds.push(t.uuid),o[t.uuid]&&o[t.uuid].forEach(e=>{let t=n.find(e);!t||!1!==t.data.visible&&this.dropDestIds.push(t.uuid)}))}),this.dragItems=s.map(e=>("locked"===this.data.planeMode&&(e.userData.lockedPlane=!0),e.userData.worldPosition0=(new j_).setFromMatrixPosition(e.matrixWorld),{obj:e,fromPosition:(new j_).setFromMatrixPosition(e.matrixWorld),pointStart:new j_,pointEnd:new j_,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:(new j_).copy(e.position),quat0:(new V_).copy(e.quaternion),snapped:!1,orientationMatrix:new yC,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return null!==this.activeIdx?this.dragItems[this.activeIdx]:null}dispose(){N8(this.actionsDrag),N8(this.actionsDrop),this.dragItems.forEach(e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()})}},f7=class extends B9{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=e=>{if(hN.length>1)return;this.eventContext.updateRaycaster(e);let{raycaster:t,page:i}=this.eventContext,n=i.raycastWithClones(t);if(this.lastDropDestination=null,0!==n.length){for(let e of this.events){let t=0;for(let{obj:i,pointEnd:a,pointStart:o}of e.dragItems){if(i===n[0].object||i===n[0].object.object||PG.is(i)&&i.isAncestorOf(n[0].object.uuid)){var r;if(e.activeIdx=t,e.activeDragItem.reset=!1,e.activeDragItem.currentDampingFactor=e.data.dampingFactor,e.activeDragItem.snapped=!1,"hand"===e.data.cursor&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){e.activeDragItem.obj.rigidBody&&e.activeDragItem.obj.rigidBody.setBodyType(2,!0);let t=e.activeDragItem.obj;i.hasNonUniformScale&&i.updateMatrixWorldSVD(),(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(t7,r7,i7),a7.setFromQuaternion(r7),void 0===t.prevR?(t.prevR=a7.clone(),t.prevT=t7.clone()):(t.prevR.copy(a7),t.prevT.copy(t7)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(e.activeDragItem.obj)}return this.calcPlaneIntersectPos(i,o,e.data.plane,e.data.referenceFrame),a.copy(o),(this.eventManager.controlsManager.usePhysics&&"dynamic"===(null===(r=i.data.physics)||void 0===r?void 0:r.rigidBody)||!1===e.data.drop||!1===e.data.resetOnSnapFail)&&e.activeDragItem.fromPosition.setFromMatrixPosition(e.activeDragItem.obj.matrixWorld),this.activeEvent=e,void(this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1))}t++}}this.activeEvent=null}else this.activeEvent=null},this.onPointerMove=e=>{if(hN.length>1)return;this.eventContext.updateRaycaster(e);let{raycaster:t,page:i}=this.eventContext,n=i.raycastWithClones(t);if(0===hN.length){let e=!1;for(let t of this.events){for(let{obj:i}of t.dragItems){var r,a,o;if(i===(null===(r=n[0])||void 0===r?void 0:r.object)||i===(null===(a=n[0])||void 0===a||null===(a=a.object)||void 0===a?void 0:a.object)||PG.is(i)&&i.isAncestorOf(null===(o=n[0])||void 0===o?void 0:o.object.uuid)){switch(e=!0,t.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move")}break}}if(e)break}return void(e||this.setCursor("default"))}if(this.activeEvent&&this.activeEvent.activeDragItem){let e,t=this.activeEvent.activeDragItem;if(t.snapped=!1,this.activeEvent.data.drop&&(e=n.filter(e=>t.obj!==e.object&&!t.obj.isAncestorOf(e.object.uuid)&&!(e.object instanceof M0)&&("all"===this.activeEvent.data.dropOn||this.activeEvent.dropDestIds.some(t=>t===e.object.uuid||i.scene.find(t).isAncestorOf(e.object.uuid))))[0]),e){let i=n7.copy(e.face.normal).applyMatrix3(s7.getNormalMatrix(e.object.matrixWorld));if("center"===this.activeEvent.data.snapTo)t.fromPosition.setFromMatrixPosition(e.object.matrixWorld);else if("surface"===this.activeEvent.data.snapTo){if(t.fromPosition.copy(e.point),"bbox"===this.activeEvent.data.snapSurfaceMode){t7.copy(i).applyMatrix3(s7.setFromMatrix4(t.obj.matrixWorld).transpose());let e=t.obj;t7.x>d7?i7.x=-e.recursiveBBox.min.x:t7.x<-d7&&(i7.x=-e.recursiveBBox.max.x),t7.y>d7?i7.y=-e.recursiveBBox.min.y:t7.y<-d7&&(i7.y=-e.recursiveBBox.max.y),t7.z>d7?i7.z=-e.recursiveBBox.min.z:t7.z<-d7&&(i7.z=-e.recursiveBBox.max.z),i7.applyMatrix3(s7.invert())}else i7.copy(i).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);t.fromPosition.add(i7)}this.activeEvent.data.autoOrient&&(t7.set(0,1,0).cross(i),t7.length()<1e-4&&t7.set(-1,0,0).cross(i),i7.crossVectors(n7,t7),t.orientationMatrix.makeBasis(t7,i7,i)),t.pointStart.copy(t.fromPosition),t.pointEnd.copy(t.pointStart),t.currentDampingFactor=this.activeEvent.snapDampingFactor,t.snapped=!0,this.lastDropDestination!==e.object&&(this.lastDropDestination=e.object,this.activeEvent.actionsDrop.Transition.forEach(e=>{e.play()}),this.activeEvent.actionsDrop.Animation.forEach(e=>{e.play()}),this.activeEvent.actionsDrop.Audio.forEach(e=>{e.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Particles.forEach(e=>{e.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(e=>{e.dispatchThrottled()}))}else t.orientationMatrix.makeRotationFromQuaternion(t.quat0),this.lastDropDestination=null,t.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(t.obj,t.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(e=>{e.stop()}),this.activeEvent.actionsDrop.Audio.forEach(e=>{e.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.Particles.forEach(e=>{e.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(e=>{e.dispatchThrottled()}),this.activeEvent.actionsDrag.SetVariable.forEach(e=>e.checkConditions()),this.activeEvent.actionsDrag.SetVariable.forEach(e=>e.dispatch()),this.activeEvent.actionsDrag.DynamicVariablePlay.forEach(e=>e.dispatch()),this.activeEvent.actionsDrag.ClearLocalStorage.forEach(e=>e.dispatch()),this.activeEvent.actionsDrag.UserAPI.forEach(e=>e.dispatch()),!1===this.activeEvent.wasDragEventTriggered&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(e=>{e.play()}),this.activeEvent.actionsDrag.Animation.forEach(e=>{e.play()}),this.activeEvent.actionsDrag.Audio.forEach(e=>{e.dispatchGameControl("start")}),this.activeEvent.actionsDrag.Particles.forEach(e=>{e.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(e=>{e.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(e=>{e.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(e=>{e.stop()}))},500),this.updateDragItem(t),t.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=e=>{if(this.activeEvent&&this.activeEvent.activeDragItem){var t;"hand"===this.activeEvent.data.cursor&&this.setCursor("grab");let e="dynamic"===(null===(t=this.activeEvent.activeDragItem.obj.data.physics)||void 0===t?void 0:t.rigidBody);!1===this.activeEvent.activeDragItem.snapped&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(!1===this.eventManager.controlsManager.usePhysics||!e)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&e&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),!0===this.activeEvent.wasDragEventTriggered&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(e=>{e.stop()}),this.activeEvent.actionsDrag.Audio.forEach(e=>{e.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(e=>{e.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.SetVariable.forEach(e=>e.checkConditions()),this.activeEvent.actionsDrop.SetVariable.forEach(e=>e.dispatch()),this.activeEvent.actionsDrop.DynamicVariablePlay.forEach(e=>e.dispatch()),this.activeEvent.actionsDrop.ClearLocalStorage.forEach(e=>e.dispatch()),this.activeEvent.actionsDrop.UserAPI.forEach(e=>e.dispatch())),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}}}connect(){let e={};if(this.eventContext.page.traverseEntity(t=>{t.component&&(e[t.component.uuid]?e[t.component.uuid].push(t.uuid):e[t.component.uuid]=[t.uuid])}),this.eventContext.page.traverseEntity(t=>{var i;null===(i=t.data)||void 0===i||i.events.filter(e=>"DragDrop"===e.data.type&&!e.data.disabled).forEach(i=>{this.events.push(new p7(t,i.id,i.data,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager,e))})}),!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let t=this.eventContext.domElement;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let e=this.eventContext.domElement;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(e=>e.dispose())}setCursor(e){this.eventContext.domElement.style.cursor=e}onAnimationFrameDamping(){for(let e of this.events)for(let t of e.dragItems)t.paused||this.updateDragItem(t,!0)}calcPlaneIntersectPos(e,t,i,n){let{getCamera:r,raycaster:a}=this.eventContext;r().getWorldDirection(J9),J9.negate();let o=r7.identity();switch("parent"===n?o7.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix).decompose(t7,o,i7):"local"===n&&e.matrixWorld.decompose(t7,o,i7),i){case"x":t7.set(1,0,0).applyQuaternion(o),l7.copy(J9).cross(t7),c7.copy(t7).cross(l7);break;case"y":t7.set(0,1,0).applyQuaternion(o),l7.copy(J9).cross(t7),c7.copy(t7).cross(l7);break;case"z":t7.set(0,0,1).applyQuaternion(o),l7.copy(J9).cross(t7),c7.copy(t7).cross(l7);break;case"xy":c7.set(0,0,1).applyQuaternion(o);break;case"yz":c7.set(1,0,0).applyQuaternion(o);break;case"xz":c7.set(0,1,0).applyQuaternion(o);break;case"adaptive":J9.angleTo(i7.set(0,1,0))>Math.PI/6?(t7.crossVectors(i7.set(0,1,0),J9),c7.crossVectors(t7,i7)):c7.set(0,1,0);break;default:c7.copy(J9)}$9.setFromMatrixPosition(e.matrixWorld);let s=e.userData.lockedPlane?e.userData.worldPosition0:$9;if(e7.setFromNormalAndCoplanarPoint(c7,s),a.ray.intersectPlane(e7,t)&&("x"===i||"y"===i||"z"===i)){let e=i7.subVectors(t,s).dot(t7);t.copy(s).addScaledVector(t7,e)}}updateDragItem(e){var t,i;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];$9.setFromMatrixPosition(e.obj.matrixWorld),"current"===e.reset?Z9.subVectors(e.fromPosition,$9).divideScalar(e.currentDampingFactor):"original"===e.reset?(Z9.subVectors(e.obj.userData.worldPosition0,$9).divideScalar(e.currentDampingFactor),e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart)):Z9.subVectors(e.pointEnd,e.pointStart).add(e.fromPosition).sub($9).divideScalar(e.currentDampingFactor),e.paused=!(e.currentDampingFactor>1)||Z9.length()<.01,(this.activeEvent&&1===this.activeEvent.data.dampingFactor||n)&&h7(e,Z9.add($9),null!==(t=this.activeEvent)&&void 0!==t&&t.data.drop&&null!==(i=this.activeEvent)&&void 0!==i&&i.data.autoOrient?e.orientationMatrix:null),e.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},m7=new j_,g7=new j_,v7=new j_,y7=new j_,b7=new YE,x7={type:"requestRender"},w7=function(){let e=new j_,t=new j_;return(i,n,r)=>r>0?(e.subVectors(i,n),e.length()<=r?i:t.copy(n).add(e.normalize().multiplyScalar(r))):n}(),S7=function(){let e=new yC;return(t,i)=>{t.position.copy(i),null!==t.parent&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof CQ&&x0(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),_7=class{constructor(e,t,i,n,r,a){this.data=e,this.id=t,this.object=i,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new j_,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data=c(c(c({},rV.defaultData),e),void 0===e.resetOnPointerLeave&&{resetOnPointerLeave:!1}),void 0===e.target||"cursor"===e.target||(this.target=n.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=B8(e,e.actions,n,r,a,i)}},C7=class extends B9{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.pairOfEventListeners=[],this.onMouseMove=e=>{if(!(hN.length>1)){this.eventContext.updateRaycaster(e);for(let e of this.events)void 0===e.target&&this.updateSingleEvent(e)}},this.onMouseEnter=e=>{for(let t of this.events)void 0===t.target&&(t.isReset=!1,t.currentDampingFactor=t.data.dampingFactor)},this.onMouseLeave=e=>{for(let t of this.events)void 0===t.target&&(t.data.resetOnPointerLeave&&(t.isReset=!0,t.currentDampingFactor=t.resetDampingFactor),this.updateSingleEvent(t))},this.onTargetChange=e=>()=>{this.updateSingleEvent(e)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity(t=>{var i,n;let r=null===(i=t.data)||void 0===i?void 0:i.events.find(e=>"Follow"===e.data.type&&!e.data.disabled);r&&(!e.data.globalPhysics.usePhysics||"dynamic"!==(null===(n=t.dataPatched.physics)||void 0===n?void 0:n.rigidBody))&&this.events.push(new _7(r.data,r.id,t,e,this.eventContext.sharedAssets,this.eventManager))}),!this.events.length)return;let{domElement:t,eventElement:i}=this.eventContext;this.domEventsNeeded.clear(),oN&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),i.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let n of this.events)if(void 0!==n.target){let e=n.target,t=this.onTargetChange(n);this.pairOfEventListeners.push([e,t]),e.addEventListener("requestRender",t)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),oN&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[i,n]of this.pairOfEventListeners)i.removeEventListener("requestRender",n);for(let i of this.events)i.paused=!0,i.isReset=!1,N8(i.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e){var t;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.events.forEach(e=>{e.actions.Create.forEach(e=>{e.dispatchThrottled()})});let{plane:n,limitDistance:r,limitDistanceEnabled:a}=e.data;if(e.object.getWorldPosition(v7),e.isReset)y7.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(y7);else{let{getCamera:e,raycaster:t}=this.eventContext;if("custom"===n?(e().getWorldDirection(g7),g7.negate(),m7.copy(g7)):"xy"===n?m7.set(0,0,1):"xz"===n?m7.set(0,1,0):"yz"===n&&m7.set(1,0,0),b7.setFromNormalAndCoplanarPoint(m7,v7),!t.ray.intersectPlane(b7,y7))return}if(!e.isReset)if(y7.distanceTo(e.worldPosition0)>r&&a&&e.target){if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&null!==e.timeoutId&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,!e.data.resetAfterDistanceLimit)return;y7.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor}else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},1e3*e.data.snapDelay)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),!1===e.delayFinished)return;!1===e.data.enabledTranslation[0]&&(y7.x=v7.x),!1===e.data.enabledTranslation[1]&&(y7.y=v7.y),!1===e.data.enabledTranslation[2]&&(y7.z=v7.z);let o=w7(v7,y7,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let t=m7.subVectors(o,v7).divideScalar(e.currentDampingFactor);v7.add(t),i&&S7(e.object,v7),e.paused=t.length()<.01}else S7(e.object,o),e.paused=!0;null!==(t=e.object)&&void 0!==t&&t.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(x7)}},E7=new j_,A7=new j_,M7=new yC,T7=new V_,P7=new V_,D7=new j_,O7=new j_,I7=new j_,k7=new j_,R7=new YE,z7={type:"requestRender"},L7={type:"changeRotation"},B7=function(){let e=new yC;return function(t,i){null!==t.parent?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),i.premultiply(A9(e).invert()),t.rotation.setFromRotationMatrix(i),t.updateMatrix(),t instanceof CQ&&x0(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),N7=class{constructor(e,t,i,n){this.id=t,this.object=i,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new V_,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data=c(c(c({},aV.defaultData),e),void 0===e.resetOnPointerLeave&&{resetOnPointerLeave:!1}),void 0===e.target||"cursor"===e.target||(this.target=n.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},F7=class extends B9{constructor(){super(...arguments),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=e=>{if(!(hN.length>1)){this._lastMouseEvent=e,this.eventContext.updateRaycaster(e);for(let e of this.events)void 0===e.target&&this.updateSingleEvent(e)}},this.onMouseEnter=e=>{for(let t of this.events)void 0===t.target&&(t.isReset=!1,t.currentDampingFactor=t.data.dampingFactor)},this.onMouseLeave=e=>{for(let t of this.events)void 0===t.target&&(t.data.resetOnPointerLeave&&(t.isReset=!0,t.currentDampingFactor=t.resetDampingFactor),this.updateSingleEvent(t))},this.onScroll=e=>{if(this._lastMouseEvent){let e=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(e)}},this.onTargetChange=e=>()=>{this.updateSingleEvent(e)},this.createUserEventListener=e=>t=>{let{eventName:i,target:n}=t;if(!i||!n)return;let r=U9(i);r&&"LookAt"===r&&this.updateSingleEvent(e)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity(t=>{var i,n;let r=null===(i=t.data)||void 0===i?void 0:i.events.find(e=>"LookAt"===e.data.type&&!e.data.disabled);r&&(!e.data.globalPhysics.usePhysics||"dynamic"!==(null===(n=t.dataPatched.physics)||void 0===n?void 0:n.rigidBody))&&this.events.push(new N7(r.data,r.id,t,e))}),!this.events.length)return;let{domElement:t,eventElement:i}=this.eventContext;this.domEventsNeeded.clear(),oN&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),i.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?i.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let n of this.events){if(void 0!==n.target){let e=this.onTargetChange(n),t=n.target;this.pairOfEventListeners.push([t,e]),t.addEventListener("requestRender",e)}let e=this.createUserEventListener(n),t=n.object;this.pairOfUserEventListeners.push([t,e]),t.addEventListener("userEvent",e)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),oN&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[i,n]of this.pairOfEventListeners)i.removeEventListener("requestRender",n);for(let[i,n]of this.pairOfUserEventListeners)i.removeEventListener("userEvent",n);for(let i of this.events)i.paused=!0,i.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){var t;let{tilt:i,axis:n,distance:r,plane:a,limitDistance:o,enabledRotation:s,limitDistanceEnabled:l}=e.data,{getCamera:c,raycaster:d}=this.eventContext,{object:u,target:h}=e;if(u.getWorldPosition(D7),!e.isReset)if(e.target)e.target.getWorldPosition(O7);else{if("custom"===a?(c().getWorldDirection(A7),A7.negate(),R7.setFromNormalAndCoplanarPoint(A7,D7)):("xy"===a?E7.set(0,0,1):"xz"===a?E7.set(0,1,0):"yz"===a&&E7.set(1,0,0),R7.setFromNormalAndCoplanarPoint(E7,D7)),!d.ray.intersectPlane(R7,O7))return;r>0&&("custom"===a||void 0===a)&&O7.addScaledVector(A7,r)}if(e.isReset||(h?"target"===i?I7.copy(h.up).applyMatrix4(M7.extractRotation(h.matrixWorld)).normalize():s.some(e=>!1===e)?("x"===n?(k7.set(0,0,1),!1===s[2]&&k7.set(0,1,0)):"y"===n?(k7.set(1,0,0),!1===s[0]&&k7.set(0,0,1)):(k7.set(0,1,0),!1===s[1]&&k7.set(1,0,0)),I7.copy(k7).applyQuaternion(e.worldQuaternion0).normalize()):I7.set(0,1,0):"custom"===a?I7.set(0,1,0):I7.copy(E7)),e.isReset)P7.copy(e.worldQuaternion0);else if(D7.distanceTo(O7)>o&&l&&h){if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&null!==e.timeoutId&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,!e.data.resetAfterDistanceLimit)return;P7.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor}else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},1e3*e.data.snapDelay)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),!1===e.delayFinished)return;(function(e,t,i,n,r,a){let o=e.elements;j7.subVectors(t,i),0===j7.lengthSq()&&(j7.z=1),j7.normalize(),V7.crossVectors(n,j7),0===V7.lengthSq()&&(1===Math.abs(n.z)?j7.x+=1e-4:j7.z+=1e-4,j7.normalize(),V7.crossVectors(n,j7)),V7.normalize(),U7.crossVectors(j7,V7),"x"===r?1===a.z?[V7,U7,j7]=[j7,V7,U7]:(V7.negate(),[V7,j7]=[j7,V7]):"y"===r?1===a.x?[V7,U7,j7]=[U7,j7,V7]:(V7.negate(),[U7,j7]=[j7,U7]):1===a.x&&(V7.negate(),[V7,U7]=[U7,V7]),o[0]=V7.x,o[4]=U7.x,o[8]=j7.x,o[1]=V7.y,o[5]=U7.y,o[9]=j7.y,o[2]=V7.z,o[6]=U7.z,o[10]=j7.z})(M7,O7,D7,I7,n,k7),P7.setFromRotationMatrix(M7),T7.setFromUnitVectors(k7.applyQuaternion(P7),I7),s.some(e=>!1===e)&&"target"!==i&&P7.premultiply(T7).normalize()}e.currentDampingFactor>1?(u.updateWorldMatrix(!0,!1),T7.setFromRotationMatrix(A9(u.matrixWorld)),T7.slerp(P7,1/e.currentDampingFactor),B7(u,M7.makeRotationFromQuaternion(T7)),e.paused=8*(1-T7.dot(P7))<1e-6):(B7(u,M7.makeRotationFromQuaternion(P7)),e.paused=!0),null!==(t=e.object)&&void 0!==t&&t.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),u.dispatchEvent(z7),u.dispatchEvent(L7)}},U7=new j_,V7=new j_,j7=new j_;var W7=class{constructor(e,t,i,n,r,a){this.id=e,this.data=t,this.object=i,this.entered=!1,this.actions=B8(t,t.actions,n,r,a,i)}disconnect(){N8(this.actions)}dispatchEnter(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.play()),this.actions.Create.forEach(e=>e.dispatchStart()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered&&(this.entered=!1,this.actions.Create.forEach(e=>e.dispatchStop()),this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()))}dispatchUserEvent(e){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),e?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch())}},H7=class extends B9{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObjects={},this.objects=[],this.objects2D=[],this._prevObjects=[],this.onMouseDown=e=>{hN.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseHoverEvent())},this.onMouseUp=e=>{hN.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=e=>{hN.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseHoverEvent())},this.onUserEvent=e=>{var t;let{eventName:i,target:n,reverse:r}=e;if(!i||!n)return;let a=U9(i);a&&"MouseHover"===a&&(n.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),null===(t=this.eventsPerObjects[n.uuid])||void 0===t||t.forEach(e=>e.dispatchUserEvent(r)))}}connect(){let{page:e,sharedAssets:t}=this.eventContext,i=(i,n)=>{var r;if(i.visible&&null!==(r=i.data)&&void 0!==r&&r.events.length){var a;for(let{id:n,data:r}of i.data.events)if(!r.disabled&&"MouseHover"===r.type)try{let a=new W7(n,r,i,e,t,this.eventManager);this.eventsPerObjects[i.uuid]?this.eventsPerObjects[i.uuid].push(a):this.eventsPerObjects[i.uuid]=[a]}catch(o){}(null===(a=this.eventsPerObjects[i.uuid])||void 0===a?void 0:a.length)&&this.objects.push(i instanceof j2?n:i)}};if(e.traverseEntity(e=>{var t;(e instanceof X3||e instanceof B3)&&null!==(t=e.frame)&&void 0!==t&&t.traverse(t=>{i(t,e)}),i(e)}),!this.objects.length)return;let{domElement:n}=this.eventContext;this.domEventsNeeded.clear(),oN&&(this.domEventsNeeded.add("pointerdown"),n.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),n.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),n.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(e=>{e.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),oN&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(e=>{e.forEach(e=>{e.disconnect()})}),this.objects.forEach(e=>{e.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(){let e=[];if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])){let{stopRaycast:t,raycaster:i,page:n,pointerScreen:r}=this.eventContext,a=!1;if(n.uiCanvas&&(a=k9(n,[r.x,r.y],Object.keys(this.eventsPerObjects),t=>{e.push(t)})),t&&!a){let t=O9(i,n,this.objects);e=I9(t),t.forEach(t=>{var i,n,r,a;t.object instanceof X3&&k9(t.object,[null!==(i=null===t||void 0===t||null===(n=t.uv)||void 0===n?void 0:n.x)&&void 0!==i?i:0,null!==(r=null===t||void 0===t||null===(a=t.uv)||void 0===a?void 0:a.y)&&void 0!==r?r:0],Object.keys(this.eventsPerObjects),t=>{e.push(t)})})}else this.objects.forEach(t=>{var n,r,a,o;let s=R9(i,t);s&&(e.push(t),t instanceof X3&&k9(t,[null!==(n=null===s||void 0===s||null===(r=s.uv)||void 0===r?void 0:r.x)&&void 0!==n?n:0,null!==(a=null===s||void 0===s||null===(o=s.uv)||void 0===o?void 0:o.y)&&void 0!==a?a:0],Object.keys(this.eventsPerObjects),t=>{e.push(t)}))})}this._prevObjects.length&&this._prevObjects.forEach(t=>{var i;e.includes(t)||(t.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),null===(i=this.eventsPerObjects[t.uuid])||void 0===i||i.forEach(e=>e.dispatchLeave()))}),e.length&&e.forEach(e=>{var t;e.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),null===(t=this.eventsPerObjects[e.uuid])||void 0===t||t.forEach(e=>e.dispatchEnter())}),this._prevObjects=e}},G7=class{constructor(e,t,i,n,r,a){this.id=e,this.data=t,this.object=i,this.scrollCounter=0,this.actions=B8(t,t.actions,n,r,a,i)}connect(){this.scrollCounter=0}disconnect(){N8(this.actions)}dispatch(e){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())});let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let i=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(e=>e.seek(i)),this.actions.Animation.forEach(e=>e.seek(t)),this.actions.Create.forEach(e=>e.dispatchThrottled()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch())}dispatchUserEvent(e){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),e?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>{e.playFromCurrent()}),this.actions.Animation.forEach(e=>{e.playFromCurrent()})),this.actions.Create.forEach(e=>e.dispatchThrottled()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch())}},q7=class{constructor(e,t,i,n,r,a,o){this.id=e,this.data=t,this.object=i,this.domElement=a,this.eventManager=o,this.scrollStart=0,this.scrollEnd=0,this.actions=B8(t,t.actions,n,r,o,i)}getStickyParentElement(){let e=this.domElement;for(;e;){if("sticky"===window.getComputedStyle(e).position)return e;e=e.parentElement}return null}computeScrollBounds(){var e,t;let i=this.getStickyParentElement(),n=null===i||void 0===i?void 0:i.parentElement,r=this.domElement.getBoundingClientRect(),a={top:r.top,bottom:r.bottom,left:r.left,right:r.right,width:r.width,height:r.height};if(n){let e=n.getBoundingClientRect(),t=window.getComputedStyle(i),l=parseFloat(t.marginTop)+parseFloat(t.marginBottom),c=parseFloat(t.top),d=parseFloat(t.bottom),u=e.height-l;if(isNaN(c)){if(!isNaN(d)){var o,s;let t=null!==(o=document.body.clientHeight)&&void 0!==o?o:window.innerHeight,i=window.innerWidth-(null!==(s=document.documentElement.clientWidth)&&void 0!==s?s:window.innerWidth);r.bottom===t-d?(a.top+=e.top-r.height+d+i,a.bottom+=e.top-r.height+d+i):r.bottom<t-d&&(a.top-=u-r.height,a.bottom-=u-r.height)}}else r.top===c?(a.top+=e.top-c,a.bottom+=e.top-c):r.top<0&&(a.top-=u-r.height,a.bottom-=u-r.height)}let l=document.body,c=document.documentElement,d=window.pageYOffset||c.scrollTop||l.scrollTop,u=c.clientTop||l.clientTop||0,h=Math.round(a.top+d-u);if("enter"===this.data.startFrom){let e=window.innerHeight,t=a.height,i=this.data.enterAnchor,n="top"===i?e:"bottom"===i?e-t:e-.5*t;this.scrollStart=h-n}else this.scrollStart=0;this.scrollStart+=null!==(e=this.data.startOffset)&&void 0!==e?e:0,this.scrollEnd=this.scrollStart+(null!==(t=this.data.endAfter)&&void 0!==t?t:400),this.box=a,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){N8(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return void 0===this.box||0===this.box.width&&0===this.box.height&&0===this.box.top&&0===this.box.bottom}computeScroll(e){let{x:t,y:i}=e;this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())});let n=this.scrollEnd-this.scrollStart,r=Math.min(1,Math.max(0,(i-this.scrollStart)/n));this.actions.Transition.forEach(e=>e.seek(r)),this.actions.Animation.forEach(e=>e.seek(r)),this.actions.Create.forEach(e=>e.dispatchThrottled()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch())}dispatch(e){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(e)}dispatchUserEvent(e){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),e?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>{e.playFromCurrent()}),this.actions.Animation.forEach(e=>{e.playFromCurrent()})),this.actions.Create.forEach(e=>e.dispatchThrottled()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch())}},X7=class extends B9{constructor(e,t){super(e),this.managers=t,this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(e=>{let[t,i]=e;i.forEach(e=>e.handleResize())})},this.onScroll=e=>{if(!this.isInview)return;let t={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(e=>{let[i,n]=e;i.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:t}),n.forEach(e=>e.dispatch(t))})},this.onWheel=e=>{!this.isInview||e.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(t=>{let[i,n]=t;i.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:e.deltaY}),n.forEach(t=>t.dispatch(e.deltaY))})},this.onUserEvent=e=>{var t;let{eventName:i,target:n,reverse:r}=e;if(!i||!n)return;let a=U9(i);a&&"Scroll"===a&&(n.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),null===(t=this.wheelEventsPerObject.get(n))||void 0===t||t.forEach(e=>{e.dispatchUserEvent(r)}))}}connect(){let{page:e,sharedAssets:t,domElement:i,isExport:n}=this.eventContext,r=r=>{var a;if(null!==(a=r.data)&&void 0!==a&&a.events.length)for(let{id:l,data:c}of r.data.events)if(!c.disabled&&"Scroll"===c.type)if("load"!==c.trigger&&n){var o;let n=new q7(l,c,r,e,t,i,this.managers);this.scrollEventsPerObject.has(r)?null===(o=this.scrollEventsPerObject.get(r))||void 0===o||o.push(n):this.scrollEventsPerObject.set(r,[n])}else{var s;let i=new G7(l,c,r,e,t,this.managers);this.wheelEventsPerObject.has(r)?null===(s=this.wheelEventsPerObject.get(r))||void 0===s||s.push(i):this.wheelEventsPerObject.set(r,[i])}};e.traverseEntity(e=>{var t;(e instanceof X3||e instanceof B3)&&null!==(t=e.frame)&&void 0!==t&&t.traverse(e=>{r(e)}),r(e)}),this.intersectionObserver=new IntersectionObserver(e=>{let t=e[0];t&&(this.isInview=t.isIntersecting)},{root:null}),this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(e=>{let[t,i]=e;i.forEach(e=>e.connect()),t.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(e=>{let[t,i]=e;i.forEach(e=>e.connect()),t.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(e=>e.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(e=>e.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(e=>{let[t,i]=e;i.forEach(e=>e.disconnect()),t.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(e=>{let[t,i]=e;i.forEach(e=>e.disconnect()),t.removeEventListener("userEvent",this.onUserEvent)})}},Y7=class{constructor(e,t,i,n,r,a){this.id=e,this.data=t,this.object=i,this.actions=B8(t,t.actions,n,r,a,i)}disconnect(){N8(this.actions)}dispatch(){this.actions.Transition.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()),this.actions.Create.forEach(e=>{e.dispatchFromStart()}),this.actions.Destroy.forEach(e=>{e.dispatchFromStart()})}dispatchAfter(e){this.actions.Audio.forEach(t=>{var i;(null!==(i=t.interaction.data.triggerAfter)&&void 0!==i?i:"any")===e&&(t.interaction instanceof T5?t.interaction.audioPlayer.play():t.interaction instanceof P5&&t.interaction.dispatch())}),this.actions.Video.forEach(t=>{var i;let n=null!==(i=t.interaction.data.triggerAfter)&&void 0!==i?i:"autoplay";n===e&&(t.interaction instanceof V8?t.interaction.play("autoplay"===n):t.interaction instanceof j8&&t.interaction.dispatch())}),this.actions.Particles.forEach(t=>{var i;(null!==(i=t.data.triggerAfter)&&void 0!==i?i:"any")===e&&t.dispatchBasic()})}async seekVideos(e){let t=[];this.actions.Video.forEach(i=>{var n;"autoplay"===(null!==(n=i.interaction.data.triggerAfter)&&void 0!==n?n:"autoplay")&&i.interaction instanceof V8&&t.push(i.interaction.seek(e))}),await Promise.all(t)}pauseVideos(){this.actions.Video.forEach(e=>{e.interaction instanceof V8&&e.interaction.pause()})}dispatchUserEvent(e){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),e?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.interaction instanceof T5?e.interaction.audioPlayer.play():e.interaction instanceof P5&&e.interaction.dispatch()}),this.actions.Video.forEach(e=>{e.interaction instanceof V8?e.interaction.play():e.interaction instanceof j8&&e.interaction.dispatch()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()})}},Q7=class extends B9{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(e=>{let[t,i]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(e=>{e.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(e=>{let[t,i]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(e=>{e.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:e,isExport:t}=this.eventContext,i=t?document:e;i.removeEventListener("pointerdown",this.onAny),i.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(e=>{let[t,i]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(e=>{e.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(e=>{let[t,i]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(e=>{e.actions.Audio.forEach(e=>{e.interaction instanceof T5&&e.interaction.audioPlayer.play()}),e.actions.Video.forEach(e=>{var t;let i=null!==(t=e.interaction.data.triggerAfter)&&void 0!==t?t:"autoplay";e.interaction instanceof V8&&e.interaction.play("autoplay"===i)}),e.actions.Particles.forEach(e=>{e.dispatchBasic()})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(e=>{let[t,i]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(e=>{e.dispatchAfter("autoplay")})})},this.seekVideos=async e=>{let t=[];[...this.eventsAfterPerObject.entries()].forEach(i=>{let[n,r]=i;r.forEach(i=>{t.push(i.seekVideos(e))})}),await Promise.all(t)},this.pauseVideos=()=>{[...this.eventsAfterPerObject.entries()].forEach(e=>{let[t,i]=e;i.forEach(e=>{e.pauseVideos()})})},this.onUserEvent=e=>{var t,i;let{eventName:n,target:r,reverse:a}=e;if(!n||!r)return;let o=U9(n);o&&"Start"===o&&(r instanceof j2||r.dispatchEvent({type:"beginEvent",eventName:"Start"}),null!==(t=this.eventsPerObject.get(r))&&void 0!==t&&t.forEach(e=>{e.dispatchUserEvent(a)}),null===(i=this.eventsAfterPerObject.get(r))||void 0===i||i.forEach(e=>{e.dispatchUserEvent(a)}))}}connect(){let{sharedAssets:e,page:t}=this.eventContext,i=i=>{var n;if(null!==(n=i.data)&&void 0!==n&&n.events.length)for(let{id:l,data:c}of i.data.events){var r,a,o,s;if(c.disabled||"Start"!==c.type)continue;let n=new Y7(l,c,i,t,e,this.eventManager);(n.actions.Transition.length||n.actions.Animation.length||n.actions.SwitchCamera.length||n.actions.Create.length||n.actions.Destroy.length||n.actions.SceneTransition.length||n.actions.Reset.length||n.actions.SetVariable.length||n.actions.DynamicVariablePlay.length||n.actions.ClearLocalStorage.length||n.actions.UserAPI.length)&&(this.eventsPerObject.has(i)?null===(r=this.eventsPerObject.get(i))||void 0===r||r.push(n):this.eventsPerObject.set(i,[n])),n.actions.Audio.length&&(this.eventsAfterPerObject.has(i)?null===(a=this.eventsAfterPerObject.get(i))||void 0===a||a.push(n):this.eventsAfterPerObject.set(i,[n])),n.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(i)?null===(o=this.eventsAfterPerObject.get(i))||void 0===o||o.push(n):this.eventsAfterPerObject.set(i,[n])),n.actions.Particles.length&&(this.eventsAfterPerObject.has(i)?null===(s=this.eventsAfterPerObject.get(i))||void 0===s||s.push(n):this.eventsAfterPerObject.set(i,[n]))}};if(t.traverseEntity(e=>{var t;(e instanceof X3||e instanceof B3)&&null!==(t=e.frame)&&void 0!==t&&t.traverse(e=>{i(e)}),i(e)}),[...this.eventsAfterPerObject.values()].some(e=>e.length)){if(0===this.eventManager.activateCount){let{domElement:e,isExport:t}=this.eventContext,i=t?document:e;i.addEventListener("pointerdown",this.onMouseDown,{once:!0}),i.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),i.addEventListener("pointerdown",this.onAny),i.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(e=>{let[t,i]=e;t.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(e=>{let[t,i]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(e=>e.dispatch()),t.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(e=>e.length)){let{domElement:e,isExport:t}=this.eventContext,i=t?document:e;i.removeEventListener("pointerdown",this.onMouseDown),i.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),i.removeEventListener("pointerdown",this.onAny),i.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(e=>{let[t,i]=e;t.removeEventListener("userEvent",this.onUserEvent),i.forEach(e=>e.disconnect())})}[...this.eventsPerObject.entries()].forEach(e=>{let[t,i]=e;t.removeEventListener("userEvent",this.onUserEvent),i.forEach(e=>e.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},K7=class{constructor(e,t,i,n,r,a){this.id=e,this.data=t,this.object=i,this.initialDisabled=!1,this.actions=B8(t,t.actions,n,r,a,i),this.target=t.target}disconnect(){N8(this.actions)}dispatch(e){this.initialDisabled||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.actions.Transition.forEach(e=>{"Toggle"===e.data.runMode?e.toggle():e.play()}),this.actions.Animation.forEach(e=>{"Toggle"===e.data.runMode?e.toggle():e.play()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(null!==e&&void 0!==e&&e)}),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()))}},Z7=class extends B9{constructor(e,t,i,n,r){super(e),this.sharedVariables=t,this.eventManager=i,this.needsMouse=n,this.needsRaycast=r,this.dynamicVars=[],this.variablesToWatch=[],this.prevMouseProperty=null,this.prevRaycastProperty=null,this.pauseTime=0,this.isOutOfFocus=!1,this.events=[],this.onFrame=e=>{let t=this.eventContext.sharedAssets;if(this.rafId=window.requestAnimationFrame(this.onFrame),this.isOutOfFocus)return;let i=new Date,n=[],r=[];for(let c=0;c<this.propertiesToWatch.length;c++){let{objectId:e,property:t,prevValue:i}=this.propertiesToWatch[c],n=this.eventContext.scene.find(e),a=pV.propertyPaths[t];if("width"===a[0]||"height"===a[0]||"depth"===a[0])n=n.geometry.userData.parameters[a[0]];else for(let r=0;r<a.length;r++)n=n[a[r]];null===i?this.propertiesToWatch[c].prevValue=n instanceof j_?n.clone():n:(n instanceof j_?!n.equals(i):i!==n)&&(r.push({objId:e,property:t}),n instanceof j_?this.propertiesToWatch[c].prevValue.copy(n):this.propertiesToWatch[c].prevValue=n)}for(let c=0;c<this.variablesToWatch.length;c++){let{id:e,prevValue:i}=this.variablesToWatch[c],r=t.getVariable(e);r!==i&&(n.push(e),this.variablesToWatch[c].prevValue=r)}for(let c=0;c<this.dynamicVars.length;c++){let{id:r,expectedTime:s,last:l,data:d,timerSeconds:u,startValue:h}=this.dynamicVars[c],p=1e3;if("timer"!==d.dynamicVariableType&&"stopwatch"!==d.dynamicVariableType||"number3decimal"!==d.format?"counter"===d.dynamicVariableType?p=d.updateInterval:"random"===d.dynamicVariableType&&(p=d.isStatic?1/0:d.updateInterval):p=1,-1!==s){if("Stopped"!==t.getDynamicVariablePlayState(r)&&"Restarted"!==t.getDynamicVariablePlayState(r)||(this.dynamicVars[c].last=e,this.dynamicVars[c].expectedTime=e+p,"counter"===d.dynamicVariableType&&t.getVariable(r)!==h&&(t.updateVariable(r,h),this.eventManager.requestRender()),("timer"===d.dynamicVariableType||"stopwatch"===d.dynamicVariableType)&&this.dynamicVars[c].timerSeconds!==h&&(this.dynamicVars[c].timerSeconds=h,t.updateVariable(r,aW.getFormattedTimerTime(h,d)),this.eventManager.requestRender()),"Restarted"===t.getDynamicVariablePlayState(r)&&t.setDynamicVariablePlayState(r,"Playing"),"Stopped"!==t.getDynamicVariablePlayState(r))){if("Paused"===t.getDynamicVariablePlayState(r)){void 0===this.dynamicVars[c].deltaToExpectedTime&&(this.dynamicVars[c].deltaToExpectedTime=Math.max(this.dynamicVars[c].expectedTime-e,0)),this.dynamicVars[c].last=e-(p-this.dynamicVars[c].deltaToExpectedTime),this.dynamicVars[c].expectedTime=e+this.dynamicVars[c].deltaToExpectedTime;continue}if(this.dynamicVars[c].deltaToExpectedTime=void 0,e>=s)if(this.dynamicVars[c].last=e,this.dynamicVars[c].expectedTime+=p,"random"===d.dynamicVariableType){let e=d.min+Math.random()*(d.max-d.min),i=d.decimals;e=Math.round(e*Math.pow(10,i))/Math.pow(10,i),t.updateVariable(r,e),n.push(r),this.eventManager.requestRender()}else if("counter"===d.dynamicVariableType){var a;let e=t.getVariable(r),i=null===(a=t.getDynamicVariableToggleIsForward(r))||void 0===a||a,o=t.getVariable(r)+d.increment*(i?1:-1);d.hasEnd&&(o=d.increment>0?h_.clamp(o,h,d.endValue):h_.clamp(o,d.endValue,h),o===h&&t.setDynamicVariableToggleIsForward(r,void 0),d.repeat?o===d.endValue&&(o=h):(o===h||o===d.endValue)&&t.setDynamicVariablePlayState(r,"Paused")),o!==e&&(n.push(r),t.updateVariable(r,o),this.eventManager.requestRender())}else if("time"===d.dynamicVariableType){let e=t.getVariable(r),a=WZ(i,d);if("object"==typeof e&&"textValue"in e&&"object"==typeof a&&"textValue"in a){if(Array.isArray(e.textValue)&&Array.isArray(a.textValue)){if(e.textValue.every((e,t)=>e===a.textValue[t]))continue}else if(e.textValue===a.textValue)continue}else if(e===a)continue;t.updateVariable(r,a),n.push(r),this.eventManager.requestRender()}else{var o;let i=eW.isTextValue(d.endValue)?$7(d.endValue.textValue):d.endValue,a=null===(o=t.getDynamicVariableToggleIsForward(r))||void 0===o||o,s=u+(e-l)/1e3*("timer"===d.dynamicVariableType?-1:1)*(a?1:-1);s=Math.max(s,0),d.hasEnd&&(s="stopwatch"===d.dynamicVariableType?h_.clamp(s,h,i):h_.clamp(s,i,h),s===h&&t.setDynamicVariableToggleIsForward(r,void 0),d.repeat?Math.abs(s-i)<("number3decimal"===d.format?1e-4:.1)&&(s=h):(Math.abs(s-h)<("number3decimal"===d.format?1e-4:.1)||Math.abs(s-i)<("number3decimal"===d.format?1e-4:.1))&&t.setDynamicVariablePlayState(r,"Paused")),s!==u&&(n.push(r),this.dynamicVars[c].timerSeconds=s,t.updateVariable(r,aW.getFormattedTimerTime(s,d)),this.eventManager.requestRender())}}}else this.dynamicVars[c].last=e,this.dynamicVars[c].expectedTime=e+p}let s=!1;t.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=t.mouseProperty,s=!0);let l=!1;t.raycastProperty!==this.prevRaycastProperty&&(this.prevRaycastProperty=t.raycastProperty,l=!0),this.events.forEach(e=>{(n.includes(e.data.variableId)||r.find(t=>t.objId===e.data.objectId&&t.property===e.data.property)||"mouseProperty"===e.data.variableId&&s||"raycastProperty"===e.data.variableId&&l)&&(e.dispatch(),this.eventManager.requestRender())})},this.onBlur=()=>{this.pause()},this.onFocus=()=>{this.resume()}}pause(){this.isOutOfFocus||(this.isOutOfFocus=!0,this.pauseTime=Date.now())}resume(){if(!this.isOutOfFocus)return;this.isOutOfFocus=!1;let e=Date.now()-this.pauseTime;for(let t=0;t<this.dynamicVars.length;t++)this.dynamicVars[t].last+=e,this.dynamicVars[t].expectedTime+=e}connect(){this.eventContext.page.traverseEntity(e=>{var t;null===(t=e.data)||void 0===t||t.events.filter(e=>"VariableChange"===e.data.type&&!e.data.disabled).forEach(t=>{this.events.push(new J7(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.propertiesToWatch=this.events.filter(e=>"objectProperty"===e.data.variableId&&null!==e.data.objectId).map(e=>({objectId:e.data.objectId,property:e.data.property,prevValue:null}));let e=this.eventContext.sharedAssets;this.sharedVariables.forEach(t=>{let i,{id:n,data:r}=t;if("dynamicVariableType"in r)if("timer"===r.dynamicVariableType||"stopwatch"===r.dynamicVariableType){let e;if(eW.isTextValue(r.value)&&Array.isArray(r.value.textValue)){let t=r.value.textValue;e=3===t.length?t[2]+60*t[1]+3600*t[0]:t[1]+60*t[0]}else e=r.value;i=e,this.dynamicVars.push({id:n,last:-1,expectedTime:-1,data:r,timerSeconds:e,startValue:i})}else"time"===r.dynamicVariableType&&e.updateVariable(n,WZ(new Date,r)),"counter"===r.dynamicVariableType&&(i=eW.isTextValue(r.value)?$7(r.value.textValue):r.value),this.dynamicVars.push({id:n,last:-1,expectedTime:-1,data:r,startValue:i});else this.events.find(e=>e.data.variableId===n)&&this.variablesToWatch.push({id:n,prevValue:e.getVariable(n)})}),this.rafId=window.requestAnimationFrame(this.onFrame),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus)}disconnect(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=void 0),this.events.forEach(e=>e.dispose())}},J7=class{constructor(e,t,i,n,r,a){this.id=e,this.data=t,this.object=i,this.actions=B8(t,t.actions,n,r,a,i)}dispatch(){let e=this.actions;e.Audio.forEach(e=>e.dispatchConditional()),e.Particles.forEach(e=>e.dispatchConditional()),e.Video.forEach(e=>e.dispatchConditional()),e.Create.forEach(e=>e.dispatch()),e.Destroy.forEach(e=>e.dispatch()),e.Reset.forEach(e=>e.dispatch()),e.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()}),e.Transition.forEach(e=>e.play()),e.Animation.forEach(e=>e.play()),e.SwitchCamera.forEach(e=>e.play()),e.SceneTransition.forEach(e=>e.dispatch()),e.SetVariable.forEach(e=>e.checkConditions()),e.SetVariable.forEach(e=>e.dispatch()),e.DynamicVariablePlay.forEach(e=>e.dispatch()),e.ClearLocalStorage.forEach(e=>e.dispatch()),e.UserAPI.forEach(e=>e.dispatch())}dispose(){N8(this.actions)}};function $7(e){return 3===e.length?e[2]+60*e[1]+3600*e[0]:e[1]+60*e[0]}var eee,tee,iee,nee="\n(async function() {\n\tconst [wasmImport, wasmBinary] = await Promise.all([\n\t\timport('".concat("https://unpkg.com/@splinetool/runtime@1.10.48/build/","' + 'navmesh.js'),\n\t\tfetch('").concat("https://unpkg.com/@splinetool/navmesh-wasm@1.10.48/build/","' + 'navmesh.wasm').then((res) => res.arrayBuffer()),\n\t]);\n\tconst wasmModule = wasmImport.default;\n\tself.module = await wasmModule({ wasmBinary });\n\tpostMessage('ready');\n})();\n"),ree={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1};CN.then(e=>{eee=e,tee=new e.Vec3,iee=new e.Vec3});var aee=new j_,oee=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.usePhysics=e,this.isExport=t,this.onPointerDown=e=>{if(1!==hN.length)return;let{raycaster:t,page:i}=this.eventContext;this.eventContext.updateRaycaster(e);let n=i.raycastWithClones(t);if(0!==n.length){if(this.gameControl){let e=aee.copy(this.gameControl.colliderWorldPosition);e.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(e,n[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(e,t)=>i=>{var n,r,a,o,s,l;let c;if(i instanceof X$){if(!i.objectForSample)return!0===i.object.dataPatched.physics.fusedBody&&"dynamic"===i.object.dataPatched.physics.rigidBody||void 0;if(i.objectForSample.dataPatched.physics.fusedBody)return;c=i.object}else if(i instanceof IG)c=i.object;else if(c=i,!1===(null===(n=c.dataPatched.cloner)||void 0===n?void 0:n.disabled)&&null!==(r=c.dataPatched.cloner)&&void 0!==r&&r.hideBase&&!0!==(null===(a=c.dataPatched.physics)||void 0===a?void 0:a.fusedBody))return!0;if(t&&!c.userData.navmesh)return;let d=c.dataPatched;if(!d.visible&&!0!==(null===(o=d.physics)||void 0===o?void 0:o.enabled))return!0;i.updateMatrixWorldSVD();let u=Gee(d),h=c.userData.hasDestroy,p=c.userData.hasDrag,f=!1,m=!1;for(let e of d.events)!0!==e.data.disabled&&("GameControl"===e.data.type?f=!0:"Follow"===e.data.type&&(m=!0));if(f||u||m||h||p)return!0;var g;if(this.usePhysics&&"dynamic"===(null===(s=d.physics)||void 0===s?void 0:s.rigidBody)){if(this.usePhysics&&null!==(g=d.physics)&&void 0!==g&&g.fusedBody)return!0}else if("geometry"in i&&i.geometry&&e.push(S9(i.geometry,i.matrixWorld)),this.usePhysics&&null!==(l=d.physics)&&void 0!==l&&l.fusedBody)return i.traverseObject((t,i)=>{var n,r;if(0===i)return;let a;if(t instanceof X$){if(!t.objectForSample)return!0===t.object.dataPatched.physics.fusedBody&&"dynamic"===t.object.dataPatched.physics.rigidBody||void 0;if(t.objectForSample.dataPatched.physics.fusedBody)return;a=t.object}else if(t instanceof IG)a=t.object;else if(a=t,null!==(n=t.dataPatched.cloner)&&void 0!==n&&n.hideBase)return!0;let o=a.dataPatched;if(!o.visible&&!0!==(null===(r=o.physics)||void 0===r?void 0:r.enabled))return!0;"geometry"in t&&t.geometry&&e.push(S9(t.geometry,t.matrixWorld))}),!0},this.traverseNoPhysics=(e,t)=>i=>{let n;if(i instanceof X$)return;n=i instanceof IG?i.object:i;let r=n.dataPatched;if("visibility"===r.physics.enabled?!r.visible:!r.physics.enabled)return!0;if(t&&!n.userData.navmesh)return;let a=i.geometry,o=!0===n.userData.hasDestroy,s=!0===n.userData.hasDrag;if(Gee(r)||o||s||n.dataPatched.events.some(e=>!0!==e.data.disabled&&"GameControl"===e.data.type))return!0;a&&e.push(S9(a,i.matrixWorld))},this.navmeshWasm=eee,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?nee:"\n(async function() {\n\tconst [wasmImport, wasmBinary] = await Promise.all([\n\t\timport(self.location.origin + '/_libraries/navmesh.js'),\n\t\tfetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),\n\t]);\n\tconst wasmModule = wasmImport.default;\n\tself.module = await wasmModule({ wasmBinary });\n\tpostMessage('ready');\n})();\n")+"\n\nonmessage = function(messageEvent) {\n\tconst meshData = messageEvent.data;\n\tconst positions = meshData[0];\n\tconst offset = meshData[1];\n\tconst indices = meshData[2];\n\tconst indicesLength = meshData[3];\n\tconst parameters = meshData[4];\n\n\tconst module = self.module;\n\tconst rc = new module.rcConfig();\n\trc.cs = parameters.cs;\n\trc.ch = parameters.ch;\n\trc.borderSize = parameters.borderSize ? parameters.borderSize : 0;\n\trc.tileSize = parameters.tileSize ? parameters.tileSize : 0;\n\trc.walkableSlopeAngle = parameters.walkableSlopeAngle;\n\trc.walkableHeight = parameters.walkableHeight;\n\trc.walkableClimb = parameters.walkableClimb;\n\trc.walkableRadius = parameters.walkableRadius;\n\trc.maxEdgeLen = parameters.maxEdgeLen;\n\trc.maxSimplificationError = parameters.maxSimplificationError;\n\trc.minRegionArea = parameters.minRegionArea;\n\trc.mergeRegionArea = parameters.mergeRegionArea;\n\trc.maxVertsPerPoly = parameters.maxVertsPerPoly;\n\trc.detailSampleDist = parameters.detailSampleDist;\n\trc.detailSampleMaxError = parameters.detailSampleMaxError;\n\n\tif (!self.navMesh) {\n\t\tself.navMesh = new module.NavMesh();\n\t}\n\tself.navMesh.build(positions, offset, indices, indicesLength, rc);\n\n\tconst navmeshData = navMesh.getNavmeshData();\n\tconst arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);\n\tconst ret = new Uint8Array(navmeshData.size);\n\tret.set(arrView);\n\tnavMesh.freeNavmeshData(navmeshData);\n\n\tpostMessage(ret);\n}\n"])),this._worker=new Worker(this._workerURL)}init(e,t,i){this.gameControl=t,this.eventContext=i,this.setDefaultQueryExtent((new j_).setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(i.page,e,e=>{this.buildFromNavmeshData(e.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,i){t.objects.forEach(t=>{var i;let n=e.scene.find(t);n.traverseEntity(e=>{e.userData.navmesh=!0}),null===(i=n.cloner)||void 0===i||i.traverseObject(e=>{e.userData.navmesh=!0})});let n=[],r=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(n,"custom"===t.zones);if(e.traverseChildren(r),t.objects.forEach(t=>{var i;let n=e.scene.find(t);n.traverseEntity(e=>{e.userData.navmesh=void 0}),null===(i=n.cloner)||void 0===i||i.traverseObject(e=>{e.userData.navmesh=void 0})}),0===n.length)return!1;let a=KW(n),{positions:o,triIndices:s}=QY(a.getAttribute("position"),a.getIndex());return this._worker.postMessage([o,o.length/3,s,s.length,c(c({},ree),t)]),this._worker.onmessage=i,!0}createDebugNavGeometry(){let e,t,i=this.navMesh.getDebugNavMesh(),n=i.getTriangleCount(),r=new Uint32Array(3*n),a=new Float32Array(3*n*3);for(e=0;e<3*n;e++)r[e]=e;for(e=0;e<n;e++)for(t=0;t<3;t++){let n=i.getTriangle(e).getPoint(t);a[9*e+3*t+0]=n.x,a[9*e+3*t+1]=n.y,a[9*e+3*t+2]=n.z}let o=new vE;return o.setIndex(new oE(r,1)),o.setAttribute("position",new oE(a,3)),o}getClosestPoint(e){return tee.x=e.x,tee.y=e.y,tee.z=e.z,this.navMesh.getClosestPoint(tee)}getClosestPointToRef(e,t){tee.x=e.x,tee.y=e.y,tee.z=e.z;let i=this.navMesh.getClosestPoint(tee);t.set(i.x,i.y,i.z)}getRandomPointAround(e,t){return tee.x=e.x,tee.y=e.y,tee.z=e.z,this.navMesh.getRandomPointAround(tee,t)}getRandomPointAroundToRef(e,t,i){tee.x=e.x,tee.y=e.y,tee.z=e.z;let n=this.navMesh.getRandomPointAround(tee,t);i.set(n.x,n.y,n.z)}moveAlong(e,t){return tee.x=e.x,tee.y=e.y,tee.z=e.z,iee.x=t.x,iee.y=t.y,iee.z=t.z,this.navMesh.moveAlong(tee,iee)}moveAlongToRef(e,t,i){return tee.x=e.x,tee.y=e.y,tee.z=e.z,iee.x=t.x,iee.y=t.y,iee.z=t.z,this.navMesh.moveAlong(tee,iee)}computePath(e,t){let i=this.getClosestPoint(t);if(iee.x=i.x,iee.y=i.y,iee.z=i.z,Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)+Math.pow(t.z-i.z,2))>this.getDefaultQueryExtent().y)return[];this.getClosestPoint(e);let n=this.navMesh.computePath(tee,iee),r=n.getPointCount(),a=[];for(let o=0;o<r;o++){let e=n.getPoint(o);a.push(new j_(e.x,e.y,e.z))}return a}createCrowd(e,t){return new see(this,e,t)}setDefaultQueryExtent(e){tee.x=e.x,tee.y=e.y,tee.z=e.z,this.navMesh.setDefaultQueryExtent(tee)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,i=this.navmeshWasm._malloc(t),n=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,i,t);n.set(e);let r=new this.navmeshWasm.NavmeshData;r.dataPointer=n.byteOffset,r.size=e.length,this.navMesh.buildFromNavmeshData(r),this.navmeshWasm._free(n.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),i=new Uint8Array(e.size);return i.set(t),this.navMesh.freeNavmeshData(e),i}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){var e;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),null===(e=this.eventContext)||void 0===e||e.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,i){return tee.x=e.x,tee.y=e.y,tee.z=e.z,this.navMesh.addCylinderObstacle(tee,t,i)}addBoxObstacle(e,t,i){return tee.x=e.x,tee.y=e.y,tee.z=e.z,iee.x=t.x,iee.y=t.y,iee.z=t.z,this.navMesh.addBoxObstacle(tee,iee,i)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return void 0!==this.navmeshWasm}},see=class{constructor(e,t,i){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,i,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,i){let n=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;n.radius=t.radius,n.height=t.height,n.maxAcceleration=t.maxAcceleration,n.maxSpeed=t.maxSpeed,n.collisionQueryRange=t.collisionQueryRange,n.pathOptimizationRange=t.pathOptimizationRange,n.separationWeight=t.separationWeight,n.updateFlags=7,n.obstacleAvoidanceType=0,n.queryFilterType=0,n.userData=0;let r=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),n);return this.transforms.push(i),this.agents.push(r),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new j_(0,0,0)),r}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let i=this.crowd.getAgentPosition(e);t.set(i.x,i.y,i.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let i=this.crowd.getAgentVelocity(e);t.set(i.x,i.y,i.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let i=this.crowd.getAgentNextTargetPath(e);t.set(i.x,i.y,i.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let i=this.agents.indexOf(e);i>-1&&(this._agentDestinationArmed[i]=!0,this._agentDestination[i].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let i=this.crowd.getAgentParameters(e);void 0!==t.radius&&(i.radius=t.radius),void 0!==t.height&&(i.height=t.height),void 0!==t.maxAcceleration&&(i.maxAcceleration=t.maxAcceleration),void 0!==t.maxSpeed&&(i.maxSpeed=t.maxSpeed),void 0!==t.collisionQueryRange&&(i.collisionQueryRange=t.collisionQueryRange),void 0!==t.pathOptimizationRange&&(i.pathOptimizationRange=t.pathOptimizationRange),void 0!==t.separationWeight&&(i.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,i)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=.001)return;let t=1/60;{let i=Math.floor(e/t);i>10&&(i=10),i<1&&(i=1);let n=e/i;for(let e=0;e<i;e++)this.crowd.update(n)}for(let i=0;i<this.agents.length;i++){let e=this.agents[i],t=this.getAgentPosition(e);if(this.transforms[i].copy(t),this._agentDestinationArmed[i]){let n=t.x-this._agentDestination[i].x,r=t.z-this._agentDestination[i].z,a=this.reachRadii[i],o=this._agentDestination[i].y-this.reachRadii[i],s=this._agentDestination[i].y+this.reachRadii[i],l=n*n+r*r;t.y>o&&t.y<s&&l<a*a&&(this.onReachTarget(e,this._agentDestination[i]),this._agentDestinationArmed[i]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,i=this.crowd.getCorners(e),n=i.getPointCount(),r=[];for(t=0;t<n;t++){let e=i.getPoint(t);r.push(new j_(e.x,e.y,e.z))}return r}dispose(){this.crowd.destroy()}};function lee(e){let t=!1;return e.scene.objects.forEach(i=>{"Page"===i.data.type&&!t&&i.data.publish.gameControlObject&&Qj.traverseModuleInstances(e,i.id,(e,i,n)=>{for(let r of n)"GameControl"===r.data.type&&r.data.navmesh.enabled&&(t=!0)})}),t}var cee={type:"change"},dee={type:"changeZoom"},uee={type:"changePan"},hee={type:"start"},pee={type:"end",changed:!0},fee={type:"end",changed:!1},mee=new V_,gee=new p_,vee=2*Math.PI,yee=new j_,bee=new p_,xee=new j_,wee=new V_,See=new yC,_ee={type:"requestRender"},Cee=class extends JS{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{isPlayMode:!1,isExport:!1};super(),this.object=e,this.domElement=t,this.options=i,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,Hw,jw],this.offset=new j_,this.eye=new j_,this.lastPosition=new j_,this.lastQuaternion=new V_,this.current=new p_,this.overShoot=new p_,this.overRatio=new p_,this.spherical=new SO,this.sphericalDelta=new SO,this.panOffset=new j_,this.panLeftV=new j_,this.panUpV=new j_,this.panV=new j_,this.rotateStart=new p_,this.rotateEnd=new p_,this.rotateDelta=new p_,this.panStart=new p_,this.panEnd=new p_,this.panDelta=new p_,this.dollyStart=new p_,this.dollyEnd=new p_,this.dollyDelta=new p_,this.rotationRangeFactor=new p_,this.panRangeFactor=new p_,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.hoverRotateDamping=this.dampingFactor,this.isCurrentlyDamping=!1,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=e=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=e.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(xee,wee,yee),this.offset.copy(xee).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&-1===this.state&&this.rotateLeft((!0===this.autoRotateClockwise?1:-1)*this.getAutoRotationAngle()),0!==this.rotationLimitsMode&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),2!==this.rotationLimitsMode&&(this.spherical.phi+=this.sphericalDelta.phi),(1!==this.rotationLimitsMode||!0===this.autoRotate)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&this.object.isPerspectiveCamera&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),0!==this.panLimitsMode&&(this.target.applyQuaternion(mee.copy(wee).invert()),this.panOffset.applyQuaternion(mee),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(wee),this.panOffset.applyQuaternion(wee)),2===this.panLimitsMode&&(this.panOffset.y=0),1===this.panLimitsMode&&(this.panOffset.x=0),-1!==this.state||this.gesture?(this.target.add(this.panOffset),this.panOffset.set(0,0,0)):(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)),this.offset.setFromSpherical(this.spherical),xee.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(See.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(See));let e=this.spherical.phi%vee;if(this.eye.copy(this.offset).normalize(),this.object.up.copy(WC.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),e>0&&e>Math.PI||e<0&&e>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),-1===this.state||!0===this.enableDamping){let e=1===this.hoverRotatePanMode?this.hoverRotateDamping:this.dampingFactor;this.sphericalDelta.theta*=1-e,this.sphericalDelta.phi*=1-e}else this.sphericalDelta.set(0,0,0);if(this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>.01||8*(1-this.lastQuaternion.dot(this.object.quaternion))>1e-8)return this.dispatchEvent(cee),this.object.dispatchEvent(_ee),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,void(this.isCurrentlyDamping=!0);this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),this.isCurrentlyDamping=!1},this.onPointerDown=e=>{!1!==this.enabled&&("touch"===e.pointerType||"pen"===e.pointerType&&oN?this.onPointerDownTouch(e):this.onPointerDownMouse(e),-1!==this.state&&(this.isPointerDown=!0,this.dispatchEvent(hee),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),e.stopPropagation(),"touch"===e.pointerType||"pen"===e.pointerType&&oN||this.domElement.setPointerCapture(e.pointerId)))},this.onPointerLeave=e=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(1===this.hoverRotatePanMode?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,yee.subVectors(this.position0,this.target0),this.spherical.setFromVector3(yee),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):2===this.hoverRotatePanMode&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=e},this.onPointerEnter=e=>{this.resetHoverEffectOnPointerLeave||void 0===this.pointerLeaveEvent?bee.set(e.clientX-this.domElement.clientWidth/2,e.clientY-this.domElement.clientHeight/2):bee.set(e.clientX-this.pointerLeaveEvent.clientX,e.clientY-this.pointerLeaveEvent.clientY),1===this.hoverRotatePanMode?(this.rotateDelta.copy(bee).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(gee,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(e.clientX,e.clientY)):2===this.hoverRotatePanMode&&(this.panDelta.copy(bee).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(e.clientX,e.clientY)),this.update()},this.onPointerMove=e=>{!1!==this.enabled&&(this.checkRaycastLock()||("touch"===e.pointerType||"pen"===e.pointerType&&oN?this.onPointerMoveTouch(e):this.onPointerMoveMouse(e),e.stopPropagation()))},this.onPointerUp=e=>{this.isPointerDown=!1,0===hN.length&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),hN.length>1&&e.preventDefault(),this.hasChange?this.dispatchEvent(pee):this.dispatchEvent(fee),this.state=-1,e&&(e.stopPropagation(),"touch"===e.pointerType||"pen"===e.pointerType&&oN||this.domElement.releasePointerCapture(e.pointerId))},this.onPointerDownMouse=e=>{let t;switch(t=this.useKeyEvents?this.mouseButtons[e.button]:this.mouseButtonsPlay[e.button],t){case 0:if(!0!==e.altKey||e.shiftKey||uN(e)){if(" "===this.key){if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2}}else{if(!1===this.enableRotate)return;this.handleMouseDownRotate(e),this.state=0}break;case 4:if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2;break;case 3:if(uN(e)||e.shiftKey){if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2}else{if(!1===this.enableRotate)return;this.handleMouseDownRotate(e),this.state=0}break;case 5:if(uN(e)||e.shiftKey){if(!1===this.enableRotate)return;this.handleMouseDownRotate(e),this.state=0}else{if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=e=>{switch(this.state){case 0:if(!1===this.enableRotate)return;this.handleMouseMoveRotate(e);break;case 1:if(!1===this.enableZoom)return;this.handleMouseMoveDolly(e);break;case 2:if(!1===this.enablePan)return;this.handleMouseMovePan(e)}this.object.wasMovedByUser=!0},this.onPointerDownTouch=e=>{switch(hN.length>1&&e.preventDefault(),this.touches[hN.length-1]){case Vw:if(!1===this.enableRotate)return void(this.state=-1);this.handleTouchStartRotate(),this.state=3;break;case jw:if(!1===this.enablePan)return void(this.state=-1);this.handleTouchStartPan(),this.state=4;break;case Ww:if(!1===this.enableZoom&&!1===this.enablePan)return;this.handleTouchStartDollyPan(),this.state=5;break;case Hw:if(!1===this.enableZoom&&!1===this.enableRotate)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=e=>{switch(hN.length>1&&e.preventDefault(),this.state){case 3:if(!1===this.enableRotate)return;this.handleTouchMoveRotate(e),this.update();break;case 4:if(!1===this.enablePan)return;this.handleTouchMovePan(e),this.update();break;case 5:if(!1===this.enableZoom&&!1===this.enablePan)return;this.handleTouchMoveDollyPan(e),this.update();break;case 6:if(!1===this.enableZoom&&!1===this.enableRotate)return;this.handleTouchMoveDollyRotate(e),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=zB(()=>this.dispatchEvent(pee),33),this.onMouseWheel=e=>{!1===this.enabled||!1===this.enableZoom&&!1===this.enablePan||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&e.preventDefault(),this.dispatchEvent(hee),this.handleMouseWheel(e),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=e=>{if(e.preventDefault(),!1!==this.enabled&&!this.checkRaycastLock()&&!rN)if("gesturechange"===e.type){if(!1===this.enableZoom||!1===this.isTouchZoom)return;this.dispatchEvent(hee),e.scale>this.prevScale?this.dollyIn(this.getZoomScale()):e.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=e.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(pee)},this.onContextMenu=e=>{e.preventDefault()},this.onTouchEnd=e=>{e.preventDefault()},this.onKeyDown=e=>{!1!==this.enabled&&(this.key=e.key," "===e.key&&this.dispatchEvent(hee))},this.onKeyUp=e=>{!1!==this.enabled&&(this.key=void 0,-1!==this.state&&"Alt"===e.key&&this.onPointerUp(hN[0])," "===e.key&&this.dispatchEvent(pee))},this.onPointerHover=e=>{"mouse"!==e.pointerType||!1===this.enabled||-1!==this.state||2===this.hoverRotatePanMode&&this.isPanOverShoot||1===this.hoverRotatePanMode&&this.isRotateOverShoot||(this.isPointerDown=!0,2===this.hoverRotatePanMode?this.handleMouseMovePan(e,this.hoverRotatePanStrength):1===this.hoverRotatePanMode&&this.handleMouseMoveRotate(e,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=e=>{e.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.initialSphericalRadius=this.spherical.radius,this.addEventListenersToCamera()}dispatchEvent(e){"start"===e.type?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,0!==this.hoverRotatePanMode&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),0!==this.hoverRotatePanMode&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){var i,n;this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.hoverRotateDamping=null!==(i=e.hoverRotateDamping)&&void 0!==i?i:this.dampingFactor,this.useWindowEvents="window"===t,0!==this.hoverRotatePanMode&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let r=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=r**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/this.maxZoom,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let a=this.object.getTarget().applyQuaternion(mee.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+a.y,this.maxV=e.panVerticalOffset.max+a.y,this.minH=-e.panHorizontalOffset.min+a.x,this.maxH=e.panHorizontalOffset.max+a.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=Eee(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=Eee(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=Eee(Eee(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=Eee(Eee(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,1===e.orbitTouches&&(this.touches[0]=Vw),1===e.panTouches&&(this.touches[0]=jw),2===e.orbitTouches&&(this.touches[1]=Hw),2===e.panTouches&&(this.touches[1]=Ww),3===e.orbitTouches&&(this.touches[2]=Vw),3===e.panTouches&&(this.touches[2]=jw),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=null!==(n=e.resetHoverEffectOnPointerLeave)&&void 0!==n&&n}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),0!==this.hoverRotatePanMode&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,i,n,r,a,o,s){let l,c,d;this.overShoot.set(0,0),e instanceof j_?(l=e.x,c=e.y,this.current.set(this.target.x,this.target.y),d=!0):(l=e.theta,c=e.phi,this.current.set(Eee(this.spherical.theta),Eee(this.spherical.phi)),d=!1),0===i&&(this.current.x+=l,this.current.y+=c),(3===t||2===t)&&(!d&&this.isThetaFlipped?this.current.x>n&&this.current.x<0?this.overShoot.x=n-this.current.x:this.current.x<r&&this.current.x>0&&(this.overShoot.x=r-this.current.x):this.current.x>n?this.overShoot.x=n-this.current.x:this.current.x<r&&(this.overShoot.x=r-this.current.x)),(3===t||1===t)&&(this.current.y>a?this.overShoot.y=a-this.current.y:this.current.y<o&&(this.overShoot.y=o-this.current.y)),d||(this.overShoot.x=Eee(this.overShoot.x),this.overShoot.y=Eee(this.overShoot.y)),0!==i?(this.overRatio.copy(this.overShoot).divide(s),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),1===i&&(this.overRatio.x=Aee(Math.abs(this.overRatio.x)),this.overRatio.y=Aee(Math.abs(this.overRatio.y))),this.isPointerDown||1===i?2===i&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):2===i&&(!d&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||d&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=.05*this.overShoot.x),this.phiIsFree||(c=.05*this.overShoot.y),d?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):d?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),e instanceof j_?(e.x=l,e.y=c):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=c))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=!0===e?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let i=this.domElement;if(i&&this.object.isPerspectiveCamera){let n=this.object.position;this.panV.copy(n).sub(this.target);let r=this.panV.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*r/i.clientHeight,this.object.matrixWorld),this.panUp(2*t*r/i.clientHeight,this.object.matrixWorld)}else i&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrixWorld));this.dispatchEvent(uee)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(dee)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(dee)}zoomOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getZoomScale();this.dispatchEvent(hee),this.dollyOut(e),this.dispatchEvent(pee)}zoomIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getZoomScale();this.dispatchEvent(hee),this.dollyIn(e),this.dispatchEvent(pee)}setZoom(e){if(this.dispatchEvent(hee),this.object.isPerspectiveCamera){let t=this.initialSphericalRadius/e/this.spherical.radius;this.scale=t}else this.object.isOrthographicCamera&&(this.object.zoom=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0);this.dispatchEvent(pee)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;void 0!==e.movementX?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(gee,-this.object.angleOffsetFromUp);let i=this.domElement,n=this.useWindowEvents?window.innerHeight:i.clientHeight,r=2*Math.PI*this.rotateDelta.x/n,a=2*Math.PI*this.rotateDelta.y/n;this.rotateLeft(r),this.rotateUp(a),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;void 0!==e.movementX?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(!1===aN&&!1===uN(e)&&!0===function(e){return 0===e.wheelDeltaY||0===e.deltaY?!(nN&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120)&&(e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX||e.wheelDeltaX===-3*window.devicePixelRatio*e.deltaX:0===e.deltaMode):e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY||e.wheelDeltaY===-3*window.devicePixelRatio*e.deltaY:0===e.deltaMode}(e)){if(!1===this.enablePan)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(!1===this.enableZoom||this.gesture)return;0===e.deltaY?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(2===hN.length){let e=.5*(hN[0].pageX+hN[1].pageX),t=.5*(hN[0].pageY+hN[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(hN[0].pageX,hN[0].pageY)}handleTouchStartPan(){if(2===hN.length){let e=.5*(hN[0].pageX+hN[1].pageX),t=.5*(hN[0].pageY+hN[1].pageY);this.panStart.set(e,t)}else this.panStart.set(hN[0].pageX,hN[0].pageY)}handleTouchStartDolly(){let e=hN[0].pageX-hN[1].pageX,t=hN[0].pageY-hN[1].pageY,i=Math.sqrt(e*e+t*t);this.dollyStart.set(0,i)}handleTouchStartDollyPan(){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(2===hN.length){let t=bN(e),i=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);this.rotateEnd.set(i,n)}else{if(e.pointerId!==hN[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(2===hN.length){let t=bN(e),i=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);this.panEnd.set(i,n)}else{if(e.pointerId!==hN[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=bN(e),i=e.pageX-t.x,n=e.pageY-t.y,r=Math.sqrt(i*i+n*n);this.dollyEnd.set(0,r),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}checkRaycastLock(){if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{var e;let t=null===(e=this.options)||void 0===e?void 0:e.showCameraLock;return t&&t(),!0}}return!1}};function Eee(e){let t=2*Math.PI;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function Aee(e){return 1-Math.pow(1-e,4)}var Mee,Tee=class{constructor(e,t,i,n,r,a){this.id=e,this.data=t,this.object=i,this.page=n,this.currentIntersectedObjects=[],this.actions=B8(t,t.actions,n,r,a,i),this.target=t.target,this.triggeringObjects=[];for(let o of t.triggeringObjects){let e=n.scene.find(o);e&&this.triggeringObjects.push(e)}}isValidTriggeringObject(e){return"all"===this.target||this.triggeringObjects.some(t=>t===e||t.isAncestorOf(e.uuid)||e.isAncestorOf(t.uuid))}disconnect(){N8(this.actions)}dispatch(){this.object.destroyedInAction||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.actions.Transition.forEach(e=>{"Toggle"===e.data.runMode?e.toggle():e.play()}),this.actions.SwitchCamera.forEach(e=>{"Toggle"===e.data.runMode?e.toggle():e.play()}),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()))}};TN.then(e=>Mee=e);var Pee=new j_,Dee=new V_,Oee=new j_,Iee=new TC(0,0,0,"YXZ"),kee=new TC(0,0,0,"XYZ"),Ree=new j_,zee=new j_,Lee=new j_(1,1,1),Bee=new V_,Nee=new yC,Fee=new yC,Uee={type:"updateMatrix"},Vee=new V_,jee=new cC,Wee={type:"beginEvent",eventName:"Collision"},Hee={type:"beginEvent",eventName:"Trigger"};var Gee=e=>e.states.some(e=>void 0!==e.data.position||void 0!==e.data.rotation||void 0!==e.data.hiddenMatrix||void 0!==e.data.cloner||void 0!==e.data.pathSnapping),qee=class{constructor(e){this.eventContext=e,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.skipRender=!0,this.processRigidBody=e=>{if(e.bodyType()!==Mee.RigidBodyType.Dynamic)return;e.isSleeping()||this.nActiveRigidBodies++;let[t,i,n]=this.rigidBodyToMesh.get(e.handle);if(Pee.copy(e.translation()).multiplyScalar(this.pixelsPerMeter),Dee.copy(e.rotation()),t.matrixWorld.compose(Pee,Dee,i),t.hasNonUniformScale&&t.matrixWorld.multiply(t.shearScale),t.dispatchEvent(Uee),n){let e=t.cloner;if(e&&void 0===e.objectForSample){e.matrixWorld.copy(t.matrixWorld);for(let t of e.children)t.updateMatrixWorld(!0)}for(let i of t.children)i.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(e,t,i)=>{var n,r;if(!1===i)return;let a,o;if(this.sensorToTriggerEvent[e]?(a=this.sensorToTriggerEvent[e],o=this.sharedGameControlGlobals.colliderToEntity.get(t)):this.sensorToTriggerEvent[t]&&(a=this.sensorToTriggerEvent[t],o=this.sharedGameControlGlobals.colliderToEntity.get(e)),a&&o&&a.isValidTriggeringObject(o))a.dispatch();else{for(let i=this.sharedGameControlGlobals.createdObjects.length-1;i>=0;i--){var s,l;let n=this.sharedGameControlGlobals.createdObjects[i];if(n.userData.hasCollisionDestroy&&((null===(s=n.rigidBody)||void 0===s?void 0:s.collider(0).handle)===e||(null===(l=n.rigidBody)||void 0===l?void 0:l.collider(0).handle)===t)){this.sharedGameControlGlobals.createdObjects.splice(i,1),n.removeFromParent(),requestAnimationFrame(()=>{var e;return null===(e=this.sharedGameControlGlobals.rapierWorld)||void 0===e?void 0:e.removeRigidBody(n.rigidBody)});break}}if(void 0!==(null===(n=this.gameControl)||void 0===n?void 0:n.object)&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(e)){let e=this.sharedGameControlGlobals.colliderToEntity.get(t),i=this.sharedGameControlGlobals.entityToCollisionEvents[e.uuid];if(void 0===i)return;for(let n of i)"character"===n.data.target&&this.dispatchCollisionEvent(n,e,t)}else if(void 0!==(null===(r=this.gameControl)||void 0===r?void 0:r.object)&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(t)){let t=this.sharedGameControlGlobals.colliderToEntity.get(e),i=this.sharedGameControlGlobals.entityToCollisionEvents[t.uuid];if(void 0===i)return;for(let n of i)"character"===n.data.target&&this.dispatchCollisionEvent(n,t,e)}else{let i=this.sharedGameControlGlobals.colliderToEntity.get(e),n=this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid];if(void 0!==n)for(let t of n)"scene"===t.data.target&&this.dispatchCollisionEvent(t,i,e);let r=this.sharedGameControlGlobals.colliderToEntity.get(t),a=this.sharedGameControlGlobals.entityToCollisionEvents[null===r||void 0===r?void 0:r.uuid];if(void 0!==a)for(let e of a)"scene"===e.data.target&&this.dispatchCollisionEvent(e,r,t)}}},this.isExport=e.isExport,this.sharedAssets=e.sharedAssets,this.renderer=e.renderer,this.requestRender=e.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=200,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(e){e.forEach(e=>{e.addEventListener("connected",e=>{"gamepad"in e.data&&"axes"in e.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(e.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(e=>{let t=e.dataPatched;for(let n of t.events){var i;if(!0===n.data.disabled)continue;let e=null===(i=n.data.actions)||void 0===i||null===(i=i.find(e=>"Destroy"===e.data.type))||void 0===i?void 0:i.data;if(e)for(let t of e.objects){let e=this.page.scene.find(t);e&&(e.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(e=>{let t=e.dataPatched;for(let i of t.events)if(!0!==i.data.disabled&&"DragDrop"===i.data.type)for(let e of i.data.objects){let t=this.page.scene.find(e);t&&(t.userData.hasDrag=!0)}})}initBVH(){let e=[];if(this.page.traverseChildren(t=>{var i,n;let r;if(t instanceof X$||t instanceof T0||t instanceof s4)return;r=t instanceof IG?t.object:t;let a=r.dataPatched;if("visibility"===(null===(i=a.physics)||void 0===i?void 0:i.enabled)?!a.visible:null===(n=a.physics)||void 0===n||!n.enabled)return!0;let o=t.geometry,s=!0===r.userData.hasDestroy,l=!0===r.userData.hasDrag;if(Gee(a)||s||l||r.dataPatched.events.some(e=>!0!==e.data.disabled&&("GameControl"===e.data.type||"Follow"===e.data.type)))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;o&&e.push(S9(o,t.matrixWorld))}),e.length>0){let t=KW(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new hG(t)}}addRigidBody(e,t,i){if(w9(e.matrixWorld))return;let n=[],r="geometry"in e?e.geometry:void 0,a=t.dataPatched;if(void 0!==(null===r||void 0===r?void 0:r.getAttribute("position"))&&n.push(S9(r,e.shearScale)),a.physics.fusedBody){let t=this.gatherChildrenGeom(e,n);e.traverseObject(t),e.children.forEach(e=>e.updateMatrixWorld(!0));let i=e.cloner;i&&void 0===i.objectForSample&&"dynamic"===a.physics.rigidBody&&(i.traverseObject(t),i.children.forEach(e=>e.updateMatrixWorld(!0)))}if(n.length>0){let l,c=!i.fromCreate&&"dynamic"===a.physics.rigidBody||i.fromCreate&&i.dynamic;c?(l=Mee.RigidBodyDesc.dynamic(),l.setLinearDamping(a.physics.damping).setAngularDamping(a.physics.damping).setAdditionalMass(1e-9).setGravityScale(a.physics.gravityScale).enabledRotations(...a.physics.enabledRotation).enabledTranslations(...a.physics.enabledTranslation)):(i.hasTransformAnim||i.hasFollow||i.hasDrag)&&!i.fromCreate?(l=Mee.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):l=Mee.RigidBodyDesc.fixed();let d=KW(n);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(Pee,Dee,Oee),e.position0=Pee.clone().divideScalar(this.pixelsPerMeter),e.rotation0=Dee.clone(),Pee.divideScalar(this.pixelsPerMeter),l.setTranslation(Pee.x,Pee.y,Pee.z).setRotation(Dee),r?null===d||void 0===d||d.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):null===d||void 0===d||d.scale(Oee.x/this.pixelsPerMeter,Oee.y/this.pixelsPerMeter,Oee.z/this.pixelsPerMeter);let u=this.sharedGameControlGlobals.rapierWorld.createRigidBody(l);c&&this.rigidBodyToMesh.set(u.handle,[e,Oee.clone(),a.physics.fusedBody]);let h=!(void 0===a.geometry||"SubdivGeometry"===a.geometry.type||"NonParametricGeometry"===a.geometry.type||"BooleanGeometry"===a.geometry.type||"VectorGeometry"===a.geometry.type||"StarGeometry"===a.geometry.type||"RectangleGeometry"===a.geometry.type||"EllipseGeometry"===a.geometry.type||"TriangleGeometry"===a.geometry.type||"TorusGeometry"===a.geometry.type||"HelixGeometry"===a.geometry.type);try{this.addCollider(u,a.physics,d,t,h)}catch(o){try{this.addCollider(u,a.physics,d,t,!1)}catch(s){console.error(s)}}e.rigidBody=u}}addBoundsTree(e){var t,i;let n=[];if(void 0!==(null===(t=e.geometry)||void 0===t?void 0:t.getAttribute("position"))&&(null===(i=e.geometry)||void 0===i?void 0:i.getAttribute("position").count)>0&&n.push(S9(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,n)),e.children.forEach(e=>e.updateMatrixWorld(!0)),n.length>0){let t=KW(n,!1);e.bvhGeometry=t,t.getAttribute("position").count>0&&(e.bvhGeometry.boundsTree=new hG(t),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e))}}addCollider(e,t,i,n){var r,a;let o,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(0===(null===i||void 0===i?void 0:i.getAttribute("position").count)||0===(null===i||void 0===i||null===(r=i.getIndex())||void 0===r?void 0:r.count))return;i&&(o="trimesh"===t.colliderType?Mee.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array):Mee.ColliderDesc.convexMesh(i.getAttribute("position").array,s?i.getIndex().array:void 0)),o.setFrictionCombineRule(Mee.CoefficientCombineRule.Average).setRestitutionCombineRule(Mee.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let l=this.sharedGameControlGlobals.rapierWorld.createCollider(o,e);this.sharedGameControlGlobals.colliderToEntity.set(l.handle,n),(null===(a=this.sharedGameControlGlobals.entityToCollisionEvents[n.uuid])||void 0===a?void 0:a.some(e=>"scene"===e.target))&&l.setActiveEvents(Mee.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(e,t){return(i,n)=>{var r;if(0===n)return;let a;if(i instanceof X$){if(!i.objectForSample)return!0===i.object.dataPatched.physics.fusedBody&&"dynamic"===i.object.dataPatched.physics.rigidBody||void 0;if(i.objectForSample.dataPatched.physics.fusedBody)return;a=i.object}else if(i instanceof IG)a=i.object;else if(a=i,null!==(r=a.dataPatched.cloner)&&void 0!==r&&r.hideBase)return!0;let o=a.dataPatched;if("visibility"===o.physics.enabled?!o.visible:!o.physics.enabled)return!0;1===n?e.hasNonUniformScale?i.matrixWorld.multiplyMatrices(e.shearScale,i.hiddenMatrix):i.matrixWorld.copy(i.hiddenMatrix):i.matrixWorld.multiplyMatrices(i.parent.matrixWorld,i.hiddenMatrix),i.matrixWorld.multiply(i.matrix);let s=i.geometry;void 0!==(null===s||void 0===s?void 0:s.getAttribute("position"))&&t.push(S9(s,i.matrixWorld))}}activate(e){if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=e,this.usePhysics=this.page.data.globalPhysics.usePhysics;let t=this.page.playCamera,i=!1,n=5,r=8,a=9,o="drag",s=this.page.data.publish.gameControlObject,l=null!==s?this.page.find(s):null,d=null;if(l)for(let c of l.data.events){if(c.data.disabled||"GameControl"!==c.data.type)continue;let e=l;for(;this.usePhysics&&null!==(null===(u=e=e.parent)||void 0===u?void 0:u.parent);){var u,h;null===(h=e.data.physics)||void 0===h||h.fusedBody}c.data.collisionEnabled&&(this.needsCollisionDetection=!0),null===d&&(d=c.data)}if(this.page.traverseEntity(e=>{for(let t of e.dataPatched.events)if(!1===t.data.disabled&&"Trigger"===t.data.type)return this.needsCollisionDetection=!0,!0}),l&&d&&(!0===l.data.visible||!0===l.data.physics.enabled)){i=i||d.camera===t.uuid||l.uuid===t.uuid;let e=new b9(l,this.renderer.domElement,d,this.eventContext.page.data.globalPhysics,this,l.uuid!==t.uuid&&d.camera===t.uuid,t,this.page,this.sharedAssets);this.gameControl=e,n=d.joystickPosLoc,r=d.joystickRotLoc,a=d.jumpTouchButtonLoc,o=d.rotByTouch,oN&&d.touchControl&&(this.joystickToGameControls[n]="pos","walk"===d.moveMode&&(this.joystickToGameControls[a]="jmp"),"joystick"===o&&(this.joystickToGameControls[r]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let e=this.gameControl.data;if(!this.navigationMeshWrapper){let t;this.navigationMeshWrapper=new oee(this.usePhysics,this.isExport),t="sphere"===e.collider.type?2*e.collider.radius:e.collider.height,t=Math.floor(t/e.navmesh.ch-1),this.navigationMeshWrapper.init(c(c({},e.navmesh),{},{walkableHeight:t}),this.gameControl,this.eventContext)}}if(!1===i){let{enableRotate:e,enablePan:i,enableZoom:n,autoRotate:r,hoverRotatePanMode:a}=this.eventManager.publish.orbitControls;(e||i||n||r||0!==a)&&(this.orbitControls=new Cee(t,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let p=this.renderer.domElement.width/this.renderer.getPixelRatio(),f=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((e,t)=>{let i=document.body.appendChild(document.createElement("div")),[n,r,a]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[t],o=(p-5*n)/4+n,s={},l="jmp"===e,c=l?0:n;t<10?(t<5?s.top=c/2:s.bottom=c/2,s.left=c/2+t%5*o):10===t?(s.left=c/2,s.top=f/2):(s.right=c/2,s.top=f/2),s.top?s.top-=r[1]:s.bottom+=r[1],s.left?s.left+=r[0]:s.right-=r[0];for(let h in s)s[h]+="px";if(l){let e=i.appendChild(document.createElement("div"));Object.assign(e.style,s,{position:"absolute",width:n+"px",height:n+"px",backgroundColor:"rgba(255,255,255,".concat("show"===a?.4:0,")"),zIndex:"9999",borderRadius:n+"px",border:"show"===a?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let r=n/16*16*.4;return"show"===a&&(e.innerHTML='\n\t\t\t\t\t\t<svg width="'.concat(r,'" height="').concat(.4*n,'" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t')),e.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),e.addEventListener("touchend",e=>e.preventDefault()),void(this.joysticks[t]=[void 0,i])}let d={zone:i,mode:"static",position:s,size:n};"hide"===a&&(d.restOpacity=0);let u=E5(d);u.on("move",(t,i)=>{let n=this.gameControl;"pos"===e?i.force<.2?n.moveForce=0:(n.movementState.movePosZ=Math.sin(-i.angle.radian),n.movementState.movePosX=Math.cos(-i.angle.radian),i.force>1.2?n.movementState.run=1:n.movementState.run=0,i.force<.3?n.moveForce=(i.force-.2)/.1:n.moveForce=1):"rot"===e&&(i.force<.2?n.rotForce=0:(n.movementState.rotPosX=i.vector.y,n.movementState.rotPosY=-i.vector.x,i.force<.3?n.rotForce=(i.force-.2)/.1:n.rotForce=1)),this.requestRender()}),u.on("end",(t,i)=>{let n=this.gameControl;"pos"===e?(n.movementState.movePosZ=0,n.movementState.movePosX=0,n.moveForce=1):"rot"===e&&(n.movementState.rotPosX=0,n.movementState.rotPosY=0,n.rotForce=1)}),this.joysticks[t]=[u,i]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(e=>e.initialDisabled=!1)},80)}initPhysics(){var e;null!==(e=this.sharedGameControlGlobals.rapierWorld)&&void 0!==e&&e.free(),this.sharedGameControlGlobals.rapierWorld=new Mee.World(new Mee.Vector3(0,this.gravity,0)),this.events=new Mee.EventQueue(!0);let t=[],i=[];if(this.page.traverseChildren(e=>{var n;let r;if(e instanceof X$){if(!e.objectForSample)return!0===e.object.dataPatched.physics.fusedBody&&"dynamic"===e.object.dataPatched.physics.rigidBody||void 0;if(e.objectForSample.dataPatched.physics.fusedBody)return;r=e.object}else if(e instanceof IG)r=e.object;else{var a,o,s;if(e instanceof s4||e instanceof T0)return;if(r=e,!1===(null===(a=r.dataPatched.cloner)||void 0===a?void 0:a.disabled)&&null!==(o=r.dataPatched.cloner)&&void 0!==o&&o.hideBase&&!0!==(null===(s=r.dataPatched.physics)||void 0===s?void 0:s.fusedBody))return!0}let l,c=r.dataPatched;for(let t of c.events)!0!==t.data.disabled&&"GameControl"===t.data.type&&(l=t.data);if(!c.physics||("visibility"===c.physics.enabled?!c.visible:!c.physics.enabled))return!0;e.updateMatrixWorldSVD();let d=Gee(c),u=!1,h=r.userData.hasDestroy,p=r.userData.hasDrag,f=!1;for(let t of c.events)if(!0!==t.data.disabled)if("Collision"===t.data.type){u=!0;let e=new K7(t.id,t.data,r,this.page,this.sharedAssets,this.eventManager);e.initialDisabled=!0,this.collisionEvents.push(e),this.sharedGameControlGlobals.entityToCollisionEvents[r.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[r.uuid].every(e=>e.id!==t.id)?this.sharedGameControlGlobals.entityToCollisionEvents[r.uuid].push(e):this.sharedGameControlGlobals.entityToCollisionEvents[r.uuid]=[e]}else if("Follow"===t.data.type){f=!0;let i=t.data.target;e.traverseVisible(e=>{e.userData.isFollowingObj=i})}"dynamic"===c.physics.rigidBody&&!1===c.physics.fusedBody&&(e.matrixWorldFusedFalse=e.matrixWorld.clone());let m=e.geometry;if(void 0!==l){let t=Mee.RigidBodyDesc.kinematicPositionBased();(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(Pee,Dee,Oee),e.position0=Pee.clone().divideScalar(this.pixelsPerMeter),e.rotation0=Dee.clone(),Pee.divideScalar(this.pixelsPerMeter),t.setTranslation(Pee.x,Pee.y,Pee.z).setRotation(Dee);let i,n=this.sharedGameControlGlobals.rapierWorld.createRigidBody(t);e.rigidBody=n,i="sphere"===l.collider.type?Mee.ColliderDesc.ball(l.collider.radius/this.pixelsPerMeter):"capsule"===l.collider.type?Mee.ColliderDesc.capsule((l.collider.height/2-l.collider.radius)/this.pixelsPerMeter,l.collider.radius/this.pixelsPerMeter):Mee.ColliderDesc.cuboid(l.collider.width/this.pixelsPerMeter/2,l.collider.height/this.pixelsPerMeter/2,l.collider.depth/this.pixelsPerMeter/2),i.setFrictionCombineRule(Mee.CoefficientCombineRule.Average).setRestitutionCombineRule(Mee.CoefficientCombineRule.Average).setDensity(c.physics.density).setFriction(c.physics.friction).setRestitution(c.physics.restitution);let a=this.sharedGameControlGlobals.rapierWorld.createCollider(i,n);this.sharedGameControlGlobals.colliderToEntity.set(a.handle,r),Pee.fromArray(l.collider.position).multiply(Oee.setFromMatrixScale(r.matrixWorld)).divideScalar(this.pixelsPerMeter),a.setTranslationWrtParent(Pee);let o=(new V_).setFromEuler((new TC).setFromVector3((new j_).fromArray(l.collider.rotation)));a.setRotationWrtParent(o),a.setActiveEvents(Mee.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(r,!0)}else"dynamic"===c.physics.rigidBody||d||f||h||p||u?(this.addRigidBody(e,r,{hasFollow:f,hasTransformAnim:d,hasDrag:p}),this.generateSensorColliderDescs(r,c.physics.fusedBody)):(m&&t.push(S9(m,e.matrixWorld)),c.physics.fusedBody&&e.traverseObject((e,i)=>{if(0===i)return;let n;if(e instanceof X$){if(!e.objectForSample)return!0===e.object.dataPatched.physics.fusedBody&&"dynamic"===e.object.dataPatched.physics.rigidBody||void 0;if(e.objectForSample.dataPatched.physics.fusedBody)return;n=e.object}else{var r;if(e instanceof s4||e instanceof T0)return;if(e instanceof IG)n=e.object;else if(n=e,null!==(r=n.dataPatched.cloner)&&void 0!==r&&r.hideBase)return!0}let a=n.dataPatched;if("visibility"===a.physics.enabled?!a.visible:!a.physics.enabled)return!0;let o=e.geometry;void 0!==(null===o||void 0===o?void 0:o.getAttribute("position"))&&t.push(S9(o,e.matrixWorld))}),this.generateSensorColliderDescs(r,c.physics.fusedBody,i));return!(!0!==(null===(n=c.physics)||void 0===n?void 0:n.fusedBody)&&!l)||void 0}),0===t.length)return;let n=KW(t);n.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let r=Mee.RigidBodyDesc.fixed(),a=this.sharedGameControlGlobals.rapierWorld.createRigidBody(r),o=Mee.ColliderDesc.trimesh(n.getAttribute("position").array,n.getIndex().array).setFrictionCombineRule(Mee.CoefficientCombineRule.Multiply).setRestitutionCombineRule(Mee.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(o,a);for(let[s,l]of i){let e=this.sharedGameControlGlobals.rapierWorld.createCollider(s,a);this.sensorToTriggerEvent[e.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?this.initPhysics():(this.page.traverseEntity(e=>{for(let t of e.dataPatched.events)if("Trigger"===t.data.type&&!0!==t.data.disabled){let i=new Tee(t.id,t.data,e,this.page,this.sharedAssets,this.eventManager),n=(new yC).compose(Ree.fromArray(t.data.position),Bee.setFromEuler(kee.fromArray(t.data.rotation)),Lee);if("box"===t.data.triggerZone){let r=new G_;r.min.fromArray(t.data.size).multiplyScalar(-.5),r.max.fromArray(t.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([r,n,e,i])}else this.sharedGameControlGlobals.triggers.push([t.data.radius,n,e,i])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(e=>e.disconnect()),this.sharedGameControlGlobals.triggers.forEach(e=>e[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){if(this.isEnabled){var e,t,i,n;this.isEnabled=!1,this.page.traverse(e=>{let t=e;t.matrixWorldFusedFalse&&(t.matrixWorldFusedFalse=void 0),t.rigidBody&&(t.rigidBody=void 0),t.position0&&(t.position0=void 0),t.rotation0&&(t.rotation0=void 0)}),null!==(e=this.sharedGameControlGlobals.rapierWorld)&&void 0!==e&&e.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),null!==(t=this.gameControl)&&void 0!==t&&t.reset(),null!==(i=this.gameControl)&&void 0!==i&&i.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(e=>{let[t,i]=e;null!==t&&void 0!==t&&t.destroy(),i.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),null!==(n=this.navigationMeshWrapper)&&void 0!==n&&n.dispose(),this.navigationMeshWrapper=void 0;for(let e of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))e.forEach(e=>e.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(e,t,i){if(!this.isEnabled)return!0;let n=!0;if(void 0!==this.orbitControls&&this.orbitControls.needsUpdate&&(this.orbitControls.update(),n=!this.orbitControls.isCurrentlyDamping),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,n=!1):2===this.initializationCounter&&this.gameControl&&(n=!this.gameControl.update(e,t,i)&&n),!1===this.usePhysics&&this.checkTrigger(),this.usePhysics){let t=.016666666666666666;if(0===e)n=this.stepPhysics()&&n;else{let i=e/1e3;i<t&&i>.55*t&&(i=t),this.accumulator+=i;let r=performance.now(),a=0,o=6;for(;this.accumulator>=t&&a<o&&(n=this.stepPhysics()&&n,this.accumulator-=t,a++,!(performance.now()-r>1e3*t)););this.accumulator=this.accumulator%t}}this.skipRender=n}stepPhysics(){var e;for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(Pee,Dee,Oee),Iee.setFromQuaternion(Dee);let e=t;void 0===e.prevR?(e.prevR=Iee.clone(),e.prevT=Pee.clone()):(e.prevR.copy(Iee),e.prevT.copy(Pee)),t.rigidBody&&(t.rigidBody.setNextKinematicTranslation(Pee.divideScalar(this.pixelsPerMeter)),t.rigidBody.setNextKinematicRotation(Dee))}return this.sharedGameControlGlobals.rapierWorld.step(this.events),null!==(e=this.events)&&void 0!==e&&e.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(e,t,i){var n;let r,a=(null===(n=this.sharedGameControlGlobals.rapierWorld)||void 0===n?void 0:n.getCollider(i))._parent;if(t.cloner)for(let o of t.cloner.children)if(o.rigidBody===a){r=o;break}e.dispatch(r),t.dispatchEvent(Wee)}updateUseWindowEvents(e){var t;null===(t=this.orbitControls)||void 0===t||t.updateUseWindowEvents(e)}generateSensorColliderDescs(e,t,i){let n=Fee.copy(e.matrixWorld).invert();e.traverseEntity((r,a)=>{if(!1===t&&1===a)return!0;for(let t of r.dataPatched.events)if("Trigger"===t.data.type&&!0!==t.data.disabled){let a,o=new Tee(t.id,t.data,r,this.page,this.sharedAssets,this.eventManager);if(a="box"===t.data.triggerZone?Mee.ColliderDesc.cuboid(...t.data.size.map(e=>e/(2*this.pixelsPerMeter))):Mee.ColliderDesc.ball(t.data.radius/this.pixelsPerMeter),a.setDensity(0).setSensor(!0).setActiveEvents(Mee.ActiveEvents.COLLISION_EVENTS),Ree.fromArray(t.data.position),Bee.setFromEuler(kee.fromArray(t.data.rotation)),Nee.compose(Ree,Bee,Lee).premultiply(r.matrixWorld),i?(Nee.decompose(Ree,Bee,zee),a.setActiveCollisionTypes(Mee.ActiveCollisionTypes.KINEMATIC_FIXED|Mee.ActiveCollisionTypes.DYNAMIC_FIXED)):(Nee.premultiply(n).decompose(Ree,Bee,zee),e.rigidBody.bodyType()===Mee.RigidBodyType.Dynamic||(e.rigidBody.bodyType()===Mee.RigidBodyType.Fixed?a.setActiveCollisionTypes(Mee.ActiveCollisionTypes.KINEMATIC_FIXED|Mee.ActiveCollisionTypes.DYNAMIC_FIXED):a.setActiveCollisionTypes(Mee.ActiveCollisionTypes.KINEMATIC_KINEMATIC|Mee.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),Ree.divideScalar(this.pixelsPerMeter),a.setTranslation(Ree.x,Ree.y,Ree.z),a.setRotation(Bee),i)i.push([a,o]);else{let t=this.sharedGameControlGlobals.rapierWorld.createCollider(a,e.rigidBody);this.sensorToTriggerEvent[t.handle]=o}}})}checkTrigger(){let e;for(let t=0;t<this.sharedGameControlGlobals.triggers.length;t++){let[i,n,r,a]=this.sharedGameControlGlobals.triggers[t];for(let t=0;t<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;t++){let o=this.sharedGameControlGlobals.entitiesWithTransformAnim[t];if(r===o||!1===a.isValidTriggeringObject(PG.is(o)?o:o.object))continue;let s=Fee.copy(r.matrixWorld).decompose(Ree,Vee,zee).compose(Ree,Vee,Lee).multiply(n),l=Nee.copy(o.matrixWorld).invert().multiply(s);i instanceof G_?e=o.bvhGeometry.boundsTree.intersectsBox(i,l):(jee.radius=i,jee.center.setFromMatrixPosition(l),e=o.bvhGeometry.boundsTree.intersectsSphere(jee)),e?-1===a.currentIntersectedObjects.indexOf(o)&&(a.currentIntersectedObjects.push(o),a.dispatch(),r.dispatchEvent(Hee)):a.currentIntersectedObjects=a.currentIntersectedObjects.filter(e=>e!==o)}}}};function Xee(e){var t;let i=this._clip.duration,n=null!==(t=this._clip.start)&&void 0!==t?t:0,r=this.loop,a=this.time+e,o=this._loopCount,s=r===zS;if(0===e)return-1===o?a:s&&1===(1&o)?i-(a-n):a;if(2200===r){-1===o&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(a>=i)a=i;else{if(!(a<0)){this.time=a;break e}a=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===o&&(e>=0?(o=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),a>=i||a<n){let t=Math.floor((a-n)/(i-n));a-=(i-n)*t,o+=Math.abs(t);let r=this.repetitions-o;if(r<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s||(a=e>0?i:n,1===this.repetitions&&(a=i)),this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===r){let t=e<0;this._setEndings(t,!t,s)}else this._setEndings(!1,!1,s);this._loopCount=o,this.time=a,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:t})}}else this.time=a;if(s&&1===(1&o))return i-(a-n)}return a}var Yee,Qee=!1,Kee=class{constructor(e,t,i,n){this.scene=e,this.requestRender=t,this.updateDisplayProgress=i,this.animationInspectorState=n,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=e=>{"Empty"===e.data.type&&e.data.animations&&e.data.animations.forEach((t,i)=>{let n=t[0]+"/";if(Array.isArray(e.identity)?n+=e.identity[0]:n+=e.uuid,this.clipIdToAction[n])return;let r=MD.parse(JSON.parse(t[2]));e.animations[i]=r;let a=this.mixer.clipAction(r,e);!1===Qee&&(Object.getPrototypeOf(a)._updateTime=Xee,Qee=!0),a.clampWhenFinished=!0,this.clipIdToAction[n]=a})},this.mixer=new vO(e),this.scene.traverseEntity(this.addClip)}deleteClip(e,t){let i=this.scene.find(t);if(!i)return;let n=i.animations.find(t=>t.uuid===e);if(!n)return;let r=this.clipIdToAction[e];!r||(r.stop(),this.mixer.uncacheClip(n),delete this.clipIdToAction[e],i.animations=i.animations.filter(t=>t.uuid!==e))}get isPlaying(){return Object.values(this.clipIdToAction).some(e=>e.isRunning())}playFromInspector(e){this.mixer.stopAllAction();let t=this.clipIdToAction[e];!t||(t.play(),this.activeClip=t.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(e=>{e.repetitions=1/0,e.loop=2201}),this.mixer.stopAllAction(),this.requestRender()}play(e){let t=e.clipId+"/"+e.object,i=this.clipIdToAction[t];if(i)return e&&(e.repeat>=0&&(i.repetitions=e.repeat+1),"pingpong"===e.direction&&0!==e.repeat&&(i.loop=zS)),i.play(),i.paused=!1,this.requestRender(),i}resumeFromInspector(e){let t=this.clipIdToAction[e];!t||(t.play(),t.paused=!1,this.requestRender())}pauseFromInspector(e){let t=this.clipIdToAction[e];!t||(t.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(e){var t;if(this.needsUpdate)this.needsUpdate=!1;else if(!1===this.isPlaying||null!==(t=this.animationInspectorState)&&void 0!==t&&t.isScrubbing)return;this.mixer.update(e/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*(this.maxFrames-1)%(this.maxFrames-1))),this.requestRender()}get maxFrames(){var e;return P8(null!==(e=this.activeClip)&&void 0!==e?e:void 0)}setProgressFromInspector(e,t){if(!this.clipIdToAction[t])return;this.activeClip!==this.clipIdToAction[t].getClip()&&this.playFromInspector(t);let i=this.clipIdToAction[t].paused;this.clipIdToAction[t].paused=!1,this.mixer.setTime(Math.min(e/(this.maxFrames-1),.9999)*this.activeClip.duration),this.requestRender(),i&&(this.clipIdToAction[t].paused=!0)}},Zee=new WeakMap,Jee=class extends ID{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,n){let r=new zD(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,e=>{this.decodeDracoFile(e,t).catch(n)},i,n)}decodeDracoFile(e,t,i,n){let r={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!i};return this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){let i=JSON.stringify(t);if(Zee.has(e)){let t=Zee.get(e);if(t.key===i)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n,r=this.workerNextTaskID++,a=e.byteLength,o=this._getWorker(r,a).then(i=>(n=i,new Promise((i,a)=>{n._callbacks[r]={resolve:i,reject:a},n.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return o.catch(()=>!0).then(()=>{n&&r&&this._releaseTask(n,r)}),Zee.set(e,{key:i,promise:o}),o}_createGeometry(e){let t=new vE;e.index&&t.setIndex(new oE(e.index.array,1));for(let i=0;i<e.attributes.length;i++){let n=e.attributes[i],r=n.name,a=n.array,o=n.itemSize;t.setAttribute(r,new oE(a,o))}return t}_loadLibrary(e,t){let i=new zD(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((t,n)=>{i.load(e,t,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{let i=t[0];e||(this.decoderConfig.wasmBinary=t[1]);let n=$ee.toString(),r=["/* draco decoder */",i,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([r]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){let i=t.data;switch(i.type){case"decode":e._callbacks[i.id].resolve(i);break;case"error":e._callbacks[i.id].reject(i);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+i.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});let i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}};function $ee(){let e,t;function i(e,t,i,n,r,a){let o=a.num_components(),s=i.num_points()*o,l=s*r.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,r),d=e._malloc(l);t.GetAttributeDataArrayForAllPoints(i,a,c,l,d);let u=new r(e.HEAPF32.buffer,d,s).slice();return e._free(d),{name:n,array:u,itemSize:o}}onmessage=function(n){let r=n.data;switch(r.type){case"init":e=r.decoderConfig,t=new Promise(function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)});break;case"decode":let n=r.buffer,a=r.taskConfig;t.then(e=>{let t=e.draco,o=new t.Decoder,s=new t.DecoderBuffer;s.Init(new Int8Array(n),n.byteLength);try{let e=function(e,t,n,r){let a,o,s=r.attributeIDs,l=r.attributeTypes,c=t.GetEncodedGeometryType(n);if(c===e.TRIANGULAR_MESH)a=new e.Mesh,o=t.DecodeBufferToMesh(n,a);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");a=new e.PointCloud,o=t.DecodeBufferToPointCloud(n,a)}if(!o.ok()||0===a.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+o.error_msg());let d={index:null,attributes:[]};for(let u in s){let n,o,c=self[l[u]];if(r.useUniqueIDs)o=s[u],n=t.GetAttributeByUniqueId(a,o);else{if(o=t.GetAttributeId(a,e[s[u]]),-1===o)continue;n=t.GetAttribute(a,o)}d.attributes.push(i(e,t,a,u,c,n))}return c===e.TRIANGULAR_MESH&&(d.index=function(e,t,i){let n=3*i.num_faces(),r=4*n,a=e._malloc(r);t.GetTrianglesUInt32Array(i,r,a);let o=new Uint32Array(e.HEAPF32.buffer,a,n).slice();return e._free(a),{array:o,itemSize:1}}(e,t,a)),e.destroy(a),d}(t,o,s,a),n=e.attributes.map(e=>e.array.buffer);e.index&&n.push(e.index.array.buffer),self.postMessage({type:"decode",id:r.id,geometry:e},n)}catch(l){console.error(l),self.postMessage({type:"error",id:r.id,error:l.message})}finally{t.destroy(s),t.destroy(o)}})}}}function ete(e){return Yee||(Yee=new Jee).setDecoderPath(e?"".concat(e,"/"):"https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload(),Yee.decoderPending}async function tte(e){if(Yee){let t,i={attributeIDs:Yee.defaultAttributeIDs,attributeTypes:Yee.defaultAttributeTypes,useUniqueIDs:!1};try{t=await Yee.decodeGeometry(new Int8Array(e).buffer,i)}catch(WN){console.error(WN)}if(t)return{index:t.index?{array:t.index.array}:void 0,attributes:Object.entries(t.attributes).map(e=>{let[t,i]=e;return{name:t,itemSize:i.itemSize,array:i.array}})}}return null}var ite=class{constructor(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0],this._delay=500,this._distance=2,this._onMouseDown=e=>{let t=[e.clientX,e.clientY],i=(new Date).getTime();if(this._clickCount>0){let e=t[0]-this._lastPosition[0],i=t[1]-this._lastPosition[1];Math.sqrt(e*e+i*i)>this._distance&&(this._clickCount=0)}this._lastPosition=t,this._clickCount=i-this._lastTime>this._delay?1:this._clickCount+1,this._lastTime=i},this._onMouseUp=e=>{}}start(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;this._target&&this.stop(),this.reset(),this._delay=t,this._distance=i,this._target=e,this._target.addEventListener("pointerdown",this._onMouseDown,!1),this._target.addEventListener("pointerup",this._onMouseUp,!1)}stop(){this._target&&(this._target.removeEventListener("pointerdown",this._onMouseDown,!1),this._target.removeEventListener("pointerup",this._onMouseUp,!1),this._target=void 0)}get clickCount(){return this._clickCount}reset(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0]}},nte=class{constructor(e,t,i,n,r,a,o,s){this.eventId=e,this.id=t,this.data=i,this.dataEvent=n,this.object=r,this.stage=!1,this.actions=B8(n,i.actions,a,o,s,r)}disconnect(){N8(this.actions)}dispatchIn(){this.actions.Audio.forEach(e=>e.dispatchBasic()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Video.forEach(e=>e.dispatchBasic()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.Link.forEach(e=>e.dispatch()),this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.actions.Transition.forEach(e=>e.toggle()),this.actions.Animation.forEach(e=>e.play()),this.actions.SwitchCamera.forEach(e=>e.play()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch())}dispatchOut(){this.actions.Transition.forEach(e=>{e.toggle()})}},rte=class extends B9{constructor(e,t){super(e),this.eventManager=t,this.breakpoints=[],this.resize=(e,t)=>{this.breakpoints.forEach(i=>{let n,r=uV.deviceToSize(i.data.size),a="horizontal"===i.dataEvent.orientation?e:t;switch(i.data.operator){case"<":n=a<r[0];break;case">":n=a>r[0];break;case"<>":n=a>r[0]&&a<r[1]}i.stage!==n&&(i.stage=n,i.stage?i.dispatchIn():i.dispatchOut())})},this.onResizeObserver=new ResizeObserver(e=>{for(let t of e){let{width:e,height:i}=t.contentRect;this.resize(e,i)}})}connect(){let{page:e,sharedAssets:t,domElement:i}=this.eventContext;this.onResizeObserver.observe(i);let n=i=>{var n;if(i.visible&&null!==(n=i.data)&&void 0!==n&&n.events.length)for(let{data:r,id:a}of i.data.events)r.disabled||"Resize"===r.type&&r.breakpoints.forEach(n=>{let{data:o,id:s}=n;try{let n=new nte(a,s,o,r,i,e,t,this.eventManager);this.breakpoints.push(n)}catch(MV){}})};e.traverseEntity(e=>{var t;(e instanceof X3||e instanceof B3)&&null!==(t=e.frame)&&void 0!==t&&t.traverse(e=>{n(e)}),n(e)})}disconnect(){this.onResizeObserver.disconnect(),this.breakpoints.forEach(e=>{e.disconnect()}),this.breakpoints=[]}},ate=class extends B9{constructor(e,t){super(e),this.eventManager=t,this.userAPIs={},this.events=[],this.onSuccess=e=>{let{userAPIId:t}=e;this.events.forEach(e=>{e.data.userAPIId===t&&e.dispatchSuccess()})},this.onError=e=>{let{userAPIId:t}=e;this.events.forEach(e=>{e.data.userAPIId===t&&e.dispatchError()})},this.userAPIs=e.sharedAssets.getUserAPIs()}connect(){this.eventContext.page.traverseEntity(e=>{var t;null===(t=e.data)||void 0===t||t.events.filter(e=>"API"===e.data.type&&!e.data.disabled).forEach(t=>{this.events.push(new ote(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),Object.entries(this.userAPIs).forEach(e=>{let[t,i]=e;i.on("success",this.onSuccess),i.on("error",this.onError),i.autostart&&i.callUserAPI(this.eventContext.sharedAssets)})}disconnect(){Object.entries(this.userAPIs).forEach(e=>{let[t,i]=e;i.off("success",this.onSuccess),i.off("error",this.onError)})}},ote=class{constructor(e,t,i,n,r,a){this.id=e,this.data=t,this.object=i,this.successActions=B8(t,t.successActions,n,r,a,i),this.errorActions=B8(t,t.errorActions,n,r,a,i)}dispatchSuccess(){this.dispatchActions(this.successActions)}dispatchError(){this.dispatchActions(this.errorActions)}dispatchActions(e){e.Audio.forEach(e=>e.dispatchConditional()),e.Particles.forEach(e=>e.dispatchConditional()),e.Video.forEach(e=>e.dispatchConditional()),e.Create.forEach(e=>e.dispatch()),e.Destroy.forEach(e=>e.dispatch()),e.Reset.forEach(e=>e.dispatch()),e.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()}),e.Transition.forEach(e=>e.play()),e.Animation.forEach(e=>e.play()),e.SwitchCamera.forEach(e=>e.play()),e.SceneTransition.forEach(e=>e.dispatch()),e.SetVariable.forEach(e=>e.checkConditions()),e.SetVariable.forEach(e=>e.dispatch()),e.DynamicVariablePlay.forEach(e=>e.dispatch()),e.ClearLocalStorage.forEach(e=>e.dispatch()),e.UserAPI.forEach(e=>e.dispatch())}},ste=class extends B9{constructor(e,t){super(e),this.eventManager=t,this.userWebhooks={},this.events=[],this.onMessage=e=>{let{userWebhookId:t}=e;this.events.forEach(e=>{e.data.userWebhookId===t&&e.dispatch()})},this.userWebhooks=e.sharedAssets.getUserWebhooks()}connect(){this.eventContext.page.traverseEntity(e=>{var t;null===(t=e.data)||void 0===t||t.events.filter(e=>"WEBHOOK"===e.data.type&&!e.data.disabled).forEach(t=>{this.events.push(new lte(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),Object.entries(this.userWebhooks).forEach(e=>{let[t,i]=e;i.connect(),i.on("message",this.onMessage)})}disconnect(){Object.entries(this.userWebhooks).forEach(e=>{let[t,i]=e;i.off("message",this.onMessage),i.disconnect()})}},lte=class{constructor(e,t,i,n,r,a){this.id=e,this.data=t,this.object=i,this.actions=B8(t,t.actions,n,r,a,i)}dispatch(){let e=this.actions;e.Audio.forEach(e=>e.dispatchConditional()),e.Particles.forEach(e=>e.dispatchConditional()),e.Video.forEach(e=>e.dispatchConditional()),e.Create.forEach(e=>e.dispatch()),e.Destroy.forEach(e=>e.dispatch()),e.Reset.forEach(e=>e.dispatch()),e.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()}),e.Transition.forEach(e=>e.play()),e.Animation.forEach(e=>e.play()),e.SwitchCamera.forEach(e=>e.play()),e.SceneTransition.forEach(e=>e.dispatch()),e.SetVariable.forEach(e=>e.checkConditions()),e.SetVariable.forEach(e=>e.dispatch()),e.DynamicVariablePlay.forEach(e=>e.dispatch()),e.ClearLocalStorage.forEach(e=>e.dispatch()),e.UserAPI.forEach(e=>e.dispatch())}};var cte=new j_(0,0,1),dte=new j_,ute=new j_,hte=new f_,pte=class{constructor(e,t,i,n,r){this.containerScene=e,this.raycaster=t,this.sharedAssets=i,this.requestRender=n,this.onExit=r,this.htmlInput=null,this.virtualInput=null,this.helper=new M2,this.doubleClickHandler=new ite,this.isDragging=!1,this.plane=new YE,this.caretInterval=0,this.planeIntersection=new j_,this.projected=new p_,this._lastIndex=0,this._isFirstDragMove=!1,this.selectionOnDragStart=0,this.onTextMaterialChanged=()=>{var e;let t=null===(e=this.virtualInput)||void 0===e?void 0:e.data;if(void 0!==this.virtualInput&&t){let e=t.material,i=function(e,t){let i=AV.fromHex(3223857),n=.8;for(let r of e.layers){if("light"===r.data.type||"displace"===r.data.type||"fresnel"===r.data.type||"matcap"===r.data.type||"texture"===r.data.type||"toon"===r.data.type||"outline"===r.data.type||"transmission"===r.data.type||"noise"===r.data.type)continue;let e="string"==typeof r.data.alpha?Number(t.getVariable(r.data.alpha)):r.data.alpha;if("color"===r.data.type&&e>.3){i=D2(r.data.color,t),n=e;break}if(("depth"===r.data.type||"gradient"===r.data.type)&&e>.3){let e=O2(r.data);i={r:e[0],g:e[1],b:e[2]},n="string"==typeof r.data.alpha?1:r.data.alpha;break}}return c(c({},i),{},{a:n})}("string"==typeof e?this.sharedAssets.data.materials[e]:e,this.sharedAssets);this.helper.setCaretColor(i)}},this.stopAnimateTextCursor=()=>{clearInterval(this.caretInterval),this.helper&&(this.helper.caretMesh.visible=!1)},this.startAnimateTextCursor=()=>{this.stopAnimateTextCursor(),this.helper&&(this.helper.caretMesh.visible=!0,this.caretInterval=setInterval(()=>{this.helper&&(this.helper.caretMesh.visible=!this.helper.caretMesh.visible),this.requestRender()},600))},this.handleCaretUpdate=e=>{if(!this.htmlInput||!this.virtualInput)return;let t=this.helper,i="ArrowLeft"===(null===e||void 0===e?void 0:e.key)||"ArrowRight"===(null===e||void 0===e?void 0:e.key),n="ArrowUp"===(null===e||void 0===e?void 0:e.key)||"ArrowDown"===(null===e||void 0===e?void 0:e.key);this.htmlInput.selectionStart===this.htmlInput.selectionEnd?(t.setCaretPosition(this.htmlInput.selectionStart,{horizontalKeyMove:i,verticalKeyMove:n}),this.startAnimateTextCursor()):t.setSelection(this.htmlInput.selectionStart,this.htmlInput.selectionEnd),this.requestRender()},this.containerScene.add(this.helper)}createInput(){return this.htmlInput=function(){let e=document.createElement("textarea");return e.style.position="fixed",e.style.top="200px",e.style.left="400px",e.style.zIndex="-1",e.style.border="1px solid rgba(255,0,0,0.5)",e.style.width="10px",e.style.height="500px",e.style.color="white",e.style.opacity="0.5",e.style.background="transparent",e.style.display="none",e.style.margin="0px",e.style.padding="0px",e.style.boxSizing="content-box",e.style.pointerEvents="none",e}(),this.htmlInput}connect(){}disconnect(){var e;this.stopAnimateTextCursor(),this.helper.hide(),null!==(e=this.htmlInput)&&void 0!==e&&e.remove(),this.doubleClickHandler.stop()}handleMouseDown(){var e,t;if(!this.htmlInput||!this.virtualInput)return!0;this.getPointOnPlane();let i=this.doubleClickHandler.clickCount,{index:n,lineIndex:r,characterIndex:a}=null!==(e=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,i>1?"inside":"previous"))&&void 0!==e?e:{index:0,lineIndex:0,characterIndex:0};null!==(t=this.virtualInput)&&void 0!==t&&null!==(t=t.wrappedText)&&void 0!==t&&t.length&&"\n"===this.virtualInput.wrappedText[r][Math.max(0,a-1)]&&(n--,a--),this._lastIndex=n,this._isFirstDragMove=!0;let o=this.checkClickedObject();if(1===i){if(null===o)return this.onExit(this.virtualInput),!0;this.selectionOnDragStart=n,this.isDragging=!0,this.setInputSelection(n)}else o===this.virtualInput&&(2===i?this.selectClosestWord(r,a):i>2&&(this.setInputSelection(0,this.htmlInput.value.length),this.doubleClickHandler.reset()))}handleMouseUp(){this.applyRangeToTextInput(),this.isDragging=!1,this._isFirstDragMove=!1}handleMouseMove(){!this.virtualInput||(this._isFirstDragMove&&this.doubleClickHandler.clickCount>1&&(this.selectionOnDragStart=this._lastIndex,this.isDragging=!0,this.setInputSelection(this._lastIndex)),this._isFirstDragMove=!1,this.getPointOnPlane(),this.applyRangeToTextInput())}focus(e){if(this.virtualInput=e,this.updateTextInputStyles(),this.htmlInput)if(e){var t,i;let e=null===(t=this.data)||void 0===t?void 0:t.geometry.text;this.htmlInput.value="string"==typeof e?"":null!==(i=null===e||void 0===e?void 0:e.textValue.toString())&&void 0!==i?i:""}else this.htmlInput.value=""}blur(){}get data(){let{virtualInput:e}=this;if(e)return e.dataPatched}applyRangeToTextInput(){var e,t;if(!this.isDragging||!this.virtualInput||!this.htmlInput)return;let i=this.selectionOnDragStart,{index:n,lineIndex:r,characterIndex:a}=null!==(e=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,this.doubleClickHandler.clickCount>2?"inside":"previous"))&&void 0!==e?e:{index:0};void 0!==r&&void 0!==a&&"\n"===(null===(t=this.virtualInput)||void 0===t?void 0:t.wrappedText[r][a-1])&&n--,this.htmlInput.setSelectionRange(Math.min(i,n),Math.max(i,n))}checkClickedObject(){if(this.virtualInput){let e=this.raycaster.intersectObject(this.virtualInput,!1);if(e.length>0){let t=e[0];if(t.object instanceof V3)return t.object}}return null}selectClosestWord(e,t){if(!this.virtualInput)return;let i=this.virtualInput.wrappedText,n=i[e],r=t+1,a=t;" "!==n[t]&&(r=this.findNextCharOccurence(n,t,"forward"," "),a=this.findNextCharOccurence(n,t,"backward"," "),a>0&&a++,r>=n.length-1&&e===i.length-1&&r++);let o=this.helper,s=o.getGlobalIndexFromLineAndCharIndexes(i,e,a),l=o.getGlobalIndexFromLineAndCharIndexes(i,e,r);this.setInputSelection(s,l)}findNextCharOccurence(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ",r=Math.max(0,e.length-1),a="forward"===i?r:0,o="forward"===i?1:-1,s=Math.max(Math.min(t,r),0);for(;s!==a;)if(s+=o,e.charAt(s)===n)return s;return a}getPointOnPlane(){var e;let t=null===(e=this.virtualInput)||void 0===e?void 0:e.data;if(this.virtualInput&&t&&this.raycaster.ray.intersectsPlane(this.plane)){null===this.planeIntersection&&(this.planeIntersection=new j_);let e=this.raycaster.ray.intersectPlane(this.plane,this.planeIntersection);if(e){this.planeIntersection.copy(this.virtualInput.worldToLocal(e));let i="number"==typeof t.geometry.width?t.geometry.width:1,n="number"==typeof t.geometry.height?t.geometry.height:1;this.projected.set(e.x+.5*i,e.y-.5*n)}}}updatePlane(){var e;let t=null===(e=this.virtualInput)||void 0===e?void 0:e.data;this.virtualInput&&t&&(hte.getNormalMatrix(this.virtualInput.matrixWorld),dte.copy(cte).applyMatrix3(hte).normalize(),this.virtualInput.localToWorld(ute.set(0,0,t.geometry.depth)),this.plane.setFromNormalAndCoplanarPoint(dte,ute))}setInputSelection(e){var t,i;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;null!==(t=this.htmlInput)&&void 0!==t&&t.setSelectionRange(e,n),rN&&null!==(i=this.htmlInput)&&void 0!==i&&i.focus(),setTimeout(()=>{var e;null===(e=this.htmlInput)||void 0===e||e.focus()})}updateTextInputStyles(){var e;let t=null===(e=this.virtualInput)||void 0===e?void 0:e.data;this.virtualInput&&t&&this.htmlInput&&(this.htmlInput.style.fontSize=t.geometry.fontSize+"px",this.htmlInput.style.letterSpacing=t.geometry.letterSpacing*t.geometry.fontSize+"px",this.htmlInput.style.lineHeight=t.geometry.fontSize*t.geometry.lineHeight+"px",this.htmlInput.style.width=t.geometry.width+"px",this.htmlInput.style.height=t.geometry.height+"px",this.htmlInput.style.textAlign=function(e){return 4===e?"justify":2===e?"right":3===e?"center":"left"}(t.geometry.horizontalAlign))}};var fte=(e,t)=>{if("string"==typeof e){let i=t.data(e);if(i)return fte(i.value,t)}return eW.getDisplayedValue(e)};function mte(e,t){let i=e.text,n="";if("string"==typeof i){let e=t.variables.data(n);e&&(n=fte(e.value,t.variables))}else n=i.textValue.toString();return n}var gte=class extends B9{constructor(e,t){super(e),this.eventManager=t,this._textInputs=[],this.sceneHelpers=new OT,this.helper=new M2,this._onMouseDownFocusIn=e=>{if(hN.length>1)return;this.eventContext.updateRaycaster(e);let t=null;if(this.eventContext.raycaster)for(let i of this._textInputs)if(this.eventContext.raycaster.intersectObject(i,!0).length>0){t=i;break}this.focusOnTextInput(t),this._onCaretUpdate(),this._onMouseUp(),this.textInputManager.doubleClickHandler.start(this.eventContext.domElement),this.textInputManager.doubleClickHandler._onMouseDown(e),this._onMouseDown(e)},this.onExit=()=>{let{virtualInput:e}=this.textInputManager;if(null===e)return;let t=this.textInputManager.htmlInput;this.helper.hide(),null!==t&&void 0!==t&&t.setSelectionRange(t.value.length,t.value.length),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0);let{domElement:i}=this.eventContext;i.removeEventListener("pointerdown",this._onMouseDown,!1),i.removeEventListener("pointerup",this._onMouseUp,!1),i.removeEventListener("pointermove",this._onMouseMove,!1),window.removeEventListener("keydown",this._onKeyPress),this.textInputManager.doubleClickHandler.reset(),i.addEventListener("pointerdown",this._onMouseDownFocusIn),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers()},this._onMouseDown=e=>{this.eventContext.updateRaycaster(e),this.textInputManager.handleMouseDown(),this.textInputManager.virtualInput&&this.eventContext.raycaster.intersectObject(this.textInputManager.virtualInput,!0).length>0&&this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1)},this._onMouseUp=()=>{this.textInputManager.handleMouseUp(),this.eventManager.controlsManager.orbitControls&&!this.eventManager.controlsManager.orbitControls.enabled&&(this.eventManager.controlsManager.orbitControls.enabled=!0)},this._onMouseMove=e=>{this.eventContext.updateRaycaster(e),this.textInputManager.handleMouseMove()},this._onTextEdit=e=>{let{htmlInput:t,virtualInput:i,helper:n}=this.textInputManager;if(!t||!i)return;let r=t.value;i.textGeometry.setText(r,this.eventContext.sharedAssets).then(()=>{this.eventContext.requestRender()});let a=i.data;n.update();let o=a.geometry.text;if("string"==typeof o){let e=o;this.eventContext.sharedAssets.updateVariable(e,{textValue:r})}this.textInputManager.updateTextInputStyles(),this._onCaretUpdate()},this._onCaretUpdate=e=>{this.textInputManager.handleCaretUpdate(e)},this._onKeyPress=e=>{"Escape"===e.key&&this.onExit()},this.textInputManager=new pte(this.sceneHelpers,e.raycaster,e.sharedAssets,e.requestRender,this.onExit)}connect(){let e=[];if(this.eventContext.scene.traverseEntity(t=>{t instanceof V3&&e.push(t)}),this._textInputs=e,0===e.length)return;let{domElement:t}=this.eventContext;t.addEventListener("pointerdown",this._onMouseDownFocusIn),this.textInputManager.connect();let i=this.textInputManager.createInput();document.body.appendChild(i),i.style.display="none",i.addEventListener("keyup",this._onCaretUpdate),i.addEventListener("keydown",this._onCaretUpdate),i.addEventListener("beforeinput",this._onCaretUpdate),i.addEventListener("paste",this._onCaretUpdate),i.addEventListener("cut",this._onCaretUpdate),i.addEventListener("select",this._onCaretUpdate),i.addEventListener("selectstart",this._onCaretUpdate)}disconnect(){let e=this.textInputManager.htmlInput,{domElement:t,sharedAssets:i}=this.eventContext;t.removeEventListener("pointerdown",this._onMouseDownFocusIn),null!==e&&void 0!==e&&e.removeEventListener("keyup",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("keydown",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("beforeinput",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("paste",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("cut",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("select",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("selectstart",this._onCaretUpdate),this._textInputs.forEach(e=>{let t=mte(e.data.geometry,this.eventContext.sharedAssets.data);e.textGeometry.setText(t,i)}),t.removeEventListener("pointerdown",this._onMouseDown,!1),t.removeEventListener("pointerup",this._onMouseUp,!1),t.removeEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers(),this.textInputManager.disconnect()}focusOnTextInput(e){this.textInputManager.focus(e),this.textInputManager.onTextMaterialChanged();let t=this.textInputManager.htmlInput;if(!t||null===e)return;this.textInputManager.updateTextInputStyles(),this.eventContext.renderer.sceneHelpersOnTop=this.sceneHelpers,this.eventContext.renderer.pipeline.enableHelpers(),this.textInputManager.isDragging=!1;let i=mte(e.textGeometry.userData.parameters,this.eventContext.sharedAssets.data);t.value=i,t.setSelectionRange(0,0),this.textInputManager.helper.show(e),t.style.display="block",t.addEventListener("input",this._onTextEdit),this.textInputManager.updatePlane();let{domElement:n}=this.eventContext;n.removeEventListener("pointerdown",this._onMouseDownFocusIn),n.addEventListener("pointerdown",this._onMouseDown,!1),n.addEventListener("pointerup",this._onMouseUp,!1),n.addEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress)}},vte=class extends B9{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.onVoice=e=>{let{value:t,frequencies:i}=e;this.events.forEach(e=>{e.dispatch()})}}connect(){this.openAIRealtime=this.eventContext.sharedAssets.openAIRealtime,this.openAIRealtime&&(this.eventContext.page.traverseEntity(e=>{var t;null===(t=e.data)||void 0===t||t.events.filter(e=>"AIAssistantListener"===e.data.type&&!e.data.disabled).forEach(t=>{this.events.push(new yte(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.openAIRealtime.on("voice",this.onVoice))}disconnect(){var e;null===(e=this.openAIRealtime)||void 0===e||e.off("voice",this.onVoice)}},yte=class{constructor(e,t,i,n,r,a){this.id=e,this.data=t,this.object=i,this.actions=B8(t,t.actions,n,r,a,i)}dispatch(){this.dispatchActions(this.actions)}dispatchActions(e){e.Audio.forEach(e=>e.dispatchConditional()),e.Particles.forEach(e=>e.dispatchConditional()),e.Video.forEach(e=>e.dispatchConditional()),e.Create.forEach(e=>e.dispatch()),e.Destroy.forEach(e=>e.dispatch()),e.Reset.forEach(e=>e.dispatch()),e.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()}),e.Transition.forEach(e=>e.play()),e.Animation.forEach(e=>e.play()),e.SwitchCamera.forEach(e=>e.play()),e.SceneTransition.forEach(e=>e.dispatch()),e.SetVariable.forEach(e=>e.checkConditions()),e.SetVariable.forEach(e=>e.dispatch()),e.DynamicVariablePlay.forEach(e=>e.dispatch()),e.ClearLocalStorage.forEach(e=>e.dispatch()),e.UserAPI.forEach(e=>e.dispatch())}},bte=class extends B9{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.onTriggerEvent=e=>{let{description:t,direction:i}=e,n=this.events.find(e=>e.data.description===t);n&&("backward"===i?n.dispatchReverse():n.dispatch())}}connect(){this.openAIRealtime=this.eventContext.sharedAssets.openAIRealtime,this.openAIRealtime&&(this.eventContext.page.traverseEntity(e=>{var t;null===(t=e.data)||void 0===t||t.events.filter(e=>"AIAssistantTrigger"===e.data.type&&!e.data.disabled).forEach(t=>{this.events.push(new xte(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.openAIRealtime.on("trigger_event",this.onTriggerEvent))}disconnect(){var e;null===(e=this.openAIRealtime)||void 0===e||e.off("trigger_event",this.onTriggerEvent)}},xte=class{constructor(e,t,i,n,r,a){this.id=e,this.data=t,this.object=i,this.actions=B8(t,t.actions,n,r,a,i)}dispatch(){let e=this.actions;e.Audio.forEach(e=>e.dispatchConditional()),e.Particles.forEach(e=>e.dispatchConditional()),e.Video.forEach(e=>e.dispatchConditional()),e.Create.forEach(e=>e.dispatch()),e.Destroy.forEach(e=>e.dispatch()),e.Reset.forEach(e=>e.dispatch()),e.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()}),e.Transition.forEach(e=>e.play()),e.Animation.forEach(e=>e.play()),e.SwitchCamera.forEach(e=>e.play()),e.SceneTransition.forEach(e=>e.dispatch()),e.SetVariable.forEach(e=>e.checkConditions()),e.SetVariable.forEach(e=>e.dispatch()),e.DynamicVariablePlay.forEach(e=>e.dispatch()),e.ClearLocalStorage.forEach(e=>e.dispatch()),e.UserAPI.forEach(e=>e.dispatch())}dispatchReverse(){let e=this.actions;e.Transition.forEach(e=>e.reverseFromCurrent()),e.Particles.forEach(e=>e.reverseFromCurrent()),e.Animation.forEach(e=>e.reverseFromCurrent()),e.SwitchCamera.forEach(e=>e.reverseFromCurrent()),e.Create.forEach(e=>e.dispatchStop())}},wte=class{constructor(e,t,i,n,r){this.publish=e,this.controlsManager=t,this.animationControls=i,this.eventContext=n,this.sharedVariables=r,this.isEnabled=!1,this.activateCount=0,this.needsMouse=!1,this.needsRaycast=!1,this.onTouchMovePreventScroll=e=>{let t=window.parent!==window,i=document.documentElement.scrollHeight>document.documentElement.clientHeight||document.documentElement.scrollWidth>document.documentElement.clientWidth;(e.touches.length>1||this.preventTouchScroll||!1===t&&!1===i)&&e.preventDefault()},this.onMouseWheelPreventScroll=e=>{this.preventScroll&&e.preventDefault()},this.onMouseMove=e=>{this.eventContext.sharedAssets.mouseProperty=c(c({},this.getMousePosition(e)),{},{pressed:e.buttons>0})},this.onMouseDown=e=>{this.eventContext.sharedAssets.mouseProperty=c(c({},this.getMousePosition(e)),{},{pressed:!0})},this.onMouseUp=e=>{this.eventContext.sharedAssets.mouseProperty=c(c({},this.getMousePosition(e)),{},{pressed:!1})},this.getMousePosition=e=>{var t;let{domRect:i}=this.eventContext,{pageX:n,pageY:r}=(null===(t=e.touches)||void 0===t?void 0:t.length)>0?e.touches[0]:e;return{x:n-(i.left+window.scrollX),y:r-(i.top+window.scrollY)}},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=n.requestRender}activate(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEnabled)return;this.isEnabled=!0,this.initializeActionsDependentStates(),this.needsMouse&&(this.eventContext.domElement.addEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.addEventListener("pointerdown",this.onMouseDown)),this.handlers={Spline:new j9(this.eventContext),VariableChange:new Z7(this.eventContext,this.sharedVariables,this,this.needsMouse,this.needsRaycast),API:new ate(this.eventContext,this),WEBHOOK:new ste(this.eventContext,this),AIAssistantListener:new vte(this.eventContext,this),AIAssistantTrigger:new bte(this.eventContext,this),Conditional:new K9(this.eventContext,this),Start:new Q7(this.eventContext,this),Basic:new H9(this.eventContext,this,this.needsRaycast),MouseHover:new H7(this.eventContext,this),Scroll:new X7(this.eventContext,this),Follow:new C7(this.eventContext,this),DragDrop:new f7(this.eventContext,this),LookAt:new F7(this.eventContext),Resize:new rte(this.eventContext,this),Textfields:new gte(this.eventContext,this)};let{page:i,domElement:n}=this.eventContext;this.hideCursor&&(n.style.cursor="none"),i.traverseEntity(e=>{e.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(e=>e.connect()),n.addEventListener("wheel",this.onMouseWheelPreventScroll),n.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++,t||null===(e=this.eventContext.sharedAssets.openAIRealtime)||void 0===e||e.connect()}deactivate(){var e,t;let i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isEnabled)return;this.isEnabled=!1,this.eventContext.domElement.removeEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.removeEventListener("pointerdown",this.onMouseDown),this.eventContext.domElement.removeEventListener("pointerup",this.onMouseUp),this.eventContext.sharedAssets.mouseProperty=null,this.eventContext.sharedAssets.raycastProperty=null;let{page:n,domElement:r}=this.eventContext;r.style.cursor="",Object.values(this.handlers).forEach(e=>e.disconnect()),null!==(e=this.controlsManager.gameControl)&&void 0!==e&&e.disposeActions(),this.controlsManager.disconnectEvents(),n.traverseEntity(e=>{e.removeEventListener("requestRender",this.requestRender),e.destroyedInAction=!1}),r.removeEventListener("touchmove",this.onTouchMovePreventScroll),r.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode(),i||null===(t=this.eventContext.sharedAssets.openAIRealtime)||void 0===t||t.disconnect()}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(!0),this.activate(!0),this.controlsManager.deactivate(),this.controlsManager.activate(this),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(e){let t=this.isEnabled;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}initializeActionsDependentStates(){let e=this.eventContext.sharedAssets;e.resetDynamicVariablePlayState();let t=i=>{if("Conditional"===i.data.type&&(i.data.ifActions.forEach(t),i.data.elseActions.forEach(t)),"Conditional"===i.data.type||"SetVariable"===i.data.type)for(let e of"Conditional"===i.data.type?i.data.condition:i.data.expression)"id"in e&&Array.isArray(e.id)&&("mouse"===e.id[0]&&(this.needsMouse=!0),"raycast"===e.id[0]&&(this.needsRaycast=!0));"DynamicVariablePlay"===i.data.type&&""!==i.data.variableId&&("Play"===i.data.mode||"PlayPause"===i.data.mode||"Toggle"===i.data.mode)&&e.setDynamicVariablePlayState(i.data.variableId,"Stopped")};this.eventContext.page.traverseEntity(e=>{var i;if(null!==(i=e.data)&&void 0!==i&&i.events.length)for(let n of e.data.events)if("VariableChange"===n.data.type&&("mouseProperty"===n.data.variableId&&(this.needsMouse=!0),"raycastProperty"===n.data.variableId&&(this.needsRaycast=!0)),"Conditional"===n.data.type)for(let e of["inActions","outActions"])n.data[e].forEach(t);else if("DragDrop"===n.data.type)for(let e of["drag","drop"])n.data.dragDropActions[e].forEach(t);else if("GameControl"===n.data.type)for(let e of["idle","move","jump","run"])n.data.gameActions[e].forEach(t);else if("Resize"===n.data.type)for(let e of n.data.breakpoints)e.data.actions.forEach(t);else"LookAt"===n.data.type||"API"===n.data.type||n.data.actions.forEach(t)})}},Ste=class{constructor(e,t,i,n,r){this._aspect=1,this.enableResponsive=!1,this._renderer=e,this._camera=t,this._frameSize=(new p_).copy(i),this._editorSize=(new p_).copy(n),this._aspect=t.aspect,this._fov=null!==r&&void 0!==r?r:t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||"PerspectiveCamera"!==this._camera.cameraType)return;let e=this._frameSize.x,t=this._frameSize.y,i=this._editorSize.y;this._aspect=e/t,t<=i&&(this._camera.zoom*=i/t),this._renderer.setViewport(0,0,e,t)}updateCamera(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this._camera)if("PerspectiveCamera"===this._camera.cameraType){let t=this._frameSize.y,i=this._editorSize.y,n=this._fov;if(e&&t>i){let e=function(e,t,i,n,r){return(e-t)/(i-t)*(r-n)+n}(t,1080,2160,1,15)/100;n*=t/i,n*=1-e}this._camera.aspect=this._aspect,this._camera.fov=n,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t,this.enableResponsive),this._camera.updateProjectionMatrix())}};var _te=class{get sharedAssets(){return this.shared}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.shared=new ZJ(e.shared,t,!0,i),this.scene=new K4(e.scene,this.sharedAssets),this.shared.setEntityOpContext({scene:this.scene,shared:this.shared})}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let e of this.scene.children)e instanceof B3&&!e.uiScene&&e.personalCamera.updateState(e.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(e=>{e instanceof r$&&e.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},Cte=class{constructor(e){let{x:t=10,y:i=10}=e;this._startTime=0;let n=document.getElementById("spe-perfs");n?this.element=n:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left="".concat(t,"px"),this.element.style.top="".concat(i,"px")}dispose(){var e;null===(e=this.element.parentElement)||void 0===e||e.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function Ete(e){let t;if(e.index)for(let i=0;i<e.index.array.length;i+=3)t=e.index.array[i],e.index.array[i]=e.index.array[i+2],e.index.array[i+2]=t}function Ate(e){return e instanceof d$?"SubdivObject":"NonParametricGeometry"===e.geometry.type?"NonParametric":"Mesh"}function Mte(e,t){let i=function(e,t){let i={};return e.traverseEntity(e=>{if(!e.visible||!(e instanceof CQ)||"Mesh"!==e.type||Array.isArray(e.material)||e.states&&Object.keys(e.states).length)return;let n=e.parent;for(;n;){if(n instanceof CQ&&e.states&&Object.keys(e.states).length)return;n=n.parent}let r=e.material.uuid,a=t.shared.materials[r];if(a){if(!lj.isMergable(a))return}else{var o;let i=null===(o=t.scene.objects.get(e.uuid))||void 0===o?void 0:o.data;if(i&&"material"in i&&"string"!=typeof i.material){if(!lj.isMergable(i.material))return;r=lj.getHash(i.material)}}i[r]||(i[r]={});let s=i[r][Ate(e)];if(s){if(s.push(e),e.cloner)for(let t of e.cloner.children)s.push(t)}else if(i[r][Ate(e)]=[e],e.cloner)for(let t of e.cloner.children)i[r][Ate(e)].push(t)}),i}(t,e),n=function(e){let t=0;return Object.values(e).forEach(e=>{Object.values(e).forEach(e=>{let i=e.length;i>t&&(t=i)})}),t}(i),r=new Array(n),a=0,o=new Array(n),s=0,l=new Array(n),c=0,d=new Array(n),u=0;for(let[h,p]of Object.entries(i))for(let e of Object.values(p)){if(s=0,c=0,e.forEach(e=>{e instanceof CQ&&(o[s++]=e.geometry.clone(),l[c++]=e)}),c<2)continue;for(let e=0;e<c;e++)l[e].updateWorldMatrix(!0,!1),o[e].applyMatrix4(l[e].matrixWorld),l[e].matrixWorld.determinant()<0&&Ete(o[e]);let n=KW(o.slice(0,s),!1);if(n){let e;if("SubdivObject"===h)console.warn("Turning subdiv object into mesh"),e=new OE(n,l[0].material);else e=new OE(n,l[0].material);e.castShadow=l[0].castShadow,e.receiveShadow=l[0].receiveShadow,t.add(e);let o=e=>{u=0;for(let t of e)t.children&&o(t.children),t instanceof CQ&&(Array.isArray(t.material)||i[t.material.uuid]&&i[t.material.uuid][Ate(t)]&&i[t.material.uuid][Ate(t)].length>1||(d[u++]=t));for(let i=0;i<u;i++)t.attach(d[i])};for(let t=0;t<c;t++){let e=l[t];o(e.children),r[a++]=e}}}for(let h=0;h<a;h++)r[h].removeFromParent()}var Tte=Ow(Fw(),1),Pte=new p_;function Dte(e){let t=new kQ(0,0,0,1);try{t.setStyle(e)}catch(VU){console.error(VU)}finally{return t}}var Ote=class{constructor(e){let{renderOnDemand:t,renderMode:i="auto",wasmPath:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._variablesCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=e=>{var t,i,n,r,a,o,s,l,c,d,u,h,p;if(this.time=e,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,null!==(t=this._perfs)&&void 0!==t&&t.start(),this._renderer)if(this._isPaused||!("manual"===this.renderMode&&!this._renderRequested||"auto"===this.renderMode&&this._skipRender)){if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=null!==(i=this._controls.update(this.dt))&&void 0!==i&&i),this._eventManager&&(null!==(n=this._eventManager.handlers)&&void 0!==n&&n.Start.hasVideoAction||null!==(r=this._eventManager.handlers)&&void 0!==r&&r.Basic.hasVideoAction||null!==(a=this._eventManager.handlers)&&void 0!==a&&a.Conditional.hasVideoAction)&&(this._skipRender=!1),null!==(o=this._animationControls)&&void 0!==o&&o.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,null!==(s=this._scene)&&void 0!==s&&s.traverseVisibleEntity(e=>{"ParticleSystem"===e.type&&(e.update(this.dt),this._skipRender=!1)}),this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),null!==(l=this._eventManager)&&void 0!==l&&l.isEnabled&&((null===(c=this._eventManager.handlers)||void 0===c?void 0:c.Follow).onAnimationFrameDamping(),(null===(d=this._eventManager.handlers)||void 0===d?void 0:d.LookAt).onAnimationFrameDamping(),(null===(u=this._eventManager.handlers)||void 0===u?void 0:u.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let e=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=e,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),null===(h=this._perfs)||void 0===h||h.end()}else{var f;null===(f=this._perfs)||void 0===f||f.end()}else null===(p=this._perfs)||void 0===p||p.end()},this._resize=e=>{if(this._renderer){var t,i,n,r,a,o,s,l;if(1===this._viewportMode&&this._frameView&&(this._frameView.frameSize=Pte.set(this._viewportWidth,this._viewportHeight)),e){let e=this._viewportWidth,t=this._viewportHeight;this._renderer.setSize(e-1,t-1,!1),this._renderer.setSize(e,t,!1)}else this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1);if(this._camera=null===(t=this._scene)||void 0===t?void 0:t.activeCamera,null!==(i=this._scene)&&void 0!==i&&i.updateViewPlaneSize(null!==(n=null===(r=this._frameView)||void 0===r||null===(r=r.frameSize)||void 0===r?void 0:r.x)&&void 0!==n?n:this._viewportWidth,null!==(a=null===(o=this._frameView)||void 0===o||null===(o=o.frameSize)||void 0===o?void 0:o.y)&&void 0!==a?a:this._viewportHeight,null!==(s=null===(l=this._frameView)||void 0===l?void 0:l.enableResponsive)&&void 0!==s&&s),this._camera){var c,d,u,h,p;let e=null!==(c=Object.values(null!==(d=null===(u=this._data)||void 0===u?void 0:u.frames)&&void 0!==d?d:{})[0].preset)&&void 0!==c?c:"fullscreen";null!==(h=this._frameView)&&void 0!==h&&h.setCamera(this._camera),null!==(p=this._frameView)&&void 0!==p&&p.updateCamera("fullscreen"!==e),"PerspectiveCamera"===this._camera.cameraType&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect()),this._requestRenderAutoMode()}},this._debouncedResize=zB(this._resize,10),this._onScroll=e=>{this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect())},this.canvas=e,this.renderMode=t?"auto":i,n&&(this._wasmPath=$B(n,"/")),this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new Cte({x:10,y:10})),function(e){e.addEventListener("pointerdown",gN,!0),e.addEventListener("pointerdown",yN,!0),e.addEventListener("pointermove",yN,!0),e.addEventListener("pointerup",vN,!0),e.addEventListener("pointercancel",vN,!0),e.addEventListener("pointerleave",vN,!0),window.addEventListener("keydown",xN,!0),window.addEventListener("keyup",wN,!0)}(e)}async load(e,t,i){(function(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?console.warn(t+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(t)})(e),this.disposed=!1;let n=await(await fetch(e,i)).arrayBuffer();await this.start(n,{variables:t})}async start(e){var t,i,n,r,a;let{interactive:o=!0,variables:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.disposed)return;let l=await async function(e,t){let[i,n]=vF(FU.deserialize(new Uint8Array(e)));return QW(i),t&&t(i),n.result().data}(e);this._data=l;let c=function(e){let t=[];return e.scene.objects.traverse((e,i)=>{"Mesh"===i.type&&"NonParametricGeometry"===i.geometry.type&&void 0!==i.geometry.data.draco&&t.push(i)}),t}(l);l.version&&(0,Tte.default)(l.version,"1.10.48")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),this._wasmPath&&this.setUIWasmUrl("".concat(this._wasmPath,"/ui.wasm")),await Promise.all([c.length&&ete(this._wasmPath),m0(l)&&sQ(this._wasmPath),c$(l)&&LY(this._wasmPath),Qj.physicsEnabled(l.scene.objects)&&PN(),P$(l)&&AJ(),F4(l)&&q4(),yJ(l)&&gJ(),i3(l)&&t3(),lee(l)&&EN(this._wasmPath)].filter(Boolean)),c.length&&await async function(e){for(let t of e){let e=await tte(t.geometry.data.draco);if(e){let i=t.geometry.data;e.index&&(i.index={array:e.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let n={};e.attributes.forEach(e=>{let{name:t,array:i,itemSize:r}=e;n[t]={array:i,itemSize:r,type:"Float32Array",normalized:!1}}),i.attributes=n,i.draco=void 0}}}(c),null!==(t=this._eventManager)&&void 0!==t&&t.deactivate(),null!==(i=this._controls)&&void 0!==i&&i.deactivate(),null===(n=this._scene)||void 0===n||n.dispose();let d=new _te(l);if(d.resetPersonalCameraFromDocumentData(),this._scene=d.scene,this._sharedAssetsManager=d.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let e=performance.now();Mte(l,d.scene);let t=performance.now();console.log("Merged geometries in ",t-e," ms")}m0(l)&&this._scene.traverse(e=>{x0(e)&&e.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var e;this._requestRenderAutoMode(),null===(e=this._scene)||void 0===e||e.traverse(e=>{e instanceof X$&&e.pendingMediaLoad&&e.update()})}),null===(r=this._scene)||void 0===r||r.traverse(e=>{"ParticleSystem"===e.type&&(e.wakeUp(),e.data.autoPlay?e.start():e.stop())});let u=Object.keys(l.shared.fonts).map(e=>this._sharedAssetsManager.getFont(e).loadingPromise);if(Promise.all(u).then(()=>{d.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),P$(l)&&function(e){if(Qj.physicsEnabled(e.scene.objects))return!0;let t=!1;return e.scene.objects.traverse((e,i)=>{if(i.events)if(Array.isArray(i.events)){for(let n of i.events)if(!0!==n.data.disabled&&"GameControl"===n.data.type&&n.data.collisionEnabled){t=!0;break}}else for(let n of Object.values(i.events))if(!0!==n.disabled&&"GameControl"===n.type&&n.collisionEnabled){t=!0;break}}),t}(l)&&await Promise.all(u),i3(l)){let e=[];this._scene.traverseEntity(t=>{(t instanceof X3||t instanceof B3)&&t.uiCanvas&&e.push(t.uiCanvas)}),await Promise.all(e.map(e=>e.promise))}if(this._scene.rewriteEventsBeforeGoToPlayMode(),m8(this._scene.activePage,this._sharedAssetsManager),!this._renderer){this._renderer=new S2({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=!0===l.scene.publish.hdTransmission;let e=()=>/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),t=this._getPixelRatio(e()?l.scene.publish.settings.web.pixelRatioMobile:l.scene.publish.settings.web.pixelRatioDesktop);if(this._renderer.setPixelRatio(t),this._renderer.pipeline.enableUIOverlay(),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode),l.shared.images.SplineWatermark){let e=this._sharedAssetsManager.getImage("SplineWatermark");await e.loadPromise;let t=e.getTexture(1001);this._renderer.pipeline.setWatermark(t)}}F4(l)&&this._scene.initializeSplatViewer(),void 0!==l.scene.blueNoiseTextureData&&this._renderer.pipeline.updateBlueNoiseTexture(l.scene.blueNoiseTextureData);let h=Object.values(l.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):("fullscreen"===h.preset?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=h.size[0],this._viewportHeight=h.size[1],this.canvas.style.width="".concat(this._viewportWidth,"px"),this.canvas.style.height="".concat(this._viewportHeight,"px")),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new Ste(this._renderer,this._camera,new p_(this._viewportWidth,this._viewportHeight),new p_(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=null!==(a=h.allowResponsive)&&void 0!==a&&a&&"fullscreen"===h.preset),o){let e=new L9(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0,h);this._scene.updateMatrixWorld(!0),this._controls=new qee(e),this._animationControls=new Kee(this._scene,this._requestRenderAutoMode),this._eventManager=new wte(l.scene.publish,this._controls,this._animationControls,e,l.shared.variables),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),this._scene.activePage.data.postprocessing.depthOfField.enabled&&Promise.all(this._sharedAssetsManager.getImageLoadPromises()).then(()=>{this._resize(!0)}),void 0!==s&&this.setVariables(s),0===this.dt&&(this.render(performance.now()),setTimeout(()=>{var e;null===(e=this._renderer)||void 0===e||e.setAnimationLoop(this.render)},0)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300),document.addEventListener("scroll",this._onScroll)}setVariables(e){if(void 0!==this._data){let t=Object.entries(e);for(let[e,i]of t)this.setVariable(e,i)}}setVariable(e,t){let i=this._getVariableByName(e);if(i&&!("dynamicVariableType"in i.data)){var n;let e=t;"number"==typeof i.data.value?e="number"==typeof t?t:"boolean"==typeof t?!0===t?1:0:parseFloat(t):"boolean"==typeof i.data.value?e="number"==typeof t?!!t:"boolean"==typeof t?t:"false"!==t.toLocaleLowerCase()&&!!t:"string"!=typeof i.data.value&&void 0!==i.data.value.textValue&&(e=t.toString());let r="string"==typeof e?{textValue:e}:e;null!==(n=this._sharedAssetsManager)&&void 0!==n&&n.updateVariable(i.id,r),this.requestRender(),this._requestRenderAutoMode()}else void 0===i?console.warn("No variable named ".concat(e," was found in your Spline file. Make sure to create it from Spline editor.")):"dynamicVariableType"in i.data&&console.warn("Dynamic variables like ".concat(e," cannot be updated from code."))}getVariables(){let e={};return this._data&&this._data.shared.variables.forEach(t=>{void 0===e[t.data.name]&&(e[t.data.name]=this._getVariableValue(this._sharedAssetsManager.getVariable(t.id)))}),e}getVariable(e){let t=this._getVariableByName(e);if(t){let e=this._sharedAssetsManager.getVariable(t.id);return this._getVariableValue(e)}}_getVariableValue(e){return"string"!=typeof e&&eW.isTextValue(e)?eW.getDisplayedValue(e):e}_getVariableByName(e){if(this._data){if(this._variablesCache.has(e))return this._variablesCache.get(e);let t=this._data.shared.variables.find(t=>t.data.name===e);return t&&this._variablesCache.set(e,t),t}}_getPixelRatio(e){switch(e){case 0:return window.devicePixelRatio;case 1:return 1;case 2:return 2}}findObjectById(e){var t;let i=null===(t=this._scene)||void 0===t?void 0:t.getObjectByProperty("uuid",e);return this._createProxyObject(i)}findObjectByName(e){var t;let i=null===(t=this._scene)||void 0===t?void 0:t.getObjectByName(e);return this._createProxyObject(i)}getAllObjects(){var e;let t=[];return null!==(e=this._scene)&&void 0!==e&&e.traverseEntity(e=>{if(e.uuid!==OV&&!this._scene.isInvisibleObjects(e)&&!(e instanceof B3)){let i=this._createProxyObject(e);i&&t.push(i)}}),t}getSplineEvents(){var e;return(null===(e=this._eventManager)||void 0===e||null===(e=e.handlers)||void 0===e?void 0:e.Spline).splineEvents}emitEvent(e,t){var i;null===(i=this.findObjectById(t)||this.findObjectByName(t))||void 0===i||i.emitEvent(e)}emitEventReverse(e,t){var i;null===(i=this.findObjectById(t)||this.findObjectByName(t))||void 0===i||i.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){var t,i;(null===(t=this._controls)||void 0===t?void 0:t.orbitControls)instanceof Cee&&(null===(i=this._controls)||void 0===i||i.orbitControls.setZoom(e))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){var t;let i=Dte(e);null!==(t=this._scene)&&void 0!==t&&t.activePage.setBackgroundColor(i),this._requestRenderAutoMode()}dispose(){var e,t,i,n,r,a,o;this.disposed=!0,null!==(e=this._eventManager)&&void 0!==e&&e.deactivate(),null!==(t=this._scene)&&void 0!==t&&t.dispose(),null!==(i=this._sharedAssetsManager)&&void 0!==i&&i.dispose(),this._proxyObjectCache.forEach(e=>{EI.unsubscribe(e)}),this._variablesCache.clear(),null!==(n=this._renderer)&&void 0!==n&&n.setAnimationLoop(null),null!==(r=this._renderer)&&void 0!==r&&r.dispose(),this._renderer=void 0,null!==(a=this._sharedAssetsManager)&&void 0!==a&&a.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),void 0!==this._resizeObserverTimeout&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),null!==(o=this._controls)&&void 0!==o&&o.deactivate(),this.dt=0,function(e){e.removeEventListener("pointerdown",gN,!0),e.removeEventListener("pointerdown",yN,!0),e.removeEventListener("pointermove",yN,!0),e.removeEventListener("pointerup",vN,!0),e.removeEventListener("pointercancel",vN,!0),e.removeEventListener("pointerleave",vN,!0),window.removeEventListener("keydown",xN,!0),window.removeEventListener("keyup",wN,!0)}(this.canvas),document.removeEventListener("scroll",this._onScroll)}get isStopped(){return this._isPaused}stop(){var e,t,i;this._isPaused||(null!==(e=this._renderer)&&void 0!==e&&e.setAnimationLoop(null),this._isPaused=!0,null!==(t=this._eventManager)&&void 0!==t&&t.pause(),(null===(i=this._controls)||void 0===i?void 0:i.orbitControls)&&(this._controls.orbitControls.enabled=!1))}play(){var e,t,i;!this._isPaused||(this._isPaused=!1,null!==(e=this._eventManager)&&void 0!==e&&e.resume(),null!==(t=this._controls)&&void 0!==t&&t.orbitControls&&(this._controls.orbitControls.enabled=!0),null===(i=this._renderer)||void 0===i||i.setAnimationLoop(this.render))}setGlobalEvents(e){var t;null===(t=this._eventManager)||void 0===t||t.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){var t;if(!this._scene||null==e)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let i;e.traverseAncestors(e=>{e instanceof B3&&(i=e.name)});let n=this._sharedAssetsManager,a={shared:n,scene:this._scene},o=t=>{if(null===t||"Base State"===t)return null;if(t&&e.data.states){let i=e.data.states.find(e=>e.data.name===t);return i?i.id:void 0}},s={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,type:e.data.type,page:i,parentUuid:e.parent instanceof B3||e instanceof K4||null===(t=e.parent)||void 0===t?void 0:t.uuid,emitEvent(t){e.dispatchEvent({type:"userEvent",eventName:t})},emitEventReverse(t){e.dispatchEvent({type:"userEvent",eventName:t,reverse:!0})},hide(){e.visible&&(e.visible=!1,a.shared.requestRender())},show(){e.visible||(e.visible=!0,a.shared.requestRender())},get state(){var t;let i=e.stateSelection;if(null!==i)return null===(t=e.data.states.find(e=>{let{id:t}=e;return t===i}))||void 0===t?void 0:t.data.name},set state(t){let i;if(void 0!==t){let n="string"==typeof t?e.data.states.find(e=>{let{id:i}=e;return i===t}):e.data.states[t];if(n)i=n.id;else{let e="string"==typeof t?o(t):void 0;e&&(i=e)}}e.changeSelectedState(null!==i&&void 0!==i?i:null,a),e.currentState=null!==i&&void 0!==i?i:null,e.dispatchEvent({type:"completeState",state:null!==i&&void 0!==i?i:null}),a.shared.requestRender()},transition(t){var i;let a,s=this,l=F6.timeline({autoplay:null===(i=t.autoPlay)||void 0===i||i}),d={transition(t){let{from:i,to:d,duration:u,delay:h}=t,p=r(t,_w),f=o(i);void 0===f&&(f=a);let m=o(d);a=m;let g=new S8(e,f,m,c(c({state:m,repeat:0,delay:null!==h&&void 0!==h?h:0,delayDirection:"start-once",direction:"normal",duration:null!==u&&void 0!==u?u:1e3},p),6===p.easing?RV.defaultData:5===p.easing?zV.defaultData:{}),n,!1);return l.add(c(c({},g.params),{},{begin:()=>{(i&&f||"Base State"===i&&!f)&&(s.state=null!==f&&void 0!==f?f:void 0)},complete:()=>{s.state=null!==m&&void 0!==m?m:void 0}}),l.duration),this},play(){return l.play(),this},pause(){return l.pause(),this},reset(){return l.reset(),this},seek(e){return l.seek(e),this}};return d.transition(t),d},set color(t){var i;let n=Dte(t);if(g0.is(e))return void(e.color=n);if("Mesh"!==e.type||!("material"in e)||!(e instanceof JJ))return;let r={r:n.r,g:n.g,b:n.b,a:n.a},o=Array.isArray(e.material)?e.material[0]:e.material,s=null===(i=o.data.layers.find(e=>"color"===e.data.type))||void 0===i?void 0:i.id;s&&o.updateByOp({type:0,path:["layers",s],props:{color:c({},r)}},o.data,a)}},l=EI(s,(t,i)=>{var n;"object"!=typeof e[t]&&null!==(n=Object.getOwnPropertyDescriptor(e,t))&&void 0!==n&&n.writable&&(e[t]=i),this._requestRenderAutoMode(),e.updateMatrix()});return this._proxyObjectCache.set(e.uuid,l),l}setUIWasmUrl(e){oZ.skiaWasmUrl=e}pauseGameControls(){var e;null===(e=this._eventManager)||void 0===e||null===(e=e.controlsManager.gameControl)||void 0===e||e.pause()}resumeGameControls(){var e;null===(e=this._eventManager)||void 0===e||null===(e=e.controlsManager.gameControl)||void 0===e||e.resume()}},Ite=i(446);function kte(e){return t=>{e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}}const Rte=["className","children","debounceTime","ignoreDimensions","parentSizeStyles","enableDebounceLeadingCall","resizeObserverPolyfill"],zte=[],Lte={width:"100%",height:"100%"},Bte=(0,e.forwardRef)(function(t,i){let{className:n,children:a,debounceTime:o=300,ignoreDimensions:s=zte,parentSizeStyles:l,enableDebounceLeadingCall:d=!0,resizeObserverPolyfill:u}=t,h=r(t,Rte);const p=(0,e.useRef)(null),f=(0,e.useRef)(0),[m,g]=(0,e.useState)({width:0,height:0,top:0,left:0}),v=(0,e.useMemo)(()=>{const e=Array.isArray(s)?s:[s];return Ite(t=>{g(i=>Object.keys(i).filter(e=>i[e]!==t[e]).every(t=>e.includes(t))?i:t)},o,{leading:d})},[o,d,s]);return(0,e.useEffect)(()=>{const e=new(u||window.ResizeObserver)(e=>{e.forEach(e=>{var t;const{left:i,top:n,width:r,height:a}=null!==(t=null==e?void 0:e.contentRect)&&void 0!==t?t:{};f.current=window.requestAnimationFrame(()=>{v({width:r,height:a,top:n,left:i})})})});return p.current&&e.observe(p.current),()=>{window.cancelAnimationFrame(f.current),e.disconnect(),v.cancel()}},[v,u]),(0,_t.jsx)("div",c(c({style:c(c({},Lte),l),ref:kte([i,p]),className:n},h),{},{children:a(c(c({},m),{},{ref:p.current,resize:v}))}))}),Nte=["scene","style","onSplineMouseDown","onSplineMouseUp","onSplineMouseHover","onSplineKeyDown","onSplineKeyUp","onSplineStart","onSplineLookAt","onSplineFollow","onSplineScroll","onLoad","renderOnDemand","wasmPath","children"],Fte=(0,e.forwardRef)((t,i)=>{let{scene:n,style:a,onSplineMouseDown:o,onSplineMouseUp:s,onSplineMouseHover:l,onSplineKeyDown:d,onSplineKeyUp:u,onSplineStart:h,onSplineLookAt:p,onSplineFollow:f,onSplineScroll:m,onLoad:g,renderOnDemand:v=!0,wasmPath:y,children:b}=t,x=r(t,Nte);const w=(0,e.useRef)(null),[S,_]=(0,e.useState)(!0),[C,E]=(0,e.useState)();if(C)throw C;return(0,e.useEffect)(()=>{let e;_(!0);const t=[{name:"mouseDown",cb:o},{name:"mouseUp",cb:s},{name:"mouseHover",cb:l},{name:"keyDown",cb:d},{name:"keyUp",cb:u},{name:"start",cb:h},{name:"lookAt",cb:p},{name:"follow",cb:f},{name:"scroll",cb:m}];if(w.current){async function i(){await e.load(n);for(let i of t)i.cb&&e.addEventListener(i.name,i.cb);_(!1),null==g||g(e)}e=new Ote(w.current,{renderOnDemand:v,wasmPath:y}),i().catch(e=>{E(e)})}return()=>{for(let i of t)i.cb&&e.removeEventListener(i.name,i.cb);e.dispose()}},[n]),(0,_t.jsx)(Bte,c(c({ref:i,parentSizeStyles:c({overflow:"hidden"},a),debounceTime:50},x),{},{children:()=>(0,_t.jsxs)(_t.Fragment,{children:[S&&b,(0,_t.jsx)("canvas",{ref:w,style:{display:S?"none":"block"}})]})}))}),Ute=()=>(e,t)=>t.reduce((e,t)=>{const[i,n]=e,r=t;return void 0!==n[r]&&(i[r]=n[r]),delete n[r],[i,n]},[{},c({},e)]);function Vte(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{name:i,strict:n=!0,hookName:r="useContext",providerName:a="Provider",errorMessage:o,defaultValue:s}=t,l=(0,e.createContext)(s);return l.displayName=i,[l.Provider,function t(){const i=(0,e.useContext)(l);if(!i&&n){var s;const e=new Error(null!==o&&void 0!==o?o:(c=a,"".concat(r," returned `undefined`. Seems you forgot to wrap component within ").concat(c)));throw e.name="ContextError",null===(s=Error.captureStackTrace)||void 0===s||s.call(Error,e,t),e}var c;return i},l]}const[jte,Wte]=Vte({name:"RenderStrategyContext",hookName:"useRenderStrategyContext",providerName:"<RenderStrategyPropsProvider />"}),Hte=e=>Ute()(e,["lazyMount","unmountOnExit"]);function Gte(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return e=>{const i=[];for(const n of t)if("function"===typeof n){const t=n(e);"function"===typeof t&&i.push(t)}else n&&(n.current=e);if(i.length)return()=>{for(const e of i)e()}}}const qte=["asChild","children"];const Xte=t=>{const i=(0,e.memo)((0,e.forwardRef)((i,n)=>{const{asChild:a,children:o}=i,s=r(i,qte);if(!a)return(0,e.createElement)(t,c(c({},s),{},{ref:n}),o);const l=e.Children.only(o);if(!(0,e.isValidElement)(l))return null;const d=function(e){var t,i;let n=null===(t=Object.getOwnPropertyDescriptor(e.props,"ref"))||void 0===t?void 0:t.get,r=n&&"isReactWarning"in n&&n.isReactWarning;return r?e.ref:(n=null===(i=Object.getOwnPropertyDescriptor(e,"ref"))||void 0===i?void 0:i.get,r=n&&"isReactWarning"in n&&n.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}(l);return(0,e.cloneElement)(l,c(c({},Xd(s,l.props)),{},{ref:n?Gte(n,d):d}))}));return i.displayName=t.displayName||t.name,i},Yte=(()=>{const e=new Map;return new Proxy(Xte,{apply:(e,t,i)=>Xte(i[0]),get(t,i){const n=i;return e.has(n)||e.set(n,Xte(n)),e.get(n)}})})(),[Qte,Kte]=Vte({name:"TabsContext",hookName:"useTabsContext",providerName:"<TabsProvider />"}),Zte=(0,e.forwardRef)((e,t)=>{const[i,n]=Hte(e),[{value:r},a]=Ute()(n,["value"]),o=Xd(r.getRootProps(),a);return(0,_t.jsx)(Qte,{value:r,children:(0,_t.jsx)(jte,{value:i,children:(0,_t.jsx)(Yte.div,c(c({},o),{},{ref:t}))})})});Zte.displayName="TabsRootProvider";var Jte=i(950),$te="undefined"!==typeof globalThis.document?e.useLayoutEffect:e.useEffect;function eie(t){var i,n;const r=null!==(i=t().value)&&void 0!==i?i:t().defaultValue,a=null!==(n=t().isEqual)&&void 0!==n?n:Object.is,[o]=(0,e.useState)(r),[s,l]=(0,e.useState)(o),c=void 0!==t().value,d=(0,e.useRef)(s);d.current=c?t().value:s;const u=(0,e.useRef)(d.current);$te(()=>{u.current=d.current},[s,t().value]);return{initial:o,ref:d,get:function(){return c?t().value:s},set(e){(t().sync?Jte.flushSync:oo)(()=>(e=>{const i=u.current,n=eo(e)?e(i):e;var r,o;t().debug&&console.log("[bindable > ".concat(t().debug,"] setValue"),{next:n,prev:i}),c||l(n),a(n,i)||null===(r=(o=t()).onChange)||void 0===r||r.call(o,n,i)})(e))},invoke(e,i){var n,r;null===(n=(r=t()).onChange)||void 0===n||n.call(r,e,i)},hash(e){var i,n,r;return null!==(i=null===(n=(r=t()).hash)||void 0===n?void 0:n.call(r,e))&&void 0!==i?i:String(e)}}}eie.cleanup=t=>{(0,e.useEffect)(()=>t,[])},eie.ref=t=>{const i=(0,e.useRef)(t);return{get:()=>i.current,set:e=>{i.current=e}}};var tie=(t,i)=>{const n=(0,e.useRef)(!1),r=(0,e.useRef)(!1);(0,e.useEffect)(()=>{if(n.current&&r.current)return i();r.current=!0},[...(null!==t&&void 0!==t?t:[]).map(e=>"function"===typeof e?e():e)]),(0,e.useEffect)(()=>(n.current=!0,()=>{n.current=!1}),[])};function iie(t){var i,n,r,a,o,s;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const d=(0,e.useMemo)(()=>{const{id:e,ids:t,getRootNode:i}=l;return function(e){const t=()=>{var t,i;return null!==(t=null===(i=e.getRootNode)||void 0===i?void 0:i.call(e))&&void 0!==t?t:document},i=()=>ws(t()),n=()=>_s(t());return c(c({},e),{},{getRootNode:t,getDoc:i,getWin:()=>{var e;return null!==(e=i().defaultView)&&void 0!==e?e:window},getActiveElement:n,isActiveElement:e=>e===n(),getById:e=>t().getElementById(e)})}({id:e,ids:t,getRootNode:i})},[l]),u=function(){t.debug&&console.log(...arguments)},h=function(e){const t=nie(e);return function(e){return t.current[e]}}(null!==(i=null===(n=t.props)||void 0===n?void 0:n.call(t,{props:ko(l),scope:d}))&&void 0!==i?i:l),p=nie(null===(r=t.context)||void 0===r?void 0:r.call(t,{prop:h,bindable:eie,scope:d,flush:rie,getContext:()=>f,getComputed:()=>M,getRefs:()=>w,getEvent:()=>b()})),f={get(e){var t;return null===(t=p.current)||void 0===t?void 0:t[e].ref.current},set(e,t){var i;null===(i=p.current)||void 0===i||i[e].set(t)},initial(e){var t;return null===(t=p.current)||void 0===t?void 0:t[e].initial},hash(e){var t,i;const n=null===(t=p.current)||void 0===t?void 0:t[e].get();return null===(i=p.current)||void 0===i?void 0:i[e].hash(n)}},m=(0,e.useRef)(new Map),g=(0,e.useRef)(null),v=(0,e.useRef)(null),y=(0,e.useRef)({type:""}),b=()=>c(c({},y.current),{},{current:()=>y.current,previous:()=>v.current}),x=()=>c(c({},T),{},{matches(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.includes(T.ref.current)},hasTag(e){var i;return!(null===(i=t.states[T.ref.current])||void 0===i||null===(i=i.tags)||void 0===i||!i.includes(e))}}),w=function(t){const i=(0,e.useRef)(t);return{get:e=>i.current[e],set(e,t){i.current[e]=t}}}(null!==(a=null===(o=t.refs)||void 0===o?void 0:o.call(t,{prop:h,context:f}))&&void 0!==a?a:{}),S=()=>({state:x(),context:f,event:b(),prop:h,send:O,action:_,guard:C,track:tie,refs:w,computed:M,flush:rie,scope:d,choose:A}),_=e=>{const i=eo(e)?e(S()):e;if(!i)return;const n=i.map(e=>{var i;const n=null===(i=t.implementations)||void 0===i||null===(i=i.actions)||void 0===i?void 0:i[e];return n||'[zag-js] No implementation found for action "'.concat(JSON.stringify(e),'"'),n});for(const t of n)null===t||void 0===t||t(S())},C=e=>{var i;return eo(e)?e(S()):null===(i=t.implementations)||void 0===i||null===(i=i.guards)||void 0===i?void 0:i[e](S())},E=e=>{const i=eo(e)?e(S()):e;if(!i)return;const n=i.map(e=>{var i;const n=null===(i=t.implementations)||void 0===i||null===(i=i.effects)||void 0===i?void 0:i[e];return n||'[zag-js] No implementation found for effect "'.concat(JSON.stringify(e),'"'),n}),r=[];for(const t of n){const e=null===t||void 0===t?void 0:t(S());e&&r.push(e)}return()=>r.forEach(e=>null===e||void 0===e?void 0:e())},A=e=>La(e).find(e=>{let t=!e.guard;return $a(e.guard)?t=!!C(e.guard):eo(e.guard)&&(t=e.guard(S())),t}),M=e=>{zo(t.computed,()=>"[zag-js] No computed object found on machine");return(0,t.computed[e])({context:f,event:b(),prop:h,refs:w,scope:d,computed:M})},T=eie(()=>({defaultValue:t.initialState({prop:h}),onChange(e,i){var n,r,a,o;if(i){const e=m.current.get(i);null===e||void 0===e||e(),m.current.delete(i)}i&&_(null===(o=t.states[i])||void 0===o?void 0:o.exit);_(null===(n=g.current)||void 0===n?void 0:n.actions);const s=E(null===(r=t.states[e])||void 0===r?void 0:r.effects);if(s&&m.current.set(e,s),i===Jd){_(t.entry);const e=E(t.effects);e&&m.current.set(Jd,e)}_(null===(a=t.states[e])||void 0===a?void 0:a.entry)}})),P=(0,e.useRef)(void 0),D=(0,e.useRef)(Zd.NotStarted);$te(()=>{queueMicrotask(()=>{var e;const t=D.current===Zd.Started;D.current=Zd.Started,u(t?"rehydrating...":"initializing...");const i=null!==(e=P.current)&&void 0!==e?e:T.initial;T.invoke(i,t?T.get():Jd)});const e=m.current,i=T.ref.current;return()=>{u("unmounting..."),P.current=i,D.current=Zd.Stopped,e.forEach(e=>null===e||void 0===e?void 0:e()),m.current=new Map,g.current=null,queueMicrotask(()=>{_(t.exit)})}},[]);const O=e=>{queueMicrotask(()=>{var i,n,r,a;if(D.current!==Zd.Started)return;v.current=y.current,y.current=e,u("send",e);let o="ref"in T?T.ref.current:T.get();const s=null!==(i=null===(n=t.states[o].on)||void 0===n?void 0:n[e.type])&&void 0!==i?i:null===(r=t.on)||void 0===r?void 0:r[e.type],l=A(s);if(!l)return;g.current=l;const c=null!==(a=l.target)&&void 0!==a?a:o;u("transition",l);const d=c!==o;if(d)(0,Jte.flushSync)(()=>T.set(c));else if(l.reenter&&!d)T.invoke(o,o);else{var h;_(null!==(h=l.actions)&&void 0!==h?h:[])}})};return null===(s=t.watch)||void 0===s||s.call(t,S()),{state:x(),send:O,context:f,prop:h,scope:d,refs:w,computed:M,event:b(),getStatus:()=>D.current}}function nie(t){const i=(0,e.useRef)(t);return i.current=t,i}function rie(e){queueMicrotask(()=>{(0,Jte.flushSync)(()=>e())})}var aie=function(e){return new Proxy({},{get:(t,i)=>"style"===i?t=>e({style:t}).style:e})}(e=>e),oie=ka("tabs").parts("root","list","trigger","content","indicator").build(),sie=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.root)&&void 0!==t?t:"tabs:".concat(e.id)},lie=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.list)&&void 0!==t?t:"tabs:".concat(e.id,":list")},cie=(e,t)=>{var i,n;return null!==(i=null===(n=e.ids)||void 0===n?void 0:n.content)&&void 0!==i?i:"tabs:".concat(e.id,":content-").concat(t)},die=(e,t)=>{var i,n;return null!==(i=null===(n=e.ids)||void 0===n?void 0:n.trigger)&&void 0!==i?i:"tabs:".concat(e.id,":trigger-").concat(t)},uie=e=>{var t,i;return null!==(t=null===(i=e.ids)||void 0===i?void 0:i.indicator)&&void 0!==t?t:"tabs:".concat(e.id,":indicator")},hie=(e,t)=>e.getById(die(e,t)),pie=e=>e.getById(uie(e)),fie=e=>{const t=CSS.escape(lie(e)),i="[role=tab][data-ownedby='".concat(t,"']:not([disabled])");return Sl((e=>e.getById(lie(e)))(e),i)},mie=e=>{var t,i,n,r;return{left:null!==(t=null===e||void 0===e?void 0:e.offsetLeft)&&void 0!==t?t:0,top:null!==(i=null===e||void 0===e?void 0:e.offsetTop)&&void 0!==i?i:0,width:null!==(n=null===e||void 0===e?void 0:e.offsetWidth)&&void 0!==n?n:0,height:null!==(r=null===e||void 0===e?void 0:e.offsetHeight)&&void 0!==r?r:0}},gie=e=>({width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),left:"".concat(e.left,"px"),top:"".concat(e.top,"px")});function vie(e,t){const{state:i,send:n,context:r,prop:a,scope:o}=e,s=a("translations"),l=i.matches("focused"),d="vertical"===a("orientation"),u="horizontal"===a("orientation"),h=a("composite");function p(e){return{selected:r.get("value")===e.value,focused:r.get("focusedValue")===e.value,disabled:!!e.disabled}}return{value:r.get("value"),focusedValue:r.get("focusedValue"),setValue(e){n({type:"SET_VALUE",value:e})},clearValue(){n({type:"CLEAR_VALUE"})},setIndicatorRect(e){const t=die(o,e);n({type:"SET_INDICATOR_RECT",id:t})},syncTabIndex(){n({type:"SYNC_TAB_INDEX"})},selectNext(e){n({type:"TAB_FOCUS",value:e,src:"selectNext"}),n({type:"ARROW_NEXT",src:"selectNext"})},selectPrev(e){n({type:"TAB_FOCUS",value:e,src:"selectPrev"}),n({type:"ARROW_PREV",src:"selectPrev"})},focus(){var e;const t=r.get("value");t&&(null===(e=hie(o,t))||void 0===e||e.focus())},getRootProps:()=>t.element(c(c({},oie.root.attrs),{},{id:sie(o),"data-orientation":a("orientation"),"data-focus":ps(l),dir:a("dir")})),getListProps:()=>t.element(c(c({},oie.list.attrs),{},{id:lie(o),role:"tablist",dir:a("dir"),"data-focus":ps(l),"aria-orientation":a("orientation"),"data-orientation":a("orientation"),"aria-label":null===s||void 0===s?void 0:s.listLabel,onKeyDown(e){if(e.defaultPrevented)return;if(!(e=>xs(e.currentTarget,Rs(e)))(e))return;if(Ls(e))return;const t={ArrowDown(){u||n({type:"ARROW_NEXT",key:"ArrowDown"})},ArrowUp(){u||n({type:"ARROW_PREV",key:"ArrowUp"})},ArrowLeft(){d||n({type:"ARROW_PREV",key:"ArrowLeft"})},ArrowRight(){d||n({type:"ARROW_NEXT",key:"ArrowRight"})},Home(){n({type:"HOME"})},End(){n({type:"END"})}}[Us(e,{dir:a("dir"),orientation:a("orientation")})];return t?(e.preventDefault(),void t(e)):void 0}})),getTriggerState:p,getTriggerProps(e){const{value:i,disabled:s}=e,l=p(e);return t.button(c(c({},oie.trigger.attrs),{},{role:"tab",type:"button",disabled:s,dir:a("dir"),"data-orientation":a("orientation"),"data-disabled":ps(s),"aria-disabled":s,"data-value":i,"aria-selected":l.selected,"data-selected":ps(l.selected),"data-focus":ps(l.focused),"aria-controls":l.selected?cie(o,i):void 0,"data-ownedby":lie(o),"data-ssr":ps(r.get("ssr")),id:die(o,i),tabIndex:l.selected&&h?0:-1,onFocus(){n({type:"TAB_FOCUS",value:i})},onBlur(e){const t=e.relatedTarget;"tab"!==(null===t||void 0===t?void 0:t.getAttribute("role"))&&n({type:"TAB_BLUR"})},onClick(e){e.defaultPrevented||zs(e)||s||(ks()&&e.currentTarget.focus(),n({type:"TAB_CLICK",value:i}))}}))},getContentProps(e){const{value:i}=e,n=r.get("value")===i;return t.element(c(c({},oie.content.attrs),{},{dir:a("dir"),id:cie(o,i),tabIndex:h?0:-1,"aria-labelledby":die(o,i),role:"tabpanel","data-ownedby":lie(o),"data-selected":ps(n),"data-orientation":a("orientation"),hidden:!n}))},getIndicatorProps(){const e=r.get("indicatorRect"),i=r.get("indicatorTransition");return t.element(c(c({id:uie(o)},oie.indicator.attrs),{},{dir:a("dir"),"data-orientation":a("orientation"),style:{"--transition-property":"left, right, top, bottom, width, height","--left":e.left,"--top":e.top,"--width":e.width,"--height":e.height,position:"absolute",willChange:"var(--transition-property)",transitionProperty:"var(--transition-property)",transitionDuration:i?"var(--transition-duration, 150ms)":"0ms",transitionTimingFunction:"var(--transition-timing-function)",[u?"left":"top"]:u?"var(--left)":"var(--top)"}}))}}}var{createMachine:yie}=Kd(),bie=yie({props(e){let{props:t}=e;return c({dir:"ltr",orientation:"horizontal",activationMode:"automatic",loopFocus:!0,composite:!0,navigate(e){sl(e.node)},defaultValue:null},t)},initialState:()=>"idle",context(e){let{prop:t,bindable:i}=e;return{value:i(()=>({defaultValue:t("defaultValue"),value:t("value"),onChange(e){var i;null===(i=t("onValueChange"))||void 0===i||i({value:e})}})),focusedValue:i(()=>({defaultValue:t("value")||t("defaultValue"),sync:!0,onChange(e){var i;null===(i=t("onFocusChange"))||void 0===i||i({focusedValue:e})}})),ssr:i(()=>({defaultValue:!0})),indicatorTransition:i(()=>({defaultValue:!1})),indicatorRect:i(()=>({defaultValue:{left:"0px",top:"0px",width:"0px",height:"0px"}}))}},watch(e){let{context:t,prop:i,track:n,action:r}=e;n([()=>t.get("value")],()=>{r(["allowIndicatorTransition","syncIndicatorRect","syncTabIndex","navigateIfNeeded"])}),n([()=>i("dir"),()=>i("orientation")],()=>{r(["syncIndicatorRect"])})},on:{SET_VALUE:{actions:["setValue"]},CLEAR_VALUE:{actions:["clearValue"]},SET_INDICATOR_RECT:{actions:["setIndicatorRect"]},SYNC_TAB_INDEX:{actions:["syncTabIndex"]}},entry:["syncIndicatorRect","syncTabIndex","syncSsr"],exit:["cleanupObserver"],states:{idle:{on:{TAB_FOCUS:{target:"focused",actions:["setFocusedValue"]},TAB_CLICK:{target:"focused",actions:["setFocusedValue","setValue"]}}},focused:{on:{TAB_CLICK:{actions:["setFocusedValue","setValue"]},ARROW_PREV:[{guard:"selectOnFocus",actions:["focusPrevTab","selectFocusedTab"]},{actions:["focusPrevTab"]}],ARROW_NEXT:[{guard:"selectOnFocus",actions:["focusNextTab","selectFocusedTab"]},{actions:["focusNextTab"]}],HOME:[{guard:"selectOnFocus",actions:["focusFirstTab","selectFocusedTab"]},{actions:["focusFirstTab"]}],END:[{guard:"selectOnFocus",actions:["focusLastTab","selectFocusedTab"]},{actions:["focusLastTab"]}],TAB_FOCUS:{actions:["setFocusedValue"]},TAB_BLUR:{target:"idle",actions:["clearFocusedValue"]}}}},implementations:{guards:{selectOnFocus:e=>{let{prop:t}=e;return"automatic"===t("activationMode")}},actions:{selectFocusedTab(e){let{context:t,prop:i}=e;al(()=>{const e=t.get("focusedValue");if(!e)return;const n=i("deselectable")&&t.get("value")===e?null:e;t.set("value",n)})},setFocusedValue(e){let{context:t,event:i,flush:n}=e;null!=i.value&&n(()=>{t.set("focusedValue",i.value)})},clearFocusedValue(e){let{context:t}=e;t.set("focusedValue",null)},setValue(e){let{context:t,event:i,prop:n}=e;const r=n("deselectable")&&t.get("value")===t.get("focusedValue");t.set("value",r?null:i.value)},clearValue(e){let{context:t}=e;t.set("value",null)},focusFirstTab(e){let{scope:t}=e;al(()=>{var e;null===(e=Ba(fie(t)))||void 0===e||e.focus()})},focusLastTab(e){let{scope:t}=e;al(()=>{var e;null===(e=Na(fie(t)))||void 0===e||e.focus()})},focusNextTab(e){var t;let{context:i,prop:n,scope:r,event:a}=e;const o=null!==(t=a.value)&&void 0!==t?t:i.get("focusedValue");if(!o)return;const s=(l=r,c={value:o,loopFocus:n("loopFocus")},Ml(fie(l),die(l,c.value),c.loopFocus));var l,c;al(()=>{n("composite")?null===s||void 0===s||s.focus():null!=(null===s||void 0===s?void 0:s.dataset.value)&&i.set("focusedValue",s.dataset.value)})},focusPrevTab(e){var t;let{context:i,prop:n,scope:r,event:a}=e;const o=null!==(t=a.value)&&void 0!==t?t:i.get("focusedValue");if(!o)return;const s=(l=r,c={value:o,loopFocus:n("loopFocus")},Tl(fie(l),die(l,c.value),c.loopFocus));var l,c;al(()=>{n("composite")?null===s||void 0===s||s.focus():null!=(null===s||void 0===s?void 0:s.dataset.value)&&i.set("focusedValue",s.dataset.value)})},syncTabIndex(e){let{context:t,scope:i}=e;al(()=>{const e=t.get("value");if(!e)return;const n=((e,t)=>e.getById(cie(e,t)))(i,e);if(!n)return;$s(n).length>0?n.removeAttribute("tabindex"):n.setAttribute("tabindex","0")})},cleanupObserver(e){let{refs:t}=e;const i=t.get("indicatorCleanup");i&&i()},allowIndicatorTransition(e){let{context:t}=e;t.set("indicatorTransition",!0)},setIndicatorRect(e){var t;let{context:i,event:n,scope:r}=e;const a=null!==(t=n.id)&&void 0!==t?t:i.get("value");if(!pie(r))return;if(!a)return void i.set("indicatorTransition",!1);hie(r,a)&&(i.set("indicatorRect",((e,t)=>{const i=El(fie(e),die(e,t));return gie(mie(i))})(r,a)),rl(()=>{i.set("indicatorTransition",!1)}))},syncSsr(e){let{context:t}=e;t.set("ssr",!1)},syncIndicatorRect(e){let{context:t,refs:i,scope:n}=e;const r=i.get("indicatorCleanup");r&&r();const a=t.get("value");if(!a)return void t.set("indicatorTransition",!1);const o=hie(n,a),s=pie(n);if(!o||!s)return;const l=Pl([o],{measure:e=>mie(e),onEntry(e){let{rects:i}=e;const[n]=i;t.set("indicatorRect",gie(n))}});i.set("indicatorCleanup",l)},navigateIfNeeded(e){let{context:t,prop:i,scope:n}=e;const r=t.get("value");if(!r)return;const a=hie(n,r);var o;(e=>!(null===e||void 0===e||!e.matches("a[href]")))(a)&&(null===(o=i("navigate"))||void 0===o||o({value:r,node:a,href:a.href}))}}}}),xie=pu()(["activationMode","composite","deselectable","dir","getRootNode","id","ids","loopFocus","navigate","onFocusChange","onValueChange","orientation","translations","value","defaultValue"]),wie=(Ro(xie),pu()(["disabled","value"])),Sie=(Ro(wie),pu()(["value"]));Ro(Sie);const[_ie,Cie]=Vte({name:"EnvironmentContext",hookName:"useEnvironmentContext",providerName:"<EnvironmentProvider />",strict:!1,defaultValue:{getRootNode:()=>document,getDocument:()=>document,getWindow:()=>window}}),[Eie,Aie]=Vte({name:"LocaleContext",hookName:"useLocaleContext",providerName:"<LocaleProvider />",strict:!1,defaultValue:{dir:"ltr",locale:"en-US"}}),Mie=(0,e.forwardRef)((t,i)=>{const[n,r]=Hte(t),[a,o]=Ute()(r,["activationMode","composite","defaultValue","deselectable","id","ids","loopFocus","navigate","onFocusChange","onValueChange","orientation","translations","value"]),s=(t=>{const i=(0,e.useId)(),{getRootNode:n}=Cie(),{dir:r}=Aie(),a=c({id:i,dir:r,getRootNode:n},t);return vie(iie(bie,a),aie)})(a),l=Xd(s.getRootProps(),o);return(0,_t.jsx)(Qte,{value:s,children:(0,_t.jsx)(jte,{value:n,children:(0,_t.jsx)(Yte.div,c(c({},l),{},{ref:i}))})})});Mie.displayName="TabsRoot";const Tie=(0,e.forwardRef)((e,t)=>{const[i,n]=Ute()(e,["disabled","value"]),r=Xd(Kte().getTriggerProps(i),n);return(0,_t.jsx)(Yte.button,c(c({},r),{},{ref:t}))});function Pie(t,i){const[n,r]=(0,e.useState)(t);return(0,e.useEffect)(()=>{const e=setTimeout(()=>{r(t)},i);return()=>{clearTimeout(e)}},[t,i]),n}Tie.displayName="TabTrigger";var Die={props(e){let{props:t}=e;return c(c({},t),{},{present:!!t.present})},initialState(e){let{prop:t}=e;return t("present")?"mounted":"unmounted"},refs:()=>({node:null,styles:null}),context(e){let{bindable:t}=e;return{unmountAnimationName:t(()=>({defaultValue:null})),prevAnimationName:t(()=>({defaultValue:null})),present:t(()=>({defaultValue:!1})),initial:t(()=>({sync:!0,defaultValue:!1}))}},exit:["clearInitial","cleanupNode"],watch(e){let{track:t,action:i,prop:n}=e;t([()=>n("present")],()=>{i(["setInitial","syncPresence"])})},on:{"NODE.SET":{actions:["setNode","setStyles"]}},states:{mounted:{on:{UNMOUNT:{target:"unmounted",actions:["clearPrevAnimationName","invokeOnExitComplete"]},"UNMOUNT.SUSPEND":{target:"unmountSuspended"}}},unmountSuspended:{effects:["trackAnimationEvents"],on:{MOUNT:{target:"mounted",actions:["setPrevAnimationName"]},UNMOUNT:{target:"unmounted",actions:["clearPrevAnimationName","invokeOnExitComplete"]}}},unmounted:{on:{MOUNT:{target:"mounted",actions:["setPrevAnimationName"]}}}},implementations:{actions:{setInitial:e=>{let{context:t}=e;t.get("initial")||queueMicrotask(()=>{t.set("initial",!0)})},clearInitial:e=>{let{context:t}=e;t.set("initial",!1)},cleanupNode:e=>{let{refs:t}=e;t.set("node",null),t.set("styles",null)},invokeOnExitComplete:e=>{var t;let{prop:i}=e;null===(t=i("onExitComplete"))||void 0===t||t()},setNode:e=>{let{refs:t,event:i}=e;t.set("node",i.node)},setStyles:e=>{let{refs:t,event:i}=e;t.set("styles",As(i.node))},syncPresence:e=>{let{context:t,refs:i,send:n,prop:r}=e;const a=r("present");if(a)return n({type:"MOUNT",src:"presence.changed"});const o=i.get("node");if(!a&&"hidden"===(null===o||void 0===o?void 0:o.ownerDocument.visibilityState))return n({type:"UNMOUNT",src:"visibilitychange"});al(()=>{var e,r;const a=Oie(i.get("styles"));t.set("unmountAnimationName",a),"none"===a||a===t.get("prevAnimationName")||"none"===(null===(e=i.get("styles"))||void 0===e?void 0:e.display)||"0s"===(null===(r=i.get("styles"))||void 0===r?void 0:r.animationDuration)?n({type:"UNMOUNT",src:"presence.changed"}):n({type:"UNMOUNT.SUSPEND"})})},setPrevAnimationName:e=>{let{context:t,refs:i}=e;al(()=>{t.set("prevAnimationName",Oie(i.get("styles")))})},clearPrevAnimationName:e=>{let{context:t}=e;t.set("prevAnimationName",null)}},effects:{trackAnimationEvents:e=>{let{context:t,refs:i,send:n}=e;const r=i.get("node");if(!r)return;const a=e=>{var n,a;(null!==(n=null===(a=e.composedPath)||void 0===a||null===(a=a.call(e))||void 0===a?void 0:a[0])&&void 0!==n?n:e.target)===r&&t.set("prevAnimationName",Oie(i.get("styles")))},o=e=>{const a=Oie(i.get("styles"));Rs(e)===r&&a===t.get("unmountAnimationName")&&n({type:"UNMOUNT",src:"animationend"})};r.addEventListener("animationstart",a),r.addEventListener("animationcancel",o),r.addEventListener("animationend",o);const s=Ol(r,{animationFillMode:"forwards"});return()=>{r.removeEventListener("animationstart",a),r.removeEventListener("animationcancel",o),r.removeEventListener("animationend",o),rl(()=>s())}}}}};function Oie(e){return(null===e||void 0===e?void 0:e.animationName)||"none"}pu()(["onExitComplete","present","immediate"]);function Iie(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sync:n=!1}=i,r=function(t){const i=(0,e.useRef)(t);return i.current=t,i}(t);return(0,e.useCallback)(function(){for(var e,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return n?queueMicrotask(()=>{var e;return null===(e=r.current)||void 0===e?void 0:e.call(r,...i)}):null===(e=r.current)||void 0===e?void 0:e.call(r,...i)},[n,r])}const kie=["lazyMount","unmountOnExit","present","skipAnimationOnMount"],[Rie,zie]=Vte({name:"PresenceContext",hookName:"usePresenceContext",providerName:"<PresenceProvider />"}),Lie=(0,e.forwardRef)((t,i)=>{const[n,a]=Ute()(t,["value"]),o=Kte(),s=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{lazyMount:i,unmountOnExit:n,present:a,skipAnimationOnMount:o=!1}=t,s=r(t,kie),l=(0,e.useRef)(!1),d=c(c({},s),{},{present:a,onExitComplete:Iie(t.onExitComplete)}),u=function(e){const{state:t,send:i,context:n}=e,r=t.matches("mounted","unmountSuspended");return{skip:!n.get("initial"),present:r,setNode(e){e&&i({type:"NODE.SET",node:e})},unmount(){i({type:"UNMOUNT"})}}}(iie(Die,d));u.present&&(l.current=!0);const h=!u.present&&!l.current&&i||n&&!u.present&&l.current;return{ref:u.setNode,getPresenceProps:()=>({"data-state":u.skip&&o?void 0:a?"open":"closed",hidden:!u.present}),present:u.present,unmounted:h}}(c(c({},Wte()),{},{present:Pie(o.value===t.value,0),immediate:!0})),l=Xd(o.getContentProps(n),s.getPresenceProps(),a);return(0,_t.jsx)(Rie,{value:s,children:s.unmounted?null:(0,_t.jsx)(Yte.div,c(c({},l),{},{ref:Gte(s.ref,i)}))})});Lie.displayName="TabContent";const Bie=(0,e.forwardRef)((e,t)=>{const i=Xd(Kte().getListProps(),e);return(0,_t.jsx)(Yte.div,c(c({},i),{},{ref:t}))});Bie.displayName="TabList";const Nie=(0,e.forwardRef)((e,t)=>{const i=Xd(Kte().getIndicatorProps(),e);return(0,_t.jsx)(Yte.div,c(c({},i),{},{ref:t}))});Nie.displayName="TabIndicator";const Fie=["unstyled"],Uie=["defaultProps"],Vie=["unstyled"],{withProvider:jie,withContext:Wie,useStyles:Hie,PropsProvider:Gie}=(t=>{const{key:i,recipe:n}=t,a=(o=i||n.className||"Component").charAt(0).toUpperCase()+o.slice(1);var o;const[s,l]=en({name:"".concat(a,"StylesContext"),errorMessage:"use".concat(a,"Styles returned is 'undefined'. Seems you forgot to wrap the components in \"<").concat(a,'.Root />" ')}),[d,u]=en({name:"".concat(a,"ClassNameContext"),errorMessage:"use".concat(a,"ClassNames returned is 'undefined'. Seems you forgot to wrap the components in \"<").concat(a,'.Root />" '),strict:!1}),[h,p]=en({strict:!1,name:"".concat(a,"PropsContext"),providerName:"".concat(a,"PropsContext"),defaultValue:{}});function f(t){const{unstyled:a}=t,o=r(t,Fie),s=function(t){const{key:i,recipe:n}=t,r=nn();return(0,e.useMemo)(()=>{const e=n||(null!=i?r.getSlotRecipe(i):{});return r.sva(structuredClone(e))},[i,n,r])}({key:i,recipe:o.recipe||n}),[l,c]=(0,e.useMemo)(()=>s.splitVariantProps(o),[o,s]);return{styles:(0,e.useMemo)(()=>a?tw:s(l),[a,l,s]),classNames:s.classNameMap,props:c}}return{StylesProvider:s,ClassNamesProvider:d,PropsProvider:h,usePropsContext:p,useRecipeResult:f,withProvider:(t,i,n)=>{const a=null!==n&&void 0!==n?n:{},{defaultProps:o}=a,l=r(a,Uie),u=Xx(t,{},l),h=(0,e.forwardRef)((t,r)=>{var a,l;const h=p(),m=(0,e.useMemo)(()=>Ox(null!==o&&void 0!==o?o:{},h,t),[h,t]),{styles:g,props:v,classNames:y}=f(m),b=y[i],x=(0,_t.jsx)(s,{value:g,children:(0,_t.jsx)(d,{value:y,children:(0,_t.jsx)(u,c(c({ref:r},v),{},{css:[g[i],m.css],className:Sr(m.className,b)}))})});return null!==(a=null===n||void 0===n||null===(l=n.wrapElement)||void 0===l?void 0:l.call(n,x,m))&&void 0!==a?a:x});return h.displayName=t.displayName||t.name,h},withContext:(t,i,n)=>{const a=Xx(t,{},n),o=(0,e.forwardRef)((e,t)=>{const{unstyled:n}=e,o=r(e,Vie),s=l(),d=u(),h=null===d||void 0===d?void 0:d[i];return(0,_t.jsx)(a,c(c({},o),{},{css:[!n&&i?s[i]:void 0,e.css],ref:t,className:Sr(e.className,h)}))});return o.displayName=t.displayName||t.name,o},withRootProvider:function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{defaultProps:n}=i,r=i=>{const r=p(),a=(0,e.useMemo)(()=>Ox(n,r,i),[r,i]),{styles:o,classNames:l,props:u}=f(a);return(0,_t.jsx)(s,{value:o,children:(0,_t.jsx)(d,{value:l,children:(0,_t.jsx)(t,c({},u))})})};return r.displayName=t.displayName||t.name,r},useStyles:l,useClassNames:u}})({key:"tabs"}),qie=(jie(Zte,"root",{forwardAsChild:!0}),jie(Mie,"root",{forwardAsChild:!0})),Xie=Wie(Tie,"trigger",{forwardAsChild:!0}),Yie=(Wie(Lie,"content",{forwardAsChild:!0}),Wie("div","contentGroup"),Wie(Bie,"list",{forwardAsChild:!0}));Wie(Nie,"indicator",{forwardAsChild:!0});function Qie(){const e=fe(),t=ue().pathname.slice(1)||"home";return(0,_t.jsx)(qie,{value:t,variant:"outline",p:"1",children:(0,_t.jsxs)(Yie,{children:[(0,_t.jsx)(Xie,{value:"home",onClick:()=>e("/"),children:"Home"}),(0,_t.jsx)(Xie,{value:"projects",onClick:()=>e("/projects"),children:"Projects"}),(0,_t.jsx)(Xie,{value:"classes",onClick:()=>e("/classes"),children:"Classes"})]})})}function Kie(){const e=fe();return(0,_t.jsxs)("div",{children:[(0,_t.jsx)(Qx,{ml:"5",mt:"2",mb:"7",children:(0,_t.jsx)("text",{children:"Hi, my name is"})}),(0,_t.jsx)(Qx,{as:"section",position:"relative",w:"100%",h:{base:"50px",sm:"100px",md:"150px",xl:"200px","2xl":"250px"},overflow:"hidden",bg:"transparent",children:(0,_t.jsx)(Qx,{position:"absolute",top:"0",left:"0",w:"100%",children:(0,_t.jsx)(Fte,{scene:"https://prod.spline.design/mC26st2WiUIQecBw/scene.splinecode"})})}),(0,_t.jsxs)(Zx,{templateColumns:"repeat(2, 1fr)",gap:"6",children:[(0,_t.jsxs)(Qx,{ml:"5",mt:"7",children:["I am a Computer Science and Mathematics student at Barnard College of Columbia University.",(0,_t.jsx)("br",{}),(0,_t.jsx)("br",{}),"I create projects and tools that turn real-world problems into elegant, usable solutions. From leading Girls Who Code workshops to developing innovative projects like 'What's Cookin',' I combine technical skill with curiosity to bring ideas to life.",(0,_t.jsx)("br",{})]}),(0,_t.jsx)(Qx,{position:"relative",children:(0,_t.jsx)(Jx,{axis:"both",children:(0,_t.jsxs)(Zx,{templateRows:"repeat(2, 1fr)",gap:10,children:[(0,_t.jsx)(fw,{onClick:()=>e("/projects"),children:"My Projects"}),(0,_t.jsx)(fw,{onClick:()=>e("/classes"),children:"My Classes"})]})})})]})]})}function Zie(){return(0,_t.jsxs)("div",{children:[(0,_t.jsx)("h1",{children:"Proj"}),(0,_t.jsx)("p",{children:"This is the Projects page."})]})}function Jie(){return(0,_t.jsxs)("div",{children:[(0,_t.jsx)("h1",{children:"hi"}),(0,_t.jsx)("p",{children:"This is my classes."})]})}const{withContext:$ie,PropsProvider:ene}=nw({key:"container"}),tne=$ie("div"),ine=["align","justify","children","wrap","skip"],nne=Xx("div",{base:{display:"inline-flex",gap:"var(--group-gap, 0.5rem)",isolation:"isolate",position:"relative","& [data-group-item]":{_focusVisible:{zIndex:1}}},variants:{orientation:{horizontal:{flexDirection:"row"},vertical:{flexDirection:"column"}},attached:{true:{gap:"0!"}},grow:{true:{display:"flex","& > *":{flex:1}}},stacking:{"first-on-top":{"& > [data-group-item]":{zIndex:"calc(var(--group-count) - var(--group-index))"}},"last-on-top":{"& > [data-group-item]":{zIndex:"var(--group-index)"}}}},compoundVariants:[{orientation:"horizontal",attached:!0,css:{"& > *[data-first]":{borderEndRadius:"0!",marginEnd:"-1px"},"& > *[data-between]":{borderRadius:"0!",marginEnd:"-1px"},"& > *[data-last]":{borderStartRadius:"0!"}}},{orientation:"vertical",attached:!0,css:{"& > *[data-first]":{borderBottomRadius:"0!",marginBottom:"-1px"},"& > *[data-between]":{borderRadius:"0!",marginBottom:"-1px"},"& > *[data-last]":{borderTopRadius:"0!"}}}],defaultVariants:{orientation:"horizontal"}}),rne=(0,e.memo)((0,e.forwardRef)(function(t,i){const{align:n="center",justify:a="flex-start",children:o,wrap:s,skip:l}=t,d=r(t,ine),u=(0,e.useMemo)(()=>{let t=e.Children.toArray(o).filter(e.isValidElement);if(1===t.length)return t;const i=t.filter(e=>!(null!==l&&void 0!==l&&l(e))),n=i.length;return 1===i.length?t:t.map(t=>{var r;const a=t.props;if(null!==l&&void 0!==l&&l(t))return t;const o=i.indexOf(t);return(0,e.cloneElement)(t,c(c({},a),{},{"data-group-item":"","data-first":$x(0===o),"data-last":$x(o===n-1),"data-between":$x(o>0&&o<n-1),style:c({"--group-count":n,"--group-index":o},null!==(r=null===a||void 0===a?void 0:a.style)&&void 0!==r?r:{})}))})},[o,l]);return(0,_t.jsx)(nne,c(c({ref:i,alignItems:n,justifyContent:a,flexWrap:s},d),{},{className:Sr("chakra-group",t.className),children:u}))})),{withContext:ane,PropsProvider:one}=nw({key:"link"}),sne=ane("a");var lne={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},cne=e.createContext&&e.createContext(lne),dne=["attr","size","title"];function une(e,t){if(null==e)return{};var i,n,r=function(e,t){if(null==e)return{};var i={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function hne(){return hne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},hne.apply(this,arguments)}function pne(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function fne(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?pne(Object(i),!0).forEach(function(t){mne(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):pne(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function mne(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function gne(t){return t&&t.map((t,i)=>e.createElement(t.tag,fne({key:i},t.attr),gne(t.child)))}function vne(t){return i=>e.createElement(yne,hne({attr:fne({},t.attr)},i),gne(t.child))}function yne(t){var i=i=>{var n,{attr:r,size:a,title:o}=t,s=une(t,dne),l=a||i.size||"1em";return i.className&&(n=i.className),t.className&&(n=(n?n+" ":"")+t.className),e.createElement("svg",hne({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},i.attr,r,s,{className:n,style:fne(fne({color:t.color||i.color},i.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),o&&e.createElement("title",null,o),t.children)};return void 0!==cne?e.createElement(cne.Consumer,null,e=>i(e)):i(lne)}function bne(e){return vne({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"},child:[]}]})(e)}function xne(e){return vne({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM349.3 793.7H230.6V411.9h118.7v381.8zm-59.3-434a68.8 68.8 0 1 1 68.8-68.8c-.1 38-30.9 68.8-68.8 68.8zm503.7 434H675.1V608c0-44.3-.8-101.2-61.7-101.2-61.7 0-71.2 48.2-71.2 98v188.9H423.7V411.9h113.8v52.2h1.6c15.8-30 54.5-61.7 112.3-61.7 120.2 0 142.3 79.1 142.3 181.9v209.4z"},child:[]}]})(e)}function wne(e){return vne({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0 0 68.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"},child:[]}]})(e)}function Sne(){return(0,_t.jsx)(tne,{fluid:!0,position:"absolute",bottom:"0",borderTopWidth:"1px",centerContent:!0,p:"4",children:(0,_t.jsxs)(rne,{children:[(0,_t.jsx)(fw,{variant:"outline",borderWidth:"0",children:(0,_t.jsxs)(sne,{href:"https://www.linkedin.com/in/beccafrey/",children:[" ",(0,_t.jsx)(xne,{})," "]})}),(0,_t.jsx)(fw,{variant:"outline",borderWidth:"0",children:(0,_t.jsxs)(sne,{href:"https://github.com/rebecca505",children:[" ",(0,_t.jsx)(bne,{})," "]})}),(0,_t.jsx)(fw,{variant:"outline",borderWidth:"0",children:(0,_t.jsxs)(sne,{href:"mailto:rlf2153@columbia.edu",children:[" ",(0,_t.jsx)(wne,{})," "]})})]})})}const _ne=function(){return(0,_t.jsx)(Ex,{children:(0,_t.jsxs)(pt,{children:[(0,_t.jsx)(Qie,{}),(0,_t.jsxs)(ke,{children:[(0,_t.jsx)(Oe,{path:"/",element:(0,_t.jsx)(Kie,{})}),(0,_t.jsx)(Oe,{path:"/projects",element:(0,_t.jsx)(Zie,{})}),(0,_t.jsx)(Oe,{path:"/classes",element:(0,_t.jsx)(Jie,{})})]}),(0,_t.jsx)(Sne,{})]})})},Cne=e=>{e&&e instanceof Function&&i.e(453).then(i.bind(i,453)).then(t=>{let{getCLS:i,getFID:n,getFCP:r,getLCP:a,getTTFB:o}=t;i(e),n(e),r(e),a(e),o(e)})};n.createRoot(document.getElementById("root")).render((0,_t.jsx)(e.StrictMode,{children:(0,_t.jsx)(_ne,{})})),Cne()})()})();
//# sourceMappingURL=main.11f58838.js.map